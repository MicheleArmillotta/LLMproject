[
  {
    "function_name": "qemuBlockStorageSourceNeedsStorageSliceLayer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "3332-3346",
    "snippet": "bool\nqemuBlockStorageSourceNeedsStorageSliceLayer(const virStorageSource *src)\n{\n    if (!src->sliceStorage)\n        return false;\n\n    if (src->format != VIR_STORAGE_FILE_RAW)\n        return true;\n\n    if (src->encryption &&\n        src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n        return true;\n\n    return false;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nbool\nqemuBlockStorageSourceNeedsStorageSliceLayer(const virStorageSource *src)\n{\n    if (!src->sliceStorage)\n        return false;\n\n    if (src->format != VIR_STORAGE_FILE_RAW)\n        return true;\n\n    if (src->encryption &&\n        src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n        return true;\n\n    return false;\n}"
  },
  {
    "function_name": "qemuBlockReopenReadOnly",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "3308-3323",
    "snippet": "int\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockReopenFormat",
          "args": [
            "vm",
            "src",
            "asyncJob"
          ],
          "line": 3317
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockReopenFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3235-3265",
          "snippet": "static int\nqemuBlockReopenFormat(virDomainObjPtr vm,\n                      virStorageSourcePtr src,\n                      qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverPtr driver = priv->driver;\n    g_autoptr(virJSONValue) reopenprops = NULL;\n    int rc;\n\n    /* If we are lacking the object here, qemu might have opened an image with\n     * a node name unknown to us */\n    if (!src->backingStore) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"can't reopen image with unknown presence of backing store\"));\n        return -1;\n    }\n\n    if (!(reopenprops = qemuBlockStorageSourceGetBlockdevProps(src, src->backingStore)))\n        return -1;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    rc = qemuMonitorBlockdevReopen(priv->mon, &reopenprops);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockReopenFormat(virDomainObjPtr vm,\n                      virStorageSourcePtr src,\n                      qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverPtr driver = priv->driver;\n    g_autoptr(virJSONValue) reopenprops = NULL;\n    int rc;\n\n    /* If we are lacking the object here, qemu might have opened an image with\n     * a node name unknown to us */\n    if (!src->backingStore) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"can't reopen image with unknown presence of backing store\"));\n        return -1;\n    }\n\n    if (!(reopenprops = qemuBlockStorageSourceGetBlockdevProps(src, src->backingStore)))\n        return -1;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    rc = qemuMonitorBlockdevReopen(priv->mon, &reopenprops);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockReopenReadWrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "3279-3294",
    "snippet": "int\nqemuBlockReopenReadWrite(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (!src->readonly)\n        return 0;\n\n    src->readonly = false;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = true;\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockReopenFormat",
          "args": [
            "vm",
            "src",
            "asyncJob"
          ],
          "line": 3288
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockReopenFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3235-3265",
          "snippet": "static int\nqemuBlockReopenFormat(virDomainObjPtr vm,\n                      virStorageSourcePtr src,\n                      qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverPtr driver = priv->driver;\n    g_autoptr(virJSONValue) reopenprops = NULL;\n    int rc;\n\n    /* If we are lacking the object here, qemu might have opened an image with\n     * a node name unknown to us */\n    if (!src->backingStore) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"can't reopen image with unknown presence of backing store\"));\n        return -1;\n    }\n\n    if (!(reopenprops = qemuBlockStorageSourceGetBlockdevProps(src, src->backingStore)))\n        return -1;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    rc = qemuMonitorBlockdevReopen(priv->mon, &reopenprops);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockReopenFormat(virDomainObjPtr vm,\n                      virStorageSourcePtr src,\n                      qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverPtr driver = priv->driver;\n    g_autoptr(virJSONValue) reopenprops = NULL;\n    int rc;\n\n    /* If we are lacking the object here, qemu might have opened an image with\n     * a node name unknown to us */\n    if (!src->backingStore) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"can't reopen image with unknown presence of backing store\"));\n        return -1;\n    }\n\n    if (!(reopenprops = qemuBlockStorageSourceGetBlockdevProps(src, src->backingStore)))\n        return -1;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    rc = qemuMonitorBlockdevReopen(priv->mon, &reopenprops);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockReopenReadWrite(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (!src->readonly)\n        return 0;\n\n    src->readonly = false;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = true;\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockReopenFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "3235-3265",
    "snippet": "static int\nqemuBlockReopenFormat(virDomainObjPtr vm,\n                      virStorageSourcePtr src,\n                      qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverPtr driver = priv->driver;\n    g_autoptr(virJSONValue) reopenprops = NULL;\n    int rc;\n\n    /* If we are lacking the object here, qemu might have opened an image with\n     * a node name unknown to us */\n    if (!src->backingStore) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"can't reopen image with unknown presence of backing store\"));\n        return -1;\n    }\n\n    if (!(reopenprops = qemuBlockStorageSourceGetBlockdevProps(src, src->backingStore)))\n        return -1;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    rc = qemuMonitorBlockdevReopen(priv->mon, &reopenprops);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuDomainObjExitMonitor",
          "args": [
            "driver",
            "vm"
          ],
          "line": 3261
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjExitMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10189-10200",
          "snippet": "int qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\n\nint qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorBlockdevReopen",
          "args": [
            "priv->mon",
            "&reopenprops"
          ],
          "line": 3259
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorBlockdevReopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4357-4367",
          "snippet": "int\nqemuMonitorBlockdevReopen(qemuMonitorPtr mon,\n                          virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevReopen(mon, props);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorBlockdevReopen(qemuMonitorPtr mon,\n                          virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevReopen(mon, props);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjEnterMonitorAsync",
          "args": [
            "driver",
            "vm",
            "asyncJob"
          ],
          "line": 3256
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjEnterMonitorAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10216-10222",
          "snippet": "int\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);",
            "qemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\nqemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));\n\nint\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBlockdevProps",
          "args": [
            "src",
            "src->backingStore"
          ],
          "line": 3253
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBlockdevProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1456-1495",
          "snippet": "virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevProps(virStorageSourcePtr src,\n                                       virStorageSourcePtr backingStore)\n{\n    g_autoptr(virJSONValue) props = NULL;\n    const char *storagenode = src->nodestorage;\n\n    if (qemuBlockStorageSourceNeedsStorageSliceLayer(src))\n        storagenode = src->sliceStorage->nodename;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatProps(src)))\n        return NULL;\n\n    if (virJSONValueObjectAppendString(props, \"file\", storagenode) < 0)\n        return NULL;\n\n    if (backingStore) {\n        if (src->format >= VIR_STORAGE_FILE_BACKING) {\n            if (virStorageSourceIsBacking(backingStore)) {\n                if (virJSONValueObjectAppendString(props, \"backing\",\n                                                   backingStore->nodeformat) < 0)\n                    return NULL;\n            } else {\n                /* chain is terminated, indicate that no detection should happen\n                 * in qemu */\n                if (virJSONValueObjectAppendNull(props, \"backing\") < 0)\n                    return NULL;\n            }\n        } else {\n            if (virStorageSourceIsBacking(backingStore)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"storage format '%s' does not support backing store\"),\n                               virStorageFileFormatTypeToString(src->format));\n                return NULL;\n            }\n        }\n    }\n\n    return g_steal_pointer(&props);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuBlockStorageSourceGetBlockdevProps(virStorageSourcePtr src,\n                                       virStorageSourcePtr backingStore)\n{\n    g_autoptr(virJSONValue) props = NULL;\n    const char *storagenode = src->nodestorage;\n\n    if (qemuBlockStorageSourceNeedsStorageSliceLayer(src))\n        storagenode = src->sliceStorage->nodename;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatProps(src)))\n        return NULL;\n\n    if (virJSONValueObjectAppendString(props, \"file\", storagenode) < 0)\n        return NULL;\n\n    if (backingStore) {\n        if (src->format >= VIR_STORAGE_FILE_BACKING) {\n            if (virStorageSourceIsBacking(backingStore)) {\n                if (virJSONValueObjectAppendString(props, \"backing\",\n                                                   backingStore->nodeformat) < 0)\n                    return NULL;\n            } else {\n                /* chain is terminated, indicate that no detection should happen\n                 * in qemu */\n                if (virJSONValueObjectAppendNull(props, \"backing\") < 0)\n                    return NULL;\n            }\n        } else {\n            if (virStorageSourceIsBacking(backingStore)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"storage format '%s' does not support backing store\"),\n                               virStorageFileFormatTypeToString(src->format));\n                return NULL;\n            }\n        }\n    }\n\n    return g_steal_pointer(&props);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "\"%s\"",
            "_(\"can't reopen image with unknown presence of backing store\")"
          ],
          "line": 3248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"can't reopen image with unknown presence of backing store\""
          ],
          "line": 3249
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockReopenFormat(virDomainObjPtr vm,\n                      virStorageSourcePtr src,\n                      qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverPtr driver = priv->driver;\n    g_autoptr(virJSONValue) reopenprops = NULL;\n    int rc;\n\n    /* If we are lacking the object here, qemu might have opened an image with\n     * a node name unknown to us */\n    if (!src->backingStore) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"can't reopen image with unknown presence of backing store\"));\n        return -1;\n    }\n\n    if (!(reopenprops = qemuBlockStorageSourceGetBlockdevProps(src, src->backingStore)))\n        return -1;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    rc = qemuMonitorBlockdevReopen(priv->mon, &reopenprops);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockBitmapsHandleCommitFinish",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "3129-3222",
    "snippet": "int\nqemuBlockBitmapsHandleCommitFinish(virStorageSourcePtr topsrc,\n                                   virStorageSourcePtr basesrc,\n                                   virHashTablePtr blockNamedNodeData,\n                                   virJSONValuePtr *actions,\n                                   char **disabledBitmapsBase)\n{\n    g_autoptr(virJSONValue) act = virJSONValueNewArray();\n    virStorageSourcePtr n;\n    qemuBlockNamedNodeDataPtr entry;\n    g_autoptr(virHashTable) commitdata = NULL;\n    struct qemuBlockBitmapsHandleCommitData *bitmapdata;\n    size_t i;\n\n    commitdata = virHashNew(qemuBlockBitmapsHandleCommitDataFree);\n\n    for (n = topsrc; n != basesrc; n = n->backingStore) {\n        if (!(entry = virHashLookup(blockNamedNodeData, n->nodeformat)))\n            continue;\n\n        for (i = 0; i < entry->nbitmaps; i++) {\n            qemuBlockNamedNodeDataBitmapPtr bitmap = entry->bitmaps[i];\n\n            if (!(bitmapdata = virHashLookup(commitdata, bitmap->name))) {\n                bitmapdata = g_new0(struct qemuBlockBitmapsHandleCommitData, 1);\n\n                /* we must mirror the state of the topmost bitmap and merge\n                 * everything else */\n                bitmapdata->create = true;\n                bitmapdata->enable = bitmap->recording;\n                bitmapdata->basenode = basesrc->nodeformat;\n                bitmapdata->merge = virJSONValueNewArray();\n                bitmapdata->granularity = bitmap->granularity;\n                bitmapdata->persistent = bitmap->persistent;\n\n                if (virHashAddEntry(commitdata, bitmap->name, bitmapdata) < 0) {\n                    qemuBlockBitmapsHandleCommitDataFree(bitmapdata);\n                    return -1;\n                }\n            }\n\n            if (bitmap->inconsistent ||\n                !qemuBlockBitmapChainIsValid(topsrc, bitmap->name, blockNamedNodeData))\n                bitmapdata->skip = true;\n\n            if (qemuMonitorTransactionBitmapMergeSourceAddBitmap(bitmapdata->merge,\n                                                                 n->nodeformat,\n                                                                 bitmap->name) < 0)\n                return -1;\n        }\n    }\n\n    if ((entry = virHashLookup(blockNamedNodeData, basesrc->nodeformat))) {\n        /* note that all bitmaps in 'base' were disabled when commit was started */\n        for (i = 0; i < entry->nbitmaps; i++) {\n            qemuBlockNamedNodeDataBitmapPtr bitmap = entry->bitmaps[i];\n\n            if ((bitmapdata = virHashLookup(commitdata, bitmap->name))) {\n                bitmapdata->create = false;\n            } else {\n                if (disabledBitmapsBase) {\n                    char **disabledbitmaps;\n\n                    for (disabledbitmaps = disabledBitmapsBase; *disabledbitmaps; disabledbitmaps++) {\n                        if (STREQ(*disabledbitmaps, bitmap->name)) {\n                            bitmapdata = g_new0(struct qemuBlockBitmapsHandleCommitData, 1);\n\n                            bitmapdata->create = false;\n                            bitmapdata->enable = true;\n                            bitmapdata->basenode = basesrc->nodeformat;\n                            bitmapdata->granularity = bitmap->granularity;\n                            bitmapdata->persistent = bitmap->persistent;\n\n                            if (virHashAddEntry(commitdata, bitmap->name, bitmapdata) < 0) {\n                                qemuBlockBitmapsHandleCommitDataFree(bitmapdata);\n                                return -1;\n                            }\n\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    if (virHashForEach(commitdata, qemuBlockBitmapsHandleCommitFinishIterate, act) < 0)\n        return -1;\n\n    if (virJSONValueArraySize(act) > 0)\n        *actions = g_steal_pointer(&act);\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&act"
          ],
          "line": 3219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueArraySize",
          "args": [
            "act"
          ],
          "line": 3218
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArraySize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1017-1021",
          "snippet": "size_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nsize_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "commitdata",
            "qemuBlockBitmapsHandleCommitFinishIterate",
            "act"
          ],
          "line": 3215
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockBitmapsHandleCommitDataFree",
          "args": [
            "bitmapdata"
          ],
          "line": 3203
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockBitmapsHandleCommitDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3075-3082",
          "snippet": "static void\nqemuBlockBitmapsHandleCommitDataFree(void *opaque)\n{\n    struct qemuBlockBitmapsHandleCommitData *data = opaque;\n\n    virJSONValueFree(data->merge);\n    g_free(data);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic void\nqemuBlockBitmapsHandleCommitDataFree(void *opaque)\n{\n    struct qemuBlockBitmapsHandleCommitData *data = opaque;\n\n    virJSONValueFree(data->merge);\n    g_free(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "commitdata",
            "bitmap->name",
            "bitmapdata"
          ],
          "line": 3202
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "structqemuBlockBitmapsHandleCommitData",
            "1"
          ],
          "line": 3194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "*disabledbitmaps",
            "bitmap->name"
          ],
          "line": 3193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "commitdata",
            "bitmap->name"
          ],
          "line": 3186
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorTransactionBitmapMergeSourceAddBitmap",
          "args": [
            "bitmapdata->merge",
            "n->nodeformat",
            "bitmap->name"
          ],
          "line": 3174
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionBitmapMergeSourceAddBitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4548-4554",
          "snippet": "int\nqemuMonitorTransactionBitmapMergeSourceAddBitmap(virJSONValuePtr sources,\n                                                 const char *sourcenode,\n                                                 const char *sourcebitmap)\n{\n    return qemuMonitorJSONTransactionBitmapMergeSourceAddBitmap(sources, sourcenode, sourcebitmap);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionBitmapMergeSourceAddBitmap(virJSONValuePtr sources,\n                                                 const char *sourcenode,\n                                                 const char *sourcebitmap)\n{\n    return qemuMonitorJSONTransactionBitmapMergeSourceAddBitmap(sources, sourcenode, sourcebitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockBitmapChainIsValid",
          "args": [
            "topsrc",
            "bitmap->name",
            "blockNamedNodeData"
          ],
          "line": 3171
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockBitmapChainIsValid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2837-2865",
          "snippet": "bool\nqemuBlockBitmapChainIsValid(virStorageSourcePtr src,\n                            const char *bitmapname,\n                            virHashTablePtr blockNamedNodeData)\n{\n    qemuBlockNamedNodeDataBitmapPtr bitmap;\n    virStorageSourcePtr n;\n    bool chain_started = false;\n    bool chain_ended = false;\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(bitmap = qemuBlockNamedNodeDataGetBitmapByName(blockNamedNodeData, n, bitmapname))) {\n            if (chain_started)\n                chain_ended = true;\n\n            continue;\n        }\n\n        if (chain_ended)\n            return false;\n\n        chain_started = true;\n\n        if (bitmap->inconsistent)\n            return false;\n    }\n\n    return chain_started;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nbool\nqemuBlockBitmapChainIsValid(virStorageSourcePtr src,\n                            const char *bitmapname,\n                            virHashTablePtr blockNamedNodeData)\n{\n    qemuBlockNamedNodeDataBitmapPtr bitmap;\n    virStorageSourcePtr n;\n    bool chain_started = false;\n    bool chain_ended = false;\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(bitmap = qemuBlockNamedNodeDataGetBitmapByName(blockNamedNodeData, n, bitmapname))) {\n            if (chain_started)\n                chain_ended = true;\n\n            continue;\n        }\n\n        if (chain_ended)\n            return false;\n\n        chain_started = true;\n\n        if (bitmap->inconsistent)\n            return false;\n    }\n\n    return chain_started;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 3160
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "structqemuBlockBitmapsHandleCommitData",
            "1"
          ],
          "line": 3153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashNew",
          "args": [
            "qemuBlockBitmapsHandleCommitDataFree"
          ],
          "line": 3143
        },
        "resolved": true,
        "details": {
          "function_name": "virHashNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "180-190",
          "snippet": "virHashTablePtr\nvirHashNew(virHashDataFree dataFree)\n{\n    return virHashCreateFull(32,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirHashNew(virHashDataFree dataFree)\n{\n    return virHashCreateFull(32,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockBitmapsHandleCommitFinish(virStorageSourcePtr topsrc,\n                                   virStorageSourcePtr basesrc,\n                                   virHashTablePtr blockNamedNodeData,\n                                   virJSONValuePtr *actions,\n                                   char **disabledBitmapsBase)\n{\n    g_autoptr(virJSONValue) act = virJSONValueNewArray();\n    virStorageSourcePtr n;\n    qemuBlockNamedNodeDataPtr entry;\n    g_autoptr(virHashTable) commitdata = NULL;\n    struct qemuBlockBitmapsHandleCommitData *bitmapdata;\n    size_t i;\n\n    commitdata = virHashNew(qemuBlockBitmapsHandleCommitDataFree);\n\n    for (n = topsrc; n != basesrc; n = n->backingStore) {\n        if (!(entry = virHashLookup(blockNamedNodeData, n->nodeformat)))\n            continue;\n\n        for (i = 0; i < entry->nbitmaps; i++) {\n            qemuBlockNamedNodeDataBitmapPtr bitmap = entry->bitmaps[i];\n\n            if (!(bitmapdata = virHashLookup(commitdata, bitmap->name))) {\n                bitmapdata = g_new0(struct qemuBlockBitmapsHandleCommitData, 1);\n\n                /* we must mirror the state of the topmost bitmap and merge\n                 * everything else */\n                bitmapdata->create = true;\n                bitmapdata->enable = bitmap->recording;\n                bitmapdata->basenode = basesrc->nodeformat;\n                bitmapdata->merge = virJSONValueNewArray();\n                bitmapdata->granularity = bitmap->granularity;\n                bitmapdata->persistent = bitmap->persistent;\n\n                if (virHashAddEntry(commitdata, bitmap->name, bitmapdata) < 0) {\n                    qemuBlockBitmapsHandleCommitDataFree(bitmapdata);\n                    return -1;\n                }\n            }\n\n            if (bitmap->inconsistent ||\n                !qemuBlockBitmapChainIsValid(topsrc, bitmap->name, blockNamedNodeData))\n                bitmapdata->skip = true;\n\n            if (qemuMonitorTransactionBitmapMergeSourceAddBitmap(bitmapdata->merge,\n                                                                 n->nodeformat,\n                                                                 bitmap->name) < 0)\n                return -1;\n        }\n    }\n\n    if ((entry = virHashLookup(blockNamedNodeData, basesrc->nodeformat))) {\n        /* note that all bitmaps in 'base' were disabled when commit was started */\n        for (i = 0; i < entry->nbitmaps; i++) {\n            qemuBlockNamedNodeDataBitmapPtr bitmap = entry->bitmaps[i];\n\n            if ((bitmapdata = virHashLookup(commitdata, bitmap->name))) {\n                bitmapdata->create = false;\n            } else {\n                if (disabledBitmapsBase) {\n                    char **disabledbitmaps;\n\n                    for (disabledbitmaps = disabledBitmapsBase; *disabledbitmaps; disabledbitmaps++) {\n                        if (STREQ(*disabledbitmaps, bitmap->name)) {\n                            bitmapdata = g_new0(struct qemuBlockBitmapsHandleCommitData, 1);\n\n                            bitmapdata->create = false;\n                            bitmapdata->enable = true;\n                            bitmapdata->basenode = basesrc->nodeformat;\n                            bitmapdata->granularity = bitmap->granularity;\n                            bitmapdata->persistent = bitmap->persistent;\n\n                            if (virHashAddEntry(commitdata, bitmap->name, bitmapdata) < 0) {\n                                qemuBlockBitmapsHandleCommitDataFree(bitmapdata);\n                                return -1;\n                            }\n\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    if (virHashForEach(commitdata, qemuBlockBitmapsHandleCommitFinishIterate, act) < 0)\n        return -1;\n\n    if (virJSONValueArraySize(act) > 0)\n        *actions = g_steal_pointer(&act);\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockBitmapsHandleCommitFinishIterate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "3085-3114",
    "snippet": "static int\nqemuBlockBitmapsHandleCommitFinishIterate(void *payload,\n                                          const void *entryname,\n                                          void *opaque)\n{\n    struct qemuBlockBitmapsHandleCommitData *data = payload;\n    const char *bitmapname = entryname;\n    virJSONValuePtr actions = opaque;\n\n    if (data->skip)\n        return 0;\n\n    if (data->create) {\n        if (qemuMonitorTransactionBitmapAdd(actions, data->basenode, bitmapname,\n                                            data->persistent, !data->enable,\n                                            data->granularity) < 0)\n            return -1;\n    } else {\n        if (data->enable &&\n            qemuMonitorTransactionBitmapEnable(actions, data->basenode, bitmapname) < 0)\n            return -1;\n    }\n\n    if (data->merge &&\n        qemuMonitorTransactionBitmapMerge(actions, data->basenode, bitmapname,\n                                          &data->merge) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorTransactionBitmapMerge",
          "args": [
            "actions",
            "data->basenode",
            "bitmapname",
            "&data->merge"
          ],
          "line": 3109
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionBitmapMerge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4538-4545",
          "snippet": "int\nqemuMonitorTransactionBitmapMerge(virJSONValuePtr actions,\n                                  const char *node,\n                                  const char *target,\n                                  virJSONValuePtr *sources)\n{\n    return qemuMonitorJSONTransactionBitmapMerge(actions, node, target, sources);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionBitmapMerge(virJSONValuePtr actions,\n                                  const char *node,\n                                  const char *target,\n                                  virJSONValuePtr *sources)\n{\n    return qemuMonitorJSONTransactionBitmapMerge(actions, node, target, sources);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorTransactionBitmapEnable",
          "args": [
            "actions",
            "data->basenode",
            "bitmapname"
          ],
          "line": 3104
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionBitmapEnable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4520-4526",
          "snippet": "int\nqemuMonitorTransactionBitmapEnable(virJSONValuePtr actions,\n                                   const char *node,\n                                   const char *name)\n{\n    return qemuMonitorJSONTransactionBitmapEnable(actions, node, name);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionBitmapEnable(virJSONValuePtr actions,\n                                   const char *node,\n                                   const char *name)\n{\n    return qemuMonitorJSONTransactionBitmapEnable(actions, node, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorTransactionBitmapAdd",
          "args": [
            "actions",
            "data->basenode",
            "bitmapname",
            "data->persistent",
            "!data->enable",
            "data->granularity"
          ],
          "line": 3098
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionBitmapAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4498-4508",
          "snippet": "int\nqemuMonitorTransactionBitmapAdd(virJSONValuePtr actions,\n                                const char *node,\n                                const char *name,\n                                bool persistent,\n                                bool disabled,\n                                unsigned long long granularity)\n{\n    return qemuMonitorJSONTransactionBitmapAdd(actions, node, name, persistent,\n                                               disabled, granularity);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionBitmapAdd(virJSONValuePtr actions,\n                                const char *node,\n                                const char *name,\n                                bool persistent,\n                                bool disabled,\n                                unsigned long long granularity)\n{\n    return qemuMonitorJSONTransactionBitmapAdd(actions, node, name, persistent,\n                                               disabled, granularity);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockBitmapsHandleCommitFinishIterate(void *payload,\n                                          const void *entryname,\n                                          void *opaque)\n{\n    struct qemuBlockBitmapsHandleCommitData *data = payload;\n    const char *bitmapname = entryname;\n    virJSONValuePtr actions = opaque;\n\n    if (data->skip)\n        return 0;\n\n    if (data->create) {\n        if (qemuMonitorTransactionBitmapAdd(actions, data->basenode, bitmapname,\n                                            data->persistent, !data->enable,\n                                            data->granularity) < 0)\n            return -1;\n    } else {\n        if (data->enable &&\n            qemuMonitorTransactionBitmapEnable(actions, data->basenode, bitmapname) < 0)\n            return -1;\n    }\n\n    if (data->merge &&\n        qemuMonitorTransactionBitmapMerge(actions, data->basenode, bitmapname,\n                                          &data->merge) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockBitmapsHandleCommitDataFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "3075-3082",
    "snippet": "static void\nqemuBlockBitmapsHandleCommitDataFree(void *opaque)\n{\n    struct qemuBlockBitmapsHandleCommitData *data = opaque;\n\n    virJSONValueFree(data->merge);\n    g_free(data);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "data"
          ],
          "line": 3081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "data->merge"
          ],
          "line": 3080
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic void\nqemuBlockBitmapsHandleCommitDataFree(void *opaque)\n{\n    struct qemuBlockBitmapsHandleCommitData *data = opaque;\n\n    virJSONValueFree(data->merge);\n    g_free(data);\n}"
  },
  {
    "function_name": "qemuBlockBitmapsHandleCommitStart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "3020-3061",
    "snippet": "int\nqemuBlockBitmapsHandleCommitStart(virStorageSourcePtr topsrc,\n                                  virStorageSourcePtr basesrc,\n                                  virHashTablePtr blockNamedNodeData,\n                                  virJSONValuePtr *actions,\n                                  char ***disabledBitmapsBase)\n{\n    g_autoptr(virJSONValue) act = virJSONValueNewArray();\n    VIR_AUTOSTRINGLIST bitmaplist = NULL;\n    size_t curbitmapstr = 0;\n    qemuBlockNamedNodeDataPtr entry;\n    bool disable_bitmaps = false;\n    size_t i;\n\n    if (!(entry = virHashLookup(blockNamedNodeData, basesrc->nodeformat)))\n        return 0;\n\n    bitmaplist = g_new0(char *, entry->nbitmaps + 1);\n\n    for (i = 0; i < entry->nbitmaps; i++) {\n        qemuBlockNamedNodeDataBitmapPtr bitmap = entry->bitmaps[i];\n\n        if (!bitmap->recording || bitmap->inconsistent ||\n            !qemuBlockBitmapChainIsValid(topsrc, bitmap->name, blockNamedNodeData))\n            continue;\n\n        disable_bitmaps = true;\n\n        if (qemuMonitorTransactionBitmapDisable(act, basesrc->nodeformat,\n                                                bitmap->name) < 0)\n            return -1;\n\n        bitmaplist[curbitmapstr++] = g_strdup(bitmap->name);\n    }\n\n    if (disable_bitmaps) {\n        *actions = g_steal_pointer(&act);\n        *disabledBitmapsBase = g_steal_pointer(&bitmaplist);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&bitmaplist"
          ],
          "line": 3057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&act"
          ],
          "line": 3056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "bitmap->name"
          ],
          "line": 3052
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorTransactionBitmapDisable",
          "args": [
            "act",
            "basesrc->nodeformat",
            "bitmap->name"
          ],
          "line": 3048
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionBitmapDisable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4529-4535",
          "snippet": "int\nqemuMonitorTransactionBitmapDisable(virJSONValuePtr actions,\n                                    const char *node,\n                                    const char *name)\n{\n    return qemuMonitorJSONTransactionBitmapDisable(actions, node, name);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionBitmapDisable(virJSONValuePtr actions,\n                                    const char *node,\n                                    const char *name)\n{\n    return qemuMonitorJSONTransactionBitmapDisable(actions, node, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockBitmapChainIsValid",
          "args": [
            "topsrc",
            "bitmap->name",
            "blockNamedNodeData"
          ],
          "line": 3043
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockBitmapChainIsValid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2837-2865",
          "snippet": "bool\nqemuBlockBitmapChainIsValid(virStorageSourcePtr src,\n                            const char *bitmapname,\n                            virHashTablePtr blockNamedNodeData)\n{\n    qemuBlockNamedNodeDataBitmapPtr bitmap;\n    virStorageSourcePtr n;\n    bool chain_started = false;\n    bool chain_ended = false;\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(bitmap = qemuBlockNamedNodeDataGetBitmapByName(blockNamedNodeData, n, bitmapname))) {\n            if (chain_started)\n                chain_ended = true;\n\n            continue;\n        }\n\n        if (chain_ended)\n            return false;\n\n        chain_started = true;\n\n        if (bitmap->inconsistent)\n            return false;\n    }\n\n    return chain_started;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nbool\nqemuBlockBitmapChainIsValid(virStorageSourcePtr src,\n                            const char *bitmapname,\n                            virHashTablePtr blockNamedNodeData)\n{\n    qemuBlockNamedNodeDataBitmapPtr bitmap;\n    virStorageSourcePtr n;\n    bool chain_started = false;\n    bool chain_ended = false;\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(bitmap = qemuBlockNamedNodeDataGetBitmapByName(blockNamedNodeData, n, bitmapname))) {\n            if (chain_started)\n                chain_ended = true;\n\n            continue;\n        }\n\n        if (chain_ended)\n            return false;\n\n        chain_started = true;\n\n        if (bitmap->inconsistent)\n            return false;\n    }\n\n    return chain_started;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "char *, entry->nbitmaps + 1"
          ],
          "line": 3037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "blockNamedNodeData",
            "basesrc->nodeformat"
          ],
          "line": 3034
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 3027
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockBitmapsHandleCommitStart(virStorageSourcePtr topsrc,\n                                  virStorageSourcePtr basesrc,\n                                  virHashTablePtr blockNamedNodeData,\n                                  virJSONValuePtr *actions,\n                                  char ***disabledBitmapsBase)\n{\n    g_autoptr(virJSONValue) act = virJSONValueNewArray();\n    VIR_AUTOSTRINGLIST bitmaplist = NULL;\n    size_t curbitmapstr = 0;\n    qemuBlockNamedNodeDataPtr entry;\n    bool disable_bitmaps = false;\n    size_t i;\n\n    if (!(entry = virHashLookup(blockNamedNodeData, basesrc->nodeformat)))\n        return 0;\n\n    bitmaplist = g_new0(char *, entry->nbitmaps + 1);\n\n    for (i = 0; i < entry->nbitmaps; i++) {\n        qemuBlockNamedNodeDataBitmapPtr bitmap = entry->bitmaps[i];\n\n        if (!bitmap->recording || bitmap->inconsistent ||\n            !qemuBlockBitmapChainIsValid(topsrc, bitmap->name, blockNamedNodeData))\n            continue;\n\n        disable_bitmaps = true;\n\n        if (qemuMonitorTransactionBitmapDisable(act, basesrc->nodeformat,\n                                                bitmap->name) < 0)\n            return -1;\n\n        bitmaplist[curbitmapstr++] = g_strdup(bitmap->name);\n    }\n\n    if (disable_bitmaps) {\n        *actions = g_steal_pointer(&act);\n        *disabledBitmapsBase = g_steal_pointer(&bitmaplist);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockBitmapsHandleBlockcopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2915-3003",
    "snippet": "int\nqemuBlockBitmapsHandleBlockcopy(virStorageSourcePtr src,\n                                virStorageSourcePtr mirror,\n                                virHashTablePtr blockNamedNodeData,\n                                bool shallow,\n                                virJSONValuePtr *actions)\n{\n    g_autoptr(virHashTable) bitmaps = virHashNew(virJSONValueHashFree);\n    g_autoptr(virHashTable) bitmaps_merge = virHashNew(virJSONValueHashFree);\n    g_autoptr(virHashTable) bitmaps_skip = virHashNew(NULL);\n    g_autoptr(virJSONValue) tmpactions = virJSONValueNewArray();\n    qemuBlockNamedNodeDataPtr entry;\n    virStorageSourcePtr n;\n    size_t i;\n    struct qemuBlockBitmapsHandleBlockcopyConcatData data = { .bitmaps_merge = bitmaps_merge,\n                                                              .actions = tmpactions,\n                                                              .mirrornodeformat = mirror->nodeformat,\n                                                              .has_bitmaps = false, };\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(entry = virHashLookup(blockNamedNodeData, n->nodeformat)))\n            continue;\n\n        for (i = 0; i < entry->nbitmaps; i++) {\n            qemuBlockNamedNodeDataBitmapPtr bitmap = entry->bitmaps[i];\n            virJSONValuePtr bitmap_merge;\n\n            if (virHashHasEntry(bitmaps_skip, bitmap->name))\n                continue;\n\n            if (!(bitmap_merge = virHashLookup(bitmaps_merge, bitmap->name))) {\n                g_autoptr(virJSONValue) tmp = NULL;\n                bool disabled = !bitmap->recording;\n\n                /* disable any non top-layer bitmaps */\n                if (n != src)\n                    disabled = true;\n\n                if (!bitmap->persistent ||\n                    !(qemuBlockBitmapChainIsValid(n, bitmap->name,\n                                                  blockNamedNodeData))) {\n                    ignore_value(virHashAddEntry(bitmaps_skip, bitmap->name, NULL));\n                    continue;\n                }\n\n                /* prepare the data for adding the bitmap to the mirror */\n                tmp = virJSONValueNewArray();\n\n                if (qemuMonitorTransactionBitmapAdd(tmp,\n                                                    mirror->nodeformat,\n                                                    bitmap->name,\n                                                    true,\n                                                    disabled,\n                                                    bitmap->granularity) < 0)\n                    return -1;\n\n                if (virHashAddEntry(bitmaps, bitmap->name, tmp) < 0)\n                    return -1;\n\n                tmp = NULL;\n\n                /* prepare array for merging all the bitmaps from the original chain */\n                tmp = virJSONValueNewArray();\n\n                if (virHashAddEntry(bitmaps_merge, bitmap->name, tmp) < 0)\n                    return -1;\n\n                bitmap_merge = g_steal_pointer(&tmp);\n            }\n\n            if (qemuMonitorTransactionBitmapMergeSourceAddBitmap(bitmap_merge,\n                                                                 n->nodeformat,\n                                                                 bitmap->name) < 0)\n                return -1;\n        }\n\n        if (shallow)\n            break;\n    }\n\n    if (virHashForEach(bitmaps, qemuBlockBitmapsHandleBlockcopyConcatActions,\n                       &data) < 0)\n        return -1;\n\n    if (data.has_bitmaps)\n        *actions = g_steal_pointer(&tmpactions);\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&tmpactions"
          ],
          "line": 3000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "bitmaps",
            "qemuBlockBitmapsHandleBlockcopyConcatActions",
            "&data"
          ],
          "line": 2995
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorTransactionBitmapMergeSourceAddBitmap",
          "args": [
            "bitmap_merge",
            "n->nodeformat",
            "bitmap->name"
          ],
          "line": 2985
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionBitmapMergeSourceAddBitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4548-4554",
          "snippet": "int\nqemuMonitorTransactionBitmapMergeSourceAddBitmap(virJSONValuePtr sources,\n                                                 const char *sourcenode,\n                                                 const char *sourcebitmap)\n{\n    return qemuMonitorJSONTransactionBitmapMergeSourceAddBitmap(sources, sourcenode, sourcebitmap);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionBitmapMergeSourceAddBitmap(virJSONValuePtr sources,\n                                                 const char *sourcenode,\n                                                 const char *sourcebitmap)\n{\n    return qemuMonitorJSONTransactionBitmapMergeSourceAddBitmap(sources, sourcenode, sourcebitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&tmp"
          ],
          "line": 2982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "bitmaps_merge",
            "bitmap->name",
            "tmp"
          ],
          "line": 2979
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 2977
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorTransactionBitmapAdd",
          "args": [
            "tmp",
            "mirror->nodeformat",
            "bitmap->name",
            "true",
            "disabled",
            "bitmap->granularity"
          ],
          "line": 2963
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionBitmapAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4498-4508",
          "snippet": "int\nqemuMonitorTransactionBitmapAdd(virJSONValuePtr actions,\n                                const char *node,\n                                const char *name,\n                                bool persistent,\n                                bool disabled,\n                                unsigned long long granularity)\n{\n    return qemuMonitorJSONTransactionBitmapAdd(actions, node, name, persistent,\n                                               disabled, granularity);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionBitmapAdd(virJSONValuePtr actions,\n                                const char *node,\n                                const char *name,\n                                bool persistent,\n                                bool disabled,\n                                unsigned long long granularity)\n{\n    return qemuMonitorJSONTransactionBitmapAdd(actions, node, name, persistent,\n                                               disabled, granularity);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virHashAddEntry(bitmaps_skip, bitmap->name, NULL)"
          ],
          "line": 2956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockBitmapChainIsValid",
          "args": [
            "n",
            "bitmap->name",
            "blockNamedNodeData"
          ],
          "line": 2954
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockBitmapChainIsValid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2837-2865",
          "snippet": "bool\nqemuBlockBitmapChainIsValid(virStorageSourcePtr src,\n                            const char *bitmapname,\n                            virHashTablePtr blockNamedNodeData)\n{\n    qemuBlockNamedNodeDataBitmapPtr bitmap;\n    virStorageSourcePtr n;\n    bool chain_started = false;\n    bool chain_ended = false;\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(bitmap = qemuBlockNamedNodeDataGetBitmapByName(blockNamedNodeData, n, bitmapname))) {\n            if (chain_started)\n                chain_ended = true;\n\n            continue;\n        }\n\n        if (chain_ended)\n            return false;\n\n        chain_started = true;\n\n        if (bitmap->inconsistent)\n            return false;\n    }\n\n    return chain_started;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nbool\nqemuBlockBitmapChainIsValid(virStorageSourcePtr src,\n                            const char *bitmapname,\n                            virHashTablePtr blockNamedNodeData)\n{\n    qemuBlockNamedNodeDataBitmapPtr bitmap;\n    virStorageSourcePtr n;\n    bool chain_started = false;\n    bool chain_ended = false;\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(bitmap = qemuBlockNamedNodeDataGetBitmapByName(blockNamedNodeData, n, bitmapname))) {\n            if (chain_started)\n                chain_ended = true;\n\n            continue;\n        }\n\n        if (chain_ended)\n            return false;\n\n        chain_started = true;\n\n        if (bitmap->inconsistent)\n            return false;\n    }\n\n    return chain_started;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "bitmaps_merge",
            "bitmap->name"
          ],
          "line": 2945
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashHasEntry",
          "args": [
            "bitmaps_skip",
            "bitmap->name"
          ],
          "line": 2942
        },
        "resolved": true,
        "details": {
          "function_name": "virHashHasEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "494-499",
          "snippet": "bool\nvirHashHasEntry(const virHashTable *table,\n                const void *name)\n{\n    return !!virHashGetEntry(table, name);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirHashHasEntry(const virHashTable *table,\n                const void *name)\n{\n    return !!virHashGetEntry(table, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashNew",
          "args": [
            "NULL"
          ],
          "line": 2924
        },
        "resolved": true,
        "details": {
          "function_name": "virHashNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "180-190",
          "snippet": "virHashTablePtr\nvirHashNew(virHashDataFree dataFree)\n{\n    return virHashCreateFull(32,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirHashNew(virHashDataFree dataFree)\n{\n    return virHashCreateFull(32,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockBitmapsHandleBlockcopy(virStorageSourcePtr src,\n                                virStorageSourcePtr mirror,\n                                virHashTablePtr blockNamedNodeData,\n                                bool shallow,\n                                virJSONValuePtr *actions)\n{\n    g_autoptr(virHashTable) bitmaps = virHashNew(virJSONValueHashFree);\n    g_autoptr(virHashTable) bitmaps_merge = virHashNew(virJSONValueHashFree);\n    g_autoptr(virHashTable) bitmaps_skip = virHashNew(NULL);\n    g_autoptr(virJSONValue) tmpactions = virJSONValueNewArray();\n    qemuBlockNamedNodeDataPtr entry;\n    virStorageSourcePtr n;\n    size_t i;\n    struct qemuBlockBitmapsHandleBlockcopyConcatData data = { .bitmaps_merge = bitmaps_merge,\n                                                              .actions = tmpactions,\n                                                              .mirrornodeformat = mirror->nodeformat,\n                                                              .has_bitmaps = false, };\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(entry = virHashLookup(blockNamedNodeData, n->nodeformat)))\n            continue;\n\n        for (i = 0; i < entry->nbitmaps; i++) {\n            qemuBlockNamedNodeDataBitmapPtr bitmap = entry->bitmaps[i];\n            virJSONValuePtr bitmap_merge;\n\n            if (virHashHasEntry(bitmaps_skip, bitmap->name))\n                continue;\n\n            if (!(bitmap_merge = virHashLookup(bitmaps_merge, bitmap->name))) {\n                g_autoptr(virJSONValue) tmp = NULL;\n                bool disabled = !bitmap->recording;\n\n                /* disable any non top-layer bitmaps */\n                if (n != src)\n                    disabled = true;\n\n                if (!bitmap->persistent ||\n                    !(qemuBlockBitmapChainIsValid(n, bitmap->name,\n                                                  blockNamedNodeData))) {\n                    ignore_value(virHashAddEntry(bitmaps_skip, bitmap->name, NULL));\n                    continue;\n                }\n\n                /* prepare the data for adding the bitmap to the mirror */\n                tmp = virJSONValueNewArray();\n\n                if (qemuMonitorTransactionBitmapAdd(tmp,\n                                                    mirror->nodeformat,\n                                                    bitmap->name,\n                                                    true,\n                                                    disabled,\n                                                    bitmap->granularity) < 0)\n                    return -1;\n\n                if (virHashAddEntry(bitmaps, bitmap->name, tmp) < 0)\n                    return -1;\n\n                tmp = NULL;\n\n                /* prepare array for merging all the bitmaps from the original chain */\n                tmp = virJSONValueNewArray();\n\n                if (virHashAddEntry(bitmaps_merge, bitmap->name, tmp) < 0)\n                    return -1;\n\n                bitmap_merge = g_steal_pointer(&tmp);\n            }\n\n            if (qemuMonitorTransactionBitmapMergeSourceAddBitmap(bitmap_merge,\n                                                                 n->nodeformat,\n                                                                 bitmap->name) < 0)\n                return -1;\n        }\n\n        if (shallow)\n            break;\n    }\n\n    if (virHashForEach(bitmaps, qemuBlockBitmapsHandleBlockcopyConcatActions,\n                       &data) < 0)\n        return -1;\n\n    if (data.has_bitmaps)\n        *actions = g_steal_pointer(&tmpactions);\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockBitmapsHandleBlockcopyConcatActions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2876-2897",
    "snippet": "static int\nqemuBlockBitmapsHandleBlockcopyConcatActions(void *payload,\n                                             const void *name,\n                                             void *opaque)\n{\n    struct qemuBlockBitmapsHandleBlockcopyConcatData *data = opaque;\n    virJSONValuePtr createactions = payload;\n    const char *bitmapname = name;\n    g_autoptr(virJSONValue) mergebitmaps = virHashSteal(data->bitmaps_merge, bitmapname);\n\n    data->has_bitmaps = true;\n\n    virJSONValueArrayConcat(data->actions, createactions);\n\n    if (qemuMonitorTransactionBitmapMerge(data->actions,\n                                          data->mirrornodeformat,\n                                          bitmapname,\n                                          &mergebitmaps) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorTransactionBitmapMerge",
          "args": [
            "data->actions",
            "data->mirrornodeformat",
            "bitmapname",
            "&mergebitmaps"
          ],
          "line": 2890
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionBitmapMerge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4538-4545",
          "snippet": "int\nqemuMonitorTransactionBitmapMerge(virJSONValuePtr actions,\n                                  const char *node,\n                                  const char *target,\n                                  virJSONValuePtr *sources)\n{\n    return qemuMonitorJSONTransactionBitmapMerge(actions, node, target, sources);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionBitmapMerge(virJSONValuePtr actions,\n                                  const char *node,\n                                  const char *target,\n                                  virJSONValuePtr *sources)\n{\n    return qemuMonitorJSONTransactionBitmapMerge(actions, node, target, sources);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayConcat",
          "args": [
            "data->actions",
            "createactions"
          ],
          "line": 2888
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayConcat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "814-835",
          "snippet": "int\nvirJSONValueArrayConcat(virJSONValuePtr a,\n                        virJSONValuePtr c)\n{\n    size_t i;\n\n    if (a->type != VIR_JSON_TYPE_ARRAY ||\n        c->type != VIR_JSON_TYPE_ARRAY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"expecting JSON array\"));\n        return -1;\n    }\n\n    a->data.array.values = g_renew(virJSONValuePtr, a->data.array.values,\n                                   a->data.array.nvalues + c->data.array.nvalues);\n\n    for (i = 0; i < c->data.array.nvalues; i++)\n        a->data.array.values[a->data.array.nvalues++] = g_steal_pointer(&c->data.array.values[i]);\n\n    c->data.array.nvalues = 0;\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayConcat(virJSONValuePtr a,\n                        virJSONValuePtr c)\n{\n    size_t i;\n\n    if (a->type != VIR_JSON_TYPE_ARRAY ||\n        c->type != VIR_JSON_TYPE_ARRAY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"expecting JSON array\"));\n        return -1;\n    }\n\n    a->data.array.values = g_renew(virJSONValuePtr, a->data.array.values,\n                                   a->data.array.nvalues + c->data.array.nvalues);\n\n    for (i = 0; i < c->data.array.nvalues; i++)\n        a->data.array.values[a->data.array.nvalues++] = g_steal_pointer(&c->data.array.values[i]);\n\n    c->data.array.nvalues = 0;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSteal",
          "args": [
            "data->bitmaps_merge",
            "bitmapname"
          ],
          "line": 2884
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSteal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "512-522",
          "snippet": "void *virHashSteal(virHashTablePtr table, const void *name)\n{\n    void *data = virHashLookup(table, name);\n    if (data) {\n        virHashDataFree dataFree = table->dataFree;\n        table->dataFree = NULL;\n        virHashRemoveEntry(table, name);\n        table->dataFree = dataFree;\n    }\n    return data;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *virHashSteal(virHashTablePtr table, const void *name)\n{\n    void *data = virHashLookup(table, name);\n    if (data) {\n        virHashDataFree dataFree = table->dataFree;\n        table->dataFree = NULL;\n        virHashRemoveEntry(table, name);\n        table->dataFree = dataFree;\n    }\n    return data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockBitmapsHandleBlockcopyConcatActions(void *payload,\n                                             const void *name,\n                                             void *opaque)\n{\n    struct qemuBlockBitmapsHandleBlockcopyConcatData *data = opaque;\n    virJSONValuePtr createactions = payload;\n    const char *bitmapname = name;\n    g_autoptr(virJSONValue) mergebitmaps = virHashSteal(data->bitmaps_merge, bitmapname);\n\n    data->has_bitmaps = true;\n\n    virJSONValueArrayConcat(data->actions, createactions);\n\n    if (qemuMonitorTransactionBitmapMerge(data->actions,\n                                          data->mirrornodeformat,\n                                          bitmapname,\n                                          &mergebitmaps) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockBitmapChainIsValid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2837-2865",
    "snippet": "bool\nqemuBlockBitmapChainIsValid(virStorageSourcePtr src,\n                            const char *bitmapname,\n                            virHashTablePtr blockNamedNodeData)\n{\n    qemuBlockNamedNodeDataBitmapPtr bitmap;\n    virStorageSourcePtr n;\n    bool chain_started = false;\n    bool chain_ended = false;\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(bitmap = qemuBlockNamedNodeDataGetBitmapByName(blockNamedNodeData, n, bitmapname))) {\n            if (chain_started)\n                chain_ended = true;\n\n            continue;\n        }\n\n        if (chain_ended)\n            return false;\n\n        chain_started = true;\n\n        if (bitmap->inconsistent)\n            return false;\n    }\n\n    return chain_started;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockNamedNodeDataGetBitmapByName",
          "args": [
            "blockNamedNodeData",
            "n",
            "bitmapname"
          ],
          "line": 2848
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockNamedNodeDataGetBitmapByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2781-2802",
          "snippet": "qemuBlockNamedNodeDataBitmapPtr\nqemuBlockNamedNodeDataGetBitmapByName(virHashTablePtr blockNamedNodeData,\n                                      virStorageSourcePtr src,\n                                      const char *bitmap)\n{\n    qemuBlockNamedNodeDataPtr nodedata;\n    size_t i;\n\n    if (!(nodedata = virHashLookup(blockNamedNodeData, src->nodeformat)))\n        return NULL;\n\n    for (i = 0; i < nodedata->nbitmaps; i++) {\n        qemuBlockNamedNodeDataBitmapPtr bitmapdata = nodedata->bitmaps[i];\n\n        if (STRNEQ(bitmapdata->name, bitmap))\n            continue;\n\n        return bitmapdata;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nqemuBlockNamedNodeDataBitmapPtr\nqemuBlockNamedNodeDataGetBitmapByName(virHashTablePtr blockNamedNodeData,\n                                      virStorageSourcePtr src,\n                                      const char *bitmap)\n{\n    qemuBlockNamedNodeDataPtr nodedata;\n    size_t i;\n\n    if (!(nodedata = virHashLookup(blockNamedNodeData, src->nodeformat)))\n        return NULL;\n\n    for (i = 0; i < nodedata->nbitmaps; i++) {\n        qemuBlockNamedNodeDataBitmapPtr bitmapdata = nodedata->bitmaps[i];\n\n        if (STRNEQ(bitmapdata->name, bitmap))\n            continue;\n\n        return bitmapdata;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nbool\nqemuBlockBitmapChainIsValid(virStorageSourcePtr src,\n                            const char *bitmapname,\n                            virHashTablePtr blockNamedNodeData)\n{\n    qemuBlockNamedNodeDataBitmapPtr bitmap;\n    virStorageSourcePtr n;\n    bool chain_started = false;\n    bool chain_ended = false;\n\n    for (n = src; n; n = n->backingStore) {\n        if (!(bitmap = qemuBlockNamedNodeDataGetBitmapByName(blockNamedNodeData, n, bitmapname))) {\n            if (chain_started)\n                chain_ended = true;\n\n            continue;\n        }\n\n        if (chain_ended)\n            return false;\n\n        chain_started = true;\n\n        if (bitmap->inconsistent)\n            return false;\n    }\n\n    return chain_started;\n}"
  },
  {
    "function_name": "qemuBlockGetNamedNodeData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2805-2824",
    "snippet": "virHashTablePtr\nqemuBlockGetNamedNodeData(virDomainObjPtr vm,\n                          qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverPtr driver = priv->driver;\n    g_autoptr(virHashTable) blockNamedNodeData = NULL;\n    bool supports_flat = virQEMUCapsGet(priv->qemuCaps,\n                                        QEMU_CAPS_QMP_QUERY_NAMED_BLOCK_NODES_FLAT);\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return NULL;\n\n    blockNamedNodeData = qemuMonitorBlockGetNamedNodeData(priv->mon, supports_flat);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || !blockNamedNodeData)\n        return NULL;\n\n    return g_steal_pointer(&blockNamedNodeData);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&blockNamedNodeData"
          ],
          "line": 2823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainObjExitMonitor",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2820
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjExitMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10189-10200",
          "snippet": "int qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\n\nint qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorBlockGetNamedNodeData",
          "args": [
            "priv->mon",
            "supports_flat"
          ],
          "line": 2818
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorBlockGetNamedNodeData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2183-2191",
          "snippet": "virHashTablePtr\nqemuMonitorBlockGetNamedNodeData(qemuMonitorPtr mon,\n                                 bool supports_flat)\n{\n    QEMU_CHECK_MONITOR_NULL(mon);\n    VIR_DEBUG(\"supports_flat=%d\", supports_flat);\n\n    return qemuMonitorJSONBlockGetNamedNodeData(mon, supports_flat);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nvirHashTablePtr\nqemuMonitorBlockGetNamedNodeData(qemuMonitorPtr mon,\n                                 bool supports_flat)\n{\n    QEMU_CHECK_MONITOR_NULL(mon);\n    VIR_DEBUG(\"supports_flat=%d\", supports_flat);\n\n    return qemuMonitorJSONBlockGetNamedNodeData(mon, supports_flat);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjEnterMonitorAsync",
          "args": [
            "driver",
            "vm",
            "asyncJob"
          ],
          "line": 2815
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjEnterMonitorAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10216-10222",
          "snippet": "int\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);",
            "qemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\nqemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));\n\nint\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUCapsGet",
          "args": [
            "priv->qemuCaps",
            "QEMU_CAPS_QMP_QUERY_NAMED_BLOCK_NODES_FLAT"
          ],
          "line": 2812
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUCapsGetPreferredMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_capabilities.c",
          "lines": "5555-5564",
          "snippet": "const char *\nvirQEMUCapsGetPreferredMachine(virQEMUCapsPtr qemuCaps,\n                               virDomainVirtType virtType)\n{\n    virQEMUCapsAccelPtr accel = virQEMUCapsGetAccel(qemuCaps, virtType);\n\n    if (!accel->nmachineTypes)\n        return NULL;\n    return accel->machineTypes[0].name;\n}",
          "includes": [
            "#include <sys/utsname.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"virutil.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_qapi.h\"",
            "#include \"qemu_capspriv.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"virstring.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnuma.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virbitmap.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/utsname.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"virutil.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_process.h\"\n#include \"qemu_qapi.h\"\n#include \"qemu_capspriv.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include \"virstring.h\"\n#include \"qemu_monitor.h\"\n#include \"virhostcpu.h\"\n#include \"virnuma.h\"\n#include \"virnodesuspend.h\"\n#include \"virbitmap.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"cpu/cpu.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include <config.h>\n\nconst char *\nvirQEMUCapsGetPreferredMachine(virQEMUCapsPtr qemuCaps,\n                               virDomainVirtType virtType)\n{\n    virQEMUCapsAccelPtr accel = virQEMUCapsGetAccel(qemuCaps, virtType);\n\n    if (!accel->nmachineTypes)\n        return NULL;\n    return accel->machineTypes[0].name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirHashTablePtr\nqemuBlockGetNamedNodeData(virDomainObjPtr vm,\n                          qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverPtr driver = priv->driver;\n    g_autoptr(virHashTable) blockNamedNodeData = NULL;\n    bool supports_flat = virQEMUCapsGet(priv->qemuCaps,\n                                        QEMU_CAPS_QMP_QUERY_NAMED_BLOCK_NODES_FLAT);\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return NULL;\n\n    blockNamedNodeData = qemuMonitorBlockGetNamedNodeData(priv->mon, supports_flat);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || !blockNamedNodeData)\n        return NULL;\n\n    return g_steal_pointer(&blockNamedNodeData);\n}"
  },
  {
    "function_name": "qemuBlockNamedNodeDataGetBitmapByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2781-2802",
    "snippet": "qemuBlockNamedNodeDataBitmapPtr\nqemuBlockNamedNodeDataGetBitmapByName(virHashTablePtr blockNamedNodeData,\n                                      virStorageSourcePtr src,\n                                      const char *bitmap)\n{\n    qemuBlockNamedNodeDataPtr nodedata;\n    size_t i;\n\n    if (!(nodedata = virHashLookup(blockNamedNodeData, src->nodeformat)))\n        return NULL;\n\n    for (i = 0; i < nodedata->nbitmaps; i++) {\n        qemuBlockNamedNodeDataBitmapPtr bitmapdata = nodedata->bitmaps[i];\n\n        if (STRNEQ(bitmapdata->name, bitmap))\n            continue;\n\n        return bitmapdata;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "bitmapdata->name",
            "bitmap"
          ],
          "line": 2795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "blockNamedNodeData",
            "src->nodeformat"
          ],
          "line": 2789
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nqemuBlockNamedNodeDataBitmapPtr\nqemuBlockNamedNodeDataGetBitmapByName(virHashTablePtr blockNamedNodeData,\n                                      virStorageSourcePtr src,\n                                      const char *bitmap)\n{\n    qemuBlockNamedNodeDataPtr nodedata;\n    size_t i;\n\n    if (!(nodedata = virHashLookup(blockNamedNodeData, src->nodeformat)))\n        return NULL;\n\n    for (i = 0; i < nodedata->nbitmaps; i++) {\n        qemuBlockNamedNodeDataBitmapPtr bitmapdata = nodedata->bitmaps[i];\n\n        if (STRNEQ(bitmapdata->name, bitmap))\n            continue;\n\n        return bitmapdata;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "qemuBlockRemoveImageMetadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2749-2770",
    "snippet": "int\nqemuBlockRemoveImageMetadata(virQEMUDriverPtr driver,\n                             virDomainObjPtr vm,\n                             const char *diskTarget,\n                             virStorageSourcePtr src)\n{\n    virStorageSourcePtr n;\n    int ret = 0;\n\n    for (n = src; virStorageSourceIsBacking(n); n = n->backingStore) {\n        if (qemuSecurityMoveImageMetadata(driver, vm, n, NULL) < 0) {\n            VIR_WARN(\"Unable to remove disk metadata on \"\n                     \"vm %s from %s (disk target %s)\",\n                     vm->def->name,\n                     NULLSTR(n->path),\n                     diskTarget);\n            ret = -1;\n        }\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to remove disk metadata on \"\n                     \"vm %s from %s (disk target %s)\"",
            "vm->def->name",
            "NULLSTR(n->path)",
            "diskTarget"
          ],
          "line": 2760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "n->path"
          ],
          "line": 2763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuSecurityMoveImageMetadata",
          "args": [
            "driver",
            "vm",
            "n",
            "NULL"
          ],
          "line": 2759
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSecurityMoveImageMetadata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_security.c",
          "lines": "171-187",
          "snippet": "int\nqemuSecurityMoveImageMetadata(virQEMUDriverPtr driver,\n                              virDomainObjPtr vm,\n                              virStorageSourcePtr src,\n                              virStorageSourcePtr dst)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    pid_t pid = -1;\n\n    if (!priv->rememberOwner)\n        return 0;\n\n    if (qemuDomainNamespaceEnabled(vm, QEMU_DOMAIN_NS_MOUNT))\n        pid = vm->pid;\n\n    return virSecurityManagerMoveImageMetadata(driver->securityManager, pid, src, dst);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"qemu_security.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nint\nqemuSecurityMoveImageMetadata(virQEMUDriverPtr driver,\n                              virDomainObjPtr vm,\n                              virStorageSourcePtr src,\n                              virStorageSourcePtr dst)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    pid_t pid = -1;\n\n    if (!priv->rememberOwner)\n        return 0;\n\n    if (qemuDomainNamespaceEnabled(vm, QEMU_DOMAIN_NS_MOUNT))\n        pid = vm->pid;\n\n    return virSecurityManagerMoveImageMetadata(driver->securityManager, pid, src, dst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBacking",
          "args": [
            "n"
          ],
          "line": 2758
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1581-1585",
          "snippet": "bool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockRemoveImageMetadata(virQEMUDriverPtr driver,\n                             virDomainObjPtr vm,\n                             const char *diskTarget,\n                             virStorageSourcePtr src)\n{\n    virStorageSourcePtr n;\n    int ret = 0;\n\n    for (n = src; virStorageSourceIsBacking(n); n = n->backingStore) {\n        if (qemuSecurityMoveImageMetadata(driver, vm, n, NULL) < 0) {\n            VIR_WARN(\"Unable to remove disk metadata on \"\n                     \"vm %s from %s (disk target %s)\",\n                     vm->def->name,\n                     NULLSTR(n->path),\n                     diskTarget);\n            ret = -1;\n        }\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateDetectSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2723-2746",
    "snippet": "int\nqemuBlockStorageSourceCreateDetectSize(virHashTablePtr blockNamedNodeData,\n                                       virStorageSourcePtr src,\n                                       virStorageSourcePtr templ)\n{\n    qemuBlockNamedNodeDataPtr entry;\n\n    if (!(entry = virHashLookup(blockNamedNodeData, templ->nodeformat))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to update capacity data for block node '%s'\"),\n                       templ->nodeformat);\n        return -1;\n    }\n\n    if (src->format == VIR_STORAGE_FILE_RAW) {\n        src->physical = entry->capacity;\n    } else {\n        src->physical = entry->physical;\n    }\n\n    src->capacity = entry->capacity;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to update capacity data for block node '%s'\")",
            "templ->nodeformat"
          ],
          "line": 2731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to update capacity data for block node '%s'\""
          ],
          "line": 2732
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "blockNamedNodeData",
            "templ->nodeformat"
          ],
          "line": 2730
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceCreateDetectSize(virHashTablePtr blockNamedNodeData,\n                                       virStorageSourcePtr src,\n                                       virStorageSourcePtr templ)\n{\n    qemuBlockNamedNodeDataPtr entry;\n\n    if (!(entry = virHashLookup(blockNamedNodeData, templ->nodeformat))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to update capacity data for block node '%s'\"),\n                       templ->nodeformat);\n        return -1;\n    }\n\n    if (src->format == VIR_STORAGE_FILE_RAW) {\n        src->physical = entry->capacity;\n    } else {\n        src->physical = entry->physical;\n    }\n\n    src->capacity = entry->capacity;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2645-2709",
    "snippet": "int\nqemuBlockStorageSourceCreate(virDomainObjPtr vm,\n                             virStorageSourcePtr src,\n                             virStorageSourcePtr backingStore,\n                             virStorageSourcePtr chain,\n                             qemuBlockStorageSourceAttachDataPtr data,\n                             qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret = -1;\n    int rc;\n\n    if (src->sliceStorage) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"creation of images with slice type='storage' is not supported\"));\n        return -1;\n    }\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuBlockStorageSourceAttachApplyStorageDeps(priv->mon, data);\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (qemuBlockStorageSourceCreateStorage(vm, src, chain, asyncJob) < 0)\n        goto cleanup;\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuBlockStorageSourceAttachApplyStorage(priv->mon, data);\n\n    if (rc == 0)\n        rc = qemuBlockStorageSourceAttachApplyFormatDeps(priv->mon, data);\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (qemuBlockStorageSourceCreateFormat(vm, src, backingStore, chain,\n                                           asyncJob) < 0)\n        goto cleanup;\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuBlockStorageSourceAttachApplyFormat(priv->mon, data);\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0 &&\n        virDomainObjIsActive(vm) &&\n        qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) == 0) {\n\n        qemuBlockStorageSourceAttachRollback(priv->mon, data);\n        ignore_value(qemuDomainObjExitMonitor(priv->driver, vm));\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "qemuDomainObjExitMonitor(priv->driver, vm)"
          ],
          "line": 2705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainObjExitMonitor",
          "args": [
            "priv->driver",
            "vm"
          ],
          "line": 2705
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjExitMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10189-10200",
          "snippet": "int qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\n\nint qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachRollback",
          "args": [
            "priv->mon",
            "data"
          ],
          "line": 2704
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachRollback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1724-1764",
          "snippet": "void\nqemuBlockStorageSourceAttachRollback(qemuMonitorPtr mon,\n                                     qemuBlockStorageSourceAttachDataPtr data)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (data->driveAdded) {\n        if (qemuMonitorDriveDel(mon, data->driveAlias) < 0)\n            VIR_WARN(\"Unable to remove drive %s (%s) after failed \"\n                     \"qemuMonitorAddDevice\", data->driveAlias, data->driveCmd);\n    }\n\n    if (data->formatAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->formatNodeName));\n\n    if (data->storageSliceAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageSliceNodeName));\n\n    if (data->storageAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageNodeName));\n\n    if (data->prmgrAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->prmgrAlias, false));\n\n    if (data->authsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->authsecretAlias, false));\n\n    if (data->encryptsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->encryptsecretAlias, false));\n\n    if (data->httpcookiesecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->httpcookiesecretAlias, false));\n\n    if (data->tlsAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->tlsAlias, false));\n\n\n    virErrorRestore(&orig_err);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvoid\nqemuBlockStorageSourceAttachRollback(qemuMonitorPtr mon,\n                                     qemuBlockStorageSourceAttachDataPtr data)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (data->driveAdded) {\n        if (qemuMonitorDriveDel(mon, data->driveAlias) < 0)\n            VIR_WARN(\"Unable to remove drive %s (%s) after failed \"\n                     \"qemuMonitorAddDevice\", data->driveAlias, data->driveCmd);\n    }\n\n    if (data->formatAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->formatNodeName));\n\n    if (data->storageSliceAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageSliceNodeName));\n\n    if (data->storageAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageNodeName));\n\n    if (data->prmgrAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->prmgrAlias, false));\n\n    if (data->authsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->authsecretAlias, false));\n\n    if (data->encryptsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->encryptsecretAlias, false));\n\n    if (data->httpcookiesecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->httpcookiesecretAlias, false));\n\n    if (data->tlsAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->tlsAlias, false));\n\n\n    virErrorRestore(&orig_err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjEnterMonitorAsync",
          "args": [
            "priv->driver",
            "vm",
            "asyncJob"
          ],
          "line": 2702
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjEnterMonitorAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10216-10222",
          "snippet": "int\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);",
            "qemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\nqemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));\n\nint\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 2701
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachApplyFormat",
          "args": [
            "priv->mon",
            "data"
          ],
          "line": 2692
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachApplyFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1649-1661",
          "snippet": "static int\nqemuBlockStorageSourceAttachApplyFormat(qemuMonitorPtr mon,\n                                        qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->formatProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->formatProps) < 0)\n            return -1;\n\n        data->formatAttached = true;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyFormat(qemuMonitorPtr mon,\n                                        qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->formatProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->formatProps) < 0)\n            return -1;\n\n        data->formatAttached = true;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateFormat",
          "args": [
            "vm",
            "src",
            "backingStore",
            "chain",
            "asyncJob"
          ],
          "line": 2685
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2596-2626",
          "snippet": "static int\nqemuBlockStorageSourceCreateFormat(virDomainObjPtr vm,\n                                   virStorageSourcePtr src,\n                                   virStorageSourcePtr backingStore,\n                                   virStorageSourcePtr chain,\n                                   qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) createformatprops = NULL;\n    int ret;\n\n    if (src->format == VIR_STORAGE_FILE_RAW &&\n        !src->encryption)\n        return 0;\n\n    if (qemuBlockStorageSourceCreateGetFormatProps(src, backingStore,\n                                                   &createformatprops) < 0)\n        return -1;\n\n    if (!createformatprops) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"can't create storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return -1;\n    }\n\n    ret = qemuBlockStorageSourceCreateGeneric(vm, createformatprops, src, chain,\n                                              false, asyncJob);\n    createformatprops = NULL;\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateFormat(virDomainObjPtr vm,\n                                   virStorageSourcePtr src,\n                                   virStorageSourcePtr backingStore,\n                                   virStorageSourcePtr chain,\n                                   qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) createformatprops = NULL;\n    int ret;\n\n    if (src->format == VIR_STORAGE_FILE_RAW &&\n        !src->encryption)\n        return 0;\n\n    if (qemuBlockStorageSourceCreateGetFormatProps(src, backingStore,\n                                                   &createformatprops) < 0)\n        return -1;\n\n    if (!createformatprops) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"can't create storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return -1;\n    }\n\n    ret = qemuBlockStorageSourceCreateGeneric(vm, createformatprops, src, chain,\n                                              false, asyncJob);\n    createformatprops = NULL;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachApplyFormatDeps",
          "args": [
            "priv->mon",
            "data"
          ],
          "line": 2680
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachApplyFormatDeps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1636-1646",
          "snippet": "static int\nqemuBlockStorageSourceAttachApplyFormatDeps(qemuMonitorPtr mon,\n                                            qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->encryptsecretProps &&\n        qemuMonitorAddObject(mon, &data->encryptsecretProps,\n                             &data->encryptsecretAlias) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyFormatDeps(qemuMonitorPtr mon,\n                                            qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->encryptsecretProps &&\n        qemuMonitorAddObject(mon, &data->encryptsecretProps,\n                             &data->encryptsecretAlias) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachApplyStorage",
          "args": [
            "priv->mon",
            "data"
          ],
          "line": 2677
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachApplyStorageSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1664-1676",
          "snippet": "static int\nqemuBlockStorageSourceAttachApplyStorageSlice(qemuMonitorPtr mon,\n                                              qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->storageSliceProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->storageSliceProps) < 0)\n            return -1;\n\n        data->storageSliceAttached = true;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyStorageSlice(qemuMonitorPtr mon,\n                                              qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->storageSliceProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->storageSliceProps) < 0)\n            return -1;\n\n        data->storageSliceAttached = true;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateStorage",
          "args": [
            "vm",
            "src",
            "chain",
            "asyncJob"
          ],
          "line": 2671
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateStorage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2560-2593",
          "snippet": "static int\nqemuBlockStorageSourceCreateStorage(virDomainObjPtr vm,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) createstorageprops = NULL;\n    int ret;\n\n    /* We create local files directly to be able to apply security labels\n     * properly. This is enough for formats which store the capacity of the image\n     * in the metadata as they will grow. We must create a correctly sized\n     * image for 'raw' and 'luks' though as the image size influences the\n     * capacity.\n     */\n    if (actualType != VIR_STORAGE_TYPE_NETWORK &&\n        !(actualType == VIR_STORAGE_TYPE_FILE && src->format == VIR_STORAGE_FILE_RAW))\n        return 0;\n\n    if (qemuBlockStorageSourceCreateGetStorageProps(src, &createstorageprops) < 0)\n        return -1;\n\n    if (!createstorageprops) {\n        /* we can always try opening it to see whether it was existing */\n        return 0;\n    }\n\n    ret = qemuBlockStorageSourceCreateGeneric(vm, createstorageprops, src, chain,\n                                              true, asyncJob);\n    createstorageprops = NULL;\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateStorage(virDomainObjPtr vm,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) createstorageprops = NULL;\n    int ret;\n\n    /* We create local files directly to be able to apply security labels\n     * properly. This is enough for formats which store the capacity of the image\n     * in the metadata as they will grow. We must create a correctly sized\n     * image for 'raw' and 'luks' though as the image size influences the\n     * capacity.\n     */\n    if (actualType != VIR_STORAGE_TYPE_NETWORK &&\n        !(actualType == VIR_STORAGE_TYPE_FILE && src->format == VIR_STORAGE_FILE_RAW))\n        return 0;\n\n    if (qemuBlockStorageSourceCreateGetStorageProps(src, &createstorageprops) < 0)\n        return -1;\n\n    if (!createstorageprops) {\n        /* we can always try opening it to see whether it was existing */\n        return 0;\n    }\n\n    ret = qemuBlockStorageSourceCreateGeneric(vm, createstorageprops, src, chain,\n                                              true, asyncJob);\n    createstorageprops = NULL;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachApplyStorageDeps",
          "args": [
            "priv->mon",
            "data"
          ],
          "line": 2666
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachApplyStorageDeps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1595-1618",
          "snippet": "static int\nqemuBlockStorageSourceAttachApplyStorageDeps(qemuMonitorPtr mon,\n                                             qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->prmgrProps &&\n        qemuMonitorAddObject(mon, &data->prmgrProps, &data->prmgrAlias) < 0)\n        return -1;\n\n    if (data->authsecretProps &&\n        qemuMonitorAddObject(mon, &data->authsecretProps,\n                             &data->authsecretAlias) < 0)\n        return -1;\n\n    if (data->httpcookiesecretProps &&\n        qemuMonitorAddObject(mon, &data->httpcookiesecretProps,\n                             &data->httpcookiesecretAlias) < 0)\n        return -1;\n\n    if (data->tlsProps &&\n        qemuMonitorAddObject(mon, &data->tlsProps, &data->tlsAlias) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyStorageDeps(qemuMonitorPtr mon,\n                                             qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->prmgrProps &&\n        qemuMonitorAddObject(mon, &data->prmgrProps, &data->prmgrAlias) < 0)\n        return -1;\n\n    if (data->authsecretProps &&\n        qemuMonitorAddObject(mon, &data->authsecretProps,\n                             &data->authsecretAlias) < 0)\n        return -1;\n\n    if (data->httpcookiesecretProps &&\n        qemuMonitorAddObject(mon, &data->httpcookiesecretProps,\n                             &data->httpcookiesecretAlias) < 0)\n        return -1;\n\n    if (data->tlsProps &&\n        qemuMonitorAddObject(mon, &data->tlsProps, &data->tlsAlias) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "\"%s\"",
            "_(\"creation of images with slice type='storage' is not supported\")"
          ],
          "line": 2658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"creation of images with slice type='storage' is not supported\""
          ],
          "line": 2659
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceCreate(virDomainObjPtr vm,\n                             virStorageSourcePtr src,\n                             virStorageSourcePtr backingStore,\n                             virStorageSourcePtr chain,\n                             qemuBlockStorageSourceAttachDataPtr data,\n                             qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret = -1;\n    int rc;\n\n    if (src->sliceStorage) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"creation of images with slice type='storage' is not supported\"));\n        return -1;\n    }\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuBlockStorageSourceAttachApplyStorageDeps(priv->mon, data);\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (qemuBlockStorageSourceCreateStorage(vm, src, chain, asyncJob) < 0)\n        goto cleanup;\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuBlockStorageSourceAttachApplyStorage(priv->mon, data);\n\n    if (rc == 0)\n        rc = qemuBlockStorageSourceAttachApplyFormatDeps(priv->mon, data);\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (qemuBlockStorageSourceCreateFormat(vm, src, backingStore, chain,\n                                           asyncJob) < 0)\n        goto cleanup;\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuBlockStorageSourceAttachApplyFormat(priv->mon, data);\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0 &&\n        virDomainObjIsActive(vm) &&\n        qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) == 0) {\n\n        qemuBlockStorageSourceAttachRollback(priv->mon, data);\n        ignore_value(qemuDomainObjExitMonitor(priv->driver, vm));\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2596-2626",
    "snippet": "static int\nqemuBlockStorageSourceCreateFormat(virDomainObjPtr vm,\n                                   virStorageSourcePtr src,\n                                   virStorageSourcePtr backingStore,\n                                   virStorageSourcePtr chain,\n                                   qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) createformatprops = NULL;\n    int ret;\n\n    if (src->format == VIR_STORAGE_FILE_RAW &&\n        !src->encryption)\n        return 0;\n\n    if (qemuBlockStorageSourceCreateGetFormatProps(src, backingStore,\n                                                   &createformatprops) < 0)\n        return -1;\n\n    if (!createformatprops) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"can't create storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return -1;\n    }\n\n    ret = qemuBlockStorageSourceCreateGeneric(vm, createformatprops, src, chain,\n                                              false, asyncJob);\n    createformatprops = NULL;\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGeneric",
          "args": [
            "vm",
            "createformatprops",
            "src",
            "chain",
            "false",
            "asyncJob"
          ],
          "line": 2621
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGeneric",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2503-2557",
          "snippet": "static int\nqemuBlockStorageSourceCreateGeneric(virDomainObjPtr vm,\n                                    virJSONValuePtr createProps,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    bool storageCreate,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) props = createProps;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    qemuBlockJobDataPtr job = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(job = qemuBlockJobNewCreate(vm, src, chain, storageCreate)))\n        return -1;\n\n    qemuBlockJobSyncBegin(job);\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorBlockdevCreate(priv->mon, job->name, props);\n    props = NULL;\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    qemuBlockJobStarted(job, vm);\n\n    qemuBlockJobUpdate(vm, job, asyncJob);\n    while (qemuBlockJobIsRunning(job))  {\n        if (virDomainObjWait(vm) < 0)\n            goto cleanup;\n        qemuBlockJobUpdate(vm, job, asyncJob);\n    }\n\n    if (job->state == QEMU_BLOCKJOB_STATE_FAILED ||\n        job->state == QEMU_BLOCKJOB_STATE_CANCELLED) {\n        if (job->state == QEMU_BLOCKJOB_STATE_CANCELLED && !job->errmsg) {\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"blockdev-create job was cancelled\"));\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"failed to format image: '%s'\"), NULLSTR(job->errmsg));\n        }\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    qemuBlockJobStartupFinalize(vm, job);\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGeneric(virDomainObjPtr vm,\n                                    virJSONValuePtr createProps,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    bool storageCreate,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) props = createProps;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    qemuBlockJobDataPtr job = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(job = qemuBlockJobNewCreate(vm, src, chain, storageCreate)))\n        return -1;\n\n    qemuBlockJobSyncBegin(job);\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorBlockdevCreate(priv->mon, job->name, props);\n    props = NULL;\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    qemuBlockJobStarted(job, vm);\n\n    qemuBlockJobUpdate(vm, job, asyncJob);\n    while (qemuBlockJobIsRunning(job))  {\n        if (virDomainObjWait(vm) < 0)\n            goto cleanup;\n        qemuBlockJobUpdate(vm, job, asyncJob);\n    }\n\n    if (job->state == QEMU_BLOCKJOB_STATE_FAILED ||\n        job->state == QEMU_BLOCKJOB_STATE_CANCELLED) {\n        if (job->state == QEMU_BLOCKJOB_STATE_CANCELLED && !job->errmsg) {\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"blockdev-create job was cancelled\"));\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"failed to format image: '%s'\"), NULLSTR(job->errmsg));\n        }\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    qemuBlockJobStartupFinalize(vm, job);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "_(\"can't create storage format '%s'\")",
            "virStorageFileFormatTypeToString(src->format)"
          ],
          "line": 2615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeToString",
          "args": [
            "src->format"
          ],
          "line": 2617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"can't create storage format '%s'\""
          ],
          "line": 2616
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGetFormatProps",
          "args": [
            "src",
            "backingStore",
            "&createformatprops"
          ],
          "line": 2610
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGetFormatProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2344-2411",
          "snippet": "int\nqemuBlockStorageSourceCreateGetFormatProps(virStorageSourcePtr src,\n                                           virStorageSourcePtr backing,\n                                           virJSONValuePtr *props)\n{\n    switch ((virStorageFileFormat) src->format) {\n    case VIR_STORAGE_FILE_RAW:\n        if (!src->encryption ||\n            src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            return 0;\n\n        return qemuBlockStorageSourceCreateGetFormatPropsLUKS(src, props);\n\n    case VIR_STORAGE_FILE_QCOW2:\n        return qemuBlockStorageSourceCreateGetFormatPropsQcow2(src, backing, props);\n\n    case VIR_STORAGE_FILE_QCOW:\n        return qemuBlockStorageSourceCreateGetFormatPropsQcow(src, backing, props);\n\n    case VIR_STORAGE_FILE_QED:\n        return qemuBlockStorageSourceCreateGetFormatPropsQed(src, backing, props);\n\n    case VIR_STORAGE_FILE_VPC:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vpc\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_PLOOP:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"parallels\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VDI:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vdi\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VHD:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vhdx\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VMDK:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vmdk\",\n                                                                 props, backing);\n\n    /* unsupported by qemu / impossible */\n    case VIR_STORAGE_FILE_FAT:\n    case VIR_STORAGE_FILE_BOCHS:\n    case VIR_STORAGE_FILE_CLOOP:\n    case VIR_STORAGE_FILE_DMG:\n    case VIR_STORAGE_FILE_COW:\n    case VIR_STORAGE_FILE_ISO:\n    case VIR_STORAGE_FILE_DIR:\n        return 0;\n\n    case VIR_STORAGE_FILE_AUTO_SAFE:\n    case VIR_STORAGE_FILE_AUTO:\n    case VIR_STORAGE_FILE_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"mishandled storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return -1;\n\n    case VIR_STORAGE_FILE_LAST:\n    default:\n        break;\n    }\n\n    virReportEnumRangeError(virStorageFileFormat, src->format);\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceCreateGetFormatProps(virStorageSourcePtr src,\n                                           virStorageSourcePtr backing,\n                                           virJSONValuePtr *props)\n{\n    switch ((virStorageFileFormat) src->format) {\n    case VIR_STORAGE_FILE_RAW:\n        if (!src->encryption ||\n            src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            return 0;\n\n        return qemuBlockStorageSourceCreateGetFormatPropsLUKS(src, props);\n\n    case VIR_STORAGE_FILE_QCOW2:\n        return qemuBlockStorageSourceCreateGetFormatPropsQcow2(src, backing, props);\n\n    case VIR_STORAGE_FILE_QCOW:\n        return qemuBlockStorageSourceCreateGetFormatPropsQcow(src, backing, props);\n\n    case VIR_STORAGE_FILE_QED:\n        return qemuBlockStorageSourceCreateGetFormatPropsQed(src, backing, props);\n\n    case VIR_STORAGE_FILE_VPC:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vpc\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_PLOOP:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"parallels\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VDI:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vdi\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VHD:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vhdx\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VMDK:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vmdk\",\n                                                                 props, backing);\n\n    /* unsupported by qemu / impossible */\n    case VIR_STORAGE_FILE_FAT:\n    case VIR_STORAGE_FILE_BOCHS:\n    case VIR_STORAGE_FILE_CLOOP:\n    case VIR_STORAGE_FILE_DMG:\n    case VIR_STORAGE_FILE_COW:\n    case VIR_STORAGE_FILE_ISO:\n    case VIR_STORAGE_FILE_DIR:\n        return 0;\n\n    case VIR_STORAGE_FILE_AUTO_SAFE:\n    case VIR_STORAGE_FILE_AUTO:\n    case VIR_STORAGE_FILE_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"mishandled storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return -1;\n\n    case VIR_STORAGE_FILE_LAST:\n    default:\n        break;\n    }\n\n    virReportEnumRangeError(virStorageFileFormat, src->format);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateFormat(virDomainObjPtr vm,\n                                   virStorageSourcePtr src,\n                                   virStorageSourcePtr backingStore,\n                                   virStorageSourcePtr chain,\n                                   qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) createformatprops = NULL;\n    int ret;\n\n    if (src->format == VIR_STORAGE_FILE_RAW &&\n        !src->encryption)\n        return 0;\n\n    if (qemuBlockStorageSourceCreateGetFormatProps(src, backingStore,\n                                                   &createformatprops) < 0)\n        return -1;\n\n    if (!createformatprops) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"can't create storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return -1;\n    }\n\n    ret = qemuBlockStorageSourceCreateGeneric(vm, createformatprops, src, chain,\n                                              false, asyncJob);\n    createformatprops = NULL;\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateStorage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2560-2593",
    "snippet": "static int\nqemuBlockStorageSourceCreateStorage(virDomainObjPtr vm,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) createstorageprops = NULL;\n    int ret;\n\n    /* We create local files directly to be able to apply security labels\n     * properly. This is enough for formats which store the capacity of the image\n     * in the metadata as they will grow. We must create a correctly sized\n     * image for 'raw' and 'luks' though as the image size influences the\n     * capacity.\n     */\n    if (actualType != VIR_STORAGE_TYPE_NETWORK &&\n        !(actualType == VIR_STORAGE_TYPE_FILE && src->format == VIR_STORAGE_FILE_RAW))\n        return 0;\n\n    if (qemuBlockStorageSourceCreateGetStorageProps(src, &createstorageprops) < 0)\n        return -1;\n\n    if (!createstorageprops) {\n        /* we can always try opening it to see whether it was existing */\n        return 0;\n    }\n\n    ret = qemuBlockStorageSourceCreateGeneric(vm, createstorageprops, src, chain,\n                                              true, asyncJob);\n    createstorageprops = NULL;\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGeneric",
          "args": [
            "vm",
            "createstorageprops",
            "src",
            "chain",
            "true",
            "asyncJob"
          ],
          "line": 2588
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGeneric",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2503-2557",
          "snippet": "static int\nqemuBlockStorageSourceCreateGeneric(virDomainObjPtr vm,\n                                    virJSONValuePtr createProps,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    bool storageCreate,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) props = createProps;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    qemuBlockJobDataPtr job = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(job = qemuBlockJobNewCreate(vm, src, chain, storageCreate)))\n        return -1;\n\n    qemuBlockJobSyncBegin(job);\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorBlockdevCreate(priv->mon, job->name, props);\n    props = NULL;\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    qemuBlockJobStarted(job, vm);\n\n    qemuBlockJobUpdate(vm, job, asyncJob);\n    while (qemuBlockJobIsRunning(job))  {\n        if (virDomainObjWait(vm) < 0)\n            goto cleanup;\n        qemuBlockJobUpdate(vm, job, asyncJob);\n    }\n\n    if (job->state == QEMU_BLOCKJOB_STATE_FAILED ||\n        job->state == QEMU_BLOCKJOB_STATE_CANCELLED) {\n        if (job->state == QEMU_BLOCKJOB_STATE_CANCELLED && !job->errmsg) {\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"blockdev-create job was cancelled\"));\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"failed to format image: '%s'\"), NULLSTR(job->errmsg));\n        }\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    qemuBlockJobStartupFinalize(vm, job);\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGeneric(virDomainObjPtr vm,\n                                    virJSONValuePtr createProps,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    bool storageCreate,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) props = createProps;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    qemuBlockJobDataPtr job = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(job = qemuBlockJobNewCreate(vm, src, chain, storageCreate)))\n        return -1;\n\n    qemuBlockJobSyncBegin(job);\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorBlockdevCreate(priv->mon, job->name, props);\n    props = NULL;\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    qemuBlockJobStarted(job, vm);\n\n    qemuBlockJobUpdate(vm, job, asyncJob);\n    while (qemuBlockJobIsRunning(job))  {\n        if (virDomainObjWait(vm) < 0)\n            goto cleanup;\n        qemuBlockJobUpdate(vm, job, asyncJob);\n    }\n\n    if (job->state == QEMU_BLOCKJOB_STATE_FAILED ||\n        job->state == QEMU_BLOCKJOB_STATE_CANCELLED) {\n        if (job->state == QEMU_BLOCKJOB_STATE_CANCELLED && !job->errmsg) {\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"blockdev-create job was cancelled\"));\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"failed to format image: '%s'\"), NULLSTR(job->errmsg));\n        }\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    qemuBlockJobStartupFinalize(vm, job);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGetStorageProps",
          "args": [
            "src",
            "&createstorageprops"
          ],
          "line": 2580
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGetStorageProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2423-2500",
          "snippet": "int\nqemuBlockStorageSourceCreateGetStorageProps(virStorageSourcePtr src,\n                                            virJSONValuePtr *props)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) location = NULL;\n    const char *driver = NULL;\n    const char *filename = NULL;\n\n    switch ((virStorageType) actualType) {\n    case VIR_STORAGE_TYPE_FILE:\n        driver = \"file\";\n        filename = src->path;\n        break;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(location = qemuBlockStorageSourceGetGlusterProps(src, false, false)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(location = qemuBlockStorageSourceGetRBDProps(src, false)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(location = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(location = qemuBlockStorageSourceGetSshProps(src)))\n                return -1;\n            break;\n\n            /* unsupported/impossible */\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            return 0;\n        }\n        break;\n\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n    case VIR_STORAGE_TYPE_VOLUME:\n    case VIR_STORAGE_TYPE_NVME:\n        return 0;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n         virReportEnumRangeError(virStorageType, actualType);\n         return -1;\n    }\n\n    if (virJSONValueObjectCreate(props,\n                                 \"s:driver\", driver,\n                                 \"S:filename\", filename,\n                                 \"A:location\", &location,\n                                 \"U:size\", src->physical,\n                                 NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceCreateGetStorageProps(virStorageSourcePtr src,\n                                            virJSONValuePtr *props)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) location = NULL;\n    const char *driver = NULL;\n    const char *filename = NULL;\n\n    switch ((virStorageType) actualType) {\n    case VIR_STORAGE_TYPE_FILE:\n        driver = \"file\";\n        filename = src->path;\n        break;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(location = qemuBlockStorageSourceGetGlusterProps(src, false, false)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(location = qemuBlockStorageSourceGetRBDProps(src, false)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(location = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(location = qemuBlockStorageSourceGetSshProps(src)))\n                return -1;\n            break;\n\n            /* unsupported/impossible */\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            return 0;\n        }\n        break;\n\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n    case VIR_STORAGE_TYPE_VOLUME:\n    case VIR_STORAGE_TYPE_NVME:\n        return 0;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n         virReportEnumRangeError(virStorageType, actualType);\n         return -1;\n    }\n\n    if (virJSONValueObjectCreate(props,\n                                 \"s:driver\", driver,\n                                 \"S:filename\", filename,\n                                 \"A:location\", &location,\n                                 \"U:size\", src->physical,\n                                 NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceGetActualType",
          "args": [
            "src"
          ],
          "line": 2566
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceGetActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2574-2583",
          "snippet": "int\nvirStorageSourceGetActualType(const virStorageSource *def)\n{\n    if (def->type == VIR_STORAGE_TYPE_VOLUME &&\n        def->srcpool &&\n        def->srcpool->actualtype != VIR_STORAGE_TYPE_NONE)\n        return def->srcpool->actualtype;\n\n    return def->type;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nint\nvirStorageSourceGetActualType(const virStorageSource *def)\n{\n    if (def->type == VIR_STORAGE_TYPE_VOLUME &&\n        def->srcpool &&\n        def->srcpool->actualtype != VIR_STORAGE_TYPE_NONE)\n        return def->srcpool->actualtype;\n\n    return def->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateStorage(virDomainObjPtr vm,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) createstorageprops = NULL;\n    int ret;\n\n    /* We create local files directly to be able to apply security labels\n     * properly. This is enough for formats which store the capacity of the image\n     * in the metadata as they will grow. We must create a correctly sized\n     * image for 'raw' and 'luks' though as the image size influences the\n     * capacity.\n     */\n    if (actualType != VIR_STORAGE_TYPE_NETWORK &&\n        !(actualType == VIR_STORAGE_TYPE_FILE && src->format == VIR_STORAGE_FILE_RAW))\n        return 0;\n\n    if (qemuBlockStorageSourceCreateGetStorageProps(src, &createstorageprops) < 0)\n        return -1;\n\n    if (!createstorageprops) {\n        /* we can always try opening it to see whether it was existing */\n        return 0;\n    }\n\n    ret = qemuBlockStorageSourceCreateGeneric(vm, createstorageprops, src, chain,\n                                              true, asyncJob);\n    createstorageprops = NULL;\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateGeneric",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2503-2557",
    "snippet": "static int\nqemuBlockStorageSourceCreateGeneric(virDomainObjPtr vm,\n                                    virJSONValuePtr createProps,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    bool storageCreate,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) props = createProps;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    qemuBlockJobDataPtr job = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(job = qemuBlockJobNewCreate(vm, src, chain, storageCreate)))\n        return -1;\n\n    qemuBlockJobSyncBegin(job);\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorBlockdevCreate(priv->mon, job->name, props);\n    props = NULL;\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    qemuBlockJobStarted(job, vm);\n\n    qemuBlockJobUpdate(vm, job, asyncJob);\n    while (qemuBlockJobIsRunning(job))  {\n        if (virDomainObjWait(vm) < 0)\n            goto cleanup;\n        qemuBlockJobUpdate(vm, job, asyncJob);\n    }\n\n    if (job->state == QEMU_BLOCKJOB_STATE_FAILED ||\n        job->state == QEMU_BLOCKJOB_STATE_CANCELLED) {\n        if (job->state == QEMU_BLOCKJOB_STATE_CANCELLED && !job->errmsg) {\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"blockdev-create job was cancelled\"));\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"failed to format image: '%s'\"), NULLSTR(job->errmsg));\n        }\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    qemuBlockJobStartupFinalize(vm, job);\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockJobStartupFinalize",
          "args": [
            "vm",
            "job"
          ],
          "line": 2555
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockJobStartupFinalize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_blockjob.c",
          "lines": "459-470",
          "snippet": "void\nqemuBlockJobStartupFinalize(virDomainObjPtr vm,\n                            qemuBlockJobDataPtr job)\n{\n    if (!job)\n        return;\n\n    if (job->state == QEMU_BLOCKJOB_STATE_NEW)\n        qemuBlockJobUnregister(job, vm);\n\n    virObjectUnref(job);\n}",
          "includes": [
            "#include \"qemu_security.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"virtime.h\"",
            "#include \"virthread.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virlog.h\"",
            "#include \"conf/domain_event.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_security.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"locking/domain_lock.h\"\n#include \"virtime.h\"\n#include \"virthread.h\"\n#include \"virstoragefile.h\"\n#include \"virlog.h\"\n#include \"conf/domain_event.h\"\n#include \"conf/domain_conf.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_block.h\"\n#include \"qemu_blockjob.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nqemuBlockJobStartupFinalize(virDomainObjPtr vm,\n                            qemuBlockJobDataPtr job)\n{\n    if (!job)\n        return;\n\n    if (job->state == QEMU_BLOCKJOB_STATE_NEW)\n        qemuBlockJobUnregister(job, vm);\n\n    virObjectUnref(job);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"failed to format image: '%s'\")",
            "NULLSTR(job->errmsg)"
          ],
          "line": 2546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "job->errmsg"
          ],
          "line": 2547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to format image: '%s'\""
          ],
          "line": 2547
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"blockdev-create job was cancelled\")"
          ],
          "line": 2543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockJobUpdate",
          "args": [
            "vm",
            "job",
            "asyncJob"
          ],
          "line": 2537
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockJobUpdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_blockjob.c",
          "lines": "1664-1680",
          "snippet": "int\nqemuBlockJobUpdate(virDomainObjPtr vm,\n                   qemuBlockJobDataPtr job,\n                   int asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (job->newstate == -1)\n        return -1;\n\n    if (virQEMUCapsGet(priv->qemuCaps, QEMU_CAPS_BLOCKDEV))\n        qemuBlockJobEventProcess(priv->driver, vm, job, asyncJob);\n    else\n        qemuBlockJobEventProcessLegacy(priv->driver, vm, job, asyncJob);\n\n    return job->state;\n}",
          "includes": [
            "#include \"qemu_security.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"virtime.h\"",
            "#include \"virthread.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virlog.h\"",
            "#include \"conf/domain_event.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_security.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"locking/domain_lock.h\"\n#include \"virtime.h\"\n#include \"virthread.h\"\n#include \"virstoragefile.h\"\n#include \"virlog.h\"\n#include \"conf/domain_event.h\"\n#include \"conf/domain_conf.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_block.h\"\n#include \"qemu_blockjob.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nqemuBlockJobUpdate(virDomainObjPtr vm,\n                   qemuBlockJobDataPtr job,\n                   int asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (job->newstate == -1)\n        return -1;\n\n    if (virQEMUCapsGet(priv->qemuCaps, QEMU_CAPS_BLOCKDEV))\n        qemuBlockJobEventProcess(priv->driver, vm, job, asyncJob);\n    else\n        qemuBlockJobEventProcessLegacy(priv->driver, vm, job, asyncJob);\n\n    return job->state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjWait",
          "args": [
            "vm"
          ],
          "line": 2535
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3659-3675",
          "snippet": "int\nvirDomainObjWait(virDomainObjPtr vm)\n{\n    if (virCondWait(&vm->cond, &vm->parent.lock) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"failed to wait for domain condition\"));\n        return -1;\n    }\n\n    if (!virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjWait(virDomainObjPtr vm)\n{\n    if (virCondWait(&vm->cond, &vm->parent.lock) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"failed to wait for domain condition\"));\n        return -1;\n    }\n\n    if (!virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockJobIsRunning",
          "args": [
            "job"
          ],
          "line": 2534
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockJobIsRunning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_blockjob.c",
          "lines": "473-480",
          "snippet": "bool\nqemuBlockJobIsRunning(qemuBlockJobDataPtr job)\n{\n    return job->state == QEMU_BLOCKJOB_STATE_RUNNING ||\n           job->state == QEMU_BLOCKJOB_STATE_READY ||\n           job->state == QEMU_BLOCKJOB_STATE_ABORTING ||\n           job->state == QEMU_BLOCKJOB_STATE_PIVOTING;\n}",
          "includes": [
            "#include \"qemu_security.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"virtime.h\"",
            "#include \"virthread.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virlog.h\"",
            "#include \"conf/domain_event.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_security.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"locking/domain_lock.h\"\n#include \"virtime.h\"\n#include \"virthread.h\"\n#include \"virstoragefile.h\"\n#include \"virlog.h\"\n#include \"conf/domain_event.h\"\n#include \"conf/domain_conf.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_block.h\"\n#include \"qemu_blockjob.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nqemuBlockJobIsRunning(qemuBlockJobDataPtr job)\n{\n    return job->state == QEMU_BLOCKJOB_STATE_RUNNING ||\n           job->state == QEMU_BLOCKJOB_STATE_READY ||\n           job->state == QEMU_BLOCKJOB_STATE_ABORTING ||\n           job->state == QEMU_BLOCKJOB_STATE_PIVOTING;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockJobStarted",
          "args": [
            "job",
            "vm"
          ],
          "line": 2531
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockJobStarted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_blockjob.c",
          "lines": "440-448",
          "snippet": "void\nqemuBlockJobStarted(qemuBlockJobDataPtr job,\n                    virDomainObjPtr vm)\n{\n    if (job->state == QEMU_BLOCKJOB_STATE_NEW)\n        job->state = QEMU_BLOCKJOB_STATE_RUNNING;\n\n    qemuDomainSaveStatus(vm);\n}",
          "includes": [
            "#include \"qemu_security.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"virtime.h\"",
            "#include \"virthread.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virlog.h\"",
            "#include \"conf/domain_event.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_security.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"locking/domain_lock.h\"\n#include \"virtime.h\"\n#include \"virthread.h\"\n#include \"virstoragefile.h\"\n#include \"virlog.h\"\n#include \"conf/domain_event.h\"\n#include \"conf/domain_conf.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_block.h\"\n#include \"qemu_blockjob.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nqemuBlockJobStarted(qemuBlockJobDataPtr job,\n                    virDomainObjPtr vm)\n{\n    if (job->state == QEMU_BLOCKJOB_STATE_NEW)\n        job->state = QEMU_BLOCKJOB_STATE_RUNNING;\n\n    qemuDomainSaveStatus(vm);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjExitMonitor",
          "args": [
            "priv->driver",
            "vm"
          ],
          "line": 2528
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjExitMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10189-10200",
          "snippet": "int qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\n\nint qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorBlockdevCreate",
          "args": [
            "priv->mon",
            "job->name",
            "props"
          ],
          "line": 2525
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorBlockdevCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4320-4334",
          "snippet": "int\nqemuMonitorBlockdevCreate(qemuMonitorPtr mon,\n                          const char *jobname,\n                          virJSONValuePtr props)\n{\n    VIR_DEBUG(\"jobname=%s props=%p\", jobname, props);\n\n    QEMU_CHECK_MONITOR_GOTO(mon, error);\n\n    return qemuMonitorJSONBlockdevCreate(mon, jobname, props);\n\n error:\n    virJSONValueFree(props);\n    return -1;\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorBlockdevCreate(qemuMonitorPtr mon,\n                          const char *jobname,\n                          virJSONValuePtr props)\n{\n    VIR_DEBUG(\"jobname=%s props=%p\", jobname, props);\n\n    QEMU_CHECK_MONITOR_GOTO(mon, error);\n\n    return qemuMonitorJSONBlockdevCreate(mon, jobname, props);\n\n error:\n    virJSONValueFree(props);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjEnterMonitorAsync",
          "args": [
            "priv->driver",
            "vm",
            "asyncJob"
          ],
          "line": 2522
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjEnterMonitorAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10216-10222",
          "snippet": "int\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);",
            "qemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\nqemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));\n\nint\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockJobSyncBegin",
          "args": [
            "job"
          ],
          "line": 2520
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockJobSyncBegin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_blockjob.c",
          "lines": "1697-1707",
          "snippet": "void\nqemuBlockJobSyncBegin(qemuBlockJobDataPtr job)\n{\n    const char *diskdst = NULL;\n\n    if (job->disk)\n        diskdst = job->disk->dst;\n\n    VIR_DEBUG(\"disk=%s\", NULLSTR(diskdst));\n    job->synchronous = true;\n}",
          "includes": [
            "#include \"qemu_security.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"virtime.h\"",
            "#include \"virthread.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virlog.h\"",
            "#include \"conf/domain_event.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_security.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"locking/domain_lock.h\"\n#include \"virtime.h\"\n#include \"virthread.h\"\n#include \"virstoragefile.h\"\n#include \"virlog.h\"\n#include \"conf/domain_event.h\"\n#include \"conf/domain_conf.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_block.h\"\n#include \"qemu_blockjob.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nqemuBlockJobSyncBegin(qemuBlockJobDataPtr job)\n{\n    const char *diskdst = NULL;\n\n    if (job->disk)\n        diskdst = job->disk->dst;\n\n    VIR_DEBUG(\"disk=%s\", NULLSTR(diskdst));\n    job->synchronous = true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockJobNewCreate",
          "args": [
            "vm",
            "src",
            "chain",
            "storageCreate"
          ],
          "line": 2517
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockJobNewCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_blockjob.c",
          "lines": "324-351",
          "snippet": "qemuBlockJobDataPtr\nqemuBlockJobNewCreate(virDomainObjPtr vm,\n                      virStorageSourcePtr src,\n                      virStorageSourcePtr chain,\n                      bool storage)\n{\n    g_autoptr(qemuBlockJobData) job = NULL;\n    g_autofree char *jobname = NULL;\n    const char *nodename = src->nodeformat;\n\n    if (storage)\n        nodename = src->nodestorage;\n\n    jobname = g_strdup_printf(\"create-%s\", nodename);\n\n    if (!(job = qemuBlockJobDataNew(QEMU_BLOCKJOB_TYPE_CREATE, jobname)))\n        return NULL;\n\n    if (virStorageSourceIsBacking(chain))\n        job->chain = virObjectRef(chain);\n\n     job->data.create.src = virObjectRef(src);\n\n    if (qemuBlockJobRegister(job, vm, NULL, true) < 0)\n        return NULL;\n\n    return g_steal_pointer(&job);\n}",
          "includes": [
            "#include \"qemu_security.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"virtime.h\"",
            "#include \"virthread.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virlog.h\"",
            "#include \"conf/domain_event.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_security.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"locking/domain_lock.h\"\n#include \"virtime.h\"\n#include \"virthread.h\"\n#include \"virstoragefile.h\"\n#include \"virlog.h\"\n#include \"conf/domain_event.h\"\n#include \"conf/domain_conf.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_block.h\"\n#include \"qemu_blockjob.h\"\n#include \"internal.h\"\n#include <config.h>\n\nqemuBlockJobDataPtr\nqemuBlockJobNewCreate(virDomainObjPtr vm,\n                      virStorageSourcePtr src,\n                      virStorageSourcePtr chain,\n                      bool storage)\n{\n    g_autoptr(qemuBlockJobData) job = NULL;\n    g_autofree char *jobname = NULL;\n    const char *nodename = src->nodeformat;\n\n    if (storage)\n        nodename = src->nodestorage;\n\n    jobname = g_strdup_printf(\"create-%s\", nodename);\n\n    if (!(job = qemuBlockJobDataNew(QEMU_BLOCKJOB_TYPE_CREATE, jobname)))\n        return NULL;\n\n    if (virStorageSourceIsBacking(chain))\n        job->chain = virObjectRef(chain);\n\n     job->data.create.src = virObjectRef(src);\n\n    if (qemuBlockJobRegister(job, vm, NULL, true) < 0)\n        return NULL;\n\n    return g_steal_pointer(&job);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGeneric(virDomainObjPtr vm,\n                                    virJSONValuePtr createProps,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr chain,\n                                    bool storageCreate,\n                                    qemuDomainAsyncJob asyncJob)\n{\n    g_autoptr(virJSONValue) props = createProps;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    qemuBlockJobDataPtr job = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(job = qemuBlockJobNewCreate(vm, src, chain, storageCreate)))\n        return -1;\n\n    qemuBlockJobSyncBegin(job);\n\n    if (qemuDomainObjEnterMonitorAsync(priv->driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorBlockdevCreate(priv->mon, job->name, props);\n    props = NULL;\n\n    if (qemuDomainObjExitMonitor(priv->driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    qemuBlockJobStarted(job, vm);\n\n    qemuBlockJobUpdate(vm, job, asyncJob);\n    while (qemuBlockJobIsRunning(job))  {\n        if (virDomainObjWait(vm) < 0)\n            goto cleanup;\n        qemuBlockJobUpdate(vm, job, asyncJob);\n    }\n\n    if (job->state == QEMU_BLOCKJOB_STATE_FAILED ||\n        job->state == QEMU_BLOCKJOB_STATE_CANCELLED) {\n        if (job->state == QEMU_BLOCKJOB_STATE_CANCELLED && !job->errmsg) {\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"blockdev-create job was cancelled\"));\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"failed to format image: '%s'\"), NULLSTR(job->errmsg));\n        }\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    qemuBlockJobStartupFinalize(vm, job);\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateGetStorageProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2423-2500",
    "snippet": "int\nqemuBlockStorageSourceCreateGetStorageProps(virStorageSourcePtr src,\n                                            virJSONValuePtr *props)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) location = NULL;\n    const char *driver = NULL;\n    const char *filename = NULL;\n\n    switch ((virStorageType) actualType) {\n    case VIR_STORAGE_TYPE_FILE:\n        driver = \"file\";\n        filename = src->path;\n        break;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(location = qemuBlockStorageSourceGetGlusterProps(src, false, false)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(location = qemuBlockStorageSourceGetRBDProps(src, false)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(location = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(location = qemuBlockStorageSourceGetSshProps(src)))\n                return -1;\n            break;\n\n            /* unsupported/impossible */\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            return 0;\n        }\n        break;\n\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n    case VIR_STORAGE_TYPE_VOLUME:\n    case VIR_STORAGE_TYPE_NVME:\n        return 0;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n         virReportEnumRangeError(virStorageType, actualType);\n         return -1;\n    }\n\n    if (virJSONValueObjectCreate(props,\n                                 \"s:driver\", driver,\n                                 \"S:filename\", filename,\n                                 \"A:location\", &location,\n                                 \"U:size\", src->physical,\n                                 NULL) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "props",
            "\"s:driver\"",
            "driver",
            "\"S:filename\"",
            "filename",
            "\"A:location\"",
            "&location",
            "\"U:size\"",
            "src->physical",
            "NULL"
          ],
          "line": 2491
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virStorageType",
            "actualType"
          ],
          "line": 2487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetSshProps",
          "args": [
            "src"
          ],
          "line": 2460
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetSshProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "908-946",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetSshProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) host_key_check = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0]);\n    if (!serverprops)\n        return NULL;\n\n    if (src->auth)\n        username = src->auth->username;\n    else if (src->ssh_user)\n        username = src->ssh_user;\n\n    if (src->ssh_host_key_check_disabled &&\n        virJSONValueObjectCreate(&host_key_check,\n                                 \"s:mode\", \"none\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &serverprops,\n                                 \"S:user\", username,\n                                 \"A:host-key-check\", &host_key_check,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetSshProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) host_key_check = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0]);\n    if (!serverprops)\n        return NULL;\n\n    if (src->auth)\n        username = src->auth->username;\n    else if (src->ssh_user)\n        username = src->ssh_user;\n\n    if (src->ssh_host_key_check_disabled &&\n        virJSONValueObjectCreate(&host_key_check,\n                                 \"s:mode\", \"none\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &serverprops,\n                                 \"S:user\", username,\n                                 \"A:host-key-check\", &host_key_check,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetSheepdogProps",
          "args": [
            "src"
          ],
          "line": 2454
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetSheepdogProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "880-905",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetSheepdogProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    /* libvirt does not support the 'snap-id' and 'tag' properties */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"s:vdi\", src->path,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetSheepdogProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    /* libvirt does not support the 'snap-id' and 'tag' properties */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"s:vdi\", src->path,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetRBDProps",
          "args": [
            "src",
            "false"
          ],
          "line": 2448
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetRBDProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "829-877",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetRBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) servers = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) authmodes = NULL;\n    g_autoptr(virJSONValue) mode = NULL;\n    const char *keysecret = NULL;\n\n    if (src->nhosts > 0 &&\n        !(servers = qemuBlockStorageSourceBuildHostsJSONInetSocketAddress(src)))\n        return NULL;\n\n    if (!onlytarget && src->auth) {\n        username = srcPriv->secinfo->s.aes.username;\n        keysecret = srcPriv->secinfo->s.aes.alias;\n        /* the auth modes are modelled after our old command line generator */\n        authmodes = virJSONValueNewArray();\n\n        if (!(mode = virJSONValueNewString(\"cephx\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n\n        if (!(mode = virJSONValueNewString(\"none\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n    }\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:pool\", src->volume,\n                                 \"s:image\", src->path,\n                                 \"S:snapshot\", src->snapshot,\n                                 \"S:conf\", src->configFile,\n                                 \"A:server\", &servers,\n                                 \"S:user\", username,\n                                 \"A:auth-client-required\", &authmodes,\n                                 \"S:key-secret\", keysecret,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetRBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) servers = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) authmodes = NULL;\n    g_autoptr(virJSONValue) mode = NULL;\n    const char *keysecret = NULL;\n\n    if (src->nhosts > 0 &&\n        !(servers = qemuBlockStorageSourceBuildHostsJSONInetSocketAddress(src)))\n        return NULL;\n\n    if (!onlytarget && src->auth) {\n        username = srcPriv->secinfo->s.aes.username;\n        keysecret = srcPriv->secinfo->s.aes.alias;\n        /* the auth modes are modelled after our old command line generator */\n        authmodes = virJSONValueNewArray();\n\n        if (!(mode = virJSONValueNewString(\"cephx\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n\n        if (!(mode = virJSONValueNewString(\"none\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n    }\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:pool\", src->volume,\n                                 \"s:image\", src->path,\n                                 \"S:snapshot\", src->snapshot,\n                                 \"S:conf\", src->configFile,\n                                 \"A:server\", &servers,\n                                 \"S:user\", username,\n                                 \"A:auth-client-required\", &authmodes,\n                                 \"S:key-secret\", keysecret,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetGlusterProps",
          "args": [
            "src",
            "false",
            "false"
          ],
          "line": 2442
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetGlusterProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "610-639",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetGlusterProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(servers = qemuBlockStorageSourceBuildHostsJSONSocketAddress(src, legacy)))\n        return NULL;\n\n     /* { driver:\"gluster\",\n      *   volume:\"testvol\",\n      *   path:\"/a.img\",\n      *   server :[{type:\"tcp\", host:\"1.2.3.4\", port:24007},\n      *            {type:\"unix\", socket:\"/tmp/glusterd.socket\"}, ...]}\n      */\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:volume\", src->volume,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &servers, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        src->debug &&\n        virJSONValueObjectAdd(props, \"u:debug\", src->debugLevel, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetGlusterProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(servers = qemuBlockStorageSourceBuildHostsJSONSocketAddress(src, legacy)))\n        return NULL;\n\n     /* { driver:\"gluster\",\n      *   volume:\"testvol\",\n      *   path:\"/a.img\",\n      *   server :[{type:\"tcp\", host:\"1.2.3.4\", port:24007},\n      *            {type:\"unix\", socket:\"/tmp/glusterd.socket\"}, ...]}\n      */\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:volume\", src->volume,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &servers, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        src->debug &&\n        virJSONValueObjectAdd(props, \"u:debug\", src->debugLevel, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceGetActualType",
          "args": [
            "src"
          ],
          "line": 2427
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceGetActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2574-2583",
          "snippet": "int\nvirStorageSourceGetActualType(const virStorageSource *def)\n{\n    if (def->type == VIR_STORAGE_TYPE_VOLUME &&\n        def->srcpool &&\n        def->srcpool->actualtype != VIR_STORAGE_TYPE_NONE)\n        return def->srcpool->actualtype;\n\n    return def->type;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nint\nvirStorageSourceGetActualType(const virStorageSource *def)\n{\n    if (def->type == VIR_STORAGE_TYPE_VOLUME &&\n        def->srcpool &&\n        def->srcpool->actualtype != VIR_STORAGE_TYPE_NONE)\n        return def->srcpool->actualtype;\n\n    return def->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceCreateGetStorageProps(virStorageSourcePtr src,\n                                            virJSONValuePtr *props)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) location = NULL;\n    const char *driver = NULL;\n    const char *filename = NULL;\n\n    switch ((virStorageType) actualType) {\n    case VIR_STORAGE_TYPE_FILE:\n        driver = \"file\";\n        filename = src->path;\n        break;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(location = qemuBlockStorageSourceGetGlusterProps(src, false, false)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(location = qemuBlockStorageSourceGetRBDProps(src, false)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(location = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return -1;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(location = qemuBlockStorageSourceGetSshProps(src)))\n                return -1;\n            break;\n\n            /* unsupported/impossible */\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            return 0;\n        }\n        break;\n\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n    case VIR_STORAGE_TYPE_VOLUME:\n    case VIR_STORAGE_TYPE_NVME:\n        return 0;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n         virReportEnumRangeError(virStorageType, actualType);\n         return -1;\n    }\n\n    if (virJSONValueObjectCreate(props,\n                                 \"s:driver\", driver,\n                                 \"S:filename\", filename,\n                                 \"A:location\", &location,\n                                 \"U:size\", src->physical,\n                                 NULL) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateGetFormatProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2344-2411",
    "snippet": "int\nqemuBlockStorageSourceCreateGetFormatProps(virStorageSourcePtr src,\n                                           virStorageSourcePtr backing,\n                                           virJSONValuePtr *props)\n{\n    switch ((virStorageFileFormat) src->format) {\n    case VIR_STORAGE_FILE_RAW:\n        if (!src->encryption ||\n            src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            return 0;\n\n        return qemuBlockStorageSourceCreateGetFormatPropsLUKS(src, props);\n\n    case VIR_STORAGE_FILE_QCOW2:\n        return qemuBlockStorageSourceCreateGetFormatPropsQcow2(src, backing, props);\n\n    case VIR_STORAGE_FILE_QCOW:\n        return qemuBlockStorageSourceCreateGetFormatPropsQcow(src, backing, props);\n\n    case VIR_STORAGE_FILE_QED:\n        return qemuBlockStorageSourceCreateGetFormatPropsQed(src, backing, props);\n\n    case VIR_STORAGE_FILE_VPC:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vpc\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_PLOOP:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"parallels\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VDI:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vdi\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VHD:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vhdx\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VMDK:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vmdk\",\n                                                                 props, backing);\n\n    /* unsupported by qemu / impossible */\n    case VIR_STORAGE_FILE_FAT:\n    case VIR_STORAGE_FILE_BOCHS:\n    case VIR_STORAGE_FILE_CLOOP:\n    case VIR_STORAGE_FILE_DMG:\n    case VIR_STORAGE_FILE_COW:\n    case VIR_STORAGE_FILE_ISO:\n    case VIR_STORAGE_FILE_DIR:\n        return 0;\n\n    case VIR_STORAGE_FILE_AUTO_SAFE:\n    case VIR_STORAGE_FILE_AUTO:\n    case VIR_STORAGE_FILE_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"mishandled storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return -1;\n\n    case VIR_STORAGE_FILE_LAST:\n    default:\n        break;\n    }\n\n    virReportEnumRangeError(virStorageFileFormat, src->format);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virStorageFileFormat",
            "src->format"
          ],
          "line": 2409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"mishandled storage format '%s'\")",
            "virStorageFileFormatTypeToString(src->format)"
          ],
          "line": 2399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeToString",
          "args": [
            "src->format"
          ],
          "line": 2401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"mishandled storage format '%s'\""
          ],
          "line": 2400
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGetFormatPropsGeneric",
          "args": [
            "src",
            "\"vmdk\"",
            "props",
            "backing"
          ],
          "line": 2383
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGetFormatPropsGeneric",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2144-2165",
          "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsGeneric(virStorageSourcePtr src,\n                                                  const char *driver,\n                                                  virJSONValuePtr *retprops,\n                                                  virStorageSourcePtr backing)\n{\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:driver\", driver,\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (backing &&\n        qemuBlockStorageSourceCreateAddBacking(backing, props, false) < 0)\n        return -1;\n\n    *retprops = g_steal_pointer(&props);\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsGeneric(virStorageSourcePtr src,\n                                                  const char *driver,\n                                                  virJSONValuePtr *retprops,\n                                                  virStorageSourcePtr backing)\n{\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:driver\", driver,\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (backing &&\n        qemuBlockStorageSourceCreateAddBacking(backing, props, false) < 0)\n        return -1;\n\n    *retprops = g_steal_pointer(&props);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGetFormatPropsQed",
          "args": [
            "src",
            "backing",
            "props"
          ],
          "line": 2364
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGetFormatPropsQed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2311-2330",
          "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsQed(virStorageSourcePtr src,\n                                              virStorageSourcePtr backing,\n                                              virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qedprops = NULL;\n\n    if (virJSONValueObjectCreate(&qedprops,\n                                 \"s:driver\", \"qed\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qedprops, true) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qedprops);\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsQed(virStorageSourcePtr src,\n                                              virStorageSourcePtr backing,\n                                              virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qedprops = NULL;\n\n    if (virJSONValueObjectCreate(&qedprops,\n                                 \"s:driver\", \"qed\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qedprops, true) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qedprops);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGetFormatPropsQcow",
          "args": [
            "src",
            "backing",
            "props"
          ],
          "line": 2361
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGetFormatPropsQcow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2288-2308",
          "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsQcow(virStorageSourcePtr src,\n                                               virStorageSourcePtr backing,\n                                               virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qcowprops = NULL;\n\n    if (virJSONValueObjectCreate(&qcowprops,\n                                 \"s:driver\", \"qcow\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qcowprops, false) < 0 ||\n        qemuBlockStorageSourceCreateAddEncryptionQcow(src, qcowprops) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qcowprops);\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsQcow(virStorageSourcePtr src,\n                                               virStorageSourcePtr backing,\n                                               virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qcowprops = NULL;\n\n    if (virJSONValueObjectCreate(&qcowprops,\n                                 \"s:driver\", \"qcow\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qcowprops, false) < 0 ||\n        qemuBlockStorageSourceCreateAddEncryptionQcow(src, qcowprops) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qcowprops);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGetFormatPropsQcow2",
          "args": [
            "src",
            "backing",
            "props"
          ],
          "line": 2358
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGetFormatPropsQcow2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2258-2285",
          "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsQcow2(virStorageSourcePtr src,\n                                                virStorageSourcePtr backing,\n                                                virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qcow2props = NULL;\n    const char *qcow2version = NULL;\n\n    if (STREQ_NULLABLE(src->compat, \"0.10\"))\n        qcow2version = \"v2\";\n    else if (STREQ_NULLABLE(src->compat, \"1.1\"))\n        qcow2version = \"v3\";\n\n    if (virJSONValueObjectCreate(&qcow2props,\n                                 \"s:driver\", \"qcow2\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 \"S:version\", qcow2version,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qcow2props, true) < 0 ||\n        qemuBlockStorageSourceCreateAddEncryptionQcow(src, qcow2props) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qcow2props);\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsQcow2(virStorageSourcePtr src,\n                                                virStorageSourcePtr backing,\n                                                virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qcow2props = NULL;\n    const char *qcow2version = NULL;\n\n    if (STREQ_NULLABLE(src->compat, \"0.10\"))\n        qcow2version = \"v2\";\n    else if (STREQ_NULLABLE(src->compat, \"1.1\"))\n        qcow2version = \"v3\";\n\n    if (virJSONValueObjectCreate(&qcow2props,\n                                 \"s:driver\", \"qcow2\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 \"S:version\", qcow2version,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qcow2props, true) < 0 ||\n        qemuBlockStorageSourceCreateAddEncryptionQcow(src, qcow2props) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qcow2props);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGetFormatPropsLUKS",
          "args": [
            "src",
            "props"
          ],
          "line": 2355
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGetFormatPropsLUKS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2209-2227",
          "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsLUKS(virStorageSourcePtr src,\n                                               virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) luksprops = NULL;\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &luksprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(luksprops,\n                              \"s:driver\", \"luks\",\n                              \"s:file\", src->nodestorage,\n                              \"U:size\", src->capacity,\n                              NULL) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&luksprops);\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsLUKS(virStorageSourcePtr src,\n                                               virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) luksprops = NULL;\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &luksprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(luksprops,\n                              \"s:driver\", \"luks\",\n                              \"s:file\", src->nodestorage,\n                              \"U:size\", src->capacity,\n                              NULL) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&luksprops);\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceCreateGetFormatProps(virStorageSourcePtr src,\n                                           virStorageSourcePtr backing,\n                                           virJSONValuePtr *props)\n{\n    switch ((virStorageFileFormat) src->format) {\n    case VIR_STORAGE_FILE_RAW:\n        if (!src->encryption ||\n            src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            return 0;\n\n        return qemuBlockStorageSourceCreateGetFormatPropsLUKS(src, props);\n\n    case VIR_STORAGE_FILE_QCOW2:\n        return qemuBlockStorageSourceCreateGetFormatPropsQcow2(src, backing, props);\n\n    case VIR_STORAGE_FILE_QCOW:\n        return qemuBlockStorageSourceCreateGetFormatPropsQcow(src, backing, props);\n\n    case VIR_STORAGE_FILE_QED:\n        return qemuBlockStorageSourceCreateGetFormatPropsQed(src, backing, props);\n\n    case VIR_STORAGE_FILE_VPC:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vpc\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_PLOOP:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"parallels\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VDI:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vdi\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VHD:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vhdx\",\n                                                                 props, NULL);\n\n    case VIR_STORAGE_FILE_VMDK:\n        return qemuBlockStorageSourceCreateGetFormatPropsGeneric(src, \"vmdk\",\n                                                                 props, backing);\n\n    /* unsupported by qemu / impossible */\n    case VIR_STORAGE_FILE_FAT:\n    case VIR_STORAGE_FILE_BOCHS:\n    case VIR_STORAGE_FILE_CLOOP:\n    case VIR_STORAGE_FILE_DMG:\n    case VIR_STORAGE_FILE_COW:\n    case VIR_STORAGE_FILE_ISO:\n    case VIR_STORAGE_FILE_DIR:\n        return 0;\n\n    case VIR_STORAGE_FILE_AUTO_SAFE:\n    case VIR_STORAGE_FILE_AUTO:\n    case VIR_STORAGE_FILE_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"mishandled storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return -1;\n\n    case VIR_STORAGE_FILE_LAST:\n    default:\n        break;\n    }\n\n    virReportEnumRangeError(virStorageFileFormat, src->format);\n    return -1;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateGetFormatPropsQed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2311-2330",
    "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsQed(virStorageSourcePtr src,\n                                              virStorageSourcePtr backing,\n                                              virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qedprops = NULL;\n\n    if (virJSONValueObjectCreate(&qedprops,\n                                 \"s:driver\", \"qed\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qedprops, true) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qedprops);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&qedprops"
          ],
          "line": 2328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateAddBacking",
          "args": [
            "backing",
            "qedprops",
            "true"
          ],
          "line": 2325
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateAddBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2112-2141",
          "snippet": "static int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&qedprops",
            "\"s:driver\"",
            "\"qed\"",
            "\"s:file\"",
            "src->nodestorage",
            "\"U:size\"",
            "src->capacity",
            "NULL"
          ],
          "line": 2318
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsQed(virStorageSourcePtr src,\n                                              virStorageSourcePtr backing,\n                                              virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qedprops = NULL;\n\n    if (virJSONValueObjectCreate(&qedprops,\n                                 \"s:driver\", \"qed\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qedprops, true) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qedprops);\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateGetFormatPropsQcow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2288-2308",
    "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsQcow(virStorageSourcePtr src,\n                                               virStorageSourcePtr backing,\n                                               virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qcowprops = NULL;\n\n    if (virJSONValueObjectCreate(&qcowprops,\n                                 \"s:driver\", \"qcow\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qcowprops, false) < 0 ||\n        qemuBlockStorageSourceCreateAddEncryptionQcow(src, qcowprops) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qcowprops);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&qcowprops"
          ],
          "line": 2306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateAddEncryptionQcow",
          "args": [
            "src",
            "qcowprops"
          ],
          "line": 2303
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateAddEncryptionQcow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2230-2255",
          "snippet": "static int\nqemuBlockStorageSourceCreateAddEncryptionQcow(virStorageSourcePtr src,\n                                              virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encryptProps = NULL;\n\n    if (!src->encryption)\n        return 0;\n\n    if (src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"creation of qcow/qcow2 files supports only 'luks' encryption\"));\n        return -1;\n    }\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &encryptProps) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(encryptProps, \"s:format\", \"luks\", NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props, \"a:encrypt\", &encryptProps, NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateAddEncryptionQcow(virStorageSourcePtr src,\n                                              virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encryptProps = NULL;\n\n    if (!src->encryption)\n        return 0;\n\n    if (src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"creation of qcow/qcow2 files supports only 'luks' encryption\"));\n        return -1;\n    }\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &encryptProps) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(encryptProps, \"s:format\", \"luks\", NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props, \"a:encrypt\", &encryptProps, NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateAddBacking",
          "args": [
            "backing",
            "qcowprops",
            "false"
          ],
          "line": 2302
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateAddBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2112-2141",
          "snippet": "static int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&qcowprops",
            "\"s:driver\"",
            "\"qcow\"",
            "\"s:file\"",
            "src->nodestorage",
            "\"U:size\"",
            "src->capacity",
            "NULL"
          ],
          "line": 2295
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsQcow(virStorageSourcePtr src,\n                                               virStorageSourcePtr backing,\n                                               virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qcowprops = NULL;\n\n    if (virJSONValueObjectCreate(&qcowprops,\n                                 \"s:driver\", \"qcow\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qcowprops, false) < 0 ||\n        qemuBlockStorageSourceCreateAddEncryptionQcow(src, qcowprops) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qcowprops);\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateGetFormatPropsQcow2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2258-2285",
    "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsQcow2(virStorageSourcePtr src,\n                                                virStorageSourcePtr backing,\n                                                virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qcow2props = NULL;\n    const char *qcow2version = NULL;\n\n    if (STREQ_NULLABLE(src->compat, \"0.10\"))\n        qcow2version = \"v2\";\n    else if (STREQ_NULLABLE(src->compat, \"1.1\"))\n        qcow2version = \"v3\";\n\n    if (virJSONValueObjectCreate(&qcow2props,\n                                 \"s:driver\", \"qcow2\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 \"S:version\", qcow2version,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qcow2props, true) < 0 ||\n        qemuBlockStorageSourceCreateAddEncryptionQcow(src, qcow2props) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qcow2props);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&qcow2props"
          ],
          "line": 2283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateAddEncryptionQcow",
          "args": [
            "src",
            "qcow2props"
          ],
          "line": 2280
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateAddEncryptionQcow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2230-2255",
          "snippet": "static int\nqemuBlockStorageSourceCreateAddEncryptionQcow(virStorageSourcePtr src,\n                                              virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encryptProps = NULL;\n\n    if (!src->encryption)\n        return 0;\n\n    if (src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"creation of qcow/qcow2 files supports only 'luks' encryption\"));\n        return -1;\n    }\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &encryptProps) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(encryptProps, \"s:format\", \"luks\", NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props, \"a:encrypt\", &encryptProps, NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateAddEncryptionQcow(virStorageSourcePtr src,\n                                              virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encryptProps = NULL;\n\n    if (!src->encryption)\n        return 0;\n\n    if (src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"creation of qcow/qcow2 files supports only 'luks' encryption\"));\n        return -1;\n    }\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &encryptProps) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(encryptProps, \"s:format\", \"luks\", NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props, \"a:encrypt\", &encryptProps, NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateAddBacking",
          "args": [
            "backing",
            "qcow2props",
            "true"
          ],
          "line": 2279
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateAddBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2112-2141",
          "snippet": "static int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&qcow2props",
            "\"s:driver\"",
            "\"qcow2\"",
            "\"s:file\"",
            "src->nodestorage",
            "\"U:size\"",
            "src->capacity",
            "\"S:version\"",
            "qcow2version",
            "NULL"
          ],
          "line": 2271
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "src->compat",
            "\"1.1\""
          ],
          "line": 2268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "src->compat",
            "\"0.10\""
          ],
          "line": 2266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsQcow2(virStorageSourcePtr src,\n                                                virStorageSourcePtr backing,\n                                                virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) qcow2props = NULL;\n    const char *qcow2version = NULL;\n\n    if (STREQ_NULLABLE(src->compat, \"0.10\"))\n        qcow2version = \"v2\";\n    else if (STREQ_NULLABLE(src->compat, \"1.1\"))\n        qcow2version = \"v3\";\n\n    if (virJSONValueObjectCreate(&qcow2props,\n                                 \"s:driver\", \"qcow2\",\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 \"S:version\", qcow2version,\n                                 NULL) < 0)\n        return -1;\n\n    if (qemuBlockStorageSourceCreateAddBacking(backing, qcow2props, true) < 0 ||\n        qemuBlockStorageSourceCreateAddEncryptionQcow(src, qcow2props) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&qcow2props);\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateAddEncryptionQcow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2230-2255",
    "snippet": "static int\nqemuBlockStorageSourceCreateAddEncryptionQcow(virStorageSourcePtr src,\n                                              virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encryptProps = NULL;\n\n    if (!src->encryption)\n        return 0;\n\n    if (src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"creation of qcow/qcow2 files supports only 'luks' encryption\"));\n        return -1;\n    }\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &encryptProps) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(encryptProps, \"s:format\", \"luks\", NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props, \"a:encrypt\", &encryptProps, NULL) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "props",
            "\"a:encrypt\"",
            "&encryptProps",
            "NULL"
          ],
          "line": 2251
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGetEncryptionLUKS",
          "args": [
            "src",
            "&encryptProps"
          ],
          "line": 2245
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGetEncryptionLUKS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2168-2206",
          "snippet": "static int\nqemuBlockStorageSourceCreateGetEncryptionLUKS(virStorageSourcePtr src,\n                                              virJSONValuePtr *luksProps)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) props = NULL;\n    g_autofree char *cipheralg = NULL;\n    const char *keysecret = NULL;\n\n    if (srcpriv &&\n        srcpriv->encinfo &&\n        srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        keysecret = srcpriv->encinfo->s.aes.alias;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:key-secret\", keysecret,\n                                 NULL) < 0)\n        return -1;\n\n    if (src->encryption) {\n        if (src->encryption->encinfo.cipher_name) {\n            cipheralg = g_strdup_printf(\"%s-%u\",\n                                        src->encryption->encinfo.cipher_name,\n                                        src->encryption->encinfo.cipher_size);\n        }\n\n        if (virJSONValueObjectAdd(props,\n                                  \"S:cipher-alg\", cipheralg,\n                                  \"S:cipher-mode\", src->encryption->encinfo.cipher_mode,\n                                  \"S:hash-alg\", src->encryption->encinfo.cipher_hash,\n                                  \"S:ivgen-alg\", src->encryption->encinfo.ivgen_name,\n                                  \"S:ivgen-hash-alg\", src->encryption->encinfo.ivgen_hash,\n                                  NULL) < 0)\n            return -1;\n    }\n\n    *luksProps = g_steal_pointer(&props);\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetEncryptionLUKS(virStorageSourcePtr src,\n                                              virJSONValuePtr *luksProps)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) props = NULL;\n    g_autofree char *cipheralg = NULL;\n    const char *keysecret = NULL;\n\n    if (srcpriv &&\n        srcpriv->encinfo &&\n        srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        keysecret = srcpriv->encinfo->s.aes.alias;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:key-secret\", keysecret,\n                                 NULL) < 0)\n        return -1;\n\n    if (src->encryption) {\n        if (src->encryption->encinfo.cipher_name) {\n            cipheralg = g_strdup_printf(\"%s-%u\",\n                                        src->encryption->encinfo.cipher_name,\n                                        src->encryption->encinfo.cipher_size);\n        }\n\n        if (virJSONValueObjectAdd(props,\n                                  \"S:cipher-alg\", cipheralg,\n                                  \"S:cipher-mode\", src->encryption->encinfo.cipher_mode,\n                                  \"S:hash-alg\", src->encryption->encinfo.cipher_hash,\n                                  \"S:ivgen-alg\", src->encryption->encinfo.ivgen_name,\n                                  \"S:ivgen-hash-alg\", src->encryption->encinfo.ivgen_hash,\n                                  NULL) < 0)\n            return -1;\n    }\n\n    *luksProps = g_steal_pointer(&props);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "\"%s\"",
            "_(\"creation of qcow/qcow2 files supports only 'luks' encryption\")"
          ],
          "line": 2240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"creation of qcow/qcow2 files supports only 'luks' encryption\""
          ],
          "line": 2241
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateAddEncryptionQcow(virStorageSourcePtr src,\n                                              virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encryptProps = NULL;\n\n    if (!src->encryption)\n        return 0;\n\n    if (src->encryption->format != VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"creation of qcow/qcow2 files supports only 'luks' encryption\"));\n        return -1;\n    }\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &encryptProps) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(encryptProps, \"s:format\", \"luks\", NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props, \"a:encrypt\", &encryptProps, NULL) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateGetFormatPropsLUKS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2209-2227",
    "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsLUKS(virStorageSourcePtr src,\n                                               virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) luksprops = NULL;\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &luksprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(luksprops,\n                              \"s:driver\", \"luks\",\n                              \"s:file\", src->nodestorage,\n                              \"U:size\", src->capacity,\n                              NULL) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&luksprops);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&luksprops"
          ],
          "line": 2225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "luksprops",
            "\"s:driver\"",
            "\"luks\"",
            "\"s:file\"",
            "src->nodestorage",
            "\"U:size\"",
            "src->capacity",
            "NULL"
          ],
          "line": 2218
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateGetEncryptionLUKS",
          "args": [
            "src",
            "&luksprops"
          ],
          "line": 2215
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateGetEncryptionLUKS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2168-2206",
          "snippet": "static int\nqemuBlockStorageSourceCreateGetEncryptionLUKS(virStorageSourcePtr src,\n                                              virJSONValuePtr *luksProps)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) props = NULL;\n    g_autofree char *cipheralg = NULL;\n    const char *keysecret = NULL;\n\n    if (srcpriv &&\n        srcpriv->encinfo &&\n        srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        keysecret = srcpriv->encinfo->s.aes.alias;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:key-secret\", keysecret,\n                                 NULL) < 0)\n        return -1;\n\n    if (src->encryption) {\n        if (src->encryption->encinfo.cipher_name) {\n            cipheralg = g_strdup_printf(\"%s-%u\",\n                                        src->encryption->encinfo.cipher_name,\n                                        src->encryption->encinfo.cipher_size);\n        }\n\n        if (virJSONValueObjectAdd(props,\n                                  \"S:cipher-alg\", cipheralg,\n                                  \"S:cipher-mode\", src->encryption->encinfo.cipher_mode,\n                                  \"S:hash-alg\", src->encryption->encinfo.cipher_hash,\n                                  \"S:ivgen-alg\", src->encryption->encinfo.ivgen_name,\n                                  \"S:ivgen-hash-alg\", src->encryption->encinfo.ivgen_hash,\n                                  NULL) < 0)\n            return -1;\n    }\n\n    *luksProps = g_steal_pointer(&props);\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetEncryptionLUKS(virStorageSourcePtr src,\n                                              virJSONValuePtr *luksProps)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) props = NULL;\n    g_autofree char *cipheralg = NULL;\n    const char *keysecret = NULL;\n\n    if (srcpriv &&\n        srcpriv->encinfo &&\n        srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        keysecret = srcpriv->encinfo->s.aes.alias;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:key-secret\", keysecret,\n                                 NULL) < 0)\n        return -1;\n\n    if (src->encryption) {\n        if (src->encryption->encinfo.cipher_name) {\n            cipheralg = g_strdup_printf(\"%s-%u\",\n                                        src->encryption->encinfo.cipher_name,\n                                        src->encryption->encinfo.cipher_size);\n        }\n\n        if (virJSONValueObjectAdd(props,\n                                  \"S:cipher-alg\", cipheralg,\n                                  \"S:cipher-mode\", src->encryption->encinfo.cipher_mode,\n                                  \"S:hash-alg\", src->encryption->encinfo.cipher_hash,\n                                  \"S:ivgen-alg\", src->encryption->encinfo.ivgen_name,\n                                  \"S:ivgen-hash-alg\", src->encryption->encinfo.ivgen_hash,\n                                  NULL) < 0)\n            return -1;\n    }\n\n    *luksProps = g_steal_pointer(&props);\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsLUKS(virStorageSourcePtr src,\n                                               virJSONValuePtr *props)\n{\n    g_autoptr(virJSONValue) luksprops = NULL;\n\n    if (qemuBlockStorageSourceCreateGetEncryptionLUKS(src, &luksprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(luksprops,\n                              \"s:driver\", \"luks\",\n                              \"s:file\", src->nodestorage,\n                              \"U:size\", src->capacity,\n                              NULL) < 0)\n        return -1;\n\n    *props = g_steal_pointer(&luksprops);\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateGetEncryptionLUKS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2168-2206",
    "snippet": "static int\nqemuBlockStorageSourceCreateGetEncryptionLUKS(virStorageSourcePtr src,\n                                              virJSONValuePtr *luksProps)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) props = NULL;\n    g_autofree char *cipheralg = NULL;\n    const char *keysecret = NULL;\n\n    if (srcpriv &&\n        srcpriv->encinfo &&\n        srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        keysecret = srcpriv->encinfo->s.aes.alias;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:key-secret\", keysecret,\n                                 NULL) < 0)\n        return -1;\n\n    if (src->encryption) {\n        if (src->encryption->encinfo.cipher_name) {\n            cipheralg = g_strdup_printf(\"%s-%u\",\n                                        src->encryption->encinfo.cipher_name,\n                                        src->encryption->encinfo.cipher_size);\n        }\n\n        if (virJSONValueObjectAdd(props,\n                                  \"S:cipher-alg\", cipheralg,\n                                  \"S:cipher-mode\", src->encryption->encinfo.cipher_mode,\n                                  \"S:hash-alg\", src->encryption->encinfo.cipher_hash,\n                                  \"S:ivgen-alg\", src->encryption->encinfo.ivgen_name,\n                                  \"S:ivgen-hash-alg\", src->encryption->encinfo.ivgen_hash,\n                                  NULL) < 0)\n            return -1;\n    }\n\n    *luksProps = g_steal_pointer(&props);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&props"
          ],
          "line": 2204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "props",
            "\"S:cipher-alg\"",
            "cipheralg",
            "\"S:cipher-mode\"",
            "src->encryption->encinfo.cipher_mode",
            "\"S:hash-alg\"",
            "src->encryption->encinfo.cipher_hash",
            "\"S:ivgen-alg\"",
            "src->encryption->encinfo.ivgen_name",
            "\"S:ivgen-hash-alg\"",
            "src->encryption->encinfo.ivgen_hash",
            "NULL"
          ],
          "line": 2194
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s-%u\"",
            "src->encryption->encinfo.cipher_name",
            "src->encryption->encinfo.cipher_size"
          ],
          "line": 2189
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&props",
            "\"s:key-secret\"",
            "keysecret",
            "NULL"
          ],
          "line": 2182
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE",
          "args": [
            "src"
          ],
          "line": 2172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetEncryptionLUKS(virStorageSourcePtr src,\n                                              virJSONValuePtr *luksProps)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) props = NULL;\n    g_autofree char *cipheralg = NULL;\n    const char *keysecret = NULL;\n\n    if (srcpriv &&\n        srcpriv->encinfo &&\n        srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        keysecret = srcpriv->encinfo->s.aes.alias;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:key-secret\", keysecret,\n                                 NULL) < 0)\n        return -1;\n\n    if (src->encryption) {\n        if (src->encryption->encinfo.cipher_name) {\n            cipheralg = g_strdup_printf(\"%s-%u\",\n                                        src->encryption->encinfo.cipher_name,\n                                        src->encryption->encinfo.cipher_size);\n        }\n\n        if (virJSONValueObjectAdd(props,\n                                  \"S:cipher-alg\", cipheralg,\n                                  \"S:cipher-mode\", src->encryption->encinfo.cipher_mode,\n                                  \"S:hash-alg\", src->encryption->encinfo.cipher_hash,\n                                  \"S:ivgen-alg\", src->encryption->encinfo.ivgen_name,\n                                  \"S:ivgen-hash-alg\", src->encryption->encinfo.ivgen_hash,\n                                  NULL) < 0)\n            return -1;\n    }\n\n    *luksProps = g_steal_pointer(&props);\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateGetFormatPropsGeneric",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2144-2165",
    "snippet": "static int\nqemuBlockStorageSourceCreateGetFormatPropsGeneric(virStorageSourcePtr src,\n                                                  const char *driver,\n                                                  virJSONValuePtr *retprops,\n                                                  virStorageSourcePtr backing)\n{\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:driver\", driver,\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (backing &&\n        qemuBlockStorageSourceCreateAddBacking(backing, props, false) < 0)\n        return -1;\n\n    *retprops = g_steal_pointer(&props);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&props"
          ],
          "line": 2163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceCreateAddBacking",
          "args": [
            "backing",
            "props",
            "false"
          ],
          "line": 2160
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceCreateAddBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2112-2141",
          "snippet": "static int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&props",
            "\"s:driver\"",
            "driver",
            "\"s:file\"",
            "src->nodestorage",
            "\"U:size\"",
            "src->capacity",
            "NULL"
          ],
          "line": 2152
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateGetFormatPropsGeneric(virStorageSourcePtr src,\n                                                  const char *driver,\n                                                  virJSONValuePtr *retprops,\n                                                  virStorageSourcePtr backing)\n{\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:driver\", driver,\n                                 \"s:file\", src->nodestorage,\n                                 \"U:size\", src->capacity,\n                                 NULL) < 0)\n        return -1;\n\n    if (backing &&\n        qemuBlockStorageSourceCreateAddBacking(backing, props, false) < 0)\n        return -1;\n\n    *retprops = g_steal_pointer(&props);\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceCreateAddBacking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2112-2141",
    "snippet": "static int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "props",
            "\"S:backing-file\"",
            "backingFileStr",
            "\"S:backing-fmt\"",
            "backingFormatStr",
            "NULL"
          ],
          "line": 2134
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockGetBackingStoreString",
          "args": [
            "backing"
          ],
          "line": 2131
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockGetBackingStoreString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "2035-2109",
          "snippet": "char *\nqemuBlockGetBackingStoreString(virStorageSourcePtr src)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) backingProps = NULL;\n    g_autoptr(virJSONValue) sliceProps = NULL;\n    virJSONValuePtr props = NULL;\n    g_autoptr(virURI) uri = NULL;\n    g_autofree char *backingJSON = NULL;\n    char *ret = NULL;\n\n    if (!src->sliceStorage) {\n        if (virStorageSourceIsLocalStorage(src)) {\n            ret = g_strdup(src->path);\n            return ret;\n        }\n\n        /* generate simplified URIs for the easy cases */\n        if (actualType == VIR_STORAGE_TYPE_NETWORK &&\n            src->nhosts == 1 &&\n            src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n\n            switch ((virStorageNetProtocol) src->protocol) {\n            case VIR_STORAGE_NET_PROTOCOL_NBD:\n            case VIR_STORAGE_NET_PROTOCOL_HTTP:\n            case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n            case VIR_STORAGE_NET_PROTOCOL_FTP:\n            case VIR_STORAGE_NET_PROTOCOL_FTPS:\n            case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n                if (!(uri = qemuBlockStorageSourceGetURI(src)))\n                    return NULL;\n\n                if (!(ret = virURIFormat(uri)))\n                    return NULL;\n\n                return ret;\n\n            case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            case VIR_STORAGE_NET_PROTOCOL_RBD:\n            case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            case VIR_STORAGE_NET_PROTOCOL_SSH:\n            case VIR_STORAGE_NET_PROTOCOL_LAST:\n            case VIR_STORAGE_NET_PROTOCOL_NONE:\n                break;\n            }\n        }\n    }\n\n    /* use json: pseudo protocol otherwise */\n    if (!(backingProps = qemuBlockStorageSourceGetBackendProps(src, false, true, false)))\n        return NULL;\n\n    props = backingProps;\n\n    if (src->sliceStorage) {\n        if (virJSONValueObjectCreate(&sliceProps,\n                                     \"s:driver\", \"raw\",\n                                     \"U:offset\", src->sliceStorage->offset,\n                                     \"U:size\", src->sliceStorage->size,\n                                     \"a:file\", &backingProps,\n                                     NULL) < 0)\n            return NULL;\n\n        props = sliceProps;\n    }\n\n    if (!(backingJSON = virJSONValueToString(props, false)))\n        return NULL;\n\n    ret = g_strdup_printf(\"json:%s\", backingJSON);\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nchar *\nqemuBlockGetBackingStoreString(virStorageSourcePtr src)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) backingProps = NULL;\n    g_autoptr(virJSONValue) sliceProps = NULL;\n    virJSONValuePtr props = NULL;\n    g_autoptr(virURI) uri = NULL;\n    g_autofree char *backingJSON = NULL;\n    char *ret = NULL;\n\n    if (!src->sliceStorage) {\n        if (virStorageSourceIsLocalStorage(src)) {\n            ret = g_strdup(src->path);\n            return ret;\n        }\n\n        /* generate simplified URIs for the easy cases */\n        if (actualType == VIR_STORAGE_TYPE_NETWORK &&\n            src->nhosts == 1 &&\n            src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n\n            switch ((virStorageNetProtocol) src->protocol) {\n            case VIR_STORAGE_NET_PROTOCOL_NBD:\n            case VIR_STORAGE_NET_PROTOCOL_HTTP:\n            case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n            case VIR_STORAGE_NET_PROTOCOL_FTP:\n            case VIR_STORAGE_NET_PROTOCOL_FTPS:\n            case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n                if (!(uri = qemuBlockStorageSourceGetURI(src)))\n                    return NULL;\n\n                if (!(ret = virURIFormat(uri)))\n                    return NULL;\n\n                return ret;\n\n            case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            case VIR_STORAGE_NET_PROTOCOL_RBD:\n            case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            case VIR_STORAGE_NET_PROTOCOL_SSH:\n            case VIR_STORAGE_NET_PROTOCOL_LAST:\n            case VIR_STORAGE_NET_PROTOCOL_NONE:\n                break;\n            }\n        }\n    }\n\n    /* use json: pseudo protocol otherwise */\n    if (!(backingProps = qemuBlockStorageSourceGetBackendProps(src, false, true, false)))\n        return NULL;\n\n    props = backingProps;\n\n    if (src->sliceStorage) {\n        if (virJSONValueObjectCreate(&sliceProps,\n                                     \"s:driver\", \"raw\",\n                                     \"U:offset\", src->sliceStorage->offset,\n                                     \"U:size\", src->sliceStorage->size,\n                                     \"a:file\", &backingProps,\n                                     NULL) < 0)\n            return NULL;\n\n        props = sliceProps;\n    }\n\n    if (!(backingJSON = virJSONValueToString(props, false)))\n        return NULL;\n\n    ret = g_strdup_printf(\"json:%s\", backingJSON);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeToString",
          "args": [
            "backing->format"
          ],
          "line": 2128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBacking",
          "args": [
            "backing"
          ],
          "line": 2120
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1581-1585",
          "snippet": "bool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceCreateAddBacking(virStorageSourcePtr backing,\n                                       virJSONValuePtr props,\n                                       bool format)\n{\n    g_autofree char *backingFileStr = NULL;\n    const char *backingFormatStr = NULL;\n\n    if (!virStorageSourceIsBacking(backing))\n        return 0;\n\n    if (format) {\n        if (backing->encryption &&\n            backing->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n            backingFormatStr = \"luks\";\n        else\n            backingFormatStr = virStorageFileFormatTypeToString(backing->format);\n    }\n\n    if (!(backingFileStr = qemuBlockGetBackingStoreString(backing)))\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"S:backing-file\", backingFileStr,\n                              \"S:backing-fmt\", backingFormatStr,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockGetBackingStoreString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2035-2109",
    "snippet": "char *\nqemuBlockGetBackingStoreString(virStorageSourcePtr src)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) backingProps = NULL;\n    g_autoptr(virJSONValue) sliceProps = NULL;\n    virJSONValuePtr props = NULL;\n    g_autoptr(virURI) uri = NULL;\n    g_autofree char *backingJSON = NULL;\n    char *ret = NULL;\n\n    if (!src->sliceStorage) {\n        if (virStorageSourceIsLocalStorage(src)) {\n            ret = g_strdup(src->path);\n            return ret;\n        }\n\n        /* generate simplified URIs for the easy cases */\n        if (actualType == VIR_STORAGE_TYPE_NETWORK &&\n            src->nhosts == 1 &&\n            src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n\n            switch ((virStorageNetProtocol) src->protocol) {\n            case VIR_STORAGE_NET_PROTOCOL_NBD:\n            case VIR_STORAGE_NET_PROTOCOL_HTTP:\n            case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n            case VIR_STORAGE_NET_PROTOCOL_FTP:\n            case VIR_STORAGE_NET_PROTOCOL_FTPS:\n            case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n                if (!(uri = qemuBlockStorageSourceGetURI(src)))\n                    return NULL;\n\n                if (!(ret = virURIFormat(uri)))\n                    return NULL;\n\n                return ret;\n\n            case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            case VIR_STORAGE_NET_PROTOCOL_RBD:\n            case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            case VIR_STORAGE_NET_PROTOCOL_SSH:\n            case VIR_STORAGE_NET_PROTOCOL_LAST:\n            case VIR_STORAGE_NET_PROTOCOL_NONE:\n                break;\n            }\n        }\n    }\n\n    /* use json: pseudo protocol otherwise */\n    if (!(backingProps = qemuBlockStorageSourceGetBackendProps(src, false, true, false)))\n        return NULL;\n\n    props = backingProps;\n\n    if (src->sliceStorage) {\n        if (virJSONValueObjectCreate(&sliceProps,\n                                     \"s:driver\", \"raw\",\n                                     \"U:offset\", src->sliceStorage->offset,\n                                     \"U:size\", src->sliceStorage->size,\n                                     \"a:file\", &backingProps,\n                                     NULL) < 0)\n            return NULL;\n\n        props = sliceProps;\n    }\n\n    if (!(backingJSON = virJSONValueToString(props, false)))\n        return NULL;\n\n    ret = g_strdup_printf(\"json:%s\", backingJSON);\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"json:%s\"",
            "backingJSON"
          ],
          "line": 2106
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueToString",
          "args": [
            "props",
            "false"
          ],
          "line": 2103
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2014-2024",
          "snippet": "char *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nchar *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&sliceProps",
            "\"s:driver\"",
            "\"raw\"",
            "\"U:offset\"",
            "src->sliceStorage->offset",
            "\"U:size\"",
            "src->sliceStorage->size",
            "\"a:file\"",
            "&backingProps",
            "NULL"
          ],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBackendProps",
          "args": [
            "src",
            "false",
            "true",
            "false"
          ],
          "line": 2086
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBackendProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1055-1199",
          "snippet": "virJSONValuePtr\nqemuBlockStorageSourceGetBackendProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget,\n                                      bool autoreadonly)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) fileprops = NULL;\n    const char *driver = NULL;\n    virTristateBool aro = VIR_TRISTATE_BOOL_ABSENT;\n    virTristateBool ro = VIR_TRISTATE_BOOL_ABSENT;\n\n    if (autoreadonly) {\n        aro = VIR_TRISTATE_BOOL_YES;\n    } else {\n        if (src->readonly)\n            ro = VIR_TRISTATE_BOOL_YES;\n        else\n            ro = VIR_TRISTATE_BOOL_NO;\n    }\n\n    switch ((virStorageType)actualType) {\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_FILE:\n        if (virStorageSourceIsBlockLocal(src)) {\n            if (src->hostcdrom)\n                driver = \"host_cdrom\";\n            else\n                driver = \"host_device\";\n        } else {\n            driver = \"file\";\n        }\n\n        if (!(fileprops = qemuBlockStorageSourceGetFileProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_DIR:\n        /* qemu handles directories by exposing them as a device with emulated\n         * FAT filesystem */\n        if (!(fileprops = qemuBlockStorageSourceGetVvfatProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_NVME:\n        if (!(fileprops = qemuBlockStorageSourceGetNVMeProps(src)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_VOLUME:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage source pool '%s' volume '%s' is not translated\"),\n                       src->srcpool->pool, src->srcpool->volume);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n        virReportEnumRangeError(virStorageType, actualType);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(fileprops = qemuBlockStorageSourceGetGlusterProps(src, legacy, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            driver = \"vxhs\";\n            if (!(fileprops = qemuBlockStorageSourceGetVxHSProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            driver = virStorageNetProtocolTypeToString(src->protocol);\n            if (!(fileprops = qemuBlockStorageSourceGetCURLProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            driver = \"iscsi\";\n            if (!(fileprops = qemuBlockStorageSourceGetISCSIProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n            driver = \"nbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetNBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetRBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(fileprops = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(fileprops = qemuBlockStorageSourceGetSshProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            virReportEnumRangeError(virStorageNetProtocol, src->protocol);\n            return NULL;\n        }\n        break;\n    }\n\n    if (driver && virJSONValueObjectPrependString(fileprops, \"driver\", driver) < 0)\n        return NULL;\n\n    if (!onlytarget) {\n        if (qemuBlockNodeNameValidate(src->nodestorage) < 0 ||\n            virJSONValueObjectAdd(fileprops, \"S:node-name\", src->nodestorage, NULL) < 0)\n            return NULL;\n\n        if (!legacy) {\n            if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, fileprops) < 0)\n                return NULL;\n\n            if (virJSONValueObjectAdd(fileprops,\n                                      \"T:read-only\", ro,\n                                      \"T:auto-read-only\", aro,\n                                      \"s:discard\", \"unmap\",\n                                      NULL) < 0)\n                return NULL;\n        }\n    }\n\n    return g_steal_pointer(&fileprops);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuBlockStorageSourceGetBackendProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget,\n                                      bool autoreadonly)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) fileprops = NULL;\n    const char *driver = NULL;\n    virTristateBool aro = VIR_TRISTATE_BOOL_ABSENT;\n    virTristateBool ro = VIR_TRISTATE_BOOL_ABSENT;\n\n    if (autoreadonly) {\n        aro = VIR_TRISTATE_BOOL_YES;\n    } else {\n        if (src->readonly)\n            ro = VIR_TRISTATE_BOOL_YES;\n        else\n            ro = VIR_TRISTATE_BOOL_NO;\n    }\n\n    switch ((virStorageType)actualType) {\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_FILE:\n        if (virStorageSourceIsBlockLocal(src)) {\n            if (src->hostcdrom)\n                driver = \"host_cdrom\";\n            else\n                driver = \"host_device\";\n        } else {\n            driver = \"file\";\n        }\n\n        if (!(fileprops = qemuBlockStorageSourceGetFileProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_DIR:\n        /* qemu handles directories by exposing them as a device with emulated\n         * FAT filesystem */\n        if (!(fileprops = qemuBlockStorageSourceGetVvfatProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_NVME:\n        if (!(fileprops = qemuBlockStorageSourceGetNVMeProps(src)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_VOLUME:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage source pool '%s' volume '%s' is not translated\"),\n                       src->srcpool->pool, src->srcpool->volume);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n        virReportEnumRangeError(virStorageType, actualType);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(fileprops = qemuBlockStorageSourceGetGlusterProps(src, legacy, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            driver = \"vxhs\";\n            if (!(fileprops = qemuBlockStorageSourceGetVxHSProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            driver = virStorageNetProtocolTypeToString(src->protocol);\n            if (!(fileprops = qemuBlockStorageSourceGetCURLProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            driver = \"iscsi\";\n            if (!(fileprops = qemuBlockStorageSourceGetISCSIProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n            driver = \"nbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetNBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetRBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(fileprops = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(fileprops = qemuBlockStorageSourceGetSshProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            virReportEnumRangeError(virStorageNetProtocol, src->protocol);\n            return NULL;\n        }\n        break;\n    }\n\n    if (driver && virJSONValueObjectPrependString(fileprops, \"driver\", driver) < 0)\n        return NULL;\n\n    if (!onlytarget) {\n        if (qemuBlockNodeNameValidate(src->nodestorage) < 0 ||\n            virJSONValueObjectAdd(fileprops, \"S:node-name\", src->nodestorage, NULL) < 0)\n            return NULL;\n\n        if (!legacy) {\n            if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, fileprops) < 0)\n                return NULL;\n\n            if (virJSONValueObjectAdd(fileprops,\n                                      \"T:read-only\", ro,\n                                      \"T:auto-read-only\", aro,\n                                      \"s:discard\", \"unmap\",\n                                      NULL) < 0)\n                return NULL;\n        }\n    }\n\n    return g_steal_pointer(&fileprops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virURIFormat",
          "args": [
            "uri"
          ],
          "line": 2069
        },
        "resolved": true,
        "details": {
          "function_name": "virURIFormatParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "253-269",
          "snippet": "char *virURIFormatParams(virURIPtr uri)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n    bool amp = false;\n\n    for (i = 0; i < uri->paramsCount; ++i) {\n        if (!uri->params[i].ignore) {\n            if (amp) virBufferAddChar(&buf, '&');\n            virBufferStrcat(&buf, uri->params[i].name, \"=\", NULL);\n            virBufferURIEncodeString(&buf, uri->params[i].value);\n            amp = true;\n        }\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nchar *virURIFormatParams(virURIPtr uri)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n    bool amp = false;\n\n    for (i = 0; i < uri->paramsCount; ++i) {\n        if (!uri->params[i].ignore) {\n            if (amp) virBufferAddChar(&buf, '&');\n            virBufferStrcat(&buf, uri->params[i].name, \"=\", NULL);\n            virBufferURIEncodeString(&buf, uri->params[i].value);\n            amp = true;\n        }\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetURI",
          "args": [
            "src"
          ],
          "line": 2066
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "406-443",
          "snippet": "virURIPtr\nqemuBlockStorageSourceGetURI(virStorageSourcePtr src)\n{\n    g_autoptr(virURI) uri = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"protocol '%s' accepts only one host\"),\n                       virStorageNetProtocolTypeToString(src->protocol));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(uri) < 0)\n        return NULL;\n\n    if (src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        uri->port = src->hosts->port;\n\n        uri->scheme = g_strdup(virStorageNetProtocolTypeToString(src->protocol));\n    } else {\n        uri->scheme = g_strdup_printf(\"%s+%s\",\n                                      virStorageNetProtocolTypeToString(src->protocol),\n                                      virStorageNetHostTransportTypeToString(src->hosts->transport));\n    }\n\n    if (src->path) {\n        if (src->volume) {\n            uri->path = g_strdup_printf(\"/%s/%s\", src->volume, src->path);\n        } else {\n            uri->path = g_strdup_printf(\"%s%s\", src->path[0] == '/' ? \"\" : \"/\",\n                                        src->path);\n        }\n    }\n\n    uri->server = g_strdup(src->hosts->name);\n\n    return g_steal_pointer(&uri);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirURIPtr\nqemuBlockStorageSourceGetURI(virStorageSourcePtr src)\n{\n    g_autoptr(virURI) uri = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"protocol '%s' accepts only one host\"),\n                       virStorageNetProtocolTypeToString(src->protocol));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(uri) < 0)\n        return NULL;\n\n    if (src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        uri->port = src->hosts->port;\n\n        uri->scheme = g_strdup(virStorageNetProtocolTypeToString(src->protocol));\n    } else {\n        uri->scheme = g_strdup_printf(\"%s+%s\",\n                                      virStorageNetProtocolTypeToString(src->protocol),\n                                      virStorageNetHostTransportTypeToString(src->hosts->transport));\n    }\n\n    if (src->path) {\n        if (src->volume) {\n            uri->path = g_strdup_printf(\"/%s/%s\", src->volume, src->path);\n        } else {\n            uri->path = g_strdup_printf(\"%s%s\", src->path[0] == '/' ? \"\" : \"/\",\n                                        src->path);\n        }\n    }\n\n    uri->server = g_strdup(src->hosts->name);\n\n    return g_steal_pointer(&uri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsLocalStorage",
          "args": [
            "src"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsLocalStorage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2586-2608",
          "snippet": "bool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceGetActualType",
          "args": [
            "src"
          ],
          "line": 2038
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceGetActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2574-2583",
          "snippet": "int\nvirStorageSourceGetActualType(const virStorageSource *def)\n{\n    if (def->type == VIR_STORAGE_TYPE_VOLUME &&\n        def->srcpool &&\n        def->srcpool->actualtype != VIR_STORAGE_TYPE_NONE)\n        return def->srcpool->actualtype;\n\n    return def->type;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nint\nvirStorageSourceGetActualType(const virStorageSource *def)\n{\n    if (def->type == VIR_STORAGE_TYPE_VOLUME &&\n        def->srcpool &&\n        def->srcpool->actualtype != VIR_STORAGE_TYPE_NONE)\n        return def->srcpool->actualtype;\n\n    return def->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nchar *\nqemuBlockGetBackingStoreString(virStorageSourcePtr src)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) backingProps = NULL;\n    g_autoptr(virJSONValue) sliceProps = NULL;\n    virJSONValuePtr props = NULL;\n    g_autoptr(virURI) uri = NULL;\n    g_autofree char *backingJSON = NULL;\n    char *ret = NULL;\n\n    if (!src->sliceStorage) {\n        if (virStorageSourceIsLocalStorage(src)) {\n            ret = g_strdup(src->path);\n            return ret;\n        }\n\n        /* generate simplified URIs for the easy cases */\n        if (actualType == VIR_STORAGE_TYPE_NETWORK &&\n            src->nhosts == 1 &&\n            src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n\n            switch ((virStorageNetProtocol) src->protocol) {\n            case VIR_STORAGE_NET_PROTOCOL_NBD:\n            case VIR_STORAGE_NET_PROTOCOL_HTTP:\n            case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n            case VIR_STORAGE_NET_PROTOCOL_FTP:\n            case VIR_STORAGE_NET_PROTOCOL_FTPS:\n            case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n                if (!(uri = qemuBlockStorageSourceGetURI(src)))\n                    return NULL;\n\n                if (!(ret = virURIFormat(uri)))\n                    return NULL;\n\n                return ret;\n\n            case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            case VIR_STORAGE_NET_PROTOCOL_RBD:\n            case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            case VIR_STORAGE_NET_PROTOCOL_SSH:\n            case VIR_STORAGE_NET_PROTOCOL_LAST:\n            case VIR_STORAGE_NET_PROTOCOL_NONE:\n                break;\n            }\n        }\n    }\n\n    /* use json: pseudo protocol otherwise */\n    if (!(backingProps = qemuBlockStorageSourceGetBackendProps(src, false, true, false)))\n        return NULL;\n\n    props = backingProps;\n\n    if (src->sliceStorage) {\n        if (virJSONValueObjectCreate(&sliceProps,\n                                     \"s:driver\", \"raw\",\n                                     \"U:offset\", src->sliceStorage->offset,\n                                     \"U:size\", src->sliceStorage->size,\n                                     \"a:file\", &backingProps,\n                                     NULL) < 0)\n            return NULL;\n\n        props = sliceProps;\n    }\n\n    if (!(backingJSON = virJSONValueToString(props, false)))\n        return NULL;\n\n    ret = g_strdup_printf(\"json:%s\", backingJSON);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageGetCopyOnReadProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "2011-2024",
    "snippet": "virJSONValuePtr\nqemuBlockStorageGetCopyOnReadProps(virDomainDiskDefPtr disk)\n{\n    qemuDomainDiskPrivatePtr priv = QEMU_DOMAIN_DISK_PRIVATE(disk);\n    virJSONValuePtr ret = NULL;\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:driver\", \"copy-on-read\",\n                                          \"s:node-name\", priv->nodeCopyOnRead,\n                                          \"s:file\", disk->src->nodeformat,\n                                          NULL));\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virJSONValueObjectCreate(&ret,\n                                          \"s:driver\", \"copy-on-read\",\n                                          \"s:node-name\", priv->nodeCopyOnRead,\n                                          \"s:file\", disk->src->nodeformat,\n                                          NULL)"
          ],
          "line": 2017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"s:driver\"",
            "\"copy-on-read\"",
            "\"s:node-name\"",
            "priv->nodeCopyOnRead",
            "\"s:file\"",
            "disk->src->nodeformat",
            "NULL"
          ],
          "line": 2017
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_DISK_PRIVATE",
          "args": [
            "disk"
          ],
          "line": 2014
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuBlockStorageGetCopyOnReadProps(virDomainDiskDefPtr disk)\n{\n    qemuDomainDiskPrivatePtr priv = QEMU_DOMAIN_DISK_PRIVATE(disk);\n    virJSONValuePtr ret = NULL;\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:driver\", \"copy-on-read\",\n                                          \"s:node-name\", priv->nodeCopyOnRead,\n                                          \"s:file\", disk->src->nodeformat,\n                                          NULL));\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockSnapshotAddBlockdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1994-2002",
    "snippet": "int\nqemuBlockSnapshotAddBlockdev(virJSONValuePtr actions,\n                             virDomainDiskDefPtr disk,\n                             virStorageSourcePtr newsrc)\n{\n    return qemuMonitorTransactionSnapshotBlockdev(actions,\n                                                  disk->src->nodeformat,\n                                                  newsrc->nodeformat);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorTransactionSnapshotBlockdev",
          "args": [
            "actions",
            "disk->src->nodeformat",
            "newsrc->nodeformat"
          ],
          "line": 1999
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionSnapshotBlockdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4569-4575",
          "snippet": "int\nqemuMonitorTransactionSnapshotBlockdev(virJSONValuePtr actions,\n                                       const char *node,\n                                       const char *overlay)\n{\n    return qemuMonitorJSONTransactionSnapshotBlockdev(actions, node, overlay);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionSnapshotBlockdev(virJSONValuePtr actions,\n                                       const char *node,\n                                       const char *overlay)\n{\n    return qemuMonitorJSONTransactionSnapshotBlockdev(actions, node, overlay);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockSnapshotAddBlockdev(virJSONValuePtr actions,\n                             virDomainDiskDefPtr disk,\n                             virStorageSourcePtr newsrc)\n{\n    return qemuMonitorTransactionSnapshotBlockdev(actions,\n                                                  disk->src->nodeformat,\n                                                  newsrc->nodeformat);\n}"
  },
  {
    "function_name": "qemuBlockSnapshotAddLegacy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1974-1991",
    "snippet": "int\nqemuBlockSnapshotAddLegacy(virJSONValuePtr actions,\n                           virDomainDiskDefPtr disk,\n                           virStorageSourcePtr newsrc,\n                           bool reuse)\n{\n    const char *format = virStorageFileFormatTypeToString(newsrc->format);\n    g_autofree char *device = NULL;\n    g_autofree char *source = NULL;\n\n    if (!(device = qemuAliasDiskDriveFromDisk(disk)))\n        return -1;\n\n    if (qemuGetDriveSourceString(newsrc, NULL, &source) < 0)\n        return -1;\n\n    return qemuMonitorTransactionSnapshotLegacy(actions, device, source, format, reuse);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorTransactionSnapshotLegacy",
          "args": [
            "actions",
            "device",
            "source",
            "format",
            "reuse"
          ],
          "line": 1990
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorTransactionSnapshotLegacy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4557-4566",
          "snippet": "int\nqemuMonitorTransactionSnapshotLegacy(virJSONValuePtr actions,\n                                     const char *device,\n                                     const char *path,\n                                     const char *format,\n                                     bool existing)\n{\n    return qemuMonitorJSONTransactionSnapshotLegacy(actions, device, path,\n                                                    format, existing);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorTransactionSnapshotLegacy(virJSONValuePtr actions,\n                                     const char *device,\n                                     const char *path,\n                                     const char *format,\n                                     bool existing)\n{\n    return qemuMonitorJSONTransactionSnapshotLegacy(actions, device, path,\n                                                    format, existing);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuGetDriveSourceString",
          "args": [
            "newsrc",
            "NULL",
            "&source"
          ],
          "line": 1987
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetDriveSourceString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_command.c",
          "lines": "1104-1138",
          "snippet": "int\nqemuGetDriveSourceString(virStorageSourcePtr src,\n                         qemuDomainSecretInfoPtr secinfo,\n                         char **source)\n{\n    int actualType = virStorageSourceGetActualType(src);\n\n    *source = NULL;\n\n    /* return 1 for empty sources */\n    if (virStorageSourceIsEmpty(src))\n        return 1;\n\n    switch ((virStorageType)actualType) {\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_DIR:\n        *source = g_strdup(src->path);\n\n        break;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        if (!(*source = qemuBuildNetworkDriveStr(src, secinfo)))\n            return -1;\n        break;\n\n    case VIR_STORAGE_TYPE_VOLUME:\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n        break;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include \"virutil.h\"",
            "#include \"logging/log_manager.h\"",
            "# include <linux/capability.h>",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virgic.h\"",
            "#include \"virnuma.h\"",
            "#include \"virscsi.h\"",
            "#include \"virtpm.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"device_conf.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"secret_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_addr.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virqemu.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virarch.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_interface.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_command.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virutil.h\"\n#include \"logging/log_manager.h\"\n# include <linux/capability.h>\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virgic.h\"\n#include \"virnuma.h\"\n#include \"virscsi.h\"\n#include \"virtpm.h\"\n#include \"virstoragefile.h\"\n#include \"device_conf.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"secret_conf.h\"\n#include \"storage_conf.h\"\n#include \"snapshot_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_audit.h\"\n#include \"domain_addr.h\"\n#include \"domain_nwfilter.h\"\n#include \"viruuid.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virqemu.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virarch.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"cpu/cpu.h\"\n#include \"qemu_block.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_interface.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_command.h\"\n#include <config.h>\n\nint\nqemuGetDriveSourceString(virStorageSourcePtr src,\n                         qemuDomainSecretInfoPtr secinfo,\n                         char **source)\n{\n    int actualType = virStorageSourceGetActualType(src);\n\n    *source = NULL;\n\n    /* return 1 for empty sources */\n    if (virStorageSourceIsEmpty(src))\n        return 1;\n\n    switch ((virStorageType)actualType) {\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_DIR:\n        *source = g_strdup(src->path);\n\n        break;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        if (!(*source = qemuBuildNetworkDriveStr(src, secinfo)))\n            return -1;\n        break;\n\n    case VIR_STORAGE_TYPE_VOLUME:\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n        break;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAliasDiskDriveFromDisk",
          "args": [
            "disk"
          ],
          "line": 1984
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAliasDiskDriveFromDisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "696-709",
          "snippet": "char *\nqemuAliasDiskDriveFromDisk(const virDomainDiskDef *disk)\n{\n    char *ret;\n\n    if (!disk->info.alias) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"disk does not have an alias\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%s%s\", QEMU_DRIVE_HOST_PREFIX, disk->info.alias);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define QEMU_DRIVE_HOST_PREFIX \"drive-\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\n#define QEMU_DRIVE_HOST_PREFIX \"drive-\"\n\nchar *\nqemuAliasDiskDriveFromDisk(const virDomainDiskDef *disk)\n{\n    char *ret;\n\n    if (!disk->info.alias) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"disk does not have an alias\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%s%s\", QEMU_DRIVE_HOST_PREFIX, disk->info.alias);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeToString",
          "args": [
            "newsrc->format"
          ],
          "line": 1980
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockSnapshotAddLegacy(virJSONValuePtr actions,\n                           virDomainDiskDefPtr disk,\n                           virStorageSourcePtr newsrc,\n                           bool reuse)\n{\n    const char *format = virStorageFileFormatTypeToString(newsrc->format);\n    g_autofree char *device = NULL;\n    g_autofree char *source = NULL;\n\n    if (!(device = qemuAliasDiskDriveFromDisk(disk)))\n        return -1;\n\n    if (qemuGetDriveSourceString(newsrc, NULL, &source) < 0)\n        return -1;\n\n    return qemuMonitorTransactionSnapshotLegacy(actions, device, source, format, reuse);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceDetachOneBlockdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1951-1971",
    "snippet": "int\nqemuBlockStorageSourceDetachOneBlockdev(virQEMUDriverPtr driver,\n                                        virDomainObjPtr vm,\n                                        qemuDomainAsyncJob asyncJob,\n                                        virStorageSourcePtr src)\n{\n    int ret;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    ret = qemuMonitorBlockdevDel(qemuDomainGetMonitor(vm), src->nodeformat);\n\n    if (ret == 0)\n        ret = qemuMonitorBlockdevDel(qemuDomainGetMonitor(vm), src->nodestorage);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0)\n        return -1;\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuDomainObjExitMonitor",
          "args": [
            "driver",
            "vm"
          ],
          "line": 1967
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjExitMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10189-10200",
          "snippet": "int qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\n\nint qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorBlockdevDel",
          "args": [
            "qemuDomainGetMonitor(vm)",
            "src->nodestorage"
          ],
          "line": 1965
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorBlockdevDel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4370-4379",
          "snippet": "int\nqemuMonitorBlockdevDel(qemuMonitorPtr mon,\n                       const char *nodename)\n{\n    VIR_DEBUG(\"nodename=%s\", nodename);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevDel(mon, nodename);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorBlockdevDel(qemuMonitorPtr mon,\n                       const char *nodename)\n{\n    VIR_DEBUG(\"nodename=%s\", nodename);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevDel(mon, nodename);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainGetMonitor",
          "args": [
            "vm"
          ],
          "line": 1965
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainGetMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "12703-12707",
          "snippet": "qemuMonitorPtr\nqemuDomainGetMonitor(virDomainObjPtr vm)\n{\n    return ((qemuDomainObjPrivatePtr) vm->privateData)->mon;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nqemuMonitorPtr\nqemuDomainGetMonitor(virDomainObjPtr vm)\n{\n    return ((qemuDomainObjPrivatePtr) vm->privateData)->mon;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjEnterMonitorAsync",
          "args": [
            "driver",
            "vm",
            "asyncJob"
          ],
          "line": 1959
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjEnterMonitorAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10216-10222",
          "snippet": "int\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);",
            "qemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\nqemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));\n\nint\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceDetachOneBlockdev(virQEMUDriverPtr driver,\n                                        virDomainObjPtr vm,\n                                        qemuDomainAsyncJob asyncJob,\n                                        virStorageSourcePtr src)\n{\n    int ret;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    ret = qemuMonitorBlockdevDel(qemuDomainGetMonitor(vm), src->nodeformat);\n\n    if (ret == 0)\n        ret = qemuMonitorBlockdevDel(qemuDomainGetMonitor(vm), src->nodestorage);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0)\n        return -1;\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceChainDetach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1929-1937",
    "snippet": "void\nqemuBlockStorageSourceChainDetach(qemuMonitorPtr mon,\n                                  qemuBlockStorageSourceChainDataPtr data)\n{\n    size_t i;\n\n    for (i = 0; i < data->nsrcdata; i++)\n        qemuBlockStorageSourceAttachRollback(mon, data->srcdata[i]);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachRollback",
          "args": [
            "mon",
            "data->srcdata[i]"
          ],
          "line": 1936
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachRollback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1724-1764",
          "snippet": "void\nqemuBlockStorageSourceAttachRollback(qemuMonitorPtr mon,\n                                     qemuBlockStorageSourceAttachDataPtr data)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (data->driveAdded) {\n        if (qemuMonitorDriveDel(mon, data->driveAlias) < 0)\n            VIR_WARN(\"Unable to remove drive %s (%s) after failed \"\n                     \"qemuMonitorAddDevice\", data->driveAlias, data->driveCmd);\n    }\n\n    if (data->formatAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->formatNodeName));\n\n    if (data->storageSliceAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageSliceNodeName));\n\n    if (data->storageAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageNodeName));\n\n    if (data->prmgrAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->prmgrAlias, false));\n\n    if (data->authsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->authsecretAlias, false));\n\n    if (data->encryptsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->encryptsecretAlias, false));\n\n    if (data->httpcookiesecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->httpcookiesecretAlias, false));\n\n    if (data->tlsAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->tlsAlias, false));\n\n\n    virErrorRestore(&orig_err);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvoid\nqemuBlockStorageSourceAttachRollback(qemuMonitorPtr mon,\n                                     qemuBlockStorageSourceAttachDataPtr data)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (data->driveAdded) {\n        if (qemuMonitorDriveDel(mon, data->driveAlias) < 0)\n            VIR_WARN(\"Unable to remove drive %s (%s) after failed \"\n                     \"qemuMonitorAddDevice\", data->driveAlias, data->driveCmd);\n    }\n\n    if (data->formatAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->formatNodeName));\n\n    if (data->storageSliceAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageSliceNodeName));\n\n    if (data->storageAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageNodeName));\n\n    if (data->prmgrAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->prmgrAlias, false));\n\n    if (data->authsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->authsecretAlias, false));\n\n    if (data->encryptsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->encryptsecretAlias, false));\n\n    if (data->httpcookiesecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->httpcookiesecretAlias, false));\n\n    if (data->tlsAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->tlsAlias, false));\n\n\n    virErrorRestore(&orig_err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvoid\nqemuBlockStorageSourceChainDetach(qemuMonitorPtr mon,\n                                  qemuBlockStorageSourceChainDataPtr data)\n{\n    size_t i;\n\n    for (i = 0; i < data->nsrcdata; i++)\n        qemuBlockStorageSourceAttachRollback(mon, data->srcdata[i]);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceChainAttach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1906-1918",
    "snippet": "int\nqemuBlockStorageSourceChainAttach(qemuMonitorPtr mon,\n                                  qemuBlockStorageSourceChainDataPtr data)\n{\n    size_t i;\n\n    for (i = data->nsrcdata; i > 0; i--) {\n        if (qemuBlockStorageSourceAttachApply(mon, data->srcdata[i - 1]) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachApply",
          "args": [
            "mon",
            "data->srcdata[i - 1]"
          ],
          "line": 1913
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachApply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1692-1711",
          "snippet": "int\nqemuBlockStorageSourceAttachApply(qemuMonitorPtr mon,\n                                  qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (qemuBlockStorageSourceAttachApplyStorageDeps(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyStorage(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyStorageSlice(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyFormatDeps(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyFormat(mon, data) < 0)\n        return -1;\n\n    if (data->driveCmd) {\n        if (qemuMonitorAddDrive(mon, data->driveCmd) < 0)\n            return -1;\n\n        data->driveAdded = true;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceAttachApply(qemuMonitorPtr mon,\n                                  qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (qemuBlockStorageSourceAttachApplyStorageDeps(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyStorage(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyStorageSlice(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyFormatDeps(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyFormat(mon, data) < 0)\n        return -1;\n\n    if (data->driveCmd) {\n        if (qemuMonitorAddDrive(mon, data->driveCmd) < 0)\n            return -1;\n\n        data->driveAdded = true;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceChainAttach(qemuMonitorPtr mon,\n                                  qemuBlockStorageSourceChainDataPtr data)\n{\n    size_t i;\n\n    for (i = data->nsrcdata; i > 0; i--) {\n        if (qemuBlockStorageSourceAttachApply(mon, data->srcdata[i - 1]) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceChainDetachPrepareDrive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1876-1893",
    "snippet": "qemuBlockStorageSourceChainDataPtr\nqemuBlockStorageSourceChainDetachPrepareDrive(virStorageSourcePtr src,\n                                              char *driveAlias)\n{\n    g_autoptr(qemuBlockStorageSourceAttachData) backend = NULL;\n    g_autoptr(qemuBlockStorageSourceChainData) data = NULL;\n\n    if (VIR_ALLOC(data) < 0)\n        return NULL;\n\n    if (!(backend = qemuBlockStorageSourceDetachPrepare(src, driveAlias)))\n        return NULL;\n\n    if (VIR_APPEND_ELEMENT(data->srcdata, data->nsrcdata, backend) < 0)\n        return NULL;\n\n    return g_steal_pointer(&data);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&data"
          ],
          "line": 1892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "data->srcdata",
            "data->nsrcdata",
            "backend"
          ],
          "line": 1889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceDetachPrepare",
          "args": [
            "src",
            "driveAlias"
          ],
          "line": 1886
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceDetachPrepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1775-1820",
          "snippet": "qemuBlockStorageSourceAttachDataPtr\nqemuBlockStorageSourceDetachPrepare(virStorageSourcePtr src,\n                                    char *driveAlias)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(qemuBlockStorageSourceAttachData) data = NULL;\n\n    data = g_new0(qemuBlockStorageSourceAttachData, 1);\n\n    if (driveAlias) {\n        data->driveAlias = g_steal_pointer(&driveAlias);\n        data->driveAdded = true;\n    } else {\n        data->formatNodeName = src->nodeformat;\n        data->formatAttached = true;\n        data->storageNodeName = src->nodestorage;\n        data->storageAttached = true;\n\n        /* 'raw' format doesn't need the extra 'raw' layer when slicing, thus\n         * the nodename is NULL */\n        if (src->sliceStorage &&\n            src->sliceStorage->nodename) {\n            data->storageSliceNodeName = src->sliceStorage->nodename;\n            data->storageSliceAttached = true;\n        }\n    }\n\n    if (src->pr &&\n        !virStoragePRDefIsManaged(src->pr))\n        data->prmgrAlias = g_strdup(src->pr->mgralias);\n\n    data->tlsAlias = g_strdup(src->tlsAlias);\n\n    if (srcpriv) {\n        if (srcpriv->secinfo && srcpriv->secinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->authsecretAlias = g_strdup(srcpriv->secinfo->s.aes.alias);\n\n        if (srcpriv->encinfo && srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->encryptsecretAlias = g_strdup(srcpriv->encinfo->s.aes.alias);\n\n        if (srcpriv->httpcookie)\n            data->httpcookiesecretAlias = g_strdup(srcpriv->httpcookie->s.aes.alias);\n    }\n\n    return g_steal_pointer(&data);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nqemuBlockStorageSourceAttachDataPtr\nqemuBlockStorageSourceDetachPrepare(virStorageSourcePtr src,\n                                    char *driveAlias)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(qemuBlockStorageSourceAttachData) data = NULL;\n\n    data = g_new0(qemuBlockStorageSourceAttachData, 1);\n\n    if (driveAlias) {\n        data->driveAlias = g_steal_pointer(&driveAlias);\n        data->driveAdded = true;\n    } else {\n        data->formatNodeName = src->nodeformat;\n        data->formatAttached = true;\n        data->storageNodeName = src->nodestorage;\n        data->storageAttached = true;\n\n        /* 'raw' format doesn't need the extra 'raw' layer when slicing, thus\n         * the nodename is NULL */\n        if (src->sliceStorage &&\n            src->sliceStorage->nodename) {\n            data->storageSliceNodeName = src->sliceStorage->nodename;\n            data->storageSliceAttached = true;\n        }\n    }\n\n    if (src->pr &&\n        !virStoragePRDefIsManaged(src->pr))\n        data->prmgrAlias = g_strdup(src->pr->mgralias);\n\n    data->tlsAlias = g_strdup(src->tlsAlias);\n\n    if (srcpriv) {\n        if (srcpriv->secinfo && srcpriv->secinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->authsecretAlias = g_strdup(srcpriv->secinfo->s.aes.alias);\n\n        if (srcpriv->encinfo && srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->encryptsecretAlias = g_strdup(srcpriv->encinfo->s.aes.alias);\n\n        if (srcpriv->httpcookie)\n            data->httpcookiesecretAlias = g_strdup(srcpriv->httpcookie->s.aes.alias);\n    }\n\n    return g_steal_pointer(&data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "data"
          ],
          "line": 1883
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nqemuBlockStorageSourceChainDataPtr\nqemuBlockStorageSourceChainDetachPrepareDrive(virStorageSourcePtr src,\n                                              char *driveAlias)\n{\n    g_autoptr(qemuBlockStorageSourceAttachData) backend = NULL;\n    g_autoptr(qemuBlockStorageSourceChainData) data = NULL;\n\n    if (VIR_ALLOC(data) < 0)\n        return NULL;\n\n    if (!(backend = qemuBlockStorageSourceDetachPrepare(src, driveAlias)))\n        return NULL;\n\n    if (VIR_APPEND_ELEMENT(data->srcdata, data->nsrcdata, backend) < 0)\n        return NULL;\n\n    return g_steal_pointer(&data);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceChainDetachPrepareBlockdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1846-1865",
    "snippet": "qemuBlockStorageSourceChainDataPtr\nqemuBlockStorageSourceChainDetachPrepareBlockdev(virStorageSourcePtr src)\n{\n    g_autoptr(qemuBlockStorageSourceAttachData) backend = NULL;\n    g_autoptr(qemuBlockStorageSourceChainData) data = NULL;\n    virStorageSourcePtr n;\n\n    if (VIR_ALLOC(data) < 0)\n        return NULL;\n\n    for (n = src; virStorageSourceIsBacking(n); n = n->backingStore) {\n        if (!(backend = qemuBlockStorageSourceDetachPrepare(n, NULL)))\n            return NULL;\n\n        if (VIR_APPEND_ELEMENT(data->srcdata, data->nsrcdata, backend) < 0)\n            return NULL;\n    }\n\n    return g_steal_pointer(&data);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&data"
          ],
          "line": 1864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "data->srcdata",
            "data->nsrcdata",
            "backend"
          ],
          "line": 1860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceDetachPrepare",
          "args": [
            "n",
            "NULL"
          ],
          "line": 1857
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceDetachPrepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1775-1820",
          "snippet": "qemuBlockStorageSourceAttachDataPtr\nqemuBlockStorageSourceDetachPrepare(virStorageSourcePtr src,\n                                    char *driveAlias)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(qemuBlockStorageSourceAttachData) data = NULL;\n\n    data = g_new0(qemuBlockStorageSourceAttachData, 1);\n\n    if (driveAlias) {\n        data->driveAlias = g_steal_pointer(&driveAlias);\n        data->driveAdded = true;\n    } else {\n        data->formatNodeName = src->nodeformat;\n        data->formatAttached = true;\n        data->storageNodeName = src->nodestorage;\n        data->storageAttached = true;\n\n        /* 'raw' format doesn't need the extra 'raw' layer when slicing, thus\n         * the nodename is NULL */\n        if (src->sliceStorage &&\n            src->sliceStorage->nodename) {\n            data->storageSliceNodeName = src->sliceStorage->nodename;\n            data->storageSliceAttached = true;\n        }\n    }\n\n    if (src->pr &&\n        !virStoragePRDefIsManaged(src->pr))\n        data->prmgrAlias = g_strdup(src->pr->mgralias);\n\n    data->tlsAlias = g_strdup(src->tlsAlias);\n\n    if (srcpriv) {\n        if (srcpriv->secinfo && srcpriv->secinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->authsecretAlias = g_strdup(srcpriv->secinfo->s.aes.alias);\n\n        if (srcpriv->encinfo && srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->encryptsecretAlias = g_strdup(srcpriv->encinfo->s.aes.alias);\n\n        if (srcpriv->httpcookie)\n            data->httpcookiesecretAlias = g_strdup(srcpriv->httpcookie->s.aes.alias);\n    }\n\n    return g_steal_pointer(&data);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nqemuBlockStorageSourceAttachDataPtr\nqemuBlockStorageSourceDetachPrepare(virStorageSourcePtr src,\n                                    char *driveAlias)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(qemuBlockStorageSourceAttachData) data = NULL;\n\n    data = g_new0(qemuBlockStorageSourceAttachData, 1);\n\n    if (driveAlias) {\n        data->driveAlias = g_steal_pointer(&driveAlias);\n        data->driveAdded = true;\n    } else {\n        data->formatNodeName = src->nodeformat;\n        data->formatAttached = true;\n        data->storageNodeName = src->nodestorage;\n        data->storageAttached = true;\n\n        /* 'raw' format doesn't need the extra 'raw' layer when slicing, thus\n         * the nodename is NULL */\n        if (src->sliceStorage &&\n            src->sliceStorage->nodename) {\n            data->storageSliceNodeName = src->sliceStorage->nodename;\n            data->storageSliceAttached = true;\n        }\n    }\n\n    if (src->pr &&\n        !virStoragePRDefIsManaged(src->pr))\n        data->prmgrAlias = g_strdup(src->pr->mgralias);\n\n    data->tlsAlias = g_strdup(src->tlsAlias);\n\n    if (srcpriv) {\n        if (srcpriv->secinfo && srcpriv->secinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->authsecretAlias = g_strdup(srcpriv->secinfo->s.aes.alias);\n\n        if (srcpriv->encinfo && srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->encryptsecretAlias = g_strdup(srcpriv->encinfo->s.aes.alias);\n\n        if (srcpriv->httpcookie)\n            data->httpcookiesecretAlias = g_strdup(srcpriv->httpcookie->s.aes.alias);\n    }\n\n    return g_steal_pointer(&data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBacking",
          "args": [
            "n"
          ],
          "line": 1856
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1581-1585",
          "snippet": "bool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "data"
          ],
          "line": 1853
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nqemuBlockStorageSourceChainDataPtr\nqemuBlockStorageSourceChainDetachPrepareBlockdev(virStorageSourcePtr src)\n{\n    g_autoptr(qemuBlockStorageSourceAttachData) backend = NULL;\n    g_autoptr(qemuBlockStorageSourceChainData) data = NULL;\n    virStorageSourcePtr n;\n\n    if (VIR_ALLOC(data) < 0)\n        return NULL;\n\n    for (n = src; virStorageSourceIsBacking(n); n = n->backingStore) {\n        if (!(backend = qemuBlockStorageSourceDetachPrepare(n, NULL)))\n            return NULL;\n\n        if (VIR_APPEND_ELEMENT(data->srcdata, data->nsrcdata, backend) < 0)\n            return NULL;\n    }\n\n    return g_steal_pointer(&data);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceChainDataFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1823-1836",
    "snippet": "void\nqemuBlockStorageSourceChainDataFree(qemuBlockStorageSourceChainDataPtr data)\n{\n    size_t i;\n\n    if (!data)\n        return;\n\n    for (i = 0; i < data->nsrcdata; i++)\n        qemuBlockStorageSourceAttachDataFree(data->srcdata[i]);\n\n    VIR_FREE(data->srcdata);\n    VIR_FREE(data);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data"
          ],
          "line": 1835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->srcdata"
          ],
          "line": 1834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachDataFree",
          "args": [
            "data->srcdata[i]"
          ],
          "line": 1832
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1524-1545",
          "snippet": "void\nqemuBlockStorageSourceAttachDataFree(qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (!data)\n        return;\n\n    virJSONValueFree(data->storageProps);\n    virJSONValueFree(data->storageSliceProps);\n    virJSONValueFree(data->formatProps);\n    virJSONValueFree(data->prmgrProps);\n    virJSONValueFree(data->authsecretProps);\n    virJSONValueFree(data->httpcookiesecretProps);\n    virJSONValueFree(data->encryptsecretProps);\n    virJSONValueFree(data->tlsProps);\n    VIR_FREE(data->tlsAlias);\n    VIR_FREE(data->authsecretAlias);\n    VIR_FREE(data->encryptsecretAlias);\n    VIR_FREE(data->httpcookiesecretAlias);\n    VIR_FREE(data->driveCmd);\n    VIR_FREE(data->driveAlias);\n    VIR_FREE(data);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvoid\nqemuBlockStorageSourceAttachDataFree(qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (!data)\n        return;\n\n    virJSONValueFree(data->storageProps);\n    virJSONValueFree(data->storageSliceProps);\n    virJSONValueFree(data->formatProps);\n    virJSONValueFree(data->prmgrProps);\n    virJSONValueFree(data->authsecretProps);\n    virJSONValueFree(data->httpcookiesecretProps);\n    virJSONValueFree(data->encryptsecretProps);\n    virJSONValueFree(data->tlsProps);\n    VIR_FREE(data->tlsAlias);\n    VIR_FREE(data->authsecretAlias);\n    VIR_FREE(data->encryptsecretAlias);\n    VIR_FREE(data->httpcookiesecretAlias);\n    VIR_FREE(data->driveCmd);\n    VIR_FREE(data->driveAlias);\n    VIR_FREE(data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvoid\nqemuBlockStorageSourceChainDataFree(qemuBlockStorageSourceChainDataPtr data)\n{\n    size_t i;\n\n    if (!data)\n        return;\n\n    for (i = 0; i < data->nsrcdata; i++)\n        qemuBlockStorageSourceAttachDataFree(data->srcdata[i]);\n\n    VIR_FREE(data->srcdata);\n    VIR_FREE(data);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceDetachPrepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1775-1820",
    "snippet": "qemuBlockStorageSourceAttachDataPtr\nqemuBlockStorageSourceDetachPrepare(virStorageSourcePtr src,\n                                    char *driveAlias)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(qemuBlockStorageSourceAttachData) data = NULL;\n\n    data = g_new0(qemuBlockStorageSourceAttachData, 1);\n\n    if (driveAlias) {\n        data->driveAlias = g_steal_pointer(&driveAlias);\n        data->driveAdded = true;\n    } else {\n        data->formatNodeName = src->nodeformat;\n        data->formatAttached = true;\n        data->storageNodeName = src->nodestorage;\n        data->storageAttached = true;\n\n        /* 'raw' format doesn't need the extra 'raw' layer when slicing, thus\n         * the nodename is NULL */\n        if (src->sliceStorage &&\n            src->sliceStorage->nodename) {\n            data->storageSliceNodeName = src->sliceStorage->nodename;\n            data->storageSliceAttached = true;\n        }\n    }\n\n    if (src->pr &&\n        !virStoragePRDefIsManaged(src->pr))\n        data->prmgrAlias = g_strdup(src->pr->mgralias);\n\n    data->tlsAlias = g_strdup(src->tlsAlias);\n\n    if (srcpriv) {\n        if (srcpriv->secinfo && srcpriv->secinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->authsecretAlias = g_strdup(srcpriv->secinfo->s.aes.alias);\n\n        if (srcpriv->encinfo && srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->encryptsecretAlias = g_strdup(srcpriv->encinfo->s.aes.alias);\n\n        if (srcpriv->httpcookie)\n            data->httpcookiesecretAlias = g_strdup(srcpriv->httpcookie->s.aes.alias);\n    }\n\n    return g_steal_pointer(&data);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&data"
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "srcpriv->httpcookie->s.aes.alias"
          ],
          "line": 1816
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePRDefIsManaged",
          "args": [
            "src->pr"
          ],
          "line": 1803
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePRDefIsManaged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2006-2010",
          "snippet": "bool\nvirStoragePRDefIsManaged(virStoragePRDefPtr prd)\n{\n    return prd && prd->managed == VIR_TRISTATE_BOOL_YES;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStoragePRDefIsManaged(virStoragePRDefPtr prd)\n{\n    return prd && prd->managed == VIR_TRISTATE_BOOL_YES;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&driveAlias"
          ],
          "line": 1785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "qemuBlockStorageSourceAttachData",
            "1"
          ],
          "line": 1782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE",
          "args": [
            "src"
          ],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nqemuBlockStorageSourceAttachDataPtr\nqemuBlockStorageSourceDetachPrepare(virStorageSourcePtr src,\n                                    char *driveAlias)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(qemuBlockStorageSourceAttachData) data = NULL;\n\n    data = g_new0(qemuBlockStorageSourceAttachData, 1);\n\n    if (driveAlias) {\n        data->driveAlias = g_steal_pointer(&driveAlias);\n        data->driveAdded = true;\n    } else {\n        data->formatNodeName = src->nodeformat;\n        data->formatAttached = true;\n        data->storageNodeName = src->nodestorage;\n        data->storageAttached = true;\n\n        /* 'raw' format doesn't need the extra 'raw' layer when slicing, thus\n         * the nodename is NULL */\n        if (src->sliceStorage &&\n            src->sliceStorage->nodename) {\n            data->storageSliceNodeName = src->sliceStorage->nodename;\n            data->storageSliceAttached = true;\n        }\n    }\n\n    if (src->pr &&\n        !virStoragePRDefIsManaged(src->pr))\n        data->prmgrAlias = g_strdup(src->pr->mgralias);\n\n    data->tlsAlias = g_strdup(src->tlsAlias);\n\n    if (srcpriv) {\n        if (srcpriv->secinfo && srcpriv->secinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->authsecretAlias = g_strdup(srcpriv->secinfo->s.aes.alias);\n\n        if (srcpriv->encinfo && srcpriv->encinfo->type == VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n            data->encryptsecretAlias = g_strdup(srcpriv->encinfo->s.aes.alias);\n\n        if (srcpriv->httpcookie)\n            data->httpcookiesecretAlias = g_strdup(srcpriv->httpcookie->s.aes.alias);\n    }\n\n    return g_steal_pointer(&data);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceAttachRollback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1724-1764",
    "snippet": "void\nqemuBlockStorageSourceAttachRollback(qemuMonitorPtr mon,\n                                     qemuBlockStorageSourceAttachDataPtr data)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (data->driveAdded) {\n        if (qemuMonitorDriveDel(mon, data->driveAlias) < 0)\n            VIR_WARN(\"Unable to remove drive %s (%s) after failed \"\n                     \"qemuMonitorAddDevice\", data->driveAlias, data->driveCmd);\n    }\n\n    if (data->formatAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->formatNodeName));\n\n    if (data->storageSliceAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageSliceNodeName));\n\n    if (data->storageAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageNodeName));\n\n    if (data->prmgrAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->prmgrAlias, false));\n\n    if (data->authsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->authsecretAlias, false));\n\n    if (data->encryptsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->encryptsecretAlias, false));\n\n    if (data->httpcookiesecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->httpcookiesecretAlias, false));\n\n    if (data->tlsAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->tlsAlias, false));\n\n\n    virErrorRestore(&orig_err);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&orig_err"
          ],
          "line": 1763
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "qemuMonitorDelObject(mon, data->tlsAlias, false)"
          ],
          "line": 1760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMonitorDelObject",
          "args": [
            "mon",
            "data->tlsAlias",
            "false"
          ],
          "line": 1760
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorDelObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2967-2977",
          "snippet": "int\nqemuMonitorDelObject(qemuMonitorPtr mon,\n                     const char *objalias,\n                     bool report_error)\n{\n    VIR_DEBUG(\"objalias=%s\", objalias);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONDelObject(mon, objalias, report_error);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorDelObject(qemuMonitorPtr mon,\n                     const char *objalias,\n                     bool report_error)\n{\n    VIR_DEBUG(\"objalias=%s\", objalias);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONDelObject(mon, objalias, report_error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "qemuMonitorDelObject(mon, data->httpcookiesecretAlias, false)"
          ],
          "line": 1757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "qemuMonitorDelObject(mon, data->encryptsecretAlias, false)"
          ],
          "line": 1754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "qemuMonitorDelObject(mon, data->authsecretAlias, false)"
          ],
          "line": 1751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "qemuMonitorDelObject(mon, data->prmgrAlias, false)"
          ],
          "line": 1748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "qemuMonitorBlockdevDel(mon, data->storageNodeName)"
          ],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMonitorBlockdevDel",
          "args": [
            "mon",
            "data->storageNodeName"
          ],
          "line": 1745
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorBlockdevDel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4370-4379",
          "snippet": "int\nqemuMonitorBlockdevDel(qemuMonitorPtr mon,\n                       const char *nodename)\n{\n    VIR_DEBUG(\"nodename=%s\", nodename);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevDel(mon, nodename);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorBlockdevDel(qemuMonitorPtr mon,\n                       const char *nodename)\n{\n    VIR_DEBUG(\"nodename=%s\", nodename);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevDel(mon, nodename);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "qemuMonitorBlockdevDel(mon, data->storageSliceNodeName)"
          ],
          "line": 1742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "qemuMonitorBlockdevDel(mon, data->formatNodeName)"
          ],
          "line": 1739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to remove drive %s (%s) after failed \"\n                     \"qemuMonitorAddDevice\"",
            "data->driveAlias",
            "data->driveCmd"
          ],
          "line": 1734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMonitorDriveDel",
          "args": [
            "mon",
            "data->driveAlias"
          ],
          "line": 1733
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorDriveDel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2768-2778",
          "snippet": "int\nqemuMonitorDriveDel(qemuMonitorPtr mon,\n                    const char *drivestr)\n{\n    VIR_DEBUG(\"drivestr=%s\", drivestr);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    /* there won't be a direct replacement for drive_del in QMP */\n    return qemuMonitorTextDriveDel(mon, drivestr);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorDriveDel(qemuMonitorPtr mon,\n                    const char *drivestr)\n{\n    VIR_DEBUG(\"drivestr=%s\", drivestr);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    /* there won't be a direct replacement for drive_del in QMP */\n    return qemuMonitorTextDriveDel(mon, drivestr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&orig_err"
          ],
          "line": 1730
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvoid\nqemuBlockStorageSourceAttachRollback(qemuMonitorPtr mon,\n                                     qemuBlockStorageSourceAttachDataPtr data)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (data->driveAdded) {\n        if (qemuMonitorDriveDel(mon, data->driveAlias) < 0)\n            VIR_WARN(\"Unable to remove drive %s (%s) after failed \"\n                     \"qemuMonitorAddDevice\", data->driveAlias, data->driveCmd);\n    }\n\n    if (data->formatAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->formatNodeName));\n\n    if (data->storageSliceAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageSliceNodeName));\n\n    if (data->storageAttached)\n        ignore_value(qemuMonitorBlockdevDel(mon, data->storageNodeName));\n\n    if (data->prmgrAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->prmgrAlias, false));\n\n    if (data->authsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->authsecretAlias, false));\n\n    if (data->encryptsecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->encryptsecretAlias, false));\n\n    if (data->httpcookiesecretAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->httpcookiesecretAlias, false));\n\n    if (data->tlsAlias)\n        ignore_value(qemuMonitorDelObject(mon, data->tlsAlias, false));\n\n\n    virErrorRestore(&orig_err);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceAttachApply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1692-1711",
    "snippet": "int\nqemuBlockStorageSourceAttachApply(qemuMonitorPtr mon,\n                                  qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (qemuBlockStorageSourceAttachApplyStorageDeps(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyStorage(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyStorageSlice(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyFormatDeps(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyFormat(mon, data) < 0)\n        return -1;\n\n    if (data->driveCmd) {\n        if (qemuMonitorAddDrive(mon, data->driveCmd) < 0)\n            return -1;\n\n        data->driveAdded = true;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorAddDrive",
          "args": [
            "mon",
            "data->driveCmd"
          ],
          "line": 1704
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorAddDrive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2980-2990",
          "snippet": "int\nqemuMonitorAddDrive(qemuMonitorPtr mon,\n                    const char *drivestr)\n{\n    VIR_DEBUG(\"drive=%s\", drivestr);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    /* there won't ever be a direct QMP replacement for this function */\n    return qemuMonitorTextAddDrive(mon, drivestr);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorAddDrive(qemuMonitorPtr mon,\n                    const char *drivestr)\n{\n    VIR_DEBUG(\"drive=%s\", drivestr);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    /* there won't ever be a direct QMP replacement for this function */\n    return qemuMonitorTextAddDrive(mon, drivestr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachApplyFormat",
          "args": [
            "mon",
            "data"
          ],
          "line": 1700
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachApplyFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1649-1661",
          "snippet": "static int\nqemuBlockStorageSourceAttachApplyFormat(qemuMonitorPtr mon,\n                                        qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->formatProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->formatProps) < 0)\n            return -1;\n\n        data->formatAttached = true;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyFormat(qemuMonitorPtr mon,\n                                        qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->formatProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->formatProps) < 0)\n            return -1;\n\n        data->formatAttached = true;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachApplyFormatDeps",
          "args": [
            "mon",
            "data"
          ],
          "line": 1699
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachApplyFormatDeps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1636-1646",
          "snippet": "static int\nqemuBlockStorageSourceAttachApplyFormatDeps(qemuMonitorPtr mon,\n                                            qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->encryptsecretProps &&\n        qemuMonitorAddObject(mon, &data->encryptsecretProps,\n                             &data->encryptsecretAlias) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyFormatDeps(qemuMonitorPtr mon,\n                                            qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->encryptsecretProps &&\n        qemuMonitorAddObject(mon, &data->encryptsecretProps,\n                             &data->encryptsecretAlias) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachApplyStorageSlice",
          "args": [
            "mon",
            "data"
          ],
          "line": 1698
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachApplyStorageSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1664-1676",
          "snippet": "static int\nqemuBlockStorageSourceAttachApplyStorageSlice(qemuMonitorPtr mon,\n                                              qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->storageSliceProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->storageSliceProps) < 0)\n            return -1;\n\n        data->storageSliceAttached = true;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyStorageSlice(qemuMonitorPtr mon,\n                                              qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->storageSliceProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->storageSliceProps) < 0)\n            return -1;\n\n        data->storageSliceAttached = true;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceAttachApplyStorageDeps",
          "args": [
            "mon",
            "data"
          ],
          "line": 1696
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceAttachApplyStorageDeps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1595-1618",
          "snippet": "static int\nqemuBlockStorageSourceAttachApplyStorageDeps(qemuMonitorPtr mon,\n                                             qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->prmgrProps &&\n        qemuMonitorAddObject(mon, &data->prmgrProps, &data->prmgrAlias) < 0)\n        return -1;\n\n    if (data->authsecretProps &&\n        qemuMonitorAddObject(mon, &data->authsecretProps,\n                             &data->authsecretAlias) < 0)\n        return -1;\n\n    if (data->httpcookiesecretProps &&\n        qemuMonitorAddObject(mon, &data->httpcookiesecretProps,\n                             &data->httpcookiesecretAlias) < 0)\n        return -1;\n\n    if (data->tlsProps &&\n        qemuMonitorAddObject(mon, &data->tlsProps, &data->tlsAlias) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyStorageDeps(qemuMonitorPtr mon,\n                                             qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->prmgrProps &&\n        qemuMonitorAddObject(mon, &data->prmgrProps, &data->prmgrAlias) < 0)\n        return -1;\n\n    if (data->authsecretProps &&\n        qemuMonitorAddObject(mon, &data->authsecretProps,\n                             &data->authsecretAlias) < 0)\n        return -1;\n\n    if (data->httpcookiesecretProps &&\n        qemuMonitorAddObject(mon, &data->httpcookiesecretProps,\n                             &data->httpcookiesecretAlias) < 0)\n        return -1;\n\n    if (data->tlsProps &&\n        qemuMonitorAddObject(mon, &data->tlsProps, &data->tlsAlias) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockStorageSourceAttachApply(qemuMonitorPtr mon,\n                                  qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (qemuBlockStorageSourceAttachApplyStorageDeps(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyStorage(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyStorageSlice(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyFormatDeps(mon, data) < 0 ||\n        qemuBlockStorageSourceAttachApplyFormat(mon, data) < 0)\n        return -1;\n\n    if (data->driveCmd) {\n        if (qemuMonitorAddDrive(mon, data->driveCmd) < 0)\n            return -1;\n\n        data->driveAdded = true;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceAttachApplyStorageSlice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1664-1676",
    "snippet": "static int\nqemuBlockStorageSourceAttachApplyStorageSlice(qemuMonitorPtr mon,\n                                              qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->storageSliceProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->storageSliceProps) < 0)\n            return -1;\n\n        data->storageSliceAttached = true;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorBlockdevAdd",
          "args": [
            "mon",
            "&data->storageSliceProps"
          ],
          "line": 1669
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorBlockdevAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4344-4354",
          "snippet": "int\nqemuMonitorBlockdevAdd(qemuMonitorPtr mon,\n                       virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevAdd(mon, props);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorBlockdevAdd(qemuMonitorPtr mon,\n                       virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevAdd(mon, props);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyStorageSlice(qemuMonitorPtr mon,\n                                              qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->storageSliceProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->storageSliceProps) < 0)\n            return -1;\n\n        data->storageSliceAttached = true;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceAttachApplyFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1649-1661",
    "snippet": "static int\nqemuBlockStorageSourceAttachApplyFormat(qemuMonitorPtr mon,\n                                        qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->formatProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->formatProps) < 0)\n            return -1;\n\n        data->formatAttached = true;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorBlockdevAdd",
          "args": [
            "mon",
            "&data->formatProps"
          ],
          "line": 1654
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorBlockdevAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4344-4354",
          "snippet": "int\nqemuMonitorBlockdevAdd(qemuMonitorPtr mon,\n                       virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevAdd(mon, props);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorBlockdevAdd(qemuMonitorPtr mon,\n                       virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevAdd(mon, props);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyFormat(qemuMonitorPtr mon,\n                                        qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->formatProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->formatProps) < 0)\n            return -1;\n\n        data->formatAttached = true;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceAttachApplyFormatDeps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1636-1646",
    "snippet": "static int\nqemuBlockStorageSourceAttachApplyFormatDeps(qemuMonitorPtr mon,\n                                            qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->encryptsecretProps &&\n        qemuMonitorAddObject(mon, &data->encryptsecretProps,\n                             &data->encryptsecretAlias) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorAddObject",
          "args": [
            "mon",
            "&data->encryptsecretProps",
            "&data->encryptsecretAlias"
          ],
          "line": 1641
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorAddObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2920-2964",
          "snippet": "int\nqemuMonitorAddObject(qemuMonitorPtr mon,\n                     virJSONValuePtr *props,\n                     char **alias)\n{\n    const char *type = NULL;\n    const char *id = NULL;\n    char *tmp = NULL;\n    int ret = -1;\n\n    if (!*props) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"object props can't be NULL\"));\n        goto cleanup;\n    }\n\n    type = virJSONValueObjectGetString(*props, \"qom-type\");\n    id = virJSONValueObjectGetString(*props, \"id\");\n\n    VIR_DEBUG(\"type=%s id=%s\", NULLSTR(type), NULLSTR(id));\n\n    QEMU_CHECK_MONITOR_GOTO(mon, cleanup);\n\n    if (!id || !type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"missing alias or qom-type for qemu object '%s'\"),\n                       NULLSTR(type));\n        goto cleanup;\n    }\n\n    if (alias)\n        tmp = g_strdup(id);\n\n    ret = qemuMonitorJSONAddObject(mon, *props);\n    *props = NULL;\n\n    if (alias)\n        *alias = g_steal_pointer(&tmp);\n\n cleanup:\n    VIR_FREE(tmp);\n    virJSONValueFree(*props);\n    *props = NULL;\n    return ret;\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorAddObject(qemuMonitorPtr mon,\n                     virJSONValuePtr *props,\n                     char **alias)\n{\n    const char *type = NULL;\n    const char *id = NULL;\n    char *tmp = NULL;\n    int ret = -1;\n\n    if (!*props) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"object props can't be NULL\"));\n        goto cleanup;\n    }\n\n    type = virJSONValueObjectGetString(*props, \"qom-type\");\n    id = virJSONValueObjectGetString(*props, \"id\");\n\n    VIR_DEBUG(\"type=%s id=%s\", NULLSTR(type), NULLSTR(id));\n\n    QEMU_CHECK_MONITOR_GOTO(mon, cleanup);\n\n    if (!id || !type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"missing alias or qom-type for qemu object '%s'\"),\n                       NULLSTR(type));\n        goto cleanup;\n    }\n\n    if (alias)\n        tmp = g_strdup(id);\n\n    ret = qemuMonitorJSONAddObject(mon, *props);\n    *props = NULL;\n\n    if (alias)\n        *alias = g_steal_pointer(&tmp);\n\n cleanup:\n    VIR_FREE(tmp);\n    virJSONValueFree(*props);\n    *props = NULL;\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyFormatDeps(qemuMonitorPtr mon,\n                                            qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->encryptsecretProps &&\n        qemuMonitorAddObject(mon, &data->encryptsecretProps,\n                             &data->encryptsecretAlias) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceAttachApplyStorage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1621-1633",
    "snippet": "static int\nqemuBlockStorageSourceAttachApplyStorage(qemuMonitorPtr mon,\n                                         qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->storageProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->storageProps) < 0)\n            return -1;\n\n        data->storageAttached = true;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorBlockdevAdd",
          "args": [
            "mon",
            "&data->storageProps"
          ],
          "line": 1626
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorBlockdevAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4344-4354",
          "snippet": "int\nqemuMonitorBlockdevAdd(qemuMonitorPtr mon,\n                       virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevAdd(mon, props);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorBlockdevAdd(qemuMonitorPtr mon,\n                       virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevAdd(mon, props);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyStorage(qemuMonitorPtr mon,\n                                         qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->storageProps) {\n        if (qemuMonitorBlockdevAdd(mon, &data->storageProps) < 0)\n            return -1;\n\n        data->storageAttached = true;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceAttachApplyStorageDeps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1595-1618",
    "snippet": "static int\nqemuBlockStorageSourceAttachApplyStorageDeps(qemuMonitorPtr mon,\n                                             qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->prmgrProps &&\n        qemuMonitorAddObject(mon, &data->prmgrProps, &data->prmgrAlias) < 0)\n        return -1;\n\n    if (data->authsecretProps &&\n        qemuMonitorAddObject(mon, &data->authsecretProps,\n                             &data->authsecretAlias) < 0)\n        return -1;\n\n    if (data->httpcookiesecretProps &&\n        qemuMonitorAddObject(mon, &data->httpcookiesecretProps,\n                             &data->httpcookiesecretAlias) < 0)\n        return -1;\n\n    if (data->tlsProps &&\n        qemuMonitorAddObject(mon, &data->tlsProps, &data->tlsAlias) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMonitorAddObject",
          "args": [
            "mon",
            "&data->tlsProps",
            "&data->tlsAlias"
          ],
          "line": 1614
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorAddObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2920-2964",
          "snippet": "int\nqemuMonitorAddObject(qemuMonitorPtr mon,\n                     virJSONValuePtr *props,\n                     char **alias)\n{\n    const char *type = NULL;\n    const char *id = NULL;\n    char *tmp = NULL;\n    int ret = -1;\n\n    if (!*props) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"object props can't be NULL\"));\n        goto cleanup;\n    }\n\n    type = virJSONValueObjectGetString(*props, \"qom-type\");\n    id = virJSONValueObjectGetString(*props, \"id\");\n\n    VIR_DEBUG(\"type=%s id=%s\", NULLSTR(type), NULLSTR(id));\n\n    QEMU_CHECK_MONITOR_GOTO(mon, cleanup);\n\n    if (!id || !type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"missing alias or qom-type for qemu object '%s'\"),\n                       NULLSTR(type));\n        goto cleanup;\n    }\n\n    if (alias)\n        tmp = g_strdup(id);\n\n    ret = qemuMonitorJSONAddObject(mon, *props);\n    *props = NULL;\n\n    if (alias)\n        *alias = g_steal_pointer(&tmp);\n\n cleanup:\n    VIR_FREE(tmp);\n    virJSONValueFree(*props);\n    *props = NULL;\n    return ret;\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorAddObject(qemuMonitorPtr mon,\n                     virJSONValuePtr *props,\n                     char **alias)\n{\n    const char *type = NULL;\n    const char *id = NULL;\n    char *tmp = NULL;\n    int ret = -1;\n\n    if (!*props) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"object props can't be NULL\"));\n        goto cleanup;\n    }\n\n    type = virJSONValueObjectGetString(*props, \"qom-type\");\n    id = virJSONValueObjectGetString(*props, \"id\");\n\n    VIR_DEBUG(\"type=%s id=%s\", NULLSTR(type), NULLSTR(id));\n\n    QEMU_CHECK_MONITOR_GOTO(mon, cleanup);\n\n    if (!id || !type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"missing alias or qom-type for qemu object '%s'\"),\n                       NULLSTR(type));\n        goto cleanup;\n    }\n\n    if (alias)\n        tmp = g_strdup(id);\n\n    ret = qemuMonitorJSONAddObject(mon, *props);\n    *props = NULL;\n\n    if (alias)\n        *alias = g_steal_pointer(&tmp);\n\n cleanup:\n    VIR_FREE(tmp);\n    virJSONValueFree(*props);\n    *props = NULL;\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceAttachApplyStorageDeps(qemuMonitorPtr mon,\n                                             qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (data->prmgrProps &&\n        qemuMonitorAddObject(mon, &data->prmgrProps, &data->prmgrAlias) < 0)\n        return -1;\n\n    if (data->authsecretProps &&\n        qemuMonitorAddObject(mon, &data->authsecretProps,\n                             &data->authsecretAlias) < 0)\n        return -1;\n\n    if (data->httpcookiesecretProps &&\n        qemuMonitorAddObject(mon, &data->httpcookiesecretProps,\n                             &data->httpcookiesecretAlias) < 0)\n        return -1;\n\n    if (data->tlsProps &&\n        qemuMonitorAddObject(mon, &data->tlsProps, &data->tlsAlias) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceAttachPrepareBlockdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1564-1592",
    "snippet": "qemuBlockStorageSourceAttachDataPtr\nqemuBlockStorageSourceAttachPrepareBlockdev(virStorageSourcePtr src,\n                                            virStorageSourcePtr backingStore,\n                                            bool autoreadonly)\n{\n    g_autoptr(qemuBlockStorageSourceAttachData) data = NULL;\n\n    if (VIR_ALLOC(data) < 0)\n        return NULL;\n\n    if (!(data->formatProps = qemuBlockStorageSourceGetBlockdevProps(src,\n                                                                     backingStore)) ||\n        !(data->storageProps = qemuBlockStorageSourceGetBackendProps(src, false,\n                                                                     false,\n                                                                     autoreadonly)))\n        return NULL;\n\n    data->storageNodeName = src->nodestorage;\n    data->formatNodeName = src->nodeformat;\n\n    if (qemuBlockStorageSourceNeedsStorageSliceLayer(src)) {\n        if (!(data->storageSliceProps = qemuBlockStorageSourceGetBlockdevStorageSliceProps(src)))\n            return NULL;\n\n        data->storageSliceNodeName = src->sliceStorage->nodename;\n    }\n\n    return g_steal_pointer(&data);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&data"
          ],
          "line": 1591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBlockdevStorageSliceProps",
          "args": [
            "src"
          ],
          "line": 1585
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBlockdevStorageSliceProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1498-1521",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevStorageSliceProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (qemuBlockNodeNameValidate(src->sliceStorage->nodename) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:driver\", \"raw\",\n                                 \"s:node-name\", src->sliceStorage->nodename,\n                                 \"U:offset\", src->sliceStorage->offset,\n                                 \"U:size\", src->sliceStorage->size,\n                                 \"s:file\", src->nodestorage,\n                                 \"b:auto-read-only\", true,\n                                 \"s:discard\", \"unmap\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, props) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevStorageSliceProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (qemuBlockNodeNameValidate(src->sliceStorage->nodename) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:driver\", \"raw\",\n                                 \"s:node-name\", src->sliceStorage->nodename,\n                                 \"U:offset\", src->sliceStorage->offset,\n                                 \"U:size\", src->sliceStorage->size,\n                                 \"s:file\", src->nodestorage,\n                                 \"b:auto-read-only\", true,\n                                 \"s:discard\", \"unmap\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, props) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceNeedsStorageSliceLayer",
          "args": [
            "src"
          ],
          "line": 1584
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceNeedsStorageSliceLayer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3332-3346",
          "snippet": "bool\nqemuBlockStorageSourceNeedsStorageSliceLayer(const virStorageSource *src)\n{\n    if (!src->sliceStorage)\n        return false;\n\n    if (src->format != VIR_STORAGE_FILE_RAW)\n        return true;\n\n    if (src->encryption &&\n        src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n        return true;\n\n    return false;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nbool\nqemuBlockStorageSourceNeedsStorageSliceLayer(const virStorageSource *src)\n{\n    if (!src->sliceStorage)\n        return false;\n\n    if (src->format != VIR_STORAGE_FILE_RAW)\n        return true;\n\n    if (src->encryption &&\n        src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n        return true;\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBackendProps",
          "args": [
            "src",
            "false",
            "false",
            "autoreadonly"
          ],
          "line": 1576
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBackendProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1055-1199",
          "snippet": "virJSONValuePtr\nqemuBlockStorageSourceGetBackendProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget,\n                                      bool autoreadonly)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) fileprops = NULL;\n    const char *driver = NULL;\n    virTristateBool aro = VIR_TRISTATE_BOOL_ABSENT;\n    virTristateBool ro = VIR_TRISTATE_BOOL_ABSENT;\n\n    if (autoreadonly) {\n        aro = VIR_TRISTATE_BOOL_YES;\n    } else {\n        if (src->readonly)\n            ro = VIR_TRISTATE_BOOL_YES;\n        else\n            ro = VIR_TRISTATE_BOOL_NO;\n    }\n\n    switch ((virStorageType)actualType) {\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_FILE:\n        if (virStorageSourceIsBlockLocal(src)) {\n            if (src->hostcdrom)\n                driver = \"host_cdrom\";\n            else\n                driver = \"host_device\";\n        } else {\n            driver = \"file\";\n        }\n\n        if (!(fileprops = qemuBlockStorageSourceGetFileProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_DIR:\n        /* qemu handles directories by exposing them as a device with emulated\n         * FAT filesystem */\n        if (!(fileprops = qemuBlockStorageSourceGetVvfatProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_NVME:\n        if (!(fileprops = qemuBlockStorageSourceGetNVMeProps(src)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_VOLUME:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage source pool '%s' volume '%s' is not translated\"),\n                       src->srcpool->pool, src->srcpool->volume);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n        virReportEnumRangeError(virStorageType, actualType);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(fileprops = qemuBlockStorageSourceGetGlusterProps(src, legacy, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            driver = \"vxhs\";\n            if (!(fileprops = qemuBlockStorageSourceGetVxHSProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            driver = virStorageNetProtocolTypeToString(src->protocol);\n            if (!(fileprops = qemuBlockStorageSourceGetCURLProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            driver = \"iscsi\";\n            if (!(fileprops = qemuBlockStorageSourceGetISCSIProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n            driver = \"nbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetNBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetRBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(fileprops = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(fileprops = qemuBlockStorageSourceGetSshProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            virReportEnumRangeError(virStorageNetProtocol, src->protocol);\n            return NULL;\n        }\n        break;\n    }\n\n    if (driver && virJSONValueObjectPrependString(fileprops, \"driver\", driver) < 0)\n        return NULL;\n\n    if (!onlytarget) {\n        if (qemuBlockNodeNameValidate(src->nodestorage) < 0 ||\n            virJSONValueObjectAdd(fileprops, \"S:node-name\", src->nodestorage, NULL) < 0)\n            return NULL;\n\n        if (!legacy) {\n            if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, fileprops) < 0)\n                return NULL;\n\n            if (virJSONValueObjectAdd(fileprops,\n                                      \"T:read-only\", ro,\n                                      \"T:auto-read-only\", aro,\n                                      \"s:discard\", \"unmap\",\n                                      NULL) < 0)\n                return NULL;\n        }\n    }\n\n    return g_steal_pointer(&fileprops);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuBlockStorageSourceGetBackendProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget,\n                                      bool autoreadonly)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) fileprops = NULL;\n    const char *driver = NULL;\n    virTristateBool aro = VIR_TRISTATE_BOOL_ABSENT;\n    virTristateBool ro = VIR_TRISTATE_BOOL_ABSENT;\n\n    if (autoreadonly) {\n        aro = VIR_TRISTATE_BOOL_YES;\n    } else {\n        if (src->readonly)\n            ro = VIR_TRISTATE_BOOL_YES;\n        else\n            ro = VIR_TRISTATE_BOOL_NO;\n    }\n\n    switch ((virStorageType)actualType) {\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_FILE:\n        if (virStorageSourceIsBlockLocal(src)) {\n            if (src->hostcdrom)\n                driver = \"host_cdrom\";\n            else\n                driver = \"host_device\";\n        } else {\n            driver = \"file\";\n        }\n\n        if (!(fileprops = qemuBlockStorageSourceGetFileProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_DIR:\n        /* qemu handles directories by exposing them as a device with emulated\n         * FAT filesystem */\n        if (!(fileprops = qemuBlockStorageSourceGetVvfatProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_NVME:\n        if (!(fileprops = qemuBlockStorageSourceGetNVMeProps(src)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_VOLUME:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage source pool '%s' volume '%s' is not translated\"),\n                       src->srcpool->pool, src->srcpool->volume);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n        virReportEnumRangeError(virStorageType, actualType);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(fileprops = qemuBlockStorageSourceGetGlusterProps(src, legacy, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            driver = \"vxhs\";\n            if (!(fileprops = qemuBlockStorageSourceGetVxHSProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            driver = virStorageNetProtocolTypeToString(src->protocol);\n            if (!(fileprops = qemuBlockStorageSourceGetCURLProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            driver = \"iscsi\";\n            if (!(fileprops = qemuBlockStorageSourceGetISCSIProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n            driver = \"nbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetNBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetRBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(fileprops = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(fileprops = qemuBlockStorageSourceGetSshProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            virReportEnumRangeError(virStorageNetProtocol, src->protocol);\n            return NULL;\n        }\n        break;\n    }\n\n    if (driver && virJSONValueObjectPrependString(fileprops, \"driver\", driver) < 0)\n        return NULL;\n\n    if (!onlytarget) {\n        if (qemuBlockNodeNameValidate(src->nodestorage) < 0 ||\n            virJSONValueObjectAdd(fileprops, \"S:node-name\", src->nodestorage, NULL) < 0)\n            return NULL;\n\n        if (!legacy) {\n            if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, fileprops) < 0)\n                return NULL;\n\n            if (virJSONValueObjectAdd(fileprops,\n                                      \"T:read-only\", ro,\n                                      \"T:auto-read-only\", aro,\n                                      \"s:discard\", \"unmap\",\n                                      NULL) < 0)\n                return NULL;\n        }\n    }\n\n    return g_steal_pointer(&fileprops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBlockdevProps",
          "args": [
            "src",
            "backingStore"
          ],
          "line": 1574
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBlockdevProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1456-1495",
          "snippet": "virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevProps(virStorageSourcePtr src,\n                                       virStorageSourcePtr backingStore)\n{\n    g_autoptr(virJSONValue) props = NULL;\n    const char *storagenode = src->nodestorage;\n\n    if (qemuBlockStorageSourceNeedsStorageSliceLayer(src))\n        storagenode = src->sliceStorage->nodename;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatProps(src)))\n        return NULL;\n\n    if (virJSONValueObjectAppendString(props, \"file\", storagenode) < 0)\n        return NULL;\n\n    if (backingStore) {\n        if (src->format >= VIR_STORAGE_FILE_BACKING) {\n            if (virStorageSourceIsBacking(backingStore)) {\n                if (virJSONValueObjectAppendString(props, \"backing\",\n                                                   backingStore->nodeformat) < 0)\n                    return NULL;\n            } else {\n                /* chain is terminated, indicate that no detection should happen\n                 * in qemu */\n                if (virJSONValueObjectAppendNull(props, \"backing\") < 0)\n                    return NULL;\n            }\n        } else {\n            if (virStorageSourceIsBacking(backingStore)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"storage format '%s' does not support backing store\"),\n                               virStorageFileFormatTypeToString(src->format));\n                return NULL;\n            }\n        }\n    }\n\n    return g_steal_pointer(&props);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuBlockStorageSourceGetBlockdevProps(virStorageSourcePtr src,\n                                       virStorageSourcePtr backingStore)\n{\n    g_autoptr(virJSONValue) props = NULL;\n    const char *storagenode = src->nodestorage;\n\n    if (qemuBlockStorageSourceNeedsStorageSliceLayer(src))\n        storagenode = src->sliceStorage->nodename;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatProps(src)))\n        return NULL;\n\n    if (virJSONValueObjectAppendString(props, \"file\", storagenode) < 0)\n        return NULL;\n\n    if (backingStore) {\n        if (src->format >= VIR_STORAGE_FILE_BACKING) {\n            if (virStorageSourceIsBacking(backingStore)) {\n                if (virJSONValueObjectAppendString(props, \"backing\",\n                                                   backingStore->nodeformat) < 0)\n                    return NULL;\n            } else {\n                /* chain is terminated, indicate that no detection should happen\n                 * in qemu */\n                if (virJSONValueObjectAppendNull(props, \"backing\") < 0)\n                    return NULL;\n            }\n        } else {\n            if (virStorageSourceIsBacking(backingStore)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"storage format '%s' does not support backing store\"),\n                               virStorageFileFormatTypeToString(src->format));\n                return NULL;\n            }\n        }\n    }\n\n    return g_steal_pointer(&props);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "data"
          ],
          "line": 1571
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nqemuBlockStorageSourceAttachDataPtr\nqemuBlockStorageSourceAttachPrepareBlockdev(virStorageSourcePtr src,\n                                            virStorageSourcePtr backingStore,\n                                            bool autoreadonly)\n{\n    g_autoptr(qemuBlockStorageSourceAttachData) data = NULL;\n\n    if (VIR_ALLOC(data) < 0)\n        return NULL;\n\n    if (!(data->formatProps = qemuBlockStorageSourceGetBlockdevProps(src,\n                                                                     backingStore)) ||\n        !(data->storageProps = qemuBlockStorageSourceGetBackendProps(src, false,\n                                                                     false,\n                                                                     autoreadonly)))\n        return NULL;\n\n    data->storageNodeName = src->nodestorage;\n    data->formatNodeName = src->nodeformat;\n\n    if (qemuBlockStorageSourceNeedsStorageSliceLayer(src)) {\n        if (!(data->storageSliceProps = qemuBlockStorageSourceGetBlockdevStorageSliceProps(src)))\n            return NULL;\n\n        data->storageSliceNodeName = src->sliceStorage->nodename;\n    }\n\n    return g_steal_pointer(&data);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceAttachDataFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1524-1545",
    "snippet": "void\nqemuBlockStorageSourceAttachDataFree(qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (!data)\n        return;\n\n    virJSONValueFree(data->storageProps);\n    virJSONValueFree(data->storageSliceProps);\n    virJSONValueFree(data->formatProps);\n    virJSONValueFree(data->prmgrProps);\n    virJSONValueFree(data->authsecretProps);\n    virJSONValueFree(data->httpcookiesecretProps);\n    virJSONValueFree(data->encryptsecretProps);\n    virJSONValueFree(data->tlsProps);\n    VIR_FREE(data->tlsAlias);\n    VIR_FREE(data->authsecretAlias);\n    VIR_FREE(data->encryptsecretAlias);\n    VIR_FREE(data->httpcookiesecretAlias);\n    VIR_FREE(data->driveCmd);\n    VIR_FREE(data->driveAlias);\n    VIR_FREE(data);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data"
          ],
          "line": 1544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->driveAlias"
          ],
          "line": 1543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->driveCmd"
          ],
          "line": 1542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->httpcookiesecretAlias"
          ],
          "line": 1541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->encryptsecretAlias"
          ],
          "line": 1540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->authsecretAlias"
          ],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->tlsAlias"
          ],
          "line": 1538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "data->tlsProps"
          ],
          "line": 1537
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvoid\nqemuBlockStorageSourceAttachDataFree(qemuBlockStorageSourceAttachDataPtr data)\n{\n    if (!data)\n        return;\n\n    virJSONValueFree(data->storageProps);\n    virJSONValueFree(data->storageSliceProps);\n    virJSONValueFree(data->formatProps);\n    virJSONValueFree(data->prmgrProps);\n    virJSONValueFree(data->authsecretProps);\n    virJSONValueFree(data->httpcookiesecretProps);\n    virJSONValueFree(data->encryptsecretProps);\n    virJSONValueFree(data->tlsProps);\n    VIR_FREE(data->tlsAlias);\n    VIR_FREE(data->authsecretAlias);\n    VIR_FREE(data->encryptsecretAlias);\n    VIR_FREE(data->httpcookiesecretAlias);\n    VIR_FREE(data->driveCmd);\n    VIR_FREE(data->driveAlias);\n    VIR_FREE(data);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetBlockdevStorageSliceProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1498-1521",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevStorageSliceProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (qemuBlockNodeNameValidate(src->sliceStorage->nodename) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:driver\", \"raw\",\n                                 \"s:node-name\", src->sliceStorage->nodename,\n                                 \"U:offset\", src->sliceStorage->offset,\n                                 \"U:size\", src->sliceStorage->size,\n                                 \"s:file\", src->nodestorage,\n                                 \"b:auto-read-only\", true,\n                                 \"s:discard\", \"unmap\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, props) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&props"
          ],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBlockdevGetCacheProps",
          "args": [
            "src",
            "props"
          ],
          "line": 1517
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBlockdevGetCacheProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1017-1042",
          "snippet": "static int\nqemuBlockStorageSourceGetBlockdevGetCacheProps(virStorageSourcePtr src,\n                                               virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) cacheobj = NULL;\n    bool direct = false;\n    bool noflush = false;\n\n    if (src->cachemode == VIR_DOMAIN_DISK_CACHE_DEFAULT)\n        return 0;\n\n    if (qemuDomainDiskCachemodeFlags(src->cachemode, NULL, &direct, &noflush) < 0)\n        return -1;\n\n    if (virJSONValueObjectCreate(&cacheobj,\n                                 \"b:direct\", direct,\n                                 \"b:no-flush\", noflush,\n                                 NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAppend(props, \"cache\", cacheobj) < 0)\n        return -1;\n    cacheobj = NULL;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetBlockdevGetCacheProps(virStorageSourcePtr src,\n                                               virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) cacheobj = NULL;\n    bool direct = false;\n    bool noflush = false;\n\n    if (src->cachemode == VIR_DOMAIN_DISK_CACHE_DEFAULT)\n        return 0;\n\n    if (qemuDomainDiskCachemodeFlags(src->cachemode, NULL, &direct, &noflush) < 0)\n        return -1;\n\n    if (virJSONValueObjectCreate(&cacheobj,\n                                 \"b:direct\", direct,\n                                 \"b:no-flush\", noflush,\n                                 NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAppend(props, \"cache\", cacheobj) < 0)\n        return -1;\n    cacheobj = NULL;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&props",
            "\"s:driver\"",
            "\"raw\"",
            "\"s:node-name\"",
            "src->sliceStorage->nodename",
            "\"U:offset\"",
            "src->sliceStorage->offset",
            "\"U:size\"",
            "src->sliceStorage->size",
            "\"s:file\"",
            "src->nodestorage",
            "\"b:auto-read-only\"",
            "true",
            "\"s:discard\"",
            "\"unmap\"",
            "NULL"
          ],
          "line": 1506
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockNodeNameValidate",
          "args": [
            "src->sliceStorage->nodename"
          ],
          "line": 1503
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockNodeNameValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "38-51",
          "snippet": "static int\nqemuBlockNodeNameValidate(const char *nn)\n{\n    if (!nn)\n        return 0;\n\n    if (strlen(nn) >= qemuBlockNodeNameBufSize) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"node-name '%s' too long for qemu\"), nn);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const size_t qemuBlockNodeNameBufSize = 32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic const size_t qemuBlockNodeNameBufSize = 32;\n\nstatic int\nqemuBlockNodeNameValidate(const char *nn)\n{\n    if (!nn)\n        return 0;\n\n    if (strlen(nn) >= qemuBlockNodeNameBufSize) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"node-name '%s' too long for qemu\"), nn);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevStorageSliceProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (qemuBlockNodeNameValidate(src->sliceStorage->nodename) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:driver\", \"raw\",\n                                 \"s:node-name\", src->sliceStorage->nodename,\n                                 \"U:offset\", src->sliceStorage->offset,\n                                 \"U:size\", src->sliceStorage->size,\n                                 \"s:file\", src->nodestorage,\n                                 \"b:auto-read-only\", true,\n                                 \"s:discard\", \"unmap\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, props) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetBlockdevProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1456-1495",
    "snippet": "virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevProps(virStorageSourcePtr src,\n                                       virStorageSourcePtr backingStore)\n{\n    g_autoptr(virJSONValue) props = NULL;\n    const char *storagenode = src->nodestorage;\n\n    if (qemuBlockStorageSourceNeedsStorageSliceLayer(src))\n        storagenode = src->sliceStorage->nodename;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatProps(src)))\n        return NULL;\n\n    if (virJSONValueObjectAppendString(props, \"file\", storagenode) < 0)\n        return NULL;\n\n    if (backingStore) {\n        if (src->format >= VIR_STORAGE_FILE_BACKING) {\n            if (virStorageSourceIsBacking(backingStore)) {\n                if (virJSONValueObjectAppendString(props, \"backing\",\n                                                   backingStore->nodeformat) < 0)\n                    return NULL;\n            } else {\n                /* chain is terminated, indicate that no detection should happen\n                 * in qemu */\n                if (virJSONValueObjectAppendNull(props, \"backing\") < 0)\n                    return NULL;\n            }\n        } else {\n            if (virStorageSourceIsBacking(backingStore)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"storage format '%s' does not support backing store\"),\n                               virStorageFileFormatTypeToString(src->format));\n                return NULL;\n            }\n        }\n    }\n\n    return g_steal_pointer(&props);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&props"
          ],
          "line": 1494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"storage format '%s' does not support backing store\")",
            "virStorageFileFormatTypeToString(src->format)"
          ],
          "line": 1486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeToString",
          "args": [
            "src->format"
          ],
          "line": 1488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage format '%s' does not support backing store\""
          ],
          "line": 1487
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBacking",
          "args": [
            "backingStore"
          ],
          "line": 1485
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1581-1585",
          "snippet": "bool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNull",
          "args": [
            "props",
            "\"backing\""
          ],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "757-769",
          "snippet": "int\nvirJSONValueObjectAppendNull(virJSONValuePtr object,\n                             const char *key)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNull();\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNull(virJSONValuePtr object,\n                             const char *key)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNull();\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendString",
          "args": [
            "props",
            "\"backing\"",
            "backingStore->nodeformat"
          ],
          "line": 1475
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "643-649",
          "snippet": "int\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBlockdevFormatProps",
          "args": [
            "src"
          ],
          "line": 1466
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBlockdevFormatProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1368-1443",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevFormatProps(virStorageSourcePtr src)\n{\n    const char *driver = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatCommonProps(src)))\n        return NULL;\n\n    switch ((virStorageFileFormat) src->format) {\n    case VIR_STORAGE_FILE_FAT:\n        /* The fat layer is emulated by the storage access layer, so we need to\n         * put a raw layer on top */\n    case VIR_STORAGE_FILE_RAW:\n        if (src->encryption &&\n            src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n            if (qemuBlockStorageSourceGetFormatLUKSProps(src, props) < 0)\n                return NULL;\n        } else {\n            if (qemuBlockStorageSourceGetFormatRawProps(src, props) < 0)\n                return NULL;\n        }\n        break;\n\n    case VIR_STORAGE_FILE_QCOW2:\n        if (qemuBlockStorageSourceGetFormatQcow2Props(src, props) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_FILE_QCOW:\n        if (qemuBlockStorageSourceGetFormatQcowGenericProps(src, \"qcow\", props) < 0)\n            return NULL;\n        break;\n\n    /* formats without any special parameters */\n    case VIR_STORAGE_FILE_PLOOP:\n        driver = \"parallels\";\n        break;\n\n    case VIR_STORAGE_FILE_VHD:\n        driver = \"vhdx\";\n        break;\n\n    case VIR_STORAGE_FILE_BOCHS:\n    case VIR_STORAGE_FILE_CLOOP:\n    case VIR_STORAGE_FILE_DMG:\n    case VIR_STORAGE_FILE_VDI:\n    case VIR_STORAGE_FILE_VPC:\n    case VIR_STORAGE_FILE_QED:\n    case VIR_STORAGE_FILE_VMDK:\n        driver = virStorageFileFormatTypeToString(src->format);\n        break;\n\n    case VIR_STORAGE_FILE_AUTO_SAFE:\n    case VIR_STORAGE_FILE_AUTO:\n    case VIR_STORAGE_FILE_NONE:\n    case VIR_STORAGE_FILE_COW:\n    case VIR_STORAGE_FILE_ISO:\n    case VIR_STORAGE_FILE_DIR:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"mishandled storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return NULL;\n\n    case VIR_STORAGE_FILE_LAST:\n    default:\n        virReportEnumRangeError(virStorageFileFormat, src->format);\n        return NULL;\n    }\n\n    if (driver &&\n        virJSONValueObjectAdd(props, \"s:driver\", driver, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevFormatProps(virStorageSourcePtr src)\n{\n    const char *driver = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatCommonProps(src)))\n        return NULL;\n\n    switch ((virStorageFileFormat) src->format) {\n    case VIR_STORAGE_FILE_FAT:\n        /* The fat layer is emulated by the storage access layer, so we need to\n         * put a raw layer on top */\n    case VIR_STORAGE_FILE_RAW:\n        if (src->encryption &&\n            src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n            if (qemuBlockStorageSourceGetFormatLUKSProps(src, props) < 0)\n                return NULL;\n        } else {\n            if (qemuBlockStorageSourceGetFormatRawProps(src, props) < 0)\n                return NULL;\n        }\n        break;\n\n    case VIR_STORAGE_FILE_QCOW2:\n        if (qemuBlockStorageSourceGetFormatQcow2Props(src, props) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_FILE_QCOW:\n        if (qemuBlockStorageSourceGetFormatQcowGenericProps(src, \"qcow\", props) < 0)\n            return NULL;\n        break;\n\n    /* formats without any special parameters */\n    case VIR_STORAGE_FILE_PLOOP:\n        driver = \"parallels\";\n        break;\n\n    case VIR_STORAGE_FILE_VHD:\n        driver = \"vhdx\";\n        break;\n\n    case VIR_STORAGE_FILE_BOCHS:\n    case VIR_STORAGE_FILE_CLOOP:\n    case VIR_STORAGE_FILE_DMG:\n    case VIR_STORAGE_FILE_VDI:\n    case VIR_STORAGE_FILE_VPC:\n    case VIR_STORAGE_FILE_QED:\n    case VIR_STORAGE_FILE_VMDK:\n        driver = virStorageFileFormatTypeToString(src->format);\n        break;\n\n    case VIR_STORAGE_FILE_AUTO_SAFE:\n    case VIR_STORAGE_FILE_AUTO:\n    case VIR_STORAGE_FILE_NONE:\n    case VIR_STORAGE_FILE_COW:\n    case VIR_STORAGE_FILE_ISO:\n    case VIR_STORAGE_FILE_DIR:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"mishandled storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return NULL;\n\n    case VIR_STORAGE_FILE_LAST:\n    default:\n        virReportEnumRangeError(virStorageFileFormat, src->format);\n        return NULL;\n    }\n\n    if (driver &&\n        virJSONValueObjectAdd(props, \"s:driver\", driver, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceNeedsStorageSliceLayer",
          "args": [
            "src"
          ],
          "line": 1463
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceNeedsStorageSliceLayer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3332-3346",
          "snippet": "bool\nqemuBlockStorageSourceNeedsStorageSliceLayer(const virStorageSource *src)\n{\n    if (!src->sliceStorage)\n        return false;\n\n    if (src->format != VIR_STORAGE_FILE_RAW)\n        return true;\n\n    if (src->encryption &&\n        src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n        return true;\n\n    return false;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nbool\nqemuBlockStorageSourceNeedsStorageSliceLayer(const virStorageSource *src)\n{\n    if (!src->sliceStorage)\n        return false;\n\n    if (src->format != VIR_STORAGE_FILE_RAW)\n        return true;\n\n    if (src->encryption &&\n        src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS)\n        return true;\n\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuBlockStorageSourceGetBlockdevProps(virStorageSourcePtr src,\n                                       virStorageSourcePtr backingStore)\n{\n    g_autoptr(virJSONValue) props = NULL;\n    const char *storagenode = src->nodestorage;\n\n    if (qemuBlockStorageSourceNeedsStorageSliceLayer(src))\n        storagenode = src->sliceStorage->nodename;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatProps(src)))\n        return NULL;\n\n    if (virJSONValueObjectAppendString(props, \"file\", storagenode) < 0)\n        return NULL;\n\n    if (backingStore) {\n        if (src->format >= VIR_STORAGE_FILE_BACKING) {\n            if (virStorageSourceIsBacking(backingStore)) {\n                if (virJSONValueObjectAppendString(props, \"backing\",\n                                                   backingStore->nodeformat) < 0)\n                    return NULL;\n            } else {\n                /* chain is terminated, indicate that no detection should happen\n                 * in qemu */\n                if (virJSONValueObjectAppendNull(props, \"backing\") < 0)\n                    return NULL;\n            }\n        } else {\n            if (virStorageSourceIsBacking(backingStore)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"storage format '%s' does not support backing store\"),\n                               virStorageFileFormatTypeToString(src->format));\n                return NULL;\n            }\n        }\n    }\n\n    return g_steal_pointer(&props);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetBlockdevFormatProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1368-1443",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevFormatProps(virStorageSourcePtr src)\n{\n    const char *driver = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatCommonProps(src)))\n        return NULL;\n\n    switch ((virStorageFileFormat) src->format) {\n    case VIR_STORAGE_FILE_FAT:\n        /* The fat layer is emulated by the storage access layer, so we need to\n         * put a raw layer on top */\n    case VIR_STORAGE_FILE_RAW:\n        if (src->encryption &&\n            src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n            if (qemuBlockStorageSourceGetFormatLUKSProps(src, props) < 0)\n                return NULL;\n        } else {\n            if (qemuBlockStorageSourceGetFormatRawProps(src, props) < 0)\n                return NULL;\n        }\n        break;\n\n    case VIR_STORAGE_FILE_QCOW2:\n        if (qemuBlockStorageSourceGetFormatQcow2Props(src, props) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_FILE_QCOW:\n        if (qemuBlockStorageSourceGetFormatQcowGenericProps(src, \"qcow\", props) < 0)\n            return NULL;\n        break;\n\n    /* formats without any special parameters */\n    case VIR_STORAGE_FILE_PLOOP:\n        driver = \"parallels\";\n        break;\n\n    case VIR_STORAGE_FILE_VHD:\n        driver = \"vhdx\";\n        break;\n\n    case VIR_STORAGE_FILE_BOCHS:\n    case VIR_STORAGE_FILE_CLOOP:\n    case VIR_STORAGE_FILE_DMG:\n    case VIR_STORAGE_FILE_VDI:\n    case VIR_STORAGE_FILE_VPC:\n    case VIR_STORAGE_FILE_QED:\n    case VIR_STORAGE_FILE_VMDK:\n        driver = virStorageFileFormatTypeToString(src->format);\n        break;\n\n    case VIR_STORAGE_FILE_AUTO_SAFE:\n    case VIR_STORAGE_FILE_AUTO:\n    case VIR_STORAGE_FILE_NONE:\n    case VIR_STORAGE_FILE_COW:\n    case VIR_STORAGE_FILE_ISO:\n    case VIR_STORAGE_FILE_DIR:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"mishandled storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return NULL;\n\n    case VIR_STORAGE_FILE_LAST:\n    default:\n        virReportEnumRangeError(virStorageFileFormat, src->format);\n        return NULL;\n    }\n\n    if (driver &&\n        virJSONValueObjectAdd(props, \"s:driver\", driver, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&props"
          ],
          "line": 1442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "props",
            "\"s:driver\"",
            "driver",
            "NULL"
          ],
          "line": 1439
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virStorageFileFormat",
            "src->format"
          ],
          "line": 1434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"mishandled storage format '%s'\")",
            "virStorageFileFormatTypeToString(src->format)"
          ],
          "line": 1427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeToString",
          "args": [
            "src->format"
          ],
          "line": 1429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"mishandled storage format '%s'\""
          ],
          "line": 1428
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeToString",
          "args": [
            "src->format"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetFormatQcowGenericProps",
          "args": [
            "src",
            "\"qcow\"",
            "props"
          ],
          "line": 1398
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetFormatQcowGenericProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1288-1304",
          "snippet": "static int\nqemuBlockStorageSourceGetFormatQcowGenericProps(virStorageSourcePtr src,\n                                                const char *format,\n                                                virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encprops = NULL;\n\n    if (qemuBlockStorageSourceGetCryptoProps(src, &encprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", format,\n                              \"A:encrypt\", &encprops, NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetFormatQcowGenericProps(virStorageSourcePtr src,\n                                                const char *format,\n                                                virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encprops = NULL;\n\n    if (qemuBlockStorageSourceGetCryptoProps(src, &encprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", format,\n                              \"A:encrypt\", &encprops, NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetFormatQcow2Props",
          "args": [
            "src",
            "props"
          ],
          "line": 1393
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetFormatQcow2Props",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1307-1328",
          "snippet": "static int\nqemuBlockStorageSourceGetFormatQcow2Props(virStorageSourcePtr src,\n                                          virJSONValuePtr props)\n{\n    /* currently unhandled qcow2 props:\n     *\n     * 'lazy-refcounts'\n     * 'pass-discard-request'\n     * 'pass-discard-snapshot'\n     * 'pass-discard-other'\n     * 'overlap-check'\n     * 'l2-cache-size'\n     * 'l2-cache-entry-size'\n     * 'refcount-cache-size'\n     * 'cache-clean-interval'\n     */\n\n    if (qemuBlockStorageSourceGetFormatQcowGenericProps(src, \"qcow2\", props) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetFormatQcow2Props(virStorageSourcePtr src,\n                                          virJSONValuePtr props)\n{\n    /* currently unhandled qcow2 props:\n     *\n     * 'lazy-refcounts'\n     * 'pass-discard-request'\n     * 'pass-discard-snapshot'\n     * 'pass-discard-other'\n     * 'overlap-check'\n     * 'l2-cache-size'\n     * 'l2-cache-entry-size'\n     * 'refcount-cache-size'\n     * 'cache-clean-interval'\n     */\n\n    if (qemuBlockStorageSourceGetFormatQcowGenericProps(src, \"qcow2\", props) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetFormatRawProps",
          "args": [
            "src",
            "props"
          ],
          "line": 1387
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetFormatRawProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1224-1242",
          "snippet": "static int\nqemuBlockStorageSourceGetFormatRawProps(virStorageSourcePtr src,\n                                        virJSONValuePtr props)\n{\n    if (virJSONValueObjectAdd(props, \"s:driver\", \"raw\", NULL) < 0)\n        return -1;\n\n    /* Currently only storage slices are supported. We'll have to calculate\n     * the union of the slices here if we don't want to be adding needless\n     * 'raw' nodes. */\n    if (src->sliceStorage &&\n        virJSONValueObjectAdd(props,\n                              \"U:offset\", src->sliceStorage->offset,\n                              \"U:size\", src->sliceStorage->size,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetFormatRawProps(virStorageSourcePtr src,\n                                        virJSONValuePtr props)\n{\n    if (virJSONValueObjectAdd(props, \"s:driver\", \"raw\", NULL) < 0)\n        return -1;\n\n    /* Currently only storage slices are supported. We'll have to calculate\n     * the union of the slices here if we don't want to be adding needless\n     * 'raw' nodes. */\n    if (src->sliceStorage &&\n        virJSONValueObjectAdd(props,\n                              \"U:offset\", src->sliceStorage->offset,\n                              \"U:size\", src->sliceStorage->size,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetFormatLUKSProps",
          "args": [
            "src",
            "props"
          ],
          "line": 1384
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetFormatLUKSProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1202-1221",
          "snippet": "static int\nqemuBlockStorageSourceGetFormatLUKSProps(virStorageSourcePtr src,\n                                         virJSONValuePtr props)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n\n    if (!srcPriv || !srcPriv->encinfo || !srcPriv->encinfo->s.aes.alias) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing secret info for 'luks' driver\"));\n        return -1;\n    }\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", \"luks\",\n                              \"s:key-secret\", srcPriv->encinfo->s.aes.alias,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetFormatLUKSProps(virStorageSourcePtr src,\n                                         virJSONValuePtr props)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n\n    if (!srcPriv || !srcPriv->encinfo || !srcPriv->encinfo->s.aes.alias) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing secret info for 'luks' driver\"));\n        return -1;\n    }\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", \"luks\",\n                              \"s:key-secret\", srcPriv->encinfo->s.aes.alias,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBlockdevFormatCommonProps",
          "args": [
            "src"
          ],
          "line": 1374
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBlockdevFormatCommonProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1331-1365",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevFormatCommonProps(virStorageSourcePtr src)\n{\n    const char *detectZeroes = NULL;\n    const char *discard = NULL;\n    int detectZeroesMode = virDomainDiskGetDetectZeroesMode(src->discard,\n                                                            src->detect_zeroes);\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (qemuBlockNodeNameValidate(src->nodeformat) < 0)\n        return NULL;\n\n    if (src->discard)\n        discard = virDomainDiskDiscardTypeToString(src->discard);\n\n    if (detectZeroesMode)\n        detectZeroes = virDomainDiskDetectZeroesTypeToString(detectZeroesMode);\n\n    /* currently unhandled global properties:\n     * '*force-share': 'bool'\n     */\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:node-name\", src->nodeformat,\n                                 \"b:read-only\", src->readonly,\n                                 \"S:discard\", discard,\n                                 \"S:detect-zeroes\", detectZeroes,\n                                 NULL) < 0)\n        return NULL;\n\n    if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, props) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevFormatCommonProps(virStorageSourcePtr src)\n{\n    const char *detectZeroes = NULL;\n    const char *discard = NULL;\n    int detectZeroesMode = virDomainDiskGetDetectZeroesMode(src->discard,\n                                                            src->detect_zeroes);\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (qemuBlockNodeNameValidate(src->nodeformat) < 0)\n        return NULL;\n\n    if (src->discard)\n        discard = virDomainDiskDiscardTypeToString(src->discard);\n\n    if (detectZeroesMode)\n        detectZeroes = virDomainDiskDetectZeroesTypeToString(detectZeroesMode);\n\n    /* currently unhandled global properties:\n     * '*force-share': 'bool'\n     */\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:node-name\", src->nodeformat,\n                                 \"b:read-only\", src->readonly,\n                                 \"S:discard\", discard,\n                                 \"S:detect-zeroes\", detectZeroes,\n                                 NULL) < 0)\n        return NULL;\n\n    if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, props) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevFormatProps(virStorageSourcePtr src)\n{\n    const char *driver = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(props = qemuBlockStorageSourceGetBlockdevFormatCommonProps(src)))\n        return NULL;\n\n    switch ((virStorageFileFormat) src->format) {\n    case VIR_STORAGE_FILE_FAT:\n        /* The fat layer is emulated by the storage access layer, so we need to\n         * put a raw layer on top */\n    case VIR_STORAGE_FILE_RAW:\n        if (src->encryption &&\n            src->encryption->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n            if (qemuBlockStorageSourceGetFormatLUKSProps(src, props) < 0)\n                return NULL;\n        } else {\n            if (qemuBlockStorageSourceGetFormatRawProps(src, props) < 0)\n                return NULL;\n        }\n        break;\n\n    case VIR_STORAGE_FILE_QCOW2:\n        if (qemuBlockStorageSourceGetFormatQcow2Props(src, props) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_FILE_QCOW:\n        if (qemuBlockStorageSourceGetFormatQcowGenericProps(src, \"qcow\", props) < 0)\n            return NULL;\n        break;\n\n    /* formats without any special parameters */\n    case VIR_STORAGE_FILE_PLOOP:\n        driver = \"parallels\";\n        break;\n\n    case VIR_STORAGE_FILE_VHD:\n        driver = \"vhdx\";\n        break;\n\n    case VIR_STORAGE_FILE_BOCHS:\n    case VIR_STORAGE_FILE_CLOOP:\n    case VIR_STORAGE_FILE_DMG:\n    case VIR_STORAGE_FILE_VDI:\n    case VIR_STORAGE_FILE_VPC:\n    case VIR_STORAGE_FILE_QED:\n    case VIR_STORAGE_FILE_VMDK:\n        driver = virStorageFileFormatTypeToString(src->format);\n        break;\n\n    case VIR_STORAGE_FILE_AUTO_SAFE:\n    case VIR_STORAGE_FILE_AUTO:\n    case VIR_STORAGE_FILE_NONE:\n    case VIR_STORAGE_FILE_COW:\n    case VIR_STORAGE_FILE_ISO:\n    case VIR_STORAGE_FILE_DIR:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"mishandled storage format '%s'\"),\n                       virStorageFileFormatTypeToString(src->format));\n        return NULL;\n\n    case VIR_STORAGE_FILE_LAST:\n    default:\n        virReportEnumRangeError(virStorageFileFormat, src->format);\n        return NULL;\n    }\n\n    if (driver &&\n        virJSONValueObjectAdd(props, \"s:driver\", driver, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetBlockdevFormatCommonProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1331-1365",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevFormatCommonProps(virStorageSourcePtr src)\n{\n    const char *detectZeroes = NULL;\n    const char *discard = NULL;\n    int detectZeroesMode = virDomainDiskGetDetectZeroesMode(src->discard,\n                                                            src->detect_zeroes);\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (qemuBlockNodeNameValidate(src->nodeformat) < 0)\n        return NULL;\n\n    if (src->discard)\n        discard = virDomainDiskDiscardTypeToString(src->discard);\n\n    if (detectZeroesMode)\n        detectZeroes = virDomainDiskDetectZeroesTypeToString(detectZeroesMode);\n\n    /* currently unhandled global properties:\n     * '*force-share': 'bool'\n     */\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:node-name\", src->nodeformat,\n                                 \"b:read-only\", src->readonly,\n                                 \"S:discard\", discard,\n                                 \"S:detect-zeroes\", detectZeroes,\n                                 NULL) < 0)\n        return NULL;\n\n    if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, props) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&props"
          ],
          "line": 1364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBlockdevGetCacheProps",
          "args": [
            "src",
            "props"
          ],
          "line": 1361
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBlockdevGetCacheProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1017-1042",
          "snippet": "static int\nqemuBlockStorageSourceGetBlockdevGetCacheProps(virStorageSourcePtr src,\n                                               virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) cacheobj = NULL;\n    bool direct = false;\n    bool noflush = false;\n\n    if (src->cachemode == VIR_DOMAIN_DISK_CACHE_DEFAULT)\n        return 0;\n\n    if (qemuDomainDiskCachemodeFlags(src->cachemode, NULL, &direct, &noflush) < 0)\n        return -1;\n\n    if (virJSONValueObjectCreate(&cacheobj,\n                                 \"b:direct\", direct,\n                                 \"b:no-flush\", noflush,\n                                 NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAppend(props, \"cache\", cacheobj) < 0)\n        return -1;\n    cacheobj = NULL;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetBlockdevGetCacheProps(virStorageSourcePtr src,\n                                               virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) cacheobj = NULL;\n    bool direct = false;\n    bool noflush = false;\n\n    if (src->cachemode == VIR_DOMAIN_DISK_CACHE_DEFAULT)\n        return 0;\n\n    if (qemuDomainDiskCachemodeFlags(src->cachemode, NULL, &direct, &noflush) < 0)\n        return -1;\n\n    if (virJSONValueObjectCreate(&cacheobj,\n                                 \"b:direct\", direct,\n                                 \"b:no-flush\", noflush,\n                                 NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAppend(props, \"cache\", cacheobj) < 0)\n        return -1;\n    cacheobj = NULL;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&props",
            "\"s:node-name\"",
            "src->nodeformat",
            "\"b:read-only\"",
            "src->readonly",
            "\"S:discard\"",
            "discard",
            "\"S:detect-zeroes\"",
            "detectZeroes",
            "NULL"
          ],
          "line": 1353
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskDetectZeroesTypeToString",
          "args": [
            "detectZeroesMode"
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskDiscardTypeToString",
          "args": [
            "src->discard"
          ],
          "line": 1344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockNodeNameValidate",
          "args": [
            "src->nodeformat"
          ],
          "line": 1340
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockNodeNameValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "38-51",
          "snippet": "static int\nqemuBlockNodeNameValidate(const char *nn)\n{\n    if (!nn)\n        return 0;\n\n    if (strlen(nn) >= qemuBlockNodeNameBufSize) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"node-name '%s' too long for qemu\"), nn);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const size_t qemuBlockNodeNameBufSize = 32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic const size_t qemuBlockNodeNameBufSize = 32;\n\nstatic int\nqemuBlockNodeNameValidate(const char *nn)\n{\n    if (!nn)\n        return 0;\n\n    if (strlen(nn) >= qemuBlockNodeNameBufSize) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"node-name '%s' too long for qemu\"), nn);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetDetectZeroesMode",
          "args": [
            "src->discard",
            "src->detect_zeroes"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetDetectZeroesMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "32007-32016",
          "snippet": "int\nvirDomainDiskGetDetectZeroesMode(virDomainDiskDiscard discard,\n                                 virDomainDiskDetectZeroes detect_zeroes)\n{\n    if (discard != VIR_DOMAIN_DISK_DISCARD_UNMAP &&\n        detect_zeroes == VIR_DOMAIN_DISK_DETECT_ZEROES_UNMAP)\n        return VIR_DOMAIN_DISK_DETECT_ZEROES_ON;\n\n    return detect_zeroes;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskGetDetectZeroesMode(virDomainDiskDiscard discard,\n                                 virDomainDiskDetectZeroes detect_zeroes)\n{\n    if (discard != VIR_DOMAIN_DISK_DISCARD_UNMAP &&\n        detect_zeroes == VIR_DOMAIN_DISK_DETECT_ZEROES_UNMAP)\n        return VIR_DOMAIN_DISK_DETECT_ZEROES_ON;\n\n    return detect_zeroes;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetBlockdevFormatCommonProps(virStorageSourcePtr src)\n{\n    const char *detectZeroes = NULL;\n    const char *discard = NULL;\n    int detectZeroesMode = virDomainDiskGetDetectZeroesMode(src->discard,\n                                                            src->detect_zeroes);\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (qemuBlockNodeNameValidate(src->nodeformat) < 0)\n        return NULL;\n\n    if (src->discard)\n        discard = virDomainDiskDiscardTypeToString(src->discard);\n\n    if (detectZeroesMode)\n        detectZeroes = virDomainDiskDetectZeroesTypeToString(detectZeroesMode);\n\n    /* currently unhandled global properties:\n     * '*force-share': 'bool'\n     */\n\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:node-name\", src->nodeformat,\n                                 \"b:read-only\", src->readonly,\n                                 \"S:discard\", discard,\n                                 \"S:detect-zeroes\", detectZeroes,\n                                 NULL) < 0)\n        return NULL;\n\n    if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, props) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetFormatQcow2Props",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1307-1328",
    "snippet": "static int\nqemuBlockStorageSourceGetFormatQcow2Props(virStorageSourcePtr src,\n                                          virJSONValuePtr props)\n{\n    /* currently unhandled qcow2 props:\n     *\n     * 'lazy-refcounts'\n     * 'pass-discard-request'\n     * 'pass-discard-snapshot'\n     * 'pass-discard-other'\n     * 'overlap-check'\n     * 'l2-cache-size'\n     * 'l2-cache-entry-size'\n     * 'refcount-cache-size'\n     * 'cache-clean-interval'\n     */\n\n    if (qemuBlockStorageSourceGetFormatQcowGenericProps(src, \"qcow2\", props) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetFormatQcowGenericProps",
          "args": [
            "src",
            "\"qcow2\"",
            "props"
          ],
          "line": 1324
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetFormatQcowGenericProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1288-1304",
          "snippet": "static int\nqemuBlockStorageSourceGetFormatQcowGenericProps(virStorageSourcePtr src,\n                                                const char *format,\n                                                virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encprops = NULL;\n\n    if (qemuBlockStorageSourceGetCryptoProps(src, &encprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", format,\n                              \"A:encrypt\", &encprops, NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetFormatQcowGenericProps(virStorageSourcePtr src,\n                                                const char *format,\n                                                virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encprops = NULL;\n\n    if (qemuBlockStorageSourceGetCryptoProps(src, &encprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", format,\n                              \"A:encrypt\", &encprops, NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetFormatQcow2Props(virStorageSourcePtr src,\n                                          virJSONValuePtr props)\n{\n    /* currently unhandled qcow2 props:\n     *\n     * 'lazy-refcounts'\n     * 'pass-discard-request'\n     * 'pass-discard-snapshot'\n     * 'pass-discard-other'\n     * 'overlap-check'\n     * 'l2-cache-size'\n     * 'l2-cache-entry-size'\n     * 'refcount-cache-size'\n     * 'cache-clean-interval'\n     */\n\n    if (qemuBlockStorageSourceGetFormatQcowGenericProps(src, \"qcow2\", props) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetFormatQcowGenericProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1288-1304",
    "snippet": "static int\nqemuBlockStorageSourceGetFormatQcowGenericProps(virStorageSourcePtr src,\n                                                const char *format,\n                                                virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encprops = NULL;\n\n    if (qemuBlockStorageSourceGetCryptoProps(src, &encprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", format,\n                              \"A:encrypt\", &encprops, NULL) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "props",
            "\"s:driver\"",
            "format",
            "\"A:encrypt\"",
            "&encprops",
            "NULL"
          ],
          "line": 1298
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetCryptoProps",
          "args": [
            "src",
            "&encprops"
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetCryptoProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1245-1285",
          "snippet": "static int\nqemuBlockStorageSourceGetCryptoProps(virStorageSourcePtr src,\n                                     virJSONValuePtr *encprops)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    const char *encformat = NULL;\n\n    *encprops = NULL;\n\n    /* qemu requires encrypted secrets regardless of encryption method used when\n     * passed using the blockdev infrastructure, thus only\n     * VIR_DOMAIN_SECRET_INFO_TYPE_AES works here. The correct type needs to be\n     * instantiated elsewhere. */\n    if (!src->encryption ||\n        !srcpriv ||\n        !srcpriv->encinfo ||\n        srcpriv->encinfo->type != VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        return 0;\n\n    switch ((virStorageEncryptionFormatType) src->encryption->format) {\n    case VIR_STORAGE_ENCRYPTION_FORMAT_QCOW:\n        encformat = \"aes\";\n        break;\n\n    case VIR_STORAGE_ENCRYPTION_FORMAT_LUKS:\n        encformat = \"luks\";\n        break;\n\n    case VIR_STORAGE_ENCRYPTION_FORMAT_DEFAULT:\n    case VIR_STORAGE_ENCRYPTION_FORMAT_LAST:\n    default:\n        virReportEnumRangeError(virStorageEncryptionFormatType,\n                                src->encryption->format);\n        return -1;\n    }\n\n    return virJSONValueObjectCreate(encprops,\n                                    \"s:format\", encformat,\n                                    \"s:key-secret\", srcpriv->encinfo->s.aes.alias,\n                                    NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetCryptoProps(virStorageSourcePtr src,\n                                     virJSONValuePtr *encprops)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    const char *encformat = NULL;\n\n    *encprops = NULL;\n\n    /* qemu requires encrypted secrets regardless of encryption method used when\n     * passed using the blockdev infrastructure, thus only\n     * VIR_DOMAIN_SECRET_INFO_TYPE_AES works here. The correct type needs to be\n     * instantiated elsewhere. */\n    if (!src->encryption ||\n        !srcpriv ||\n        !srcpriv->encinfo ||\n        srcpriv->encinfo->type != VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        return 0;\n\n    switch ((virStorageEncryptionFormatType) src->encryption->format) {\n    case VIR_STORAGE_ENCRYPTION_FORMAT_QCOW:\n        encformat = \"aes\";\n        break;\n\n    case VIR_STORAGE_ENCRYPTION_FORMAT_LUKS:\n        encformat = \"luks\";\n        break;\n\n    case VIR_STORAGE_ENCRYPTION_FORMAT_DEFAULT:\n    case VIR_STORAGE_ENCRYPTION_FORMAT_LAST:\n    default:\n        virReportEnumRangeError(virStorageEncryptionFormatType,\n                                src->encryption->format);\n        return -1;\n    }\n\n    return virJSONValueObjectCreate(encprops,\n                                    \"s:format\", encformat,\n                                    \"s:key-secret\", srcpriv->encinfo->s.aes.alias,\n                                    NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetFormatQcowGenericProps(virStorageSourcePtr src,\n                                                const char *format,\n                                                virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) encprops = NULL;\n\n    if (qemuBlockStorageSourceGetCryptoProps(src, &encprops) < 0)\n        return -1;\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", format,\n                              \"A:encrypt\", &encprops, NULL) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetCryptoProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1245-1285",
    "snippet": "static int\nqemuBlockStorageSourceGetCryptoProps(virStorageSourcePtr src,\n                                     virJSONValuePtr *encprops)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    const char *encformat = NULL;\n\n    *encprops = NULL;\n\n    /* qemu requires encrypted secrets regardless of encryption method used when\n     * passed using the blockdev infrastructure, thus only\n     * VIR_DOMAIN_SECRET_INFO_TYPE_AES works here. The correct type needs to be\n     * instantiated elsewhere. */\n    if (!src->encryption ||\n        !srcpriv ||\n        !srcpriv->encinfo ||\n        srcpriv->encinfo->type != VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        return 0;\n\n    switch ((virStorageEncryptionFormatType) src->encryption->format) {\n    case VIR_STORAGE_ENCRYPTION_FORMAT_QCOW:\n        encformat = \"aes\";\n        break;\n\n    case VIR_STORAGE_ENCRYPTION_FORMAT_LUKS:\n        encformat = \"luks\";\n        break;\n\n    case VIR_STORAGE_ENCRYPTION_FORMAT_DEFAULT:\n    case VIR_STORAGE_ENCRYPTION_FORMAT_LAST:\n    default:\n        virReportEnumRangeError(virStorageEncryptionFormatType,\n                                src->encryption->format);\n        return -1;\n    }\n\n    return virJSONValueObjectCreate(encprops,\n                                    \"s:format\", encformat,\n                                    \"s:key-secret\", srcpriv->encinfo->s.aes.alias,\n                                    NULL);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "encprops",
            "\"s:format\"",
            "encformat",
            "\"s:key-secret\"",
            "srcpriv->encinfo->s.aes.alias",
            "NULL"
          ],
          "line": 1281
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virStorageEncryptionFormatType",
            "src->encryption->format"
          ],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE",
          "args": [
            "src"
          ],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetCryptoProps(virStorageSourcePtr src,\n                                     virJSONValuePtr *encprops)\n{\n    qemuDomainStorageSourcePrivatePtr srcpriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    const char *encformat = NULL;\n\n    *encprops = NULL;\n\n    /* qemu requires encrypted secrets regardless of encryption method used when\n     * passed using the blockdev infrastructure, thus only\n     * VIR_DOMAIN_SECRET_INFO_TYPE_AES works here. The correct type needs to be\n     * instantiated elsewhere. */\n    if (!src->encryption ||\n        !srcpriv ||\n        !srcpriv->encinfo ||\n        srcpriv->encinfo->type != VIR_DOMAIN_SECRET_INFO_TYPE_AES)\n        return 0;\n\n    switch ((virStorageEncryptionFormatType) src->encryption->format) {\n    case VIR_STORAGE_ENCRYPTION_FORMAT_QCOW:\n        encformat = \"aes\";\n        break;\n\n    case VIR_STORAGE_ENCRYPTION_FORMAT_LUKS:\n        encformat = \"luks\";\n        break;\n\n    case VIR_STORAGE_ENCRYPTION_FORMAT_DEFAULT:\n    case VIR_STORAGE_ENCRYPTION_FORMAT_LAST:\n    default:\n        virReportEnumRangeError(virStorageEncryptionFormatType,\n                                src->encryption->format);\n        return -1;\n    }\n\n    return virJSONValueObjectCreate(encprops,\n                                    \"s:format\", encformat,\n                                    \"s:key-secret\", srcpriv->encinfo->s.aes.alias,\n                                    NULL);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetFormatRawProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1224-1242",
    "snippet": "static int\nqemuBlockStorageSourceGetFormatRawProps(virStorageSourcePtr src,\n                                        virJSONValuePtr props)\n{\n    if (virJSONValueObjectAdd(props, \"s:driver\", \"raw\", NULL) < 0)\n        return -1;\n\n    /* Currently only storage slices are supported. We'll have to calculate\n     * the union of the slices here if we don't want to be adding needless\n     * 'raw' nodes. */\n    if (src->sliceStorage &&\n        virJSONValueObjectAdd(props,\n                              \"U:offset\", src->sliceStorage->offset,\n                              \"U:size\", src->sliceStorage->size,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "props",
            "\"U:offset\"",
            "src->sliceStorage->offset",
            "\"U:size\"",
            "src->sliceStorage->size",
            "NULL"
          ],
          "line": 1235
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetFormatRawProps(virStorageSourcePtr src,\n                                        virJSONValuePtr props)\n{\n    if (virJSONValueObjectAdd(props, \"s:driver\", \"raw\", NULL) < 0)\n        return -1;\n\n    /* Currently only storage slices are supported. We'll have to calculate\n     * the union of the slices here if we don't want to be adding needless\n     * 'raw' nodes. */\n    if (src->sliceStorage &&\n        virJSONValueObjectAdd(props,\n                              \"U:offset\", src->sliceStorage->offset,\n                              \"U:size\", src->sliceStorage->size,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetFormatLUKSProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1202-1221",
    "snippet": "static int\nqemuBlockStorageSourceGetFormatLUKSProps(virStorageSourcePtr src,\n                                         virJSONValuePtr props)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n\n    if (!srcPriv || !srcPriv->encinfo || !srcPriv->encinfo->s.aes.alias) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing secret info for 'luks' driver\"));\n        return -1;\n    }\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", \"luks\",\n                              \"s:key-secret\", srcPriv->encinfo->s.aes.alias,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "props",
            "\"s:driver\"",
            "\"luks\"",
            "\"s:key-secret\"",
            "srcPriv->encinfo->s.aes.alias",
            "NULL"
          ],
          "line": 1214
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing secret info for 'luks' driver\")"
          ],
          "line": 1209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing secret info for 'luks' driver\""
          ],
          "line": 1210
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE",
          "args": [
            "src"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetFormatLUKSProps(virStorageSourcePtr src,\n                                         virJSONValuePtr props)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n\n    if (!srcPriv || !srcPriv->encinfo || !srcPriv->encinfo->s.aes.alias) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing secret info for 'luks' driver\"));\n        return -1;\n    }\n\n    if (virJSONValueObjectAdd(props,\n                              \"s:driver\", \"luks\",\n                              \"s:key-secret\", srcPriv->encinfo->s.aes.alias,\n                              NULL) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetBackendProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1055-1199",
    "snippet": "virJSONValuePtr\nqemuBlockStorageSourceGetBackendProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget,\n                                      bool autoreadonly)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) fileprops = NULL;\n    const char *driver = NULL;\n    virTristateBool aro = VIR_TRISTATE_BOOL_ABSENT;\n    virTristateBool ro = VIR_TRISTATE_BOOL_ABSENT;\n\n    if (autoreadonly) {\n        aro = VIR_TRISTATE_BOOL_YES;\n    } else {\n        if (src->readonly)\n            ro = VIR_TRISTATE_BOOL_YES;\n        else\n            ro = VIR_TRISTATE_BOOL_NO;\n    }\n\n    switch ((virStorageType)actualType) {\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_FILE:\n        if (virStorageSourceIsBlockLocal(src)) {\n            if (src->hostcdrom)\n                driver = \"host_cdrom\";\n            else\n                driver = \"host_device\";\n        } else {\n            driver = \"file\";\n        }\n\n        if (!(fileprops = qemuBlockStorageSourceGetFileProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_DIR:\n        /* qemu handles directories by exposing them as a device with emulated\n         * FAT filesystem */\n        if (!(fileprops = qemuBlockStorageSourceGetVvfatProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_NVME:\n        if (!(fileprops = qemuBlockStorageSourceGetNVMeProps(src)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_VOLUME:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage source pool '%s' volume '%s' is not translated\"),\n                       src->srcpool->pool, src->srcpool->volume);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n        virReportEnumRangeError(virStorageType, actualType);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(fileprops = qemuBlockStorageSourceGetGlusterProps(src, legacy, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            driver = \"vxhs\";\n            if (!(fileprops = qemuBlockStorageSourceGetVxHSProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            driver = virStorageNetProtocolTypeToString(src->protocol);\n            if (!(fileprops = qemuBlockStorageSourceGetCURLProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            driver = \"iscsi\";\n            if (!(fileprops = qemuBlockStorageSourceGetISCSIProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n            driver = \"nbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetNBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetRBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(fileprops = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(fileprops = qemuBlockStorageSourceGetSshProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            virReportEnumRangeError(virStorageNetProtocol, src->protocol);\n            return NULL;\n        }\n        break;\n    }\n\n    if (driver && virJSONValueObjectPrependString(fileprops, \"driver\", driver) < 0)\n        return NULL;\n\n    if (!onlytarget) {\n        if (qemuBlockNodeNameValidate(src->nodestorage) < 0 ||\n            virJSONValueObjectAdd(fileprops, \"S:node-name\", src->nodestorage, NULL) < 0)\n            return NULL;\n\n        if (!legacy) {\n            if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, fileprops) < 0)\n                return NULL;\n\n            if (virJSONValueObjectAdd(fileprops,\n                                      \"T:read-only\", ro,\n                                      \"T:auto-read-only\", aro,\n                                      \"s:discard\", \"unmap\",\n                                      NULL) < 0)\n                return NULL;\n        }\n    }\n\n    return g_steal_pointer(&fileprops);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&fileprops"
          ],
          "line": 1198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "fileprops",
            "\"T:read-only\"",
            "ro",
            "\"T:auto-read-only\"",
            "aro",
            "\"s:discard\"",
            "\"unmap\"",
            "NULL"
          ],
          "line": 1189
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetBlockdevGetCacheProps",
          "args": [
            "src",
            "fileprops"
          ],
          "line": 1186
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetBlockdevGetCacheProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "1017-1042",
          "snippet": "static int\nqemuBlockStorageSourceGetBlockdevGetCacheProps(virStorageSourcePtr src,\n                                               virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) cacheobj = NULL;\n    bool direct = false;\n    bool noflush = false;\n\n    if (src->cachemode == VIR_DOMAIN_DISK_CACHE_DEFAULT)\n        return 0;\n\n    if (qemuDomainDiskCachemodeFlags(src->cachemode, NULL, &direct, &noflush) < 0)\n        return -1;\n\n    if (virJSONValueObjectCreate(&cacheobj,\n                                 \"b:direct\", direct,\n                                 \"b:no-flush\", noflush,\n                                 NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAppend(props, \"cache\", cacheobj) < 0)\n        return -1;\n    cacheobj = NULL;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetBlockdevGetCacheProps(virStorageSourcePtr src,\n                                               virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) cacheobj = NULL;\n    bool direct = false;\n    bool noflush = false;\n\n    if (src->cachemode == VIR_DOMAIN_DISK_CACHE_DEFAULT)\n        return 0;\n\n    if (qemuDomainDiskCachemodeFlags(src->cachemode, NULL, &direct, &noflush) < 0)\n        return -1;\n\n    if (virJSONValueObjectCreate(&cacheobj,\n                                 \"b:direct\", direct,\n                                 \"b:no-flush\", noflush,\n                                 NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAppend(props, \"cache\", cacheobj) < 0)\n        return -1;\n    cacheobj = NULL;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockNodeNameValidate",
          "args": [
            "src->nodestorage"
          ],
          "line": 1181
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockNodeNameValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "38-51",
          "snippet": "static int\nqemuBlockNodeNameValidate(const char *nn)\n{\n    if (!nn)\n        return 0;\n\n    if (strlen(nn) >= qemuBlockNodeNameBufSize) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"node-name '%s' too long for qemu\"), nn);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const size_t qemuBlockNodeNameBufSize = 32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic const size_t qemuBlockNodeNameBufSize = 32;\n\nstatic int\nqemuBlockNodeNameValidate(const char *nn)\n{\n    if (!nn)\n        return 0;\n\n    if (strlen(nn) >= qemuBlockNodeNameBufSize) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"node-name '%s' too long for qemu\"), nn);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectPrependString",
          "args": [
            "fileprops",
            "\"driver\"",
            "driver"
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectPrependString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "652-658",
          "snippet": "int\nvirJSONValueObjectPrependString(virJSONValuePtr object,\n                                const char *key,\n                                const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, true);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectPrependString(virJSONValuePtr object,\n                                const char *key,\n                                const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virStorageNetProtocol",
            "src->protocol"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetSshProps",
          "args": [
            "src"
          ],
          "line": 1165
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetSshProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "908-946",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetSshProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) host_key_check = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0]);\n    if (!serverprops)\n        return NULL;\n\n    if (src->auth)\n        username = src->auth->username;\n    else if (src->ssh_user)\n        username = src->ssh_user;\n\n    if (src->ssh_host_key_check_disabled &&\n        virJSONValueObjectCreate(&host_key_check,\n                                 \"s:mode\", \"none\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &serverprops,\n                                 \"S:user\", username,\n                                 \"A:host-key-check\", &host_key_check,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetSshProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) host_key_check = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0]);\n    if (!serverprops)\n        return NULL;\n\n    if (src->auth)\n        username = src->auth->username;\n    else if (src->ssh_user)\n        username = src->ssh_user;\n\n    if (src->ssh_host_key_check_disabled &&\n        virJSONValueObjectCreate(&host_key_check,\n                                 \"s:mode\", \"none\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &serverprops,\n                                 \"S:user\", username,\n                                 \"A:host-key-check\", &host_key_check,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetSheepdogProps",
          "args": [
            "src"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetSheepdogProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "880-905",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetSheepdogProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    /* libvirt does not support the 'snap-id' and 'tag' properties */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"s:vdi\", src->path,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetSheepdogProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    /* libvirt does not support the 'snap-id' and 'tag' properties */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"s:vdi\", src->path,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetRBDProps",
          "args": [
            "src",
            "onlytarget"
          ],
          "line": 1153
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetRBDProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "829-877",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetRBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) servers = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) authmodes = NULL;\n    g_autoptr(virJSONValue) mode = NULL;\n    const char *keysecret = NULL;\n\n    if (src->nhosts > 0 &&\n        !(servers = qemuBlockStorageSourceBuildHostsJSONInetSocketAddress(src)))\n        return NULL;\n\n    if (!onlytarget && src->auth) {\n        username = srcPriv->secinfo->s.aes.username;\n        keysecret = srcPriv->secinfo->s.aes.alias;\n        /* the auth modes are modelled after our old command line generator */\n        authmodes = virJSONValueNewArray();\n\n        if (!(mode = virJSONValueNewString(\"cephx\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n\n        if (!(mode = virJSONValueNewString(\"none\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n    }\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:pool\", src->volume,\n                                 \"s:image\", src->path,\n                                 \"S:snapshot\", src->snapshot,\n                                 \"S:conf\", src->configFile,\n                                 \"A:server\", &servers,\n                                 \"S:user\", username,\n                                 \"A:auth-client-required\", &authmodes,\n                                 \"S:key-secret\", keysecret,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetRBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) servers = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) authmodes = NULL;\n    g_autoptr(virJSONValue) mode = NULL;\n    const char *keysecret = NULL;\n\n    if (src->nhosts > 0 &&\n        !(servers = qemuBlockStorageSourceBuildHostsJSONInetSocketAddress(src)))\n        return NULL;\n\n    if (!onlytarget && src->auth) {\n        username = srcPriv->secinfo->s.aes.username;\n        keysecret = srcPriv->secinfo->s.aes.alias;\n        /* the auth modes are modelled after our old command line generator */\n        authmodes = virJSONValueNewArray();\n\n        if (!(mode = virJSONValueNewString(\"cephx\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n\n        if (!(mode = virJSONValueNewString(\"none\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n    }\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:pool\", src->volume,\n                                 \"s:image\", src->path,\n                                 \"S:snapshot\", src->snapshot,\n                                 \"S:conf\", src->configFile,\n                                 \"A:server\", &servers,\n                                 \"S:user\", username,\n                                 \"A:auth-client-required\", &authmodes,\n                                 \"S:key-secret\", keysecret,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetNBDProps",
          "args": [
            "src",
            "onlytarget"
          ],
          "line": 1147
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetNBDProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "796-826",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetNBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    const char *tlsAlias = src->tlsAlias;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"nbd protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    if (onlytarget)\n        tlsAlias = NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"S:export\", src->path,\n                                 \"S:tls-creds\", tlsAlias,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetNBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    const char *tlsAlias = src->tlsAlias;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"nbd protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    if (onlytarget)\n        tlsAlias = NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"S:export\", src->path,\n                                 \"S:tls-creds\", tlsAlias,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetISCSIProps",
          "args": [
            "src",
            "onlytarget"
          ],
          "line": 1141
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetISCSIProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "733-793",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetISCSIProps(virStorageSourcePtr src,\n                                    bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autofree char *target = NULL;\n    char *lunStr = NULL;\n    char *username = NULL;\n    char *objalias = NULL;\n    g_autofree char *portal = NULL;\n    unsigned int lun = 0;\n    virJSONValuePtr ret = NULL;\n\n    /* { driver:\"iscsi\",\n     *   transport:\"tcp\",  (\"iser\" also possible)\n     *   portal:\"example.com\",\n     *   target:\"iqn.2017-04.com.example:iscsi-disks\",\n     *   lun:1,\n     *   user:\"username\",\n     *   password-secret:\"secret-alias\",\n     *   initiator-name:\"iqn.2017-04.com.example:client\"\n     * }\n     */\n\n    target = g_strdup(src->path);\n\n    /* Separate the target and lun */\n    if ((lunStr = strchr(target, '/'))) {\n        *(lunStr++) = '\\0';\n        if (virStrToLong_ui(lunStr, NULL, 10, &lun) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot parse target for lunStr '%s'\"),\n                           target);\n            return NULL;\n        }\n    }\n\n    /* combine host and port into portal */\n    if (virSocketAddrNumericFamily(src->hosts[0].name) == AF_INET6) {\n        portal = g_strdup_printf(\"[%s]:%u\", src->hosts[0].name,\n                                 src->hosts[0].port);\n    } else {\n        portal = g_strdup_printf(\"%s:%u\", src->hosts[0].name, src->hosts[0].port);\n    }\n\n    if (!onlytarget && src->auth) {\n        username = src->auth->username;\n        objalias = srcPriv->secinfo->s.aes.alias;\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:portal\", portal,\n                                          \"s:target\", target,\n                                          \"u:lun\", lun,\n                                          \"s:transport\", \"tcp\",\n                                          \"S:user\", username,\n                                          \"S:password-secret\", objalias,\n                                          \"S:initiator-name\", src->initiator.iqn,\n                                          NULL));\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetISCSIProps(virStorageSourcePtr src,\n                                    bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autofree char *target = NULL;\n    char *lunStr = NULL;\n    char *username = NULL;\n    char *objalias = NULL;\n    g_autofree char *portal = NULL;\n    unsigned int lun = 0;\n    virJSONValuePtr ret = NULL;\n\n    /* { driver:\"iscsi\",\n     *   transport:\"tcp\",  (\"iser\" also possible)\n     *   portal:\"example.com\",\n     *   target:\"iqn.2017-04.com.example:iscsi-disks\",\n     *   lun:1,\n     *   user:\"username\",\n     *   password-secret:\"secret-alias\",\n     *   initiator-name:\"iqn.2017-04.com.example:client\"\n     * }\n     */\n\n    target = g_strdup(src->path);\n\n    /* Separate the target and lun */\n    if ((lunStr = strchr(target, '/'))) {\n        *(lunStr++) = '\\0';\n        if (virStrToLong_ui(lunStr, NULL, 10, &lun) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot parse target for lunStr '%s'\"),\n                           target);\n            return NULL;\n        }\n    }\n\n    /* combine host and port into portal */\n    if (virSocketAddrNumericFamily(src->hosts[0].name) == AF_INET6) {\n        portal = g_strdup_printf(\"[%s]:%u\", src->hosts[0].name,\n                                 src->hosts[0].port);\n    } else {\n        portal = g_strdup_printf(\"%s:%u\", src->hosts[0].name, src->hosts[0].port);\n    }\n\n    if (!onlytarget && src->auth) {\n        username = src->auth->username;\n        objalias = srcPriv->secinfo->s.aes.alias;\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:portal\", portal,\n                                          \"s:target\", target,\n                                          \"u:lun\", lun,\n                                          \"s:transport\", \"tcp\",\n                                          \"S:user\", username,\n                                          \"S:password-secret\", objalias,\n                                          \"S:initiator-name\", src->initiator.iqn,\n                                          NULL));\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetCURLProps",
          "args": [
            "src",
            "onlytarget"
          ],
          "line": 1135
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetCURLProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "677-730",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetCURLProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    const char *passwordalias = NULL;\n    const char *cookiealias = NULL;\n    const char *username = NULL;\n    virJSONValuePtr ret = NULL;\n    g_autoptr(virURI) uri = NULL;\n    g_autofree char *uristr = NULL;\n\n    /**\n     * Common options:\n     * url, readahead, timeout, username, password-secret, proxy-username,\n     * proxy-password-secret\n     *\n     * Options for http transport:\n     * cookie, cookie-secret\n     *\n     * Options for secure transport (ftps, https):\n     * sslverify\n     */\n\n\n    if (!(uri = qemuBlockStorageSourceGetURI(src)))\n        return NULL;\n\n    if (!(uristr = virURIFormat(uri)))\n        return NULL;\n\n    if (!onlytarget) {\n        if (src->auth) {\n            username = src->auth->username;\n            passwordalias = srcPriv->secinfo->s.aes.alias;\n        }\n\n        if (srcPriv &&\n            srcPriv->httpcookie)\n            cookiealias = srcPriv->httpcookie->s.aes.alias;\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:url\", uristr,\n                                          \"S:username\", username,\n                                          \"S:password-secret\", passwordalias,\n                                          \"T:sslverify\", src->sslverify,\n                                          \"S:cookie-secret\", cookiealias,\n                                          \"P:timeout\", src->timeout,\n                                          \"P:readahead\", src->readahead,\n                                          NULL));\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetCURLProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    const char *passwordalias = NULL;\n    const char *cookiealias = NULL;\n    const char *username = NULL;\n    virJSONValuePtr ret = NULL;\n    g_autoptr(virURI) uri = NULL;\n    g_autofree char *uristr = NULL;\n\n    /**\n     * Common options:\n     * url, readahead, timeout, username, password-secret, proxy-username,\n     * proxy-password-secret\n     *\n     * Options for http transport:\n     * cookie, cookie-secret\n     *\n     * Options for secure transport (ftps, https):\n     * sslverify\n     */\n\n\n    if (!(uri = qemuBlockStorageSourceGetURI(src)))\n        return NULL;\n\n    if (!(uristr = virURIFormat(uri)))\n        return NULL;\n\n    if (!onlytarget) {\n        if (src->auth) {\n            username = src->auth->username;\n            passwordalias = srcPriv->secinfo->s.aes.alias;\n        }\n\n        if (srcPriv &&\n            srcPriv->httpcookie)\n            cookiealias = srcPriv->httpcookie->s.aes.alias;\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:url\", uristr,\n                                          \"S:username\", username,\n                                          \"S:password-secret\", passwordalias,\n                                          \"T:sslverify\", src->sslverify,\n                                          \"S:cookie-secret\", cookiealias,\n                                          \"P:timeout\", src->timeout,\n                                          \"P:readahead\", src->readahead,\n                                          NULL));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageNetProtocolTypeToString",
          "args": [
            "src->protocol"
          ],
          "line": 1134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetVxHSProps",
          "args": [
            "src",
            "onlytarget"
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetVxHSProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "642-674",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetVxHSProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *tlsAlias = src->tlsAlias;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"VxHS protocol accepts only one host\"));\n        return NULL;\n    }\n\n    if (!(server = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0])))\n        return NULL;\n\n    if (onlytarget)\n        tlsAlias = NULL;\n\n    /* VxHS disk specification example:\n     * { driver:\"vxhs\",\n     *   tls-creds:\"objvirtio-disk0_tls0\",\n     *   vdisk-id:\"eb90327c-8302-4725-4e85ed4dc251\",\n     *   server:{type:\"tcp\", host:\"1.2.3.4\", port:9999}}\n     */\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"S:tls-creds\", tlsAlias,\n                                          \"s:vdisk-id\", src->path,\n                                          \"a:server\", &server, NULL));\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetVxHSProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *tlsAlias = src->tlsAlias;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"VxHS protocol accepts only one host\"));\n        return NULL;\n    }\n\n    if (!(server = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0])))\n        return NULL;\n\n    if (onlytarget)\n        tlsAlias = NULL;\n\n    /* VxHS disk specification example:\n     * { driver:\"vxhs\",\n     *   tls-creds:\"objvirtio-disk0_tls0\",\n     *   vdisk-id:\"eb90327c-8302-4725-4e85ed4dc251\",\n     *   server:{type:\"tcp\", host:\"1.2.3.4\", port:9999}}\n     */\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"S:tls-creds\", tlsAlias,\n                                          \"s:vdisk-id\", src->path,\n                                          \"a:server\", &server, NULL));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetGlusterProps",
          "args": [
            "src",
            "legacy",
            "onlytarget"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetGlusterProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "610-639",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetGlusterProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(servers = qemuBlockStorageSourceBuildHostsJSONSocketAddress(src, legacy)))\n        return NULL;\n\n     /* { driver:\"gluster\",\n      *   volume:\"testvol\",\n      *   path:\"/a.img\",\n      *   server :[{type:\"tcp\", host:\"1.2.3.4\", port:24007},\n      *            {type:\"unix\", socket:\"/tmp/glusterd.socket\"}, ...]}\n      */\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:volume\", src->volume,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &servers, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        src->debug &&\n        virJSONValueObjectAdd(props, \"u:debug\", src->debugLevel, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetGlusterProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(servers = qemuBlockStorageSourceBuildHostsJSONSocketAddress(src, legacy)))\n        return NULL;\n\n     /* { driver:\"gluster\",\n      *   volume:\"testvol\",\n      *   path:\"/a.img\",\n      *   server :[{type:\"tcp\", host:\"1.2.3.4\", port:24007},\n      *            {type:\"unix\", socket:\"/tmp/glusterd.socket\"}, ...]}\n      */\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:volume\", src->volume,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &servers, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        src->debug &&\n        virJSONValueObjectAdd(props, \"u:debug\", src->debugLevel, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virStorageType",
            "actualType"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"storage source pool '%s' volume '%s' is not translated\")",
            "src->srcpool->pool",
            "src->srcpool->volume"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage source pool '%s' volume '%s' is not translated\""
          ],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetNVMeProps",
          "args": [
            "src"
          ],
          "line": 1100
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetNVMeProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "998-1014",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetNVMeProps(virStorageSourcePtr src)\n{\n    const virStorageSourceNVMeDef *nvme = src->nvme;\n    g_autofree char *pciAddr = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (!(pciAddr = virPCIDeviceAddressAsString(&nvme->pciAddr)))\n        return NULL;\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:driver\", \"nvme\",\n                                          \"s:device\", pciAddr,\n                                          \"U:namespace\", nvme->namespace,\n                                          NULL));\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetNVMeProps(virStorageSourcePtr src)\n{\n    const virStorageSourceNVMeDef *nvme = src->nvme;\n    g_autofree char *pciAddr = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (!(pciAddr = virPCIDeviceAddressAsString(&nvme->pciAddr)))\n        return NULL;\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:driver\", \"nvme\",\n                                          \"s:device\", pciAddr,\n                                          \"U:namespace\", nvme->namespace,\n                                          NULL));\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetVvfatProps",
          "args": [
            "src",
            "onlytarget"
          ],
          "line": 1095
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetVvfatProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "974-995",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetVvfatProps(virStorageSourcePtr src,\n                                    bool onlytarget)\n{\n    g_autoptr(virJSONValue) ret = NULL;\n\n    /* libvirt currently does not handle the following attributes:\n     * '*fat-type': 'int'\n     * '*label': 'str'\n     */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:driver\", \"vvfat\",\n                                 \"s:dir\", src->path,\n                                 \"b:floppy\", src->floppyimg, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        virJSONValueObjectAdd(ret, \"b:rw\", !src->readonly, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetVvfatProps(virStorageSourcePtr src,\n                                    bool onlytarget)\n{\n    g_autoptr(virJSONValue) ret = NULL;\n\n    /* libvirt currently does not handle the following attributes:\n     * '*fat-type': 'int'\n     * '*label': 'str'\n     */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:driver\", \"vvfat\",\n                                 \"s:dir\", src->path,\n                                 \"b:floppy\", src->floppyimg, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        virJSONValueObjectAdd(ret, \"b:rw\", !src->readonly, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetFileProps",
          "args": [
            "src",
            "onlytarget"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetFileProps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "949-971",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetFileProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    const char *iomode = NULL;\n    const char *prManagerAlias = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (!onlytarget) {\n        if (src->pr)\n            prManagerAlias = src->pr->mgralias;\n\n        if (src->iomode != VIR_DOMAIN_DISK_IO_DEFAULT)\n            iomode = virDomainDiskIoTypeToString(src->iomode);\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:filename\", src->path,\n                                          \"S:aio\", iomode,\n                                          \"S:pr-manager\", prManagerAlias,\n                                          NULL) < 0);\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetFileProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    const char *iomode = NULL;\n    const char *prManagerAlias = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (!onlytarget) {\n        if (src->pr)\n            prManagerAlias = src->pr->mgralias;\n\n        if (src->iomode != VIR_DOMAIN_DISK_IO_DEFAULT)\n            iomode = virDomainDiskIoTypeToString(src->iomode);\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:filename\", src->path,\n                                          \"S:aio\", iomode,\n                                          \"S:pr-manager\", prManagerAlias,\n                                          NULL) < 0);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBlockLocal",
          "args": [
            "src"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBlockLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2643-2647",
          "snippet": "bool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceGetActualType",
          "args": [
            "src"
          ],
          "line": 1061
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceGetActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2574-2583",
          "snippet": "int\nvirStorageSourceGetActualType(const virStorageSource *def)\n{\n    if (def->type == VIR_STORAGE_TYPE_VOLUME &&\n        def->srcpool &&\n        def->srcpool->actualtype != VIR_STORAGE_TYPE_NONE)\n        return def->srcpool->actualtype;\n\n    return def->type;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nint\nvirStorageSourceGetActualType(const virStorageSource *def)\n{\n    if (def->type == VIR_STORAGE_TYPE_VOLUME &&\n        def->srcpool &&\n        def->srcpool->actualtype != VIR_STORAGE_TYPE_NONE)\n        return def->srcpool->actualtype;\n\n    return def->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuBlockStorageSourceGetBackendProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget,\n                                      bool autoreadonly)\n{\n    int actualType = virStorageSourceGetActualType(src);\n    g_autoptr(virJSONValue) fileprops = NULL;\n    const char *driver = NULL;\n    virTristateBool aro = VIR_TRISTATE_BOOL_ABSENT;\n    virTristateBool ro = VIR_TRISTATE_BOOL_ABSENT;\n\n    if (autoreadonly) {\n        aro = VIR_TRISTATE_BOOL_YES;\n    } else {\n        if (src->readonly)\n            ro = VIR_TRISTATE_BOOL_YES;\n        else\n            ro = VIR_TRISTATE_BOOL_NO;\n    }\n\n    switch ((virStorageType)actualType) {\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_FILE:\n        if (virStorageSourceIsBlockLocal(src)) {\n            if (src->hostcdrom)\n                driver = \"host_cdrom\";\n            else\n                driver = \"host_device\";\n        } else {\n            driver = \"file\";\n        }\n\n        if (!(fileprops = qemuBlockStorageSourceGetFileProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_DIR:\n        /* qemu handles directories by exposing them as a device with emulated\n         * FAT filesystem */\n        if (!(fileprops = qemuBlockStorageSourceGetVvfatProps(src, onlytarget)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_NVME:\n        if (!(fileprops = qemuBlockStorageSourceGetNVMeProps(src)))\n            return NULL;\n        break;\n\n    case VIR_STORAGE_TYPE_VOLUME:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage source pool '%s' volume '%s' is not translated\"),\n                       src->srcpool->pool, src->srcpool->volume);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NONE:\n    case VIR_STORAGE_TYPE_LAST:\n        virReportEnumRangeError(virStorageType, actualType);\n        return NULL;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n        switch ((virStorageNetProtocol) src->protocol) {\n        case VIR_STORAGE_NET_PROTOCOL_GLUSTER:\n            driver = \"gluster\";\n            if (!(fileprops = qemuBlockStorageSourceGetGlusterProps(src, legacy, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_VXHS:\n            driver = \"vxhs\";\n            if (!(fileprops = qemuBlockStorageSourceGetVxHSProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_HTTP:\n        case VIR_STORAGE_NET_PROTOCOL_HTTPS:\n        case VIR_STORAGE_NET_PROTOCOL_FTP:\n        case VIR_STORAGE_NET_PROTOCOL_FTPS:\n        case VIR_STORAGE_NET_PROTOCOL_TFTP:\n            driver = virStorageNetProtocolTypeToString(src->protocol);\n            if (!(fileprops = qemuBlockStorageSourceGetCURLProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_ISCSI:\n            driver = \"iscsi\";\n            if (!(fileprops = qemuBlockStorageSourceGetISCSIProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NBD:\n            driver = \"nbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetNBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_RBD:\n            driver = \"rbd\";\n            if (!(fileprops = qemuBlockStorageSourceGetRBDProps(src, onlytarget)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SHEEPDOG:\n            driver = \"sheepdog\";\n            if (!(fileprops = qemuBlockStorageSourceGetSheepdogProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_SSH:\n            driver = \"ssh\";\n            if (!(fileprops = qemuBlockStorageSourceGetSshProps(src)))\n                return NULL;\n            break;\n\n        case VIR_STORAGE_NET_PROTOCOL_NONE:\n        case VIR_STORAGE_NET_PROTOCOL_LAST:\n            virReportEnumRangeError(virStorageNetProtocol, src->protocol);\n            return NULL;\n        }\n        break;\n    }\n\n    if (driver && virJSONValueObjectPrependString(fileprops, \"driver\", driver) < 0)\n        return NULL;\n\n    if (!onlytarget) {\n        if (qemuBlockNodeNameValidate(src->nodestorage) < 0 ||\n            virJSONValueObjectAdd(fileprops, \"S:node-name\", src->nodestorage, NULL) < 0)\n            return NULL;\n\n        if (!legacy) {\n            if (qemuBlockStorageSourceGetBlockdevGetCacheProps(src, fileprops) < 0)\n                return NULL;\n\n            if (virJSONValueObjectAdd(fileprops,\n                                      \"T:read-only\", ro,\n                                      \"T:auto-read-only\", aro,\n                                      \"s:discard\", \"unmap\",\n                                      NULL) < 0)\n                return NULL;\n        }\n    }\n\n    return g_steal_pointer(&fileprops);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetBlockdevGetCacheProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "1017-1042",
    "snippet": "static int\nqemuBlockStorageSourceGetBlockdevGetCacheProps(virStorageSourcePtr src,\n                                               virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) cacheobj = NULL;\n    bool direct = false;\n    bool noflush = false;\n\n    if (src->cachemode == VIR_DOMAIN_DISK_CACHE_DEFAULT)\n        return 0;\n\n    if (qemuDomainDiskCachemodeFlags(src->cachemode, NULL, &direct, &noflush) < 0)\n        return -1;\n\n    if (virJSONValueObjectCreate(&cacheobj,\n                                 \"b:direct\", direct,\n                                 \"b:no-flush\", noflush,\n                                 NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAppend(props, \"cache\", cacheobj) < 0)\n        return -1;\n    cacheobj = NULL;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "props",
            "\"cache\"",
            "cacheobj"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&cacheobj",
            "\"b:direct\"",
            "direct",
            "\"b:no-flush\"",
            "noflush",
            "NULL"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainDiskCachemodeFlags",
          "args": [
            "src->cachemode",
            "NULL",
            "&direct",
            "&noflush"
          ],
          "line": 1028
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDiskCachemodeFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "16684-16749",
          "snippet": "int\nqemuDomainDiskCachemodeFlags(int cachemode,\n                             bool *writeback,\n                             bool *direct,\n                             bool *noflush)\n{\n    bool dummy;\n\n    if (!writeback)\n        writeback = &dummy;\n\n    if (!direct)\n        direct = &dummy;\n\n    if (!noflush)\n        noflush = &dummy;\n\n    /* Mapping of cache modes to the attributes according to qemu-options.hx\n     *               cache.writeback   cache.direct   cache.no-flush\n     * \n     * writeback     true              false          false\n     * none          true              true           false\n     * writethrough  false             false          false\n     * directsync    false             true           false\n     * unsafe        true              false          true\n     */\n    switch ((virDomainDiskCache) cachemode) {\n    case VIR_DOMAIN_DISK_CACHE_DISABLE: /* 'none' */\n        *writeback = true;\n        *direct = true;\n        *noflush = false;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_WRITETHRU:\n        *writeback = false;\n        *direct = false;\n        *noflush = false;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_WRITEBACK:\n        *writeback = true;\n        *direct = false;\n        *noflush = false;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_DIRECTSYNC:\n        *writeback = false;\n        *direct = true;\n        *noflush = false;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_UNSAFE:\n        *writeback = true;\n        *direct = false;\n        *noflush = true;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_DEFAULT:\n    case VIR_DOMAIN_DISK_CACHE_LAST:\n    default:\n        virReportEnumRangeError(virDomainDiskCache, cachemode);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nint\nqemuDomainDiskCachemodeFlags(int cachemode,\n                             bool *writeback,\n                             bool *direct,\n                             bool *noflush)\n{\n    bool dummy;\n\n    if (!writeback)\n        writeback = &dummy;\n\n    if (!direct)\n        direct = &dummy;\n\n    if (!noflush)\n        noflush = &dummy;\n\n    /* Mapping of cache modes to the attributes according to qemu-options.hx\n     *               cache.writeback   cache.direct   cache.no-flush\n     * \n     * writeback     true              false          false\n     * none          true              true           false\n     * writethrough  false             false          false\n     * directsync    false             true           false\n     * unsafe        true              false          true\n     */\n    switch ((virDomainDiskCache) cachemode) {\n    case VIR_DOMAIN_DISK_CACHE_DISABLE: /* 'none' */\n        *writeback = true;\n        *direct = true;\n        *noflush = false;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_WRITETHRU:\n        *writeback = false;\n        *direct = false;\n        *noflush = false;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_WRITEBACK:\n        *writeback = true;\n        *direct = false;\n        *noflush = false;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_DIRECTSYNC:\n        *writeback = false;\n        *direct = true;\n        *noflush = false;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_UNSAFE:\n        *writeback = true;\n        *direct = false;\n        *noflush = true;\n        break;\n\n    case VIR_DOMAIN_DISK_CACHE_DEFAULT:\n    case VIR_DOMAIN_DISK_CACHE_LAST:\n    default:\n        virReportEnumRangeError(virDomainDiskCache, cachemode);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockStorageSourceGetBlockdevGetCacheProps(virStorageSourcePtr src,\n                                               virJSONValuePtr props)\n{\n    g_autoptr(virJSONValue) cacheobj = NULL;\n    bool direct = false;\n    bool noflush = false;\n\n    if (src->cachemode == VIR_DOMAIN_DISK_CACHE_DEFAULT)\n        return 0;\n\n    if (qemuDomainDiskCachemodeFlags(src->cachemode, NULL, &direct, &noflush) < 0)\n        return -1;\n\n    if (virJSONValueObjectCreate(&cacheobj,\n                                 \"b:direct\", direct,\n                                 \"b:no-flush\", noflush,\n                                 NULL) < 0)\n        return -1;\n\n    if (virJSONValueObjectAppend(props, \"cache\", cacheobj) < 0)\n        return -1;\n    cacheobj = NULL;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetNVMeProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "998-1014",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetNVMeProps(virStorageSourcePtr src)\n{\n    const virStorageSourceNVMeDef *nvme = src->nvme;\n    g_autofree char *pciAddr = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (!(pciAddr = virPCIDeviceAddressAsString(&nvme->pciAddr)))\n        return NULL;\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:driver\", \"nvme\",\n                                          \"s:device\", pciAddr,\n                                          \"U:namespace\", nvme->namespace,\n                                          NULL));\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virJSONValueObjectCreate(&ret,\n                                          \"s:driver\", \"nvme\",\n                                          \"s:device\", pciAddr,\n                                          \"U:namespace\", nvme->namespace,\n                                          NULL)"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"s:driver\"",
            "\"nvme\"",
            "\"s:device\"",
            "pciAddr",
            "\"U:namespace\"",
            "nvme->namespace",
            "NULL"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressAsString",
          "args": [
            "&nvme->pciAddr"
          ],
          "line": 1005
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressAsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1351-1362",
          "snippet": "char *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nchar *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetNVMeProps(virStorageSourcePtr src)\n{\n    const virStorageSourceNVMeDef *nvme = src->nvme;\n    g_autofree char *pciAddr = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (!(pciAddr = virPCIDeviceAddressAsString(&nvme->pciAddr)))\n        return NULL;\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:driver\", \"nvme\",\n                                          \"s:device\", pciAddr,\n                                          \"U:namespace\", nvme->namespace,\n                                          NULL));\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetVvfatProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "974-995",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetVvfatProps(virStorageSourcePtr src,\n                                    bool onlytarget)\n{\n    g_autoptr(virJSONValue) ret = NULL;\n\n    /* libvirt currently does not handle the following attributes:\n     * '*fat-type': 'int'\n     * '*label': 'str'\n     */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:driver\", \"vvfat\",\n                                 \"s:dir\", src->path,\n                                 \"b:floppy\", src->floppyimg, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        virJSONValueObjectAdd(ret, \"b:rw\", !src->readonly, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&ret"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "ret",
            "\"b:rw\"",
            "!src->readonly",
            "NULL"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"s:driver\"",
            "\"vvfat\"",
            "\"s:dir\"",
            "src->path",
            "\"b:floppy\"",
            "src->floppyimg",
            "NULL"
          ],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetVvfatProps(virStorageSourcePtr src,\n                                    bool onlytarget)\n{\n    g_autoptr(virJSONValue) ret = NULL;\n\n    /* libvirt currently does not handle the following attributes:\n     * '*fat-type': 'int'\n     * '*label': 'str'\n     */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:driver\", \"vvfat\",\n                                 \"s:dir\", src->path,\n                                 \"b:floppy\", src->floppyimg, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        virJSONValueObjectAdd(ret, \"b:rw\", !src->readonly, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetFileProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "949-971",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetFileProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    const char *iomode = NULL;\n    const char *prManagerAlias = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (!onlytarget) {\n        if (src->pr)\n            prManagerAlias = src->pr->mgralias;\n\n        if (src->iomode != VIR_DOMAIN_DISK_IO_DEFAULT)\n            iomode = virDomainDiskIoTypeToString(src->iomode);\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:filename\", src->path,\n                                          \"S:aio\", iomode,\n                                          \"S:pr-manager\", prManagerAlias,\n                                          NULL) < 0);\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virJSONValueObjectCreate(&ret,\n                                          \"s:filename\", src->path,\n                                          \"S:aio\", iomode,\n                                          \"S:pr-manager\", prManagerAlias,\n                                          NULL) < 0"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"s:filename\"",
            "src->path",
            "\"S:aio\"",
            "iomode",
            "\"S:pr-manager\"",
            "prManagerAlias",
            "NULL"
          ],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskIoTypeToString",
          "args": [
            "src->iomode"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetFileProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    const char *iomode = NULL;\n    const char *prManagerAlias = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (!onlytarget) {\n        if (src->pr)\n            prManagerAlias = src->pr->mgralias;\n\n        if (src->iomode != VIR_DOMAIN_DISK_IO_DEFAULT)\n            iomode = virDomainDiskIoTypeToString(src->iomode);\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:filename\", src->path,\n                                          \"S:aio\", iomode,\n                                          \"S:pr-manager\", prManagerAlias,\n                                          NULL) < 0);\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetSshProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "908-946",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetSshProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) host_key_check = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0]);\n    if (!serverprops)\n        return NULL;\n\n    if (src->auth)\n        username = src->auth->username;\n    else if (src->ssh_user)\n        username = src->ssh_user;\n\n    if (src->ssh_host_key_check_disabled &&\n        virJSONValueObjectCreate(&host_key_check,\n                                 \"s:mode\", \"none\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &serverprops,\n                                 \"S:user\", username,\n                                 \"A:host-key-check\", &host_key_check,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"s:path\"",
            "src->path",
            "\"a:server\"",
            "&serverprops",
            "\"S:user\"",
            "username",
            "\"A:host-key-check\"",
            "&host_key_check",
            "NULL"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceBuildJSONInetSocketAddress",
          "args": [
            "&src->hosts[0]"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceBuildJSONInetSocketAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "554-574",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildJSONInetSocketAddress(virStorageNetHostDefPtr host)\n{\n    virJSONValuePtr ret = NULL;\n    g_autofree char *port = NULL;\n\n    if (host->transport != VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only TCP protocol can be converted to InetSocketAddress\"));\n        return NULL;\n    }\n\n    port = g_strdup_printf(\"%u\", host->port);\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:host\", host->name,\n                                          \"s:port\", port,\n                                          NULL));\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildJSONInetSocketAddress(virStorageNetHostDefPtr host)\n{\n    virJSONValuePtr ret = NULL;\n    g_autofree char *port = NULL;\n\n    if (host->transport != VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only TCP protocol can be converted to InetSocketAddress\"));\n        return NULL;\n    }\n\n    port = g_strdup_printf(\"%u\", host->port);\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:host\", host->name,\n                                          \"s:port\", port,\n                                          NULL));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"sheepdog protocol accepts only one host\")"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"sheepdog protocol accepts only one host\""
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetSshProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) host_key_check = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0]);\n    if (!serverprops)\n        return NULL;\n\n    if (src->auth)\n        username = src->auth->username;\n    else if (src->ssh_user)\n        username = src->ssh_user;\n\n    if (src->ssh_host_key_check_disabled &&\n        virJSONValueObjectCreate(&host_key_check,\n                                 \"s:mode\", \"none\",\n                                 NULL) < 0)\n        return NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &serverprops,\n                                 \"S:user\", username,\n                                 \"A:host-key-check\", &host_key_check,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetSheepdogProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "880-905",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetSheepdogProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    /* libvirt does not support the 'snap-id' and 'tag' properties */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"s:vdi\", src->path,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"a:server\"",
            "&serverprops",
            "\"s:vdi\"",
            "src->path",
            "NULL"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceBuildJSONSocketAddress",
          "args": [
            "&src->hosts[0]",
            "false"
          ],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceBuildJSONSocketAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "459-507",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildJSONSocketAddress(virStorageNetHostDefPtr host,\n                                             bool legacy)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *transport;\n    const char *field;\n    g_autofree char *port = NULL;\n\n    switch ((virStorageNetHostTransport) host->transport) {\n    case VIR_STORAGE_NET_HOST_TRANS_TCP:\n        if (legacy)\n            transport = \"tcp\";\n        else\n            transport = \"inet\";\n\n        port = g_strdup_printf(\"%u\", host->port);\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", transport,\n                                     \"s:host\", host->name,\n                                     \"s:port\", port,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_UNIX:\n        if (legacy)\n            field = \"s:socket\";\n        else\n            field = \"s:path\";\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", \"unix\",\n                                     field, host->socket,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_RDMA:\n    case VIR_STORAGE_NET_HOST_TRANS_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"transport protocol '%s' is not yet supported\"),\n                       virStorageNetHostTransportTypeToString(host->transport));\n        return NULL;\n    }\n\n    return g_steal_pointer(&server);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildJSONSocketAddress(virStorageNetHostDefPtr host,\n                                             bool legacy)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *transport;\n    const char *field;\n    g_autofree char *port = NULL;\n\n    switch ((virStorageNetHostTransport) host->transport) {\n    case VIR_STORAGE_NET_HOST_TRANS_TCP:\n        if (legacy)\n            transport = \"tcp\";\n        else\n            transport = \"inet\";\n\n        port = g_strdup_printf(\"%u\", host->port);\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", transport,\n                                     \"s:host\", host->name,\n                                     \"s:port\", port,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_UNIX:\n        if (legacy)\n            field = \"s:socket\";\n        else\n            field = \"s:path\";\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", \"unix\",\n                                     field, host->socket,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_RDMA:\n    case VIR_STORAGE_NET_HOST_TRANS_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"transport protocol '%s' is not yet supported\"),\n                       virStorageNetHostTransportTypeToString(host->transport));\n        return NULL;\n    }\n\n    return g_steal_pointer(&server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"sheepdog protocol accepts only one host\")"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"sheepdog protocol accepts only one host\""
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetSheepdogProps(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"sheepdog protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    /* libvirt does not support the 'snap-id' and 'tag' properties */\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"s:vdi\", src->path,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetRBDProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "829-877",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetRBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) servers = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) authmodes = NULL;\n    g_autoptr(virJSONValue) mode = NULL;\n    const char *keysecret = NULL;\n\n    if (src->nhosts > 0 &&\n        !(servers = qemuBlockStorageSourceBuildHostsJSONInetSocketAddress(src)))\n        return NULL;\n\n    if (!onlytarget && src->auth) {\n        username = srcPriv->secinfo->s.aes.username;\n        keysecret = srcPriv->secinfo->s.aes.alias;\n        /* the auth modes are modelled after our old command line generator */\n        authmodes = virJSONValueNewArray();\n\n        if (!(mode = virJSONValueNewString(\"cephx\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n\n        if (!(mode = virJSONValueNewString(\"none\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n    }\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:pool\", src->volume,\n                                 \"s:image\", src->path,\n                                 \"S:snapshot\", src->snapshot,\n                                 \"S:conf\", src->configFile,\n                                 \"A:server\", &servers,\n                                 \"S:user\", username,\n                                 \"A:auth-client-required\", &authmodes,\n                                 \"S:key-secret\", keysecret,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"s:pool\"",
            "src->volume",
            "\"s:image\"",
            "src->path",
            "\"S:snapshot\"",
            "src->snapshot",
            "\"S:conf\"",
            "src->configFile",
            "\"A:server\"",
            "&servers",
            "\"S:user\"",
            "username",
            "\"A:auth-client-required\"",
            "&authmodes",
            "\"S:key-secret\"",
            "keysecret",
            "NULL"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayAppend",
          "args": [
            "authmodes",
            "mode"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "792-804",
          "snippet": "int\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewString",
          "args": [
            "\"none\""
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "433-448",
          "snippet": "virJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceBuildHostsJSONInetSocketAddress",
          "args": [
            "src"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceBuildHostsJSONInetSocketAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "584-607",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildHostsJSONInetSocketAddress(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) server = NULL;\n    virStorageNetHostDefPtr host;\n    size_t i;\n\n    servers = virJSONValueNewArray();\n\n    for (i = 0; i < src->nhosts; i++) {\n        host = src->hosts + i;\n\n        if (!(server = qemuBlockStorageSourceBuildJSONInetSocketAddress(host)))\n            return NULL;\n\n        if (virJSONValueArrayAppend(servers, server) < 0)\n            return NULL;\n\n        server = NULL;\n    }\n\n    return g_steal_pointer(&servers);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildHostsJSONInetSocketAddress(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) server = NULL;\n    virStorageNetHostDefPtr host;\n    size_t i;\n\n    servers = virJSONValueNewArray();\n\n    for (i = 0; i < src->nhosts; i++) {\n        host = src->hosts + i;\n\n        if (!(server = qemuBlockStorageSourceBuildJSONInetSocketAddress(host)))\n            return NULL;\n\n        if (virJSONValueArrayAppend(servers, server) < 0)\n            return NULL;\n\n        server = NULL;\n    }\n\n    return g_steal_pointer(&servers);\n}"
        }
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE",
          "args": [
            "src"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetRBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autoptr(virJSONValue) servers = NULL;\n    virJSONValuePtr ret = NULL;\n    const char *username = NULL;\n    g_autoptr(virJSONValue) authmodes = NULL;\n    g_autoptr(virJSONValue) mode = NULL;\n    const char *keysecret = NULL;\n\n    if (src->nhosts > 0 &&\n        !(servers = qemuBlockStorageSourceBuildHostsJSONInetSocketAddress(src)))\n        return NULL;\n\n    if (!onlytarget && src->auth) {\n        username = srcPriv->secinfo->s.aes.username;\n        keysecret = srcPriv->secinfo->s.aes.alias;\n        /* the auth modes are modelled after our old command line generator */\n        authmodes = virJSONValueNewArray();\n\n        if (!(mode = virJSONValueNewString(\"cephx\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n\n        if (!(mode = virJSONValueNewString(\"none\")) ||\n            virJSONValueArrayAppend(authmodes, mode) < 0)\n            return NULL;\n\n        mode = NULL;\n    }\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"s:pool\", src->volume,\n                                 \"s:image\", src->path,\n                                 \"S:snapshot\", src->snapshot,\n                                 \"S:conf\", src->configFile,\n                                 \"A:server\", &servers,\n                                 \"S:user\", username,\n                                 \"A:auth-client-required\", &authmodes,\n                                 \"S:key-secret\", keysecret,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetNBDProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "796-826",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetNBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    const char *tlsAlias = src->tlsAlias;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"nbd protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    if (onlytarget)\n        tlsAlias = NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"S:export\", src->path,\n                                 \"S:tls-creds\", tlsAlias,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"a:server\"",
            "&serverprops",
            "\"S:export\"",
            "src->path",
            "\"S:tls-creds\"",
            "tlsAlias",
            "NULL"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceBuildJSONSocketAddress",
          "args": [
            "&src->hosts[0]",
            "false"
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceBuildJSONSocketAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "459-507",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildJSONSocketAddress(virStorageNetHostDefPtr host,\n                                             bool legacy)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *transport;\n    const char *field;\n    g_autofree char *port = NULL;\n\n    switch ((virStorageNetHostTransport) host->transport) {\n    case VIR_STORAGE_NET_HOST_TRANS_TCP:\n        if (legacy)\n            transport = \"tcp\";\n        else\n            transport = \"inet\";\n\n        port = g_strdup_printf(\"%u\", host->port);\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", transport,\n                                     \"s:host\", host->name,\n                                     \"s:port\", port,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_UNIX:\n        if (legacy)\n            field = \"s:socket\";\n        else\n            field = \"s:path\";\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", \"unix\",\n                                     field, host->socket,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_RDMA:\n    case VIR_STORAGE_NET_HOST_TRANS_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"transport protocol '%s' is not yet supported\"),\n                       virStorageNetHostTransportTypeToString(host->transport));\n        return NULL;\n    }\n\n    return g_steal_pointer(&server);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildJSONSocketAddress(virStorageNetHostDefPtr host,\n                                             bool legacy)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *transport;\n    const char *field;\n    g_autofree char *port = NULL;\n\n    switch ((virStorageNetHostTransport) host->transport) {\n    case VIR_STORAGE_NET_HOST_TRANS_TCP:\n        if (legacy)\n            transport = \"tcp\";\n        else\n            transport = \"inet\";\n\n        port = g_strdup_printf(\"%u\", host->port);\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", transport,\n                                     \"s:host\", host->name,\n                                     \"s:port\", port,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_UNIX:\n        if (legacy)\n            field = \"s:socket\";\n        else\n            field = \"s:path\";\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", \"unix\",\n                                     field, host->socket,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_RDMA:\n    case VIR_STORAGE_NET_HOST_TRANS_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"transport protocol '%s' is not yet supported\"),\n                       virStorageNetHostTransportTypeToString(host->transport));\n        return NULL;\n    }\n\n    return g_steal_pointer(&server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"nbd protocol accepts only one host\")"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"nbd protocol accepts only one host\""
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetNBDProps(virStorageSourcePtr src,\n                                  bool onlytarget)\n{\n    g_autoptr(virJSONValue) serverprops = NULL;\n    const char *tlsAlias = src->tlsAlias;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"nbd protocol accepts only one host\"));\n        return NULL;\n    }\n\n    serverprops = qemuBlockStorageSourceBuildJSONSocketAddress(&src->hosts[0],\n                                                               false);\n    if (!serverprops)\n        return NULL;\n\n    if (onlytarget)\n        tlsAlias = NULL;\n\n    if (virJSONValueObjectCreate(&ret,\n                                 \"a:server\", &serverprops,\n                                 \"S:export\", src->path,\n                                 \"S:tls-creds\", tlsAlias,\n                                 NULL) < 0)\n        return NULL;\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetISCSIProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "733-793",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetISCSIProps(virStorageSourcePtr src,\n                                    bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autofree char *target = NULL;\n    char *lunStr = NULL;\n    char *username = NULL;\n    char *objalias = NULL;\n    g_autofree char *portal = NULL;\n    unsigned int lun = 0;\n    virJSONValuePtr ret = NULL;\n\n    /* { driver:\"iscsi\",\n     *   transport:\"tcp\",  (\"iser\" also possible)\n     *   portal:\"example.com\",\n     *   target:\"iqn.2017-04.com.example:iscsi-disks\",\n     *   lun:1,\n     *   user:\"username\",\n     *   password-secret:\"secret-alias\",\n     *   initiator-name:\"iqn.2017-04.com.example:client\"\n     * }\n     */\n\n    target = g_strdup(src->path);\n\n    /* Separate the target and lun */\n    if ((lunStr = strchr(target, '/'))) {\n        *(lunStr++) = '\\0';\n        if (virStrToLong_ui(lunStr, NULL, 10, &lun) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot parse target for lunStr '%s'\"),\n                           target);\n            return NULL;\n        }\n    }\n\n    /* combine host and port into portal */\n    if (virSocketAddrNumericFamily(src->hosts[0].name) == AF_INET6) {\n        portal = g_strdup_printf(\"[%s]:%u\", src->hosts[0].name,\n                                 src->hosts[0].port);\n    } else {\n        portal = g_strdup_printf(\"%s:%u\", src->hosts[0].name, src->hosts[0].port);\n    }\n\n    if (!onlytarget && src->auth) {\n        username = src->auth->username;\n        objalias = srcPriv->secinfo->s.aes.alias;\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:portal\", portal,\n                                          \"s:target\", target,\n                                          \"u:lun\", lun,\n                                          \"s:transport\", \"tcp\",\n                                          \"S:user\", username,\n                                          \"S:password-secret\", objalias,\n                                          \"S:initiator-name\", src->initiator.iqn,\n                                          NULL));\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virJSONValueObjectCreate(&ret,\n                                          \"s:portal\", portal,\n                                          \"s:target\", target,\n                                          \"u:lun\", lun,\n                                          \"s:transport\", \"tcp\",\n                                          \"S:user\", username,\n                                          \"S:password-secret\", objalias,\n                                          \"S:initiator-name\", src->initiator.iqn,\n                                          NULL)"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"s:portal\"",
            "portal",
            "\"s:target\"",
            "target",
            "\"u:lun\"",
            "lun",
            "\"s:transport\"",
            "\"tcp\"",
            "\"S:user\"",
            "username",
            "\"S:password-secret\"",
            "objalias",
            "\"S:initiator-name\"",
            "src->initiator.iqn",
            "NULL"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s:%u\"",
            "src->hosts[0].name",
            "src->hosts[0].port"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSocketAddrNumericFamily",
          "args": [
            "src->hosts[0].name"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrNumericFamily",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "1209-1221",
          "snippet": "int\nvirSocketAddrNumericFamily(const char *address)\n{\n    struct addrinfo *res;\n    unsigned short family;\n\n    if (virSocketAddrParseInternal(&res, address, AF_UNSPEC, AI_NUMERICHOST, false) < 0)\n        return -1;\n\n    family = res->ai_addr->sa_family;\n    freeaddrinfo(res);\n    return family;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nint\nvirSocketAddrNumericFamily(const char *address)\n{\n    struct addrinfo *res;\n    unsigned short family;\n\n    if (virSocketAddrParseInternal(&res, address, AF_UNSPEC, AI_NUMERICHOST, false) < 0)\n        return -1;\n\n    family = res->ai_addr->sa_family;\n    freeaddrinfo(res);\n    return family;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse target for lunStr '%s'\")",
            "target"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot parse target for lunStr '%s'\""
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "lunStr",
            "NULL",
            "10",
            "&lun"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "target",
            "'/'"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE",
          "args": [
            "src"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetISCSIProps(virStorageSourcePtr src,\n                                    bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    g_autofree char *target = NULL;\n    char *lunStr = NULL;\n    char *username = NULL;\n    char *objalias = NULL;\n    g_autofree char *portal = NULL;\n    unsigned int lun = 0;\n    virJSONValuePtr ret = NULL;\n\n    /* { driver:\"iscsi\",\n     *   transport:\"tcp\",  (\"iser\" also possible)\n     *   portal:\"example.com\",\n     *   target:\"iqn.2017-04.com.example:iscsi-disks\",\n     *   lun:1,\n     *   user:\"username\",\n     *   password-secret:\"secret-alias\",\n     *   initiator-name:\"iqn.2017-04.com.example:client\"\n     * }\n     */\n\n    target = g_strdup(src->path);\n\n    /* Separate the target and lun */\n    if ((lunStr = strchr(target, '/'))) {\n        *(lunStr++) = '\\0';\n        if (virStrToLong_ui(lunStr, NULL, 10, &lun) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot parse target for lunStr '%s'\"),\n                           target);\n            return NULL;\n        }\n    }\n\n    /* combine host and port into portal */\n    if (virSocketAddrNumericFamily(src->hosts[0].name) == AF_INET6) {\n        portal = g_strdup_printf(\"[%s]:%u\", src->hosts[0].name,\n                                 src->hosts[0].port);\n    } else {\n        portal = g_strdup_printf(\"%s:%u\", src->hosts[0].name, src->hosts[0].port);\n    }\n\n    if (!onlytarget && src->auth) {\n        username = src->auth->username;\n        objalias = srcPriv->secinfo->s.aes.alias;\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:portal\", portal,\n                                          \"s:target\", target,\n                                          \"u:lun\", lun,\n                                          \"s:transport\", \"tcp\",\n                                          \"S:user\", username,\n                                          \"S:password-secret\", objalias,\n                                          \"S:initiator-name\", src->initiator.iqn,\n                                          NULL));\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetCURLProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "677-730",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetCURLProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    const char *passwordalias = NULL;\n    const char *cookiealias = NULL;\n    const char *username = NULL;\n    virJSONValuePtr ret = NULL;\n    g_autoptr(virURI) uri = NULL;\n    g_autofree char *uristr = NULL;\n\n    /**\n     * Common options:\n     * url, readahead, timeout, username, password-secret, proxy-username,\n     * proxy-password-secret\n     *\n     * Options for http transport:\n     * cookie, cookie-secret\n     *\n     * Options for secure transport (ftps, https):\n     * sslverify\n     */\n\n\n    if (!(uri = qemuBlockStorageSourceGetURI(src)))\n        return NULL;\n\n    if (!(uristr = virURIFormat(uri)))\n        return NULL;\n\n    if (!onlytarget) {\n        if (src->auth) {\n            username = src->auth->username;\n            passwordalias = srcPriv->secinfo->s.aes.alias;\n        }\n\n        if (srcPriv &&\n            srcPriv->httpcookie)\n            cookiealias = srcPriv->httpcookie->s.aes.alias;\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:url\", uristr,\n                                          \"S:username\", username,\n                                          \"S:password-secret\", passwordalias,\n                                          \"T:sslverify\", src->sslverify,\n                                          \"S:cookie-secret\", cookiealias,\n                                          \"P:timeout\", src->timeout,\n                                          \"P:readahead\", src->readahead,\n                                          NULL));\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virJSONValueObjectCreate(&ret,\n                                          \"s:url\", uristr,\n                                          \"S:username\", username,\n                                          \"S:password-secret\", passwordalias,\n                                          \"T:sslverify\", src->sslverify,\n                                          \"S:cookie-secret\", cookiealias,\n                                          \"P:timeout\", src->timeout,\n                                          \"P:readahead\", src->readahead,\n                                          NULL)"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"s:url\"",
            "uristr",
            "\"S:username\"",
            "username",
            "\"S:password-secret\"",
            "passwordalias",
            "\"T:sslverify\"",
            "src->sslverify",
            "\"S:cookie-secret\"",
            "cookiealias",
            "\"P:timeout\"",
            "src->timeout",
            "\"P:readahead\"",
            "src->readahead",
            "NULL"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virURIFormat",
          "args": [
            "uri"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "virURIFormatParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "253-269",
          "snippet": "char *virURIFormatParams(virURIPtr uri)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n    bool amp = false;\n\n    for (i = 0; i < uri->paramsCount; ++i) {\n        if (!uri->params[i].ignore) {\n            if (amp) virBufferAddChar(&buf, '&');\n            virBufferStrcat(&buf, uri->params[i].name, \"=\", NULL);\n            virBufferURIEncodeString(&buf, uri->params[i].value);\n            amp = true;\n        }\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nchar *virURIFormatParams(virURIPtr uri)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n    bool amp = false;\n\n    for (i = 0; i < uri->paramsCount; ++i) {\n        if (!uri->params[i].ignore) {\n            if (amp) virBufferAddChar(&buf, '&');\n            virBufferStrcat(&buf, uri->params[i].name, \"=\", NULL);\n            virBufferURIEncodeString(&buf, uri->params[i].value);\n            amp = true;\n        }\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceGetURI",
          "args": [
            "src"
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceGetURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "406-443",
          "snippet": "virURIPtr\nqemuBlockStorageSourceGetURI(virStorageSourcePtr src)\n{\n    g_autoptr(virURI) uri = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"protocol '%s' accepts only one host\"),\n                       virStorageNetProtocolTypeToString(src->protocol));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(uri) < 0)\n        return NULL;\n\n    if (src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        uri->port = src->hosts->port;\n\n        uri->scheme = g_strdup(virStorageNetProtocolTypeToString(src->protocol));\n    } else {\n        uri->scheme = g_strdup_printf(\"%s+%s\",\n                                      virStorageNetProtocolTypeToString(src->protocol),\n                                      virStorageNetHostTransportTypeToString(src->hosts->transport));\n    }\n\n    if (src->path) {\n        if (src->volume) {\n            uri->path = g_strdup_printf(\"/%s/%s\", src->volume, src->path);\n        } else {\n            uri->path = g_strdup_printf(\"%s%s\", src->path[0] == '/' ? \"\" : \"/\",\n                                        src->path);\n        }\n    }\n\n    uri->server = g_strdup(src->hosts->name);\n\n    return g_steal_pointer(&uri);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirURIPtr\nqemuBlockStorageSourceGetURI(virStorageSourcePtr src)\n{\n    g_autoptr(virURI) uri = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"protocol '%s' accepts only one host\"),\n                       virStorageNetProtocolTypeToString(src->protocol));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(uri) < 0)\n        return NULL;\n\n    if (src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        uri->port = src->hosts->port;\n\n        uri->scheme = g_strdup(virStorageNetProtocolTypeToString(src->protocol));\n    } else {\n        uri->scheme = g_strdup_printf(\"%s+%s\",\n                                      virStorageNetProtocolTypeToString(src->protocol),\n                                      virStorageNetHostTransportTypeToString(src->hosts->transport));\n    }\n\n    if (src->path) {\n        if (src->volume) {\n            uri->path = g_strdup_printf(\"/%s/%s\", src->volume, src->path);\n        } else {\n            uri->path = g_strdup_printf(\"%s%s\", src->path[0] == '/' ? \"\" : \"/\",\n                                        src->path);\n        }\n    }\n\n    uri->server = g_strdup(src->hosts->name);\n\n    return g_steal_pointer(&uri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE",
          "args": [
            "src"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetCURLProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    qemuDomainStorageSourcePrivatePtr srcPriv = QEMU_DOMAIN_STORAGE_SOURCE_PRIVATE(src);\n    const char *passwordalias = NULL;\n    const char *cookiealias = NULL;\n    const char *username = NULL;\n    virJSONValuePtr ret = NULL;\n    g_autoptr(virURI) uri = NULL;\n    g_autofree char *uristr = NULL;\n\n    /**\n     * Common options:\n     * url, readahead, timeout, username, password-secret, proxy-username,\n     * proxy-password-secret\n     *\n     * Options for http transport:\n     * cookie, cookie-secret\n     *\n     * Options for secure transport (ftps, https):\n     * sslverify\n     */\n\n\n    if (!(uri = qemuBlockStorageSourceGetURI(src)))\n        return NULL;\n\n    if (!(uristr = virURIFormat(uri)))\n        return NULL;\n\n    if (!onlytarget) {\n        if (src->auth) {\n            username = src->auth->username;\n            passwordalias = srcPriv->secinfo->s.aes.alias;\n        }\n\n        if (srcPriv &&\n            srcPriv->httpcookie)\n            cookiealias = srcPriv->httpcookie->s.aes.alias;\n    }\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:url\", uristr,\n                                          \"S:username\", username,\n                                          \"S:password-secret\", passwordalias,\n                                          \"T:sslverify\", src->sslverify,\n                                          \"S:cookie-secret\", cookiealias,\n                                          \"P:timeout\", src->timeout,\n                                          \"P:readahead\", src->readahead,\n                                          NULL));\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetVxHSProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "642-674",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetVxHSProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *tlsAlias = src->tlsAlias;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"VxHS protocol accepts only one host\"));\n        return NULL;\n    }\n\n    if (!(server = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0])))\n        return NULL;\n\n    if (onlytarget)\n        tlsAlias = NULL;\n\n    /* VxHS disk specification example:\n     * { driver:\"vxhs\",\n     *   tls-creds:\"objvirtio-disk0_tls0\",\n     *   vdisk-id:\"eb90327c-8302-4725-4e85ed4dc251\",\n     *   server:{type:\"tcp\", host:\"1.2.3.4\", port:9999}}\n     */\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"S:tls-creds\", tlsAlias,\n                                          \"s:vdisk-id\", src->path,\n                                          \"a:server\", &server, NULL));\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virJSONValueObjectCreate(&ret,\n                                          \"S:tls-creds\", tlsAlias,\n                                          \"s:vdisk-id\", src->path,\n                                          \"a:server\", &server, NULL)"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"S:tls-creds\"",
            "tlsAlias",
            "\"s:vdisk-id\"",
            "src->path",
            "\"a:server\"",
            "&server",
            "NULL"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceBuildJSONInetSocketAddress",
          "args": [
            "&src->hosts[0]"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceBuildJSONInetSocketAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "554-574",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildJSONInetSocketAddress(virStorageNetHostDefPtr host)\n{\n    virJSONValuePtr ret = NULL;\n    g_autofree char *port = NULL;\n\n    if (host->transport != VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only TCP protocol can be converted to InetSocketAddress\"));\n        return NULL;\n    }\n\n    port = g_strdup_printf(\"%u\", host->port);\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:host\", host->name,\n                                          \"s:port\", port,\n                                          NULL));\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildJSONInetSocketAddress(virStorageNetHostDefPtr host)\n{\n    virJSONValuePtr ret = NULL;\n    g_autofree char *port = NULL;\n\n    if (host->transport != VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only TCP protocol can be converted to InetSocketAddress\"));\n        return NULL;\n    }\n\n    port = g_strdup_printf(\"%u\", host->port);\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:host\", host->name,\n                                          \"s:port\", port,\n                                          NULL));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"VxHS protocol accepts only one host\")"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"VxHS protocol accepts only one host\""
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetVxHSProps(virStorageSourcePtr src,\n                                   bool onlytarget)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *tlsAlias = src->tlsAlias;\n    virJSONValuePtr ret = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"VxHS protocol accepts only one host\"));\n        return NULL;\n    }\n\n    if (!(server = qemuBlockStorageSourceBuildJSONInetSocketAddress(&src->hosts[0])))\n        return NULL;\n\n    if (onlytarget)\n        tlsAlias = NULL;\n\n    /* VxHS disk specification example:\n     * { driver:\"vxhs\",\n     *   tls-creds:\"objvirtio-disk0_tls0\",\n     *   vdisk-id:\"eb90327c-8302-4725-4e85ed4dc251\",\n     *   server:{type:\"tcp\", host:\"1.2.3.4\", port:9999}}\n     */\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"S:tls-creds\", tlsAlias,\n                                          \"s:vdisk-id\", src->path,\n                                          \"a:server\", &server, NULL));\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetGlusterProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "610-639",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceGetGlusterProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(servers = qemuBlockStorageSourceBuildHostsJSONSocketAddress(src, legacy)))\n        return NULL;\n\n     /* { driver:\"gluster\",\n      *   volume:\"testvol\",\n      *   path:\"/a.img\",\n      *   server :[{type:\"tcp\", host:\"1.2.3.4\", port:24007},\n      *            {type:\"unix\", socket:\"/tmp/glusterd.socket\"}, ...]}\n      */\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:volume\", src->volume,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &servers, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        src->debug &&\n        virJSONValueObjectAdd(props, \"u:debug\", src->debugLevel, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&props"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAdd",
          "args": [
            "props",
            "\"u:debug\"",
            "src->debugLevel",
            "NULL"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "345-356",
          "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&props",
            "\"s:volume\"",
            "src->volume",
            "\"s:path\"",
            "src->path",
            "\"a:server\"",
            "&servers",
            "NULL"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceBuildHostsJSONSocketAddress",
          "args": [
            "src",
            "legacy"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceBuildHostsJSONSocketAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "518-542",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildHostsJSONSocketAddress(virStorageSourcePtr src,\n                                                  bool legacy)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) server = NULL;\n    virStorageNetHostDefPtr host;\n    size_t i;\n\n    servers = virJSONValueNewArray();\n\n    for (i = 0; i < src->nhosts; i++) {\n        host = src->hosts + i;\n\n        if (!(server = qemuBlockStorageSourceBuildJSONSocketAddress(host, legacy)))\n              return NULL;\n\n        if (virJSONValueArrayAppend(servers, server) < 0)\n            return NULL;\n\n        server = NULL;\n    }\n\n    return g_steal_pointer(&servers);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildHostsJSONSocketAddress(virStorageSourcePtr src,\n                                                  bool legacy)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) server = NULL;\n    virStorageNetHostDefPtr host;\n    size_t i;\n\n    servers = virJSONValueNewArray();\n\n    for (i = 0; i < src->nhosts; i++) {\n        host = src->hosts + i;\n\n        if (!(server = qemuBlockStorageSourceBuildJSONSocketAddress(host, legacy)))\n              return NULL;\n\n        if (virJSONValueArrayAppend(servers, server) < 0)\n            return NULL;\n\n        server = NULL;\n    }\n\n    return g_steal_pointer(&servers);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceGetGlusterProps(virStorageSourcePtr src,\n                                      bool legacy,\n                                      bool onlytarget)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) props = NULL;\n\n    if (!(servers = qemuBlockStorageSourceBuildHostsJSONSocketAddress(src, legacy)))\n        return NULL;\n\n     /* { driver:\"gluster\",\n      *   volume:\"testvol\",\n      *   path:\"/a.img\",\n      *   server :[{type:\"tcp\", host:\"1.2.3.4\", port:24007},\n      *            {type:\"unix\", socket:\"/tmp/glusterd.socket\"}, ...]}\n      */\n    if (virJSONValueObjectCreate(&props,\n                                 \"s:volume\", src->volume,\n                                 \"s:path\", src->path,\n                                 \"a:server\", &servers, NULL) < 0)\n        return NULL;\n\n    if (!onlytarget &&\n        src->debug &&\n        virJSONValueObjectAdd(props, \"u:debug\", src->debugLevel, NULL) < 0)\n        return NULL;\n\n    return g_steal_pointer(&props);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceBuildHostsJSONInetSocketAddress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "584-607",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildHostsJSONInetSocketAddress(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) server = NULL;\n    virStorageNetHostDefPtr host;\n    size_t i;\n\n    servers = virJSONValueNewArray();\n\n    for (i = 0; i < src->nhosts; i++) {\n        host = src->hosts + i;\n\n        if (!(server = qemuBlockStorageSourceBuildJSONInetSocketAddress(host)))\n            return NULL;\n\n        if (virJSONValueArrayAppend(servers, server) < 0)\n            return NULL;\n\n        server = NULL;\n    }\n\n    return g_steal_pointer(&servers);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&servers"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayAppend",
          "args": [
            "servers",
            "server"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "792-804",
          "snippet": "int\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceBuildJSONInetSocketAddress",
          "args": [
            "host"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceBuildJSONInetSocketAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "554-574",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildJSONInetSocketAddress(virStorageNetHostDefPtr host)\n{\n    virJSONValuePtr ret = NULL;\n    g_autofree char *port = NULL;\n\n    if (host->transport != VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only TCP protocol can be converted to InetSocketAddress\"));\n        return NULL;\n    }\n\n    port = g_strdup_printf(\"%u\", host->port);\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:host\", host->name,\n                                          \"s:port\", port,\n                                          NULL));\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildJSONInetSocketAddress(virStorageNetHostDefPtr host)\n{\n    virJSONValuePtr ret = NULL;\n    g_autofree char *port = NULL;\n\n    if (host->transport != VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only TCP protocol can be converted to InetSocketAddress\"));\n        return NULL;\n    }\n\n    port = g_strdup_printf(\"%u\", host->port);\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:host\", host->name,\n                                          \"s:port\", port,\n                                          NULL));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildHostsJSONInetSocketAddress(virStorageSourcePtr src)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) server = NULL;\n    virStorageNetHostDefPtr host;\n    size_t i;\n\n    servers = virJSONValueNewArray();\n\n    for (i = 0; i < src->nhosts; i++) {\n        host = src->hosts + i;\n\n        if (!(server = qemuBlockStorageSourceBuildJSONInetSocketAddress(host)))\n            return NULL;\n\n        if (virJSONValueArrayAppend(servers, server) < 0)\n            return NULL;\n\n        server = NULL;\n    }\n\n    return g_steal_pointer(&servers);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceBuildJSONInetSocketAddress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "554-574",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildJSONInetSocketAddress(virStorageNetHostDefPtr host)\n{\n    virJSONValuePtr ret = NULL;\n    g_autofree char *port = NULL;\n\n    if (host->transport != VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only TCP protocol can be converted to InetSocketAddress\"));\n        return NULL;\n    }\n\n    port = g_strdup_printf(\"%u\", host->port);\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:host\", host->name,\n                                          \"s:port\", port,\n                                          NULL));\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virJSONValueObjectCreate(&ret,\n                                          \"s:host\", host->name,\n                                          \"s:port\", port,\n                                          NULL)"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&ret",
            "\"s:host\"",
            "host->name",
            "\"s:port\"",
            "port",
            "NULL"
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%u\"",
            "host->port"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"only TCP protocol can be converted to InetSocketAddress\")"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"only TCP protocol can be converted to InetSocketAddress\""
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildJSONInetSocketAddress(virStorageNetHostDefPtr host)\n{\n    virJSONValuePtr ret = NULL;\n    g_autofree char *port = NULL;\n\n    if (host->transport != VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only TCP protocol can be converted to InetSocketAddress\"));\n        return NULL;\n    }\n\n    port = g_strdup_printf(\"%u\", host->port);\n\n    ignore_value(virJSONValueObjectCreate(&ret,\n                                          \"s:host\", host->name,\n                                          \"s:port\", port,\n                                          NULL));\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceBuildHostsJSONSocketAddress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "518-542",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildHostsJSONSocketAddress(virStorageSourcePtr src,\n                                                  bool legacy)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) server = NULL;\n    virStorageNetHostDefPtr host;\n    size_t i;\n\n    servers = virJSONValueNewArray();\n\n    for (i = 0; i < src->nhosts; i++) {\n        host = src->hosts + i;\n\n        if (!(server = qemuBlockStorageSourceBuildJSONSocketAddress(host, legacy)))\n              return NULL;\n\n        if (virJSONValueArrayAppend(servers, server) < 0)\n            return NULL;\n\n        server = NULL;\n    }\n\n    return g_steal_pointer(&servers);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&servers"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayAppend",
          "args": [
            "servers",
            "server"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "792-804",
          "snippet": "int\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockStorageSourceBuildJSONSocketAddress",
          "args": [
            "host",
            "legacy"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockStorageSourceBuildJSONSocketAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "459-507",
          "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildJSONSocketAddress(virStorageNetHostDefPtr host,\n                                             bool legacy)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *transport;\n    const char *field;\n    g_autofree char *port = NULL;\n\n    switch ((virStorageNetHostTransport) host->transport) {\n    case VIR_STORAGE_NET_HOST_TRANS_TCP:\n        if (legacy)\n            transport = \"tcp\";\n        else\n            transport = \"inet\";\n\n        port = g_strdup_printf(\"%u\", host->port);\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", transport,\n                                     \"s:host\", host->name,\n                                     \"s:port\", port,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_UNIX:\n        if (legacy)\n            field = \"s:socket\";\n        else\n            field = \"s:path\";\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", \"unix\",\n                                     field, host->socket,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_RDMA:\n    case VIR_STORAGE_NET_HOST_TRANS_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"transport protocol '%s' is not yet supported\"),\n                       virStorageNetHostTransportTypeToString(host->transport));\n        return NULL;\n    }\n\n    return g_steal_pointer(&server);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildJSONSocketAddress(virStorageNetHostDefPtr host,\n                                             bool legacy)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *transport;\n    const char *field;\n    g_autofree char *port = NULL;\n\n    switch ((virStorageNetHostTransport) host->transport) {\n    case VIR_STORAGE_NET_HOST_TRANS_TCP:\n        if (legacy)\n            transport = \"tcp\";\n        else\n            transport = \"inet\";\n\n        port = g_strdup_printf(\"%u\", host->port);\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", transport,\n                                     \"s:host\", host->name,\n                                     \"s:port\", port,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_UNIX:\n        if (legacy)\n            field = \"s:socket\";\n        else\n            field = \"s:path\";\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", \"unix\",\n                                     field, host->socket,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_RDMA:\n    case VIR_STORAGE_NET_HOST_TRANS_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"transport protocol '%s' is not yet supported\"),\n                       virStorageNetHostTransportTypeToString(host->transport));\n        return NULL;\n    }\n\n    return g_steal_pointer(&server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildHostsJSONSocketAddress(virStorageSourcePtr src,\n                                                  bool legacy)\n{\n    g_autoptr(virJSONValue) servers = NULL;\n    g_autoptr(virJSONValue) server = NULL;\n    virStorageNetHostDefPtr host;\n    size_t i;\n\n    servers = virJSONValueNewArray();\n\n    for (i = 0; i < src->nhosts; i++) {\n        host = src->hosts + i;\n\n        if (!(server = qemuBlockStorageSourceBuildJSONSocketAddress(host, legacy)))\n              return NULL;\n\n        if (virJSONValueArrayAppend(servers, server) < 0)\n            return NULL;\n\n        server = NULL;\n    }\n\n    return g_steal_pointer(&servers);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceBuildJSONSocketAddress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "459-507",
    "snippet": "static virJSONValuePtr\nqemuBlockStorageSourceBuildJSONSocketAddress(virStorageNetHostDefPtr host,\n                                             bool legacy)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *transport;\n    const char *field;\n    g_autofree char *port = NULL;\n\n    switch ((virStorageNetHostTransport) host->transport) {\n    case VIR_STORAGE_NET_HOST_TRANS_TCP:\n        if (legacy)\n            transport = \"tcp\";\n        else\n            transport = \"inet\";\n\n        port = g_strdup_printf(\"%u\", host->port);\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", transport,\n                                     \"s:host\", host->name,\n                                     \"s:port\", port,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_UNIX:\n        if (legacy)\n            field = \"s:socket\";\n        else\n            field = \"s:path\";\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", \"unix\",\n                                     field, host->socket,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_RDMA:\n    case VIR_STORAGE_NET_HOST_TRANS_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"transport protocol '%s' is not yet supported\"),\n                       virStorageNetHostTransportTypeToString(host->transport));\n        return NULL;\n    }\n\n    return g_steal_pointer(&server);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&server"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"transport protocol '%s' is not yet supported\")",
            "virStorageNetHostTransportTypeToString(host->transport)"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageNetHostTransportTypeToString",
          "args": [
            "host->transport"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"transport protocol '%s' is not yet supported\""
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreate",
          "args": [
            "&server",
            "\"s:type\"",
            "\"unix\"",
            "field",
            "host->socket",
            "NULL"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "377-388",
          "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%u\"",
            "host->port"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nqemuBlockStorageSourceBuildJSONSocketAddress(virStorageNetHostDefPtr host,\n                                             bool legacy)\n{\n    g_autoptr(virJSONValue) server = NULL;\n    const char *transport;\n    const char *field;\n    g_autofree char *port = NULL;\n\n    switch ((virStorageNetHostTransport) host->transport) {\n    case VIR_STORAGE_NET_HOST_TRANS_TCP:\n        if (legacy)\n            transport = \"tcp\";\n        else\n            transport = \"inet\";\n\n        port = g_strdup_printf(\"%u\", host->port);\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", transport,\n                                     \"s:host\", host->name,\n                                     \"s:port\", port,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_UNIX:\n        if (legacy)\n            field = \"s:socket\";\n        else\n            field = \"s:path\";\n\n        if (virJSONValueObjectCreate(&server,\n                                     \"s:type\", \"unix\",\n                                     field, host->socket,\n                                     NULL) < 0)\n            return NULL;\n        break;\n\n    case VIR_STORAGE_NET_HOST_TRANS_RDMA:\n    case VIR_STORAGE_NET_HOST_TRANS_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"transport protocol '%s' is not yet supported\"),\n                       virStorageNetHostTransportTypeToString(host->transport));\n        return NULL;\n    }\n\n    return g_steal_pointer(&server);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceGetURI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "406-443",
    "snippet": "virURIPtr\nqemuBlockStorageSourceGetURI(virStorageSourcePtr src)\n{\n    g_autoptr(virURI) uri = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"protocol '%s' accepts only one host\"),\n                       virStorageNetProtocolTypeToString(src->protocol));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(uri) < 0)\n        return NULL;\n\n    if (src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        uri->port = src->hosts->port;\n\n        uri->scheme = g_strdup(virStorageNetProtocolTypeToString(src->protocol));\n    } else {\n        uri->scheme = g_strdup_printf(\"%s+%s\",\n                                      virStorageNetProtocolTypeToString(src->protocol),\n                                      virStorageNetHostTransportTypeToString(src->hosts->transport));\n    }\n\n    if (src->path) {\n        if (src->volume) {\n            uri->path = g_strdup_printf(\"/%s/%s\", src->volume, src->path);\n        } else {\n            uri->path = g_strdup_printf(\"%s%s\", src->path[0] == '/' ? \"\" : \"/\",\n                                        src->path);\n        }\n    }\n\n    uri->server = g_strdup(src->hosts->name);\n\n    return g_steal_pointer(&uri);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&uri"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src->hosts->name"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageNetHostTransportTypeToString",
          "args": [
            "src->hosts->transport"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageNetProtocolTypeToString",
          "args": [
            "src->protocol"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageNetProtocolTypeToString",
          "args": [
            "src->protocol"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "uri"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"protocol '%s' accepts only one host\")",
            "virStorageNetProtocolTypeToString(src->protocol)"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageNetProtocolTypeToString",
          "args": [
            "src->protocol"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"protocol '%s' accepts only one host\""
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirURIPtr\nqemuBlockStorageSourceGetURI(virStorageSourcePtr src)\n{\n    g_autoptr(virURI) uri = NULL;\n\n    if (src->nhosts != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"protocol '%s' accepts only one host\"),\n                       virStorageNetProtocolTypeToString(src->protocol));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(uri) < 0)\n        return NULL;\n\n    if (src->hosts->transport == VIR_STORAGE_NET_HOST_TRANS_TCP) {\n        uri->port = src->hosts->port;\n\n        uri->scheme = g_strdup(virStorageNetProtocolTypeToString(src->protocol));\n    } else {\n        uri->scheme = g_strdup_printf(\"%s+%s\",\n                                      virStorageNetProtocolTypeToString(src->protocol),\n                                      virStorageNetHostTransportTypeToString(src->hosts->transport));\n    }\n\n    if (src->path) {\n        if (src->volume) {\n            uri->path = g_strdup_printf(\"/%s/%s\", src->volume, src->path);\n        } else {\n            uri->path = g_strdup_printf(\"%s%s\", src->path[0] == '/' ? \"\" : \"/\",\n                                        src->path);\n        }\n    }\n\n    uri->server = g_strdup(src->hosts->name);\n\n    return g_steal_pointer(&uri);\n}"
  },
  {
    "function_name": "qemuBlockStorageSourceSupportsConcurrentAccess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "392-397",
    "snippet": "bool\nqemuBlockStorageSourceSupportsConcurrentAccess(virStorageSourcePtr src)\n{\n    /* no need to check in backing chain since only RAW storage supports this */\n    return src->format == VIR_STORAGE_FILE_RAW;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nbool\nqemuBlockStorageSourceSupportsConcurrentAccess(virStorageSourcePtr src)\n{\n    /* no need to check in backing chain since only RAW storage supports this */\n    return src->format == VIR_STORAGE_FILE_RAW;\n}"
  },
  {
    "function_name": "qemuBlockGetNodeData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "369-382",
    "snippet": "virHashTablePtr\nqemuBlockGetNodeData(virJSONValuePtr data)\n{\n    g_autoptr(virHashTable) nodedata = NULL;\n\n    if (!(nodedata = virHashCreate(50, virJSONValueHashFree)))\n        return NULL;\n\n    if (virJSONValueArrayForeachSteal(data,\n                                      qemuBlockNamedNodesArrayToHash, nodedata) < 0)\n        return NULL;\n\n    return g_steal_pointer(&nodedata);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&nodedata"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayForeachSteal",
          "args": [
            "data",
            "qemuBlockNamedNodesArrayToHash",
            "nodedata"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayForeachSteal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1078-1112",
          "snippet": "int\nvirJSONValueArrayForeachSteal(virJSONValuePtr array,\n                              virJSONArrayIteratorFunc cb,\n                              void *opaque)\n{\n    size_t i;\n    size_t j = 0;\n    int ret = 0;\n    int rc;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if ((rc = cb(i, array->data.array.values[i], opaque)) < 0) {\n            ret = -1;\n            break;\n        }\n\n        if (rc == 0)\n            array->data.array.values[i] = NULL;\n    }\n\n    /* condense the remaining entries at the beginning */\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if (!array->data.array.values[i])\n            continue;\n\n        array->data.array.values[j++] = array->data.array.values[i];\n    }\n\n    array->data.array.nvalues = j;\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayForeachSteal(virJSONValuePtr array,\n                              virJSONArrayIteratorFunc cb,\n                              void *opaque)\n{\n    size_t i;\n    size_t j = 0;\n    int ret = 0;\n    int rc;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if ((rc = cb(i, array->data.array.values[i], opaque)) < 0) {\n            ret = -1;\n            break;\n        }\n\n        if (rc == 0)\n            array->data.array.values[i] = NULL;\n    }\n\n    /* condense the remaining entries at the beginning */\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if (!array->data.array.values[i])\n            continue;\n\n        array->data.array.values[j++] = array->data.array.values[i];\n    }\n\n    array->data.array.nvalues = j;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "50",
            "virJSONValueHashFree"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirHashTablePtr\nqemuBlockGetNodeData(virJSONValuePtr data)\n{\n    g_autoptr(virHashTable) nodedata = NULL;\n\n    if (!(nodedata = virHashCreate(50, virJSONValueHashFree)))\n        return NULL;\n\n    if (virJSONValueArrayForeachSteal(data,\n                                      qemuBlockNamedNodesArrayToHash, nodedata) < 0)\n        return NULL;\n\n    return g_steal_pointer(&nodedata);\n}"
  },
  {
    "function_name": "qemuBlockNodeNamesDetect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "322-357",
    "snippet": "int\nqemuBlockNodeNamesDetect(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autoptr(virHashTable) disktable = NULL;\n    g_autoptr(virJSONValue) data = NULL;\n    g_autoptr(virJSONValue) blockstats = NULL;\n    virDomainDiskDefPtr disk;\n    size_t i;\n\n    if (!virQEMUCapsGet(priv->qemuCaps, QEMU_CAPS_QUERY_NAMED_BLOCK_NODES))\n        return 0;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    data = qemuMonitorQueryNamedBlockNodes(qemuDomainGetMonitor(vm));\n    blockstats = qemuMonitorQueryBlockstats(qemuDomainGetMonitor(vm));\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || !data || !blockstats)\n        return -1;\n\n    if (!(disktable = qemuBlockNodeNameGetBackingChain(data, blockstats)))\n        return -1;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        disk = vm->def->disks[i];\n\n        if (qemuBlockDiskDetectNodes(disk, disktable) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockDiskDetectNodes",
          "args": [
            "disk",
            "disktable"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockDiskDetectNodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "275-319",
          "snippet": "static int\nqemuBlockDiskDetectNodes(virDomainDiskDefPtr disk,\n                         virHashTablePtr disktable)\n{\n    qemuBlockNodeNameBackingChainDataPtr entry = NULL;\n    virStorageSourcePtr src = disk->src;\n    g_autofree char *alias = NULL;\n    int ret = -1;\n\n    /* don't attempt the detection if the top level already has node names */\n    if (src->nodeformat || src->nodestorage)\n        return 0;\n\n    if (!(alias = qemuAliasDiskDriveFromDisk(disk)))\n        goto cleanup;\n\n    if (!(entry = virHashLookup(disktable, alias))) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    while (virStorageSourceIsBacking(src) && entry) {\n        if (src->nodeformat || src->nodestorage) {\n            if (STRNEQ_NULLABLE(src->nodeformat, entry->nodeformat) ||\n                STRNEQ_NULLABLE(src->nodestorage, entry->nodestorage))\n                goto cleanup;\n\n            break;\n        } else {\n            src->nodeformat = g_strdup(entry->nodeformat);\n            src->nodestorage = g_strdup(entry->nodestorage);\n        }\n\n        entry = entry->backing;\n        src = src->backingStore;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0)\n        qemuBlockDiskClearDetectedNodes(disk);\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockDiskDetectNodes(virDomainDiskDefPtr disk,\n                         virHashTablePtr disktable)\n{\n    qemuBlockNodeNameBackingChainDataPtr entry = NULL;\n    virStorageSourcePtr src = disk->src;\n    g_autofree char *alias = NULL;\n    int ret = -1;\n\n    /* don't attempt the detection if the top level already has node names */\n    if (src->nodeformat || src->nodestorage)\n        return 0;\n\n    if (!(alias = qemuAliasDiskDriveFromDisk(disk)))\n        goto cleanup;\n\n    if (!(entry = virHashLookup(disktable, alias))) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    while (virStorageSourceIsBacking(src) && entry) {\n        if (src->nodeformat || src->nodestorage) {\n            if (STRNEQ_NULLABLE(src->nodeformat, entry->nodeformat) ||\n                STRNEQ_NULLABLE(src->nodestorage, entry->nodestorage))\n                goto cleanup;\n\n            break;\n        } else {\n            src->nodeformat = g_strdup(entry->nodeformat);\n            src->nodestorage = g_strdup(entry->nodestorage);\n        }\n\n        entry = entry->backing;\n        src = src->backingStore;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0)\n        qemuBlockDiskClearDetectedNodes(disk);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockNodeNameGetBackingChain",
          "args": [
            "data",
            "blockstats"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockNodeNameGetBackingChain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "228-258",
          "snippet": "virHashTablePtr\nqemuBlockNodeNameGetBackingChain(virJSONValuePtr namednodes,\n                                 virJSONValuePtr blockstats)\n{\n    struct qemuBlockNodeNameGetBackingChainData data;\n    g_autoptr(virHashTable) namednodestable = NULL;\n    g_autoptr(virHashTable) disks = NULL;\n\n    memset(&data, 0, sizeof(data));\n\n    if (!(namednodestable = virHashCreate(50, virJSONValueHashFree)))\n        return NULL;\n\n    if (virJSONValueArrayForeachSteal(namednodes,\n                                      qemuBlockNamedNodesArrayToHash,\n                                      namednodestable) < 0)\n        return NULL;\n\n    if (!(disks = virHashCreate(50, qemuBlockNodeNameBackingChainDataHashEntryFree)))\n        return NULL;\n\n    data.nodenamestable = namednodestable;\n    data.disks = disks;\n\n    if (virJSONValueArrayForeachSteal(blockstats,\n                                      qemuBlockNodeNameGetBackingChainDisk,\n                                      &data) < 0)\n        return NULL;\n\n    return g_steal_pointer(&disks);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirHashTablePtr\nqemuBlockNodeNameGetBackingChain(virJSONValuePtr namednodes,\n                                 virJSONValuePtr blockstats)\n{\n    struct qemuBlockNodeNameGetBackingChainData data;\n    g_autoptr(virHashTable) namednodestable = NULL;\n    g_autoptr(virHashTable) disks = NULL;\n\n    memset(&data, 0, sizeof(data));\n\n    if (!(namednodestable = virHashCreate(50, virJSONValueHashFree)))\n        return NULL;\n\n    if (virJSONValueArrayForeachSteal(namednodes,\n                                      qemuBlockNamedNodesArrayToHash,\n                                      namednodestable) < 0)\n        return NULL;\n\n    if (!(disks = virHashCreate(50, qemuBlockNodeNameBackingChainDataHashEntryFree)))\n        return NULL;\n\n    data.nodenamestable = namednodestable;\n    data.disks = disks;\n\n    if (virJSONValueArrayForeachSteal(blockstats,\n                                      qemuBlockNodeNameGetBackingChainDisk,\n                                      &data) < 0)\n        return NULL;\n\n    return g_steal_pointer(&disks);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjExitMonitor",
          "args": [
            "driver",
            "vm"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjExitMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10189-10200",
          "snippet": "int qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\n\nint qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorQueryBlockstats",
          "args": [
            "qemuDomainGetMonitor(vm)"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorQueryBlockstats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2099-2105",
          "snippet": "virJSONValuePtr\nqemuMonitorQueryBlockstats(qemuMonitorPtr mon)\n{\n    QEMU_CHECK_MONITOR_NULL(mon);\n\n    return qemuMonitorJSONQueryBlockstats(mon);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nvirJSONValuePtr\nqemuMonitorQueryBlockstats(qemuMonitorPtr mon)\n{\n    QEMU_CHECK_MONITOR_NULL(mon);\n\n    return qemuMonitorJSONQueryBlockstats(mon);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainGetMonitor",
          "args": [
            "vm"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainGetMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "12703-12707",
          "snippet": "qemuMonitorPtr\nqemuDomainGetMonitor(virDomainObjPtr vm)\n{\n    return ((qemuDomainObjPrivatePtr) vm->privateData)->mon;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nqemuMonitorPtr\nqemuDomainGetMonitor(virDomainObjPtr vm)\n{\n    return ((qemuDomainObjPrivatePtr) vm->privateData)->mon;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorQueryNamedBlockNodes",
          "args": [
            "qemuDomainGetMonitor(vm)"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorQueryNamedBlockNodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4224-4230",
          "snippet": "virJSONValuePtr\nqemuMonitorQueryNamedBlockNodes(qemuMonitorPtr mon)\n{\n    QEMU_CHECK_MONITOR_NULL(mon);\n\n    return qemuMonitorJSONQueryNamedBlockNodes(mon, false);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nvirJSONValuePtr\nqemuMonitorQueryNamedBlockNodes(qemuMonitorPtr mon)\n{\n    QEMU_CHECK_MONITOR_NULL(mon);\n\n    return qemuMonitorJSONQueryNamedBlockNodes(mon, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjEnterMonitorAsync",
          "args": [
            "driver",
            "vm",
            "asyncJob"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjEnterMonitorAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10216-10222",
          "snippet": "int\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);",
            "qemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\nqemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));\n\nint\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUCapsGet",
          "args": [
            "priv->qemuCaps",
            "QEMU_CAPS_QUERY_NAMED_BLOCK_NODES"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUCapsGetPreferredMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_capabilities.c",
          "lines": "5555-5564",
          "snippet": "const char *\nvirQEMUCapsGetPreferredMachine(virQEMUCapsPtr qemuCaps,\n                               virDomainVirtType virtType)\n{\n    virQEMUCapsAccelPtr accel = virQEMUCapsGetAccel(qemuCaps, virtType);\n\n    if (!accel->nmachineTypes)\n        return NULL;\n    return accel->machineTypes[0].name;\n}",
          "includes": [
            "#include <sys/utsname.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"virutil.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_qapi.h\"",
            "#include \"qemu_capspriv.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"virstring.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnuma.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virbitmap.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/utsname.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"virutil.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_process.h\"\n#include \"qemu_qapi.h\"\n#include \"qemu_capspriv.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include \"virstring.h\"\n#include \"qemu_monitor.h\"\n#include \"virhostcpu.h\"\n#include \"virnuma.h\"\n#include \"virnodesuspend.h\"\n#include \"virbitmap.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"cpu/cpu.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include <config.h>\n\nconst char *\nvirQEMUCapsGetPreferredMachine(virQEMUCapsPtr qemuCaps,\n                               virDomainVirtType virtType)\n{\n    virQEMUCapsAccelPtr accel = virQEMUCapsGetAccel(qemuCaps, virtType);\n\n    if (!accel->nmachineTypes)\n        return NULL;\n    return accel->machineTypes[0].name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockNodeNamesDetect(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         qemuDomainAsyncJob asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autoptr(virHashTable) disktable = NULL;\n    g_autoptr(virJSONValue) data = NULL;\n    g_autoptr(virJSONValue) blockstats = NULL;\n    virDomainDiskDefPtr disk;\n    size_t i;\n\n    if (!virQEMUCapsGet(priv->qemuCaps, QEMU_CAPS_QUERY_NAMED_BLOCK_NODES))\n        return 0;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    data = qemuMonitorQueryNamedBlockNodes(qemuDomainGetMonitor(vm));\n    blockstats = qemuMonitorQueryBlockstats(qemuDomainGetMonitor(vm));\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || !data || !blockstats)\n        return -1;\n\n    if (!(disktable = qemuBlockNodeNameGetBackingChain(data, blockstats)))\n        return -1;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        disk = vm->def->disks[i];\n\n        if (qemuBlockDiskDetectNodes(disk, disktable) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockDiskDetectNodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "275-319",
    "snippet": "static int\nqemuBlockDiskDetectNodes(virDomainDiskDefPtr disk,\n                         virHashTablePtr disktable)\n{\n    qemuBlockNodeNameBackingChainDataPtr entry = NULL;\n    virStorageSourcePtr src = disk->src;\n    g_autofree char *alias = NULL;\n    int ret = -1;\n\n    /* don't attempt the detection if the top level already has node names */\n    if (src->nodeformat || src->nodestorage)\n        return 0;\n\n    if (!(alias = qemuAliasDiskDriveFromDisk(disk)))\n        goto cleanup;\n\n    if (!(entry = virHashLookup(disktable, alias))) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    while (virStorageSourceIsBacking(src) && entry) {\n        if (src->nodeformat || src->nodestorage) {\n            if (STRNEQ_NULLABLE(src->nodeformat, entry->nodeformat) ||\n                STRNEQ_NULLABLE(src->nodestorage, entry->nodestorage))\n                goto cleanup;\n\n            break;\n        } else {\n            src->nodeformat = g_strdup(entry->nodeformat);\n            src->nodestorage = g_strdup(entry->nodestorage);\n        }\n\n        entry = entry->backing;\n        src = src->backingStore;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0)\n        qemuBlockDiskClearDetectedNodes(disk);\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockDiskClearDetectedNodes",
          "args": [
            "disk"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockDiskClearDetectedNodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "261-272",
          "snippet": "static void\nqemuBlockDiskClearDetectedNodes(virDomainDiskDefPtr disk)\n{\n    virStorageSourcePtr next = disk->src;\n\n    while (virStorageSourceIsBacking(next)) {\n        VIR_FREE(next->nodeformat);\n        VIR_FREE(next->nodestorage);\n\n        next = next->backingStore;\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic void\nqemuBlockDiskClearDetectedNodes(virDomainDiskDefPtr disk)\n{\n    virStorageSourcePtr next = disk->src;\n\n    while (virStorageSourceIsBacking(next)) {\n        VIR_FREE(next->nodeformat);\n        VIR_FREE(next->nodestorage);\n\n        next = next->backingStore;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "entry->nodestorage"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ_NULLABLE",
          "args": [
            "src->nodestorage",
            "entry->nodestorage"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ_NULLABLE",
          "args": [
            "src->nodeformat",
            "entry->nodeformat"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBacking",
          "args": [
            "src"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1581-1585",
          "snippet": "bool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "disktable",
            "alias"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAliasDiskDriveFromDisk",
          "args": [
            "disk"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAliasDiskDriveFromDisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "696-709",
          "snippet": "char *\nqemuAliasDiskDriveFromDisk(const virDomainDiskDef *disk)\n{\n    char *ret;\n\n    if (!disk->info.alias) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"disk does not have an alias\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%s%s\", QEMU_DRIVE_HOST_PREFIX, disk->info.alias);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define QEMU_DRIVE_HOST_PREFIX \"drive-\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\n#define QEMU_DRIVE_HOST_PREFIX \"drive-\"\n\nchar *\nqemuAliasDiskDriveFromDisk(const virDomainDiskDef *disk)\n{\n    char *ret;\n\n    if (!disk->info.alias) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"disk does not have an alias\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%s%s\", QEMU_DRIVE_HOST_PREFIX, disk->info.alias);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockDiskDetectNodes(virDomainDiskDefPtr disk,\n                         virHashTablePtr disktable)\n{\n    qemuBlockNodeNameBackingChainDataPtr entry = NULL;\n    virStorageSourcePtr src = disk->src;\n    g_autofree char *alias = NULL;\n    int ret = -1;\n\n    /* don't attempt the detection if the top level already has node names */\n    if (src->nodeformat || src->nodestorage)\n        return 0;\n\n    if (!(alias = qemuAliasDiskDriveFromDisk(disk)))\n        goto cleanup;\n\n    if (!(entry = virHashLookup(disktable, alias))) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    while (virStorageSourceIsBacking(src) && entry) {\n        if (src->nodeformat || src->nodestorage) {\n            if (STRNEQ_NULLABLE(src->nodeformat, entry->nodeformat) ||\n                STRNEQ_NULLABLE(src->nodestorage, entry->nodestorage))\n                goto cleanup;\n\n            break;\n        } else {\n            src->nodeformat = g_strdup(entry->nodeformat);\n            src->nodestorage = g_strdup(entry->nodestorage);\n        }\n\n        entry = entry->backing;\n        src = src->backingStore;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0)\n        qemuBlockDiskClearDetectedNodes(disk);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuBlockDiskClearDetectedNodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "261-272",
    "snippet": "static void\nqemuBlockDiskClearDetectedNodes(virDomainDiskDefPtr disk)\n{\n    virStorageSourcePtr next = disk->src;\n\n    while (virStorageSourceIsBacking(next)) {\n        VIR_FREE(next->nodeformat);\n        VIR_FREE(next->nodestorage);\n\n        next = next->backingStore;\n    }\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "next->nodestorage"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "next->nodeformat"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBacking",
          "args": [
            "next"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1581-1585",
          "snippet": "bool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic void\nqemuBlockDiskClearDetectedNodes(virDomainDiskDefPtr disk)\n{\n    virStorageSourcePtr next = disk->src;\n\n    while (virStorageSourceIsBacking(next)) {\n        VIR_FREE(next->nodeformat);\n        VIR_FREE(next->nodestorage);\n\n        next = next->backingStore;\n    }\n}"
  },
  {
    "function_name": "qemuBlockNodeNameGetBackingChain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "228-258",
    "snippet": "virHashTablePtr\nqemuBlockNodeNameGetBackingChain(virJSONValuePtr namednodes,\n                                 virJSONValuePtr blockstats)\n{\n    struct qemuBlockNodeNameGetBackingChainData data;\n    g_autoptr(virHashTable) namednodestable = NULL;\n    g_autoptr(virHashTable) disks = NULL;\n\n    memset(&data, 0, sizeof(data));\n\n    if (!(namednodestable = virHashCreate(50, virJSONValueHashFree)))\n        return NULL;\n\n    if (virJSONValueArrayForeachSteal(namednodes,\n                                      qemuBlockNamedNodesArrayToHash,\n                                      namednodestable) < 0)\n        return NULL;\n\n    if (!(disks = virHashCreate(50, qemuBlockNodeNameBackingChainDataHashEntryFree)))\n        return NULL;\n\n    data.nodenamestable = namednodestable;\n    data.disks = disks;\n\n    if (virJSONValueArrayForeachSteal(blockstats,\n                                      qemuBlockNodeNameGetBackingChainDisk,\n                                      &data) < 0)\n        return NULL;\n\n    return g_steal_pointer(&disks);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&disks"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayForeachSteal",
          "args": [
            "blockstats",
            "qemuBlockNodeNameGetBackingChainDisk",
            "&data"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayForeachSteal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1078-1112",
          "snippet": "int\nvirJSONValueArrayForeachSteal(virJSONValuePtr array,\n                              virJSONArrayIteratorFunc cb,\n                              void *opaque)\n{\n    size_t i;\n    size_t j = 0;\n    int ret = 0;\n    int rc;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if ((rc = cb(i, array->data.array.values[i], opaque)) < 0) {\n            ret = -1;\n            break;\n        }\n\n        if (rc == 0)\n            array->data.array.values[i] = NULL;\n    }\n\n    /* condense the remaining entries at the beginning */\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if (!array->data.array.values[i])\n            continue;\n\n        array->data.array.values[j++] = array->data.array.values[i];\n    }\n\n    array->data.array.nvalues = j;\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayForeachSteal(virJSONValuePtr array,\n                              virJSONArrayIteratorFunc cb,\n                              void *opaque)\n{\n    size_t i;\n    size_t j = 0;\n    int ret = 0;\n    int rc;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if ((rc = cb(i, array->data.array.values[i], opaque)) < 0) {\n            ret = -1;\n            break;\n        }\n\n        if (rc == 0)\n            array->data.array.values[i] = NULL;\n    }\n\n    /* condense the remaining entries at the beginning */\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if (!array->data.array.values[i])\n            continue;\n\n        array->data.array.values[j++] = array->data.array.values[i];\n    }\n\n    array->data.array.nvalues = j;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "50",
            "qemuBlockNodeNameBackingChainDataHashEntryFree"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&data",
            "0",
            "sizeof(data)"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nvirHashTablePtr\nqemuBlockNodeNameGetBackingChain(virJSONValuePtr namednodes,\n                                 virJSONValuePtr blockstats)\n{\n    struct qemuBlockNodeNameGetBackingChainData data;\n    g_autoptr(virHashTable) namednodestable = NULL;\n    g_autoptr(virHashTable) disks = NULL;\n\n    memset(&data, 0, sizeof(data));\n\n    if (!(namednodestable = virHashCreate(50, virJSONValueHashFree)))\n        return NULL;\n\n    if (virJSONValueArrayForeachSteal(namednodes,\n                                      qemuBlockNamedNodesArrayToHash,\n                                      namednodestable) < 0)\n        return NULL;\n\n    if (!(disks = virHashCreate(50, qemuBlockNodeNameBackingChainDataHashEntryFree)))\n        return NULL;\n\n    data.nodenamestable = namednodestable;\n    data.disks = disks;\n\n    if (virJSONValueArrayForeachSteal(blockstats,\n                                      qemuBlockNodeNameGetBackingChainDisk,\n                                      &data) < 0)\n        return NULL;\n\n    return g_steal_pointer(&disks);\n}"
  },
  {
    "function_name": "qemuBlockNodeNameGetBackingChainDisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "193-212",
    "snippet": "static int\nqemuBlockNodeNameGetBackingChainDisk(size_t pos G_GNUC_UNUSED,\n                                     virJSONValuePtr item,\n                                     void *opaque)\n{\n    struct qemuBlockNodeNameGetBackingChainData *data = opaque;\n    const char *device = virJSONValueObjectGetString(item, \"device\");\n    g_autoptr(qemuBlockNodeNameBackingChainData) devicedata = NULL;\n\n    if (qemuBlockNodeNameGetBackingChainBacking(item, data->nodenamestable,\n                                                &devicedata) < 0)\n        return -1;\n\n    if (devicedata &&\n        virHashAddEntry(data->disks, device, devicedata) < 0)\n        return -1;\n\n    devicedata = NULL;\n    return 1; /* we don't really want to steal @item */\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "data->disks",
            "device",
            "devicedata"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockNodeNameGetBackingChainBacking",
          "args": [
            "item",
            "data->nodenamestable",
            "&devicedata"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockNodeNameGetBackingChainBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "128-190",
          "snippet": "static int\nqemuBlockNodeNameGetBackingChainBacking(virJSONValuePtr next,\n                                        virHashTablePtr nodenamestable,\n                                        qemuBlockNodeNameBackingChainDataPtr *nodenamedata)\n{\n    g_autoptr(qemuBlockNodeNameBackingChainData) data = NULL;\n    qemuBlockNodeNameBackingChainDataPtr backingdata = NULL;\n    virJSONValuePtr backing = virJSONValueObjectGetObject(next, \"backing\");\n    virJSONValuePtr parent = virJSONValueObjectGetObject(next, \"parent\");\n    virJSONValuePtr parentnodedata;\n    virJSONValuePtr nodedata;\n    const char *nodename = virJSONValueObjectGetString(next, \"node-name\");\n    const char *drvname = NULL;\n    const char *drvparent = NULL;\n    const char *parentnodename = NULL;\n    const char *filename = NULL;\n\n    if (!nodename)\n        return 0;\n\n    if ((nodedata = virHashLookup(nodenamestable, nodename)) &&\n        (drvname = virJSONValueObjectGetString(nodedata, \"drv\"))) {\n\n        /* qemu 2.9 reports layers in the backing chain which don't correspond\n         * to files. skip them */\n        if (qemuBlockDriverMatch(drvname, qemuBlockDriversBlockjob)) {\n            if (backing) {\n                return qemuBlockNodeNameGetBackingChainBacking(backing,\n                                                               nodenamestable,\n                                                               nodenamedata);\n            } else {\n                return 0;\n            }\n        }\n    }\n\n    if (parent &&\n        (parentnodename = virJSONValueObjectGetString(parent, \"node-name\"))) {\n        if ((parentnodedata = virHashLookup(nodenamestable, parentnodename))) {\n            filename = virJSONValueObjectGetString(parentnodedata, \"file\");\n            drvparent = virJSONValueObjectGetString(parentnodedata, \"drv\");\n        }\n    }\n\n    if (VIR_ALLOC(data) < 0)\n        return -1;\n\n    data->nodeformat = g_strdup(nodename);\n    data->nodestorage = g_strdup(parentnodename);\n    data->qemufilename = g_strdup(filename);\n    data->drvformat = g_strdup(drvname);\n    data->drvstorage = g_strdup(drvparent);\n\n    if (backing &&\n        qemuBlockNodeNameGetBackingChainBacking(backing, nodenamestable,\n                                                &backingdata) < 0)\n        return -1;\n\n    data->backing = g_steal_pointer(&backingdata);\n    *nodenamedata = g_steal_pointer(&data);\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *qemuBlockDriversBlockjob[] = {\n    \"mirror_top\", \"commit_top\", NULL };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic const char *qemuBlockDriversBlockjob[] = {\n    \"mirror_top\", \"commit_top\", NULL };\n\nstatic int\nqemuBlockNodeNameGetBackingChainBacking(virJSONValuePtr next,\n                                        virHashTablePtr nodenamestable,\n                                        qemuBlockNodeNameBackingChainDataPtr *nodenamedata)\n{\n    g_autoptr(qemuBlockNodeNameBackingChainData) data = NULL;\n    qemuBlockNodeNameBackingChainDataPtr backingdata = NULL;\n    virJSONValuePtr backing = virJSONValueObjectGetObject(next, \"backing\");\n    virJSONValuePtr parent = virJSONValueObjectGetObject(next, \"parent\");\n    virJSONValuePtr parentnodedata;\n    virJSONValuePtr nodedata;\n    const char *nodename = virJSONValueObjectGetString(next, \"node-name\");\n    const char *drvname = NULL;\n    const char *drvparent = NULL;\n    const char *parentnodename = NULL;\n    const char *filename = NULL;\n\n    if (!nodename)\n        return 0;\n\n    if ((nodedata = virHashLookup(nodenamestable, nodename)) &&\n        (drvname = virJSONValueObjectGetString(nodedata, \"drv\"))) {\n\n        /* qemu 2.9 reports layers in the backing chain which don't correspond\n         * to files. skip them */\n        if (qemuBlockDriverMatch(drvname, qemuBlockDriversBlockjob)) {\n            if (backing) {\n                return qemuBlockNodeNameGetBackingChainBacking(backing,\n                                                               nodenamestable,\n                                                               nodenamedata);\n            } else {\n                return 0;\n            }\n        }\n    }\n\n    if (parent &&\n        (parentnodename = virJSONValueObjectGetString(parent, \"node-name\"))) {\n        if ((parentnodedata = virHashLookup(nodenamestable, parentnodename))) {\n            filename = virJSONValueObjectGetString(parentnodedata, \"file\");\n            drvparent = virJSONValueObjectGetString(parentnodedata, \"drv\");\n        }\n    }\n\n    if (VIR_ALLOC(data) < 0)\n        return -1;\n\n    data->nodeformat = g_strdup(nodename);\n    data->nodestorage = g_strdup(parentnodename);\n    data->qemufilename = g_strdup(filename);\n    data->drvformat = g_strdup(drvname);\n    data->drvstorage = g_strdup(drvparent);\n\n    if (backing &&\n        qemuBlockNodeNameGetBackingChainBacking(backing, nodenamestable,\n                                                &backingdata) < 0)\n        return -1;\n\n    data->backing = g_steal_pointer(&backingdata);\n    *nodenamedata = g_steal_pointer(&data);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "item",
            "\"device\""
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockNodeNameGetBackingChainDisk(size_t pos G_GNUC_UNUSED,\n                                     virJSONValuePtr item,\n                                     void *opaque)\n{\n    struct qemuBlockNodeNameGetBackingChainData *data = opaque;\n    const char *device = virJSONValueObjectGetString(item, \"device\");\n    g_autoptr(qemuBlockNodeNameBackingChainData) devicedata = NULL;\n\n    if (qemuBlockNodeNameGetBackingChainBacking(item, data->nodenamestable,\n                                                &devicedata) < 0)\n        return -1;\n\n    if (devicedata &&\n        virHashAddEntry(data->disks, device, devicedata) < 0)\n        return -1;\n\n    devicedata = NULL;\n    return 1; /* we don't really want to steal @item */\n}"
  },
  {
    "function_name": "qemuBlockNodeNameGetBackingChainBacking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "128-190",
    "snippet": "static int\nqemuBlockNodeNameGetBackingChainBacking(virJSONValuePtr next,\n                                        virHashTablePtr nodenamestable,\n                                        qemuBlockNodeNameBackingChainDataPtr *nodenamedata)\n{\n    g_autoptr(qemuBlockNodeNameBackingChainData) data = NULL;\n    qemuBlockNodeNameBackingChainDataPtr backingdata = NULL;\n    virJSONValuePtr backing = virJSONValueObjectGetObject(next, \"backing\");\n    virJSONValuePtr parent = virJSONValueObjectGetObject(next, \"parent\");\n    virJSONValuePtr parentnodedata;\n    virJSONValuePtr nodedata;\n    const char *nodename = virJSONValueObjectGetString(next, \"node-name\");\n    const char *drvname = NULL;\n    const char *drvparent = NULL;\n    const char *parentnodename = NULL;\n    const char *filename = NULL;\n\n    if (!nodename)\n        return 0;\n\n    if ((nodedata = virHashLookup(nodenamestable, nodename)) &&\n        (drvname = virJSONValueObjectGetString(nodedata, \"drv\"))) {\n\n        /* qemu 2.9 reports layers in the backing chain which don't correspond\n         * to files. skip them */\n        if (qemuBlockDriverMatch(drvname, qemuBlockDriversBlockjob)) {\n            if (backing) {\n                return qemuBlockNodeNameGetBackingChainBacking(backing,\n                                                               nodenamestable,\n                                                               nodenamedata);\n            } else {\n                return 0;\n            }\n        }\n    }\n\n    if (parent &&\n        (parentnodename = virJSONValueObjectGetString(parent, \"node-name\"))) {\n        if ((parentnodedata = virHashLookup(nodenamestable, parentnodename))) {\n            filename = virJSONValueObjectGetString(parentnodedata, \"file\");\n            drvparent = virJSONValueObjectGetString(parentnodedata, \"drv\");\n        }\n    }\n\n    if (VIR_ALLOC(data) < 0)\n        return -1;\n\n    data->nodeformat = g_strdup(nodename);\n    data->nodestorage = g_strdup(parentnodename);\n    data->qemufilename = g_strdup(filename);\n    data->drvformat = g_strdup(drvname);\n    data->drvstorage = g_strdup(drvparent);\n\n    if (backing &&\n        qemuBlockNodeNameGetBackingChainBacking(backing, nodenamestable,\n                                                &backingdata) < 0)\n        return -1;\n\n    data->backing = g_steal_pointer(&backingdata);\n    *nodenamedata = g_steal_pointer(&data);\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *qemuBlockDriversBlockjob[] = {\n    \"mirror_top\", \"commit_top\", NULL };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&data"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&backingdata"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockNodeNameGetBackingChainBacking",
          "args": [
            "backing",
            "nodenamestable",
            "&backingdata"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockNodeNameGetBackingChainBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "128-190",
          "snippet": "static int\nqemuBlockNodeNameGetBackingChainBacking(virJSONValuePtr next,\n                                        virHashTablePtr nodenamestable,\n                                        qemuBlockNodeNameBackingChainDataPtr *nodenamedata)\n{\n    g_autoptr(qemuBlockNodeNameBackingChainData) data = NULL;\n    qemuBlockNodeNameBackingChainDataPtr backingdata = NULL;\n    virJSONValuePtr backing = virJSONValueObjectGetObject(next, \"backing\");\n    virJSONValuePtr parent = virJSONValueObjectGetObject(next, \"parent\");\n    virJSONValuePtr parentnodedata;\n    virJSONValuePtr nodedata;\n    const char *nodename = virJSONValueObjectGetString(next, \"node-name\");\n    const char *drvname = NULL;\n    const char *drvparent = NULL;\n    const char *parentnodename = NULL;\n    const char *filename = NULL;\n\n    if (!nodename)\n        return 0;\n\n    if ((nodedata = virHashLookup(nodenamestable, nodename)) &&\n        (drvname = virJSONValueObjectGetString(nodedata, \"drv\"))) {\n\n        /* qemu 2.9 reports layers in the backing chain which don't correspond\n         * to files. skip them */\n        if (qemuBlockDriverMatch(drvname, qemuBlockDriversBlockjob)) {\n            if (backing) {\n                return qemuBlockNodeNameGetBackingChainBacking(backing,\n                                                               nodenamestable,\n                                                               nodenamedata);\n            } else {\n                return 0;\n            }\n        }\n    }\n\n    if (parent &&\n        (parentnodename = virJSONValueObjectGetString(parent, \"node-name\"))) {\n        if ((parentnodedata = virHashLookup(nodenamestable, parentnodename))) {\n            filename = virJSONValueObjectGetString(parentnodedata, \"file\");\n            drvparent = virJSONValueObjectGetString(parentnodedata, \"drv\");\n        }\n    }\n\n    if (VIR_ALLOC(data) < 0)\n        return -1;\n\n    data->nodeformat = g_strdup(nodename);\n    data->nodestorage = g_strdup(parentnodename);\n    data->qemufilename = g_strdup(filename);\n    data->drvformat = g_strdup(drvname);\n    data->drvstorage = g_strdup(drvparent);\n\n    if (backing &&\n        qemuBlockNodeNameGetBackingChainBacking(backing, nodenamestable,\n                                                &backingdata) < 0)\n        return -1;\n\n    data->backing = g_steal_pointer(&backingdata);\n    *nodenamedata = g_steal_pointer(&data);\n\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "drvparent"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "data"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "parentnodedata",
            "\"drv\""
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "nodenamestable",
            "parentnodename"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuBlockDriverMatch",
          "args": [
            "drvname",
            "qemuBlockDriversBlockjob"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockDriverMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "107-119",
          "snippet": "static bool\nqemuBlockDriverMatch(const char *drvname,\n                     const char **drivers)\n{\n    while (*drivers) {\n        if (STREQ(drvname, *drivers))\n            return true;\n\n        drivers++;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic bool\nqemuBlockDriverMatch(const char *drvname,\n                     const char **drivers)\n{\n    while (*drivers) {\n        if (STREQ(drvname, *drivers))\n            return true;\n\n        drivers++;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetObject",
          "args": [
            "next",
            "\"parent\""
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1415-1419",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetObject(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_OBJECT);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetObject(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_OBJECT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic const char *qemuBlockDriversBlockjob[] = {\n    \"mirror_top\", \"commit_top\", NULL };\n\nstatic int\nqemuBlockNodeNameGetBackingChainBacking(virJSONValuePtr next,\n                                        virHashTablePtr nodenamestable,\n                                        qemuBlockNodeNameBackingChainDataPtr *nodenamedata)\n{\n    g_autoptr(qemuBlockNodeNameBackingChainData) data = NULL;\n    qemuBlockNodeNameBackingChainDataPtr backingdata = NULL;\n    virJSONValuePtr backing = virJSONValueObjectGetObject(next, \"backing\");\n    virJSONValuePtr parent = virJSONValueObjectGetObject(next, \"parent\");\n    virJSONValuePtr parentnodedata;\n    virJSONValuePtr nodedata;\n    const char *nodename = virJSONValueObjectGetString(next, \"node-name\");\n    const char *drvname = NULL;\n    const char *drvparent = NULL;\n    const char *parentnodename = NULL;\n    const char *filename = NULL;\n\n    if (!nodename)\n        return 0;\n\n    if ((nodedata = virHashLookup(nodenamestable, nodename)) &&\n        (drvname = virJSONValueObjectGetString(nodedata, \"drv\"))) {\n\n        /* qemu 2.9 reports layers in the backing chain which don't correspond\n         * to files. skip them */\n        if (qemuBlockDriverMatch(drvname, qemuBlockDriversBlockjob)) {\n            if (backing) {\n                return qemuBlockNodeNameGetBackingChainBacking(backing,\n                                                               nodenamestable,\n                                                               nodenamedata);\n            } else {\n                return 0;\n            }\n        }\n    }\n\n    if (parent &&\n        (parentnodename = virJSONValueObjectGetString(parent, \"node-name\"))) {\n        if ((parentnodedata = virHashLookup(nodenamestable, parentnodename))) {\n            filename = virJSONValueObjectGetString(parentnodedata, \"file\");\n            drvparent = virJSONValueObjectGetString(parentnodedata, \"drv\");\n        }\n    }\n\n    if (VIR_ALLOC(data) < 0)\n        return -1;\n\n    data->nodeformat = g_strdup(nodename);\n    data->nodestorage = g_strdup(parentnodename);\n    data->qemufilename = g_strdup(filename);\n    data->drvformat = g_strdup(drvname);\n    data->drvstorage = g_strdup(drvparent);\n\n    if (backing &&\n        qemuBlockNodeNameGetBackingChainBacking(backing, nodenamestable,\n                                                &backingdata) < 0)\n        return -1;\n\n    data->backing = g_steal_pointer(&backingdata);\n    *nodenamedata = g_steal_pointer(&data);\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockDriverMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "107-119",
    "snippet": "static bool\nqemuBlockDriverMatch(const char *drvname,\n                     const char **drivers)\n{\n    while (*drivers) {\n        if (STREQ(drvname, *drivers))\n            return true;\n\n        drivers++;\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "drvname",
            "*drivers"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic bool\nqemuBlockDriverMatch(const char *drvname,\n                     const char **drivers)\n{\n    while (*drivers) {\n        if (STREQ(drvname, *drivers))\n            return true;\n\n        drivers++;\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "qemuBlockNodeNameBackingChainDataHashEntryFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "95-99",
    "snippet": "static void\nqemuBlockNodeNameBackingChainDataHashEntryFree(void *opaque)\n{\n    qemuBlockNodeNameBackingChainDataFree(opaque);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuBlockNodeNameBackingChainDataFree",
          "args": [
            "opaque"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockNodeNameBackingChainDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "72-89",
          "snippet": "static void\nqemuBlockNodeNameBackingChainDataFree(qemuBlockNodeNameBackingChainDataPtr data)\n{\n    if (!data)\n        return;\n\n    VIR_FREE(data->nodeformat);\n    VIR_FREE(data->nodestorage);\n\n    VIR_FREE(data->qemufilename);\n\n    VIR_FREE(data->drvformat);\n    VIR_FREE(data->drvstorage);\n\n    qemuBlockNodeNameBackingChainDataFree(data->backing);\n\n    VIR_FREE(data);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic void\nqemuBlockNodeNameBackingChainDataFree(qemuBlockNodeNameBackingChainDataPtr data)\n{\n    if (!data)\n        return;\n\n    VIR_FREE(data->nodeformat);\n    VIR_FREE(data->nodestorage);\n\n    VIR_FREE(data->qemufilename);\n\n    VIR_FREE(data->drvformat);\n    VIR_FREE(data->drvstorage);\n\n    qemuBlockNodeNameBackingChainDataFree(data->backing);\n\n    VIR_FREE(data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic void\nqemuBlockNodeNameBackingChainDataHashEntryFree(void *opaque)\n{\n    qemuBlockNodeNameBackingChainDataFree(opaque);\n}"
  },
  {
    "function_name": "qemuBlockNodeNameBackingChainDataFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "72-89",
    "snippet": "static void\nqemuBlockNodeNameBackingChainDataFree(qemuBlockNodeNameBackingChainDataPtr data)\n{\n    if (!data)\n        return;\n\n    VIR_FREE(data->nodeformat);\n    VIR_FREE(data->nodestorage);\n\n    VIR_FREE(data->qemufilename);\n\n    VIR_FREE(data->drvformat);\n    VIR_FREE(data->drvstorage);\n\n    qemuBlockNodeNameBackingChainDataFree(data->backing);\n\n    VIR_FREE(data);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuBlockNodeNameBackingChainDataFree",
          "args": [
            "data->backing"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockNodeNameBackingChainDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "72-89",
          "snippet": "static void\nqemuBlockNodeNameBackingChainDataFree(qemuBlockNodeNameBackingChainDataPtr data)\n{\n    if (!data)\n        return;\n\n    VIR_FREE(data->nodeformat);\n    VIR_FREE(data->nodestorage);\n\n    VIR_FREE(data->qemufilename);\n\n    VIR_FREE(data->drvformat);\n    VIR_FREE(data->drvstorage);\n\n    qemuBlockNodeNameBackingChainDataFree(data->backing);\n\n    VIR_FREE(data);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->drvstorage"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->drvformat"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->qemufilename"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->nodestorage"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->nodeformat"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic void\nqemuBlockNodeNameBackingChainDataFree(qemuBlockNodeNameBackingChainDataPtr data)\n{\n    if (!data)\n        return;\n\n    VIR_FREE(data->nodeformat);\n    VIR_FREE(data->nodestorage);\n\n    VIR_FREE(data->qemufilename);\n\n    VIR_FREE(data->drvformat);\n    VIR_FREE(data->drvstorage);\n\n    qemuBlockNodeNameBackingChainDataFree(data->backing);\n\n    VIR_FREE(data);\n}"
  },
  {
    "function_name": "qemuBlockNamedNodesArrayToHash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "54-69",
    "snippet": "static int\nqemuBlockNamedNodesArrayToHash(size_t pos G_GNUC_UNUSED,\n                               virJSONValuePtr item,\n                               void *opaque)\n{\n    virHashTablePtr table = opaque;\n    const char *name;\n\n    if (!(name = virJSONValueObjectGetString(item, \"node-name\")))\n        return 1;\n\n    if (virHashAddEntry(table, name, item) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "table",
            "name",
            "item"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "item",
            "\"node-name\""
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic int\nqemuBlockNamedNodesArrayToHash(size_t pos G_GNUC_UNUSED,\n                               virJSONValuePtr item,\n                               void *opaque)\n{\n    virHashTablePtr table = opaque;\n    const char *name;\n\n    if (!(name = virJSONValueObjectGetString(item, \"node-name\")))\n        return 1;\n\n    if (virHashAddEntry(table, name, item) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuBlockNodeNameValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
    "lines": "38-51",
    "snippet": "static int\nqemuBlockNodeNameValidate(const char *nn)\n{\n    if (!nn)\n        return 0;\n\n    if (strlen(nn) >= qemuBlockNodeNameBufSize) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"node-name '%s' too long for qemu\"), nn);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_command.h\"",
      "#include \"qemu_block.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const size_t qemuBlockNodeNameBufSize = 32;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"node-name '%s' too long for qemu\")",
            "nn"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"node-name '%s' too long for qemu\""
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "nn"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nstatic const size_t qemuBlockNodeNameBufSize = 32;\n\nstatic int\nqemuBlockNodeNameValidate(const char *nn)\n{\n    if (!nn)\n        return 0;\n\n    if (strlen(nn) >= qemuBlockNodeNameBufSize) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"node-name '%s' too long for qemu\"), nn);\n        return -1;\n    }\n\n    return 0;\n}"
  }
]