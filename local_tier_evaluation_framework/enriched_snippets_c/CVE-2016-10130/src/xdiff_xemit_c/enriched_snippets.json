[
  {
    "function_name": "xdl_emit_diff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
    "lines": "171-290",
    "snippet": "int xdl_emit_diff(xdfenv_t *xe, xdchange_t *xscr, xdemitcb_t *ecb,\n\t\t  xdemitconf_t const *xecfg) {\n\tlong s1, s2, e1, e2, lctx;\n\txdchange_t *xch, *xche;\n\tlong funclineprev = -1;\n\tstruct func_line func_line = { 0 };\n\n\tif (xecfg->flags & XDL_EMIT_COMMON)\n\t\treturn xdl_emit_common(xe, xscr, ecb, xecfg);\n\n\tfor (xch = xscr; xch; xch = xche->next) {\n\t\txche = xdl_get_hunk(&xch, xecfg);\n\t\tif (!xch)\n\t\t\tbreak;\n\n\t\ts1 = XDL_MAX(xch->i1 - xecfg->ctxlen, 0);\n\t\ts2 = XDL_MAX(xch->i2 - xecfg->ctxlen, 0);\n\n\t\tif (xecfg->flags & XDL_EMIT_FUNCCONTEXT) {\n\t\t\tlong fs1 = get_func_line(xe, xecfg, NULL, xch->i1, -1);\n\t\t\tif (fs1 < 0)\n\t\t\t\tfs1 = 0;\n\t\t\tif (fs1 < s1) {\n\t\t\t\ts2 -= s1 - fs1;\n\t\t\t\ts1 = fs1;\n\t\t\t}\n\t\t}\n\n again:\n\t\tlctx = xecfg->ctxlen;\n\t\tlctx = XDL_MIN(lctx, xe->xdf1.nrec - (xche->i1 + xche->chg1));\n\t\tlctx = XDL_MIN(lctx, xe->xdf2.nrec - (xche->i2 + xche->chg2));\n\n\t\te1 = xche->i1 + xche->chg1 + lctx;\n\t\te2 = xche->i2 + xche->chg2 + lctx;\n\n\t\tif (xecfg->flags & XDL_EMIT_FUNCCONTEXT) {\n\t\t\tlong fe1 = get_func_line(xe, xecfg, NULL,\n\t\t\t\t\t\t xche->i1 + xche->chg1,\n\t\t\t\t\t\t xe->xdf1.nrec);\n\t\t\tif (fe1 < 0)\n\t\t\t\tfe1 = xe->xdf1.nrec;\n\t\t\tif (fe1 > e1) {\n\t\t\t\te2 += fe1 - e1;\n\t\t\t\te1 = fe1;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * Overlap with next change?  Then include it\n\t\t\t * in the current hunk and start over to find\n\t\t\t * its new end.\n\t\t\t */\n\t\t\tif (xche->next) {\n\t\t\t\tlong l = xche->next->i1;\n\t\t\t\tif (l <= e1 ||\n\t\t\t\t    get_func_line(xe, xecfg, NULL, l, e1) < 0) {\n\t\t\t\t\txche = xche->next;\n\t\t\t\t\tgoto again;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/*\n\t\t * Emit current hunk header.\n\t\t */\n\n\t\tif (xecfg->flags & XDL_EMIT_FUNCNAMES) {\n\t\t\tget_func_line(xe, xecfg, &func_line,\n\t\t\t\t      s1 - 1, funclineprev);\n\t\t\tfunclineprev = s1 - 1;\n\t\t}\n\t\tif (xdl_emit_hunk_hdr(s1 + 1, e1 - s1, s2 + 1, e2 - s2,\n\t\t\t\t      func_line.buf, func_line.len, ecb) < 0)\n\t\t\treturn -1;\n\n\t\t/*\n\t\t * Emit pre-context.\n\t\t */\n\t\tfor (; s2 < xch->i2; s2++)\n\t\t\tif (xdl_emit_record(&xe->xdf2, s2, \" \", ecb) < 0)\n\t\t\t\treturn -1;\n\n\t\tfor (s1 = xch->i1, s2 = xch->i2;; xch = xch->next) {\n\t\t\t/*\n\t\t\t * Merge previous with current change atom.\n\t\t\t */\n\t\t\tfor (; s1 < xch->i1 && s2 < xch->i2; s1++, s2++)\n\t\t\t\tif (xdl_emit_record(&xe->xdf2, s2, \" \", ecb) < 0)\n\t\t\t\t\treturn -1;\n\n\t\t\t/*\n\t\t\t * Removes lines from the first file.\n\t\t\t */\n\t\t\tfor (s1 = xch->i1; s1 < xch->i1 + xch->chg1; s1++)\n\t\t\t\tif (xdl_emit_record(&xe->xdf1, s1, \"-\", ecb) < 0)\n\t\t\t\t\treturn -1;\n\n\t\t\t/*\n\t\t\t * Adds lines from the second file.\n\t\t\t */\n\t\t\tfor (s2 = xch->i2; s2 < xch->i2 + xch->chg2; s2++)\n\t\t\t\tif (xdl_emit_record(&xe->xdf2, s2, \"+\", ecb) < 0)\n\t\t\t\t\treturn -1;\n\n\t\t\tif (xch == xche)\n\t\t\t\tbreak;\n\t\t\ts1 = xch->i1 + xch->chg1;\n\t\t\ts2 = xch->i2 + xch->chg2;\n\t\t}\n\n\t\t/*\n\t\t * Emit post-context.\n\t\t */\n\t\tfor (s2 = xche->i2 + xche->chg2; s2 < e2; s2++)\n\t\t\tif (xdl_emit_record(&xe->xdf2, s2, \" \", ecb) < 0)\n\t\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"xinclude.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdl_emit_record",
          "args": [
            "&xe->xdf2",
            "s2",
            "\" \"",
            "ecb"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_emit_record",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
          "lines": "42-53",
          "snippet": "static int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb) {\n\tlong size, psize = (long)strlen(pre);\n\tchar const *rec;\n\n\tsize = xdl_get_rec(xdf, ri, &rec);\n\tif (xdl_emit_diffrec(rec, size, pre, psize, ecb) < 0) {\n\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);",
            "static int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\nstatic int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);\n\nstatic int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb) {\n\tlong size, psize = (long)strlen(pre);\n\tchar const *rec;\n\n\tsize = xdl_get_rec(xdf, ri, &rec);\n\tif (xdl_emit_diffrec(rec, size, pre, psize, ecb) < 0) {\n\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdl_emit_hunk_hdr",
          "args": [
            "s1 + 1",
            "e1 - s1",
            "s2 + 1",
            "e2 - s2",
            "func_line.buf",
            "func_line.len",
            "ecb"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_emit_hunk_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xutils.c",
          "lines": "325-372",
          "snippet": "int xdl_emit_hunk_hdr(long s1, long c1, long s2, long c2,\n\t\t      const char *func, long funclen, xdemitcb_t *ecb) {\n\tint nb = 0;\n\tmmbuffer_t mb;\n\tchar buf[128];\n\n\tmemcpy(buf, \"@@ -\", 4);\n\tnb += 4;\n\n\tnb += xdl_num_out(buf + nb, c1 ? s1: s1 - 1);\n\n\tif (c1 != 1) {\n\t\tmemcpy(buf + nb, \",\", 1);\n\t\tnb += 1;\n\n\t\tnb += xdl_num_out(buf + nb, c1);\n\t}\n\n\tmemcpy(buf + nb, \" +\", 2);\n\tnb += 2;\n\n\tnb += xdl_num_out(buf + nb, c2 ? s2: s2 - 1);\n\n\tif (c2 != 1) {\n\t\tmemcpy(buf + nb, \",\", 1);\n\t\tnb += 1;\n\n\t\tnb += xdl_num_out(buf + nb, c2);\n\t}\n\n\tmemcpy(buf + nb, \" @@\", 3);\n\tnb += 3;\n\tif (func && funclen) {\n\t\tbuf[nb++] = ' ';\n\t\tif (funclen > (long)sizeof(buf) - nb - 1)\n\t\t\tfunclen = (long)sizeof(buf) - nb - 1;\n\t\tmemcpy(buf + nb, func, funclen);\n\t\tnb += funclen;\n\t}\n\tbuf[nb++] = '\\n';\n\n\tmb.ptr = buf;\n\tmb.size = nb;\n\tif (ecb->outf(ecb->priv, &mb, 1) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nint xdl_emit_hunk_hdr(long s1, long c1, long s2, long c2,\n\t\t      const char *func, long funclen, xdemitcb_t *ecb) {\n\tint nb = 0;\n\tmmbuffer_t mb;\n\tchar buf[128];\n\n\tmemcpy(buf, \"@@ -\", 4);\n\tnb += 4;\n\n\tnb += xdl_num_out(buf + nb, c1 ? s1: s1 - 1);\n\n\tif (c1 != 1) {\n\t\tmemcpy(buf + nb, \",\", 1);\n\t\tnb += 1;\n\n\t\tnb += xdl_num_out(buf + nb, c1);\n\t}\n\n\tmemcpy(buf + nb, \" +\", 2);\n\tnb += 2;\n\n\tnb += xdl_num_out(buf + nb, c2 ? s2: s2 - 1);\n\n\tif (c2 != 1) {\n\t\tmemcpy(buf + nb, \",\", 1);\n\t\tnb += 1;\n\n\t\tnb += xdl_num_out(buf + nb, c2);\n\t}\n\n\tmemcpy(buf + nb, \" @@\", 3);\n\tnb += 3;\n\tif (func && funclen) {\n\t\tbuf[nb++] = ' ';\n\t\tif (funclen > (long)sizeof(buf) - nb - 1)\n\t\t\tfunclen = (long)sizeof(buf) - nb - 1;\n\t\tmemcpy(buf + nb, func, funclen);\n\t\tnb += funclen;\n\t}\n\tbuf[nb++] = '\\n';\n\n\tmb.ptr = buf;\n\tmb.size = nb;\n\tif (ecb->outf(ecb->priv, &mb, 1) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_func_line",
          "args": [
            "xe",
            "xecfg",
            "&func_line",
            "s1 - 1",
            "funclineprev"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "get_func_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
          "lines": "148-169",
          "snippet": "static long get_func_line(xdfenv_t *xe, xdemitconf_t const *xecfg,\n\t\t\t  struct func_line *func_line, long start, long limit)\n{\n\tfind_func_t ff = xecfg->find_func ? xecfg->find_func : def_ff;\n\tlong l, size, step = (start > limit) ? -1 : 1;\n\tchar *buf, dummy[1];\n\n\tbuf = func_line ? func_line->buf : dummy;\n\tsize = func_line ? sizeof(func_line->buf) : sizeof(dummy);\n\n\tfor (l = start; l != limit && 0 <= l && l < xe->xdf1.nrec; l += step) {\n\t\tconst char *rec;\n\t\tlong reclen = xdl_get_rec(&xe->xdf1, l, &rec);\n\t\tlong len = ff(rec, reclen, buf, size, xecfg->find_func_priv);\n\t\tif (len >= 0) {\n\t\t\tif (func_line)\n\t\t\t\tfunc_line->len = len;\n\t\t\treturn l;\n\t\t}\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\n\nstatic long get_func_line(xdfenv_t *xe, xdemitconf_t const *xecfg,\n\t\t\t  struct func_line *func_line, long start, long limit)\n{\n\tfind_func_t ff = xecfg->find_func ? xecfg->find_func : def_ff;\n\tlong l, size, step = (start > limit) ? -1 : 1;\n\tchar *buf, dummy[1];\n\n\tbuf = func_line ? func_line->buf : dummy;\n\tsize = func_line ? sizeof(func_line->buf) : sizeof(dummy);\n\n\tfor (l = start; l != limit && 0 <= l && l < xe->xdf1.nrec; l += step) {\n\t\tconst char *rec;\n\t\tlong reclen = xdl_get_rec(&xe->xdf1, l, &rec);\n\t\tlong len = ff(rec, reclen, buf, size, xecfg->find_func_priv);\n\t\tif (len >= 0) {\n\t\t\tif (func_line)\n\t\t\t\tfunc_line->len = len;\n\t\t\treturn l;\n\t\t}\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XDL_MIN",
          "args": [
            "lctx",
            "xe->xdf2.nrec - (xche->i2 + xche->chg2)"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDL_MIN",
          "args": [
            "lctx",
            "xe->xdf1.nrec - (xche->i1 + xche->chg1)"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDL_MAX",
          "args": [
            "xch->i2 - xecfg->ctxlen",
            "0"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDL_MAX",
          "args": [
            "xch->i1 - xecfg->ctxlen",
            "0"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdl_get_hunk",
          "args": [
            "&xch",
            "xecfg"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_get_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
          "lines": "61-104",
          "snippet": "xdchange_t *xdl_get_hunk(xdchange_t **xscr, xdemitconf_t const *xecfg)\n{\n\txdchange_t *xch, *xchp, *lxch;\n\tlong max_common = 2 * xecfg->ctxlen + xecfg->interhunkctxlen;\n\tlong max_ignorable = xecfg->ctxlen;\n\tunsigned long ignored = 0; /* number of ignored blank lines */\n\n\t/* remove ignorable changes that are too far before other changes */\n\tfor (xchp = *xscr; xchp && xchp->ignore; xchp = xchp->next) {\n\t\txch = xchp->next;\n\n\t\tif (xch == NULL ||\n\t\t    xch->i1 - (xchp->i1 + xchp->chg1) >= max_ignorable)\n\t\t\t*xscr = xch;\n\t}\n\n\tif (*xscr == NULL)\n\t\treturn NULL;\n\n\tlxch = *xscr;\n\n\tfor (xchp = *xscr, xch = xchp->next; xch; xchp = xch, xch = xch->next) {\n\t\tlong distance = xch->i1 - (xchp->i1 + xchp->chg1);\n\t\tif (distance > max_common)\n\t\t\tbreak;\n\n\t\tif (distance < max_ignorable && (!xch->ignore || lxch == xchp)) {\n\t\t\tlxch = xch;\n\t\t\tignored = 0;\n\t\t} else if (distance < max_ignorable && xch->ignore) {\n\t\t\tignored += xch->chg2;\n\t\t} else if (lxch != xchp &&\n\t\t\t   xch->i1 + ignored - (lxch->i1 + lxch->chg1) > (unsigned long)max_common) {\n\t\t\tbreak;\n\t\t} else if (!xch->ignore) {\n\t\t\tlxch = xch;\n\t\t\tignored = 0;\n\t\t} else {\n\t\t\tignored += xch->chg2;\n\t\t}\n\t}\n\n\treturn lxch;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nxdchange_t *xdl_get_hunk(xdchange_t **xscr, xdemitconf_t const *xecfg)\n{\n\txdchange_t *xch, *xchp, *lxch;\n\tlong max_common = 2 * xecfg->ctxlen + xecfg->interhunkctxlen;\n\tlong max_ignorable = xecfg->ctxlen;\n\tunsigned long ignored = 0; /* number of ignored blank lines */\n\n\t/* remove ignorable changes that are too far before other changes */\n\tfor (xchp = *xscr; xchp && xchp->ignore; xchp = xchp->next) {\n\t\txch = xchp->next;\n\n\t\tif (xch == NULL ||\n\t\t    xch->i1 - (xchp->i1 + xchp->chg1) >= max_ignorable)\n\t\t\t*xscr = xch;\n\t}\n\n\tif (*xscr == NULL)\n\t\treturn NULL;\n\n\tlxch = *xscr;\n\n\tfor (xchp = *xscr, xch = xchp->next; xch; xchp = xch, xch = xch->next) {\n\t\tlong distance = xch->i1 - (xchp->i1 + xchp->chg1);\n\t\tif (distance > max_common)\n\t\t\tbreak;\n\n\t\tif (distance < max_ignorable && (!xch->ignore || lxch == xchp)) {\n\t\t\tlxch = xch;\n\t\t\tignored = 0;\n\t\t} else if (distance < max_ignorable && xch->ignore) {\n\t\t\tignored += xch->chg2;\n\t\t} else if (lxch != xchp &&\n\t\t\t   xch->i1 + ignored - (lxch->i1 + lxch->chg1) > (unsigned long)max_common) {\n\t\t\tbreak;\n\t\t} else if (!xch->ignore) {\n\t\t\tlxch = xch;\n\t\t\tignored = 0;\n\t\t} else {\n\t\t\tignored += xch->chg2;\n\t\t}\n\t}\n\n\treturn lxch;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdl_emit_common",
          "args": [
            "xe",
            "xscr",
            "ecb",
            "xecfg"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_emit_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
          "lines": "125-141",
          "snippet": "static int xdl_emit_common(xdfenv_t *xe, xdchange_t *xscr, xdemitcb_t *ecb,\n                           xdemitconf_t const *xecfg) {\n\txdfile_t *xdf = &xe->xdf2;\n\tconst char *rchg = xdf->rchg;\n\tlong ix;\n\n\t(void)xscr;\n\t(void)xecfg;\n\n\tfor (ix = 0; ix < xdf->nrec; ix++) {\n\t\tif (rchg[ix])\n\t\t\tcontinue;\n\t\tif (xdl_emit_record(xdf, ix, \"\", ecb))\n\t\t\treturn -1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nstatic int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);\n\nstatic int xdl_emit_common(xdfenv_t *xe, xdchange_t *xscr, xdemitcb_t *ecb,\n                           xdemitconf_t const *xecfg) {\n\txdfile_t *xdf = &xe->xdf2;\n\tconst char *rchg = xdf->rchg;\n\tlong ix;\n\n\t(void)xscr;\n\t(void)xecfg;\n\n\tfor (ix = 0; ix < xdf->nrec; ix++) {\n\t\tif (rchg[ix])\n\t\t\tcontinue;\n\t\tif (xdl_emit_record(xdf, ix, \"\", ecb))\n\t\t\treturn -1;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xinclude.h\"\n\nstatic int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);\n\nint xdl_emit_diff(xdfenv_t *xe, xdchange_t *xscr, xdemitcb_t *ecb,\n\t\t  xdemitconf_t const *xecfg) {\n\tlong s1, s2, e1, e2, lctx;\n\txdchange_t *xch, *xche;\n\tlong funclineprev = -1;\n\tstruct func_line func_line = { 0 };\n\n\tif (xecfg->flags & XDL_EMIT_COMMON)\n\t\treturn xdl_emit_common(xe, xscr, ecb, xecfg);\n\n\tfor (xch = xscr; xch; xch = xche->next) {\n\t\txche = xdl_get_hunk(&xch, xecfg);\n\t\tif (!xch)\n\t\t\tbreak;\n\n\t\ts1 = XDL_MAX(xch->i1 - xecfg->ctxlen, 0);\n\t\ts2 = XDL_MAX(xch->i2 - xecfg->ctxlen, 0);\n\n\t\tif (xecfg->flags & XDL_EMIT_FUNCCONTEXT) {\n\t\t\tlong fs1 = get_func_line(xe, xecfg, NULL, xch->i1, -1);\n\t\t\tif (fs1 < 0)\n\t\t\t\tfs1 = 0;\n\t\t\tif (fs1 < s1) {\n\t\t\t\ts2 -= s1 - fs1;\n\t\t\t\ts1 = fs1;\n\t\t\t}\n\t\t}\n\n again:\n\t\tlctx = xecfg->ctxlen;\n\t\tlctx = XDL_MIN(lctx, xe->xdf1.nrec - (xche->i1 + xche->chg1));\n\t\tlctx = XDL_MIN(lctx, xe->xdf2.nrec - (xche->i2 + xche->chg2));\n\n\t\te1 = xche->i1 + xche->chg1 + lctx;\n\t\te2 = xche->i2 + xche->chg2 + lctx;\n\n\t\tif (xecfg->flags & XDL_EMIT_FUNCCONTEXT) {\n\t\t\tlong fe1 = get_func_line(xe, xecfg, NULL,\n\t\t\t\t\t\t xche->i1 + xche->chg1,\n\t\t\t\t\t\t xe->xdf1.nrec);\n\t\t\tif (fe1 < 0)\n\t\t\t\tfe1 = xe->xdf1.nrec;\n\t\t\tif (fe1 > e1) {\n\t\t\t\te2 += fe1 - e1;\n\t\t\t\te1 = fe1;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * Overlap with next change?  Then include it\n\t\t\t * in the current hunk and start over to find\n\t\t\t * its new end.\n\t\t\t */\n\t\t\tif (xche->next) {\n\t\t\t\tlong l = xche->next->i1;\n\t\t\t\tif (l <= e1 ||\n\t\t\t\t    get_func_line(xe, xecfg, NULL, l, e1) < 0) {\n\t\t\t\t\txche = xche->next;\n\t\t\t\t\tgoto again;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/*\n\t\t * Emit current hunk header.\n\t\t */\n\n\t\tif (xecfg->flags & XDL_EMIT_FUNCNAMES) {\n\t\t\tget_func_line(xe, xecfg, &func_line,\n\t\t\t\t      s1 - 1, funclineprev);\n\t\t\tfunclineprev = s1 - 1;\n\t\t}\n\t\tif (xdl_emit_hunk_hdr(s1 + 1, e1 - s1, s2 + 1, e2 - s2,\n\t\t\t\t      func_line.buf, func_line.len, ecb) < 0)\n\t\t\treturn -1;\n\n\t\t/*\n\t\t * Emit pre-context.\n\t\t */\n\t\tfor (; s2 < xch->i2; s2++)\n\t\t\tif (xdl_emit_record(&xe->xdf2, s2, \" \", ecb) < 0)\n\t\t\t\treturn -1;\n\n\t\tfor (s1 = xch->i1, s2 = xch->i2;; xch = xch->next) {\n\t\t\t/*\n\t\t\t * Merge previous with current change atom.\n\t\t\t */\n\t\t\tfor (; s1 < xch->i1 && s2 < xch->i2; s1++, s2++)\n\t\t\t\tif (xdl_emit_record(&xe->xdf2, s2, \" \", ecb) < 0)\n\t\t\t\t\treturn -1;\n\n\t\t\t/*\n\t\t\t * Removes lines from the first file.\n\t\t\t */\n\t\t\tfor (s1 = xch->i1; s1 < xch->i1 + xch->chg1; s1++)\n\t\t\t\tif (xdl_emit_record(&xe->xdf1, s1, \"-\", ecb) < 0)\n\t\t\t\t\treturn -1;\n\n\t\t\t/*\n\t\t\t * Adds lines from the second file.\n\t\t\t */\n\t\t\tfor (s2 = xch->i2; s2 < xch->i2 + xch->chg2; s2++)\n\t\t\t\tif (xdl_emit_record(&xe->xdf2, s2, \"+\", ecb) < 0)\n\t\t\t\t\treturn -1;\n\n\t\t\tif (xch == xche)\n\t\t\t\tbreak;\n\t\t\ts1 = xch->i1 + xch->chg1;\n\t\t\ts2 = xch->i2 + xch->chg2;\n\t\t}\n\n\t\t/*\n\t\t * Emit post-context.\n\t\t */\n\t\tfor (s2 = xche->i2 + xche->chg2; s2 < e2; s2++)\n\t\t\tif (xdl_emit_record(&xe->xdf2, s2, \" \", ecb) < 0)\n\t\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "get_func_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
    "lines": "148-169",
    "snippet": "static long get_func_line(xdfenv_t *xe, xdemitconf_t const *xecfg,\n\t\t\t  struct func_line *func_line, long start, long limit)\n{\n\tfind_func_t ff = xecfg->find_func ? xecfg->find_func : def_ff;\n\tlong l, size, step = (start > limit) ? -1 : 1;\n\tchar *buf, dummy[1];\n\n\tbuf = func_line ? func_line->buf : dummy;\n\tsize = func_line ? sizeof(func_line->buf) : sizeof(dummy);\n\n\tfor (l = start; l != limit && 0 <= l && l < xe->xdf1.nrec; l += step) {\n\t\tconst char *rec;\n\t\tlong reclen = xdl_get_rec(&xe->xdf1, l, &rec);\n\t\tlong len = ff(rec, reclen, buf, size, xecfg->find_func_priv);\n\t\tif (len >= 0) {\n\t\t\tif (func_line)\n\t\t\t\tfunc_line->len = len;\n\t\t\treturn l;\n\t\t}\n\t}\n\treturn -1;\n}",
    "includes": [
      "#include \"xinclude.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ff",
          "args": [
            "rec",
            "reclen",
            "buf",
            "size",
            "xecfg->find_func_priv"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "def_ff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
          "lines": "107-123",
          "snippet": "static long def_ff(const char *rec, long len, char *buf, long sz, void *priv)\n{\n\t(void)priv;\n\n\tif (len > 0 &&\n\t\t\t(isalpha((unsigned char)*rec) || /* identifier? */\n\t\t\t *rec == '_' ||\t/* also identifier? */\n\t\t\t *rec == '$')) { /* identifiers from VMS and other esoterico */\n\t\tif (len > sz)\n\t\t\tlen = sz;\n\t\twhile (0 < len && isspace((unsigned char)rec[len - 1]))\n\t\t\tlen--;\n\t\tmemcpy(buf, rec, len);\n\t\treturn len;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\n\nstatic long def_ff(const char *rec, long len, char *buf, long sz, void *priv)\n{\n\t(void)priv;\n\n\tif (len > 0 &&\n\t\t\t(isalpha((unsigned char)*rec) || /* identifier? */\n\t\t\t *rec == '_' ||\t/* also identifier? */\n\t\t\t *rec == '$')) { /* identifiers from VMS and other esoterico */\n\t\tif (len > sz)\n\t\t\tlen = sz;\n\t\twhile (0 < len && isspace((unsigned char)rec[len - 1]))\n\t\t\tlen--;\n\t\tmemcpy(buf, rec, len);\n\t\treturn len;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdl_get_rec",
          "args": [
            "&xe->xdf1",
            "l",
            "&rec"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_get_rec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
          "lines": "34-39",
          "snippet": "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec) {\n\n\t*rec = xdf->recs[ri]->ptr;\n\n\treturn xdf->recs[ri]->size;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec) {\n\n\t*rec = xdf->recs[ri]->ptr;\n\n\treturn xdf->recs[ri]->size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\n\nstatic long get_func_line(xdfenv_t *xe, xdemitconf_t const *xecfg,\n\t\t\t  struct func_line *func_line, long start, long limit)\n{\n\tfind_func_t ff = xecfg->find_func ? xecfg->find_func : def_ff;\n\tlong l, size, step = (start > limit) ? -1 : 1;\n\tchar *buf, dummy[1];\n\n\tbuf = func_line ? func_line->buf : dummy;\n\tsize = func_line ? sizeof(func_line->buf) : sizeof(dummy);\n\n\tfor (l = start; l != limit && 0 <= l && l < xe->xdf1.nrec; l += step) {\n\t\tconst char *rec;\n\t\tlong reclen = xdl_get_rec(&xe->xdf1, l, &rec);\n\t\tlong len = ff(rec, reclen, buf, size, xecfg->find_func_priv);\n\t\tif (len >= 0) {\n\t\t\tif (func_line)\n\t\t\t\tfunc_line->len = len;\n\t\t\treturn l;\n\t\t}\n\t}\n\treturn -1;\n}"
  },
  {
    "function_name": "xdl_emit_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
    "lines": "125-141",
    "snippet": "static int xdl_emit_common(xdfenv_t *xe, xdchange_t *xscr, xdemitcb_t *ecb,\n                           xdemitconf_t const *xecfg) {\n\txdfile_t *xdf = &xe->xdf2;\n\tconst char *rchg = xdf->rchg;\n\tlong ix;\n\n\t(void)xscr;\n\t(void)xecfg;\n\n\tfor (ix = 0; ix < xdf->nrec; ix++) {\n\t\tif (rchg[ix])\n\t\t\tcontinue;\n\t\tif (xdl_emit_record(xdf, ix, \"\", ecb))\n\t\t\treturn -1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"xinclude.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdl_emit_record",
          "args": [
            "xdf",
            "ix",
            "\"\"",
            "ecb"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_emit_record",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
          "lines": "42-53",
          "snippet": "static int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb) {\n\tlong size, psize = (long)strlen(pre);\n\tchar const *rec;\n\n\tsize = xdl_get_rec(xdf, ri, &rec);\n\tif (xdl_emit_diffrec(rec, size, pre, psize, ecb) < 0) {\n\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);",
            "static int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\nstatic int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);\n\nstatic int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb) {\n\tlong size, psize = (long)strlen(pre);\n\tchar const *rec;\n\n\tsize = xdl_get_rec(xdf, ri, &rec);\n\tif (xdl_emit_diffrec(rec, size, pre, psize, ecb) < 0) {\n\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xinclude.h\"\n\nstatic int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);\n\nstatic int xdl_emit_common(xdfenv_t *xe, xdchange_t *xscr, xdemitcb_t *ecb,\n                           xdemitconf_t const *xecfg) {\n\txdfile_t *xdf = &xe->xdf2;\n\tconst char *rchg = xdf->rchg;\n\tlong ix;\n\n\t(void)xscr;\n\t(void)xecfg;\n\n\tfor (ix = 0; ix < xdf->nrec; ix++) {\n\t\tif (rchg[ix])\n\t\t\tcontinue;\n\t\tif (xdl_emit_record(xdf, ix, \"\", ecb))\n\t\t\treturn -1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "def_ff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
    "lines": "107-123",
    "snippet": "static long def_ff(const char *rec, long len, char *buf, long sz, void *priv)\n{\n\t(void)priv;\n\n\tif (len > 0 &&\n\t\t\t(isalpha((unsigned char)*rec) || /* identifier? */\n\t\t\t *rec == '_' ||\t/* also identifier? */\n\t\t\t *rec == '$')) { /* identifiers from VMS and other esoterico */\n\t\tif (len > sz)\n\t\t\tlen = sz;\n\t\twhile (0 < len && isspace((unsigned char)rec[len - 1]))\n\t\t\tlen--;\n\t\tmemcpy(buf, rec, len);\n\t\treturn len;\n\t}\n\treturn -1;\n}",
    "includes": [
      "#include \"xinclude.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "rec",
            "len"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "(unsigned char)rec[len - 1]"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "git__isspace_nonlf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "459-462",
          "snippet": "GIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}"
        }
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "(unsigned char)*rec"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "git__isalpha",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "444-447",
          "snippet": "GIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\n\nstatic long def_ff(const char *rec, long len, char *buf, long sz, void *priv)\n{\n\t(void)priv;\n\n\tif (len > 0 &&\n\t\t\t(isalpha((unsigned char)*rec) || /* identifier? */\n\t\t\t *rec == '_' ||\t/* also identifier? */\n\t\t\t *rec == '$')) { /* identifiers from VMS and other esoterico */\n\t\tif (len > sz)\n\t\t\tlen = sz;\n\t\twhile (0 < len && isspace((unsigned char)rec[len - 1]))\n\t\t\tlen--;\n\t\tmemcpy(buf, rec, len);\n\t\treturn len;\n\t}\n\treturn -1;\n}"
  },
  {
    "function_name": "xdl_get_hunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
    "lines": "61-104",
    "snippet": "xdchange_t *xdl_get_hunk(xdchange_t **xscr, xdemitconf_t const *xecfg)\n{\n\txdchange_t *xch, *xchp, *lxch;\n\tlong max_common = 2 * xecfg->ctxlen + xecfg->interhunkctxlen;\n\tlong max_ignorable = xecfg->ctxlen;\n\tunsigned long ignored = 0; /* number of ignored blank lines */\n\n\t/* remove ignorable changes that are too far before other changes */\n\tfor (xchp = *xscr; xchp && xchp->ignore; xchp = xchp->next) {\n\t\txch = xchp->next;\n\n\t\tif (xch == NULL ||\n\t\t    xch->i1 - (xchp->i1 + xchp->chg1) >= max_ignorable)\n\t\t\t*xscr = xch;\n\t}\n\n\tif (*xscr == NULL)\n\t\treturn NULL;\n\n\tlxch = *xscr;\n\n\tfor (xchp = *xscr, xch = xchp->next; xch; xchp = xch, xch = xch->next) {\n\t\tlong distance = xch->i1 - (xchp->i1 + xchp->chg1);\n\t\tif (distance > max_common)\n\t\t\tbreak;\n\n\t\tif (distance < max_ignorable && (!xch->ignore || lxch == xchp)) {\n\t\t\tlxch = xch;\n\t\t\tignored = 0;\n\t\t} else if (distance < max_ignorable && xch->ignore) {\n\t\t\tignored += xch->chg2;\n\t\t} else if (lxch != xchp &&\n\t\t\t   xch->i1 + ignored - (lxch->i1 + lxch->chg1) > (unsigned long)max_common) {\n\t\t\tbreak;\n\t\t} else if (!xch->ignore) {\n\t\t\tlxch = xch;\n\t\t\tignored = 0;\n\t\t} else {\n\t\t\tignored += xch->chg2;\n\t\t}\n\t}\n\n\treturn lxch;\n}",
    "includes": [
      "#include \"xinclude.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xinclude.h\"\n\nxdchange_t *xdl_get_hunk(xdchange_t **xscr, xdemitconf_t const *xecfg)\n{\n\txdchange_t *xch, *xchp, *lxch;\n\tlong max_common = 2 * xecfg->ctxlen + xecfg->interhunkctxlen;\n\tlong max_ignorable = xecfg->ctxlen;\n\tunsigned long ignored = 0; /* number of ignored blank lines */\n\n\t/* remove ignorable changes that are too far before other changes */\n\tfor (xchp = *xscr; xchp && xchp->ignore; xchp = xchp->next) {\n\t\txch = xchp->next;\n\n\t\tif (xch == NULL ||\n\t\t    xch->i1 - (xchp->i1 + xchp->chg1) >= max_ignorable)\n\t\t\t*xscr = xch;\n\t}\n\n\tif (*xscr == NULL)\n\t\treturn NULL;\n\n\tlxch = *xscr;\n\n\tfor (xchp = *xscr, xch = xchp->next; xch; xchp = xch, xch = xch->next) {\n\t\tlong distance = xch->i1 - (xchp->i1 + xchp->chg1);\n\t\tif (distance > max_common)\n\t\t\tbreak;\n\n\t\tif (distance < max_ignorable && (!xch->ignore || lxch == xchp)) {\n\t\t\tlxch = xch;\n\t\t\tignored = 0;\n\t\t} else if (distance < max_ignorable && xch->ignore) {\n\t\t\tignored += xch->chg2;\n\t\t} else if (lxch != xchp &&\n\t\t\t   xch->i1 + ignored - (lxch->i1 + lxch->chg1) > (unsigned long)max_common) {\n\t\t\tbreak;\n\t\t} else if (!xch->ignore) {\n\t\t\tlxch = xch;\n\t\t\tignored = 0;\n\t\t} else {\n\t\t\tignored += xch->chg2;\n\t\t}\n\t}\n\n\treturn lxch;\n}"
  },
  {
    "function_name": "xdl_emit_record",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
    "lines": "42-53",
    "snippet": "static int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb) {\n\tlong size, psize = (long)strlen(pre);\n\tchar const *rec;\n\n\tsize = xdl_get_rec(xdf, ri, &rec);\n\tif (xdl_emit_diffrec(rec, size, pre, psize, ecb) < 0) {\n\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"xinclude.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);",
      "static int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdl_emit_diffrec",
          "args": [
            "rec",
            "size",
            "pre",
            "psize",
            "ecb"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_emit_diffrec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xutils.c",
          "lines": "41-61",
          "snippet": "int xdl_emit_diffrec(char const *rec, long size, char const *pre, long psize,\n\t\t     xdemitcb_t *ecb) {\n\tint i = 2;\n\tmmbuffer_t mb[3];\n\n\tmb[0].ptr = (char *) pre;\n\tmb[0].size = psize;\n\tmb[1].ptr = (char *) rec;\n\tmb[1].size = size;\n\tif (size > 0 && rec[size - 1] != '\\n') {\n\t\tmb[2].ptr = (char *) \"\\n\\\\ No newline at end of file\\n\";\n\t\tmb[2].size = strlen(mb[2].ptr);\n\t\ti++;\n\t}\n\tif (ecb->outf(ecb->priv, mb, i) < 0) {\n\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nint xdl_emit_diffrec(char const *rec, long size, char const *pre, long psize,\n\t\t     xdemitcb_t *ecb) {\n\tint i = 2;\n\tmmbuffer_t mb[3];\n\n\tmb[0].ptr = (char *) pre;\n\tmb[0].size = psize;\n\tmb[1].ptr = (char *) rec;\n\tmb[1].size = size;\n\tif (size > 0 && rec[size - 1] != '\\n') {\n\t\tmb[2].ptr = (char *) \"\\n\\\\ No newline at end of file\\n\";\n\t\tmb[2].size = strlen(mb[2].ptr);\n\t\ti++;\n\t}\n\tif (ecb->outf(ecb->priv, mb, i) < 0) {\n\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdl_get_rec",
          "args": [
            "xdf",
            "ri",
            "&rec"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_get_rec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
          "lines": "34-39",
          "snippet": "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec) {\n\n\t*rec = xdf->recs[ri]->ptr;\n\n\treturn xdf->recs[ri]->size;\n}",
          "includes": [
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec) {\n\n\t*rec = xdf->recs[ri]->ptr;\n\n\treturn xdf->recs[ri]->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pre"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\nstatic int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb);\n\nstatic int xdl_emit_record(xdfile_t *xdf, long ri, char const *pre, xdemitcb_t *ecb) {\n\tlong size, psize = (long)strlen(pre);\n\tchar const *rec;\n\n\tsize = xdl_get_rec(xdf, ri, &rec);\n\tif (xdl_emit_diffrec(rec, size, pre, psize, ecb) < 0) {\n\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "xdl_get_rec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xemit.c",
    "lines": "34-39",
    "snippet": "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec) {\n\n\t*rec = xdf->recs[ri]->ptr;\n\n\treturn xdf->recs[ri]->size;\n}",
    "includes": [
      "#include \"xinclude.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"xinclude.h\"\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec);\n\nstatic long xdl_get_rec(xdfile_t *xdf, long ri, char const **rec) {\n\n\t*rec = xdf->recs[ri]->ptr;\n\n\treturn xdf->recs[ri]->size;\n}"
  }
]