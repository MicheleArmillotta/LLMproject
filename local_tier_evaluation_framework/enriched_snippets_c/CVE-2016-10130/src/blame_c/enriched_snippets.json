[
  {
    "function_name": "git_blame_init_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "511-516",
    "snippet": "int git_blame_init_options(git_blame_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_blame_options, GIT_BLAME_OPTIONS_INIT);\n\treturn 0;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_INIT_STRUCTURE_FROM_TEMPLATE",
          "args": [
            "opts",
            "version",
            "git_blame_options",
            "GIT_BLAME_OPTIONS_INIT"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nint git_blame_init_options(git_blame_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_blame_options, GIT_BLAME_OPTIONS_INIT);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_blame_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "476-509",
    "snippet": "int git_blame_buffer(\n\t\tgit_blame **out,\n\t\tgit_blame *reference,\n\t\tconst char *buffer,\n\t\tsize_t buffer_len)\n{\n\tgit_blame *blame;\n\tgit_diff_options diffopts = GIT_DIFF_OPTIONS_INIT;\n\tsize_t i;\n\tgit_blame_hunk *hunk;\n\n\tdiffopts.context_lines = 0;\n\n\tassert(out && reference && buffer && buffer_len);\n\n\tblame = git_blame__alloc(reference->repository, reference->options, reference->path);\n\tGITERR_CHECK_ALLOC(blame);\n\n\t/* Duplicate all of the hunk structures in the reference blame */\n\tgit_vector_foreach(&reference->hunks, i, hunk) {\n\t\tgit_blame_hunk *h = dup_hunk(hunk);\n\t\tGITERR_CHECK_ALLOC(h);\n\n\t\tgit_vector_insert(&blame->hunks, h);\n\t}\n\n\t/* Diff to the reference blob */\n\tgit_diff_blob_to_buffer(reference->final_blob, blame->path,\n\t\tbuffer, buffer_len, blame->path, &diffopts,\n\t\tNULL, NULL, buffer_hunk_cb, buffer_line_cb, blame);\n\n\t*out = blame;\n\treturn 0;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_diff_blob_to_buffer",
          "args": [
            "reference->final_blob",
            "blame->path",
            "buffer",
            "buffer_len",
            "blame->path",
            "&diffopts",
            "NULL",
            "NULL",
            "buffer_hunk_cb",
            "buffer_line_cb",
            "blame"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_blob_to_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "659-678",
          "snippet": "int git_diff_blob_to_buffer(\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst char *buf,\n\tsize_t buflen,\n\tconst char *buf_path,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(buf, buflen, buf_path);\n\treturn diff_from_sources(\n\t\t&osrc, &nsrc, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nint git_diff_blob_to_buffer(\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst char *buf,\n\tsize_t buflen,\n\tconst char *buf_path,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(buf, buflen, buf_path);\n\treturn diff_from_sources(\n\t\t&osrc, &nsrc, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&blame->hunks",
            "h"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "h"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dup_hunk",
          "args": [
            "hunk"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "dup_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "72-89",
          "snippet": "static git_blame_hunk* dup_hunk(git_blame_hunk *hunk)\n{\n\tgit_blame_hunk *newhunk = new_hunk(\n\t\t\thunk->final_start_line_number,\n\t\t\thunk->lines_in_hunk,\n\t\t\thunk->orig_start_line_number,\n\t\t\thunk->orig_path);\n\n\tif (!newhunk)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&newhunk->orig_commit_id, &hunk->orig_commit_id);\n\tgit_oid_cpy(&newhunk->final_commit_id, &hunk->final_commit_id);\n\tnewhunk->boundary = hunk->boundary;\n\tgit_signature_dup(&newhunk->final_signature, hunk->final_signature);\n\tgit_signature_dup(&newhunk->orig_signature, hunk->orig_signature);\n\treturn newhunk;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* dup_hunk(git_blame_hunk *hunk)\n{\n\tgit_blame_hunk *newhunk = new_hunk(\n\t\t\thunk->final_start_line_number,\n\t\t\thunk->lines_in_hunk,\n\t\t\thunk->orig_start_line_number,\n\t\t\thunk->orig_path);\n\n\tif (!newhunk)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&newhunk->orig_commit_id, &hunk->orig_commit_id);\n\tgit_oid_cpy(&newhunk->final_commit_id, &hunk->final_commit_id);\n\tnewhunk->boundary = hunk->boundary;\n\tgit_signature_dup(&newhunk->final_signature, hunk->final_signature);\n\tgit_signature_dup(&newhunk->orig_signature, hunk->orig_signature);\n\treturn newhunk;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&reference->hunks",
            "i",
            "hunk"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "blame"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_blame__alloc",
          "args": [
            "reference->repository",
            "reference->options",
            "reference->path"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame__alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "113-135",
          "snippet": "git_blame* git_blame__alloc(\n\tgit_repository *repo,\n\tgit_blame_options opts,\n\tconst char *path)\n{\n\tgit_blame *gbr = git__calloc(1, sizeof(git_blame));\n\tif (!gbr)\n\t\treturn NULL;\n\n\tgbr->repository = repo;\n\tgbr->options = opts;\n\n\tif (git_vector_init(&gbr->hunks, 8, hunk_cmp) < 0 ||\n\t\tgit_vector_init(&gbr->paths, 8, paths_cmp) < 0 ||\n\t\t(gbr->path = git__strdup(path)) == NULL ||\n\t\tgit_vector_insert(&gbr->paths, git__strdup(path)) < 0)\n\t{\n\t\tgit_blame_free(gbr);\n\t\treturn NULL;\n\t}\n\n\treturn gbr;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\ngit_blame* git_blame__alloc(\n\tgit_repository *repo,\n\tgit_blame_options opts,\n\tconst char *path)\n{\n\tgit_blame *gbr = git__calloc(1, sizeof(git_blame));\n\tif (!gbr)\n\t\treturn NULL;\n\n\tgbr->repository = repo;\n\tgbr->options = opts;\n\n\tif (git_vector_init(&gbr->hunks, 8, hunk_cmp) < 0 ||\n\t\tgit_vector_init(&gbr->paths, 8, paths_cmp) < 0 ||\n\t\t(gbr->path = git__strdup(path)) == NULL ||\n\t\tgit_vector_insert(&gbr->paths, git__strdup(path)) < 0)\n\t{\n\t\tgit_blame_free(gbr);\n\t\treturn NULL;\n\t}\n\n\treturn gbr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && reference && buffer && buffer_len"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nint git_blame_buffer(\n\t\tgit_blame **out,\n\t\tgit_blame *reference,\n\t\tconst char *buffer,\n\t\tsize_t buffer_len)\n{\n\tgit_blame *blame;\n\tgit_diff_options diffopts = GIT_DIFF_OPTIONS_INIT;\n\tsize_t i;\n\tgit_blame_hunk *hunk;\n\n\tdiffopts.context_lines = 0;\n\n\tassert(out && reference && buffer && buffer_len);\n\n\tblame = git_blame__alloc(reference->repository, reference->options, reference->path);\n\tGITERR_CHECK_ALLOC(blame);\n\n\t/* Duplicate all of the hunk structures in the reference blame */\n\tgit_vector_foreach(&reference->hunks, i, hunk) {\n\t\tgit_blame_hunk *h = dup_hunk(hunk);\n\t\tGITERR_CHECK_ALLOC(h);\n\n\t\tgit_vector_insert(&blame->hunks, h);\n\t}\n\n\t/* Diff to the reference blob */\n\tgit_diff_blob_to_buffer(reference->final_blob, blame->path,\n\t\tbuffer, buffer_len, blame->path, &diffopts,\n\t\tNULL, NULL, buffer_hunk_cb, buffer_line_cb, blame);\n\n\t*out = blame;\n\treturn 0;\n}"
  },
  {
    "function_name": "buffer_line_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "429-474",
    "snippet": "static int buffer_line_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tconst git_diff_line *line,\n\tvoid *payload)\n{\n\tgit_blame *blame = (git_blame*)payload;\n\n\tGIT_UNUSED(delta);\n\tGIT_UNUSED(hunk);\n\tGIT_UNUSED(line);\n\n\tif (line->origin == GIT_DIFF_LINE_ADDITION) {\n\t\tif (hunk_is_bufferblame(blame->current_hunk) &&\n\t\t    hunk_ends_at_or_before_line(blame->current_hunk, blame->current_diff_line)) {\n\t\t\t/* Append to the current buffer-blame hunk */\n\t\t\tblame->current_hunk->lines_in_hunk++;\n\t\t\tshift_hunks_by(&blame->hunks, blame->current_diff_line+1, 1);\n\t\t} else {\n\t\t\t/* Create a new buffer-blame hunk with this line */\n\t\t\tshift_hunks_by(&blame->hunks, blame->current_diff_line, 1);\n\t\t\tblame->current_hunk = new_hunk(blame->current_diff_line, 1, 0, blame->path);\n\t\t\tGITERR_CHECK_ALLOC(blame->current_hunk);\n\n\t\t\tgit_vector_insert_sorted(&blame->hunks, blame->current_hunk, NULL);\n\t\t}\n\t\tblame->current_diff_line++;\n\t}\n\n\tif (line->origin == GIT_DIFF_LINE_DELETION) {\n\t\t/* Trim the line from the current hunk; remove it if it's now empty */\n\t\tsize_t shift_base = blame->current_diff_line + blame->current_hunk->lines_in_hunk+1;\n\n\t\tif (--(blame->current_hunk->lines_in_hunk) == 0) {\n\t\t\tsize_t i;\n\t\t\tshift_base--;\n\t\t\tif (!git_vector_search2(&i, &blame->hunks, ptrs_equal_cmp, blame->current_hunk)) {\n\t\t\t\tgit_vector_remove(&blame->hunks, i);\n\t\t\t\tfree_hunk(blame->current_hunk);\n\t\t\t\tblame->current_hunk = (git_blame_hunk*)git_blame_get_hunk_byindex(blame, (uint32_t)i);\n\t\t\t}\n\t\t}\n\t\tshift_hunks_by(&blame->hunks, shift_base, -1);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shift_hunks_by",
          "args": [
            "&blame->hunks",
            "shift_base",
            "-1"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "shift_hunks_by",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "101-111",
          "snippet": "static void shift_hunks_by(git_vector *v, size_t start_line, int shift_by)\n{\n\tsize_t i;\n\n\tif (!git_vector_bsearch2(&i, v, hunk_byfinalline_search_cmp, &start_line)) {\n\t\tfor (; i < v->length; i++) {\n\t\t\tgit_blame_hunk *hunk = (git_blame_hunk*)v->contents[i];\n\t\t\thunk->final_start_line_number += shift_by;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic void shift_hunks_by(git_vector *v, size_t start_line, int shift_by)\n{\n\tsize_t i;\n\n\tif (!git_vector_bsearch2(&i, v, hunk_byfinalline_search_cmp, &start_line)) {\n\t\tfor (; i < v->length; i++) {\n\t\t\tgit_blame_hunk *hunk = (git_blame_hunk*)v->contents[i];\n\t\t\thunk->final_start_line_number += shift_by;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blame_get_hunk_byindex",
          "args": [
            "blame",
            "(uint32_t)i"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame_get_hunk_byindex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "163-167",
          "snippet": "const git_blame_hunk *git_blame_get_hunk_byindex(git_blame *blame, uint32_t index)\n{\n\tassert(blame);\n\treturn (git_blame_hunk*)git_vector_get(&blame->hunks, index);\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nconst git_blame_hunk *git_blame_get_hunk_byindex(git_blame *blame, uint32_t index)\n{\n\tassert(blame);\n\treturn (git_blame_hunk*)git_vector_get(&blame->hunks, index);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_hunk",
          "args": [
            "blame->current_hunk"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "free_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "91-97",
          "snippet": "static void free_hunk(git_blame_hunk *hunk)\n{\n\tgit__free((void*)hunk->orig_path);\n\tgit_signature_free(hunk->final_signature);\n\tgit_signature_free(hunk->orig_signature);\n\tgit__free(hunk);\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic void free_hunk(git_blame_hunk *hunk)\n{\n\tgit__free((void*)hunk->orig_path);\n\tgit_signature_free(hunk->final_signature);\n\tgit_signature_free(hunk->orig_signature);\n\tgit__free(hunk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_remove",
          "args": [
            "&blame->hunks",
            "i"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "233-250",
          "snippet": "int git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_search2",
          "args": [
            "&i",
            "&blame->hunks",
            "ptrs_equal_cmp",
            "blame->current_hunk"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_search2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "204-221",
          "snippet": "int git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert_sorted",
          "args": [
            "&blame->hunks",
            "blame->current_hunk",
            "NULL"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert_sorted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "141-173",
          "snippet": "int git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "blame->current_hunk"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_hunk",
          "args": [
            "blame->current_diff_line",
            "1",
            "0",
            "blame->path"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "new_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "55-70",
          "snippet": "static git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hunk_ends_at_or_before_line",
          "args": [
            "blame->current_hunk",
            "blame->current_diff_line"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "hunk_ends_at_or_before_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "45-48",
          "snippet": "static bool hunk_ends_at_or_before_line(git_blame_hunk *hunk, size_t line)\n{\n\treturn line >= (hunk->final_start_line_number + hunk->lines_in_hunk - 1);\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic bool hunk_ends_at_or_before_line(git_blame_hunk *hunk, size_t line)\n{\n\treturn line >= (hunk->final_start_line_number + hunk->lines_in_hunk - 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hunk_is_bufferblame",
          "args": [
            "blame->current_hunk"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "hunk_is_bufferblame",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "393-396",
          "snippet": "static bool hunk_is_bufferblame(git_blame_hunk *hunk)\n{\n\treturn git_oid_iszero(&hunk->final_commit_id);\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic bool hunk_is_bufferblame(git_blame_hunk *hunk)\n{\n\treturn git_oid_iszero(&hunk->final_commit_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "line"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "hunk"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "delta"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int buffer_line_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tconst git_diff_line *line,\n\tvoid *payload)\n{\n\tgit_blame *blame = (git_blame*)payload;\n\n\tGIT_UNUSED(delta);\n\tGIT_UNUSED(hunk);\n\tGIT_UNUSED(line);\n\n\tif (line->origin == GIT_DIFF_LINE_ADDITION) {\n\t\tif (hunk_is_bufferblame(blame->current_hunk) &&\n\t\t    hunk_ends_at_or_before_line(blame->current_hunk, blame->current_diff_line)) {\n\t\t\t/* Append to the current buffer-blame hunk */\n\t\t\tblame->current_hunk->lines_in_hunk++;\n\t\t\tshift_hunks_by(&blame->hunks, blame->current_diff_line+1, 1);\n\t\t} else {\n\t\t\t/* Create a new buffer-blame hunk with this line */\n\t\t\tshift_hunks_by(&blame->hunks, blame->current_diff_line, 1);\n\t\t\tblame->current_hunk = new_hunk(blame->current_diff_line, 1, 0, blame->path);\n\t\t\tGITERR_CHECK_ALLOC(blame->current_hunk);\n\n\t\t\tgit_vector_insert_sorted(&blame->hunks, blame->current_hunk, NULL);\n\t\t}\n\t\tblame->current_diff_line++;\n\t}\n\n\tif (line->origin == GIT_DIFF_LINE_DELETION) {\n\t\t/* Trim the line from the current hunk; remove it if it's now empty */\n\t\tsize_t shift_base = blame->current_diff_line + blame->current_hunk->lines_in_hunk+1;\n\n\t\tif (--(blame->current_hunk->lines_in_hunk) == 0) {\n\t\t\tsize_t i;\n\t\t\tshift_base--;\n\t\t\tif (!git_vector_search2(&i, &blame->hunks, ptrs_equal_cmp, blame->current_hunk)) {\n\t\t\t\tgit_vector_remove(&blame->hunks, i);\n\t\t\t\tfree_hunk(blame->current_hunk);\n\t\t\t\tblame->current_hunk = (git_blame_hunk*)git_blame_get_hunk_byindex(blame, (uint32_t)i);\n\t\t\t}\n\t\t}\n\t\tshift_hunks_by(&blame->hunks, shift_base, -1);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "ptrs_equal_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "428-428",
    "snippet": "static int ptrs_equal_cmp(const void *a, const void *b) { return a<b ? -1 : a>b ? 1 : 0; }",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int ptrs_equal_cmp(const void *a, const void *b) { return a<b ? -1 : a>b ? 1 : 0; }"
  },
  {
    "function_name": "buffer_hunk_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "398-426",
    "snippet": "static int buffer_hunk_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tvoid *payload)\n{\n\tgit_blame *blame = (git_blame*)payload;\n\tuint32_t wedge_line;\n\n\tGIT_UNUSED(delta);\n\n\twedge_line = (hunk->old_lines == 0) ? hunk->new_start : hunk->old_start;\n\tblame->current_diff_line = wedge_line;\n\n\tblame->current_hunk = (git_blame_hunk*)git_blame_get_hunk_byline(blame, wedge_line);\n\tif (!blame->current_hunk) {\n\t\t/* Line added at the end of the file */\n\t\tblame->current_hunk = new_hunk(wedge_line, 0, wedge_line, blame->path);\n\t\tGITERR_CHECK_ALLOC(blame->current_hunk);\n\n\t\tgit_vector_insert(&blame->hunks, blame->current_hunk);\n\t} else if (!hunk_starts_at_or_after_line(blame->current_hunk, wedge_line)){\n\t\t/* If this hunk doesn't start between existing hunks, split a hunk up so it does */\n\t\tblame->current_hunk = split_hunk_in_vector(&blame->hunks, blame->current_hunk,\n\t\t\t\twedge_line - blame->current_hunk->orig_start_line_number, true);\n\t\tGITERR_CHECK_ALLOC(blame->current_hunk);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "blame->current_hunk"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "split_hunk_in_vector",
          "args": [
            "&blame->hunks",
            "blame->current_hunk",
            "wedge_line - blame->current_hunk->orig_start_line_number",
            "true"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "split_hunk_in_vector",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "213-246",
          "snippet": "static git_blame_hunk *split_hunk_in_vector(\n\t\tgit_vector *vec,\n\t\tgit_blame_hunk *hunk,\n\t\tsize_t rel_line,\n\t\tbool return_new)\n{\n\tsize_t new_line_count;\n\tgit_blame_hunk *nh;\n\n\t/* Don't split if already at a boundary */\n\tif (rel_line <= 0 ||\n\t    rel_line >= hunk->lines_in_hunk)\n\t{\n\t\treturn hunk;\n\t}\n\n\tnew_line_count = hunk->lines_in_hunk - rel_line;\n\tnh = new_hunk(hunk->final_start_line_number + rel_line, new_line_count,\n\t\t\thunk->orig_start_line_number + rel_line, hunk->orig_path);\n\n\tif (!nh)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&nh->final_commit_id, &hunk->final_commit_id);\n\tgit_oid_cpy(&nh->orig_commit_id, &hunk->orig_commit_id);\n\n\t/* Adjust hunk that was split */\n\thunk->lines_in_hunk -= new_line_count;\n\tgit_vector_insert_sorted(vec, nh, NULL);\n\t{\n\t\tgit_blame_hunk *ret = return_new ? nh : hunk;\n\t\treturn ret;\n\t}\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk *split_hunk_in_vector(\n\t\tgit_vector *vec,\n\t\tgit_blame_hunk *hunk,\n\t\tsize_t rel_line,\n\t\tbool return_new)\n{\n\tsize_t new_line_count;\n\tgit_blame_hunk *nh;\n\n\t/* Don't split if already at a boundary */\n\tif (rel_line <= 0 ||\n\t    rel_line >= hunk->lines_in_hunk)\n\t{\n\t\treturn hunk;\n\t}\n\n\tnew_line_count = hunk->lines_in_hunk - rel_line;\n\tnh = new_hunk(hunk->final_start_line_number + rel_line, new_line_count,\n\t\t\thunk->orig_start_line_number + rel_line, hunk->orig_path);\n\n\tif (!nh)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&nh->final_commit_id, &hunk->final_commit_id);\n\tgit_oid_cpy(&nh->orig_commit_id, &hunk->orig_commit_id);\n\n\t/* Adjust hunk that was split */\n\thunk->lines_in_hunk -= new_line_count;\n\tgit_vector_insert_sorted(vec, nh, NULL);\n\t{\n\t\tgit_blame_hunk *ret = return_new ? nh : hunk;\n\t\treturn ret;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "hunk_starts_at_or_after_line",
          "args": [
            "blame->current_hunk",
            "wedge_line"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "hunk_starts_at_or_after_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "50-53",
          "snippet": "static bool hunk_starts_at_or_after_line(git_blame_hunk *hunk, size_t line)\n{\n\treturn line <= hunk->final_start_line_number;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic bool hunk_starts_at_or_after_line(git_blame_hunk *hunk, size_t line)\n{\n\treturn line <= hunk->final_start_line_number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&blame->hunks",
            "blame->current_hunk"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "blame->current_hunk"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_hunk",
          "args": [
            "wedge_line",
            "0",
            "wedge_line",
            "blame->path"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "new_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "55-70",
          "snippet": "static git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blame_get_hunk_byline",
          "args": [
            "blame",
            "wedge_line"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame_get_hunk_byline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "169-179",
          "snippet": "const git_blame_hunk *git_blame_get_hunk_byline(git_blame *blame, size_t lineno)\n{\n\tsize_t i, new_lineno = lineno;\n\tassert(blame);\n\n\tif (!git_vector_bsearch2(&i, &blame->hunks, hunk_byfinalline_search_cmp, &new_lineno)) {\n\t\treturn git_blame_get_hunk_byindex(blame, (uint32_t)i);\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nconst git_blame_hunk *git_blame_get_hunk_byline(git_blame *blame, size_t lineno)\n{\n\tsize_t i, new_lineno = lineno;\n\tassert(blame);\n\n\tif (!git_vector_bsearch2(&i, &blame->hunks, hunk_byfinalline_search_cmp, &new_lineno)) {\n\t\treturn git_blame_get_hunk_byindex(blame, (uint32_t)i);\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "delta"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int buffer_hunk_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tvoid *payload)\n{\n\tgit_blame *blame = (git_blame*)payload;\n\tuint32_t wedge_line;\n\n\tGIT_UNUSED(delta);\n\n\twedge_line = (hunk->old_lines == 0) ? hunk->new_start : hunk->old_start;\n\tblame->current_diff_line = wedge_line;\n\n\tblame->current_hunk = (git_blame_hunk*)git_blame_get_hunk_byline(blame, wedge_line);\n\tif (!blame->current_hunk) {\n\t\t/* Line added at the end of the file */\n\t\tblame->current_hunk = new_hunk(wedge_line, 0, wedge_line, blame->path);\n\t\tGITERR_CHECK_ALLOC(blame->current_hunk);\n\n\t\tgit_vector_insert(&blame->hunks, blame->current_hunk);\n\t} else if (!hunk_starts_at_or_after_line(blame->current_hunk, wedge_line)){\n\t\t/* If this hunk doesn't start between existing hunks, split a hunk up so it does */\n\t\tblame->current_hunk = split_hunk_in_vector(&blame->hunks, blame->current_hunk,\n\t\t\t\twedge_line - blame->current_hunk->orig_start_line_number, true);\n\t\tGITERR_CHECK_ALLOC(blame->current_hunk);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hunk_is_bufferblame",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "393-396",
    "snippet": "static bool hunk_is_bufferblame(git_blame_hunk *hunk)\n{\n\treturn git_oid_iszero(&hunk->final_commit_id);\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_iszero",
          "args": [
            "&hunk->final_commit_id"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_iszero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "239-247",
          "snippet": "int git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic bool hunk_is_bufferblame(git_blame_hunk *hunk)\n{\n\treturn git_oid_iszero(&hunk->final_commit_id);\n}"
  },
  {
    "function_name": "git_blame_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "358-387",
    "snippet": "int git_blame_file(\n\t\tgit_blame **out,\n\t\tgit_repository *repo,\n\t\tconst char *path,\n\t\tgit_blame_options *options)\n{\n\tint error = -1;\n\tgit_blame_options normOptions = GIT_BLAME_OPTIONS_INIT;\n\tgit_blame *blame = NULL;\n\n\tassert(out && repo && path);\n\tif ((error = normalize_options(&normOptions, options, repo)) < 0)\n\t\tgoto on_error;\n\n\tblame = git_blame__alloc(repo, normOptions, path);\n\tGITERR_CHECK_ALLOC(blame);\n\n\tif ((error = load_blob(blame)) < 0)\n\t\tgoto on_error;\n\n\tif ((error = blame_internal(blame)) < 0)\n\t\tgoto on_error;\n\n\t*out = blame;\n\treturn 0;\n\non_error:\n\tgit_blame_free(blame);\n\treturn error;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_blame_free",
          "args": [
            "blame"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "137-155",
          "snippet": "void git_blame_free(git_blame *blame)\n{\n\tsize_t i;\n\tgit_blame_hunk *hunk;\n\n\tif (!blame) return;\n\n\tgit_vector_foreach(&blame->hunks, i, hunk)\n\t\tfree_hunk(hunk);\n\tgit_vector_free(&blame->hunks);\n\n\tgit_vector_free_deep(&blame->paths);\n\n\tgit_array_clear(blame->line_index);\n\n\tgit__free(blame->path);\n\tgit_blob_free(blame->final_blob);\n\tgit__free(blame);\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nvoid git_blame_free(git_blame *blame)\n{\n\tsize_t i;\n\tgit_blame_hunk *hunk;\n\n\tif (!blame) return;\n\n\tgit_vector_foreach(&blame->hunks, i, hunk)\n\t\tfree_hunk(hunk);\n\tgit_vector_free(&blame->hunks);\n\n\tgit_vector_free_deep(&blame->paths);\n\n\tgit_array_clear(blame->line_index);\n\n\tgit__free(blame->path);\n\tgit_blob_free(blame->final_blob);\n\tgit__free(blame);\n}"
        }
      },
      {
        "call_info": {
          "callee": "blame_internal",
          "args": [
            "blame"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "blame_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "313-352",
          "snippet": "static int blame_internal(git_blame *blame)\n{\n\tint error;\n\tgit_blame__entry *ent = NULL;\n\tgit_blame__origin *o;\n\n\tif ((error = load_blob(blame)) < 0 ||\n\t    (error = git_blame__get_origin(&o, blame, blame->final, blame->path)) < 0)\n\t\tgoto cleanup;\n\tblame->final_buf = git_blob_rawcontent(blame->final_blob);\n\tblame->final_buf_size = git_blob_rawsize(blame->final_blob);\n\n\tent = git__calloc(1, sizeof(git_blame__entry));\n\tGITERR_CHECK_ALLOC(ent);\n\n\tent->num_lines = index_blob_lines(blame);\n\tent->lno = blame->options.min_line - 1;\n\tent->num_lines = ent->num_lines - blame->options.min_line + 1;\n\tif (blame->options.max_line > 0)\n\t\tent->num_lines = blame->options.max_line - blame->options.min_line + 1;\n\tent->s_lno = ent->lno;\n\tent->suspect = o;\n\n\tblame->ent = ent;\n\n\terror = git_blame__like_git(blame, blame->options.flags);\n\ncleanup:\n\tfor (ent = blame->ent; ent; ) {\n\t\tgit_blame__entry *e = ent->next;\n\t\tgit_blame_hunk *h = hunk_from_entry(ent);\n\n\t\tgit_vector_insert(&blame->hunks, h);\n\n\t\tgit_blame__free_entry(ent);\n\t\tent = e;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int blame_internal(git_blame *blame)\n{\n\tint error;\n\tgit_blame__entry *ent = NULL;\n\tgit_blame__origin *o;\n\n\tif ((error = load_blob(blame)) < 0 ||\n\t    (error = git_blame__get_origin(&o, blame, blame->final, blame->path)) < 0)\n\t\tgoto cleanup;\n\tblame->final_buf = git_blob_rawcontent(blame->final_blob);\n\tblame->final_buf_size = git_blob_rawsize(blame->final_blob);\n\n\tent = git__calloc(1, sizeof(git_blame__entry));\n\tGITERR_CHECK_ALLOC(ent);\n\n\tent->num_lines = index_blob_lines(blame);\n\tent->lno = blame->options.min_line - 1;\n\tent->num_lines = ent->num_lines - blame->options.min_line + 1;\n\tif (blame->options.max_line > 0)\n\t\tent->num_lines = blame->options.max_line - blame->options.min_line + 1;\n\tent->s_lno = ent->lno;\n\tent->suspect = o;\n\n\tblame->ent = ent;\n\n\terror = git_blame__like_git(blame, blame->options.flags);\n\ncleanup:\n\tfor (ent = blame->ent; ent; ) {\n\t\tgit_blame__entry *e = ent->next;\n\t\tgit_blame_hunk *h = hunk_from_entry(ent);\n\n\t\tgit_vector_insert(&blame->hunks, h);\n\n\t\tgit_blame__free_entry(ent);\n\t\tent = e;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "load_blob",
          "args": [
            "blame"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "load_blob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "297-311",
          "snippet": "static int load_blob(git_blame *blame)\n{\n\tint error;\n\n\tif (blame->final_blob) return 0;\n\n\terror = git_commit_lookup(&blame->final, blame->repository, &blame->options.newest_commit);\n\tif (error < 0)\n\t\tgoto cleanup;\n\terror = git_object_lookup_bypath((git_object**)&blame->final_blob,\n\t\t\t(git_object*)blame->final, blame->path, GIT_OBJ_BLOB);\n\ncleanup:\n\treturn error;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int load_blob(git_blame *blame)\n{\n\tint error;\n\n\tif (blame->final_blob) return 0;\n\n\terror = git_commit_lookup(&blame->final, blame->repository, &blame->options.newest_commit);\n\tif (error < 0)\n\t\tgoto cleanup;\n\terror = git_object_lookup_bypath((git_object**)&blame->final_blob,\n\t\t\t(git_object*)blame->final, blame->path, GIT_OBJ_BLOB);\n\ncleanup:\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "blame"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_blame__alloc",
          "args": [
            "repo",
            "normOptions",
            "path"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame__alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "113-135",
          "snippet": "git_blame* git_blame__alloc(\n\tgit_repository *repo,\n\tgit_blame_options opts,\n\tconst char *path)\n{\n\tgit_blame *gbr = git__calloc(1, sizeof(git_blame));\n\tif (!gbr)\n\t\treturn NULL;\n\n\tgbr->repository = repo;\n\tgbr->options = opts;\n\n\tif (git_vector_init(&gbr->hunks, 8, hunk_cmp) < 0 ||\n\t\tgit_vector_init(&gbr->paths, 8, paths_cmp) < 0 ||\n\t\t(gbr->path = git__strdup(path)) == NULL ||\n\t\tgit_vector_insert(&gbr->paths, git__strdup(path)) < 0)\n\t{\n\t\tgit_blame_free(gbr);\n\t\treturn NULL;\n\t}\n\n\treturn gbr;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\ngit_blame* git_blame__alloc(\n\tgit_repository *repo,\n\tgit_blame_options opts,\n\tconst char *path)\n{\n\tgit_blame *gbr = git__calloc(1, sizeof(git_blame));\n\tif (!gbr)\n\t\treturn NULL;\n\n\tgbr->repository = repo;\n\tgbr->options = opts;\n\n\tif (git_vector_init(&gbr->hunks, 8, hunk_cmp) < 0 ||\n\t\tgit_vector_init(&gbr->paths, 8, paths_cmp) < 0 ||\n\t\t(gbr->path = git__strdup(path)) == NULL ||\n\t\tgit_vector_insert(&gbr->paths, git__strdup(path)) < 0)\n\t{\n\t\tgit_blame_free(gbr);\n\t\treturn NULL;\n\t}\n\n\treturn gbr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "normalize_options",
          "args": [
            "&normOptions",
            "options",
            "repo"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "normalize_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "181-211",
          "snippet": "static int normalize_options(\n\t\tgit_blame_options *out,\n\t\tconst git_blame_options *in,\n\t\tgit_repository *repo)\n{\n\tgit_blame_options dummy = GIT_BLAME_OPTIONS_INIT;\n\tif (!in) in = &dummy;\n\n\tmemcpy(out, in, sizeof(git_blame_options));\n\n\t/* No newest_commit => HEAD */\n\tif (git_oid_iszero(&out->newest_commit)) {\n\t\tif (git_reference_name_to_id(&out->newest_commit, repo, \"HEAD\") < 0) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\t/* min_line 0 really means 1 */\n\tif (!out->min_line) out->min_line = 1;\n\t/* max_line 0 really means N, but we don't know N yet */\n\n\t/* Fix up option implications */\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_ANY_COMMIT_COPIES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_COMMIT_COPIES;\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_SAME_COMMIT_COPIES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_COMMIT_MOVES;\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_SAME_COMMIT_MOVES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_FILE;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int normalize_options(\n\t\tgit_blame_options *out,\n\t\tconst git_blame_options *in,\n\t\tgit_repository *repo)\n{\n\tgit_blame_options dummy = GIT_BLAME_OPTIONS_INIT;\n\tif (!in) in = &dummy;\n\n\tmemcpy(out, in, sizeof(git_blame_options));\n\n\t/* No newest_commit => HEAD */\n\tif (git_oid_iszero(&out->newest_commit)) {\n\t\tif (git_reference_name_to_id(&out->newest_commit, repo, \"HEAD\") < 0) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\t/* min_line 0 really means 1 */\n\tif (!out->min_line) out->min_line = 1;\n\t/* max_line 0 really means N, but we don't know N yet */\n\n\t/* Fix up option implications */\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_ANY_COMMIT_COPIES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_COMMIT_COPIES;\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_SAME_COMMIT_COPIES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_COMMIT_MOVES;\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_SAME_COMMIT_MOVES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_FILE;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo && path"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nint git_blame_file(\n\t\tgit_blame **out,\n\t\tgit_repository *repo,\n\t\tconst char *path,\n\t\tgit_blame_options *options)\n{\n\tint error = -1;\n\tgit_blame_options normOptions = GIT_BLAME_OPTIONS_INIT;\n\tgit_blame *blame = NULL;\n\n\tassert(out && repo && path);\n\tif ((error = normalize_options(&normOptions, options, repo)) < 0)\n\t\tgoto on_error;\n\n\tblame = git_blame__alloc(repo, normOptions, path);\n\tGITERR_CHECK_ALLOC(blame);\n\n\tif ((error = load_blob(blame)) < 0)\n\t\tgoto on_error;\n\n\tif ((error = blame_internal(blame)) < 0)\n\t\tgoto on_error;\n\n\t*out = blame;\n\treturn 0;\n\non_error:\n\tgit_blame_free(blame);\n\treturn error;\n}"
  },
  {
    "function_name": "blame_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "313-352",
    "snippet": "static int blame_internal(git_blame *blame)\n{\n\tint error;\n\tgit_blame__entry *ent = NULL;\n\tgit_blame__origin *o;\n\n\tif ((error = load_blob(blame)) < 0 ||\n\t    (error = git_blame__get_origin(&o, blame, blame->final, blame->path)) < 0)\n\t\tgoto cleanup;\n\tblame->final_buf = git_blob_rawcontent(blame->final_blob);\n\tblame->final_buf_size = git_blob_rawsize(blame->final_blob);\n\n\tent = git__calloc(1, sizeof(git_blame__entry));\n\tGITERR_CHECK_ALLOC(ent);\n\n\tent->num_lines = index_blob_lines(blame);\n\tent->lno = blame->options.min_line - 1;\n\tent->num_lines = ent->num_lines - blame->options.min_line + 1;\n\tif (blame->options.max_line > 0)\n\t\tent->num_lines = blame->options.max_line - blame->options.min_line + 1;\n\tent->s_lno = ent->lno;\n\tent->suspect = o;\n\n\tblame->ent = ent;\n\n\terror = git_blame__like_git(blame, blame->options.flags);\n\ncleanup:\n\tfor (ent = blame->ent; ent; ) {\n\t\tgit_blame__entry *e = ent->next;\n\t\tgit_blame_hunk *h = hunk_from_entry(ent);\n\n\t\tgit_vector_insert(&blame->hunks, h);\n\n\t\tgit_blame__free_entry(ent);\n\t\tent = e;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_blame__free_entry",
          "args": [
            "ent"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame__free_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame_git.c",
          "lines": "655-660",
          "snippet": "void git_blame__free_entry(git_blame__entry *ent)\n{\n\tif (!ent) return;\n\torigin_decref(ent->suspect);\n\tgit__free(ent);\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"xdiff/xinclude.h\"",
            "#include \"blob.h\"",
            "#include \"commit.h\"",
            "#include \"blame_git.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"xdiff/xinclude.h\"\n#include \"blob.h\"\n#include \"commit.h\"\n#include \"blame_git.h\"\n\nvoid git_blame__free_entry(git_blame__entry *ent)\n{\n\tif (!ent) return;\n\torigin_decref(ent->suspect);\n\tgit__free(ent);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&blame->hunks",
            "h"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hunk_from_entry",
          "args": [
            "ent"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "hunk_from_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "281-295",
          "snippet": "static git_blame_hunk* hunk_from_entry(git_blame__entry *e)\n{\n\tgit_blame_hunk *h = new_hunk(\n\t\t\te->lno+1, e->num_lines, e->s_lno+1, e->suspect->path);\n\n\tif (!h)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&h->final_commit_id, git_commit_id(e->suspect->commit));\n\tgit_oid_cpy(&h->orig_commit_id, git_commit_id(e->suspect->commit));\n\tgit_signature_dup(&h->final_signature, git_commit_author(e->suspect->commit));\n\tgit_signature_dup(&h->orig_signature, git_commit_author(e->suspect->commit));\n\th->boundary = e->is_boundary ? 1 : 0;\n\treturn h;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* hunk_from_entry(git_blame__entry *e)\n{\n\tgit_blame_hunk *h = new_hunk(\n\t\t\te->lno+1, e->num_lines, e->s_lno+1, e->suspect->path);\n\n\tif (!h)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&h->final_commit_id, git_commit_id(e->suspect->commit));\n\tgit_oid_cpy(&h->orig_commit_id, git_commit_id(e->suspect->commit));\n\tgit_signature_dup(&h->final_signature, git_commit_author(e->suspect->commit));\n\tgit_signature_dup(&h->orig_signature, git_commit_author(e->suspect->commit));\n\th->boundary = e->is_boundary ? 1 : 0;\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blame__like_git",
          "args": [
            "blame",
            "blame->options.flags"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame__like_git",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame_git.c",
          "lines": "619-653",
          "snippet": "int git_blame__like_git(git_blame *blame, uint32_t opt)\n{\n\twhile (true) {\n\t\tgit_blame__entry *ent;\n\t\tgit_blame__origin *suspect = NULL;\n\n\t\t/* Find a suspect to break down */\n\t\tfor (ent = blame->ent; !suspect && ent; ent = ent->next)\n\t\t\tif (!ent->guilty)\n\t\t\t\tsuspect = ent->suspect;\n\t\tif (!suspect)\n\t\t\treturn 0; /* all done */\n\n\t\t/* We'll use this suspect later in the loop, so hold on to it for now. */\n\t\torigin_incref(suspect);\n\n\t\tif (pass_blame(blame, suspect, opt) < 0)\n\t\t\treturn -1;\n\n\t\t/* Take responsibility for the remaining entries */\n\t\tfor (ent = blame->ent; ent; ent = ent->next) {\n\t\t\tif (same_suspect(ent->suspect, suspect)) {\n\t\t\t\tent->guilty = true;\n\t\t\t\tent->is_boundary = !git_oid_cmp(\n\t\t\t\t\t\tgit_commit_id(suspect->commit),\n\t\t\t\t\t\t&blame->options.oldest_commit);\n\t\t\t}\n\t\t}\n\t\torigin_decref(suspect);\n\t}\n\n\tcoalesce(blame);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"xdiff/xinclude.h\"",
            "#include \"blob.h\"",
            "#include \"commit.h\"",
            "#include \"blame_git.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"xdiff/xinclude.h\"\n#include \"blob.h\"\n#include \"commit.h\"\n#include \"blame_git.h\"\n\nint git_blame__like_git(git_blame *blame, uint32_t opt)\n{\n\twhile (true) {\n\t\tgit_blame__entry *ent;\n\t\tgit_blame__origin *suspect = NULL;\n\n\t\t/* Find a suspect to break down */\n\t\tfor (ent = blame->ent; !suspect && ent; ent = ent->next)\n\t\t\tif (!ent->guilty)\n\t\t\t\tsuspect = ent->suspect;\n\t\tif (!suspect)\n\t\t\treturn 0; /* all done */\n\n\t\t/* We'll use this suspect later in the loop, so hold on to it for now. */\n\t\torigin_incref(suspect);\n\n\t\tif (pass_blame(blame, suspect, opt) < 0)\n\t\t\treturn -1;\n\n\t\t/* Take responsibility for the remaining entries */\n\t\tfor (ent = blame->ent; ent; ent = ent->next) {\n\t\t\tif (same_suspect(ent->suspect, suspect)) {\n\t\t\t\tent->guilty = true;\n\t\t\t\tent->is_boundary = !git_oid_cmp(\n\t\t\t\t\t\tgit_commit_id(suspect->commit),\n\t\t\t\t\t\t&blame->options.oldest_commit);\n\t\t\t}\n\t\t}\n\t\torigin_decref(suspect);\n\t}\n\n\tcoalesce(blame);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "index_blob_lines",
          "args": [
            "blame"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "index_blob_lines",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "253-279",
          "snippet": "static int index_blob_lines(git_blame *blame)\n{\n    const char *buf = blame->final_buf;\n    git_off_t len = blame->final_buf_size;\n    int num = 0, incomplete = 0, bol = 1;\n    size_t *i;\n\n    if (len && buf[len-1] != '\\n')\n        incomplete++; /* incomplete line at the end */\n    while (len--) {\n        if (bol) {\n            i = git_array_alloc(blame->line_index);\n            GITERR_CHECK_ALLOC(i);\n            *i = buf - blame->final_buf;\n            bol = 0;\n        }\n        if (*buf++ == '\\n') {\n            num++;\n            bol = 1;\n        }\n    }\n    i = git_array_alloc(blame->line_index);\n    GITERR_CHECK_ALLOC(i);\n    *i = buf - blame->final_buf;\n    blame->num_lines = num + incomplete;\n    return blame->num_lines;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int index_blob_lines(git_blame *blame)\n{\n    const char *buf = blame->final_buf;\n    git_off_t len = blame->final_buf_size;\n    int num = 0, incomplete = 0, bol = 1;\n    size_t *i;\n\n    if (len && buf[len-1] != '\\n')\n        incomplete++; /* incomplete line at the end */\n    while (len--) {\n        if (bol) {\n            i = git_array_alloc(blame->line_index);\n            GITERR_CHECK_ALLOC(i);\n            *i = buf - blame->final_buf;\n            bol = 0;\n        }\n        if (*buf++ == '\\n') {\n            num++;\n            bol = 1;\n        }\n    }\n    i = git_array_alloc(blame->line_index);\n    GITERR_CHECK_ALLOC(i);\n    *i = buf - blame->final_buf;\n    blame->num_lines = num + incomplete;\n    return blame->num_lines;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "ent"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_blame__entry)"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_rawsize",
          "args": [
            "blame->final_blob"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_rawsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blob.c",
          "lines": "25-29",
          "snippet": "git_off_t git_blob_rawsize(const git_blob *blob)\n{\n\tassert(blob);\n\treturn (git_off_t)git_odb_object_size(blob->odb_object);\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"filter.h\"",
            "#include \"blob.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"filter.h\"\n#include \"blob.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\ngit_off_t git_blob_rawsize(const git_blob *blob)\n{\n\tassert(blob);\n\treturn (git_off_t)git_odb_object_size(blob->odb_object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_rawcontent",
          "args": [
            "blame->final_blob"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_rawcontent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blob.c",
          "lines": "19-23",
          "snippet": "const void *git_blob_rawcontent(const git_blob *blob)\n{\n\tassert(blob);\n\treturn git_odb_object_data(blob->odb_object);\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"filter.h\"",
            "#include \"blob.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"filter.h\"\n#include \"blob.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nconst void *git_blob_rawcontent(const git_blob *blob)\n{\n\tassert(blob);\n\treturn git_odb_object_data(blob->odb_object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blame__get_origin",
          "args": [
            "&o",
            "blame",
            "blame->final",
            "blame->path"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame__get_origin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame_git.c",
          "lines": "64-78",
          "snippet": "int git_blame__get_origin(\n\t\tgit_blame__origin **out,\n\t\tgit_blame *blame,\n\t\tgit_commit *commit,\n\t\tconst char *path)\n{\n\tgit_blame__entry *e;\n\n\tfor (e = blame->ent; e; e = e->next) {\n\t\tif (e->suspect->commit == commit && !strcmp(e->suspect->path, path)) {\n\t\t\t*out = origin_incref(e->suspect);\n\t\t}\n\t}\n\treturn make_origin(out, commit, path);\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"xdiff/xinclude.h\"",
            "#include \"blob.h\"",
            "#include \"commit.h\"",
            "#include \"blame_git.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"xdiff/xinclude.h\"\n#include \"blob.h\"\n#include \"commit.h\"\n#include \"blame_git.h\"\n\nint git_blame__get_origin(\n\t\tgit_blame__origin **out,\n\t\tgit_blame *blame,\n\t\tgit_commit *commit,\n\t\tconst char *path)\n{\n\tgit_blame__entry *e;\n\n\tfor (e = blame->ent; e; e = e->next) {\n\t\tif (e->suspect->commit == commit && !strcmp(e->suspect->path, path)) {\n\t\t\t*out = origin_incref(e->suspect);\n\t\t}\n\t}\n\treturn make_origin(out, commit, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "load_blob",
          "args": [
            "blame"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "load_blob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "297-311",
          "snippet": "static int load_blob(git_blame *blame)\n{\n\tint error;\n\n\tif (blame->final_blob) return 0;\n\n\terror = git_commit_lookup(&blame->final, blame->repository, &blame->options.newest_commit);\n\tif (error < 0)\n\t\tgoto cleanup;\n\terror = git_object_lookup_bypath((git_object**)&blame->final_blob,\n\t\t\t(git_object*)blame->final, blame->path, GIT_OBJ_BLOB);\n\ncleanup:\n\treturn error;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int load_blob(git_blame *blame)\n{\n\tint error;\n\n\tif (blame->final_blob) return 0;\n\n\terror = git_commit_lookup(&blame->final, blame->repository, &blame->options.newest_commit);\n\tif (error < 0)\n\t\tgoto cleanup;\n\terror = git_object_lookup_bypath((git_object**)&blame->final_blob,\n\t\t\t(git_object*)blame->final, blame->path, GIT_OBJ_BLOB);\n\ncleanup:\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int blame_internal(git_blame *blame)\n{\n\tint error;\n\tgit_blame__entry *ent = NULL;\n\tgit_blame__origin *o;\n\n\tif ((error = load_blob(blame)) < 0 ||\n\t    (error = git_blame__get_origin(&o, blame, blame->final, blame->path)) < 0)\n\t\tgoto cleanup;\n\tblame->final_buf = git_blob_rawcontent(blame->final_blob);\n\tblame->final_buf_size = git_blob_rawsize(blame->final_blob);\n\n\tent = git__calloc(1, sizeof(git_blame__entry));\n\tGITERR_CHECK_ALLOC(ent);\n\n\tent->num_lines = index_blob_lines(blame);\n\tent->lno = blame->options.min_line - 1;\n\tent->num_lines = ent->num_lines - blame->options.min_line + 1;\n\tif (blame->options.max_line > 0)\n\t\tent->num_lines = blame->options.max_line - blame->options.min_line + 1;\n\tent->s_lno = ent->lno;\n\tent->suspect = o;\n\n\tblame->ent = ent;\n\n\terror = git_blame__like_git(blame, blame->options.flags);\n\ncleanup:\n\tfor (ent = blame->ent; ent; ) {\n\t\tgit_blame__entry *e = ent->next;\n\t\tgit_blame_hunk *h = hunk_from_entry(ent);\n\n\t\tgit_vector_insert(&blame->hunks, h);\n\n\t\tgit_blame__free_entry(ent);\n\t\tent = e;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "load_blob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "297-311",
    "snippet": "static int load_blob(git_blame *blame)\n{\n\tint error;\n\n\tif (blame->final_blob) return 0;\n\n\terror = git_commit_lookup(&blame->final, blame->repository, &blame->options.newest_commit);\n\tif (error < 0)\n\t\tgoto cleanup;\n\terror = git_object_lookup_bypath((git_object**)&blame->final_blob,\n\t\t\t(git_object*)blame->final, blame->path, GIT_OBJ_BLOB);\n\ncleanup:\n\treturn error;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_object_lookup_bypath",
          "args": [
            "(git_object**)&blame->final_blob",
            "(git_object*)blame->final",
            "blame->path",
            "GIT_OBJ_BLOB"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_lookup_bypath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "390-423",
          "snippet": "int git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "&blame->final",
            "blame->repository",
            "&blame->options.newest_commit"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int load_blob(git_blame *blame)\n{\n\tint error;\n\n\tif (blame->final_blob) return 0;\n\n\terror = git_commit_lookup(&blame->final, blame->repository, &blame->options.newest_commit);\n\tif (error < 0)\n\t\tgoto cleanup;\n\terror = git_object_lookup_bypath((git_object**)&blame->final_blob,\n\t\t\t(git_object*)blame->final, blame->path, GIT_OBJ_BLOB);\n\ncleanup:\n\treturn error;\n}"
  },
  {
    "function_name": "hunk_from_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "281-295",
    "snippet": "static git_blame_hunk* hunk_from_entry(git_blame__entry *e)\n{\n\tgit_blame_hunk *h = new_hunk(\n\t\t\te->lno+1, e->num_lines, e->s_lno+1, e->suspect->path);\n\n\tif (!h)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&h->final_commit_id, git_commit_id(e->suspect->commit));\n\tgit_oid_cpy(&h->orig_commit_id, git_commit_id(e->suspect->commit));\n\tgit_signature_dup(&h->final_signature, git_commit_author(e->suspect->commit));\n\tgit_signature_dup(&h->orig_signature, git_commit_author(e->suspect->commit));\n\th->boundary = e->is_boundary ? 1 : 0;\n\treturn h;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_signature_dup",
          "args": [
            "&h->orig_signature",
            "git_commit_author(e->suspect->commit)"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "98-120",
          "snippet": "int git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_author",
          "args": [
            "e->suspect->commit"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_commit_author",
          "args": [
            "e->suspect->commit"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&h->orig_commit_id",
            "git_commit_id(e->suspect->commit)"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_id",
          "args": [
            "e->suspect->commit"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "35-38",
          "snippet": "const git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_hunk",
          "args": [
            "e->lno+1",
            "e->num_lines",
            "e->s_lno+1",
            "e->suspect->path"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "new_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "55-70",
          "snippet": "static git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* hunk_from_entry(git_blame__entry *e)\n{\n\tgit_blame_hunk *h = new_hunk(\n\t\t\te->lno+1, e->num_lines, e->s_lno+1, e->suspect->path);\n\n\tif (!h)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&h->final_commit_id, git_commit_id(e->suspect->commit));\n\tgit_oid_cpy(&h->orig_commit_id, git_commit_id(e->suspect->commit));\n\tgit_signature_dup(&h->final_signature, git_commit_author(e->suspect->commit));\n\tgit_signature_dup(&h->orig_signature, git_commit_author(e->suspect->commit));\n\th->boundary = e->is_boundary ? 1 : 0;\n\treturn h;\n}"
  },
  {
    "function_name": "index_blob_lines",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "253-279",
    "snippet": "static int index_blob_lines(git_blame *blame)\n{\n    const char *buf = blame->final_buf;\n    git_off_t len = blame->final_buf_size;\n    int num = 0, incomplete = 0, bol = 1;\n    size_t *i;\n\n    if (len && buf[len-1] != '\\n')\n        incomplete++; /* incomplete line at the end */\n    while (len--) {\n        if (bol) {\n            i = git_array_alloc(blame->line_index);\n            GITERR_CHECK_ALLOC(i);\n            *i = buf - blame->final_buf;\n            bol = 0;\n        }\n        if (*buf++ == '\\n') {\n            num++;\n            bol = 1;\n        }\n    }\n    i = git_array_alloc(blame->line_index);\n    GITERR_CHECK_ALLOC(i);\n    *i = buf - blame->final_buf;\n    blame->num_lines = num + incomplete;\n    return blame->num_lines;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "i"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "blame->line_index"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "i"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "blame->line_index"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int index_blob_lines(git_blame *blame)\n{\n    const char *buf = blame->final_buf;\n    git_off_t len = blame->final_buf_size;\n    int num = 0, incomplete = 0, bol = 1;\n    size_t *i;\n\n    if (len && buf[len-1] != '\\n')\n        incomplete++; /* incomplete line at the end */\n    while (len--) {\n        if (bol) {\n            i = git_array_alloc(blame->line_index);\n            GITERR_CHECK_ALLOC(i);\n            *i = buf - blame->final_buf;\n            bol = 0;\n        }\n        if (*buf++ == '\\n') {\n            num++;\n            bol = 1;\n        }\n    }\n    i = git_array_alloc(blame->line_index);\n    GITERR_CHECK_ALLOC(i);\n    *i = buf - blame->final_buf;\n    blame->num_lines = num + incomplete;\n    return blame->num_lines;\n}"
  },
  {
    "function_name": "split_hunk_in_vector",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "213-246",
    "snippet": "static git_blame_hunk *split_hunk_in_vector(\n\t\tgit_vector *vec,\n\t\tgit_blame_hunk *hunk,\n\t\tsize_t rel_line,\n\t\tbool return_new)\n{\n\tsize_t new_line_count;\n\tgit_blame_hunk *nh;\n\n\t/* Don't split if already at a boundary */\n\tif (rel_line <= 0 ||\n\t    rel_line >= hunk->lines_in_hunk)\n\t{\n\t\treturn hunk;\n\t}\n\n\tnew_line_count = hunk->lines_in_hunk - rel_line;\n\tnh = new_hunk(hunk->final_start_line_number + rel_line, new_line_count,\n\t\t\thunk->orig_start_line_number + rel_line, hunk->orig_path);\n\n\tif (!nh)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&nh->final_commit_id, &hunk->final_commit_id);\n\tgit_oid_cpy(&nh->orig_commit_id, &hunk->orig_commit_id);\n\n\t/* Adjust hunk that was split */\n\thunk->lines_in_hunk -= new_line_count;\n\tgit_vector_insert_sorted(vec, nh, NULL);\n\t{\n\t\tgit_blame_hunk *ret = return_new ? nh : hunk;\n\t\treturn ret;\n\t}\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_insert_sorted",
          "args": [
            "vec",
            "nh",
            "NULL"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert_sorted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "141-173",
          "snippet": "int git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&nh->orig_commit_id",
            "&hunk->orig_commit_id"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_hunk",
          "args": [
            "hunk->final_start_line_number + rel_line",
            "new_line_count",
            "hunk->orig_start_line_number + rel_line",
            "hunk->orig_path"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "new_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "55-70",
          "snippet": "static git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk *split_hunk_in_vector(\n\t\tgit_vector *vec,\n\t\tgit_blame_hunk *hunk,\n\t\tsize_t rel_line,\n\t\tbool return_new)\n{\n\tsize_t new_line_count;\n\tgit_blame_hunk *nh;\n\n\t/* Don't split if already at a boundary */\n\tif (rel_line <= 0 ||\n\t    rel_line >= hunk->lines_in_hunk)\n\t{\n\t\treturn hunk;\n\t}\n\n\tnew_line_count = hunk->lines_in_hunk - rel_line;\n\tnh = new_hunk(hunk->final_start_line_number + rel_line, new_line_count,\n\t\t\thunk->orig_start_line_number + rel_line, hunk->orig_path);\n\n\tif (!nh)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&nh->final_commit_id, &hunk->final_commit_id);\n\tgit_oid_cpy(&nh->orig_commit_id, &hunk->orig_commit_id);\n\n\t/* Adjust hunk that was split */\n\thunk->lines_in_hunk -= new_line_count;\n\tgit_vector_insert_sorted(vec, nh, NULL);\n\t{\n\t\tgit_blame_hunk *ret = return_new ? nh : hunk;\n\t\treturn ret;\n\t}\n}"
  },
  {
    "function_name": "normalize_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "181-211",
    "snippet": "static int normalize_options(\n\t\tgit_blame_options *out,\n\t\tconst git_blame_options *in,\n\t\tgit_repository *repo)\n{\n\tgit_blame_options dummy = GIT_BLAME_OPTIONS_INIT;\n\tif (!in) in = &dummy;\n\n\tmemcpy(out, in, sizeof(git_blame_options));\n\n\t/* No newest_commit => HEAD */\n\tif (git_oid_iszero(&out->newest_commit)) {\n\t\tif (git_reference_name_to_id(&out->newest_commit, repo, \"HEAD\") < 0) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\t/* min_line 0 really means 1 */\n\tif (!out->min_line) out->min_line = 1;\n\t/* max_line 0 really means N, but we don't know N yet */\n\n\t/* Fix up option implications */\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_ANY_COMMIT_COPIES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_COMMIT_COPIES;\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_SAME_COMMIT_COPIES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_COMMIT_MOVES;\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_SAME_COMMIT_MOVES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_FILE;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_name_to_id",
          "args": [
            "&out->newest_commit",
            "repo",
            "\"HEAD\""
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "152-164",
          "snippet": "int git_reference_name_to_id(\n\tgit_oid *out, git_repository *repo, const char *name)\n{\n\tint error;\n\tgit_reference *ref;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, name, -1)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(out, git_reference_target(ref));\n\tgit_reference_free(ref);\n\treturn 0;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_name_to_id(\n\tgit_oid *out, git_repository *repo, const char *name)\n{\n\tint error;\n\tgit_reference *ref;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, name, -1)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(out, git_reference_target(ref));\n\tgit_reference_free(ref);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_iszero",
          "args": [
            "&out->newest_commit"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_iszero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "239-247",
          "snippet": "int git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out",
            "in",
            "sizeof(git_blame_options)"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int normalize_options(\n\t\tgit_blame_options *out,\n\t\tconst git_blame_options *in,\n\t\tgit_repository *repo)\n{\n\tgit_blame_options dummy = GIT_BLAME_OPTIONS_INIT;\n\tif (!in) in = &dummy;\n\n\tmemcpy(out, in, sizeof(git_blame_options));\n\n\t/* No newest_commit => HEAD */\n\tif (git_oid_iszero(&out->newest_commit)) {\n\t\tif (git_reference_name_to_id(&out->newest_commit, repo, \"HEAD\") < 0) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\t/* min_line 0 really means 1 */\n\tif (!out->min_line) out->min_line = 1;\n\t/* max_line 0 really means N, but we don't know N yet */\n\n\t/* Fix up option implications */\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_ANY_COMMIT_COPIES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_COMMIT_COPIES;\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_SAME_COMMIT_COPIES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_COMMIT_MOVES;\n\tif (out->flags & GIT_BLAME_TRACK_COPIES_SAME_COMMIT_MOVES)\n\t\tout->flags |= GIT_BLAME_TRACK_COPIES_SAME_FILE;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_blame_get_hunk_byline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "169-179",
    "snippet": "const git_blame_hunk *git_blame_get_hunk_byline(git_blame *blame, size_t lineno)\n{\n\tsize_t i, new_lineno = lineno;\n\tassert(blame);\n\n\tif (!git_vector_bsearch2(&i, &blame->hunks, hunk_byfinalline_search_cmp, &new_lineno)) {\n\t\treturn git_blame_get_hunk_byindex(blame, (uint32_t)i);\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_blame_get_hunk_byindex",
          "args": [
            "blame",
            "(uint32_t)i"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame_get_hunk_byindex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "163-167",
          "snippet": "const git_blame_hunk *git_blame_get_hunk_byindex(git_blame *blame, uint32_t index)\n{\n\tassert(blame);\n\treturn (git_blame_hunk*)git_vector_get(&blame->hunks, index);\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nconst git_blame_hunk *git_blame_get_hunk_byindex(git_blame *blame, uint32_t index)\n{\n\tassert(blame);\n\treturn (git_blame_hunk*)git_vector_get(&blame->hunks, index);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_bsearch2",
          "args": [
            "&i",
            "&blame->hunks",
            "hunk_byfinalline_search_cmp",
            "&new_lineno"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_bsearch2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "187-202",
          "snippet": "int git_vector_bsearch2(\n\tsize_t *at_pos,\n\tgit_vector *v,\n\tgit_vector_cmp key_lookup,\n\tconst void *key)\n{\n\tassert(v && key && key_lookup);\n\n\t/* need comparison function to sort the vector */\n\tif (!v->_cmp)\n\t\treturn -1;\n\n\tgit_vector_sort(v);\n\n\treturn git__bsearch(v->contents, v->length, key, key_lookup, at_pos);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_bsearch2(\n\tsize_t *at_pos,\n\tgit_vector *v,\n\tgit_vector_cmp key_lookup,\n\tconst void *key)\n{\n\tassert(v && key && key_lookup);\n\n\t/* need comparison function to sort the vector */\n\tif (!v->_cmp)\n\t\treturn -1;\n\n\tgit_vector_sort(v);\n\n\treturn git__bsearch(v->contents, v->length, key, key_lookup, at_pos);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "blame"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nconst git_blame_hunk *git_blame_get_hunk_byline(git_blame *blame, size_t lineno)\n{\n\tsize_t i, new_lineno = lineno;\n\tassert(blame);\n\n\tif (!git_vector_bsearch2(&i, &blame->hunks, hunk_byfinalline_search_cmp, &new_lineno)) {\n\t\treturn git_blame_get_hunk_byindex(blame, (uint32_t)i);\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "git_blame_get_hunk_byindex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "163-167",
    "snippet": "const git_blame_hunk *git_blame_get_hunk_byindex(git_blame *blame, uint32_t index)\n{\n\tassert(blame);\n\treturn (git_blame_hunk*)git_vector_get(&blame->hunks, index);\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&blame->hunks",
            "index"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "blame"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nconst git_blame_hunk *git_blame_get_hunk_byindex(git_blame *blame, uint32_t index)\n{\n\tassert(blame);\n\treturn (git_blame_hunk*)git_vector_get(&blame->hunks, index);\n}"
  },
  {
    "function_name": "git_blame_get_hunk_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "157-161",
    "snippet": "uint32_t git_blame_get_hunk_count(git_blame *blame)\n{\n\tassert(blame);\n\treturn (uint32_t)blame->hunks.length;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "blame"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nuint32_t git_blame_get_hunk_count(git_blame *blame)\n{\n\tassert(blame);\n\treturn (uint32_t)blame->hunks.length;\n}"
  },
  {
    "function_name": "git_blame_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "137-155",
    "snippet": "void git_blame_free(git_blame *blame)\n{\n\tsize_t i;\n\tgit_blame_hunk *hunk;\n\n\tif (!blame) return;\n\n\tgit_vector_foreach(&blame->hunks, i, hunk)\n\t\tfree_hunk(hunk);\n\tgit_vector_free(&blame->hunks);\n\n\tgit_vector_free_deep(&blame->paths);\n\n\tgit_array_clear(blame->line_index);\n\n\tgit__free(blame->path);\n\tgit_blob_free(blame->final_blob);\n\tgit__free(blame);\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "blame"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_free",
          "args": [
            "blame->final_blob"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "116-119",
          "snippet": "void git_blob_free(git_blob *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_blob_free(git_blob *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "blame->line_index"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_free_deep",
          "args": [
            "&blame->paths"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_hunk",
          "args": [
            "hunk"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "free_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "91-97",
          "snippet": "static void free_hunk(git_blame_hunk *hunk)\n{\n\tgit__free((void*)hunk->orig_path);\n\tgit_signature_free(hunk->final_signature);\n\tgit_signature_free(hunk->orig_signature);\n\tgit__free(hunk);\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic void free_hunk(git_blame_hunk *hunk)\n{\n\tgit__free((void*)hunk->orig_path);\n\tgit_signature_free(hunk->final_signature);\n\tgit_signature_free(hunk->orig_signature);\n\tgit__free(hunk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&blame->hunks",
            "i",
            "hunk"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nvoid git_blame_free(git_blame *blame)\n{\n\tsize_t i;\n\tgit_blame_hunk *hunk;\n\n\tif (!blame) return;\n\n\tgit_vector_foreach(&blame->hunks, i, hunk)\n\t\tfree_hunk(hunk);\n\tgit_vector_free(&blame->hunks);\n\n\tgit_vector_free_deep(&blame->paths);\n\n\tgit_array_clear(blame->line_index);\n\n\tgit__free(blame->path);\n\tgit_blob_free(blame->final_blob);\n\tgit__free(blame);\n}"
  },
  {
    "function_name": "git_blame__alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "113-135",
    "snippet": "git_blame* git_blame__alloc(\n\tgit_repository *repo,\n\tgit_blame_options opts,\n\tconst char *path)\n{\n\tgit_blame *gbr = git__calloc(1, sizeof(git_blame));\n\tif (!gbr)\n\t\treturn NULL;\n\n\tgbr->repository = repo;\n\tgbr->options = opts;\n\n\tif (git_vector_init(&gbr->hunks, 8, hunk_cmp) < 0 ||\n\t\tgit_vector_init(&gbr->paths, 8, paths_cmp) < 0 ||\n\t\t(gbr->path = git__strdup(path)) == NULL ||\n\t\tgit_vector_insert(&gbr->paths, git__strdup(path)) < 0)\n\t{\n\t\tgit_blame_free(gbr);\n\t\treturn NULL;\n\t}\n\n\treturn gbr;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_blame_free",
          "args": [
            "gbr"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "git_blame_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "137-155",
          "snippet": "void git_blame_free(git_blame *blame)\n{\n\tsize_t i;\n\tgit_blame_hunk *hunk;\n\n\tif (!blame) return;\n\n\tgit_vector_foreach(&blame->hunks, i, hunk)\n\t\tfree_hunk(hunk);\n\tgit_vector_free(&blame->hunks);\n\n\tgit_vector_free_deep(&blame->paths);\n\n\tgit_array_clear(blame->line_index);\n\n\tgit__free(blame->path);\n\tgit_blob_free(blame->final_blob);\n\tgit__free(blame);\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nvoid git_blame_free(git_blame *blame)\n{\n\tsize_t i;\n\tgit_blame_hunk *hunk;\n\n\tif (!blame) return;\n\n\tgit_vector_foreach(&blame->hunks, i, hunk)\n\t\tfree_hunk(hunk);\n\tgit_vector_free(&blame->hunks);\n\n\tgit_vector_free_deep(&blame->paths);\n\n\tgit_array_clear(blame->line_index);\n\n\tgit__free(blame->path);\n\tgit_blob_free(blame->final_blob);\n\tgit__free(blame);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&gbr->paths",
            "git__strdup(path)"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "path"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "&gbr->paths",
            "8",
            "paths_cmp"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_blame)"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\ngit_blame* git_blame__alloc(\n\tgit_repository *repo,\n\tgit_blame_options opts,\n\tconst char *path)\n{\n\tgit_blame *gbr = git__calloc(1, sizeof(git_blame));\n\tif (!gbr)\n\t\treturn NULL;\n\n\tgbr->repository = repo;\n\tgbr->options = opts;\n\n\tif (git_vector_init(&gbr->hunks, 8, hunk_cmp) < 0 ||\n\t\tgit_vector_init(&gbr->paths, 8, paths_cmp) < 0 ||\n\t\t(gbr->path = git__strdup(path)) == NULL ||\n\t\tgit_vector_insert(&gbr->paths, git__strdup(path)) < 0)\n\t{\n\t\tgit_blame_free(gbr);\n\t\treturn NULL;\n\t}\n\n\treturn gbr;\n}"
  },
  {
    "function_name": "shift_hunks_by",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "101-111",
    "snippet": "static void shift_hunks_by(git_vector *v, size_t start_line, int shift_by)\n{\n\tsize_t i;\n\n\tif (!git_vector_bsearch2(&i, v, hunk_byfinalline_search_cmp, &start_line)) {\n\t\tfor (; i < v->length; i++) {\n\t\t\tgit_blame_hunk *hunk = (git_blame_hunk*)v->contents[i];\n\t\t\thunk->final_start_line_number += shift_by;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_bsearch2",
          "args": [
            "&i",
            "v",
            "hunk_byfinalline_search_cmp",
            "&start_line"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_bsearch2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "187-202",
          "snippet": "int git_vector_bsearch2(\n\tsize_t *at_pos,\n\tgit_vector *v,\n\tgit_vector_cmp key_lookup,\n\tconst void *key)\n{\n\tassert(v && key && key_lookup);\n\n\t/* need comparison function to sort the vector */\n\tif (!v->_cmp)\n\t\treturn -1;\n\n\tgit_vector_sort(v);\n\n\treturn git__bsearch(v->contents, v->length, key, key_lookup, at_pos);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_bsearch2(\n\tsize_t *at_pos,\n\tgit_vector *v,\n\tgit_vector_cmp key_lookup,\n\tconst void *key)\n{\n\tassert(v && key && key_lookup);\n\n\t/* need comparison function to sort the vector */\n\tif (!v->_cmp)\n\t\treturn -1;\n\n\tgit_vector_sort(v);\n\n\treturn git__bsearch(v->contents, v->length, key, key_lookup, at_pos);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic void shift_hunks_by(git_vector *v, size_t start_line, int shift_by)\n{\n\tsize_t i;\n\n\tif (!git_vector_bsearch2(&i, v, hunk_byfinalline_search_cmp, &start_line)) {\n\t\tfor (; i < v->length; i++) {\n\t\t\tgit_blame_hunk *hunk = (git_blame_hunk*)v->contents[i];\n\t\t\thunk->final_start_line_number += shift_by;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "free_hunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "91-97",
    "snippet": "static void free_hunk(git_blame_hunk *hunk)\n{\n\tgit__free((void*)hunk->orig_path);\n\tgit_signature_free(hunk->final_signature);\n\tgit_signature_free(hunk->orig_signature);\n\tgit__free(hunk);\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "hunk"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_signature_free",
          "args": [
            "hunk->orig_signature"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "14-24",
          "snippet": "void git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nvoid git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic void free_hunk(git_blame_hunk *hunk)\n{\n\tgit__free((void*)hunk->orig_path);\n\tgit_signature_free(hunk->final_signature);\n\tgit_signature_free(hunk->orig_signature);\n\tgit__free(hunk);\n}"
  },
  {
    "function_name": "dup_hunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "72-89",
    "snippet": "static git_blame_hunk* dup_hunk(git_blame_hunk *hunk)\n{\n\tgit_blame_hunk *newhunk = new_hunk(\n\t\t\thunk->final_start_line_number,\n\t\t\thunk->lines_in_hunk,\n\t\t\thunk->orig_start_line_number,\n\t\t\thunk->orig_path);\n\n\tif (!newhunk)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&newhunk->orig_commit_id, &hunk->orig_commit_id);\n\tgit_oid_cpy(&newhunk->final_commit_id, &hunk->final_commit_id);\n\tnewhunk->boundary = hunk->boundary;\n\tgit_signature_dup(&newhunk->final_signature, hunk->final_signature);\n\tgit_signature_dup(&newhunk->orig_signature, hunk->orig_signature);\n\treturn newhunk;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_signature_dup",
          "args": [
            "&newhunk->orig_signature",
            "hunk->orig_signature"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "98-120",
          "snippet": "int git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&newhunk->final_commit_id",
            "&hunk->final_commit_id"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_hunk",
          "args": [
            "hunk->final_start_line_number",
            "hunk->lines_in_hunk",
            "hunk->orig_start_line_number",
            "hunk->orig_path"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "new_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
          "lines": "55-70",
          "snippet": "static git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}",
          "includes": [
            "#include \"blame_git.h\"",
            "#include \"repository.h\"",
            "#include \"util.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"blame.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* dup_hunk(git_blame_hunk *hunk)\n{\n\tgit_blame_hunk *newhunk = new_hunk(\n\t\t\thunk->final_start_line_number,\n\t\t\thunk->lines_in_hunk,\n\t\t\thunk->orig_start_line_number,\n\t\t\thunk->orig_path);\n\n\tif (!newhunk)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&newhunk->orig_commit_id, &hunk->orig_commit_id);\n\tgit_oid_cpy(&newhunk->final_commit_id, &hunk->final_commit_id);\n\tnewhunk->boundary = hunk->boundary;\n\tgit_signature_dup(&newhunk->final_signature, hunk->final_signature);\n\tgit_signature_dup(&newhunk->orig_signature, hunk->orig_signature);\n\treturn newhunk;\n}"
  },
  {
    "function_name": "new_hunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "55-70",
    "snippet": "static git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "path"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_blame_hunk)"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic git_blame_hunk* new_hunk(\n\t\tsize_t start,\n\t\tsize_t lines,\n\t\tsize_t orig_start,\n\t\tconst char *path)\n{\n\tgit_blame_hunk *hunk = git__calloc(1, sizeof(git_blame_hunk));\n\tif (!hunk) return NULL;\n\n\thunk->lines_in_hunk = lines;\n\thunk->final_start_line_number = start;\n\thunk->orig_start_line_number = orig_start;\n\thunk->orig_path = path ? git__strdup(path) : NULL;\n\n\treturn hunk;\n}"
  },
  {
    "function_name": "hunk_starts_at_or_after_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "50-53",
    "snippet": "static bool hunk_starts_at_or_after_line(git_blame_hunk *hunk, size_t line)\n{\n\treturn line <= hunk->final_start_line_number;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic bool hunk_starts_at_or_after_line(git_blame_hunk *hunk, size_t line)\n{\n\treturn line <= hunk->final_start_line_number;\n}"
  },
  {
    "function_name": "hunk_ends_at_or_before_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "45-48",
    "snippet": "static bool hunk_ends_at_or_before_line(git_blame_hunk *hunk, size_t line)\n{\n\treturn line >= (hunk->final_start_line_number + hunk->lines_in_hunk - 1);\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic bool hunk_ends_at_or_before_line(git_blame_hunk *hunk, size_t line)\n{\n\treturn line >= (hunk->final_start_line_number + hunk->lines_in_hunk - 1);\n}"
  },
  {
    "function_name": "hunk_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "37-43",
    "snippet": "static int hunk_cmp(const void *_a, const void *_b)\n{\n\tgit_blame_hunk *a = (git_blame_hunk*)_a,\n\t\t\t\t\t\t*b = (git_blame_hunk*)_b;\n\n\treturn a->final_start_line_number - b->final_start_line_number;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int hunk_cmp(const void *_a, const void *_b)\n{\n\tgit_blame_hunk *a = (git_blame_hunk*)_a,\n\t\t\t\t\t\t*b = (git_blame_hunk*)_b;\n\n\treturn a->final_start_line_number - b->final_start_line_number;\n}"
  },
  {
    "function_name": "paths_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "36-36",
    "snippet": "static int paths_cmp(const void *a, const void *b) { return git__strcmp((char*)a, (char*)b); }",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__strcmp",
          "args": [
            "(char*)a",
            "(char*)b"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int paths_cmp(const void *a, const void *b) { return git__strcmp((char*)a, (char*)b); }"
  },
  {
    "function_name": "hunk_byfinalline_search_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame.c",
    "lines": "21-34",
    "snippet": "static int hunk_byfinalline_search_cmp(const void *key, const void *entry)\n{\n\tgit_blame_hunk *hunk = (git_blame_hunk*)entry;\n\n\tsize_t lineno = *(size_t*)key;\n\tsize_t lines_in_hunk = hunk->lines_in_hunk;\n\tsize_t final_start_line_number = hunk->final_start_line_number;\n\n\tif (lineno < final_start_line_number)\n\t\treturn -1;\n\tif (lineno >= final_start_line_number + lines_in_hunk)\n\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"blame_git.h\"",
      "#include \"repository.h\"",
      "#include \"util.h\"",
      "#include \"git2/signature.h\"",
      "#include \"git2/blob.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"blame.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"blame_git.h\"\n#include \"repository.h\"\n#include \"util.h\"\n#include \"git2/signature.h\"\n#include \"git2/blob.h\"\n#include \"git2/diff.h\"\n#include \"git2/tree.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"blame.h\"\n\nstatic int hunk_byfinalline_search_cmp(const void *key, const void *entry)\n{\n\tgit_blame_hunk *hunk = (git_blame_hunk*)entry;\n\n\tsize_t lineno = *(size_t*)key;\n\tsize_t lines_in_hunk = hunk->lines_in_hunk;\n\tsize_t final_start_line_number = hunk->final_start_line_number;\n\n\tif (lineno < final_start_line_number)\n\t\treturn -1;\n\tif (lineno >= final_start_line_number + lines_in_hunk)\n\t\treturn 1;\n\treturn 0;\n}"
  }
]