[
  {
    "function_name": "git_libgit2_opts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/settings.c",
    "lines": "86-220",
    "snippet": "int git_libgit2_opts(int key, ...)\n{\n\tint error = 0;\n\tva_list ap;\n\n\tva_start(ap, key);\n\n\tswitch (key) {\n\tcase GIT_OPT_SET_MWINDOW_SIZE:\n\t\tgit_mwindow__window_size = va_arg(ap, size_t);\n\t\tbreak;\n\n\tcase GIT_OPT_GET_MWINDOW_SIZE:\n\t\t*(va_arg(ap, size_t *)) = git_mwindow__window_size;\n\t\tbreak;\n\n\tcase GIT_OPT_SET_MWINDOW_MAPPED_LIMIT:\n\t\tgit_mwindow__mapped_limit = va_arg(ap, size_t);\n\t\tbreak;\n\n\tcase GIT_OPT_GET_MWINDOW_MAPPED_LIMIT:\n\t\t*(va_arg(ap, size_t *)) = git_mwindow__mapped_limit;\n\t\tbreak;\n\n\tcase GIT_OPT_GET_SEARCH_PATH:\n\t\tif ((error = config_level_to_sysdir(va_arg(ap, int))) >= 0) {\n\t\t\tgit_buf *out = va_arg(ap, git_buf *);\n\t\t\tconst git_buf *tmp;\n\n\t\t\tgit_buf_sanitize(out);\n\t\t\tif ((error = git_sysdir_get(&tmp, error)) < 0)\n\t\t\t\tbreak;\n\n\t\t\terror = git_buf_sets(out, tmp->ptr);\n\t\t}\n\t\tbreak;\n\n\tcase GIT_OPT_SET_SEARCH_PATH:\n\t\tif ((error = config_level_to_sysdir(va_arg(ap, int))) >= 0)\n\t\t\terror = git_sysdir_set(error, va_arg(ap, const char *));\n\t\tbreak;\n\n\tcase GIT_OPT_SET_CACHE_OBJECT_LIMIT:\n\t\t{\n\t\t\tgit_otype type = (git_otype)va_arg(ap, int);\n\t\t\tsize_t size = va_arg(ap, size_t);\n\t\t\terror = git_cache_set_max_object_size(type, size);\n\t\t\tbreak;\n\t\t}\n\n\tcase GIT_OPT_SET_CACHE_MAX_SIZE:\n\t\tgit_cache__max_storage = va_arg(ap, ssize_t);\n\t\tbreak;\n\n\tcase GIT_OPT_ENABLE_CACHING:\n\t\tgit_cache__enabled = (va_arg(ap, int) != 0);\n\t\tbreak;\n\n\tcase GIT_OPT_GET_CACHED_MEMORY:\n\t\t*(va_arg(ap, ssize_t *)) = git_cache__current_storage.val;\n\t\t*(va_arg(ap, ssize_t *)) = git_cache__max_storage;\n\t\tbreak;\n\n\tcase GIT_OPT_GET_TEMPLATE_PATH:\n\t\t{\n\t\t\tgit_buf *out = va_arg(ap, git_buf *);\n\t\t\tconst git_buf *tmp;\n\n\t\t\tgit_buf_sanitize(out);\n\t\t\tif ((error = git_sysdir_get(&tmp, GIT_SYSDIR_TEMPLATE)) < 0)\n\t\t\t\tbreak;\n\n\t\t\terror = git_buf_sets(out, tmp->ptr);\n\t\t}\n\t\tbreak;\n\n\tcase GIT_OPT_SET_TEMPLATE_PATH:\n\t\terror = git_sysdir_set(GIT_SYSDIR_TEMPLATE, va_arg(ap, const char *));\n\t\tbreak;\n\n\tcase GIT_OPT_SET_SSL_CERT_LOCATIONS:\n#ifdef GIT_OPENSSL\n\t\t{\n\t\t\tconst char *file = va_arg(ap, const char *);\n\t\t\tconst char *path = va_arg(ap, const char *);\n\t\t\tif (!SSL_CTX_load_verify_locations(git__ssl_ctx, file, path)) {\n\t\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(ERR_get_error(), NULL));\n\t\t\t\terror = -1;\n\t\t\t}\n\t\t}\n#else\n\t\tgiterr_set(GITERR_NET, \"cannot set certificate locations: OpenSSL is not enabled\");\n\t\terror = -1;\n#endif\n\t\tbreak;\n\tcase GIT_OPT_SET_USER_AGENT:\n\t\tgit__free(git__user_agent);\n\t\tgit__user_agent = git__strdup(va_arg(ap, const char *));\n\t\tif (!git__user_agent) {\n\t\t\tgiterr_set_oom();\n\t\t\terror = -1;\n\t\t}\n\n\t\tbreak;\n\n\tcase GIT_OPT_ENABLE_STRICT_OBJECT_CREATION:\n\t\tgit_object__strict_input_validation = (va_arg(ap, int) != 0);\n\t\tbreak;\n\n\tcase GIT_OPT_SET_SSL_CIPHERS:\n#ifdef GIT_OPENSSL\n\t\t{\n\t\t\tgit__free(git__ssl_ciphers);\n\t\t\tgit__ssl_ciphers = git__strdup(va_arg(ap, const char *));\n\t\t\tif (!git__ssl_ciphers) {\n\t\t\t\tgiterr_set_oom();\n\t\t\t\terror = -1;\n\t\t\t}\n\t\t}\n#else\n\t\tgiterr_set(GITERR_NET, \"cannot set custom ciphers: OpenSSL is not enabled\");\n\t\terror = -1;\n#endif\n\t\tbreak;\n\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"invalid option key\");\n\t\terror = -1;\n\t}\n\n\tva_end(ap);\n\n\treturn error;\n}",
    "includes": [
      "#include \"object.h\"",
      "#include \"global.h\"",
      "#include \"cache.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\"",
      "#include <git2.h>",
      "# include <openssl/err.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern size_t git_mwindow__window_size;",
      "extern size_t git_mwindow__mapped_limit;",
      "extern char *git__user_agent;",
      "extern char *git__ssl_ciphers;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"invalid option key\""
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set_oom",
          "args": [],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "45-48",
          "snippet": "void giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};\n\nvoid giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "va_arg(ap, const char *)"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "constchar *"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "git__ssl_ciphers"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "int"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "constchar *"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"SSL error: %s\"",
            "ERR_error_string(ERR_get_error(), NULL)"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_error_string",
          "args": [
            "ERR_get_error()",
            "NULL"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_get_error",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_CTX_load_verify_locations",
          "args": [
            "git__ssl_ctx",
            "file",
            "path"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "constchar *"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "constchar *"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_sysdir_set",
          "args": [
            "GIT_SYSDIR_TEMPLATE",
            "va_arg(ap, const char *)"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "163-205",
          "snippet": "int git_sysdir_set(git_sysdir_t which, const char *search_path)\n{\n\tconst char *expand_path = NULL;\n\tgit_buf merge = GIT_BUF_INIT;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\tif (search_path != NULL)\n\t\texpand_path = strstr(search_path, PATH_MAGIC);\n\n\t/* reset the default if this path has been cleared */\n\tif (!search_path || expand_path)\n\t\tgit_sysdir__dirs[which].guess(&git_sysdir__dirs[which].buf);\n\n\t/* if $PATH is not referenced, then just set the path */\n\tif (!expand_path) {\n\t\tif (search_path)\n\t\t\tgit_buf_sets(&git_sysdir__dirs[which].buf, search_path);\n\n\t\tgoto done;\n\t}\n\n\t/* otherwise set to join(before $PATH, old value, after $PATH) */\n\tif (expand_path > search_path)\n\t\tgit_buf_set(&merge, search_path, expand_path - search_path);\n\n\tif (git_buf_len(&git_sysdir__dirs[which].buf))\n\t\tgit_buf_join(&merge, GIT_PATH_LIST_SEPARATOR,\n\t\t\tmerge.ptr, git_sysdir__dirs[which].buf.ptr);\n\n\texpand_path += strlen(PATH_MAGIC);\n\tif (*expand_path)\n\t\tgit_buf_join(&merge, GIT_PATH_LIST_SEPARATOR, merge.ptr, expand_path);\n\n\tgit_buf_swap(&git_sysdir__dirs[which].buf, &merge);\n\tgit_buf_free(&merge);\n\ndone:\n\tif (git_buf_oom(&git_sysdir__dirs[which].buf))\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define PATH_MAGIC \"$PATH\""
          ],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\n#define PATH_MAGIC \"$PATH\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_set(git_sysdir_t which, const char *search_path)\n{\n\tconst char *expand_path = NULL;\n\tgit_buf merge = GIT_BUF_INIT;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\tif (search_path != NULL)\n\t\texpand_path = strstr(search_path, PATH_MAGIC);\n\n\t/* reset the default if this path has been cleared */\n\tif (!search_path || expand_path)\n\t\tgit_sysdir__dirs[which].guess(&git_sysdir__dirs[which].buf);\n\n\t/* if $PATH is not referenced, then just set the path */\n\tif (!expand_path) {\n\t\tif (search_path)\n\t\t\tgit_buf_sets(&git_sysdir__dirs[which].buf, search_path);\n\n\t\tgoto done;\n\t}\n\n\t/* otherwise set to join(before $PATH, old value, after $PATH) */\n\tif (expand_path > search_path)\n\t\tgit_buf_set(&merge, search_path, expand_path - search_path);\n\n\tif (git_buf_len(&git_sysdir__dirs[which].buf))\n\t\tgit_buf_join(&merge, GIT_PATH_LIST_SEPARATOR,\n\t\t\tmerge.ptr, git_sysdir__dirs[which].buf.ptr);\n\n\texpand_path += strlen(PATH_MAGIC);\n\tif (*expand_path)\n\t\tgit_buf_join(&merge, GIT_PATH_LIST_SEPARATOR, merge.ptr, expand_path);\n\n\tgit_buf_swap(&git_sysdir__dirs[which].buf, &merge);\n\tgit_buf_free(&merge);\n\ndone:\n\tif (git_buf_oom(&git_sysdir__dirs[which].buf))\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "constchar *"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_sets",
          "args": [
            "out",
            "tmp->ptr"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "181-184",
          "snippet": "int git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_sysdir_get",
          "args": [
            "&tmp",
            "GIT_SYSDIR_TEMPLATE"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "130-140",
          "snippet": "int git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "out"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "git_buf*"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "int"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "ssize_t"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_cache_set_max_object_size",
          "args": [
            "type",
            "size"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_set_max_object_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "35-44",
          "snippet": "int git_cache_set_max_object_size(git_otype type, size_t size)\n{\n\tif (type < 0 || (size_t)type >= ARRAY_SIZE(git_cache__max_object_size)) {\n\t\tgiterr_set(GITERR_INVALID, \"type out of range\");\n\t\treturn -1;\n\t}\n\n\tgit_cache__max_object_size[type] = size;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};\n\nint git_cache_set_max_object_size(git_otype type, size_t size)\n{\n\tif (type < 0 || (size_t)type >= ARRAY_SIZE(git_cache__max_object_size)) {\n\t\tgiterr_set(GITERR_INVALID, \"type out of range\");\n\t\treturn -1;\n\t}\n\n\tgit_cache__max_object_size[type] = size;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "size_t"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "int"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "constchar *"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_level_to_sysdir",
          "args": [
            "va_arg(ap, int)"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "config_level_to_sysdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/settings.c",
          "lines": "48-71",
          "snippet": "static int config_level_to_sysdir(int config_level)\n{\n\tint val = -1;\n\n\tswitch (config_level) {\n\tcase GIT_CONFIG_LEVEL_SYSTEM:\n\t\tval = GIT_SYSDIR_SYSTEM;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_XDG:\n\t\tval = GIT_SYSDIR_XDG;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_GLOBAL:\n\t\tval = GIT_SYSDIR_GLOBAL;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_PROGRAMDATA:\n\t\tval = GIT_SYSDIR_PROGRAMDATA;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(\n\t\t\tGITERR_INVALID, \"Invalid config path selector %d\", config_level);\n\t}\n\n\treturn val;\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"global.h\"",
            "#include \"cache.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\"",
            "#include <git2.h>",
            "# include <openssl/err.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"global.h\"\n#include \"cache.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n#include <git2.h>\n# include <openssl/err.h>\n\nstatic int config_level_to_sysdir(int config_level)\n{\n\tint val = -1;\n\n\tswitch (config_level) {\n\tcase GIT_CONFIG_LEVEL_SYSTEM:\n\t\tval = GIT_SYSDIR_SYSTEM;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_XDG:\n\t\tval = GIT_SYSDIR_XDG;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_GLOBAL:\n\t\tval = GIT_SYSDIR_GLOBAL;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_PROGRAMDATA:\n\t\tval = GIT_SYSDIR_PROGRAMDATA;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(\n\t\t\tGITERR_INVALID, \"Invalid config path selector %d\", config_level);\n\t}\n\n\treturn val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "int"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "git_buf*"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "int"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "size_t"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "size_t"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "key"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"object.h\"\n#include \"global.h\"\n#include \"cache.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n#include <git2.h>\n# include <openssl/err.h>\n\nextern size_t git_mwindow__window_size;\nextern size_t git_mwindow__mapped_limit;\nextern char *git__user_agent;\nextern char *git__ssl_ciphers;\n\nint git_libgit2_opts(int key, ...)\n{\n\tint error = 0;\n\tva_list ap;\n\n\tva_start(ap, key);\n\n\tswitch (key) {\n\tcase GIT_OPT_SET_MWINDOW_SIZE:\n\t\tgit_mwindow__window_size = va_arg(ap, size_t);\n\t\tbreak;\n\n\tcase GIT_OPT_GET_MWINDOW_SIZE:\n\t\t*(va_arg(ap, size_t *)) = git_mwindow__window_size;\n\t\tbreak;\n\n\tcase GIT_OPT_SET_MWINDOW_MAPPED_LIMIT:\n\t\tgit_mwindow__mapped_limit = va_arg(ap, size_t);\n\t\tbreak;\n\n\tcase GIT_OPT_GET_MWINDOW_MAPPED_LIMIT:\n\t\t*(va_arg(ap, size_t *)) = git_mwindow__mapped_limit;\n\t\tbreak;\n\n\tcase GIT_OPT_GET_SEARCH_PATH:\n\t\tif ((error = config_level_to_sysdir(va_arg(ap, int))) >= 0) {\n\t\t\tgit_buf *out = va_arg(ap, git_buf *);\n\t\t\tconst git_buf *tmp;\n\n\t\t\tgit_buf_sanitize(out);\n\t\t\tif ((error = git_sysdir_get(&tmp, error)) < 0)\n\t\t\t\tbreak;\n\n\t\t\terror = git_buf_sets(out, tmp->ptr);\n\t\t}\n\t\tbreak;\n\n\tcase GIT_OPT_SET_SEARCH_PATH:\n\t\tif ((error = config_level_to_sysdir(va_arg(ap, int))) >= 0)\n\t\t\terror = git_sysdir_set(error, va_arg(ap, const char *));\n\t\tbreak;\n\n\tcase GIT_OPT_SET_CACHE_OBJECT_LIMIT:\n\t\t{\n\t\t\tgit_otype type = (git_otype)va_arg(ap, int);\n\t\t\tsize_t size = va_arg(ap, size_t);\n\t\t\terror = git_cache_set_max_object_size(type, size);\n\t\t\tbreak;\n\t\t}\n\n\tcase GIT_OPT_SET_CACHE_MAX_SIZE:\n\t\tgit_cache__max_storage = va_arg(ap, ssize_t);\n\t\tbreak;\n\n\tcase GIT_OPT_ENABLE_CACHING:\n\t\tgit_cache__enabled = (va_arg(ap, int) != 0);\n\t\tbreak;\n\n\tcase GIT_OPT_GET_CACHED_MEMORY:\n\t\t*(va_arg(ap, ssize_t *)) = git_cache__current_storage.val;\n\t\t*(va_arg(ap, ssize_t *)) = git_cache__max_storage;\n\t\tbreak;\n\n\tcase GIT_OPT_GET_TEMPLATE_PATH:\n\t\t{\n\t\t\tgit_buf *out = va_arg(ap, git_buf *);\n\t\t\tconst git_buf *tmp;\n\n\t\t\tgit_buf_sanitize(out);\n\t\t\tif ((error = git_sysdir_get(&tmp, GIT_SYSDIR_TEMPLATE)) < 0)\n\t\t\t\tbreak;\n\n\t\t\terror = git_buf_sets(out, tmp->ptr);\n\t\t}\n\t\tbreak;\n\n\tcase GIT_OPT_SET_TEMPLATE_PATH:\n\t\terror = git_sysdir_set(GIT_SYSDIR_TEMPLATE, va_arg(ap, const char *));\n\t\tbreak;\n\n\tcase GIT_OPT_SET_SSL_CERT_LOCATIONS:\n#ifdef GIT_OPENSSL\n\t\t{\n\t\t\tconst char *file = va_arg(ap, const char *);\n\t\t\tconst char *path = va_arg(ap, const char *);\n\t\t\tif (!SSL_CTX_load_verify_locations(git__ssl_ctx, file, path)) {\n\t\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(ERR_get_error(), NULL));\n\t\t\t\terror = -1;\n\t\t\t}\n\t\t}\n#else\n\t\tgiterr_set(GITERR_NET, \"cannot set certificate locations: OpenSSL is not enabled\");\n\t\terror = -1;\n#endif\n\t\tbreak;\n\tcase GIT_OPT_SET_USER_AGENT:\n\t\tgit__free(git__user_agent);\n\t\tgit__user_agent = git__strdup(va_arg(ap, const char *));\n\t\tif (!git__user_agent) {\n\t\t\tgiterr_set_oom();\n\t\t\terror = -1;\n\t\t}\n\n\t\tbreak;\n\n\tcase GIT_OPT_ENABLE_STRICT_OBJECT_CREATION:\n\t\tgit_object__strict_input_validation = (va_arg(ap, int) != 0);\n\t\tbreak;\n\n\tcase GIT_OPT_SET_SSL_CIPHERS:\n#ifdef GIT_OPENSSL\n\t\t{\n\t\t\tgit__free(git__ssl_ciphers);\n\t\t\tgit__ssl_ciphers = git__strdup(va_arg(ap, const char *));\n\t\t\tif (!git__ssl_ciphers) {\n\t\t\t\tgiterr_set_oom();\n\t\t\t\terror = -1;\n\t\t\t}\n\t\t}\n#else\n\t\tgiterr_set(GITERR_NET, \"cannot set custom ciphers: OpenSSL is not enabled\");\n\t\terror = -1;\n#endif\n\t\tbreak;\n\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"invalid option key\");\n\t\terror = -1;\n\t}\n\n\tva_end(ap);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_libgit2__ssl_ciphers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/settings.c",
    "lines": "81-84",
    "snippet": "const char *git_libgit2__ssl_ciphers()\n{\n\treturn git__ssl_ciphers;\n}",
    "includes": [
      "#include \"object.h\"",
      "#include \"global.h\"",
      "#include \"cache.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\"",
      "#include <git2.h>",
      "# include <openssl/err.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern char *git__ssl_ciphers;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"object.h\"\n#include \"global.h\"\n#include \"cache.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n#include <git2.h>\n# include <openssl/err.h>\n\nextern char *git__ssl_ciphers;\n\nconst char *git_libgit2__ssl_ciphers()\n{\n\treturn git__ssl_ciphers;\n}"
  },
  {
    "function_name": "git_libgit2__user_agent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/settings.c",
    "lines": "76-79",
    "snippet": "const char *git_libgit2__user_agent()\n{\n\treturn git__user_agent;\n}",
    "includes": [
      "#include \"object.h\"",
      "#include \"global.h\"",
      "#include \"cache.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\"",
      "#include <git2.h>",
      "# include <openssl/err.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern char *git__user_agent;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"object.h\"\n#include \"global.h\"\n#include \"cache.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n#include <git2.h>\n# include <openssl/err.h>\n\nextern char *git__user_agent;\n\nconst char *git_libgit2__user_agent()\n{\n\treturn git__user_agent;\n}"
  },
  {
    "function_name": "config_level_to_sysdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/settings.c",
    "lines": "48-71",
    "snippet": "static int config_level_to_sysdir(int config_level)\n{\n\tint val = -1;\n\n\tswitch (config_level) {\n\tcase GIT_CONFIG_LEVEL_SYSTEM:\n\t\tval = GIT_SYSDIR_SYSTEM;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_XDG:\n\t\tval = GIT_SYSDIR_XDG;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_GLOBAL:\n\t\tval = GIT_SYSDIR_GLOBAL;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_PROGRAMDATA:\n\t\tval = GIT_SYSDIR_PROGRAMDATA;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(\n\t\t\tGITERR_INVALID, \"Invalid config path selector %d\", config_level);\n\t}\n\n\treturn val;\n}",
    "includes": [
      "#include \"object.h\"",
      "#include \"global.h\"",
      "#include \"cache.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\"",
      "#include <git2.h>",
      "# include <openssl/err.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Invalid config path selector %d\"",
            "config_level"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"object.h\"\n#include \"global.h\"\n#include \"cache.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n#include <git2.h>\n# include <openssl/err.h>\n\nstatic int config_level_to_sysdir(int config_level)\n{\n\tint val = -1;\n\n\tswitch (config_level) {\n\tcase GIT_CONFIG_LEVEL_SYSTEM:\n\t\tval = GIT_SYSDIR_SYSTEM;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_XDG:\n\t\tval = GIT_SYSDIR_XDG;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_GLOBAL:\n\t\tval = GIT_SYSDIR_GLOBAL;\n\t\tbreak;\n\tcase GIT_CONFIG_LEVEL_PROGRAMDATA:\n\t\tval = GIT_SYSDIR_PROGRAMDATA;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(\n\t\t\tGITERR_INVALID, \"Invalid config path selector %d\", config_level);\n\t}\n\n\treturn val;\n}"
  },
  {
    "function_name": "git_libgit2_features",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/settings.c",
    "lines": "26-42",
    "snippet": "int git_libgit2_features()\n{\n\treturn 0\n#ifdef GIT_THREADS\n\t\t| GIT_FEATURE_THREADS\n#endif\n#if defined(GIT_OPENSSL) || defined(GIT_WINHTTP) || defined(GIT_SECURE_TRANSPORT)\n\t\t| GIT_FEATURE_HTTPS\n#endif\n#if defined(GIT_SSH)\n\t\t| GIT_FEATURE_SSH\n#endif\n#if defined(GIT_USE_NSEC)\n\t\t| GIT_FEATURE_NSEC\n#endif\n\t;\n}",
    "includes": [
      "#include \"object.h\"",
      "#include \"global.h\"",
      "#include \"cache.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\"",
      "#include <git2.h>",
      "# include <openssl/err.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"object.h\"\n#include \"global.h\"\n#include \"cache.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n#include <git2.h>\n# include <openssl/err.h>\n\nint git_libgit2_features()\n{\n\treturn 0\n#ifdef GIT_THREADS\n\t\t| GIT_FEATURE_THREADS\n#endif\n#if defined(GIT_OPENSSL) || defined(GIT_WINHTTP) || defined(GIT_SECURE_TRANSPORT)\n\t\t| GIT_FEATURE_HTTPS\n#endif\n#if defined(GIT_SSH)\n\t\t| GIT_FEATURE_SSH\n#endif\n#if defined(GIT_USE_NSEC)\n\t\t| GIT_FEATURE_NSEC\n#endif\n\t;\n}"
  },
  {
    "function_name": "git_libgit2_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/settings.c",
    "lines": "19-24",
    "snippet": "void git_libgit2_version(int *major, int *minor, int *rev)\n{\n\t*major = LIBGIT2_VER_MAJOR;\n\t*minor = LIBGIT2_VER_MINOR;\n\t*rev = LIBGIT2_VER_REVISION;\n}",
    "includes": [
      "#include \"object.h\"",
      "#include \"global.h\"",
      "#include \"cache.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\"",
      "#include <git2.h>",
      "# include <openssl/err.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"object.h\"\n#include \"global.h\"\n#include \"cache.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n#include <git2.h>\n# include <openssl/err.h>\n\nvoid git_libgit2_version(int *major, int *minor, int *rev)\n{\n\t*major = LIBGIT2_VER_MAJOR;\n\t*minor = LIBGIT2_VER_MINOR;\n\t*rev = LIBGIT2_VER_REVISION;\n}"
  }
]