[
  {
    "function_name": "git_note_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "677-694",
    "snippet": "int git_note_next(\n\tgit_oid* note_id,\n\tgit_oid* annotated_id,\n\tgit_note_iterator *it)\n{\n\tint error;\n\tconst git_index_entry *item;\n\n\tif ((error = git_iterator_current(&item, it)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(note_id, &item->id);\n\n\tif (!(error = process_entry_path(item->path, annotated_id)))\n\t\tgit_iterator_advance(NULL, it);\n\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_iterator_advance",
          "args": [
            "NULL",
            "it"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_advance_into_or_over",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
          "lines": "192-201",
          "snippet": "GIT_INLINE(int) git_iterator_advance_into_or_over(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\tint error = iter->cb->advance_into(entry, iter);\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = iter->cb->advance(entry, iter);\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"buffer.h\"",
            "#include \"vector.h\"",
            "#include \"git2/index.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_advance_into_or_over(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\tint error = iter->cb->advance_into(entry, iter);\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = iter->cb->advance(entry, iter);\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "process_entry_path",
          "args": [
            "item->path",
            "annotated_id"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "process_entry_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "569-613",
          "snippet": "static int process_entry_path(\n\tconst char* entry_path,\n\tgit_oid *annotated_object_id)\n{\n\tint error = 0;\n\tsize_t i = 0, j = 0, len;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tif ((error = git_buf_puts(&buf, entry_path)) < 0)\n\t\tgoto cleanup;\n\n\tlen = git_buf_len(&buf);\n\n\twhile (i < len) {\n\t\tif (buf.ptr[i] == '/') {\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (git__fromhex(buf.ptr[i]) < 0) {\n\t\t\t/* This is not a note entry */\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\tif (i != j)\n\t\t\tbuf.ptr[j] = buf.ptr[i];\n\n\t\ti++;\n\t\tj++;\n\t}\n\n\tbuf.ptr[j] = '\\0';\n\tbuf.size = j;\n\n\tif (j != GIT_OID_HEXSZ) {\n\t\t/* This is not a note entry */\n\t\tgoto cleanup;\n\t}\n\n\terror = git_oid_fromstr(annotated_object_id, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int process_entry_path(\n\tconst char* entry_path,\n\tgit_oid *annotated_object_id)\n{\n\tint error = 0;\n\tsize_t i = 0, j = 0, len;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tif ((error = git_buf_puts(&buf, entry_path)) < 0)\n\t\tgoto cleanup;\n\n\tlen = git_buf_len(&buf);\n\n\twhile (i < len) {\n\t\tif (buf.ptr[i] == '/') {\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (git__fromhex(buf.ptr[i]) < 0) {\n\t\t\t/* This is not a note entry */\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\tif (i != j)\n\t\t\tbuf.ptr[j] = buf.ptr[i];\n\n\t\ti++;\n\t\tj++;\n\t}\n\n\tbuf.ptr[j] = '\\0';\n\tbuf.size = j;\n\n\tif (j != GIT_OID_HEXSZ) {\n\t\t/* This is not a note entry */\n\t\tgoto cleanup;\n\t}\n\n\terror = git_oid_fromstr(annotated_object_id, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "note_id",
            "&item->id"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_current",
          "args": [
            "&item",
            "it"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_current_workdir_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "2014-2024",
          "snippet": "int git_iterator_current_workdir_path(git_buf **path, git_iterator *iter)\n{\n\tworkdir_iterator *wi = (workdir_iterator *)iter;\n\n\tif (iter->type != GIT_ITERATOR_TYPE_WORKDIR || !wi->fi.entry.path)\n\t\t*path = NULL;\n\telse\n\t\t*path = &wi->fi.path;\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int fs_iterator__update_entry(fs_iterator *fi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nstatic int fs_iterator__update_entry(fs_iterator *fi);\n\nint git_iterator_current_workdir_path(git_buf **path, git_iterator *iter)\n{\n\tworkdir_iterator *wi = (workdir_iterator *)iter;\n\n\tif (iter->type != GIT_ITERATOR_TYPE_WORKDIR || !wi->fi.entry.path)\n\t\t*path = NULL;\n\telse\n\t\t*path = &wi->fi.path;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_next(\n\tgit_oid* note_id,\n\tgit_oid* annotated_id,\n\tgit_note_iterator *it)\n{\n\tint error;\n\tconst git_index_entry *item;\n\n\tif ((error = git_iterator_current(&item, it)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(note_id, &item->id);\n\n\tif (!(error = process_entry_path(item->path, annotated_id)))\n\t\tgit_iterator_advance(NULL, it);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_note_iterator_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "652-675",
    "snippet": "int git_note_iterator_new(\n\tgit_note_iterator **it,\n\tgit_repository *repo,\n\tconst char *notes_ref_in)\n{\n\tint error;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\tchar *notes_ref;\n\n\terror = retrieve_note_tree_and_commit(&tree, &commit, &notes_ref, repo, notes_ref_in);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_iterator_for_tree(it, tree, NULL)) < 0)\n\t\tgit_iterator_free(*it);\n\ncleanup:\n\tgit__free(notes_ref);\n\tgit_tree_free(tree);\n\tgit_commit_free(commit);\n\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "commit"
          ],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "tree"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "notes_ref"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_free",
          "args": [
            "*it"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "1871-1885",
          "snippet": "void git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nvoid git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_for_tree",
          "args": [
            "it",
            "tree",
            "NULL"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_for_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "809-843",
          "snippet": "int git_iterator_for_tree(\n\tgit_iterator **iter,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\tint error;\n\ttree_iterator *ti;\n\n\tif (tree == NULL)\n\t\treturn git_iterator_for_nothing(iter, options);\n\n\tif ((error = git_object_dup((git_object **)&tree, (git_object *)tree)) < 0)\n\t\treturn error;\n\n\tti = git__calloc(1, sizeof(tree_iterator));\n\tGITERR_CHECK_ALLOC(ti);\n\n\tITERATOR_BASE_INIT(ti, tree, TREE, git_tree_owner(tree));\n\n\tif ((error = iterator__update_ignore_case((git_iterator *)ti, options ? options->flags : 0)) < 0)\n\t\tgoto fail;\n\n\tgit_pool_init(&ti->pool, sizeof(tree_iterator_entry));\n\n\tif ((error = tree_iterator__create_root_frame(ti, tree)) < 0 ||\n\t\t(error = tree_iterator__push_frame(ti)) < 0) /* expand root now */\n\t\tgoto fail;\n\n\t*iter = (git_iterator *)ti;\n\treturn 0;\n\nfail:\n\tgit_iterator_free((git_iterator *)ti);\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nint git_iterator_for_tree(\n\tgit_iterator **iter,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\tint error;\n\ttree_iterator *ti;\n\n\tif (tree == NULL)\n\t\treturn git_iterator_for_nothing(iter, options);\n\n\tif ((error = git_object_dup((git_object **)&tree, (git_object *)tree)) < 0)\n\t\treturn error;\n\n\tti = git__calloc(1, sizeof(tree_iterator));\n\tGITERR_CHECK_ALLOC(ti);\n\n\tITERATOR_BASE_INIT(ti, tree, TREE, git_tree_owner(tree));\n\n\tif ((error = iterator__update_ignore_case((git_iterator *)ti, options ? options->flags : 0)) < 0)\n\t\tgoto fail;\n\n\tgit_pool_init(&ti->pool, sizeof(tree_iterator_entry));\n\n\tif ((error = tree_iterator__create_root_frame(ti, tree)) < 0 ||\n\t\t(error = tree_iterator__push_frame(ti)) < 0) /* expand root now */\n\t\tgoto fail;\n\n\t*iter = (git_iterator *)ti;\n\treturn 0;\n\nfail:\n\tgit_iterator_free((git_iterator *)ti);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "retrieve_note_tree_and_commit",
          "args": [
            "&tree",
            "&commit",
            "&notes_ref",
            "repo",
            "notes_ref_in"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "retrieve_note_tree_and_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "413-436",
          "snippet": "static int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_iterator_new(\n\tgit_note_iterator **it,\n\tgit_repository *repo,\n\tconst char *notes_ref_in)\n{\n\tint error;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\tchar *notes_ref;\n\n\terror = retrieve_note_tree_and_commit(&tree, &commit, &notes_ref, repo, notes_ref_in);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_iterator_for_tree(it, tree, NULL)) < 0)\n\t\tgit_iterator_free(*it);\n\ncleanup:\n\tgit__free(notes_ref);\n\tgit_tree_free(tree);\n\tgit_commit_free(commit);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_note_iterator_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "643-649",
    "snippet": "void git_note_iterator_free(git_note_iterator *it)\n{\n\tif (it == NULL)\n\t\treturn;\n\n\tgit_iterator_free(it);\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_iterator_free",
          "args": [
            "it"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "1871-1885",
          "snippet": "void git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nvoid git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nvoid git_note_iterator_free(git_note_iterator *it)\n{\n\tif (it == NULL)\n\t\treturn;\n\n\tgit_iterator_free(it);\n}"
  },
  {
    "function_name": "git_note_foreach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "615-640",
    "snippet": "int git_note_foreach(\n\tgit_repository *repo,\n\tconst char *notes_ref,\n\tgit_note_foreach_cb note_cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_note_iterator *iter = NULL;\n\tgit_oid note_id, annotated_id;\n\n\tif ((error = git_note_iterator_new(&iter, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_note_next(&note_id, &annotated_id, iter))) {\n\t\tif ((error = note_cb(&note_id, &annotated_id, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\tgit_note_iterator_free(iter);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_note_iterator_free",
          "args": [
            "iter"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "git_note_iterator_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "643-649",
          "snippet": "void git_note_iterator_free(git_note_iterator *it)\n{\n\tif (it == NULL)\n\t\treturn;\n\n\tgit_iterator_free(it);\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nvoid git_note_iterator_free(git_note_iterator *it)\n{\n\tif (it == NULL)\n\t\treturn;\n\n\tgit_iterator_free(it);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set_after_callback",
          "args": [
            "error"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "note_cb",
          "args": [
            "&note_id",
            "&annotated_id",
            "payload"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_note_next",
          "args": [
            "&note_id",
            "&annotated_id",
            "iter"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "git_note_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "677-694",
          "snippet": "int git_note_next(\n\tgit_oid* note_id,\n\tgit_oid* annotated_id,\n\tgit_note_iterator *it)\n{\n\tint error;\n\tconst git_index_entry *item;\n\n\tif ((error = git_iterator_current(&item, it)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(note_id, &item->id);\n\n\tif (!(error = process_entry_path(item->path, annotated_id)))\n\t\tgit_iterator_advance(NULL, it);\n\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_next(\n\tgit_oid* note_id,\n\tgit_oid* annotated_id,\n\tgit_note_iterator *it)\n{\n\tint error;\n\tconst git_index_entry *item;\n\n\tif ((error = git_iterator_current(&item, it)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(note_id, &item->id);\n\n\tif (!(error = process_entry_path(item->path, annotated_id)))\n\t\tgit_iterator_advance(NULL, it);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_note_iterator_new",
          "args": [
            "&iter",
            "repo",
            "notes_ref"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "git_note_iterator_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "652-675",
          "snippet": "int git_note_iterator_new(\n\tgit_note_iterator **it,\n\tgit_repository *repo,\n\tconst char *notes_ref_in)\n{\n\tint error;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\tchar *notes_ref;\n\n\terror = retrieve_note_tree_and_commit(&tree, &commit, &notes_ref, repo, notes_ref_in);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_iterator_for_tree(it, tree, NULL)) < 0)\n\t\tgit_iterator_free(*it);\n\ncleanup:\n\tgit__free(notes_ref);\n\tgit_tree_free(tree);\n\tgit_commit_free(commit);\n\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_iterator_new(\n\tgit_note_iterator **it,\n\tgit_repository *repo,\n\tconst char *notes_ref_in)\n{\n\tint error;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\tchar *notes_ref;\n\n\terror = retrieve_note_tree_and_commit(&tree, &commit, &notes_ref, repo, notes_ref_in);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_iterator_for_tree(it, tree, NULL)) < 0)\n\t\tgit_iterator_free(*it);\n\ncleanup:\n\tgit__free(notes_ref);\n\tgit_tree_free(tree);\n\tgit_commit_free(commit);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_foreach(\n\tgit_repository *repo,\n\tconst char *notes_ref,\n\tgit_note_foreach_cb note_cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_note_iterator *iter = NULL;\n\tgit_oid note_id, annotated_id;\n\n\tif ((error = git_note_iterator_new(&iter, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_note_next(&note_id, &annotated_id, iter))) {\n\t\tif ((error = note_cb(&note_id, &annotated_id, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\tgit_note_iterator_free(iter);\n\treturn error;\n}"
  },
  {
    "function_name": "process_entry_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "569-613",
    "snippet": "static int process_entry_path(\n\tconst char* entry_path,\n\tgit_oid *annotated_object_id)\n{\n\tint error = 0;\n\tsize_t i = 0, j = 0, len;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tif ((error = git_buf_puts(&buf, entry_path)) < 0)\n\t\tgoto cleanup;\n\n\tlen = git_buf_len(&buf);\n\n\twhile (i < len) {\n\t\tif (buf.ptr[i] == '/') {\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (git__fromhex(buf.ptr[i]) < 0) {\n\t\t\t/* This is not a note entry */\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\tif (i != j)\n\t\t\tbuf.ptr[j] = buf.ptr[i];\n\n\t\ti++;\n\t\tj++;\n\t}\n\n\tbuf.ptr[j] = '\\0';\n\tbuf.size = j;\n\n\tif (j != GIT_OID_HEXSZ) {\n\t\t/* This is not a note entry */\n\t\tgoto cleanup;\n\t}\n\n\terror = git_oid_fromstr(annotated_object_id, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fromstr",
          "args": [
            "annotated_object_id",
            "buf.ptr"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "54-57",
          "snippet": "int git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__fromhex",
          "args": [
            "buf.ptr[i]"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "git__fromhex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "408-411",
          "snippet": "GIT_INLINE(int) git__fromhex(char h)\n{\n\treturn from_hex[(unsigned char) h];\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__fromhex(char h)\n{\n\treturn from_hex[(unsigned char) h];\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "&buf"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "&buf",
            "entry_path"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int process_entry_path(\n\tconst char* entry_path,\n\tgit_oid *annotated_object_id)\n{\n\tint error = 0;\n\tsize_t i = 0, j = 0, len;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tif ((error = git_buf_puts(&buf, entry_path)) < 0)\n\t\tgoto cleanup;\n\n\tlen = git_buf_len(&buf);\n\n\twhile (i < len) {\n\t\tif (buf.ptr[i] == '/') {\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (git__fromhex(buf.ptr[i]) < 0) {\n\t\t\t/* This is not a note entry */\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\tif (i != j)\n\t\t\tbuf.ptr[j] = buf.ptr[i];\n\n\t\ti++;\n\t\tj++;\n\t}\n\n\tbuf.ptr[j] = '\\0';\n\tbuf.size = j;\n\n\tif (j != GIT_OID_HEXSZ) {\n\t\t/* This is not a note entry */\n\t\tgoto cleanup;\n\t}\n\n\terror = git_oid_fromstr(annotated_object_id, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\treturn error;\n}"
  },
  {
    "function_name": "git_note_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "558-567",
    "snippet": "void git_note_free(git_note *note)\n{\n\tif (note == NULL)\n\t\treturn;\n\n\tgit_signature_free(note->committer);\n\tgit_signature_free(note->author);\n\tgit__free(note->message);\n\tgit__free(note);\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "note"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_signature_free",
          "args": [
            "note->author"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "14-24",
          "snippet": "void git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nvoid git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nvoid git_note_free(git_note *note)\n{\n\tif (note == NULL)\n\t\treturn;\n\n\tgit_signature_free(note->committer);\n\tgit_signature_free(note->author);\n\tgit__free(note->message);\n\tgit__free(note);\n}"
  },
  {
    "function_name": "git_note_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "552-556",
    "snippet": "const git_oid * git_note_id(const git_note *note)\n{\n\tassert(note);\n\treturn &note->id;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "note"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nconst git_oid * git_note_id(const git_note *note)\n{\n\tassert(note);\n\treturn &note->id;\n}"
  },
  {
    "function_name": "git_note_message",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "546-550",
    "snippet": "const char * git_note_message(const git_note *note)\n{\n\tassert(note);\n\treturn note->message;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "note"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nconst char * git_note_message(const git_note *note)\n{\n\tassert(note);\n\treturn note->message;\n}"
  },
  {
    "function_name": "git_note_author",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "540-544",
    "snippet": "const git_signature *git_note_author(const git_note *note)\n{\n\tassert(note);\n\treturn note->author;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "note"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nconst git_signature *git_note_author(const git_note *note)\n{\n\tassert(note);\n\treturn note->author;\n}"
  },
  {
    "function_name": "git_note_committer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "534-538",
    "snippet": "const git_signature *git_note_committer(const git_note *note)\n{\n\tassert(note);\n\treturn note->committer;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "note"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nconst git_signature *git_note_committer(const git_note *note)\n{\n\tassert(note);\n\treturn note->committer;\n}"
  },
  {
    "function_name": "git_note_default_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "518-532",
    "snippet": "int git_note_default_ref(git_buf *out, git_repository *repo)\n{\n\tchar *default_ref;\n\tint error;\n\n\tassert(out && repo);\n\n\tgit_buf_sanitize(out);\n\n\tif ((error = note_get_default_ref(&default_ref, repo)) < 0)\n\t\treturn error;\n\n\tgit_buf_attach(out, default_ref, strlen(default_ref));\n\treturn 0;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_attach",
          "args": [
            "out",
            "default_ref",
            "strlen(default_ref)"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_attach_notowned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "505-517",
          "snippet": "void git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "default_ref"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "note_get_default_ref",
          "args": [
            "&default_ref",
            "repo"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "note_get_default_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "391-400",
          "snippet": "static int note_get_default_ref(char **out, git_repository *repo)\n{\n\tgit_config *cfg;\n\tint ret = git_repository_config__weakptr(&cfg, repo);\n\n\t*out = (ret != 0) ? NULL : git_config__get_string_force(\n\t\tcfg, \"core.notesref\", GIT_NOTES_DEFAULT_REF);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_get_default_ref(char **out, git_repository *repo)\n{\n\tgit_config *cfg;\n\tint ret = git_repository_config__weakptr(&cfg, repo);\n\n\t*out = (ret != 0) ? NULL : git_config__get_string_force(\n\t\tcfg, \"core.notesref\", GIT_NOTES_DEFAULT_REF);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "out"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_default_ref(git_buf *out, git_repository *repo)\n{\n\tchar *default_ref;\n\tint error;\n\n\tassert(out && repo);\n\n\tgit_buf_sanitize(out);\n\n\tif ((error = note_get_default_ref(&default_ref, repo)) < 0)\n\t\treturn error;\n\n\tgit_buf_attach(out, default_ref, strlen(default_ref));\n\treturn 0;\n}"
  },
  {
    "function_name": "git_note_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "494-516",
    "snippet": "int git_note_remove(git_repository *repo, const char *notes_ref_in,\n\t\tconst git_signature *author, const git_signature *committer,\n\t\tconst git_oid *oid)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\tif (!(error = retrieve_note_tree_and_commit(\n\t\t      &tree, &commit, &notes_ref, repo, notes_ref_in)))\n\t\terror = note_remove(\n\t\t\trepo, author, committer, notes_ref, tree, target, &commit);\n\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_commit_free(commit);\n\tgit_tree_free(tree);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "tree"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "commit"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "target"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "note_remove",
          "args": [
            "repo",
            "author",
            "committer",
            "notes_ref",
            "tree",
            "target",
            "&commit"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "note_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "366-389",
          "snippet": "static int note_remove(git_repository *repo,\n\t\tconst git_signature *author, const git_signature *committer,\n\t\tconst char *notes_ref, git_tree *tree,\n\t\tconst char *target, git_commit **parents)\n{\n\tint error;\n\tgit_tree *tree_after_removal = NULL;\n\tgit_oid oid;\n\n\tif ((error = manipulate_note_in_tree_r(\n\t\t&tree_after_removal, repo, tree, NULL, target, 0,\n\t\tremove_note_in_tree_eexists_cb, remove_note_in_tree_enotfound_cb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_commit_create(&oid, repo, notes_ref, author, committer,\n\t  NULL, GIT_NOTES_DEFAULT_MSG_RM,\n\t  tree_after_removal,\n\t  *parents == NULL ? 0 : 1,\n\t  (const git_commit **) parents);\n\ncleanup:\n\tgit_tree_free(tree_after_removal);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_remove(git_repository *repo,\n\t\tconst git_signature *author, const git_signature *committer,\n\t\tconst char *notes_ref, git_tree *tree,\n\t\tconst char *target, git_commit **parents)\n{\n\tint error;\n\tgit_tree *tree_after_removal = NULL;\n\tgit_oid oid;\n\n\tif ((error = manipulate_note_in_tree_r(\n\t\t&tree_after_removal, repo, tree, NULL, target, 0,\n\t\tremove_note_in_tree_eexists_cb, remove_note_in_tree_enotfound_cb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_commit_create(&oid, repo, notes_ref, author, committer,\n\t  NULL, GIT_NOTES_DEFAULT_MSG_RM,\n\t  tree_after_removal,\n\t  *parents == NULL ? 0 : 1,\n\t  (const git_commit **) parents);\n\ncleanup:\n\tgit_tree_free(tree_after_removal);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "retrieve_note_tree_and_commit",
          "args": [
            "&tree",
            "&commit",
            "&notes_ref",
            "repo",
            "notes_ref_in"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "retrieve_note_tree_and_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "413-436",
          "snippet": "static int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "target"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_allocfmt",
          "args": [
            "oid"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_allocfmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "110-117",
          "snippet": "char *git_oid_allocfmt(const git_oid *oid)\n{\n\tchar *str = git__malloc(GIT_OID_HEXSZ + 1);\n\tif (!str)\n\t\treturn NULL;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_allocfmt(const git_oid *oid)\n{\n\tchar *str = git__malloc(GIT_OID_HEXSZ + 1);\n\tif (!str)\n\t\treturn NULL;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_remove(git_repository *repo, const char *notes_ref_in,\n\t\tconst git_signature *author, const git_signature *committer,\n\t\tconst git_oid *oid)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\tif (!(error = retrieve_note_tree_and_commit(\n\t\t      &tree, &commit, &notes_ref, repo, notes_ref_in)))\n\t\terror = note_remove(\n\t\t\trepo, author, committer, notes_ref, tree, target, &commit);\n\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_commit_free(commit);\n\tgit_tree_free(tree);\n\treturn error;\n}"
  },
  {
    "function_name": "git_note_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "460-492",
    "snippet": "int git_note_create(\n\tgit_oid *out,\n\tgit_repository *repo,\n\tconst char *notes_ref_in,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst git_oid *oid,\n\tconst char *note,\n\tint allow_note_overwrite)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref = NULL;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\terror = retrieve_note_tree_and_commit(&tree, &commit, &notes_ref, repo, notes_ref_in);\n\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\terror = note_write(out, repo, author, committer, notes_ref,\n\t\t\tnote, tree, target, &commit, allow_note_overwrite);\n\ncleanup:\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_commit_free(commit);\n\tgit_tree_free(tree);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "tree"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "commit"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "target"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "note_write",
          "args": [
            "out",
            "repo",
            "author",
            "committer",
            "notes_ref",
            "note",
            "tree",
            "target",
            "&commit",
            "allow_note_overwrite"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "note_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "271-307",
          "snippet": "static int note_write(git_oid *out,\n\tgit_repository *repo,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *notes_ref,\n\tconst char *note,\n\tgit_tree *commit_tree,\n\tconst char *target,\n\tgit_commit **parents,\n\tint allow_note_overwrite)\n{\n\tint error;\n\tgit_oid oid;\n\tgit_tree *tree = NULL;\n\n\t// TODO: should we apply filters?\n\t/* create note object */\n\tif ((error = git_blob_create_frombuffer(&oid, repo, note, strlen(note))) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = manipulate_note_in_tree_r(\n\t\t&tree, repo, commit_tree, &oid, target, 0,\n\t\tallow_note_overwrite ? insert_note_in_tree_enotfound_cb : insert_note_in_tree_eexists_cb,\n\t\tinsert_note_in_tree_enotfound_cb)) < 0)\n\t\tgoto cleanup;\n\n\tif (out)\n\t\tgit_oid_cpy(out, &oid);\n\n\terror = git_commit_create(&oid, repo, notes_ref, author, committer,\n\t\t\t\t  NULL, GIT_NOTES_DEFAULT_MSG_ADD,\n\t\t\t\t  tree, *parents == NULL ? 0 : 1, (const git_commit **) parents);\n\ncleanup:\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_write(git_oid *out,\n\tgit_repository *repo,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *notes_ref,\n\tconst char *note,\n\tgit_tree *commit_tree,\n\tconst char *target,\n\tgit_commit **parents,\n\tint allow_note_overwrite)\n{\n\tint error;\n\tgit_oid oid;\n\tgit_tree *tree = NULL;\n\n\t// TODO: should we apply filters?\n\t/* create note object */\n\tif ((error = git_blob_create_frombuffer(&oid, repo, note, strlen(note))) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = manipulate_note_in_tree_r(\n\t\t&tree, repo, commit_tree, &oid, target, 0,\n\t\tallow_note_overwrite ? insert_note_in_tree_enotfound_cb : insert_note_in_tree_eexists_cb,\n\t\tinsert_note_in_tree_enotfound_cb)) < 0)\n\t\tgoto cleanup;\n\n\tif (out)\n\t\tgit_oid_cpy(out, &oid);\n\n\terror = git_commit_create(&oid, repo, notes_ref, author, committer,\n\t\t\t\t  NULL, GIT_NOTES_DEFAULT_MSG_ADD,\n\t\t\t\t  tree, *parents == NULL ? 0 : 1, (const git_commit **) parents);\n\ncleanup:\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "retrieve_note_tree_and_commit",
          "args": [
            "&tree",
            "&commit",
            "&notes_ref",
            "repo",
            "notes_ref_in"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "retrieve_note_tree_and_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "413-436",
          "snippet": "static int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "target"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_allocfmt",
          "args": [
            "oid"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_allocfmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "110-117",
          "snippet": "char *git_oid_allocfmt(const git_oid *oid)\n{\n\tchar *str = git__malloc(GIT_OID_HEXSZ + 1);\n\tif (!str)\n\t\treturn NULL;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_allocfmt(const git_oid *oid)\n{\n\tchar *str = git__malloc(GIT_OID_HEXSZ + 1);\n\tif (!str)\n\t\treturn NULL;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_create(\n\tgit_oid *out,\n\tgit_repository *repo,\n\tconst char *notes_ref_in,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst git_oid *oid,\n\tconst char *note,\n\tint allow_note_overwrite)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref = NULL;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\terror = retrieve_note_tree_and_commit(&tree, &commit, &notes_ref, repo, notes_ref_in);\n\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\terror = note_write(out, repo, author, committer, notes_ref,\n\t\t\tnote, tree, target, &commit, allow_note_overwrite);\n\ncleanup:\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_commit_free(commit);\n\tgit_tree_free(tree);\n\treturn error;\n}"
  },
  {
    "function_name": "git_note_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "438-458",
    "snippet": "int git_note_read(git_note **out, git_repository *repo,\n\t\t  const char *notes_ref_in, const git_oid *oid)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref = NULL;\n\tgit_tree *tree = NULL;\n\tgit_commit *commit = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\tif (!(error = retrieve_note_tree_and_commit(\n\t\t      &tree, &commit, &notes_ref, repo, notes_ref_in)))\n\t\terror = note_lookup(out, repo, commit, tree, target);\n\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_tree_free(tree);\n\tgit_commit_free(commit);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "commit"
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "tree"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "target"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "note_lookup",
          "args": [
            "out",
            "repo",
            "commit",
            "tree",
            "target"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "note_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "333-364",
          "snippet": "static int note_lookup(\n\tgit_note **out,\n\tgit_repository *repo,\n\tgit_commit *commit,\n\tgit_tree *tree,\n\tconst char *target)\n{\n\tint error, fanout = 0;\n\tgit_oid oid;\n\tgit_blob *blob = NULL;\n\tgit_note *note = NULL;\n\tgit_tree *subtree = NULL;\n\n\tif ((error = find_subtree_r(&subtree, tree, repo, target, &fanout)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = find_blob(&oid, subtree, target + fanout)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_blob_lookup(&blob, repo, &oid)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = note_new(&note, &oid, commit, blob)) < 0)\n\t\tgoto cleanup;\n\n\t*out = note;\n\ncleanup:\n\tgit_tree_free(subtree);\n\tgit_blob_free(blob);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_lookup(\n\tgit_note **out,\n\tgit_repository *repo,\n\tgit_commit *commit,\n\tgit_tree *tree,\n\tconst char *target)\n{\n\tint error, fanout = 0;\n\tgit_oid oid;\n\tgit_blob *blob = NULL;\n\tgit_note *note = NULL;\n\tgit_tree *subtree = NULL;\n\n\tif ((error = find_subtree_r(&subtree, tree, repo, target, &fanout)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = find_blob(&oid, subtree, target + fanout)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_blob_lookup(&blob, repo, &oid)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = note_new(&note, &oid, commit, blob)) < 0)\n\t\tgoto cleanup;\n\n\t*out = note;\n\ncleanup:\n\tgit_tree_free(subtree);\n\tgit_blob_free(blob);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "retrieve_note_tree_and_commit",
          "args": [
            "&tree",
            "&commit",
            "&notes_ref",
            "repo",
            "notes_ref_in"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "retrieve_note_tree_and_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "413-436",
          "snippet": "static int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "target"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_allocfmt",
          "args": [
            "oid"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_allocfmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "110-117",
          "snippet": "char *git_oid_allocfmt(const git_oid *oid)\n{\n\tchar *str = git__malloc(GIT_OID_HEXSZ + 1);\n\tif (!str)\n\t\treturn NULL;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_allocfmt(const git_oid *oid)\n{\n\tchar *str = git__malloc(GIT_OID_HEXSZ + 1);\n\tif (!str)\n\t\treturn NULL;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_read(git_note **out, git_repository *repo,\n\t\t  const char *notes_ref_in, const git_oid *oid)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref = NULL;\n\tgit_tree *tree = NULL;\n\tgit_commit *commit = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\tif (!(error = retrieve_note_tree_and_commit(\n\t\t      &tree, &commit, &notes_ref, repo, notes_ref_in)))\n\t\terror = note_lookup(out, repo, commit, tree, target);\n\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_tree_free(tree);\n\tgit_commit_free(commit);\n\treturn error;\n}"
  },
  {
    "function_name": "retrieve_note_tree_and_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "413-436",
    "snippet": "static int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_tree",
          "args": [
            "tree_out",
            "*commit_out"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "530-534",
          "snippet": "int git_commit_tree(git_tree **tree_out, const git_commit *commit)\n{\n\tassert(commit);\n\treturn git_tree_lookup(tree_out, commit->object.repo, &commit->tree_id);\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_commit_tree(git_tree **tree_out, const git_commit *commit)\n{\n\tassert(commit);\n\treturn git_tree_lookup(tree_out, commit->object.repo, &commit->tree_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "commit_out",
            "repo",
            "&oid"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_name_to_id",
          "args": [
            "&oid",
            "repo",
            "*notes_ref_out"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "152-164",
          "snippet": "int git_reference_name_to_id(\n\tgit_oid *out, git_repository *repo, const char *name)\n{\n\tint error;\n\tgit_reference *ref;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, name, -1)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(out, git_reference_target(ref));\n\tgit_reference_free(ref);\n\treturn 0;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_name_to_id(\n\tgit_oid *out, git_repository *repo, const char *name)\n{\n\tint error;\n\tgit_reference *ref;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, name, -1)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(out, git_reference_target(ref));\n\tgit_reference_free(ref);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "normalize_namespace",
          "args": [
            "notes_ref_out",
            "repo",
            "notes_ref"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "normalize_namespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "402-411",
          "snippet": "static int normalize_namespace(char **out, git_repository *repo, const char *notes_ref)\n{\n\tif (notes_ref) {\n\t\t*out = git__strdup(notes_ref);\n\t\tGITERR_CHECK_ALLOC(*out);\n\t\treturn 0;\n\t}\n\n\treturn note_get_default_ref(out, repo);\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int normalize_namespace(char **out, git_repository *repo, const char *notes_ref)\n{\n\tif (notes_ref) {\n\t\t*out = git__strdup(notes_ref);\n\t\tGITERR_CHECK_ALLOC(*out);\n\t\treturn 0;\n\t}\n\n\treturn note_get_default_ref(out, repo);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int retrieve_note_tree_and_commit(\n\tgit_tree **tree_out,\n\tgit_commit **commit_out,\n\tchar **notes_ref_out,\n\tgit_repository *repo,\n\tconst char *notes_ref)\n{\n\tint error;\n\tgit_oid oid;\n\n\tif ((error = normalize_namespace(notes_ref_out, repo, notes_ref)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_name_to_id(&oid, repo, *notes_ref_out)) < 0)\n\t\treturn error;\n\n\tif (git_commit_lookup(commit_out, repo, &oid) < 0)\n\t\treturn error;\n\n\tif ((error = git_commit_tree(tree_out, *commit_out)) < 0)\n\t\treturn error;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "normalize_namespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "402-411",
    "snippet": "static int normalize_namespace(char **out, git_repository *repo, const char *notes_ref)\n{\n\tif (notes_ref) {\n\t\t*out = git__strdup(notes_ref);\n\t\tGITERR_CHECK_ALLOC(*out);\n\t\treturn 0;\n\t}\n\n\treturn note_get_default_ref(out, repo);\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "note_get_default_ref",
          "args": [
            "out",
            "repo"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "note_get_default_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "391-400",
          "snippet": "static int note_get_default_ref(char **out, git_repository *repo)\n{\n\tgit_config *cfg;\n\tint ret = git_repository_config__weakptr(&cfg, repo);\n\n\t*out = (ret != 0) ? NULL : git_config__get_string_force(\n\t\tcfg, \"core.notesref\", GIT_NOTES_DEFAULT_REF);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_get_default_ref(char **out, git_repository *repo)\n{\n\tgit_config *cfg;\n\tint ret = git_repository_config__weakptr(&cfg, repo);\n\n\t*out = (ret != 0) ? NULL : git_config__get_string_force(\n\t\tcfg, \"core.notesref\", GIT_NOTES_DEFAULT_REF);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "*out"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "notes_ref"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int normalize_namespace(char **out, git_repository *repo, const char *notes_ref)\n{\n\tif (notes_ref) {\n\t\t*out = git__strdup(notes_ref);\n\t\tGITERR_CHECK_ALLOC(*out);\n\t\treturn 0;\n\t}\n\n\treturn note_get_default_ref(out, repo);\n}"
  },
  {
    "function_name": "note_get_default_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "391-400",
    "snippet": "static int note_get_default_ref(char **out, git_repository *repo)\n{\n\tgit_config *cfg;\n\tint ret = git_repository_config__weakptr(&cfg, repo);\n\n\t*out = (ret != 0) ? NULL : git_config__get_string_force(\n\t\tcfg, \"core.notesref\", GIT_NOTES_DEFAULT_REF);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config__get_string_force",
          "args": [
            "cfg",
            "\"core.notesref\"",
            "GIT_NOTES_DEFAULT_REF"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__get_string_force",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "877-888",
          "snippet": "char *git_config__get_string_force(\n\tconst git_config *cfg, const char *key, const char *fallback_value)\n{\n\tgit_config_entry *entry;\n\tchar *ret;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\tret = (entry && entry->value) ? git__strdup(entry->value) : fallback_value ? git__strdup(fallback_value) : NULL;\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nchar *git_config__get_string_force(\n\tconst git_config *cfg, const char *key, const char *fallback_value)\n{\n\tgit_config_entry *entry;\n\tchar *ret;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\tret = (entry && entry->value) ? git__strdup(entry->value) : fallback_value ? git__strdup(fallback_value) : NULL;\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config__weakptr",
          "args": [
            "&cfg",
            "repo"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "661-705",
          "snippet": "int git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_get_default_ref(char **out, git_repository *repo)\n{\n\tgit_config *cfg;\n\tint ret = git_repository_config__weakptr(&cfg, repo);\n\n\t*out = (ret != 0) ? NULL : git_config__get_string_force(\n\t\tcfg, \"core.notesref\", GIT_NOTES_DEFAULT_REF);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "note_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "366-389",
    "snippet": "static int note_remove(git_repository *repo,\n\t\tconst git_signature *author, const git_signature *committer,\n\t\tconst char *notes_ref, git_tree *tree,\n\t\tconst char *target, git_commit **parents)\n{\n\tint error;\n\tgit_tree *tree_after_removal = NULL;\n\tgit_oid oid;\n\n\tif ((error = manipulate_note_in_tree_r(\n\t\t&tree_after_removal, repo, tree, NULL, target, 0,\n\t\tremove_note_in_tree_eexists_cb, remove_note_in_tree_enotfound_cb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_commit_create(&oid, repo, notes_ref, author, committer,\n\t  NULL, GIT_NOTES_DEFAULT_MSG_RM,\n\t  tree_after_removal,\n\t  *parents == NULL ? 0 : 1,\n\t  (const git_commit **) parents);\n\ncleanup:\n\tgit_tree_free(tree_after_removal);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "tree_after_removal"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_create",
          "args": [
            "&oid",
            "repo",
            "notes_ref",
            "author",
            "committer",
            "NULL",
            "GIT_NOTES_DEFAULT_MSG_RM",
            "tree_after_removal",
            "*parents == NULL ? 0 : 1",
            "(const git_commit **) parents"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "240-260",
          "snippet": "int git_commit_create(\n\tgit_oid *id,\n\tgit_repository *repo,\n\tconst char *update_ref,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message,\n\tconst git_tree *tree,\n\tsize_t parent_count,\n\tconst git_commit *parents[])\n{\n\tcommit_parent_data data = { parent_count, parents, repo };\n\n\tassert(tree && git_tree_owner(tree) == repo);\n\n\treturn git_commit__create_internal(\n\t\tid, repo, update_ref, author, committer,\n\t\tmessage_encoding, message, git_tree_id(tree),\n\t\tcommit_parent_from_array, &data, false);\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_commit_create(\n\tgit_oid *id,\n\tgit_repository *repo,\n\tconst char *update_ref,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message,\n\tconst git_tree *tree,\n\tsize_t parent_count,\n\tconst git_commit *parents[])\n{\n\tcommit_parent_data data = { parent_count, parents, repo };\n\n\tassert(tree && git_tree_owner(tree) == repo);\n\n\treturn git_commit__create_internal(\n\t\tid, repo, update_ref, author, committer,\n\t\tmessage_encoding, message, git_tree_id(tree),\n\t\tcommit_parent_from_array, &data, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "manipulate_note_in_tree_r",
          "args": [
            "&tree_after_removal",
            "repo",
            "tree",
            "NULL",
            "target",
            "0",
            "remove_note_in_tree_eexists_cb",
            "remove_note_in_tree_enotfound_cb"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "manipulate_note_in_tree_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "132-197",
          "snippet": "static int manipulate_note_in_tree_r(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint (*note_exists_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error),\n\tint (*note_notfound_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error))\n{\n\tint error;\n\tgit_tree *subtree = NULL, *new = NULL;\n\tchar subtree_name[3];\n\n\terror = find_subtree_in_current_level(\n\t\t&subtree, repo, parent, annotated_object_sha, fanout);\n\n\tif (error == GIT_EEXISTS) {\n\t\terror = note_exists_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error == GIT_ENOTFOUND) {\n\t\terror = note_notfound_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\t/* An existing fanout has been found, let's dig deeper */\n\terror = manipulate_note_in_tree_r(\n\t\t&new, repo, subtree, note_oid, annotated_object_sha,\n\t\tfanout + 2, note_exists_cb, note_notfound_cb);\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tstrncpy(subtree_name, annotated_object_sha + fanout, 2);\n\tsubtree_name[2] = '\\0';\n\n\terror = tree_write(out, repo, parent, git_tree_id(new),\n\t\t\t   subtree_name, GIT_FILEMODE_TREE);\n\n\ncleanup:\n\tgit_tree_free(new);\n\tgit_tree_free(subtree);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int manipulate_note_in_tree_r(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint (*note_exists_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error),\n\tint (*note_notfound_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error))\n{\n\tint error;\n\tgit_tree *subtree = NULL, *new = NULL;\n\tchar subtree_name[3];\n\n\terror = find_subtree_in_current_level(\n\t\t&subtree, repo, parent, annotated_object_sha, fanout);\n\n\tif (error == GIT_EEXISTS) {\n\t\terror = note_exists_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error == GIT_ENOTFOUND) {\n\t\terror = note_notfound_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\t/* An existing fanout has been found, let's dig deeper */\n\terror = manipulate_note_in_tree_r(\n\t\t&new, repo, subtree, note_oid, annotated_object_sha,\n\t\tfanout + 2, note_exists_cb, note_notfound_cb);\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tstrncpy(subtree_name, annotated_object_sha + fanout, 2);\n\tsubtree_name[2] = '\\0';\n\n\terror = tree_write(out, repo, parent, git_tree_id(new),\n\t\t\t   subtree_name, GIT_FILEMODE_TREE);\n\n\ncleanup:\n\tgit_tree_free(new);\n\tgit_tree_free(subtree);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_remove(git_repository *repo,\n\t\tconst git_signature *author, const git_signature *committer,\n\t\tconst char *notes_ref, git_tree *tree,\n\t\tconst char *target, git_commit **parents)\n{\n\tint error;\n\tgit_tree *tree_after_removal = NULL;\n\tgit_oid oid;\n\n\tif ((error = manipulate_note_in_tree_r(\n\t\t&tree_after_removal, repo, tree, NULL, target, 0,\n\t\tremove_note_in_tree_eexists_cb, remove_note_in_tree_enotfound_cb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_commit_create(&oid, repo, notes_ref, author, committer,\n\t  NULL, GIT_NOTES_DEFAULT_MSG_RM,\n\t  tree_after_removal,\n\t  *parents == NULL ? 0 : 1,\n\t  (const git_commit **) parents);\n\ncleanup:\n\tgit_tree_free(tree_after_removal);\n\treturn error;\n}"
  },
  {
    "function_name": "note_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "333-364",
    "snippet": "static int note_lookup(\n\tgit_note **out,\n\tgit_repository *repo,\n\tgit_commit *commit,\n\tgit_tree *tree,\n\tconst char *target)\n{\n\tint error, fanout = 0;\n\tgit_oid oid;\n\tgit_blob *blob = NULL;\n\tgit_note *note = NULL;\n\tgit_tree *subtree = NULL;\n\n\tif ((error = find_subtree_r(&subtree, tree, repo, target, &fanout)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = find_blob(&oid, subtree, target + fanout)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_blob_lookup(&blob, repo, &oid)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = note_new(&note, &oid, commit, blob)) < 0)\n\t\tgoto cleanup;\n\n\t*out = note;\n\ncleanup:\n\tgit_tree_free(subtree);\n\tgit_blob_free(blob);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_blob_free",
          "args": [
            "blob"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "116-119",
          "snippet": "void git_blob_free(git_blob *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_blob_free(git_blob *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "subtree"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "note_new",
          "args": [
            "&note",
            "&oid",
            "commit",
            "blob"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "note_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "309-331",
          "snippet": "static int note_new(\n\tgit_note **out,\n\tgit_oid *note_oid,\n\tgit_commit *commit,\n\tgit_blob *blob)\n{\n\tgit_note *note = NULL;\n\n\tnote = git__malloc(sizeof(git_note));\n\tGITERR_CHECK_ALLOC(note);\n\n\tgit_oid_cpy(&note->id, note_oid);\n\n\tif (git_signature_dup(&note->author, git_commit_author(commit)) < 0 ||\n\t\tgit_signature_dup(&note->committer, git_commit_committer(commit)) < 0)\n\t\treturn -1;\n\n\tnote->message = git__strndup(git_blob_rawcontent(blob), git_blob_rawsize(blob));\n\tGITERR_CHECK_ALLOC(note->message);\n\n\t*out = note;\n\treturn 0;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_new(\n\tgit_note **out,\n\tgit_oid *note_oid,\n\tgit_commit *commit,\n\tgit_blob *blob)\n{\n\tgit_note *note = NULL;\n\n\tnote = git__malloc(sizeof(git_note));\n\tGITERR_CHECK_ALLOC(note);\n\n\tgit_oid_cpy(&note->id, note_oid);\n\n\tif (git_signature_dup(&note->author, git_commit_author(commit)) < 0 ||\n\t\tgit_signature_dup(&note->committer, git_commit_committer(commit)) < 0)\n\t\treturn -1;\n\n\tnote->message = git__strndup(git_blob_rawcontent(blob), git_blob_rawsize(blob));\n\tGITERR_CHECK_ALLOC(note->message);\n\n\t*out = note;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_lookup",
          "args": [
            "&blob",
            "repo",
            "&oid"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "106-109",
          "snippet": "int git_blob_lookup(git_blob **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_BLOB);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_blob_lookup(git_blob **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_BLOB);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_blob",
          "args": [
            "&oid",
            "subtree",
            "target + fanout"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "find_blob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "78-95",
          "snippet": "static int find_blob(git_oid *blob, git_tree *tree, const char *target)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\tfor (i=0; i<git_tree_entrycount(tree); i++) {\n\t\tentry = git_tree_entry_byindex(tree, i);\n\n\t\tif (!strcmp(git_tree_entry_name(entry), target)) {\n\t\t\t/* found matching note object - return */\n\n\t\t\tgit_oid_cpy(blob, git_tree_entry_id(entry));\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn note_error_notfound();\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int find_blob(git_oid *blob, git_tree *tree, const char *target)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\tfor (i=0; i<git_tree_entrycount(tree); i++) {\n\t\tentry = git_tree_entry_byindex(tree, i);\n\n\t\tif (!strcmp(git_tree_entry_name(entry), target)) {\n\t\t\t/* found matching note object - return */\n\n\t\t\tgit_oid_cpy(blob, git_tree_entry_id(entry));\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn note_error_notfound();\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_subtree_r",
          "args": [
            "&subtree",
            "tree",
            "repo",
            "target",
            "&fanout"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "find_subtree_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "56-76",
          "snippet": "static int find_subtree_r(git_tree **out, git_tree *root,\n\t\t\tgit_repository *repo, const char *target, int *fanout)\n{\n\tint error;\n\tgit_tree *subtree = NULL;\n\n\t*out = NULL;\n\n\terror = find_subtree_in_current_level(&subtree, repo, root, target, *fanout);\n\tif (error == GIT_EEXISTS)\n\t\treturn git_tree_lookup(out, repo, git_tree_id(root));\n\n\tif (error < 0)\n\t\treturn error;\n\n\t*fanout += 2;\n\terror = find_subtree_r(out, subtree, repo, target, fanout);\n\tgit_tree_free(subtree);\n\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int find_subtree_r(git_tree **out, git_tree *root,\n\t\t\tgit_repository *repo, const char *target, int *fanout)\n{\n\tint error;\n\tgit_tree *subtree = NULL;\n\n\t*out = NULL;\n\n\terror = find_subtree_in_current_level(&subtree, repo, root, target, *fanout);\n\tif (error == GIT_EEXISTS)\n\t\treturn git_tree_lookup(out, repo, git_tree_id(root));\n\n\tif (error < 0)\n\t\treturn error;\n\n\t*fanout += 2;\n\terror = find_subtree_r(out, subtree, repo, target, fanout);\n\tgit_tree_free(subtree);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_lookup(\n\tgit_note **out,\n\tgit_repository *repo,\n\tgit_commit *commit,\n\tgit_tree *tree,\n\tconst char *target)\n{\n\tint error, fanout = 0;\n\tgit_oid oid;\n\tgit_blob *blob = NULL;\n\tgit_note *note = NULL;\n\tgit_tree *subtree = NULL;\n\n\tif ((error = find_subtree_r(&subtree, tree, repo, target, &fanout)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = find_blob(&oid, subtree, target + fanout)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_blob_lookup(&blob, repo, &oid)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = note_new(&note, &oid, commit, blob)) < 0)\n\t\tgoto cleanup;\n\n\t*out = note;\n\ncleanup:\n\tgit_tree_free(subtree);\n\tgit_blob_free(blob);\n\treturn error;\n}"
  },
  {
    "function_name": "note_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "309-331",
    "snippet": "static int note_new(\n\tgit_note **out,\n\tgit_oid *note_oid,\n\tgit_commit *commit,\n\tgit_blob *blob)\n{\n\tgit_note *note = NULL;\n\n\tnote = git__malloc(sizeof(git_note));\n\tGITERR_CHECK_ALLOC(note);\n\n\tgit_oid_cpy(&note->id, note_oid);\n\n\tif (git_signature_dup(&note->author, git_commit_author(commit)) < 0 ||\n\t\tgit_signature_dup(&note->committer, git_commit_committer(commit)) < 0)\n\t\treturn -1;\n\n\tnote->message = git__strndup(git_blob_rawcontent(blob), git_blob_rawsize(blob));\n\tGITERR_CHECK_ALLOC(note->message);\n\n\t*out = note;\n\treturn 0;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "note->message"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strndup",
          "args": [
            "git_blob_rawcontent(blob)",
            "git_blob_rawsize(blob)"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "git__strndup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "181-198",
          "snippet": "GIT_INLINE(char *) git__strndup(const char *str, size_t n)\n{\n\tsize_t length = 0, alloclength;\n\tchar *ptr;\n\n\tlength = p_strnlen(str, n);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclength, length, 1) ||\n\t\t!(ptr = git__malloc(alloclength)))\n\t\treturn NULL;\n\n\tif (length)\n\t\tmemcpy(ptr, str, length);\n\n\tptr[length] = '\\0';\n\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strndup(const char *str, size_t n)\n{\n\tsize_t length = 0, alloclength;\n\tchar *ptr;\n\n\tlength = p_strnlen(str, n);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclength, length, 1) ||\n\t\t!(ptr = git__malloc(alloclength)))\n\t\treturn NULL;\n\n\tif (length)\n\t\tmemcpy(ptr, str, length);\n\n\tptr[length] = '\\0';\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_rawsize",
          "args": [
            "blob"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_rawsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blob.c",
          "lines": "25-29",
          "snippet": "git_off_t git_blob_rawsize(const git_blob *blob)\n{\n\tassert(blob);\n\treturn (git_off_t)git_odb_object_size(blob->odb_object);\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"filter.h\"",
            "#include \"blob.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"filter.h\"\n#include \"blob.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\ngit_off_t git_blob_rawsize(const git_blob *blob)\n{\n\tassert(blob);\n\treturn (git_off_t)git_odb_object_size(blob->odb_object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_rawcontent",
          "args": [
            "blob"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_rawcontent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blob.c",
          "lines": "19-23",
          "snippet": "const void *git_blob_rawcontent(const git_blob *blob)\n{\n\tassert(blob);\n\treturn git_odb_object_data(blob->odb_object);\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"filter.h\"",
            "#include \"blob.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"filter.h\"\n#include \"blob.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nconst void *git_blob_rawcontent(const git_blob *blob)\n{\n\tassert(blob);\n\treturn git_odb_object_data(blob->odb_object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_signature_dup",
          "args": [
            "&note->committer",
            "git_commit_committer(commit)"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "98-120",
          "snippet": "int git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_committer",
          "args": [
            "commit"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_commit_author",
          "args": [
            "commit"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&note->id",
            "note_oid"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "note"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(git_note)"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_new(\n\tgit_note **out,\n\tgit_oid *note_oid,\n\tgit_commit *commit,\n\tgit_blob *blob)\n{\n\tgit_note *note = NULL;\n\n\tnote = git__malloc(sizeof(git_note));\n\tGITERR_CHECK_ALLOC(note);\n\n\tgit_oid_cpy(&note->id, note_oid);\n\n\tif (git_signature_dup(&note->author, git_commit_author(commit)) < 0 ||\n\t\tgit_signature_dup(&note->committer, git_commit_committer(commit)) < 0)\n\t\treturn -1;\n\n\tnote->message = git__strndup(git_blob_rawcontent(blob), git_blob_rawsize(blob));\n\tGITERR_CHECK_ALLOC(note->message);\n\n\t*out = note;\n\treturn 0;\n}"
  },
  {
    "function_name": "note_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "271-307",
    "snippet": "static int note_write(git_oid *out,\n\tgit_repository *repo,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *notes_ref,\n\tconst char *note,\n\tgit_tree *commit_tree,\n\tconst char *target,\n\tgit_commit **parents,\n\tint allow_note_overwrite)\n{\n\tint error;\n\tgit_oid oid;\n\tgit_tree *tree = NULL;\n\n\t// TODO: should we apply filters?\n\t/* create note object */\n\tif ((error = git_blob_create_frombuffer(&oid, repo, note, strlen(note))) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = manipulate_note_in_tree_r(\n\t\t&tree, repo, commit_tree, &oid, target, 0,\n\t\tallow_note_overwrite ? insert_note_in_tree_enotfound_cb : insert_note_in_tree_eexists_cb,\n\t\tinsert_note_in_tree_enotfound_cb)) < 0)\n\t\tgoto cleanup;\n\n\tif (out)\n\t\tgit_oid_cpy(out, &oid);\n\n\terror = git_commit_create(&oid, repo, notes_ref, author, committer,\n\t\t\t\t  NULL, GIT_NOTES_DEFAULT_MSG_ADD,\n\t\t\t\t  tree, *parents == NULL ? 0 : 1, (const git_commit **) parents);\n\ncleanup:\n\tgit_tree_free(tree);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "tree"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_create",
          "args": [
            "&oid",
            "repo",
            "notes_ref",
            "author",
            "committer",
            "NULL",
            "GIT_NOTES_DEFAULT_MSG_ADD",
            "tree",
            "*parents == NULL ? 0 : 1",
            "(const git_commit **) parents"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "240-260",
          "snippet": "int git_commit_create(\n\tgit_oid *id,\n\tgit_repository *repo,\n\tconst char *update_ref,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message,\n\tconst git_tree *tree,\n\tsize_t parent_count,\n\tconst git_commit *parents[])\n{\n\tcommit_parent_data data = { parent_count, parents, repo };\n\n\tassert(tree && git_tree_owner(tree) == repo);\n\n\treturn git_commit__create_internal(\n\t\tid, repo, update_ref, author, committer,\n\t\tmessage_encoding, message, git_tree_id(tree),\n\t\tcommit_parent_from_array, &data, false);\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_commit_create(\n\tgit_oid *id,\n\tgit_repository *repo,\n\tconst char *update_ref,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message,\n\tconst git_tree *tree,\n\tsize_t parent_count,\n\tconst git_commit *parents[])\n{\n\tcommit_parent_data data = { parent_count, parents, repo };\n\n\tassert(tree && git_tree_owner(tree) == repo);\n\n\treturn git_commit__create_internal(\n\t\tid, repo, update_ref, author, committer,\n\t\tmessage_encoding, message, git_tree_id(tree),\n\t\tcommit_parent_from_array, &data, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "out",
            "&oid"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "manipulate_note_in_tree_r",
          "args": [
            "&tree",
            "repo",
            "commit_tree",
            "&oid",
            "target",
            "0",
            "allow_note_overwrite ? insert_note_in_tree_enotfound_cb : insert_note_in_tree_eexists_cb",
            "insert_note_in_tree_enotfound_cb"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "manipulate_note_in_tree_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "132-197",
          "snippet": "static int manipulate_note_in_tree_r(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint (*note_exists_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error),\n\tint (*note_notfound_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error))\n{\n\tint error;\n\tgit_tree *subtree = NULL, *new = NULL;\n\tchar subtree_name[3];\n\n\terror = find_subtree_in_current_level(\n\t\t&subtree, repo, parent, annotated_object_sha, fanout);\n\n\tif (error == GIT_EEXISTS) {\n\t\terror = note_exists_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error == GIT_ENOTFOUND) {\n\t\terror = note_notfound_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\t/* An existing fanout has been found, let's dig deeper */\n\terror = manipulate_note_in_tree_r(\n\t\t&new, repo, subtree, note_oid, annotated_object_sha,\n\t\tfanout + 2, note_exists_cb, note_notfound_cb);\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tstrncpy(subtree_name, annotated_object_sha + fanout, 2);\n\tsubtree_name[2] = '\\0';\n\n\terror = tree_write(out, repo, parent, git_tree_id(new),\n\t\t\t   subtree_name, GIT_FILEMODE_TREE);\n\n\ncleanup:\n\tgit_tree_free(new);\n\tgit_tree_free(subtree);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int manipulate_note_in_tree_r(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint (*note_exists_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error),\n\tint (*note_notfound_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error))\n{\n\tint error;\n\tgit_tree *subtree = NULL, *new = NULL;\n\tchar subtree_name[3];\n\n\terror = find_subtree_in_current_level(\n\t\t&subtree, repo, parent, annotated_object_sha, fanout);\n\n\tif (error == GIT_EEXISTS) {\n\t\terror = note_exists_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error == GIT_ENOTFOUND) {\n\t\terror = note_notfound_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\t/* An existing fanout has been found, let's dig deeper */\n\terror = manipulate_note_in_tree_r(\n\t\t&new, repo, subtree, note_oid, annotated_object_sha,\n\t\tfanout + 2, note_exists_cb, note_notfound_cb);\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tstrncpy(subtree_name, annotated_object_sha + fanout, 2);\n\tsubtree_name[2] = '\\0';\n\n\terror = tree_write(out, repo, parent, git_tree_id(new),\n\t\t\t   subtree_name, GIT_FILEMODE_TREE);\n\n\ncleanup:\n\tgit_tree_free(new);\n\tgit_tree_free(subtree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_create_frombuffer",
          "args": [
            "&oid",
            "repo",
            "note",
            "strlen(note)"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_create_frombuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blob.c",
          "lines": "53-71",
          "snippet": "int git_blob_create_frombuffer(\n\tgit_oid *id, git_repository *repo, const void *buffer, size_t len)\n{\n\tint error;\n\tgit_odb *odb;\n\tgit_odb_stream *stream;\n\n\tassert(id && repo);\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0 ||\n\t\t(error = git_odb_open_wstream(&stream, odb, len, GIT_OBJ_BLOB)) < 0)\n\t\treturn error;\n\n\tif ((error = git_odb_stream_write(stream, buffer, len)) == 0)\n\t\terror = git_odb_stream_finalize_write(id, stream);\n\n\tgit_odb_stream_free(stream);\n\treturn error;\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"filter.h\"",
            "#include \"blob.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"filter.h\"\n#include \"blob.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_blob_create_frombuffer(\n\tgit_oid *id, git_repository *repo, const void *buffer, size_t len)\n{\n\tint error;\n\tgit_odb *odb;\n\tgit_odb_stream *stream;\n\n\tassert(id && repo);\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0 ||\n\t\t(error = git_odb_open_wstream(&stream, odb, len, GIT_OBJ_BLOB)) < 0)\n\t\treturn error;\n\n\tif ((error = git_odb_stream_write(stream, buffer, len)) == 0)\n\t\terror = git_odb_stream_finalize_write(id, stream);\n\n\tgit_odb_stream_free(stream);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "note"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_write(git_oid *out,\n\tgit_repository *repo,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *notes_ref,\n\tconst char *note,\n\tgit_tree *commit_tree,\n\tconst char *target,\n\tgit_commit **parents,\n\tint allow_note_overwrite)\n{\n\tint error;\n\tgit_oid oid;\n\tgit_tree *tree = NULL;\n\n\t// TODO: should we apply filters?\n\t/* create note object */\n\tif ((error = git_blob_create_frombuffer(&oid, repo, note, strlen(note))) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = manipulate_note_in_tree_r(\n\t\t&tree, repo, commit_tree, &oid, target, 0,\n\t\tallow_note_overwrite ? insert_note_in_tree_enotfound_cb : insert_note_in_tree_eexists_cb,\n\t\tinsert_note_in_tree_enotfound_cb)) < 0)\n\t\tgoto cleanup;\n\n\tif (out)\n\t\tgit_oid_cpy(out, &oid);\n\n\terror = git_commit_create(&oid, repo, notes_ref, author, committer,\n\t\t\t\t  NULL, GIT_NOTES_DEFAULT_MSG_ADD,\n\t\t\t\t  tree, *parents == NULL ? 0 : 1, (const git_commit **) parents);\n\ncleanup:\n\tgit_tree_free(tree);\n\treturn error;\n}"
  },
  {
    "function_name": "insert_note_in_tree_enotfound_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "251-269",
    "snippet": "static int insert_note_in_tree_enotfound_cb(git_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint current_error)\n{\n\tGIT_UNUSED(current_error);\n\n\t/* No existing fanout at this level, insert in place */\n\treturn tree_write(\n\t\tout,\n\t\trepo,\n\t\tparent,\n\t\tnote_oid,\n\t\tannotated_object_sha + fanout,\n\t\tGIT_FILEMODE_BLOB);\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tree_write",
          "args": [
            "out",
            "repo",
            "parent",
            "note_oid",
            "annotated_object_sha + fanout",
            "GIT_FILEMODE_BLOB"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "tree_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "97-130",
          "snippet": "static int tree_write(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *source_tree,\n\tconst git_oid *object_oid,\n\tconst char *treeentry_name,\n\tunsigned int attributes)\n{\n\tint error;\n\tgit_treebuilder *tb = NULL;\n\tconst git_tree_entry *entry;\n\tgit_oid tree_oid;\n\n\tif ((error = git_treebuilder_new(&tb, repo, source_tree)) < 0)\n\t\tgoto cleanup;\n\n\tif (object_oid) {\n\t\tif ((error = git_treebuilder_insert(\n\t\t\t\t&entry, tb, treeentry_name, object_oid, attributes)) < 0)\n\t\t\tgoto cleanup;\n\t} else {\n\t\tif ((error = git_treebuilder_remove(tb, treeentry_name)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_treebuilder_write(&tree_oid, tb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_tree_lookup(out, repo, &tree_oid);\n\ncleanup:\n\tgit_treebuilder_free(tb);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int tree_write(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *source_tree,\n\tconst git_oid *object_oid,\n\tconst char *treeentry_name,\n\tunsigned int attributes)\n{\n\tint error;\n\tgit_treebuilder *tb = NULL;\n\tconst git_tree_entry *entry;\n\tgit_oid tree_oid;\n\n\tif ((error = git_treebuilder_new(&tb, repo, source_tree)) < 0)\n\t\tgoto cleanup;\n\n\tif (object_oid) {\n\t\tif ((error = git_treebuilder_insert(\n\t\t\t\t&entry, tb, treeentry_name, object_oid, attributes)) < 0)\n\t\t\tgoto cleanup;\n\t} else {\n\t\tif ((error = git_treebuilder_remove(tb, treeentry_name)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_treebuilder_write(&tree_oid, tb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_tree_lookup(out, repo, &tree_oid);\n\ncleanup:\n\tgit_treebuilder_free(tb);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "current_error"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int insert_note_in_tree_enotfound_cb(git_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint current_error)\n{\n\tGIT_UNUSED(current_error);\n\n\t/* No existing fanout at this level, insert in place */\n\treturn tree_write(\n\t\tout,\n\t\trepo,\n\t\tparent,\n\t\tnote_oid,\n\t\tannotated_object_sha + fanout,\n\t\tGIT_FILEMODE_BLOB);\n}"
  },
  {
    "function_name": "insert_note_in_tree_eexists_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "233-249",
    "snippet": "static int insert_note_in_tree_eexists_cb(git_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint current_error)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(repo);\n\tGIT_UNUSED(parent);\n\tGIT_UNUSED(note_oid);\n\tGIT_UNUSED(fanout);\n\n\tgiterr_set(GITERR_REPOSITORY, \"Note for '%s' exists already\", annotated_object_sha);\n\treturn current_error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"Note for '%s' exists already\"",
            "annotated_object_sha"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "fanout"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "note_oid"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "parent"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "repo"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "out"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int insert_note_in_tree_eexists_cb(git_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint current_error)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(repo);\n\tGIT_UNUSED(parent);\n\tGIT_UNUSED(note_oid);\n\tGIT_UNUSED(fanout);\n\n\tgiterr_set(GITERR_REPOSITORY, \"Note for '%s' exists already\", annotated_object_sha);\n\treturn current_error;\n}"
  },
  {
    "function_name": "remove_note_in_tree_enotfound_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "214-231",
    "snippet": "static int remove_note_in_tree_enotfound_cb(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint current_error)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(repo);\n\tGIT_UNUSED(parent);\n\tGIT_UNUSED(note_oid);\n\tGIT_UNUSED(fanout);\n\n\tgiterr_set(GITERR_REPOSITORY, \"Object '%s' has no note\", annotated_object_sha);\n\treturn current_error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"Object '%s' has no note\"",
            "annotated_object_sha"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "fanout"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "note_oid"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "parent"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "repo"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "out"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int remove_note_in_tree_enotfound_cb(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint current_error)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(repo);\n\tGIT_UNUSED(parent);\n\tGIT_UNUSED(note_oid);\n\tGIT_UNUSED(fanout);\n\n\tgiterr_set(GITERR_REPOSITORY, \"Object '%s' has no note\", annotated_object_sha);\n\treturn current_error;\n}"
  },
  {
    "function_name": "remove_note_in_tree_eexists_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "199-212",
    "snippet": "static int remove_note_in_tree_eexists_cb(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint current_error)\n{\n\tGIT_UNUSED(note_oid);\n\tGIT_UNUSED(current_error);\n\n\treturn tree_write(out, repo, parent, NULL, annotated_object_sha + fanout, 0);\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tree_write",
          "args": [
            "out",
            "repo",
            "parent",
            "NULL",
            "annotated_object_sha + fanout",
            "0"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "tree_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "97-130",
          "snippet": "static int tree_write(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *source_tree,\n\tconst git_oid *object_oid,\n\tconst char *treeentry_name,\n\tunsigned int attributes)\n{\n\tint error;\n\tgit_treebuilder *tb = NULL;\n\tconst git_tree_entry *entry;\n\tgit_oid tree_oid;\n\n\tif ((error = git_treebuilder_new(&tb, repo, source_tree)) < 0)\n\t\tgoto cleanup;\n\n\tif (object_oid) {\n\t\tif ((error = git_treebuilder_insert(\n\t\t\t\t&entry, tb, treeentry_name, object_oid, attributes)) < 0)\n\t\t\tgoto cleanup;\n\t} else {\n\t\tif ((error = git_treebuilder_remove(tb, treeentry_name)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_treebuilder_write(&tree_oid, tb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_tree_lookup(out, repo, &tree_oid);\n\ncleanup:\n\tgit_treebuilder_free(tb);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int tree_write(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *source_tree,\n\tconst git_oid *object_oid,\n\tconst char *treeentry_name,\n\tunsigned int attributes)\n{\n\tint error;\n\tgit_treebuilder *tb = NULL;\n\tconst git_tree_entry *entry;\n\tgit_oid tree_oid;\n\n\tif ((error = git_treebuilder_new(&tb, repo, source_tree)) < 0)\n\t\tgoto cleanup;\n\n\tif (object_oid) {\n\t\tif ((error = git_treebuilder_insert(\n\t\t\t\t&entry, tb, treeentry_name, object_oid, attributes)) < 0)\n\t\t\tgoto cleanup;\n\t} else {\n\t\tif ((error = git_treebuilder_remove(tb, treeentry_name)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_treebuilder_write(&tree_oid, tb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_tree_lookup(out, repo, &tree_oid);\n\ncleanup:\n\tgit_treebuilder_free(tb);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "current_error"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "note_oid"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int remove_note_in_tree_eexists_cb(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint current_error)\n{\n\tGIT_UNUSED(note_oid);\n\tGIT_UNUSED(current_error);\n\n\treturn tree_write(out, repo, parent, NULL, annotated_object_sha + fanout, 0);\n}"
  },
  {
    "function_name": "manipulate_note_in_tree_r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "132-197",
    "snippet": "static int manipulate_note_in_tree_r(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint (*note_exists_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error),\n\tint (*note_notfound_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error))\n{\n\tint error;\n\tgit_tree *subtree = NULL, *new = NULL;\n\tchar subtree_name[3];\n\n\terror = find_subtree_in_current_level(\n\t\t&subtree, repo, parent, annotated_object_sha, fanout);\n\n\tif (error == GIT_EEXISTS) {\n\t\terror = note_exists_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error == GIT_ENOTFOUND) {\n\t\terror = note_notfound_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\t/* An existing fanout has been found, let's dig deeper */\n\terror = manipulate_note_in_tree_r(\n\t\t&new, repo, subtree, note_oid, annotated_object_sha,\n\t\tfanout + 2, note_exists_cb, note_notfound_cb);\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tstrncpy(subtree_name, annotated_object_sha + fanout, 2);\n\tsubtree_name[2] = '\\0';\n\n\terror = tree_write(out, repo, parent, git_tree_id(new),\n\t\t\t   subtree_name, GIT_FILEMODE_TREE);\n\n\ncleanup:\n\tgit_tree_free(new);\n\tgit_tree_free(subtree);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "subtree"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tree_write",
          "args": [
            "out",
            "repo",
            "parent",
            "git_tree_id(new)",
            "subtree_name",
            "GIT_FILEMODE_TREE"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "tree_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "97-130",
          "snippet": "static int tree_write(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *source_tree,\n\tconst git_oid *object_oid,\n\tconst char *treeentry_name,\n\tunsigned int attributes)\n{\n\tint error;\n\tgit_treebuilder *tb = NULL;\n\tconst git_tree_entry *entry;\n\tgit_oid tree_oid;\n\n\tif ((error = git_treebuilder_new(&tb, repo, source_tree)) < 0)\n\t\tgoto cleanup;\n\n\tif (object_oid) {\n\t\tif ((error = git_treebuilder_insert(\n\t\t\t\t&entry, tb, treeentry_name, object_oid, attributes)) < 0)\n\t\t\tgoto cleanup;\n\t} else {\n\t\tif ((error = git_treebuilder_remove(tb, treeentry_name)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_treebuilder_write(&tree_oid, tb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_tree_lookup(out, repo, &tree_oid);\n\ncleanup:\n\tgit_treebuilder_free(tb);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int tree_write(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *source_tree,\n\tconst git_oid *object_oid,\n\tconst char *treeentry_name,\n\tunsigned int attributes)\n{\n\tint error;\n\tgit_treebuilder *tb = NULL;\n\tconst git_tree_entry *entry;\n\tgit_oid tree_oid;\n\n\tif ((error = git_treebuilder_new(&tb, repo, source_tree)) < 0)\n\t\tgoto cleanup;\n\n\tif (object_oid) {\n\t\tif ((error = git_treebuilder_insert(\n\t\t\t\t&entry, tb, treeentry_name, object_oid, attributes)) < 0)\n\t\t\tgoto cleanup;\n\t} else {\n\t\tif ((error = git_treebuilder_remove(tb, treeentry_name)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_treebuilder_write(&tree_oid, tb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_tree_lookup(out, repo, &tree_oid);\n\ncleanup:\n\tgit_treebuilder_free(tb);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_id",
          "args": [
            "new"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "64-67",
          "snippet": "const git_oid *git_tree_id(const git_tree *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_tree_id(const git_tree *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "subtree_name",
            "annotated_object_sha + fanout",
            "2"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "manipulate_note_in_tree_r",
          "args": [
            "&new",
            "repo",
            "subtree",
            "note_oid",
            "annotated_object_sha",
            "fanout + 2",
            "note_exists_cb",
            "note_notfound_cb"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "manipulate_note_in_tree_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "132-197",
          "snippet": "static int manipulate_note_in_tree_r(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint (*note_exists_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error),\n\tint (*note_notfound_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error))\n{\n\tint error;\n\tgit_tree *subtree = NULL, *new = NULL;\n\tchar subtree_name[3];\n\n\terror = find_subtree_in_current_level(\n\t\t&subtree, repo, parent, annotated_object_sha, fanout);\n\n\tif (error == GIT_EEXISTS) {\n\t\terror = note_exists_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error == GIT_ENOTFOUND) {\n\t\terror = note_notfound_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\t/* An existing fanout has been found, let's dig deeper */\n\terror = manipulate_note_in_tree_r(\n\t\t&new, repo, subtree, note_oid, annotated_object_sha,\n\t\tfanout + 2, note_exists_cb, note_notfound_cb);\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tstrncpy(subtree_name, annotated_object_sha + fanout, 2);\n\tsubtree_name[2] = '\\0';\n\n\terror = tree_write(out, repo, parent, git_tree_id(new),\n\t\t\t   subtree_name, GIT_FILEMODE_TREE);\n\n\ncleanup:\n\tgit_tree_free(new);\n\tgit_tree_free(subtree);\n\treturn error;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "note_notfound_cb",
          "args": [
            "out",
            "repo",
            "parent",
            "note_oid",
            "annotated_object_sha",
            "fanout",
            "error"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "note_exists_cb",
          "args": [
            "out",
            "repo",
            "parent",
            "note_oid",
            "annotated_object_sha",
            "fanout",
            "error"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_subtree_in_current_level",
          "args": [
            "&subtree",
            "repo",
            "parent",
            "annotated_object_sha",
            "fanout"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "find_subtree_in_current_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "22-54",
          "snippet": "static int find_subtree_in_current_level(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tconst char *annotated_object_sha,\n\tint fanout)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\t*out = NULL;\n\n\tif (parent == NULL)\n\t\treturn note_error_notfound();\n\n\tfor (i = 0; i < git_tree_entrycount(parent); i++) {\n\t\tentry = git_tree_entry_byindex(parent, i);\n\n\t\tif (!git__ishex(git_tree_entry_name(entry)))\n\t\t\tcontinue;\n\n\t\tif (S_ISDIR(git_tree_entry_filemode(entry))\n\t\t\t&& strlen(git_tree_entry_name(entry)) == 2\n\t\t\t&& !strncmp(git_tree_entry_name(entry), annotated_object_sha + fanout, 2))\n\t\t\treturn git_tree_lookup(out, repo, git_tree_entry_id(entry));\n\n\t\t/* Not a DIR, so do we have an already existing blob? */\n\t\tif (!strcmp(git_tree_entry_name(entry), annotated_object_sha + fanout))\n\t\t\treturn GIT_EEXISTS;\n\t}\n\n\treturn note_error_notfound();\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int find_subtree_in_current_level(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tconst char *annotated_object_sha,\n\tint fanout)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\t*out = NULL;\n\n\tif (parent == NULL)\n\t\treturn note_error_notfound();\n\n\tfor (i = 0; i < git_tree_entrycount(parent); i++) {\n\t\tentry = git_tree_entry_byindex(parent, i);\n\n\t\tif (!git__ishex(git_tree_entry_name(entry)))\n\t\t\tcontinue;\n\n\t\tif (S_ISDIR(git_tree_entry_filemode(entry))\n\t\t\t&& strlen(git_tree_entry_name(entry)) == 2\n\t\t\t&& !strncmp(git_tree_entry_name(entry), annotated_object_sha + fanout, 2))\n\t\t\treturn git_tree_lookup(out, repo, git_tree_entry_id(entry));\n\n\t\t/* Not a DIR, so do we have an already existing blob? */\n\t\tif (!strcmp(git_tree_entry_name(entry), annotated_object_sha + fanout))\n\t\t\treturn GIT_EEXISTS;\n\t}\n\n\treturn note_error_notfound();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int manipulate_note_in_tree_r(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tgit_oid *note_oid,\n\tconst char *annotated_object_sha,\n\tint fanout,\n\tint (*note_exists_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error),\n\tint (*note_notfound_cb)(\n\t\tgit_tree **out,\n\t\tgit_repository *repo,\n\t\tgit_tree *parent,\n\t\tgit_oid *note_oid,\n\t\tconst char *annotated_object_sha,\n\t\tint fanout,\n\t\tint current_error))\n{\n\tint error;\n\tgit_tree *subtree = NULL, *new = NULL;\n\tchar subtree_name[3];\n\n\terror = find_subtree_in_current_level(\n\t\t&subtree, repo, parent, annotated_object_sha, fanout);\n\n\tif (error == GIT_EEXISTS) {\n\t\terror = note_exists_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error == GIT_ENOTFOUND) {\n\t\terror = note_notfound_cb(\n\t\t\tout, repo, parent, note_oid, annotated_object_sha, fanout, error);\n\t\tgoto cleanup;\n\t}\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\t/* An existing fanout has been found, let's dig deeper */\n\terror = manipulate_note_in_tree_r(\n\t\t&new, repo, subtree, note_oid, annotated_object_sha,\n\t\tfanout + 2, note_exists_cb, note_notfound_cb);\n\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\tstrncpy(subtree_name, annotated_object_sha + fanout, 2);\n\tsubtree_name[2] = '\\0';\n\n\terror = tree_write(out, repo, parent, git_tree_id(new),\n\t\t\t   subtree_name, GIT_FILEMODE_TREE);\n\n\ncleanup:\n\tgit_tree_free(new);\n\tgit_tree_free(subtree);\n\treturn error;\n}"
  },
  {
    "function_name": "tree_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "97-130",
    "snippet": "static int tree_write(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *source_tree,\n\tconst git_oid *object_oid,\n\tconst char *treeentry_name,\n\tunsigned int attributes)\n{\n\tint error;\n\tgit_treebuilder *tb = NULL;\n\tconst git_tree_entry *entry;\n\tgit_oid tree_oid;\n\n\tif ((error = git_treebuilder_new(&tb, repo, source_tree)) < 0)\n\t\tgoto cleanup;\n\n\tif (object_oid) {\n\t\tif ((error = git_treebuilder_insert(\n\t\t\t\t&entry, tb, treeentry_name, object_oid, attributes)) < 0)\n\t\t\tgoto cleanup;\n\t} else {\n\t\tif ((error = git_treebuilder_remove(tb, treeentry_name)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_treebuilder_write(&tree_oid, tb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_tree_lookup(out, repo, &tree_oid);\n\ncleanup:\n\tgit_treebuilder_free(tb);\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_treebuilder_free",
          "args": [
            "tb"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "878-886",
          "snippet": "void git_treebuilder_free(git_treebuilder *bld)\n{\n\tif (bld == NULL)\n\t\treturn;\n\n\tgit_treebuilder_clear(bld);\n\tgit_strmap_free(bld->map);\n\tgit__free(bld);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_treebuilder_free(git_treebuilder *bld)\n{\n\tif (bld == NULL)\n\t\treturn;\n\n\tgit_treebuilder_clear(bld);\n\tgit_strmap_free(bld->map);\n\tgit__free(bld);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_lookup",
          "args": [
            "out",
            "repo",
            "&tree_oid"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "49-52",
          "snippet": "int git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_treebuilder_write",
          "args": [
            "&tree_oid",
            "tb"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "803-848",
          "snippet": "int git_treebuilder_write(git_oid *oid, git_treebuilder *bld)\n{\n\tint error = 0;\n\tsize_t i, entrycount;\n\tgit_buf tree = GIT_BUF_INIT;\n\tgit_odb *odb;\n\tgit_tree_entry *entry;\n\tgit_vector entries;\n\n\tassert(bld);\n\n\tentrycount = git_strmap_num_entries(bld->map);\n\tif (git_vector_init(&entries, entrycount, entry_sort_cmp) < 0)\n\t\treturn -1;\n\n\tgit_strmap_foreach_value(bld->map, entry, {\n\t\tif (git_vector_insert(&entries, entry) < 0)\n\t\t\treturn -1;\n\t});\n\n\tgit_vector_sort(&entries);\n\n\t/* Grow the buffer beforehand to an estimated size */\n\terror = git_buf_grow(&tree, entrycount * 72);\n\n\tfor (i = 0; i < entries.length && !error; ++i) {\n\t\tgit_tree_entry *entry = git_vector_get(&entries, i);\n\n\t\tgit_buf_printf(&tree, \"%o \", entry->attr);\n\t\tgit_buf_put(&tree, entry->filename, entry->filename_len + 1);\n\t\tgit_buf_put(&tree, (char *)entry->oid->id, GIT_OID_RAWSZ);\n\n\t\tif (git_buf_oom(&tree))\n\t\t\terror = -1;\n\t}\n\n\n\tif (!error &&\n\t\t!(error = git_repository_odb__weakptr(&odb, bld->repo)))\n\t\terror = git_odb_write(oid, odb, tree.ptr, tree.size, GIT_OBJ_TREE);\n\n\tgit_buf_free(&tree);\n\tgit_vector_free(&entries);\n\n\treturn error;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_write(git_oid *oid, git_treebuilder *bld)\n{\n\tint error = 0;\n\tsize_t i, entrycount;\n\tgit_buf tree = GIT_BUF_INIT;\n\tgit_odb *odb;\n\tgit_tree_entry *entry;\n\tgit_vector entries;\n\n\tassert(bld);\n\n\tentrycount = git_strmap_num_entries(bld->map);\n\tif (git_vector_init(&entries, entrycount, entry_sort_cmp) < 0)\n\t\treturn -1;\n\n\tgit_strmap_foreach_value(bld->map, entry, {\n\t\tif (git_vector_insert(&entries, entry) < 0)\n\t\t\treturn -1;\n\t});\n\n\tgit_vector_sort(&entries);\n\n\t/* Grow the buffer beforehand to an estimated size */\n\terror = git_buf_grow(&tree, entrycount * 72);\n\n\tfor (i = 0; i < entries.length && !error; ++i) {\n\t\tgit_tree_entry *entry = git_vector_get(&entries, i);\n\n\t\tgit_buf_printf(&tree, \"%o \", entry->attr);\n\t\tgit_buf_put(&tree, entry->filename, entry->filename_len + 1);\n\t\tgit_buf_put(&tree, (char *)entry->oid->id, GIT_OID_RAWSZ);\n\n\t\tif (git_buf_oom(&tree))\n\t\t\terror = -1;\n\t}\n\n\n\tif (!error &&\n\t\t!(error = git_repository_odb__weakptr(&odb, bld->repo)))\n\t\terror = git_odb_write(oid, odb, tree.ptr, tree.size, GIT_OBJ_TREE);\n\n\tgit_buf_free(&tree);\n\tgit_vector_free(&entries);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_treebuilder_remove",
          "args": [
            "tb",
            "treeentry_name"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "790-801",
          "snippet": "int git_treebuilder_remove(git_treebuilder *bld, const char *filename)\n{\n\tgit_tree_entry *entry = treebuilder_get(bld, filename);\n\n\tif (entry == NULL)\n\t\treturn tree_error(\"Failed to remove entry. File isn't in the tree\", filename);\n\n\tgit_strmap_delete(bld->map, filename);\n\tgit_tree_entry_free(entry);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_remove(git_treebuilder *bld, const char *filename)\n{\n\tgit_tree_entry *entry = treebuilder_get(bld, filename);\n\n\tif (entry == NULL)\n\t\treturn tree_error(\"Failed to remove entry. File isn't in the tree\", filename);\n\n\tgit_strmap_delete(bld->map, filename);\n\tgit_tree_entry_free(entry);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_treebuilder_insert",
          "args": [
            "&entry",
            "tb",
            "treeentry_name",
            "object_oid",
            "attributes"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "723-769",
          "snippet": "int git_treebuilder_insert(\n\tconst git_tree_entry **entry_out,\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error;\n\tgit_strmap_iter pos;\n\n\tassert(bld && id && filename);\n\n\tif (!valid_filemode(filemode))\n\t\treturn tree_error(\"Failed to insert entry. Invalid filemode for file\", filename);\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tif (filemode != GIT_FILEMODE_COMMIT &&\n\t    !git_object__is_valid(bld->repo, id, otype_from_mode(filemode)))\n\t\treturn tree_error(\"Failed to insert entry; invalid object specified\", filename);\n\n\tpos = git_strmap_lookup_index(bld->map, filename);\n\tif (git_strmap_valid_index(bld->map, pos)) {\n\t\tentry = git_strmap_value_at(bld->map, pos);\n\t\tgit_oid_cpy((git_oid *) entry->oid, id);\n\t} else {\n\t\tentry = alloc_entry(filename, strlen(filename), id);\n\t\tGITERR_CHECK_ALLOC(entry);\n\n\t\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\n\t\tif (error < 0) {\n\t\t\tgit_tree_entry_free(entry);\n\t\t\tgiterr_set(GITERR_TREE, \"failed to insert %s\", filename);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tentry->attr = filemode;\n\n\tif (entry_out)\n\t\t*entry_out = entry;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_insert(\n\tconst git_tree_entry **entry_out,\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error;\n\tgit_strmap_iter pos;\n\n\tassert(bld && id && filename);\n\n\tif (!valid_filemode(filemode))\n\t\treturn tree_error(\"Failed to insert entry. Invalid filemode for file\", filename);\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tif (filemode != GIT_FILEMODE_COMMIT &&\n\t    !git_object__is_valid(bld->repo, id, otype_from_mode(filemode)))\n\t\treturn tree_error(\"Failed to insert entry; invalid object specified\", filename);\n\n\tpos = git_strmap_lookup_index(bld->map, filename);\n\tif (git_strmap_valid_index(bld->map, pos)) {\n\t\tentry = git_strmap_value_at(bld->map, pos);\n\t\tgit_oid_cpy((git_oid *) entry->oid, id);\n\t} else {\n\t\tentry = alloc_entry(filename, strlen(filename), id);\n\t\tGITERR_CHECK_ALLOC(entry);\n\n\t\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\n\t\tif (error < 0) {\n\t\t\tgit_tree_entry_free(entry);\n\t\t\tgiterr_set(GITERR_TREE, \"failed to insert %s\", filename);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tentry->attr = filemode;\n\n\tif (entry_out)\n\t\t*entry_out = entry;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_treebuilder_new",
          "args": [
            "&tb",
            "repo",
            "source_tree"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "671-709",
          "snippet": "int git_treebuilder_new(\n\tgit_treebuilder **builder_p,\n\tgit_repository *repo,\n\tconst git_tree *source)\n{\n\tgit_treebuilder *bld;\n\tsize_t i;\n\n\tassert(builder_p && repo);\n\n\tbld = git__calloc(1, sizeof(git_treebuilder));\n\tGITERR_CHECK_ALLOC(bld);\n\n\tbld->repo = repo;\n\n\tif (git_strmap_alloc(&bld->map) < 0) {\n\t\tgit__free(bld);\n\t\treturn -1;\n\t}\n\n\tif (source != NULL) {\n\t\tgit_tree_entry *entry_src;\n\n\t\tgit_array_foreach(source->entries, i, entry_src) {\n\t\t\tif (append_entry(\n\t\t\t\tbld, entry_src->filename,\n\t\t\t\tentry_src->oid,\n\t\t\t\tentry_src->attr) < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\t*builder_p = bld;\n\treturn 0;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_new(\n\tgit_treebuilder **builder_p,\n\tgit_repository *repo,\n\tconst git_tree *source)\n{\n\tgit_treebuilder *bld;\n\tsize_t i;\n\n\tassert(builder_p && repo);\n\n\tbld = git__calloc(1, sizeof(git_treebuilder));\n\tGITERR_CHECK_ALLOC(bld);\n\n\tbld->repo = repo;\n\n\tif (git_strmap_alloc(&bld->map) < 0) {\n\t\tgit__free(bld);\n\t\treturn -1;\n\t}\n\n\tif (source != NULL) {\n\t\tgit_tree_entry *entry_src;\n\n\t\tgit_array_foreach(source->entries, i, entry_src) {\n\t\t\tif (append_entry(\n\t\t\t\tbld, entry_src->filename,\n\t\t\t\tentry_src->oid,\n\t\t\t\tentry_src->attr) < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\t*builder_p = bld;\n\treturn 0;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int tree_write(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *source_tree,\n\tconst git_oid *object_oid,\n\tconst char *treeentry_name,\n\tunsigned int attributes)\n{\n\tint error;\n\tgit_treebuilder *tb = NULL;\n\tconst git_tree_entry *entry;\n\tgit_oid tree_oid;\n\n\tif ((error = git_treebuilder_new(&tb, repo, source_tree)) < 0)\n\t\tgoto cleanup;\n\n\tif (object_oid) {\n\t\tif ((error = git_treebuilder_insert(\n\t\t\t\t&entry, tb, treeentry_name, object_oid, attributes)) < 0)\n\t\t\tgoto cleanup;\n\t} else {\n\t\tif ((error = git_treebuilder_remove(tb, treeentry_name)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_treebuilder_write(&tree_oid, tb)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_tree_lookup(out, repo, &tree_oid);\n\ncleanup:\n\tgit_treebuilder_free(tb);\n\treturn error;\n}"
  },
  {
    "function_name": "find_blob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "78-95",
    "snippet": "static int find_blob(git_oid *blob, git_tree *tree, const char *target)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\tfor (i=0; i<git_tree_entrycount(tree); i++) {\n\t\tentry = git_tree_entry_byindex(tree, i);\n\n\t\tif (!strcmp(git_tree_entry_name(entry), target)) {\n\t\t\t/* found matching note object - return */\n\n\t\t\tgit_oid_cpy(blob, git_tree_entry_id(entry));\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn note_error_notfound();\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "note_error_notfound",
          "args": [],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "note_error_notfound",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "16-20",
          "snippet": "static int note_error_notfound(void)\n{\n\tgiterr_set(GITERR_INVALID, \"Note could not be found\");\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_error_notfound(void)\n{\n\tgiterr_set(GITERR_INVALID, \"Note could not be found\");\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "blob",
            "git_tree_entry_id(entry)"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_id",
          "args": [
            "entry"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "278-282",
          "snippet": "const git_oid *git_tree_entry_id(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->oid;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_oid *git_tree_entry_id(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "git_tree_entry_name(entry)",
            "target"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_name",
          "args": [
            "entry"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "272-276",
          "snippet": "const char *git_tree_entry_name(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->filename;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst char *git_tree_entry_name(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->filename;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_byindex",
          "args": [
            "tree",
            "i"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_byindex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "324-329",
          "snippet": "const git_tree_entry *git_tree_entry_byindex(\n\tconst git_tree *tree, size_t idx)\n{\n\tassert(tree);\n\treturn git_array_get(tree->entries, idx);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_tree_entry *git_tree_entry_byindex(\n\tconst git_tree *tree, size_t idx)\n{\n\tassert(tree);\n\treturn git_array_get(tree->entries, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entrycount",
          "args": [
            "tree"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entrycount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "382-386",
          "snippet": "size_t git_tree_entrycount(const git_tree *tree)\n{\n\tassert(tree);\n\treturn tree->entries.size;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nsize_t git_tree_entrycount(const git_tree *tree)\n{\n\tassert(tree);\n\treturn tree->entries.size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int find_blob(git_oid *blob, git_tree *tree, const char *target)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\tfor (i=0; i<git_tree_entrycount(tree); i++) {\n\t\tentry = git_tree_entry_byindex(tree, i);\n\n\t\tif (!strcmp(git_tree_entry_name(entry), target)) {\n\t\t\t/* found matching note object - return */\n\n\t\t\tgit_oid_cpy(blob, git_tree_entry_id(entry));\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn note_error_notfound();\n}"
  },
  {
    "function_name": "find_subtree_r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "56-76",
    "snippet": "static int find_subtree_r(git_tree **out, git_tree *root,\n\t\t\tgit_repository *repo, const char *target, int *fanout)\n{\n\tint error;\n\tgit_tree *subtree = NULL;\n\n\t*out = NULL;\n\n\terror = find_subtree_in_current_level(&subtree, repo, root, target, *fanout);\n\tif (error == GIT_EEXISTS)\n\t\treturn git_tree_lookup(out, repo, git_tree_id(root));\n\n\tif (error < 0)\n\t\treturn error;\n\n\t*fanout += 2;\n\terror = find_subtree_r(out, subtree, repo, target, fanout);\n\tgit_tree_free(subtree);\n\n\treturn error;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "subtree"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_subtree_r",
          "args": [
            "out",
            "subtree",
            "repo",
            "target",
            "fanout"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "find_subtree_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "56-76",
          "snippet": "static int find_subtree_r(git_tree **out, git_tree *root,\n\t\t\tgit_repository *repo, const char *target, int *fanout)\n{\n\tint error;\n\tgit_tree *subtree = NULL;\n\n\t*out = NULL;\n\n\terror = find_subtree_in_current_level(&subtree, repo, root, target, *fanout);\n\tif (error == GIT_EEXISTS)\n\t\treturn git_tree_lookup(out, repo, git_tree_id(root));\n\n\tif (error < 0)\n\t\treturn error;\n\n\t*fanout += 2;\n\terror = find_subtree_r(out, subtree, repo, target, fanout);\n\tgit_tree_free(subtree);\n\n\treturn error;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_lookup",
          "args": [
            "out",
            "repo",
            "git_tree_id(root)"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "49-52",
          "snippet": "int git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_id",
          "args": [
            "root"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "64-67",
          "snippet": "const git_oid *git_tree_id(const git_tree *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_tree_id(const git_tree *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_subtree_in_current_level",
          "args": [
            "&subtree",
            "repo",
            "root",
            "target",
            "*fanout"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "find_subtree_in_current_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "22-54",
          "snippet": "static int find_subtree_in_current_level(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tconst char *annotated_object_sha,\n\tint fanout)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\t*out = NULL;\n\n\tif (parent == NULL)\n\t\treturn note_error_notfound();\n\n\tfor (i = 0; i < git_tree_entrycount(parent); i++) {\n\t\tentry = git_tree_entry_byindex(parent, i);\n\n\t\tif (!git__ishex(git_tree_entry_name(entry)))\n\t\t\tcontinue;\n\n\t\tif (S_ISDIR(git_tree_entry_filemode(entry))\n\t\t\t&& strlen(git_tree_entry_name(entry)) == 2\n\t\t\t&& !strncmp(git_tree_entry_name(entry), annotated_object_sha + fanout, 2))\n\t\t\treturn git_tree_lookup(out, repo, git_tree_entry_id(entry));\n\n\t\t/* Not a DIR, so do we have an already existing blob? */\n\t\tif (!strcmp(git_tree_entry_name(entry), annotated_object_sha + fanout))\n\t\t\treturn GIT_EEXISTS;\n\t}\n\n\treturn note_error_notfound();\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int find_subtree_in_current_level(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tconst char *annotated_object_sha,\n\tint fanout)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\t*out = NULL;\n\n\tif (parent == NULL)\n\t\treturn note_error_notfound();\n\n\tfor (i = 0; i < git_tree_entrycount(parent); i++) {\n\t\tentry = git_tree_entry_byindex(parent, i);\n\n\t\tif (!git__ishex(git_tree_entry_name(entry)))\n\t\t\tcontinue;\n\n\t\tif (S_ISDIR(git_tree_entry_filemode(entry))\n\t\t\t&& strlen(git_tree_entry_name(entry)) == 2\n\t\t\t&& !strncmp(git_tree_entry_name(entry), annotated_object_sha + fanout, 2))\n\t\t\treturn git_tree_lookup(out, repo, git_tree_entry_id(entry));\n\n\t\t/* Not a DIR, so do we have an already existing blob? */\n\t\tif (!strcmp(git_tree_entry_name(entry), annotated_object_sha + fanout))\n\t\t\treturn GIT_EEXISTS;\n\t}\n\n\treturn note_error_notfound();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int find_subtree_r(git_tree **out, git_tree *root,\n\t\t\tgit_repository *repo, const char *target, int *fanout)\n{\n\tint error;\n\tgit_tree *subtree = NULL;\n\n\t*out = NULL;\n\n\terror = find_subtree_in_current_level(&subtree, repo, root, target, *fanout);\n\tif (error == GIT_EEXISTS)\n\t\treturn git_tree_lookup(out, repo, git_tree_id(root));\n\n\tif (error < 0)\n\t\treturn error;\n\n\t*fanout += 2;\n\terror = find_subtree_r(out, subtree, repo, target, fanout);\n\tgit_tree_free(subtree);\n\n\treturn error;\n}"
  },
  {
    "function_name": "find_subtree_in_current_level",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "22-54",
    "snippet": "static int find_subtree_in_current_level(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tconst char *annotated_object_sha,\n\tint fanout)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\t*out = NULL;\n\n\tif (parent == NULL)\n\t\treturn note_error_notfound();\n\n\tfor (i = 0; i < git_tree_entrycount(parent); i++) {\n\t\tentry = git_tree_entry_byindex(parent, i);\n\n\t\tif (!git__ishex(git_tree_entry_name(entry)))\n\t\t\tcontinue;\n\n\t\tif (S_ISDIR(git_tree_entry_filemode(entry))\n\t\t\t&& strlen(git_tree_entry_name(entry)) == 2\n\t\t\t&& !strncmp(git_tree_entry_name(entry), annotated_object_sha + fanout, 2))\n\t\t\treturn git_tree_lookup(out, repo, git_tree_entry_id(entry));\n\n\t\t/* Not a DIR, so do we have an already existing blob? */\n\t\tif (!strcmp(git_tree_entry_name(entry), annotated_object_sha + fanout))\n\t\t\treturn GIT_EEXISTS;\n\t}\n\n\treturn note_error_notfound();\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "note_error_notfound",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "note_error_notfound",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "16-20",
          "snippet": "static int note_error_notfound(void)\n{\n\tgiterr_set(GITERR_INVALID, \"Note could not be found\");\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_error_notfound(void)\n{\n\tgiterr_set(GITERR_INVALID, \"Note could not be found\");\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "git_tree_entry_name(entry)",
            "annotated_object_sha + fanout"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_name",
          "args": [
            "entry"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "272-276",
          "snippet": "const char *git_tree_entry_name(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->filename;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst char *git_tree_entry_name(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->filename;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_lookup",
          "args": [
            "out",
            "repo",
            "git_tree_entry_id(entry)"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "49-52",
          "snippet": "int git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_id",
          "args": [
            "entry"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "278-282",
          "snippet": "const git_oid *git_tree_entry_id(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->oid;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_oid *git_tree_entry_id(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "git_tree_entry_name(entry)",
            "annotated_object_sha + fanout",
            "2"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "git__strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "205-212",
          "snippet": "int git__strncmp(const char *a, const char *b, size_t sz)\n{\n\twhile (sz && *a && *b && *a == *b)\n\t\t--sz, ++a, ++b;\n\tif (!sz)\n\t\treturn 0;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strncmp(const char *a, const char *b, size_t sz)\n{\n\twhile (sz && *a && *b && *a == *b)\n\t\t--sz, ++a, ++b;\n\tif (!sz)\n\t\treturn 0;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "git_tree_entry_name(entry)"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "git_tree_entry_filemode(entry)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_tree_entry_filemode",
          "args": [
            "entry"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_filemode_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "267-270",
          "snippet": "git_filemode_t git_tree_entry_filemode_raw(const git_tree_entry *entry)\n{\n\treturn entry->attr;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\ngit_filemode_t git_tree_entry_filemode_raw(const git_tree_entry *entry)\n{\n\treturn entry->attr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__ishex",
          "args": [
            "git_tree_entry_name(entry)"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "git__ishex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "413-420",
          "snippet": "GIT_INLINE(int) git__ishex(const char *str)\n{\n\tunsigned i;\n\tfor (i=0; str[i] != '\\0'; i++)\n\t\tif (git__fromhex(str[i]) < 0)\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__ishex(const char *str)\n{\n\tunsigned i;\n\tfor (i=0; str[i] != '\\0'; i++)\n\t\tif (git__fromhex(str[i]) < 0)\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_byindex",
          "args": [
            "parent",
            "i"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_byindex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "324-329",
          "snippet": "const git_tree_entry *git_tree_entry_byindex(\n\tconst git_tree *tree, size_t idx)\n{\n\tassert(tree);\n\treturn git_array_get(tree->entries, idx);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_tree_entry *git_tree_entry_byindex(\n\tconst git_tree *tree, size_t idx)\n{\n\tassert(tree);\n\treturn git_array_get(tree->entries, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entrycount",
          "args": [
            "parent"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entrycount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "382-386",
          "snippet": "size_t git_tree_entrycount(const git_tree *tree)\n{\n\tassert(tree);\n\treturn tree->entries.size;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nsize_t git_tree_entrycount(const git_tree *tree)\n{\n\tassert(tree);\n\treturn tree->entries.size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int find_subtree_in_current_level(\n\tgit_tree **out,\n\tgit_repository *repo,\n\tgit_tree *parent,\n\tconst char *annotated_object_sha,\n\tint fanout)\n{\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\t*out = NULL;\n\n\tif (parent == NULL)\n\t\treturn note_error_notfound();\n\n\tfor (i = 0; i < git_tree_entrycount(parent); i++) {\n\t\tentry = git_tree_entry_byindex(parent, i);\n\n\t\tif (!git__ishex(git_tree_entry_name(entry)))\n\t\t\tcontinue;\n\n\t\tif (S_ISDIR(git_tree_entry_filemode(entry))\n\t\t\t&& strlen(git_tree_entry_name(entry)) == 2\n\t\t\t&& !strncmp(git_tree_entry_name(entry), annotated_object_sha + fanout, 2))\n\t\t\treturn git_tree_lookup(out, repo, git_tree_entry_id(entry));\n\n\t\t/* Not a DIR, so do we have an already existing blob? */\n\t\tif (!strcmp(git_tree_entry_name(entry), annotated_object_sha + fanout))\n\t\t\treturn GIT_EEXISTS;\n\t}\n\n\treturn note_error_notfound();\n}"
  },
  {
    "function_name": "note_error_notfound",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
    "lines": "16-20",
    "snippet": "static int note_error_notfound(void)\n{\n\tgiterr_set(GITERR_INVALID, \"Note could not be found\");\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include \"signature.h\"",
      "#include \"iterator.h\"",
      "#include \"config.h\"",
      "#include \"refs.h\"",
      "#include \"git2.h\"",
      "#include \"notes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Note could not be found\""
          ],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nstatic int note_error_notfound(void)\n{\n\tgiterr_set(GITERR_INVALID, \"Note could not be found\");\n\treturn GIT_ENOTFOUND;\n}"
  }
]