[
  {
    "function_name": "git_odb_init_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1240-1245",
    "snippet": "int git_odb_init_backend(git_odb_backend *backend, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\tbackend, version, git_odb_backend, GIT_ODB_BACKEND_INIT);\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_INIT_STRUCTURE_FROM_TEMPLATE",
          "args": [
            "backend",
            "version",
            "git_odb_backend",
            "GIT_ODB_BACKEND_INIT"
          ],
          "line": 1242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_init_backend(git_odb_backend *backend, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\tbackend, version, git_odb_backend, GIT_ODB_BACKEND_INIT);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb__error_ambiguous",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1234-1238",
    "snippet": "int git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_ODB",
            "\"Ambiguous SHA1 prefix - %s\"",
            "message"
          ],
          "line": 1236
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}"
  },
  {
    "function_name": "git_odb__error_notfound",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1220-1232",
    "snippet": "int git_odb__error_notfound(\n\tconst char *message, const git_oid *oid, size_t oid_len)\n{\n\tif (oid != NULL) {\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\tgit_oid_tostr(oid_str, oid_len+1, oid);\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s (%.*s)\",\n\t\t\tmessage, oid_len, oid_str);\n\t} else\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s\", message);\n\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_ODB",
            "\"Object not found - %s\"",
            "message"
          ],
          "line": 1229
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_tostr",
          "args": [
            "oid_str",
            "oid_len+1",
            "oid"
          ],
          "line": 1225
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_tostr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "119-131",
          "snippet": "char *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__error_notfound(\n\tconst char *message, const git_oid *oid, size_t oid_len)\n{\n\tif (oid != NULL) {\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\tgit_oid_tostr(oid_str, oid_len+1, oid);\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s (%.*s)\",\n\t\t\tmessage, oid_len, oid_str);\n\t} else\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s\", message);\n\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git_odb_refresh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1201-1218",
    "snippet": "int git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b->refresh",
          "args": [
            "b"
          ],
          "line": 1211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 1207
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb_backend_malloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1195-1199",
    "snippet": "void *git_odb_backend_malloc(git_odb_backend *backend, size_t len)\n{\n\tGIT_UNUSED(backend);\n\treturn git__malloc(len);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "len"
          ],
          "line": 1198
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "backend"
          ],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid *git_odb_backend_malloc(git_odb_backend *backend, size_t len)\n{\n\tGIT_UNUSED(backend);\n\treturn git__malloc(len);\n}"
  },
  {
    "function_name": "git_odb_write_pack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1166-1193",
    "snippet": "int git_odb_write_pack(struct git_odb_writepack **out, git_odb *db, git_transfer_progress_cb progress_cb, void *progress_payload)\n{\n\tsize_t i, writes = 0;\n\tint error = GIT_ERROR;\n\n\tassert(out && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->writepack != NULL) {\n\t\t\t++writes;\n\t\t\terror = b->writepack(out, b, db, progress_cb, progress_payload);\n\t\t}\n\t}\n\n\tif (error == GIT_PASSTHROUGH)\n\t\terror = 0;\n\tif (error < 0 && !writes)\n\t\terror = git_odb__error_unsupported_in_backend(\"write pack\");\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb__error_unsupported_in_backend",
          "args": [
            "\"write pack\""
          ],
          "line": 1190
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_unsupported_in_backend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "450-455",
          "snippet": "static int git_odb__error_unsupported_in_backend(const char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - unsupported in the loaded odb backends\", action);\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int git_odb__error_unsupported_in_backend(const char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - unsupported in the loaded odb backends\", action);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->writepack",
          "args": [
            "out",
            "b",
            "db",
            "progress_cb",
            "progress_payload"
          ],
          "line": 1183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 1174
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && db"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_write_pack(struct git_odb_writepack **out, git_odb *db, git_transfer_progress_cb progress_cb, void *progress_payload)\n{\n\tsize_t i, writes = 0;\n\tint error = GIT_ERROR;\n\n\tassert(out && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->writepack != NULL) {\n\t\t\t++writes;\n\t\t\terror = b->writepack(out, b, db, progress_cb, progress_payload);\n\t\t}\n\t}\n\n\tif (error == GIT_PASSTHROUGH)\n\t\terror = 0;\n\tif (error < 0 && !writes)\n\t\terror = git_odb__error_unsupported_in_backend(\"write pack\");\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_odb_open_rstream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1141-1164",
    "snippet": "int git_odb_open_rstream(git_odb_stream **stream, git_odb *db, const git_oid *oid)\n{\n\tsize_t i, reads = 0;\n\tint error = GIT_ERROR;\n\n\tassert(stream && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->readstream != NULL) {\n\t\t\t++reads;\n\t\t\terror = b->readstream(stream, b, oid);\n\t\t}\n\t}\n\n\tif (error == GIT_PASSTHROUGH)\n\t\terror = 0;\n\tif (error < 0 && !reads)\n\t\terror = git_odb__error_unsupported_in_backend(\"read object streamed\");\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb__error_unsupported_in_backend",
          "args": [
            "\"read object streamed\""
          ],
          "line": 1161
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_unsupported_in_backend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "450-455",
          "snippet": "static int git_odb__error_unsupported_in_backend(const char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - unsupported in the loaded odb backends\", action);\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int git_odb__error_unsupported_in_backend(const char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - unsupported in the loaded odb backends\", action);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->readstream",
          "args": [
            "stream",
            "b",
            "oid"
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "stream && db"
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_open_rstream(git_odb_stream **stream, git_odb *db, const git_oid *oid)\n{\n\tsize_t i, reads = 0;\n\tint error = GIT_ERROR;\n\n\tassert(stream && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->readstream != NULL) {\n\t\t\t++reads;\n\t\t\terror = b->readstream(stream, b, oid);\n\t\t}\n\t}\n\n\tif (error == GIT_PASSTHROUGH)\n\t\terror = 0;\n\tif (error < 0 && !reads)\n\t\terror = git_odb__error_unsupported_in_backend(\"read object streamed\");\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_odb_stream_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1131-1139",
    "snippet": "void git_odb_stream_free(git_odb_stream *stream)\n{\n\tif (stream == NULL)\n\t\treturn;\n\n\tgit_hash_ctx_cleanup(stream->hash_ctx);\n\tgit__free(stream->hash_ctx);\n\tstream->free(stream);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stream->free",
          "args": [
            "stream"
          ],
          "line": 1138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "stream->hash_ctx"
          ],
          "line": 1137
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_hash_ctx_cleanup",
          "args": [
            "stream->hash_ctx"
          ],
          "line": 1136
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_ctx_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "268-276",
          "snippet": "void git_hash_ctx_cleanup(git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\n\tif (ctx->type == CNG)\n\t\thash_ctx_cng_cleanup(ctx);\n\telse if(ctx->type == CRYPTOAPI)\n\t\thash_ctx_cryptoapi_cleanup(ctx);\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid git_hash_ctx_cleanup(git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\n\tif (ctx->type == CNG)\n\t\thash_ctx_cng_cleanup(ctx);\n\telse if(ctx->type == CRYPTOAPI)\n\t\thash_ctx_cryptoapi_cleanup(ctx);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_stream_free(git_odb_stream *stream)\n{\n\tif (stream == NULL)\n\t\treturn;\n\n\tgit_hash_ctx_cleanup(stream->hash_ctx);\n\tgit__free(stream->hash_ctx);\n\tstream->free(stream);\n}"
  },
  {
    "function_name": "git_odb_stream_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1126-1129",
    "snippet": "int git_odb_stream_read(git_odb_stream *stream, char *buffer, size_t len)\n{\n\treturn stream->read(stream, buffer, len);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stream->read",
          "args": [
            "stream",
            "buffer",
            "len"
          ],
          "line": 1128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_stream_read(git_odb_stream *stream, char *buffer, size_t len)\n{\n\treturn stream->read(stream, buffer, len);\n}"
  },
  {
    "function_name": "git_odb_stream_finalize_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1112-1124",
    "snippet": "int git_odb_stream_finalize_write(git_oid *out, git_odb_stream *stream)\n{\n\tif (stream->received_bytes != stream->declared_size)\n\t\treturn git_odb_stream__invalid_length(stream,\n\t\t\t\"stream_finalize_write()\");\n\n\tgit_hash_final(out, stream->hash_ctx);\n\n\tif (git_odb_exists(stream->backend->odb, out))\n\t\treturn 0;\n\n\treturn stream->finalize_write(stream, out);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stream->finalize_write",
          "args": [
            "stream",
            "out"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_odb_exists",
          "args": [
            "stream->backend->odb",
            "out"
          ],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "646-665",
          "snippet": "int git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_hash_final",
          "args": [
            "out",
            "stream->hash_ctx"
          ],
          "line": 1118
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_openssl.h",
          "lines": "37-42",
          "snippet": "GIT_INLINE(int) git_hash_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\tSHA1_Final(out->id, &ctx->c);\n\treturn 0;\n}",
          "includes": [
            "#include <openssl/sha.h>",
            "#include \"hash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/sha.h>\n#include \"hash.h\"\n\nGIT_INLINE(int) git_hash_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\tSHA1_Final(out->id, &ctx->c);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_stream__invalid_length",
          "args": [
            "stream",
            "\"stream_finalize_write()\""
          ],
          "line": 1115
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_stream__invalid_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1086-1097",
          "snippet": "static int git_odb_stream__invalid_length(\n\tconst git_odb_stream *stream,\n\tconst char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - \"\n\t\t\"Invalid length. %\"PRIuZ\" was expected. The \"\n\t\t\"total size of the received chunks amounts to %\"PRIuZ\".\",\n\t\taction, stream->declared_size, stream->received_bytes);\t\t\n\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int git_odb_stream__invalid_length(\n\tconst git_odb_stream *stream,\n\tconst char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - \"\n\t\t\"Invalid length. %\"PRIuZ\" was expected. The \"\n\t\t\"total size of the received chunks amounts to %\"PRIuZ\".\",\n\t\taction, stream->declared_size, stream->received_bytes);\t\t\n\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_stream_finalize_write(git_oid *out, git_odb_stream *stream)\n{\n\tif (stream->received_bytes != stream->declared_size)\n\t\treturn git_odb_stream__invalid_length(stream,\n\t\t\t\"stream_finalize_write()\");\n\n\tgit_hash_final(out, stream->hash_ctx);\n\n\tif (git_odb_exists(stream->backend->odb, out))\n\t\treturn 0;\n\n\treturn stream->finalize_write(stream, out);\n}"
  },
  {
    "function_name": "git_odb_stream_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1099-1110",
    "snippet": "int git_odb_stream_write(git_odb_stream *stream, const char *buffer, size_t len)\n{\n\tgit_hash_update(stream->hash_ctx, buffer, len);\n\n\tstream->received_bytes += len;\n\n\tif (stream->received_bytes > stream->declared_size)\n\t\treturn git_odb_stream__invalid_length(stream,\n\t\t\t\"stream_write()\");\n\n\treturn stream->write(stream, buffer, len);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stream->write",
          "args": [
            "stream",
            "buffer",
            "len"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_odb_stream__invalid_length",
          "args": [
            "stream",
            "\"stream_write()\""
          ],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_stream__invalid_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1086-1097",
          "snippet": "static int git_odb_stream__invalid_length(\n\tconst git_odb_stream *stream,\n\tconst char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - \"\n\t\t\"Invalid length. %\"PRIuZ\" was expected. The \"\n\t\t\"total size of the received chunks amounts to %\"PRIuZ\".\",\n\t\taction, stream->declared_size, stream->received_bytes);\t\t\n\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int git_odb_stream__invalid_length(\n\tconst git_odb_stream *stream,\n\tconst char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - \"\n\t\t\"Invalid length. %\"PRIuZ\" was expected. The \"\n\t\t\"total size of the received chunks amounts to %\"PRIuZ\".\",\n\t\taction, stream->declared_size, stream->received_bytes);\t\t\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_hash_update",
          "args": [
            "stream->hash_ctx",
            "buffer",
            "len"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_openssl.h",
          "lines": "30-35",
          "snippet": "GIT_INLINE(int) git_hash_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx);\n\tSHA1_Update(&ctx->c, data, len);\n\treturn 0;\n}",
          "includes": [
            "#include <openssl/sha.h>",
            "#include \"hash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/sha.h>\n#include \"hash.h\"\n\nGIT_INLINE(int) git_hash_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx);\n\tSHA1_Update(&ctx->c, data, len);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_stream_write(git_odb_stream *stream, const char *buffer, size_t len)\n{\n\tgit_hash_update(stream->hash_ctx, buffer, len);\n\n\tstream->received_bytes += len;\n\n\tif (stream->received_bytes > stream->declared_size)\n\t\treturn git_odb_stream__invalid_length(stream,\n\t\t\t\"stream_write()\");\n\n\treturn stream->write(stream, buffer, len);\n}"
  },
  {
    "function_name": "git_odb_stream__invalid_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1086-1097",
    "snippet": "static int git_odb_stream__invalid_length(\n\tconst git_odb_stream *stream,\n\tconst char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - \"\n\t\t\"Invalid length. %\"PRIuZ\" was expected. The \"\n\t\t\"total size of the received chunks amounts to %\"PRIuZ\".\",\n\t\taction, stream->declared_size, stream->received_bytes);\t\t\n\n\treturn -1;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_ODB",
            "\"Cannot %s - \"\n\t\t\"Invalid length. %\"PRIuZ\" was expected. The \"\n\t\t\"total size of the received chunks amounts to %\"PRIuZ\".\"",
            "action",
            "stream->declared_size",
            "stream->received_bytes"
          ],
          "line": 1090
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int git_odb_stream__invalid_length(\n\tconst git_odb_stream *stream,\n\tconst char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - \"\n\t\t\"Invalid length. %\"PRIuZ\" was expected. The \"\n\t\t\"total size of the received chunks amounts to %\"PRIuZ\".\",\n\t\taction, stream->declared_size, stream->received_bytes);\t\t\n\n\treturn -1;\n}"
  },
  {
    "function_name": "git_odb_open_wstream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1035-1084",
    "snippet": "int git_odb_open_wstream(\n\tgit_odb_stream **stream, git_odb *db, git_off_t size, git_otype type)\n{\n\tsize_t i, writes = 0;\n\tint error = GIT_ERROR;\n\tgit_hash_ctx *ctx = NULL;\n\n\tassert(stream && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->writestream != NULL) {\n\t\t\t++writes;\n\t\t\terror = b->writestream(stream, b, size, type);\n\t\t} else if (b->write != NULL) {\n\t\t\t++writes;\n\t\t\terror = init_fake_wstream(stream, b, size, type);\n\t\t}\n\t}\n\n\tif (error < 0) {\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = 0;\n\t\telse if (!writes)\n\t\t\terror = git_odb__error_unsupported_in_backend(\"write object\");\n\n\t\tgoto done;\n\t}\n\n\tctx = git__malloc(sizeof(git_hash_ctx));\n\tGITERR_CHECK_ALLOC(ctx);\n\n\tif ((error = git_hash_ctx_init(ctx)) < 0)\n\t\tgoto done;\n\n\thash_header(ctx, size, type);\n\t(*stream)->hash_ctx = ctx;\n\n\t(*stream)->declared_size = size;\n\t(*stream)->received_bytes = 0;\n\ndone:\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_header",
          "args": [
            "ctx",
            "size",
            "type"
          ],
          "line": 1076
        },
        "resolved": true,
        "details": {
          "function_name": "hash_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1026-1033",
          "snippet": "static void hash_header(git_hash_ctx *ctx, git_off_t size, git_otype type)\n{\n\tchar header[64];\n\tint hdrlen;\n\n\thdrlen = git_odb__format_object_header(header, sizeof(header), size, type);\n\tgit_hash_update(ctx, header, hdrlen);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic void hash_header(git_hash_ctx *ctx, git_off_t size, git_otype type)\n{\n\tchar header[64];\n\tint hdrlen;\n\n\thdrlen = git_odb__format_object_header(header, sizeof(header), size, type);\n\tgit_hash_update(ctx, header, hdrlen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_hash_ctx_init",
          "args": [
            "ctx"
          ],
          "line": 1073
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_ctx_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "231-248",
          "snippet": "int git_hash_ctx_init(git_hash_ctx *ctx)\n{\n\tint error = 0;\n\n\tassert(ctx);\n\n\t/*\n\t * When compiled with GIT_THREADS, the global hash_prov data is\n\t * initialized with git_libgit2_init.  Otherwise, it must be initialized\n\t * at first use.\n\t */\n\tif (hash_prov.type == INVALID && (error = git_hash_global_init()) < 0)\n\t\treturn error;\n\n\tmemset(ctx, 0x0, sizeof(git_hash_ctx));\n\n\treturn (hash_prov.type == CNG) ? hash_ctx_cng_init(ctx) : hash_ctx_cryptoapi_init(ctx);\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nint git_hash_ctx_init(git_hash_ctx *ctx)\n{\n\tint error = 0;\n\n\tassert(ctx);\n\n\t/*\n\t * When compiled with GIT_THREADS, the global hash_prov data is\n\t * initialized with git_libgit2_init.  Otherwise, it must be initialized\n\t * at first use.\n\t */\n\tif (hash_prov.type == INVALID && (error = git_hash_global_init()) < 0)\n\t\treturn error;\n\n\tmemset(ctx, 0x0, sizeof(git_hash_ctx));\n\n\treturn (hash_prov.type == CNG) ? hash_ctx_cng_init(ctx) : hash_ctx_cryptoapi_init(ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "ctx"
          ],
          "line": 1071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(git_hash_ctx)"
          ],
          "line": 1070
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__error_unsupported_in_backend",
          "args": [
            "\"write object\""
          ],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_unsupported_in_backend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "450-455",
          "snippet": "static int git_odb__error_unsupported_in_backend(const char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - unsupported in the loaded odb backends\", action);\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int git_odb__error_unsupported_in_backend(const char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - unsupported in the loaded odb backends\", action);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_fake_wstream",
          "args": [
            "stream",
            "b",
            "size",
            "type"
          ],
          "line": 1057
        },
        "resolved": true,
        "details": {
          "function_name": "init_fake_wstream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "333-362",
          "snippet": "static int init_fake_wstream(git_odb_stream **stream_p, git_odb_backend *backend, git_off_t size, git_otype type)\n{\n\tfake_wstream *stream;\n\n\tif (!git__is_ssizet(size)) {\n\t\tgiterr_set(GITERR_ODB, \"object size too large to keep in memory\");\n\t\treturn -1;\n\t}\n\n\tstream = git__calloc(1, sizeof(fake_wstream));\n\tGITERR_CHECK_ALLOC(stream);\n\n\tstream->size = size;\n\tstream->type = type;\n\tstream->buffer = git__malloc(size);\n\tif (stream->buffer == NULL) {\n\t\tgit__free(stream);\n\t\treturn -1;\n\t}\n\n\tstream->stream.backend = backend;\n\tstream->stream.read = NULL; /* read only */\n\tstream->stream.write = &fake_wstream__write;\n\tstream->stream.finalize_write = &fake_wstream__fwrite;\n\tstream->stream.free = &fake_wstream__free;\n\tstream->stream.mode = GIT_STREAM_WRONLY;\n\n\t*stream_p = (git_odb_stream *)stream;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int init_fake_wstream(git_odb_stream **stream_p, git_odb_backend *backend, git_off_t size, git_otype type)\n{\n\tfake_wstream *stream;\n\n\tif (!git__is_ssizet(size)) {\n\t\tgiterr_set(GITERR_ODB, \"object size too large to keep in memory\");\n\t\treturn -1;\n\t}\n\n\tstream = git__calloc(1, sizeof(fake_wstream));\n\tGITERR_CHECK_ALLOC(stream);\n\n\tstream->size = size;\n\tstream->type = type;\n\tstream->buffer = git__malloc(size);\n\tif (stream->buffer == NULL) {\n\t\tgit__free(stream);\n\t\treturn -1;\n\t}\n\n\tstream->stream.backend = backend;\n\tstream->stream.read = NULL; /* read only */\n\tstream->stream.write = &fake_wstream__write;\n\tstream->stream.finalize_write = &fake_wstream__fwrite;\n\tstream->stream.free = &fake_wstream__free;\n\tstream->stream.mode = GIT_STREAM_WRONLY;\n\n\t*stream_p = (git_odb_stream *)stream;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->writestream",
          "args": [
            "stream",
            "b",
            "size",
            "type"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "stream && db"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_open_wstream(\n\tgit_odb_stream **stream, git_odb *db, git_off_t size, git_otype type)\n{\n\tsize_t i, writes = 0;\n\tint error = GIT_ERROR;\n\tgit_hash_ctx *ctx = NULL;\n\n\tassert(stream && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->writestream != NULL) {\n\t\t\t++writes;\n\t\t\terror = b->writestream(stream, b, size, type);\n\t\t} else if (b->write != NULL) {\n\t\t\t++writes;\n\t\t\terror = init_fake_wstream(stream, b, size, type);\n\t\t}\n\t}\n\n\tif (error < 0) {\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = 0;\n\t\telse if (!writes)\n\t\t\terror = git_odb__error_unsupported_in_backend(\"write object\");\n\n\t\tgoto done;\n\t}\n\n\tctx = git__malloc(sizeof(git_hash_ctx));\n\tGITERR_CHECK_ALLOC(ctx);\n\n\tif ((error = git_hash_ctx_init(ctx)) < 0)\n\t\tgoto done;\n\n\thash_header(ctx, size, type);\n\t(*stream)->hash_ctx = ctx;\n\n\t(*stream)->declared_size = size;\n\t(*stream)->received_bytes = 0;\n\ndone:\n\treturn error;\n}"
  },
  {
    "function_name": "hash_header",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "1026-1033",
    "snippet": "static void hash_header(git_hash_ctx *ctx, git_off_t size, git_otype type)\n{\n\tchar header[64];\n\tint hdrlen;\n\n\thdrlen = git_odb__format_object_header(header, sizeof(header), size, type);\n\tgit_hash_update(ctx, header, hdrlen);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_hash_update",
          "args": [
            "ctx",
            "header",
            "hdrlen"
          ],
          "line": 1032
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_openssl.h",
          "lines": "30-35",
          "snippet": "GIT_INLINE(int) git_hash_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx);\n\tSHA1_Update(&ctx->c, data, len);\n\treturn 0;\n}",
          "includes": [
            "#include <openssl/sha.h>",
            "#include \"hash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/sha.h>\n#include \"hash.h\"\n\nGIT_INLINE(int) git_hash_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx);\n\tSHA1_Update(&ctx->c, data, len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__format_object_header",
          "args": [
            "header",
            "sizeof(header)",
            "size",
            "type"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__format_object_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "53-59",
          "snippet": "int git_odb__format_object_header(char *hdr, size_t n, git_off_t obj_len, git_otype obj_type)\n{\n\tconst char *type_str = git_object_type2string(obj_type);\n\tint len = p_snprintf(hdr, n, \"%s %lld\", type_str, (long long)obj_len);\n\tassert(len > 0 && len <= (int)n);\n\treturn len+1;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__format_object_header(char *hdr, size_t n, git_off_t obj_len, git_otype obj_type)\n{\n\tconst char *type_str = git_object_type2string(obj_type);\n\tint len = p_snprintf(hdr, n, \"%s %lld\", type_str, (long long)obj_len);\n\tassert(len > 0 && len <= (int)n);\n\treturn len+1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic void hash_header(git_hash_ctx *ctx, git_off_t size, git_otype type)\n{\n\tchar header[64];\n\tint hdrlen;\n\n\thdrlen = git_odb__format_object_header(header, sizeof(header), size, type);\n\tgit_hash_update(ctx, header, hdrlen);\n}"
  },
  {
    "function_name": "git_odb_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "984-1024",
    "snippet": "int git_odb_write(\n\tgit_oid *oid, git_odb *db, const void *data, size_t len, git_otype type)\n{\n\tsize_t i;\n\tint error = GIT_ERROR;\n\tgit_odb_stream *stream;\n\n\tassert(oid && db);\n\n\tgit_odb_hash(oid, data, len, type);\n\tif (git_odb_exists(db, oid))\n\t\treturn 0;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->write != NULL)\n\t\t\terror = b->write(b, oid, data, len, type);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/* if no backends were able to write the object directly, we try a\n\t * streaming write to the backends; just write the whole object into the\n\t * stream in one push\n\t */\n\tif ((error = git_odb_open_wstream(&stream, db, len, type)) != 0)\n\t\treturn error;\n\n\tstream->write(stream, data, len);\n\terror = stream->finalize_write(stream, oid);\n\tgit_odb_stream_free(stream);\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_stream_free",
          "args": [
            "stream"
          ],
          "line": 1021
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_stream_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1131-1139",
          "snippet": "void git_odb_stream_free(git_odb_stream *stream)\n{\n\tif (stream == NULL)\n\t\treturn;\n\n\tgit_hash_ctx_cleanup(stream->hash_ctx);\n\tgit__free(stream->hash_ctx);\n\tstream->free(stream);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_stream_free(git_odb_stream *stream)\n{\n\tif (stream == NULL)\n\t\treturn;\n\n\tgit_hash_ctx_cleanup(stream->hash_ctx);\n\tgit__free(stream->hash_ctx);\n\tstream->free(stream);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stream->finalize_write",
          "args": [
            "stream",
            "oid"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream->write",
          "args": [
            "stream",
            "data",
            "len"
          ],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_odb_open_wstream",
          "args": [
            "&stream",
            "db",
            "len",
            "type"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_open_wstream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1035-1084",
          "snippet": "int git_odb_open_wstream(\n\tgit_odb_stream **stream, git_odb *db, git_off_t size, git_otype type)\n{\n\tsize_t i, writes = 0;\n\tint error = GIT_ERROR;\n\tgit_hash_ctx *ctx = NULL;\n\n\tassert(stream && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->writestream != NULL) {\n\t\t\t++writes;\n\t\t\terror = b->writestream(stream, b, size, type);\n\t\t} else if (b->write != NULL) {\n\t\t\t++writes;\n\t\t\terror = init_fake_wstream(stream, b, size, type);\n\t\t}\n\t}\n\n\tif (error < 0) {\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = 0;\n\t\telse if (!writes)\n\t\t\terror = git_odb__error_unsupported_in_backend(\"write object\");\n\n\t\tgoto done;\n\t}\n\n\tctx = git__malloc(sizeof(git_hash_ctx));\n\tGITERR_CHECK_ALLOC(ctx);\n\n\tif ((error = git_hash_ctx_init(ctx)) < 0)\n\t\tgoto done;\n\n\thash_header(ctx, size, type);\n\t(*stream)->hash_ctx = ctx;\n\n\t(*stream)->declared_size = size;\n\t(*stream)->received_bytes = 0;\n\ndone:\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_open_wstream(\n\tgit_odb_stream **stream, git_odb *db, git_off_t size, git_otype type)\n{\n\tsize_t i, writes = 0;\n\tint error = GIT_ERROR;\n\tgit_hash_ctx *ctx = NULL;\n\n\tassert(stream && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->writestream != NULL) {\n\t\t\t++writes;\n\t\t\terror = b->writestream(stream, b, size, type);\n\t\t} else if (b->write != NULL) {\n\t\t\t++writes;\n\t\t\terror = init_fake_wstream(stream, b, size, type);\n\t\t}\n\t}\n\n\tif (error < 0) {\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = 0;\n\t\telse if (!writes)\n\t\t\terror = git_odb__error_unsupported_in_backend(\"write object\");\n\n\t\tgoto done;\n\t}\n\n\tctx = git__malloc(sizeof(git_hash_ctx));\n\tGITERR_CHECK_ALLOC(ctx);\n\n\tif ((error = git_hash_ctx_init(ctx)) < 0)\n\t\tgoto done;\n\n\thash_header(ctx, size, type);\n\t(*stream)->hash_ctx = ctx;\n\n\t(*stream)->declared_size = size;\n\t(*stream)->received_bytes = 0;\n\ndone:\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->write",
          "args": [
            "b",
            "oid",
            "data",
            "len",
            "type"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_exists",
          "args": [
            "db",
            "oid"
          ],
          "line": 994
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "646-665",
          "snippet": "int git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_hash",
          "args": [
            "oid",
            "data",
            "len",
            "type"
          ],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "283-294",
          "snippet": "int git_odb_hash(git_oid *id, const void *data, size_t len, git_otype type)\n{\n\tgit_rawobj raw;\n\n\tassert(id);\n\n\traw.data = (void *)data;\n\traw.len = len;\n\traw.type = type;\n\n\treturn git_odb__hashobj(id, &raw);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_hash(git_oid *id, const void *data, size_t len, git_otype type)\n{\n\tgit_rawobj raw;\n\n\tassert(id);\n\n\traw.data = (void *)data;\n\traw.len = len;\n\traw.type = type;\n\n\treturn git_odb__hashobj(id, &raw);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "oid && db"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_write(\n\tgit_oid *oid, git_odb *db, const void *data, size_t len, git_otype type)\n{\n\tsize_t i;\n\tint error = GIT_ERROR;\n\tgit_odb_stream *stream;\n\n\tassert(oid && db);\n\n\tgit_odb_hash(oid, data, len, type);\n\tif (git_odb_exists(db, oid))\n\t\treturn 0;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->write != NULL)\n\t\t\terror = b->write(b, oid, data, len, type);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/* if no backends were able to write the object directly, we try a\n\t * streaming write to the backends; just write the whole object into the\n\t * stream in one push\n\t */\n\tif ((error = git_odb_open_wstream(&stream, db, len, type)) != 0)\n\t\treturn error;\n\n\tstream->write(stream, data, len);\n\terror = stream->finalize_write(stream, oid);\n\tgit_odb_stream_free(stream);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_odb_foreach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "969-982",
    "snippet": "int git_odb_foreach(git_odb *db, git_odb_foreach_cb cb, void *payload)\n{\n\tunsigned int i;\n\tbackend_internal *internal;\n\n\tgit_vector_foreach(&db->backends, i, internal) {\n\t\tgit_odb_backend *b = internal->backend;\n\t\tint error = b->foreach(b, cb, payload);\n\t\tif (error < 0)\n\t\t\treturn error;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b->foreach",
          "args": [
            "b",
            "cb",
            "payload"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&db->backends",
            "i",
            "internal"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_foreach(git_odb *db, git_odb_foreach_cb cb, void *payload)\n{\n\tunsigned int i;\n\tbackend_internal *internal;\n\n\tgit_vector_foreach(&db->backends, i, internal) {\n\t\tgit_odb_backend *b = internal->backend;\n\t\tint error = b->foreach(b, cb, payload);\n\t\tif (error < 0)\n\t\t\treturn error;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb_read_prefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "933-967",
    "snippet": "int git_odb_read_prefix(\n\tgit_odb_object **out, git_odb *db, const git_oid *short_id, size_t len)\n{\n\tgit_oid key = {{0}};\n\tint error;\n\n\tassert(out && db);\n\n\tif (len < GIT_OID_MINPREFIXLEN)\n\t\treturn git_odb__error_ambiguous(\"prefix length too short\");\n\n\tif (len > GIT_OID_HEXSZ)\n\t\tlen = GIT_OID_HEXSZ;\n\n\tif (len == GIT_OID_HEXSZ) {\n\t\t*out = git_cache_get_raw(odb_cache(db), short_id);\n\t\tif (*out != NULL)\n\t\t\treturn 0;\n\t}\n\n\t/* just copy valid part of short_id */\n\tmemcpy(&key.id, short_id->id, (len + 1) / 2);\n\tif (len & 1)\n\t\tkey.id[len / 2] &= 0xF0;\n\n\terror = read_prefix_1(out, db, &key, len, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = read_prefix_1(out, db, &key, len, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for prefix\", &key, len);\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb__error_notfound",
          "args": [
            "\"no match for prefix\"",
            "&key",
            "len"
          ],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_notfound",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1220-1232",
          "snippet": "int git_odb__error_notfound(\n\tconst char *message, const git_oid *oid, size_t oid_len)\n{\n\tif (oid != NULL) {\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\tgit_oid_tostr(oid_str, oid_len+1, oid);\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s (%.*s)\",\n\t\t\tmessage, oid_len, oid_str);\n\t} else\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s\", message);\n\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__error_notfound(\n\tconst char *message, const git_oid *oid, size_t oid_len)\n{\n\tif (oid != NULL) {\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\tgit_oid_tostr(oid_str, oid_len+1, oid);\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s (%.*s)\",\n\t\t\tmessage, oid_len, oid_str);\n\t} else\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s\", message);\n\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_prefix_1",
          "args": [
            "out",
            "db",
            "&key",
            "len",
            "true"
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "read_prefix_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "883-931",
          "snippet": "static int read_prefix_1(git_odb_object **out, git_odb *db,\n\t\tconst git_oid *key, size_t len, bool only_refreshed)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_oid found_full_oid = {{0}};\n\tgit_rawobj raw;\n\tvoid *data = NULL;\n\tbool found = false;\n\tgit_odb_object *object;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->read_prefix != NULL) {\n\t\t\tgit_oid full_oid;\n\t\t\terror = b->read_prefix(&full_oid, &raw.data, &raw.len, &raw.type, b, key, len);\n\t\t\tif (error == GIT_ENOTFOUND || error == GIT_PASSTHROUGH)\n\t\t\t\tcontinue;\n\n\t\t\tif (error)\n\t\t\t\treturn error;\n\n\t\t\tgit__free(data);\n\t\t\tdata = raw.data;\n\n\t\t\tif (found && git_oid__cmp(&full_oid, &found_full_oid)) {\n\t\t\t\tgit__free(raw.data);\n\t\t\t\treturn git_odb__error_ambiguous(\"multiple matches for prefix\");\n\t\t\t}\n\n\t\t\tfound_full_oid = full_oid;\n\t\t\tfound = true;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn GIT_ENOTFOUND;\n\n\tif ((object = odb_object__alloc(&found_full_oid, &raw)) == NULL)\n\t\treturn -1;\n\n\t*out = git_cache_store_raw(odb_cache(db), object);\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int read_prefix_1(git_odb_object **out, git_odb *db,\n\t\tconst git_oid *key, size_t len, bool only_refreshed)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_oid found_full_oid = {{0}};\n\tgit_rawobj raw;\n\tvoid *data = NULL;\n\tbool found = false;\n\tgit_odb_object *object;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->read_prefix != NULL) {\n\t\t\tgit_oid full_oid;\n\t\t\terror = b->read_prefix(&full_oid, &raw.data, &raw.len, &raw.type, b, key, len);\n\t\t\tif (error == GIT_ENOTFOUND || error == GIT_PASSTHROUGH)\n\t\t\t\tcontinue;\n\n\t\t\tif (error)\n\t\t\t\treturn error;\n\n\t\t\tgit__free(data);\n\t\t\tdata = raw.data;\n\n\t\t\tif (found && git_oid__cmp(&full_oid, &found_full_oid)) {\n\t\t\t\tgit__free(raw.data);\n\t\t\t\treturn git_odb__error_ambiguous(\"multiple matches for prefix\");\n\t\t\t}\n\n\t\t\tfound_full_oid = full_oid;\n\t\t\tfound = true;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn GIT_ENOTFOUND;\n\n\tif ((object = odb_object__alloc(&found_full_oid, &raw)) == NULL)\n\t\treturn -1;\n\n\t*out = git_cache_store_raw(odb_cache(db), object);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_refresh",
          "args": [
            "db"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_refresh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1201-1218",
          "snippet": "int git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&key.id",
            "short_id->id",
            "(len + 1) / 2"
          ],
          "line": 954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_cache_get_raw",
          "args": [
            "odb_cache(db)",
            "short_id"
          ],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_get_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "247-250",
          "snippet": "git_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_cache",
          "args": [
            "db"
          ],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "odb_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "41-49",
          "snippet": "static git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__error_ambiguous",
          "args": [
            "\"prefix length too short\""
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_ambiguous",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1234-1238",
          "snippet": "int git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && db"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_read_prefix(\n\tgit_odb_object **out, git_odb *db, const git_oid *short_id, size_t len)\n{\n\tgit_oid key = {{0}};\n\tint error;\n\n\tassert(out && db);\n\n\tif (len < GIT_OID_MINPREFIXLEN)\n\t\treturn git_odb__error_ambiguous(\"prefix length too short\");\n\n\tif (len > GIT_OID_HEXSZ)\n\t\tlen = GIT_OID_HEXSZ;\n\n\tif (len == GIT_OID_HEXSZ) {\n\t\t*out = git_cache_get_raw(odb_cache(db), short_id);\n\t\tif (*out != NULL)\n\t\t\treturn 0;\n\t}\n\n\t/* just copy valid part of short_id */\n\tmemcpy(&key.id, short_id->id, (len + 1) / 2);\n\tif (len & 1)\n\t\tkey.id[len / 2] &= 0xF0;\n\n\terror = read_prefix_1(out, db, &key, len, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = read_prefix_1(out, db, &key, len, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for prefix\", &key, len);\n\n\treturn error;\n}"
  },
  {
    "function_name": "read_prefix_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "883-931",
    "snippet": "static int read_prefix_1(git_odb_object **out, git_odb *db,\n\t\tconst git_oid *key, size_t len, bool only_refreshed)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_oid found_full_oid = {{0}};\n\tgit_rawobj raw;\n\tvoid *data = NULL;\n\tbool found = false;\n\tgit_odb_object *object;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->read_prefix != NULL) {\n\t\t\tgit_oid full_oid;\n\t\t\terror = b->read_prefix(&full_oid, &raw.data, &raw.len, &raw.type, b, key, len);\n\t\t\tif (error == GIT_ENOTFOUND || error == GIT_PASSTHROUGH)\n\t\t\t\tcontinue;\n\n\t\t\tif (error)\n\t\t\t\treturn error;\n\n\t\t\tgit__free(data);\n\t\t\tdata = raw.data;\n\n\t\t\tif (found && git_oid__cmp(&full_oid, &found_full_oid)) {\n\t\t\t\tgit__free(raw.data);\n\t\t\t\treturn git_odb__error_ambiguous(\"multiple matches for prefix\");\n\t\t\t}\n\n\t\t\tfound_full_oid = full_oid;\n\t\t\tfound = true;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn GIT_ENOTFOUND;\n\n\tif ((object = odb_object__alloc(&found_full_oid, &raw)) == NULL)\n\t\treturn -1;\n\n\t*out = git_cache_store_raw(odb_cache(db), object);\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_cache_store_raw",
          "args": [
            "odb_cache(db)",
            "object"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_store_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "235-239",
          "snippet": "void *git_cache_store_raw(git_cache *cache, git_odb_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_RAW;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid *git_cache_store_raw(git_cache *cache, git_odb_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_RAW;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_cache",
          "args": [
            "db"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "odb_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "41-49",
          "snippet": "static git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_object__alloc",
          "args": [
            "&found_full_oid",
            "&raw"
          ],
          "line": 926
        },
        "resolved": true,
        "details": {
          "function_name": "odb_object__alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "88-100",
          "snippet": "static git_odb_object *odb_object__alloc(const git_oid *oid, git_rawobj *source)\n{\n\tgit_odb_object *object = git__calloc(1, sizeof(git_odb_object));\n\n\tif (object != NULL) {\n\t\tgit_oid_cpy(&object->cached.oid, oid);\n\t\tobject->cached.type = source->type;\n\t\tobject->cached.size = source->len;\n\t\tobject->buffer      = source->data;\n\t}\n\n\treturn object;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_odb_object *odb_object__alloc(const git_oid *oid, git_rawobj *source)\n{\n\tgit_odb_object *object = git__calloc(1, sizeof(git_odb_object));\n\n\tif (object != NULL) {\n\t\tgit_oid_cpy(&object->cached.oid, oid);\n\t\tobject->cached.type = source->type;\n\t\tobject->cached.size = source->len;\n\t\tobject->buffer      = source->data;\n\t}\n\n\treturn object;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__error_ambiguous",
          "args": [
            "\"multiple matches for prefix\""
          ],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_ambiguous",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1234-1238",
          "snippet": "int git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "raw.data"
          ],
          "line": 914
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid__cmp",
          "args": [
            "&full_oid",
            "&found_full_oid"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid__cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.h",
          "lines": "42-45",
          "snippet": "GIT_INLINE(int) git_oid__cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__hashcmp(a->id, b->id);\n}",
          "includes": [
            "#include \"git2/oid.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n\nGIT_INLINE(int) git_oid__cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__hashcmp(a->id, b->id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->read_prefix",
          "args": [
            "&full_oid",
            "&raw.data",
            "&raw.len",
            "&raw.type",
            "b",
            "key",
            "len"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int read_prefix_1(git_odb_object **out, git_odb *db,\n\t\tconst git_oid *key, size_t len, bool only_refreshed)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_oid found_full_oid = {{0}};\n\tgit_rawobj raw;\n\tvoid *data = NULL;\n\tbool found = false;\n\tgit_odb_object *object;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->read_prefix != NULL) {\n\t\t\tgit_oid full_oid;\n\t\t\terror = b->read_prefix(&full_oid, &raw.data, &raw.len, &raw.type, b, key, len);\n\t\t\tif (error == GIT_ENOTFOUND || error == GIT_PASSTHROUGH)\n\t\t\t\tcontinue;\n\n\t\t\tif (error)\n\t\t\t\treturn error;\n\n\t\t\tgit__free(data);\n\t\t\tdata = raw.data;\n\n\t\t\tif (found && git_oid__cmp(&full_oid, &found_full_oid)) {\n\t\t\t\tgit__free(raw.data);\n\t\t\t\treturn git_odb__error_ambiguous(\"multiple matches for prefix\");\n\t\t\t}\n\n\t\t\tfound_full_oid = full_oid;\n\t\t\tfound = true;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn GIT_ENOTFOUND;\n\n\tif ((object = odb_object__alloc(&found_full_oid, &raw)) == NULL)\n\t\treturn -1;\n\n\t*out = git_cache_store_raw(odb_cache(db), object);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "862-881",
    "snippet": "int git_odb_read(git_odb_object **out, git_odb *db, const git_oid *id)\n{\n\tint error;\n\n\tassert(out && db && id);\n\n\t*out = git_cache_get_raw(odb_cache(db), id);\n\tif (*out != NULL)\n\t\treturn 0;\n\n\terror = odb_read_1(out, db, id, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_read_1(out, db, id, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id\", id, GIT_OID_HEXSZ);\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb__error_notfound",
          "args": [
            "\"no match for id\"",
            "id",
            "GIT_OID_HEXSZ"
          ],
          "line": 878
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_notfound",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1220-1232",
          "snippet": "int git_odb__error_notfound(\n\tconst char *message, const git_oid *oid, size_t oid_len)\n{\n\tif (oid != NULL) {\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\tgit_oid_tostr(oid_str, oid_len+1, oid);\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s (%.*s)\",\n\t\t\tmessage, oid_len, oid_str);\n\t} else\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s\", message);\n\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__error_notfound(\n\tconst char *message, const git_oid *oid, size_t oid_len)\n{\n\tif (oid != NULL) {\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\tgit_oid_tostr(oid_str, oid_len+1, oid);\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s (%.*s)\",\n\t\t\tmessage, oid_len, oid_str);\n\t} else\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s\", message);\n\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_read_1",
          "args": [
            "out",
            "db",
            "id",
            "true"
          ],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "odb_read_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "821-860",
          "snippet": "static int odb_read_1(git_odb_object **out, git_odb *db, const git_oid *id,\n\t\tbool only_refreshed)\n{\n\tsize_t i;\n\tgit_rawobj raw;\n\tgit_odb_object *object;\n\tbool found = false;\n\n\tif (!hardcoded_objects(&raw, id))\n\t\tfound = true;\n\n\tfor (i = 0; i < db->backends.length && !found; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->read != NULL) {\n\t\t\tint error = b->read(&raw.data, &raw.len, &raw.type, b, id);\n\t\t\tif (error == GIT_PASSTHROUGH || error == GIT_ENOTFOUND)\n\t\t\t\tcontinue;\n\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\n\t\t\tfound = true;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn GIT_ENOTFOUND;\n\n\tgiterr_clear();\n\tif ((object = odb_object__alloc(id, &raw)) == NULL)\n\t\treturn -1;\n\n\t*out = git_cache_store_raw(odb_cache(db), object);\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int odb_read_1(git_odb_object **out, git_odb *db, const git_oid *id,\n\t\tbool only_refreshed)\n{\n\tsize_t i;\n\tgit_rawobj raw;\n\tgit_odb_object *object;\n\tbool found = false;\n\n\tif (!hardcoded_objects(&raw, id))\n\t\tfound = true;\n\n\tfor (i = 0; i < db->backends.length && !found; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->read != NULL) {\n\t\t\tint error = b->read(&raw.data, &raw.len, &raw.type, b, id);\n\t\t\tif (error == GIT_PASSTHROUGH || error == GIT_ENOTFOUND)\n\t\t\t\tcontinue;\n\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\n\t\t\tfound = true;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn GIT_ENOTFOUND;\n\n\tgiterr_clear();\n\tif ((object = odb_object__alloc(id, &raw)) == NULL)\n\t\treturn -1;\n\n\t*out = git_cache_store_raw(odb_cache(db), object);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_refresh",
          "args": [
            "db"
          ],
          "line": 874
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_refresh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1201-1218",
          "snippet": "int git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cache_get_raw",
          "args": [
            "odb_cache(db)",
            "id"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_get_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "247-250",
          "snippet": "git_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_cache",
          "args": [
            "db"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "odb_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "41-49",
          "snippet": "static git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && db && id"
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_read(git_odb_object **out, git_odb *db, const git_oid *id)\n{\n\tint error;\n\n\tassert(out && db && id);\n\n\t*out = git_cache_get_raw(odb_cache(db), id);\n\tif (*out != NULL)\n\t\treturn 0;\n\n\terror = odb_read_1(out, db, id, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_read_1(out, db, id, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id\", id, GIT_OID_HEXSZ);\n\n\treturn error;\n}"
  },
  {
    "function_name": "odb_read_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "821-860",
    "snippet": "static int odb_read_1(git_odb_object **out, git_odb *db, const git_oid *id,\n\t\tbool only_refreshed)\n{\n\tsize_t i;\n\tgit_rawobj raw;\n\tgit_odb_object *object;\n\tbool found = false;\n\n\tif (!hardcoded_objects(&raw, id))\n\t\tfound = true;\n\n\tfor (i = 0; i < db->backends.length && !found; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->read != NULL) {\n\t\t\tint error = b->read(&raw.data, &raw.len, &raw.type, b, id);\n\t\t\tif (error == GIT_PASSTHROUGH || error == GIT_ENOTFOUND)\n\t\t\t\tcontinue;\n\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\n\t\t\tfound = true;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn GIT_ENOTFOUND;\n\n\tgiterr_clear();\n\tif ((object = odb_object__alloc(id, &raw)) == NULL)\n\t\treturn -1;\n\n\t*out = git_cache_store_raw(odb_cache(db), object);\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_cache_store_raw",
          "args": [
            "odb_cache(db)",
            "object"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_store_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "235-239",
          "snippet": "void *git_cache_store_raw(git_cache *cache, git_odb_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_RAW;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid *git_cache_store_raw(git_cache *cache, git_odb_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_RAW;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_cache",
          "args": [
            "db"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "odb_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "41-49",
          "snippet": "static git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_object__alloc",
          "args": [
            "id",
            "&raw"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "odb_object__alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "88-100",
          "snippet": "static git_odb_object *odb_object__alloc(const git_oid *oid, git_rawobj *source)\n{\n\tgit_odb_object *object = git__calloc(1, sizeof(git_odb_object));\n\n\tif (object != NULL) {\n\t\tgit_oid_cpy(&object->cached.oid, oid);\n\t\tobject->cached.type = source->type;\n\t\tobject->cached.size = source->len;\n\t\tobject->buffer      = source->data;\n\t}\n\n\treturn object;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_odb_object *odb_object__alloc(const git_oid *oid, git_rawobj *source)\n{\n\tgit_odb_object *object = git__calloc(1, sizeof(git_odb_object));\n\n\tif (object != NULL) {\n\t\tgit_oid_cpy(&object->cached.oid, oid);\n\t\tobject->cached.type = source->type;\n\t\tobject->cached.size = source->len;\n\t\tobject->buffer      = source->data;\n\t}\n\n\treturn object;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->read",
          "args": [
            "&raw.data",
            "&raw.len",
            "&raw.type",
            "b",
            "id"
          ],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hardcoded_objects",
          "args": [
            "&raw",
            "id"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "hardcoded_objects",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "809-819",
          "snippet": "static int hardcoded_objects(git_rawobj *raw, const git_oid *id)\n{\n\tif (!git_oid_cmp(id, &empty_tree)) {\n\t\traw->type = GIT_OBJ_TREE;\n\t\traw->len = 0;\n\t\traw->data = git__calloc(1, sizeof(uint8_t));\n\t\treturn 0;\n\t} else {\n\t\treturn GIT_ENOTFOUND;\n\t}\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_oid empty_tree = {{ 0x4b, 0x82, 0x5d, 0xc6, 0x42, 0xcb, 0x6e, 0xb9, 0xa0, 0x60,\n\t\t\t       0xe5, 0x4b, 0xf8, 0xd6, 0x92, 0x88, 0xfb, 0xee, 0x49, 0x04 }};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_oid empty_tree = {{ 0x4b, 0x82, 0x5d, 0xc6, 0x42, 0xcb, 0x6e, 0xb9, 0xa0, 0x60,\n\t\t\t       0xe5, 0x4b, 0xf8, 0xd6, 0x92, 0x88, 0xfb, 0xee, 0x49, 0x04 }};\n\nstatic int hardcoded_objects(git_rawobj *raw, const git_oid *id)\n{\n\tif (!git_oid_cmp(id, &empty_tree)) {\n\t\traw->type = GIT_OBJ_TREE;\n\t\traw->len = 0;\n\t\traw->data = git__calloc(1, sizeof(uint8_t));\n\t\treturn 0;\n\t} else {\n\t\treturn GIT_ENOTFOUND;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int odb_read_1(git_odb_object **out, git_odb *db, const git_oid *id,\n\t\tbool only_refreshed)\n{\n\tsize_t i;\n\tgit_rawobj raw;\n\tgit_odb_object *object;\n\tbool found = false;\n\n\tif (!hardcoded_objects(&raw, id))\n\t\tfound = true;\n\n\tfor (i = 0; i < db->backends.length && !found; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->read != NULL) {\n\t\t\tint error = b->read(&raw.data, &raw.len, &raw.type, b, id);\n\t\t\tif (error == GIT_PASSTHROUGH || error == GIT_ENOTFOUND)\n\t\t\t\tcontinue;\n\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\n\t\t\tfound = true;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn GIT_ENOTFOUND;\n\n\tgiterr_clear();\n\tif ((object = odb_object__alloc(id, &raw)) == NULL)\n\t\treturn -1;\n\n\t*out = git_cache_store_raw(odb_cache(db), object);\n\treturn 0;\n}"
  },
  {
    "function_name": "hardcoded_objects",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "809-819",
    "snippet": "static int hardcoded_objects(git_rawobj *raw, const git_oid *id)\n{\n\tif (!git_oid_cmp(id, &empty_tree)) {\n\t\traw->type = GIT_OBJ_TREE;\n\t\traw->len = 0;\n\t\traw->data = git__calloc(1, sizeof(uint8_t));\n\t\treturn 0;\n\t} else {\n\t\treturn GIT_ENOTFOUND;\n\t}\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_oid empty_tree = {{ 0x4b, 0x82, 0x5d, 0xc6, 0x42, 0xcb, 0x6e, 0xb9, 0xa0, 0x60,\n\t\t\t       0xe5, 0x4b, 0xf8, 0xd6, 0x92, 0x88, 0xfb, 0xee, 0x49, 0x04 }};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(uint8_t)"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cmp",
          "args": [
            "id",
            "&empty_tree"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "179-182",
          "snippet": "int git_oid_cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__cmp(a, b);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__cmp(a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_oid empty_tree = {{ 0x4b, 0x82, 0x5d, 0xc6, 0x42, 0xcb, 0x6e, 0xb9, 0xa0, 0x60,\n\t\t\t       0xe5, 0x4b, 0xf8, 0xd6, 0x92, 0x88, 0xfb, 0xee, 0x49, 0x04 }};\n\nstatic int hardcoded_objects(git_rawobj *raw, const git_oid *id)\n{\n\tif (!git_oid_cmp(id, &empty_tree)) {\n\t\traw->type = GIT_OBJ_TREE;\n\t\traw->len = 0;\n\t\traw->data = git__calloc(1, sizeof(uint8_t));\n\t\treturn 0;\n\t} else {\n\t\treturn GIT_ENOTFOUND;\n\t}\n}"
  },
  {
    "function_name": "git_odb__read_header_or_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "762-804",
    "snippet": "int git_odb__read_header_or_object(\n\tgit_odb_object **out, size_t *len_p, git_otype *type_p,\n\tgit_odb *db, const git_oid *id)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_odb_object *object;\n\n\tassert(db && id && out && len_p && type_p);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\t*len_p = object->cached.size;\n\t\t*type_p = object->cached.type;\n\t\t*out = object;\n\t\treturn 0;\n\t}\n\n\t*out = NULL;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->read_header != NULL)\n\t\t\terror = b->read_header(len_p, type_p, b, id);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/*\n\t * no backend could read only the header.\n\t * try reading the whole object and freeing the contents\n\t */\n\tif ((error = git_odb_read(&object, db, id)) < 0)\n\t\treturn error; /* error already set - pass along */\n\n\t*len_p = object->cached.size;\n\t*type_p = object->cached.type;\n\t*out = object;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_read",
          "args": [
            "&object",
            "db",
            "id"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "862-881",
          "snippet": "int git_odb_read(git_odb_object **out, git_odb *db, const git_oid *id)\n{\n\tint error;\n\n\tassert(out && db && id);\n\n\t*out = git_cache_get_raw(odb_cache(db), id);\n\tif (*out != NULL)\n\t\treturn 0;\n\n\terror = odb_read_1(out, db, id, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_read_1(out, db, id, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id\", id, GIT_OID_HEXSZ);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_read(git_odb_object **out, git_odb *db, const git_oid *id)\n{\n\tint error;\n\n\tassert(out && db && id);\n\n\t*out = git_cache_get_raw(odb_cache(db), id);\n\tif (*out != NULL)\n\t\treturn 0;\n\n\terror = odb_read_1(out, db, id, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_read_1(out, db, id, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id\", id, GIT_OID_HEXSZ);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->read_header",
          "args": [
            "len_p",
            "type_p",
            "b",
            "id"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cache_get_raw",
          "args": [
            "odb_cache(db)",
            "id"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_get_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "247-250",
          "snippet": "git_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_cache",
          "args": [
            "db"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "odb_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "41-49",
          "snippet": "static git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && id && out && len_p && type_p"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__read_header_or_object(\n\tgit_odb_object **out, size_t *len_p, git_otype *type_p,\n\tgit_odb *db, const git_oid *id)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_odb_object *object;\n\n\tassert(db && id && out && len_p && type_p);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\t*len_p = object->cached.size;\n\t\t*type_p = object->cached.type;\n\t\t*out = object;\n\t\treturn 0;\n\t}\n\n\t*out = NULL;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->read_header != NULL)\n\t\t\terror = b->read_header(len_p, type_p, b, id);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/*\n\t * no backend could read only the header.\n\t * try reading the whole object and freeing the contents\n\t */\n\tif ((error = git_odb_read(&object, db, id)) < 0)\n\t\treturn error; /* error already set - pass along */\n\n\t*len_p = object->cached.size;\n\t*type_p = object->cached.type;\n\t*out = object;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb_read_header",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "749-760",
    "snippet": "int git_odb_read_header(size_t *len_p, git_otype *type_p, git_odb *db, const git_oid *id)\n{\n\tint error;\n\tgit_odb_object *object;\n\n\terror = git_odb__read_header_or_object(&object, len_p, type_p, db, id);\n\n\tif (object)\n\t\tgit_odb_object_free(object);\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_object_free",
          "args": [
            "object"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "137-143",
          "snippet": "void git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__read_header_or_object",
          "args": [
            "&object",
            "len_p",
            "type_p",
            "db",
            "id"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__read_header_or_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "762-804",
          "snippet": "int git_odb__read_header_or_object(\n\tgit_odb_object **out, size_t *len_p, git_otype *type_p,\n\tgit_odb *db, const git_oid *id)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_odb_object *object;\n\n\tassert(db && id && out && len_p && type_p);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\t*len_p = object->cached.size;\n\t\t*type_p = object->cached.type;\n\t\t*out = object;\n\t\treturn 0;\n\t}\n\n\t*out = NULL;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->read_header != NULL)\n\t\t\terror = b->read_header(len_p, type_p, b, id);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/*\n\t * no backend could read only the header.\n\t * try reading the whole object and freeing the contents\n\t */\n\tif ((error = git_odb_read(&object, db, id)) < 0)\n\t\treturn error; /* error already set - pass along */\n\n\t*len_p = object->cached.size;\n\t*type_p = object->cached.type;\n\t*out = object;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__read_header_or_object(\n\tgit_odb_object **out, size_t *len_p, git_otype *type_p,\n\tgit_odb *db, const git_oid *id)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_odb_object *object;\n\n\tassert(db && id && out && len_p && type_p);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\t*len_p = object->cached.size;\n\t\t*type_p = object->cached.type;\n\t\t*out = object;\n\t\treturn 0;\n\t}\n\n\t*out = NULL;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->read_header != NULL)\n\t\t\terror = b->read_header(len_p, type_p, b, id);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/*\n\t * no backend could read only the header.\n\t * try reading the whole object and freeing the contents\n\t */\n\tif ((error = git_odb_read(&object, db, id)) < 0)\n\t\treturn error; /* error already set - pass along */\n\n\t*len_p = object->cached.size;\n\t*type_p = object->cached.type;\n\t*out = object;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_read_header(size_t *len_p, git_otype *type_p, git_odb *db, const git_oid *id)\n{\n\tint error;\n\tgit_odb_object *object;\n\n\terror = git_odb__read_header_or_object(&object, len_p, type_p, db, id);\n\n\tif (object)\n\t\tgit_odb_object_free(object);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_odb_exists_prefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "709-747",
    "snippet": "int git_odb_exists_prefix(\n\tgit_oid *out, git_odb *db, const git_oid *short_id, size_t len)\n{\n\tint error;\n\tgit_oid key = {{0}}; \n\n\tassert(db && short_id);\n\n\tif (len < GIT_OID_MINPREFIXLEN)\n\t\treturn git_odb__error_ambiguous(\"prefix length too short\");\n\tif (len > GIT_OID_HEXSZ)\n\t\tlen = GIT_OID_HEXSZ;\n\n\tif (len == GIT_OID_HEXSZ) {\n\t\tif (git_odb_exists(db, short_id)) {\n\t\t\tif (out)\n\t\t\t\tgit_oid_cpy(out, short_id);\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn git_odb__error_notfound(\n\t\t\t\t\"no match for id prefix\", short_id, len);\n\t\t}\n\t}\n\n\t/* just copy valid part of short_id */\n\tmemcpy(&key.id, short_id->id, (len + 1) / 2);\n\tif (len & 1)\n\t\tkey.id[len / 2] &= 0xF0;\n\n\terror = odb_exists_prefix_1(out, db, &key, len, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_exists_prefix_1(out, db, &key, len, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id prefix\", &key, len);\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb__error_notfound",
          "args": [
            "\"no match for id prefix\"",
            "&key",
            "len"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_notfound",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1220-1232",
          "snippet": "int git_odb__error_notfound(\n\tconst char *message, const git_oid *oid, size_t oid_len)\n{\n\tif (oid != NULL) {\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\tgit_oid_tostr(oid_str, oid_len+1, oid);\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s (%.*s)\",\n\t\t\tmessage, oid_len, oid_str);\n\t} else\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s\", message);\n\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__error_notfound(\n\tconst char *message, const git_oid *oid, size_t oid_len)\n{\n\tif (oid != NULL) {\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\tgit_oid_tostr(oid_str, oid_len+1, oid);\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s (%.*s)\",\n\t\t\tmessage, oid_len, oid_str);\n\t} else\n\t\tgiterr_set(GITERR_ODB, \"Object not found - %s\", message);\n\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_exists_prefix_1",
          "args": [
            "out",
            "db",
            "&key",
            "len",
            "true"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "odb_exists_prefix_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "667-707",
          "snippet": "static int odb_exists_prefix_1(git_oid *out, git_odb *db,\n\tconst git_oid *key, size_t len, bool only_refreshed)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND, num_found = 0;\n\tgit_oid last_found = {{0}}, found;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (!b->exists_prefix)\n\t\t\tcontinue;\n\n\t\terror = b->exists_prefix(&found, b, key, len);\n\t\tif (error == GIT_ENOTFOUND || error == GIT_PASSTHROUGH)\n\t\t\tcontinue;\n\t\tif (error)\n\t\t\treturn error;\n\n\t\t/* make sure found item doesn't introduce ambiguity */\n\t\tif (num_found) {\n\t\t\tif (git_oid__cmp(&last_found, &found))\n\t\t\t\treturn git_odb__error_ambiguous(\"multiple matches for prefix\");\n\t\t} else {\n\t\t\tgit_oid_cpy(&last_found, &found);\n\t\t\tnum_found++;\n\t\t}\n\t}\n\n\tif (!num_found)\n\t\treturn GIT_ENOTFOUND;\n\n\tif (out)\n\t\tgit_oid_cpy(out, &last_found);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int odb_exists_prefix_1(git_oid *out, git_odb *db,\n\tconst git_oid *key, size_t len, bool only_refreshed)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND, num_found = 0;\n\tgit_oid last_found = {{0}}, found;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (!b->exists_prefix)\n\t\t\tcontinue;\n\n\t\terror = b->exists_prefix(&found, b, key, len);\n\t\tif (error == GIT_ENOTFOUND || error == GIT_PASSTHROUGH)\n\t\t\tcontinue;\n\t\tif (error)\n\t\t\treturn error;\n\n\t\t/* make sure found item doesn't introduce ambiguity */\n\t\tif (num_found) {\n\t\t\tif (git_oid__cmp(&last_found, &found))\n\t\t\t\treturn git_odb__error_ambiguous(\"multiple matches for prefix\");\n\t\t} else {\n\t\t\tgit_oid_cpy(&last_found, &found);\n\t\t\tnum_found++;\n\t\t}\n\t}\n\n\tif (!num_found)\n\t\treturn GIT_ENOTFOUND;\n\n\tif (out)\n\t\tgit_oid_cpy(out, &last_found);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_refresh",
          "args": [
            "db"
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_refresh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1201-1218",
          "snippet": "int git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&key.id",
            "short_id->id",
            "(len + 1) / 2"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "out",
            "short_id"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_exists",
          "args": [
            "db",
            "short_id"
          ],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "646-665",
          "snippet": "int git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__error_ambiguous",
          "args": [
            "\"prefix length too short\""
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_ambiguous",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1234-1238",
          "snippet": "int git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && short_id"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_exists_prefix(\n\tgit_oid *out, git_odb *db, const git_oid *short_id, size_t len)\n{\n\tint error;\n\tgit_oid key = {{0}}; \n\n\tassert(db && short_id);\n\n\tif (len < GIT_OID_MINPREFIXLEN)\n\t\treturn git_odb__error_ambiguous(\"prefix length too short\");\n\tif (len > GIT_OID_HEXSZ)\n\t\tlen = GIT_OID_HEXSZ;\n\n\tif (len == GIT_OID_HEXSZ) {\n\t\tif (git_odb_exists(db, short_id)) {\n\t\t\tif (out)\n\t\t\t\tgit_oid_cpy(out, short_id);\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn git_odb__error_notfound(\n\t\t\t\t\"no match for id prefix\", short_id, len);\n\t\t}\n\t}\n\n\t/* just copy valid part of short_id */\n\tmemcpy(&key.id, short_id->id, (len + 1) / 2);\n\tif (len & 1)\n\t\tkey.id[len / 2] &= 0xF0;\n\n\terror = odb_exists_prefix_1(out, db, &key, len, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_exists_prefix_1(out, db, &key, len, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id prefix\", &key, len);\n\n\treturn error;\n}"
  },
  {
    "function_name": "odb_exists_prefix_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "667-707",
    "snippet": "static int odb_exists_prefix_1(git_oid *out, git_odb *db,\n\tconst git_oid *key, size_t len, bool only_refreshed)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND, num_found = 0;\n\tgit_oid last_found = {{0}}, found;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (!b->exists_prefix)\n\t\t\tcontinue;\n\n\t\terror = b->exists_prefix(&found, b, key, len);\n\t\tif (error == GIT_ENOTFOUND || error == GIT_PASSTHROUGH)\n\t\t\tcontinue;\n\t\tif (error)\n\t\t\treturn error;\n\n\t\t/* make sure found item doesn't introduce ambiguity */\n\t\tif (num_found) {\n\t\t\tif (git_oid__cmp(&last_found, &found))\n\t\t\t\treturn git_odb__error_ambiguous(\"multiple matches for prefix\");\n\t\t} else {\n\t\t\tgit_oid_cpy(&last_found, &found);\n\t\t\tnum_found++;\n\t\t}\n\t}\n\n\tif (!num_found)\n\t\treturn GIT_ENOTFOUND;\n\n\tif (out)\n\t\tgit_oid_cpy(out, &last_found);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "out",
            "&last_found"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__error_ambiguous",
          "args": [
            "\"multiple matches for prefix\""
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__error_ambiguous",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1234-1238",
          "snippet": "int git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__error_ambiguous(const char *message)\n{\n\tgiterr_set(GITERR_ODB, \"Ambiguous SHA1 prefix - %s\", message);\n\treturn GIT_EAMBIGUOUS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid__cmp",
          "args": [
            "&last_found",
            "&found"
          ],
          "line": 692
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid__cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.h",
          "lines": "42-45",
          "snippet": "GIT_INLINE(int) git_oid__cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__hashcmp(a->id, b->id);\n}",
          "includes": [
            "#include \"git2/oid.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n\nGIT_INLINE(int) git_oid__cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__hashcmp(a->id, b->id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->exists_prefix",
          "args": [
            "&found",
            "b",
            "key",
            "len"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int odb_exists_prefix_1(git_oid *out, git_odb *db,\n\tconst git_oid *key, size_t len, bool only_refreshed)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND, num_found = 0;\n\tgit_oid last_found = {{0}}, found;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (!b->exists_prefix)\n\t\t\tcontinue;\n\n\t\terror = b->exists_prefix(&found, b, key, len);\n\t\tif (error == GIT_ENOTFOUND || error == GIT_PASSTHROUGH)\n\t\t\tcontinue;\n\t\tif (error)\n\t\t\treturn error;\n\n\t\t/* make sure found item doesn't introduce ambiguity */\n\t\tif (num_found) {\n\t\t\tif (git_oid__cmp(&last_found, &found))\n\t\t\t\treturn git_odb__error_ambiguous(\"multiple matches for prefix\");\n\t\t} else {\n\t\t\tgit_oid_cpy(&last_found, &found);\n\t\t\tnum_found++;\n\t\t}\n\t}\n\n\tif (!num_found)\n\t\treturn GIT_ENOTFOUND;\n\n\tif (out)\n\t\tgit_oid_cpy(out, &last_found);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb_exists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "646-665",
    "snippet": "int git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "odb_exists_1",
          "args": [
            "db",
            "id",
            "true"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "odb_exists_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "627-644",
          "snippet": "static int odb_exists_1(git_odb *db, const git_oid *id, bool only_refreshed)\n{\n\tsize_t i;\n\tbool found = false;\n\n\tfor (i = 0; i < db->backends.length && !found; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->exists != NULL)\n\t\t\tfound = (bool)b->exists(b, id);\n\t}\n\n\treturn (int)found;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int odb_exists_1(git_odb *db, const git_oid *id, bool only_refreshed)\n{\n\tsize_t i;\n\tbool found = false;\n\n\tfor (i = 0; i < db->backends.length && !found; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->exists != NULL)\n\t\t\tfound = (bool)b->exists(b, id);\n\t}\n\n\treturn (int)found;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_refresh",
          "args": [
            "db"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_refresh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1201-1218",
          "snippet": "int git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_refresh(struct git_odb *db)\n{\n\tsize_t i;\n\tassert(db);\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->refresh != NULL) {\n\t\t\tint error = b->refresh(b);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_object_free",
          "args": [
            "object"
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "137-143",
          "snippet": "void git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cache_get_raw",
          "args": [
            "odb_cache(db)",
            "id"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_get_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "247-250",
          "snippet": "git_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}"
        }
      },
      {
        "call_info": {
          "callee": "odb_cache",
          "args": [
            "db"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "odb_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "41-49",
          "snippet": "static git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && id"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}"
  },
  {
    "function_name": "odb_exists_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "627-644",
    "snippet": "static int odb_exists_1(git_odb *db, const git_oid *id, bool only_refreshed)\n{\n\tsize_t i;\n\tbool found = false;\n\n\tfor (i = 0; i < db->backends.length && !found; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->exists != NULL)\n\t\t\tfound = (bool)b->exists(b, id);\n\t}\n\n\treturn (int)found;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b->exists",
          "args": [
            "b",
            "id"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int odb_exists_1(git_odb *db, const git_oid *id, bool only_refreshed)\n{\n\tsize_t i;\n\tbool found = false;\n\n\tfor (i = 0; i < db->backends.length && !found; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (only_refreshed && !b->refresh)\n\t\t\tcontinue;\n\n\t\tif (b->exists != NULL)\n\t\t\tfound = (bool)b->exists(b, id);\n\t}\n\n\treturn (int)found;\n}"
  },
  {
    "function_name": "git_odb_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "619-625",
    "snippet": "void git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_DEC",
          "args": [
            "db",
            "odb_free"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}"
  },
  {
    "function_name": "odb_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "599-617",
    "snippet": "static void odb_free(git_odb *db)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *backend = internal->backend;\n\n\t\tbackend->free(backend);\n\n\t\tgit__free(internal);\n\t}\n\n\tgit_vector_free(&db->backends);\n\tgit_cache_free(&db->own_cache);\n\n\tgit__memzero(db, sizeof(*db));\n\tgit__free(db);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "db"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__memzero",
          "args": [
            "db",
            "sizeof(*db)"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "git__memzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "521-531",
          "snippet": "GIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cache_free",
          "args": [
            "&db->own_cache"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "106-112",
          "snippet": "void git_cache_free(git_cache *cache)\n{\n\tgit_cache_clear(cache);\n\tgit_oidmap_free(cache->map);\n\tgit_rwlock_free(&cache->lock);\n\tgit__memzero(cache, sizeof(*cache));\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cache_free(git_cache *cache)\n{\n\tgit_cache_clear(cache);\n\tgit_oidmap_free(cache->map);\n\tgit_rwlock_free(&cache->lock);\n\tgit__memzero(cache, sizeof(*cache));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "&db->backends"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->free",
          "args": [
            "backend"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic void odb_free(git_odb *db)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *backend = internal->backend;\n\n\t\tbackend->free(backend);\n\n\t\tgit__free(internal);\n\t}\n\n\tgit_vector_free(&db->backends);\n\tgit_cache_free(&db->own_cache);\n\n\tgit__memzero(db, sizeof(*db));\n\tgit__free(db);\n}"
  },
  {
    "function_name": "git_odb_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "579-597",
    "snippet": "int git_odb_open(git_odb **out, const char *objects_dir)\n{\n\tgit_odb *db;\n\n\tassert(out && objects_dir);\n\n\t*out = NULL;\n\n\tif (git_odb_new(&db) < 0)\n\t\treturn -1;\n\n\tif (add_default_backends(db, objects_dir, 0, 0) < 0) {\n\t\tgit_odb_free(db);\n\t\treturn -1;\n\t}\n\n\t*out = db;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_free",
          "args": [
            "db"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "619-625",
          "snippet": "void git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_default_backends",
          "args": [
            "db",
            "objects_dir",
            "0",
            "0"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "add_default_backends",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "474-519",
          "snippet": "static int add_default_backends(\n\tgit_odb *db, const char *objects_dir,\n\tbool as_alternates, int alternate_depth)\n{\n\tsize_t i;\n\tstruct stat st;\n\tino_t inode;\n\tgit_odb_backend *loose, *packed;\n\n\t/* TODO: inodes are not really relevant on Win32, so we need to find\n\t * a cross-platform workaround for this */\n#ifdef GIT_WIN32\n\tGIT_UNUSED(i);\n\tGIT_UNUSED(st);\n\n\tinode = 0;\n#else\n\tif (p_stat(objects_dir, &st) < 0) {\n\t\tif (as_alternates)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_ODB, \"Failed to load object database in '%s'\", objects_dir);\n\t\treturn -1;\n\t}\n\n\tinode = st.st_ino;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *backend = git_vector_get(&db->backends, i);\n\t\tif (backend->disk_inode == inode)\n\t\t\treturn 0;\n\t}\n#endif\n\n\t/* add the loose object backend */\n\tif (git_odb_backend_loose(&loose, objects_dir, -1, 0, 0, 0) < 0 ||\n\t\tadd_backend_internal(db, loose, GIT_LOOSE_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\t/* add the packed file backend */\n\tif (git_odb_backend_pack(&packed, objects_dir) < 0 ||\n\t\tadd_backend_internal(db, packed, GIT_PACKED_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\treturn load_alternates(db, objects_dir, alternate_depth);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define GIT_PACKED_PRIORITY 2",
            "#define GIT_LOOSE_PRIORITY 1"
          ],
          "globals_used": [
            "static int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\n#define GIT_PACKED_PRIORITY 2\n#define GIT_LOOSE_PRIORITY 1\n\nstatic int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);\n\nstatic int add_default_backends(\n\tgit_odb *db, const char *objects_dir,\n\tbool as_alternates, int alternate_depth)\n{\n\tsize_t i;\n\tstruct stat st;\n\tino_t inode;\n\tgit_odb_backend *loose, *packed;\n\n\t/* TODO: inodes are not really relevant on Win32, so we need to find\n\t * a cross-platform workaround for this */\n#ifdef GIT_WIN32\n\tGIT_UNUSED(i);\n\tGIT_UNUSED(st);\n\n\tinode = 0;\n#else\n\tif (p_stat(objects_dir, &st) < 0) {\n\t\tif (as_alternates)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_ODB, \"Failed to load object database in '%s'\", objects_dir);\n\t\treturn -1;\n\t}\n\n\tinode = st.st_ino;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *backend = git_vector_get(&db->backends, i);\n\t\tif (backend->disk_inode == inode)\n\t\t\treturn 0;\n\t}\n#endif\n\n\t/* add the loose object backend */\n\tif (git_odb_backend_loose(&loose, objects_dir, -1, 0, 0, 0) < 0 ||\n\t\tadd_backend_internal(db, loose, GIT_LOOSE_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\t/* add the packed file backend */\n\tif (git_odb_backend_pack(&packed, objects_dir) < 0 ||\n\t\tadd_backend_internal(db, packed, GIT_PACKED_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\treturn load_alternates(db, objects_dir, alternate_depth);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_new",
          "args": [
            "&db"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "387-401",
          "snippet": "int git_odb_new(git_odb **out)\n{\n\tgit_odb *db = git__calloc(1, sizeof(*db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tif (git_cache_init(&db->own_cache) < 0 ||\n\t\tgit_vector_init(&db->backends, 4, backend_sort_cmp) < 0) {\n\t\tgit__free(db);\n\t\treturn -1;\n\t}\n\n\t*out = db;\n\tGIT_REFCOUNT_INC(db);\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_new(git_odb **out)\n{\n\tgit_odb *db = git__calloc(1, sizeof(*db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tif (git_cache_init(&db->own_cache) < 0 ||\n\t\tgit_vector_init(&db->backends, 4, backend_sort_cmp) < 0) {\n\t\tgit__free(db);\n\t\treturn -1;\n\t}\n\n\t*out = db;\n\tGIT_REFCOUNT_INC(db);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && objects_dir"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_open(git_odb **out, const char *objects_dir)\n{\n\tgit_odb *db;\n\n\tassert(out && objects_dir);\n\n\t*out = NULL;\n\n\tif (git_odb_new(&db) < 0)\n\t\treturn -1;\n\n\tif (add_default_backends(db, objects_dir, 0, 0) < 0) {\n\t\tgit_odb_free(db);\n\t\treturn -1;\n\t}\n\n\t*out = db;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb_add_disk_alternate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "574-577",
    "snippet": "int git_odb_add_disk_alternate(git_odb *odb, const char *path)\n{\n\treturn add_default_backends(odb, path, true, 0);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_default_backends",
          "args": [
            "odb",
            "path",
            "true",
            "0"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "add_default_backends",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "474-519",
          "snippet": "static int add_default_backends(\n\tgit_odb *db, const char *objects_dir,\n\tbool as_alternates, int alternate_depth)\n{\n\tsize_t i;\n\tstruct stat st;\n\tino_t inode;\n\tgit_odb_backend *loose, *packed;\n\n\t/* TODO: inodes are not really relevant on Win32, so we need to find\n\t * a cross-platform workaround for this */\n#ifdef GIT_WIN32\n\tGIT_UNUSED(i);\n\tGIT_UNUSED(st);\n\n\tinode = 0;\n#else\n\tif (p_stat(objects_dir, &st) < 0) {\n\t\tif (as_alternates)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_ODB, \"Failed to load object database in '%s'\", objects_dir);\n\t\treturn -1;\n\t}\n\n\tinode = st.st_ino;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *backend = git_vector_get(&db->backends, i);\n\t\tif (backend->disk_inode == inode)\n\t\t\treturn 0;\n\t}\n#endif\n\n\t/* add the loose object backend */\n\tif (git_odb_backend_loose(&loose, objects_dir, -1, 0, 0, 0) < 0 ||\n\t\tadd_backend_internal(db, loose, GIT_LOOSE_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\t/* add the packed file backend */\n\tif (git_odb_backend_pack(&packed, objects_dir) < 0 ||\n\t\tadd_backend_internal(db, packed, GIT_PACKED_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\treturn load_alternates(db, objects_dir, alternate_depth);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define GIT_PACKED_PRIORITY 2",
            "#define GIT_LOOSE_PRIORITY 1"
          ],
          "globals_used": [
            "static int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\n#define GIT_PACKED_PRIORITY 2\n#define GIT_LOOSE_PRIORITY 1\n\nstatic int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);\n\nstatic int add_default_backends(\n\tgit_odb *db, const char *objects_dir,\n\tbool as_alternates, int alternate_depth)\n{\n\tsize_t i;\n\tstruct stat st;\n\tino_t inode;\n\tgit_odb_backend *loose, *packed;\n\n\t/* TODO: inodes are not really relevant on Win32, so we need to find\n\t * a cross-platform workaround for this */\n#ifdef GIT_WIN32\n\tGIT_UNUSED(i);\n\tGIT_UNUSED(st);\n\n\tinode = 0;\n#else\n\tif (p_stat(objects_dir, &st) < 0) {\n\t\tif (as_alternates)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_ODB, \"Failed to load object database in '%s'\", objects_dir);\n\t\treturn -1;\n\t}\n\n\tinode = st.st_ino;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *backend = git_vector_get(&db->backends, i);\n\t\tif (backend->disk_inode == inode)\n\t\t\treturn 0;\n\t}\n#endif\n\n\t/* add the loose object backend */\n\tif (git_odb_backend_loose(&loose, objects_dir, -1, 0, 0, 0) < 0 ||\n\t\tadd_backend_internal(db, loose, GIT_LOOSE_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\t/* add the packed file backend */\n\tif (git_odb_backend_pack(&packed, objects_dir) < 0 ||\n\t\tadd_backend_internal(db, packed, GIT_PACKED_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\treturn load_alternates(db, objects_dir, alternate_depth);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_add_disk_alternate(git_odb *odb, const char *path)\n{\n\treturn add_default_backends(odb, path, true, 0);\n}"
  },
  {
    "function_name": "load_alternates",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "521-572",
    "snippet": "static int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth)\n{\n\tgit_buf alternates_path = GIT_BUF_INIT;\n\tgit_buf alternates_buf = GIT_BUF_INIT;\n\tchar *buffer;\n\tconst char *alternate;\n\tint result = 0;\n\n\t/* Git reports an error, we just ignore anything deeper */\n\tif (alternate_depth > GIT_ALTERNATES_MAX_DEPTH)\n\t\treturn 0;\n\n\tif (git_buf_joinpath(&alternates_path, objects_dir, GIT_ALTERNATES_FILE) < 0)\n\t\treturn -1;\n\n\tif (git_path_exists(alternates_path.ptr) == false) {\n\t\tgit_buf_free(&alternates_path);\n\t\treturn 0;\n\t}\n\n\tif (git_futils_readbuffer(&alternates_buf, alternates_path.ptr) < 0) {\n\t\tgit_buf_free(&alternates_path);\n\t\treturn -1;\n\t}\n\n\tbuffer = (char *)alternates_buf.ptr;\n\n\t/* add each alternate as a new backend; one alternate per line */\n\twhile ((alternate = git__strtok(&buffer, \"\\r\\n\")) != NULL) {\n\t\tif (*alternate == '\\0' || *alternate == '#')\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * Relative path: build based on the current `objects`\n\t\t * folder. However, relative paths are only allowed in\n\t\t * the current repository.\n\t\t */\n\t\tif (*alternate == '.' && !alternate_depth) {\n\t\t\tif ((result = git_buf_joinpath(&alternates_path, objects_dir, alternate)) < 0)\n\t\t\t\tbreak;\n\t\t\talternate = git_buf_cstr(&alternates_path);\n\t\t}\n\n\t\tif ((result = add_default_backends(odb, alternate, true, alternate_depth + 1)) < 0)\n\t\t\tbreak;\n\t}\n\n\tgit_buf_free(&alternates_path);\n\tgit_buf_free(&alternates_buf);\n\n\treturn result;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define GIT_ALTERNATES_MAX_DEPTH 5",
      "#define GIT_ALTERNATES_FILE \"info/alternates\""
    ],
    "globals_used": [
      "static int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&alternates_buf"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_default_backends",
          "args": [
            "odb",
            "alternate",
            "true",
            "alternate_depth + 1"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "add_default_backends",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "474-519",
          "snippet": "static int add_default_backends(\n\tgit_odb *db, const char *objects_dir,\n\tbool as_alternates, int alternate_depth)\n{\n\tsize_t i;\n\tstruct stat st;\n\tino_t inode;\n\tgit_odb_backend *loose, *packed;\n\n\t/* TODO: inodes are not really relevant on Win32, so we need to find\n\t * a cross-platform workaround for this */\n#ifdef GIT_WIN32\n\tGIT_UNUSED(i);\n\tGIT_UNUSED(st);\n\n\tinode = 0;\n#else\n\tif (p_stat(objects_dir, &st) < 0) {\n\t\tif (as_alternates)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_ODB, \"Failed to load object database in '%s'\", objects_dir);\n\t\treturn -1;\n\t}\n\n\tinode = st.st_ino;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *backend = git_vector_get(&db->backends, i);\n\t\tif (backend->disk_inode == inode)\n\t\t\treturn 0;\n\t}\n#endif\n\n\t/* add the loose object backend */\n\tif (git_odb_backend_loose(&loose, objects_dir, -1, 0, 0, 0) < 0 ||\n\t\tadd_backend_internal(db, loose, GIT_LOOSE_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\t/* add the packed file backend */\n\tif (git_odb_backend_pack(&packed, objects_dir) < 0 ||\n\t\tadd_backend_internal(db, packed, GIT_PACKED_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\treturn load_alternates(db, objects_dir, alternate_depth);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define GIT_PACKED_PRIORITY 2",
            "#define GIT_LOOSE_PRIORITY 1"
          ],
          "globals_used": [
            "static int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\n#define GIT_PACKED_PRIORITY 2\n#define GIT_LOOSE_PRIORITY 1\n\nstatic int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);\n\nstatic int add_default_backends(\n\tgit_odb *db, const char *objects_dir,\n\tbool as_alternates, int alternate_depth)\n{\n\tsize_t i;\n\tstruct stat st;\n\tino_t inode;\n\tgit_odb_backend *loose, *packed;\n\n\t/* TODO: inodes are not really relevant on Win32, so we need to find\n\t * a cross-platform workaround for this */\n#ifdef GIT_WIN32\n\tGIT_UNUSED(i);\n\tGIT_UNUSED(st);\n\n\tinode = 0;\n#else\n\tif (p_stat(objects_dir, &st) < 0) {\n\t\tif (as_alternates)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_ODB, \"Failed to load object database in '%s'\", objects_dir);\n\t\treturn -1;\n\t}\n\n\tinode = st.st_ino;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *backend = git_vector_get(&db->backends, i);\n\t\tif (backend->disk_inode == inode)\n\t\t\treturn 0;\n\t}\n#endif\n\n\t/* add the loose object backend */\n\tif (git_odb_backend_loose(&loose, objects_dir, -1, 0, 0, 0) < 0 ||\n\t\tadd_backend_internal(db, loose, GIT_LOOSE_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\t/* add the packed file backend */\n\tif (git_odb_backend_pack(&packed, objects_dir) < 0 ||\n\t\tadd_backend_internal(db, packed, GIT_PACKED_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\treturn load_alternates(db, objects_dir, alternate_depth);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&alternates_path"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&alternates_path",
            "objects_dir",
            "alternate"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strtok",
          "args": [
            "&buffer",
            "\"\\r\\n\""
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "git__strtok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "281-304",
          "snippet": "char *git__strtok(char **end, const char *sep)\n{\n\tchar *ptr = *end;\n\n\twhile (*ptr && strchr(sep, *ptr))\n\t\t++ptr;\n\n\tif (*ptr) {\n\t\tchar *start = ptr;\n\t\t*end = start + 1;\n\n\t\twhile (**end && !strchr(sep, **end))\n\t\t\t++*end;\n\n\t\tif (**end) {\n\t\t\t**end = '\\0';\n\t\t\t++*end;\n\t\t}\n\n\t\treturn start;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nchar *git__strtok(char **end, const char *sep)\n{\n\tchar *ptr = *end;\n\n\twhile (*ptr && strchr(sep, *ptr))\n\t\t++ptr;\n\n\tif (*ptr) {\n\t\tchar *start = ptr;\n\t\t*end = start + 1;\n\n\t\twhile (**end && !strchr(sep, **end))\n\t\t\t++*end;\n\n\t\tif (**end) {\n\t\t\t**end = '\\0';\n\t\t\t++*end;\n\t\t}\n\n\t\treturn start;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_readbuffer",
          "args": [
            "&alternates_buf",
            "alternates_path.ptr"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_readbuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "224-227",
          "snippet": "int git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_exists",
          "args": [
            "alternates_path.ptr"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "503-507",
          "snippet": "bool git_path_exists(const char *path)\n{\n\tassert(path);\n\treturn p_access(path, F_OK) == 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_exists(const char *path)\n{\n\tassert(path);\n\treturn p_access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\n#define GIT_ALTERNATES_MAX_DEPTH 5\n#define GIT_ALTERNATES_FILE \"info/alternates\"\n\nstatic int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);\n\nstatic int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth)\n{\n\tgit_buf alternates_path = GIT_BUF_INIT;\n\tgit_buf alternates_buf = GIT_BUF_INIT;\n\tchar *buffer;\n\tconst char *alternate;\n\tint result = 0;\n\n\t/* Git reports an error, we just ignore anything deeper */\n\tif (alternate_depth > GIT_ALTERNATES_MAX_DEPTH)\n\t\treturn 0;\n\n\tif (git_buf_joinpath(&alternates_path, objects_dir, GIT_ALTERNATES_FILE) < 0)\n\t\treturn -1;\n\n\tif (git_path_exists(alternates_path.ptr) == false) {\n\t\tgit_buf_free(&alternates_path);\n\t\treturn 0;\n\t}\n\n\tif (git_futils_readbuffer(&alternates_buf, alternates_path.ptr) < 0) {\n\t\tgit_buf_free(&alternates_path);\n\t\treturn -1;\n\t}\n\n\tbuffer = (char *)alternates_buf.ptr;\n\n\t/* add each alternate as a new backend; one alternate per line */\n\twhile ((alternate = git__strtok(&buffer, \"\\r\\n\")) != NULL) {\n\t\tif (*alternate == '\\0' || *alternate == '#')\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * Relative path: build based on the current `objects`\n\t\t * folder. However, relative paths are only allowed in\n\t\t * the current repository.\n\t\t */\n\t\tif (*alternate == '.' && !alternate_depth) {\n\t\t\tif ((result = git_buf_joinpath(&alternates_path, objects_dir, alternate)) < 0)\n\t\t\t\tbreak;\n\t\t\talternate = git_buf_cstr(&alternates_path);\n\t\t}\n\n\t\tif ((result = add_default_backends(odb, alternate, true, alternate_depth + 1)) < 0)\n\t\t\tbreak;\n\t}\n\n\tgit_buf_free(&alternates_path);\n\tgit_buf_free(&alternates_buf);\n\n\treturn result;\n}"
  },
  {
    "function_name": "add_default_backends",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "474-519",
    "snippet": "static int add_default_backends(\n\tgit_odb *db, const char *objects_dir,\n\tbool as_alternates, int alternate_depth)\n{\n\tsize_t i;\n\tstruct stat st;\n\tino_t inode;\n\tgit_odb_backend *loose, *packed;\n\n\t/* TODO: inodes are not really relevant on Win32, so we need to find\n\t * a cross-platform workaround for this */\n#ifdef GIT_WIN32\n\tGIT_UNUSED(i);\n\tGIT_UNUSED(st);\n\n\tinode = 0;\n#else\n\tif (p_stat(objects_dir, &st) < 0) {\n\t\tif (as_alternates)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_ODB, \"Failed to load object database in '%s'\", objects_dir);\n\t\treturn -1;\n\t}\n\n\tinode = st.st_ino;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *backend = git_vector_get(&db->backends, i);\n\t\tif (backend->disk_inode == inode)\n\t\t\treturn 0;\n\t}\n#endif\n\n\t/* add the loose object backend */\n\tif (git_odb_backend_loose(&loose, objects_dir, -1, 0, 0, 0) < 0 ||\n\t\tadd_backend_internal(db, loose, GIT_LOOSE_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\t/* add the packed file backend */\n\tif (git_odb_backend_pack(&packed, objects_dir) < 0 ||\n\t\tadd_backend_internal(db, packed, GIT_PACKED_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\treturn load_alternates(db, objects_dir, alternate_depth);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define GIT_PACKED_PRIORITY 2",
      "#define GIT_LOOSE_PRIORITY 1"
    ],
    "globals_used": [
      "static int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "load_alternates",
          "args": [
            "db",
            "objects_dir",
            "alternate_depth"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "load_alternates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "521-572",
          "snippet": "static int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth)\n{\n\tgit_buf alternates_path = GIT_BUF_INIT;\n\tgit_buf alternates_buf = GIT_BUF_INIT;\n\tchar *buffer;\n\tconst char *alternate;\n\tint result = 0;\n\n\t/* Git reports an error, we just ignore anything deeper */\n\tif (alternate_depth > GIT_ALTERNATES_MAX_DEPTH)\n\t\treturn 0;\n\n\tif (git_buf_joinpath(&alternates_path, objects_dir, GIT_ALTERNATES_FILE) < 0)\n\t\treturn -1;\n\n\tif (git_path_exists(alternates_path.ptr) == false) {\n\t\tgit_buf_free(&alternates_path);\n\t\treturn 0;\n\t}\n\n\tif (git_futils_readbuffer(&alternates_buf, alternates_path.ptr) < 0) {\n\t\tgit_buf_free(&alternates_path);\n\t\treturn -1;\n\t}\n\n\tbuffer = (char *)alternates_buf.ptr;\n\n\t/* add each alternate as a new backend; one alternate per line */\n\twhile ((alternate = git__strtok(&buffer, \"\\r\\n\")) != NULL) {\n\t\tif (*alternate == '\\0' || *alternate == '#')\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * Relative path: build based on the current `objects`\n\t\t * folder. However, relative paths are only allowed in\n\t\t * the current repository.\n\t\t */\n\t\tif (*alternate == '.' && !alternate_depth) {\n\t\t\tif ((result = git_buf_joinpath(&alternates_path, objects_dir, alternate)) < 0)\n\t\t\t\tbreak;\n\t\t\talternate = git_buf_cstr(&alternates_path);\n\t\t}\n\n\t\tif ((result = add_default_backends(odb, alternate, true, alternate_depth + 1)) < 0)\n\t\t\tbreak;\n\t}\n\n\tgit_buf_free(&alternates_path);\n\tgit_buf_free(&alternates_buf);\n\n\treturn result;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define GIT_ALTERNATES_MAX_DEPTH 5",
            "#define GIT_ALTERNATES_FILE \"info/alternates\""
          ],
          "globals_used": [
            "static int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\n#define GIT_ALTERNATES_MAX_DEPTH 5\n#define GIT_ALTERNATES_FILE \"info/alternates\"\n\nstatic int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);\n\nstatic int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth)\n{\n\tgit_buf alternates_path = GIT_BUF_INIT;\n\tgit_buf alternates_buf = GIT_BUF_INIT;\n\tchar *buffer;\n\tconst char *alternate;\n\tint result = 0;\n\n\t/* Git reports an error, we just ignore anything deeper */\n\tif (alternate_depth > GIT_ALTERNATES_MAX_DEPTH)\n\t\treturn 0;\n\n\tif (git_buf_joinpath(&alternates_path, objects_dir, GIT_ALTERNATES_FILE) < 0)\n\t\treturn -1;\n\n\tif (git_path_exists(alternates_path.ptr) == false) {\n\t\tgit_buf_free(&alternates_path);\n\t\treturn 0;\n\t}\n\n\tif (git_futils_readbuffer(&alternates_buf, alternates_path.ptr) < 0) {\n\t\tgit_buf_free(&alternates_path);\n\t\treturn -1;\n\t}\n\n\tbuffer = (char *)alternates_buf.ptr;\n\n\t/* add each alternate as a new backend; one alternate per line */\n\twhile ((alternate = git__strtok(&buffer, \"\\r\\n\")) != NULL) {\n\t\tif (*alternate == '\\0' || *alternate == '#')\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * Relative path: build based on the current `objects`\n\t\t * folder. However, relative paths are only allowed in\n\t\t * the current repository.\n\t\t */\n\t\tif (*alternate == '.' && !alternate_depth) {\n\t\t\tif ((result = git_buf_joinpath(&alternates_path, objects_dir, alternate)) < 0)\n\t\t\t\tbreak;\n\t\t\talternate = git_buf_cstr(&alternates_path);\n\t\t}\n\n\t\tif ((result = add_default_backends(odb, alternate, true, alternate_depth + 1)) < 0)\n\t\t\tbreak;\n\t}\n\n\tgit_buf_free(&alternates_path);\n\tgit_buf_free(&alternates_buf);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_backend_internal",
          "args": [
            "db",
            "packed",
            "GIT_PACKED_PRIORITY",
            "as_alternates",
            "inode"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "add_backend_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "403-432",
          "snippet": "static int add_backend_internal(\n\tgit_odb *odb, git_odb_backend *backend,\n\tint priority, bool is_alternate, ino_t disk_inode)\n{\n\tbackend_internal *internal;\n\n\tassert(odb && backend);\n\n\tGITERR_CHECK_VERSION(backend, GIT_ODB_BACKEND_VERSION, \"git_odb_backend\");\n\n\t/* Check if the backend is already owned by another ODB */\n\tassert(!backend->odb || backend->odb == odb);\n\n\tinternal = git__malloc(sizeof(backend_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tinternal->backend = backend;\n\tinternal->priority = priority;\n\tinternal->is_alternate = is_alternate;\n\tinternal->disk_inode = disk_inode;\n\n\tif (git_vector_insert(&odb->backends, internal) < 0) {\n\t\tgit__free(internal);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&odb->backends);\n\tinternal->backend->odb = odb;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int add_backend_internal(\n\tgit_odb *odb, git_odb_backend *backend,\n\tint priority, bool is_alternate, ino_t disk_inode)\n{\n\tbackend_internal *internal;\n\n\tassert(odb && backend);\n\n\tGITERR_CHECK_VERSION(backend, GIT_ODB_BACKEND_VERSION, \"git_odb_backend\");\n\n\t/* Check if the backend is already owned by another ODB */\n\tassert(!backend->odb || backend->odb == odb);\n\n\tinternal = git__malloc(sizeof(backend_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tinternal->backend = backend;\n\tinternal->priority = priority;\n\tinternal->is_alternate = is_alternate;\n\tinternal->disk_inode = disk_inode;\n\n\tif (git_vector_insert(&odb->backends, internal) < 0) {\n\t\tgit__free(internal);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&odb->backends);\n\tinternal->backend->odb = odb;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_backend_pack",
          "args": [
            "&packed",
            "objects_dir"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_backend_pack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_pack.c",
          "lines": "588-614",
          "snippet": "int git_odb_backend_pack(git_odb_backend **backend_out, const char *objects_dir)\n{\n\tint error = 0;\n\tstruct pack_backend *backend = NULL;\n\tgit_buf path = GIT_BUF_INIT;\n\n\tif (pack_backend__alloc(&backend, 8) < 0)\n\t\treturn -1;\n\n\tif (!(error = git_buf_joinpath(&path, objects_dir, \"pack\")) &&\n\t\tgit_path_isdir(git_buf_cstr(&path)))\n\t{\n\t\tbackend->pack_folder = git_buf_detach(&path);\n\t\terror = pack_backend__refresh((git_odb_backend *)backend);\n\t}\n\n\tif (error < 0) {\n\t\tpack_backend__free((git_odb_backend *)backend);\n\t\tbackend = NULL;\n\t}\n\n\t*backend_out = (git_odb_backend *)backend;\n\n\tgit_buf_free(&path);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/odb_backend.h\"",
            "#include \"pack.h\"",
            "#include \"mwindow.h\"",
            "#include \"sha1_lookup.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/repository.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int packfile_load__cb(void *_data, git_buf *path);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/odb_backend.h\"\n#include \"pack.h\"\n#include \"mwindow.h\"\n#include \"sha1_lookup.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/indexer.h\"\n#include \"git2/repository.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int packfile_load__cb(void *_data, git_buf *path);\n\nint git_odb_backend_pack(git_odb_backend **backend_out, const char *objects_dir)\n{\n\tint error = 0;\n\tstruct pack_backend *backend = NULL;\n\tgit_buf path = GIT_BUF_INIT;\n\n\tif (pack_backend__alloc(&backend, 8) < 0)\n\t\treturn -1;\n\n\tif (!(error = git_buf_joinpath(&path, objects_dir, \"pack\")) &&\n\t\tgit_path_isdir(git_buf_cstr(&path)))\n\t{\n\t\tbackend->pack_folder = git_buf_detach(&path);\n\t\terror = pack_backend__refresh((git_odb_backend *)backend);\n\t}\n\n\tif (error < 0) {\n\t\tpack_backend__free((git_odb_backend *)backend);\n\t\tbackend = NULL;\n\t}\n\n\t*backend_out = (git_odb_backend *)backend;\n\n\tgit_buf_free(&path);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_backend_loose",
          "args": [
            "&loose",
            "objects_dir",
            "-1",
            "0",
            "0",
            "0"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_backend_loose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_loose.c",
          "lines": "930-982",
          "snippet": "int git_odb_backend_loose(\n\tgit_odb_backend **backend_out,\n\tconst char *objects_dir,\n\tint compression_level,\n\tint do_fsync,\n\tunsigned int dir_mode,\n\tunsigned int file_mode)\n{\n\tloose_backend *backend;\n\tsize_t objects_dirlen, alloclen;\n\n\tassert(backend_out && objects_dir);\n\n\tobjects_dirlen = strlen(objects_dir);\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, sizeof(loose_backend), objects_dirlen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 2);\n\tbackend = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(backend);\n\n\tbackend->parent.version = GIT_ODB_BACKEND_VERSION;\n\tbackend->objects_dirlen = objects_dirlen;\n\tmemcpy(backend->objects_dir, objects_dir, objects_dirlen);\n\tif (backend->objects_dir[backend->objects_dirlen - 1] != '/')\n\t\tbackend->objects_dir[backend->objects_dirlen++] = '/';\n\n\tif (compression_level < 0)\n\t\tcompression_level = Z_BEST_SPEED;\n\n\tif (dir_mode == 0)\n\t\tdir_mode = GIT_OBJECT_DIR_MODE;\n\n\tif (file_mode == 0)\n\t\tfile_mode = GIT_OBJECT_FILE_MODE;\n\n\tbackend->object_zlib_level = compression_level;\n\tbackend->fsync_object_files = do_fsync;\n\tbackend->object_dir_mode = dir_mode;\n\tbackend->object_file_mode = file_mode;\n\n\tbackend->parent.read = &loose_backend__read;\n\tbackend->parent.write = &loose_backend__write;\n\tbackend->parent.read_prefix = &loose_backend__read_prefix;\n\tbackend->parent.read_header = &loose_backend__read_header;\n\tbackend->parent.writestream = &loose_backend__stream;\n\tbackend->parent.exists = &loose_backend__exists;\n\tbackend->parent.exists_prefix = &loose_backend__exists_prefix;\n\tbackend->parent.foreach = &loose_backend__foreach;\n\tbackend->parent.free = &loose_backend__free;\n\n\t*backend_out = (git_odb_backend *)backend;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/types.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"filebuf.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/types.h\"\n#include \"git2/odb_backend.h\"\n#include \"filebuf.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_backend_loose(\n\tgit_odb_backend **backend_out,\n\tconst char *objects_dir,\n\tint compression_level,\n\tint do_fsync,\n\tunsigned int dir_mode,\n\tunsigned int file_mode)\n{\n\tloose_backend *backend;\n\tsize_t objects_dirlen, alloclen;\n\n\tassert(backend_out && objects_dir);\n\n\tobjects_dirlen = strlen(objects_dir);\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, sizeof(loose_backend), objects_dirlen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 2);\n\tbackend = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(backend);\n\n\tbackend->parent.version = GIT_ODB_BACKEND_VERSION;\n\tbackend->objects_dirlen = objects_dirlen;\n\tmemcpy(backend->objects_dir, objects_dir, objects_dirlen);\n\tif (backend->objects_dir[backend->objects_dirlen - 1] != '/')\n\t\tbackend->objects_dir[backend->objects_dirlen++] = '/';\n\n\tif (compression_level < 0)\n\t\tcompression_level = Z_BEST_SPEED;\n\n\tif (dir_mode == 0)\n\t\tdir_mode = GIT_OBJECT_DIR_MODE;\n\n\tif (file_mode == 0)\n\t\tfile_mode = GIT_OBJECT_FILE_MODE;\n\n\tbackend->object_zlib_level = compression_level;\n\tbackend->fsync_object_files = do_fsync;\n\tbackend->object_dir_mode = dir_mode;\n\tbackend->object_file_mode = file_mode;\n\n\tbackend->parent.read = &loose_backend__read;\n\tbackend->parent.write = &loose_backend__write;\n\tbackend->parent.read_prefix = &loose_backend__read_prefix;\n\tbackend->parent.read_header = &loose_backend__read_header;\n\tbackend->parent.writestream = &loose_backend__stream;\n\tbackend->parent.exists = &loose_backend__exists;\n\tbackend->parent.exists_prefix = &loose_backend__exists_prefix;\n\tbackend->parent.foreach = &loose_backend__foreach;\n\tbackend->parent.free = &loose_backend__free;\n\n\t*backend_out = (git_odb_backend *)backend;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&db->backends",
            "i"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_ODB",
            "\"Failed to load object database in '%s'\"",
            "objects_dir"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_stat",
          "args": [
            "objects_dir",
            "&st"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "p_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "417-432",
          "snippet": "int p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "st"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "i"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\n#define GIT_PACKED_PRIORITY 2\n#define GIT_LOOSE_PRIORITY 1\n\nstatic int load_alternates(git_odb *odb, const char *objects_dir, int alternate_depth);\n\nstatic int add_default_backends(\n\tgit_odb *db, const char *objects_dir,\n\tbool as_alternates, int alternate_depth)\n{\n\tsize_t i;\n\tstruct stat st;\n\tino_t inode;\n\tgit_odb_backend *loose, *packed;\n\n\t/* TODO: inodes are not really relevant on Win32, so we need to find\n\t * a cross-platform workaround for this */\n#ifdef GIT_WIN32\n\tGIT_UNUSED(i);\n\tGIT_UNUSED(st);\n\n\tinode = 0;\n#else\n\tif (p_stat(objects_dir, &st) < 0) {\n\t\tif (as_alternates)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_ODB, \"Failed to load object database in '%s'\", objects_dir);\n\t\treturn -1;\n\t}\n\n\tinode = st.st_ino;\n\n\tfor (i = 0; i < db->backends.length; ++i) {\n\t\tbackend_internal *backend = git_vector_get(&db->backends, i);\n\t\tif (backend->disk_inode == inode)\n\t\t\treturn 0;\n\t}\n#endif\n\n\t/* add the loose object backend */\n\tif (git_odb_backend_loose(&loose, objects_dir, -1, 0, 0, 0) < 0 ||\n\t\tadd_backend_internal(db, loose, GIT_LOOSE_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\t/* add the packed file backend */\n\tif (git_odb_backend_pack(&packed, objects_dir) < 0 ||\n\t\tadd_backend_internal(db, packed, GIT_PACKED_PRIORITY, as_alternates, inode) < 0)\n\t\treturn -1;\n\n\treturn load_alternates(db, objects_dir, alternate_depth);\n}"
  },
  {
    "function_name": "git_odb_get_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "458-472",
    "snippet": "int git_odb_get_backend(git_odb_backend **out, git_odb *odb, size_t pos)\n{\n\tbackend_internal *internal;\n\n\tassert(out && odb);\n\tinternal = git_vector_get(&odb->backends, pos);\n\n\tif (internal && internal->backend) {\n\t\t*out = internal->backend;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_ODB, \"No ODB backend loaded at index %\" PRIuZ, pos);\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_ODB",
            "\"No ODB backend loaded at index %\" PRIuZ",
            "pos"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&odb->backends",
            "pos"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && odb"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_get_backend(git_odb_backend **out, git_odb *odb, size_t pos)\n{\n\tbackend_internal *internal;\n\n\tassert(out && odb);\n\tinternal = git_vector_get(&odb->backends, pos);\n\n\tif (internal && internal->backend) {\n\t\t*out = internal->backend;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_ODB, \"No ODB backend loaded at index %\" PRIuZ, pos);\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git_odb__error_unsupported_in_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "450-455",
    "snippet": "static int git_odb__error_unsupported_in_backend(const char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - unsupported in the loaded odb backends\", action);\n\treturn -1;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_ODB",
            "\"Cannot %s - unsupported in the loaded odb backends\"",
            "action"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int git_odb__error_unsupported_in_backend(const char *action)\n{\n\tgiterr_set(GITERR_ODB,\n\t\t\"Cannot %s - unsupported in the loaded odb backends\", action);\n\treturn -1;\n}"
  },
  {
    "function_name": "git_odb_num_backends",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "444-448",
    "snippet": "size_t git_odb_num_backends(git_odb *odb)\n{\n\tassert(odb);\n\treturn odb->backends.length;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "odb"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nsize_t git_odb_num_backends(git_odb *odb)\n{\n\tassert(odb);\n\treturn odb->backends.length;\n}"
  },
  {
    "function_name": "git_odb_add_alternate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "439-442",
    "snippet": "int git_odb_add_alternate(git_odb *odb, git_odb_backend *backend, int priority)\n{\n\treturn add_backend_internal(odb, backend, priority, true, 0);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_backend_internal",
          "args": [
            "odb",
            "backend",
            "priority",
            "true",
            "0"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "add_backend_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "403-432",
          "snippet": "static int add_backend_internal(\n\tgit_odb *odb, git_odb_backend *backend,\n\tint priority, bool is_alternate, ino_t disk_inode)\n{\n\tbackend_internal *internal;\n\n\tassert(odb && backend);\n\n\tGITERR_CHECK_VERSION(backend, GIT_ODB_BACKEND_VERSION, \"git_odb_backend\");\n\n\t/* Check if the backend is already owned by another ODB */\n\tassert(!backend->odb || backend->odb == odb);\n\n\tinternal = git__malloc(sizeof(backend_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tinternal->backend = backend;\n\tinternal->priority = priority;\n\tinternal->is_alternate = is_alternate;\n\tinternal->disk_inode = disk_inode;\n\n\tif (git_vector_insert(&odb->backends, internal) < 0) {\n\t\tgit__free(internal);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&odb->backends);\n\tinternal->backend->odb = odb;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int add_backend_internal(\n\tgit_odb *odb, git_odb_backend *backend,\n\tint priority, bool is_alternate, ino_t disk_inode)\n{\n\tbackend_internal *internal;\n\n\tassert(odb && backend);\n\n\tGITERR_CHECK_VERSION(backend, GIT_ODB_BACKEND_VERSION, \"git_odb_backend\");\n\n\t/* Check if the backend is already owned by another ODB */\n\tassert(!backend->odb || backend->odb == odb);\n\n\tinternal = git__malloc(sizeof(backend_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tinternal->backend = backend;\n\tinternal->priority = priority;\n\tinternal->is_alternate = is_alternate;\n\tinternal->disk_inode = disk_inode;\n\n\tif (git_vector_insert(&odb->backends, internal) < 0) {\n\t\tgit__free(internal);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&odb->backends);\n\tinternal->backend->odb = odb;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_add_alternate(git_odb *odb, git_odb_backend *backend, int priority)\n{\n\treturn add_backend_internal(odb, backend, priority, true, 0);\n}"
  },
  {
    "function_name": "git_odb_add_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "434-437",
    "snippet": "int git_odb_add_backend(git_odb *odb, git_odb_backend *backend, int priority)\n{\n\treturn add_backend_internal(odb, backend, priority, false, 0);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_backend_internal",
          "args": [
            "odb",
            "backend",
            "priority",
            "false",
            "0"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "add_backend_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "403-432",
          "snippet": "static int add_backend_internal(\n\tgit_odb *odb, git_odb_backend *backend,\n\tint priority, bool is_alternate, ino_t disk_inode)\n{\n\tbackend_internal *internal;\n\n\tassert(odb && backend);\n\n\tGITERR_CHECK_VERSION(backend, GIT_ODB_BACKEND_VERSION, \"git_odb_backend\");\n\n\t/* Check if the backend is already owned by another ODB */\n\tassert(!backend->odb || backend->odb == odb);\n\n\tinternal = git__malloc(sizeof(backend_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tinternal->backend = backend;\n\tinternal->priority = priority;\n\tinternal->is_alternate = is_alternate;\n\tinternal->disk_inode = disk_inode;\n\n\tif (git_vector_insert(&odb->backends, internal) < 0) {\n\t\tgit__free(internal);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&odb->backends);\n\tinternal->backend->odb = odb;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int add_backend_internal(\n\tgit_odb *odb, git_odb_backend *backend,\n\tint priority, bool is_alternate, ino_t disk_inode)\n{\n\tbackend_internal *internal;\n\n\tassert(odb && backend);\n\n\tGITERR_CHECK_VERSION(backend, GIT_ODB_BACKEND_VERSION, \"git_odb_backend\");\n\n\t/* Check if the backend is already owned by another ODB */\n\tassert(!backend->odb || backend->odb == odb);\n\n\tinternal = git__malloc(sizeof(backend_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tinternal->backend = backend;\n\tinternal->priority = priority;\n\tinternal->is_alternate = is_alternate;\n\tinternal->disk_inode = disk_inode;\n\n\tif (git_vector_insert(&odb->backends, internal) < 0) {\n\t\tgit__free(internal);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&odb->backends);\n\tinternal->backend->odb = odb;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_add_backend(git_odb *odb, git_odb_backend *backend, int priority)\n{\n\treturn add_backend_internal(odb, backend, priority, false, 0);\n}"
  },
  {
    "function_name": "add_backend_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "403-432",
    "snippet": "static int add_backend_internal(\n\tgit_odb *odb, git_odb_backend *backend,\n\tint priority, bool is_alternate, ino_t disk_inode)\n{\n\tbackend_internal *internal;\n\n\tassert(odb && backend);\n\n\tGITERR_CHECK_VERSION(backend, GIT_ODB_BACKEND_VERSION, \"git_odb_backend\");\n\n\t/* Check if the backend is already owned by another ODB */\n\tassert(!backend->odb || backend->odb == odb);\n\n\tinternal = git__malloc(sizeof(backend_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tinternal->backend = backend;\n\tinternal->priority = priority;\n\tinternal->is_alternate = is_alternate;\n\tinternal->disk_inode = disk_inode;\n\n\tif (git_vector_insert(&odb->backends, internal) < 0) {\n\t\tgit__free(internal);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&odb->backends);\n\tinternal->backend->odb = odb;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_sort",
          "args": [
            "&odb->backends"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_sort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "175-185",
          "snippet": "void git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "internal"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&odb->backends",
            "internal"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "internal"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(backend_internal)"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!backend->odb || backend->odb == odb"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_VERSION",
          "args": [
            "backend",
            "GIT_ODB_BACKEND_VERSION",
            "\"git_odb_backend\""
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "odb && backend"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int add_backend_internal(\n\tgit_odb *odb, git_odb_backend *backend,\n\tint priority, bool is_alternate, ino_t disk_inode)\n{\n\tbackend_internal *internal;\n\n\tassert(odb && backend);\n\n\tGITERR_CHECK_VERSION(backend, GIT_ODB_BACKEND_VERSION, \"git_odb_backend\");\n\n\t/* Check if the backend is already owned by another ODB */\n\tassert(!backend->odb || backend->odb == odb);\n\n\tinternal = git__malloc(sizeof(backend_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tinternal->backend = backend;\n\tinternal->priority = priority;\n\tinternal->is_alternate = is_alternate;\n\tinternal->disk_inode = disk_inode;\n\n\tif (git_vector_insert(&odb->backends, internal) < 0) {\n\t\tgit__free(internal);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&odb->backends);\n\tinternal->backend->odb = odb;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "387-401",
    "snippet": "int git_odb_new(git_odb **out)\n{\n\tgit_odb *db = git__calloc(1, sizeof(*db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tif (git_cache_init(&db->own_cache) < 0 ||\n\t\tgit_vector_init(&db->backends, 4, backend_sort_cmp) < 0) {\n\t\tgit__free(db);\n\t\treturn -1;\n\t}\n\n\t*out = db;\n\tGIT_REFCOUNT_INC(db);\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "db"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "db"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "&db->backends",
            "4",
            "backend_sort_cmp"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cache_init",
          "args": [
            "&db->own_cache"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "67-77",
          "snippet": "int git_cache_init(git_cache *cache)\n{\n\tmemset(cache, 0, sizeof(*cache));\n\tcache->map = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(cache->map);\n\tif (git_rwlock_init(&cache->lock)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize cache rwlock\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_cache_init(git_cache *cache)\n{\n\tmemset(cache, 0, sizeof(*cache));\n\tcache->map = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(cache->map);\n\tif (git_rwlock_init(&cache->lock)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize cache rwlock\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "db"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(*db)"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_new(git_odb **out)\n{\n\tgit_odb *db = git__calloc(1, sizeof(*db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tif (git_cache_init(&db->own_cache) < 0 ||\n\t\tgit_vector_init(&db->backends, 4, backend_sort_cmp) < 0) {\n\t\tgit__free(db);\n\t\treturn -1;\n\t}\n\n\t*out = db;\n\tGIT_REFCOUNT_INC(db);\n\treturn 0;\n}"
  },
  {
    "function_name": "backend_sort_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "372-385",
    "snippet": "static int backend_sort_cmp(const void *a, const void *b)\n{\n\tconst backend_internal *backend_a = (const backend_internal *)(a);\n\tconst backend_internal *backend_b = (const backend_internal *)(b);\n\n\tif (backend_b->priority == backend_a->priority) {\n\t\tif (backend_a->is_alternate)\n\t\t\treturn -1;\n\t\tif (backend_b->is_alternate)\n\t\t\treturn 1;\n\t\treturn 0;\n\t}\n\treturn (backend_b->priority - backend_a->priority);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int backend_sort_cmp(const void *a, const void *b)\n{\n\tconst backend_internal *backend_a = (const backend_internal *)(a);\n\tconst backend_internal *backend_b = (const backend_internal *)(b);\n\n\tif (backend_b->priority == backend_a->priority) {\n\t\tif (backend_a->is_alternate)\n\t\t\treturn -1;\n\t\tif (backend_b->is_alternate)\n\t\t\treturn 1;\n\t\treturn 0;\n\t}\n\treturn (backend_b->priority - backend_a->priority);\n}"
  },
  {
    "function_name": "init_fake_wstream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "333-362",
    "snippet": "static int init_fake_wstream(git_odb_stream **stream_p, git_odb_backend *backend, git_off_t size, git_otype type)\n{\n\tfake_wstream *stream;\n\n\tif (!git__is_ssizet(size)) {\n\t\tgiterr_set(GITERR_ODB, \"object size too large to keep in memory\");\n\t\treturn -1;\n\t}\n\n\tstream = git__calloc(1, sizeof(fake_wstream));\n\tGITERR_CHECK_ALLOC(stream);\n\n\tstream->size = size;\n\tstream->type = type;\n\tstream->buffer = git__malloc(size);\n\tif (stream->buffer == NULL) {\n\t\tgit__free(stream);\n\t\treturn -1;\n\t}\n\n\tstream->stream.backend = backend;\n\tstream->stream.read = NULL; /* read only */\n\tstream->stream.write = &fake_wstream__write;\n\tstream->stream.finalize_write = &fake_wstream__fwrite;\n\tstream->stream.free = &fake_wstream__free;\n\tstream->stream.mode = GIT_STREAM_WRONLY;\n\n\t*stream_p = (git_odb_stream *)stream;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "stream"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "size"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "stream"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(fake_wstream)"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_ODB",
            "\"object size too large to keep in memory\""
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__is_ssizet",
          "args": [
            "size"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "git__is_ssizet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/integer.h",
          "lines": "18-22",
          "snippet": "GIT_INLINE(int) git__is_ssizet(size_t p)\n{\n\tssize_t r = (ssize_t)p;\n\treturn p == (size_t)r;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "GIT_INLINE(int) git__is_ssizet(size_t p)\n{\n\tssize_t r = (ssize_t)p;\n\treturn p == (size_t)r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int init_fake_wstream(git_odb_stream **stream_p, git_odb_backend *backend, git_off_t size, git_otype type)\n{\n\tfake_wstream *stream;\n\n\tif (!git__is_ssizet(size)) {\n\t\tgiterr_set(GITERR_ODB, \"object size too large to keep in memory\");\n\t\treturn -1;\n\t}\n\n\tstream = git__calloc(1, sizeof(fake_wstream));\n\tGITERR_CHECK_ALLOC(stream);\n\n\tstream->size = size;\n\tstream->type = type;\n\tstream->buffer = git__malloc(size);\n\tif (stream->buffer == NULL) {\n\t\tgit__free(stream);\n\t\treturn -1;\n\t}\n\n\tstream->stream.backend = backend;\n\tstream->stream.read = NULL; /* read only */\n\tstream->stream.write = &fake_wstream__write;\n\tstream->stream.finalize_write = &fake_wstream__fwrite;\n\tstream->stream.free = &fake_wstream__free;\n\tstream->stream.mode = GIT_STREAM_WRONLY;\n\n\t*stream_p = (git_odb_stream *)stream;\n\treturn 0;\n}"
  },
  {
    "function_name": "fake_wstream__free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "325-331",
    "snippet": "static void fake_wstream__free(git_odb_stream *_stream)\n{\n\tfake_wstream *stream = (fake_wstream *)_stream;\n\n\tgit__free(stream->buffer);\n\tgit__free(stream);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "stream"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic void fake_wstream__free(git_odb_stream *_stream)\n{\n\tfake_wstream *stream = (fake_wstream *)_stream;\n\n\tgit__free(stream->buffer);\n\tgit__free(stream);\n}"
  },
  {
    "function_name": "fake_wstream__write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "313-323",
    "snippet": "static int fake_wstream__write(git_odb_stream *_stream, const char *data, size_t len)\n{\n\tfake_wstream *stream = (fake_wstream *)_stream;\n\n\tif (stream->written + len > stream->size)\n\t\treturn -1;\n\n\tmemcpy(stream->buffer + stream->written, data, len);\n\tstream->written += len;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "stream->buffer + stream->written",
            "data",
            "len"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int fake_wstream__write(git_odb_stream *_stream, const char *data, size_t len)\n{\n\tfake_wstream *stream = (fake_wstream *)_stream;\n\n\tif (stream->written + len > stream->size)\n\t\treturn -1;\n\n\tmemcpy(stream->buffer + stream->written, data, len);\n\tstream->written += len;\n\treturn 0;\n}"
  },
  {
    "function_name": "fake_wstream__fwrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "307-311",
    "snippet": "static int fake_wstream__fwrite(git_odb_stream *_stream, const git_oid *oid)\n{\n\tfake_wstream *stream = (fake_wstream *)_stream;\n\treturn _stream->backend->write(_stream->backend, oid, stream->buffer, stream->size, stream->type);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_stream->backend->write",
          "args": [
            "_stream->backend",
            "oid",
            "stream->buffer",
            "stream->size",
            "stream->type"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic int fake_wstream__fwrite(git_odb_stream *_stream, const git_oid *oid)\n{\n\tfake_wstream *stream = (fake_wstream *)_stream;\n\treturn _stream->backend->write(_stream->backend, oid, stream->buffer, stream->size, stream->type);\n}"
  },
  {
    "function_name": "git_odb_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "283-294",
    "snippet": "int git_odb_hash(git_oid *id, const void *data, size_t len, git_otype type)\n{\n\tgit_rawobj raw;\n\n\tassert(id);\n\n\traw.data = (void *)data;\n\traw.len = len;\n\traw.type = type;\n\n\treturn git_odb__hashobj(id, &raw);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb__hashobj",
          "args": [
            "id",
            "&raw"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__hashobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "61-85",
          "snippet": "int git_odb__hashobj(git_oid *id, git_rawobj *obj)\n{\n\tgit_buf_vec vec[2];\n\tchar header[64];\n\tint hdrlen;\n\n\tassert(id && obj);\n\n\tif (!git_object_typeisloose(obj->type))\n\t\treturn -1;\n\n\tif (!obj->data && obj->len != 0)\n\t\treturn -1;\n\n\thdrlen = git_odb__format_object_header(header, sizeof(header), obj->len, obj->type);\n\n\tvec[0].data = header;\n\tvec[0].len = hdrlen;\n\tvec[1].data = obj->data;\n\tvec[1].len = obj->len;\n\n\tgit_hash_vec(id, vec, 2);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__hashobj(git_oid *id, git_rawobj *obj)\n{\n\tgit_buf_vec vec[2];\n\tchar header[64];\n\tint hdrlen;\n\n\tassert(id && obj);\n\n\tif (!git_object_typeisloose(obj->type))\n\t\treturn -1;\n\n\tif (!obj->data && obj->len != 0)\n\t\treturn -1;\n\n\thdrlen = git_odb__format_object_header(header, sizeof(header), obj->len, obj->type);\n\n\tvec[0].data = header;\n\tvec[0].len = hdrlen;\n\tvec[1].data = obj->data;\n\tvec[1].len = obj->len;\n\n\tgit_hash_vec(id, vec, 2);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "id"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_hash(git_oid *id, const void *data, size_t len, git_otype type)\n{\n\tgit_rawobj raw;\n\n\tassert(id);\n\n\traw.data = (void *)data;\n\traw.len = len;\n\traw.type = type;\n\n\treturn git_odb__hashobj(id, &raw);\n}"
  },
  {
    "function_name": "git_odb_hashfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "265-281",
    "snippet": "int git_odb_hashfile(git_oid *out, const char *path, git_otype type)\n{\n\tgit_off_t size;\n\tint result, fd = git_futils_open_ro(path);\n\tif (fd < 0)\n\t\treturn fd;\n\n\tif ((size = git_futils_filesize(fd)) < 0 || !git__is_sizet(size)) {\n\t\tgiterr_set(GITERR_OS, \"File size overflow for 32-bit systems\");\n\t\tp_close(fd);\n\t\treturn -1;\n\t}\n\n\tresult = git_odb__hashfd(out, fd, (size_t)size, type);\n\tp_close(fd);\n\treturn result;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p_close",
          "args": [
            "fd"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "winhttp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/winhttp.c",
          "lines": "1359-1377",
          "snippet": "static int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}",
          "includes": [
            "#include <urlmon.h>",
            "#include <objbase.h>",
            "#include <winhttp.h>",
            "#include <wincrypt.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"remote.h\"",
            "#include \"smart.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <urlmon.h>\n#include <objbase.h>\n#include <winhttp.h>\n#include <wincrypt.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"remote.h\"\n#include \"smart.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"git2.h\"\n\nstatic int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__hashfd",
          "args": [
            "out",
            "fd",
            "(size_t)size",
            "type"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__hashfd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "145-188",
          "snippet": "int git_odb__hashfd(git_oid *out, git_file fd, size_t size, git_otype type)\n{\n\tint hdr_len;\n\tchar hdr[64], buffer[FILEIO_BUFSIZE];\n\tgit_hash_ctx ctx;\n\tssize_t read_len = 0;\n\tint error = 0;\n\n\tif (!git_object_typeisloose(type)) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid object type for hash\");\n\t\treturn -1;\n\t}\n\n\tif ((error = git_hash_ctx_init(&ctx)) < 0)\n\t\treturn -1;\n\n\thdr_len = git_odb__format_object_header(hdr, sizeof(hdr), size, type);\n\n\tif ((error = git_hash_update(&ctx, hdr, hdr_len)) < 0)\n\t\tgoto done;\n\n\twhile (size > 0 && (read_len = p_read(fd, buffer, sizeof(buffer))) > 0) {\n\t\tif ((error = git_hash_update(&ctx, buffer, read_len)) < 0)\n\t\t\tgoto done;\n\n\t\tsize -= read_len;\n\t}\n\n\t/* If p_read returned an error code, the read obviously failed.\n\t * If size is not zero, the file was truncated after we originally\n\t * stat'd it, so we consider this a read failure too */\n\tif (read_len < 0 || size > 0) {\n\t\tgiterr_set(GITERR_OS, \"Error reading file for hashing\");\n\t\terror = -1;\n\n\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__hashfd(git_oid *out, git_file fd, size_t size, git_otype type)\n{\n\tint hdr_len;\n\tchar hdr[64], buffer[FILEIO_BUFSIZE];\n\tgit_hash_ctx ctx;\n\tssize_t read_len = 0;\n\tint error = 0;\n\n\tif (!git_object_typeisloose(type)) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid object type for hash\");\n\t\treturn -1;\n\t}\n\n\tif ((error = git_hash_ctx_init(&ctx)) < 0)\n\t\treturn -1;\n\n\thdr_len = git_odb__format_object_header(hdr, sizeof(hdr), size, type);\n\n\tif ((error = git_hash_update(&ctx, hdr, hdr_len)) < 0)\n\t\tgoto done;\n\n\twhile (size > 0 && (read_len = p_read(fd, buffer, sizeof(buffer))) > 0) {\n\t\tif ((error = git_hash_update(&ctx, buffer, read_len)) < 0)\n\t\t\tgoto done;\n\n\t\tsize -= read_len;\n\t}\n\n\t/* If p_read returned an error code, the read obviously failed.\n\t * If size is not zero, the file was truncated after we originally\n\t * stat'd it, so we consider this a read failure too */\n\tif (read_len < 0 || size > 0) {\n\t\tgiterr_set(GITERR_OS, \"Error reading file for hashing\");\n\t\terror = -1;\n\n\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"File size overflow for 32-bit systems\""
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__is_sizet",
          "args": [
            "size"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "git__is_sizet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/integer.h",
          "lines": "11-15",
          "snippet": "GIT_INLINE(int) git__is_sizet(git_off_t p)\n{\n\tsize_t r = (size_t)p;\n\treturn p == (git_off_t)r;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "GIT_INLINE(int) git__is_sizet(git_off_t p)\n{\n\tsize_t r = (size_t)p;\n\treturn p == (git_off_t)r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_filesize",
          "args": [
            "fd"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_filesize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "98-108",
          "snippet": "git_off_t git_futils_filesize(git_file fd)\n{\n\tstruct stat sb;\n\n\tif (p_fstat(fd, &sb)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to stat file descriptor\");\n\t\treturn -1;\n\t}\n\n\treturn sb.st_size;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\ngit_off_t git_futils_filesize(git_file fd)\n{\n\tstruct stat sb;\n\n\tif (p_fstat(fd, &sb)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to stat file descriptor\");\n\t\treturn -1;\n\t}\n\n\treturn sb.st_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_open_ro",
          "args": [
            "path"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_open_ro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "90-96",
          "snippet": "int git_futils_open_ro(const char *path)\n{\n\tint fd = p_open(path, O_RDONLY);\n\tif (fd < 0)\n\t\treturn git_path_set_error(errno, path, \"open\");\n\treturn fd;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_open_ro(const char *path)\n{\n\tint fd = p_open(path, O_RDONLY);\n\tif (fd < 0)\n\t\treturn git_path_set_error(errno, path, \"open\");\n\treturn fd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_hashfile(git_oid *out, const char *path, git_otype type)\n{\n\tgit_off_t size;\n\tint result, fd = git_futils_open_ro(path);\n\tif (fd < 0)\n\t\treturn fd;\n\n\tif ((size = git_futils_filesize(fd)) < 0 || !git__is_sizet(size)) {\n\t\tgiterr_set(GITERR_OS, \"File size overflow for 32-bit systems\");\n\t\tp_close(fd);\n\t\treturn -1;\n\t}\n\n\tresult = git_odb__hashfd(out, fd, (size_t)size, type);\n\tp_close(fd);\n\treturn result;\n}"
  },
  {
    "function_name": "git_odb__hashlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "219-263",
    "snippet": "int git_odb__hashlink(git_oid *out, const char *path)\n{\n\tstruct stat st;\n\tint size;\n\tint result;\n\n\tif (git_path_lstat(path, &st) < 0)\n\t\treturn -1;\n\n\tif (!git__is_int(st.st_size) || (int)st.st_size < 0) {\n\t\tgiterr_set(GITERR_FILESYSTEM, \"File size overflow for 32-bit systems\");\n\t\treturn -1;\n\t}\n\n\tsize = (int)st.st_size;\n\n\tif (S_ISLNK(st.st_mode)) {\n\t\tchar *link_data;\n\t\tint read_len;\n\t\tsize_t alloc_size;\n\n\t\tGITERR_CHECK_ALLOC_ADD(&alloc_size, size, 1);\n\t\tlink_data = git__malloc(alloc_size);\n\t\tGITERR_CHECK_ALLOC(link_data);\n\n\t\tread_len = p_readlink(path, link_data, size);\n\t\tlink_data[size] = '\\0';\n\t\tif (read_len != size) {\n\t\t\tgiterr_set(GITERR_OS, \"Failed to read symlink data for '%s'\", path);\n\t\t\tgit__free(link_data);\n\t\t\treturn -1;\n\t\t}\n\n\t\tresult = git_odb_hash(out, link_data, size, GIT_OBJ_BLOB);\n\t\tgit__free(link_data);\n\t} else {\n\t\tint fd = git_futils_open_ro(path);\n\t\tif (fd < 0)\n\t\t\treturn -1;\n\t\tresult = git_odb__hashfd(out, fd, size, GIT_OBJ_BLOB);\n\t\tp_close(fd);\n\t}\n\n\treturn result;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p_close",
          "args": [
            "fd"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "winhttp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/winhttp.c",
          "lines": "1359-1377",
          "snippet": "static int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}",
          "includes": [
            "#include <urlmon.h>",
            "#include <objbase.h>",
            "#include <winhttp.h>",
            "#include <wincrypt.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"remote.h\"",
            "#include \"smart.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <urlmon.h>\n#include <objbase.h>\n#include <winhttp.h>\n#include <wincrypt.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"remote.h\"\n#include \"smart.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"git2.h\"\n\nstatic int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__hashfd",
          "args": [
            "out",
            "fd",
            "size",
            "GIT_OBJ_BLOB"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__hashfd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "145-188",
          "snippet": "int git_odb__hashfd(git_oid *out, git_file fd, size_t size, git_otype type)\n{\n\tint hdr_len;\n\tchar hdr[64], buffer[FILEIO_BUFSIZE];\n\tgit_hash_ctx ctx;\n\tssize_t read_len = 0;\n\tint error = 0;\n\n\tif (!git_object_typeisloose(type)) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid object type for hash\");\n\t\treturn -1;\n\t}\n\n\tif ((error = git_hash_ctx_init(&ctx)) < 0)\n\t\treturn -1;\n\n\thdr_len = git_odb__format_object_header(hdr, sizeof(hdr), size, type);\n\n\tif ((error = git_hash_update(&ctx, hdr, hdr_len)) < 0)\n\t\tgoto done;\n\n\twhile (size > 0 && (read_len = p_read(fd, buffer, sizeof(buffer))) > 0) {\n\t\tif ((error = git_hash_update(&ctx, buffer, read_len)) < 0)\n\t\t\tgoto done;\n\n\t\tsize -= read_len;\n\t}\n\n\t/* If p_read returned an error code, the read obviously failed.\n\t * If size is not zero, the file was truncated after we originally\n\t * stat'd it, so we consider this a read failure too */\n\tif (read_len < 0 || size > 0) {\n\t\tgiterr_set(GITERR_OS, \"Error reading file for hashing\");\n\t\terror = -1;\n\n\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__hashfd(git_oid *out, git_file fd, size_t size, git_otype type)\n{\n\tint hdr_len;\n\tchar hdr[64], buffer[FILEIO_BUFSIZE];\n\tgit_hash_ctx ctx;\n\tssize_t read_len = 0;\n\tint error = 0;\n\n\tif (!git_object_typeisloose(type)) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid object type for hash\");\n\t\treturn -1;\n\t}\n\n\tif ((error = git_hash_ctx_init(&ctx)) < 0)\n\t\treturn -1;\n\n\thdr_len = git_odb__format_object_header(hdr, sizeof(hdr), size, type);\n\n\tif ((error = git_hash_update(&ctx, hdr, hdr_len)) < 0)\n\t\tgoto done;\n\n\twhile (size > 0 && (read_len = p_read(fd, buffer, sizeof(buffer))) > 0) {\n\t\tif ((error = git_hash_update(&ctx, buffer, read_len)) < 0)\n\t\t\tgoto done;\n\n\t\tsize -= read_len;\n\t}\n\n\t/* If p_read returned an error code, the read obviously failed.\n\t * If size is not zero, the file was truncated after we originally\n\t * stat'd it, so we consider this a read failure too */\n\tif (read_len < 0 || size > 0) {\n\t\tgiterr_set(GITERR_OS, \"Error reading file for hashing\");\n\t\terror = -1;\n\n\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_open_ro",
          "args": [
            "path"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_open_ro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "90-96",
          "snippet": "int git_futils_open_ro(const char *path)\n{\n\tint fd = p_open(path, O_RDONLY);\n\tif (fd < 0)\n\t\treturn git_path_set_error(errno, path, \"open\");\n\treturn fd;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_open_ro(const char *path)\n{\n\tint fd = p_open(path, O_RDONLY);\n\tif (fd < 0)\n\t\treturn git_path_set_error(errno, path, \"open\");\n\treturn fd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "link_data"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_hash",
          "args": [
            "out",
            "link_data",
            "size",
            "GIT_OBJ_BLOB"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "283-294",
          "snippet": "int git_odb_hash(git_oid *id, const void *data, size_t len, git_otype type)\n{\n\tgit_rawobj raw;\n\n\tassert(id);\n\n\traw.data = (void *)data;\n\traw.len = len;\n\traw.type = type;\n\n\treturn git_odb__hashobj(id, &raw);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_hash(git_oid *id, const void *data, size_t len, git_otype type)\n{\n\tgit_rawobj raw;\n\n\tassert(id);\n\n\traw.data = (void *)data;\n\traw.len = len;\n\traw.type = type;\n\n\treturn git_odb__hashobj(id, &raw);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Failed to read symlink data for '%s'\"",
            "path"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_readlink",
          "args": [
            "path",
            "link_data",
            "size"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "p_readlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "251-273",
          "snippet": "int p_readlink(const char *path, char *buf, size_t bufsiz)\n{\n\tgit_win32_path path_w, target_w;\n\tgit_win32_utf8_path target;\n\tint len;\n\n\t/* readlink(2) does not NULL-terminate the string written\n\t * to the target buffer. Furthermore, the target buffer need\n\t * not be large enough to hold the entire result. A truncated\n\t * result should be written in this case. Since this truncation\n\t * could occur in the middle of the encoding of a code point,\n\t * we need to buffer the result on the stack. */\n\n\tif (git_win32_path_from_utf8(path_w, path) < 0 ||\n\t\tgit_win32_path_readlink_w(target_w, path_w) < 0 ||\n\t\t(len = git_win32_path_to_utf8(target, target_w)) < 0)\n\t\treturn -1;\n\n\tbufsiz = min((size_t)len, bufsiz);\n\tmemcpy(buf, target, bufsiz);\n\n\treturn (int)bufsiz;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_readlink(const char *path, char *buf, size_t bufsiz)\n{\n\tgit_win32_path path_w, target_w;\n\tgit_win32_utf8_path target;\n\tint len;\n\n\t/* readlink(2) does not NULL-terminate the string written\n\t * to the target buffer. Furthermore, the target buffer need\n\t * not be large enough to hold the entire result. A truncated\n\t * result should be written in this case. Since this truncation\n\t * could occur in the middle of the encoding of a code point,\n\t * we need to buffer the result on the stack. */\n\n\tif (git_win32_path_from_utf8(path_w, path) < 0 ||\n\t\tgit_win32_path_readlink_w(target_w, path_w) < 0 ||\n\t\t(len = git_win32_path_to_utf8(target, target_w)) < 0)\n\t\treturn -1;\n\n\tbufsiz = min((size_t)len, bufsiz);\n\tmemcpy(buf, target, bufsiz);\n\n\treturn (int)bufsiz;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "link_data"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "alloc_size"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloc_size",
            "size",
            "1"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "st.st_mode"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_FILESYSTEM",
            "\"File size overflow for 32-bit systems\""
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__is_int",
          "args": [
            "st.st_size"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "git__is_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/integer.h",
          "lines": "39-43",
          "snippet": "GIT_INLINE(int) git__is_int(long long p)\n{\n\tint r = (int)p;\n\treturn p == (long long)r;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "GIT_INLINE(int) git__is_int(long long p)\n{\n\tint r = (int)p;\n\treturn p == (long long)r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_lstat",
          "args": [
            "path",
            "&st"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_lstat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "634-640",
          "snippet": "int git_path_lstat(const char *path, struct stat *st)\n{\n\tif (p_lstat(path, st) == 0)\n\t\treturn 0;\n\n\treturn git_path_set_error(errno, path, \"stat\");\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_lstat(const char *path, struct stat *st)\n{\n\tif (p_lstat(path, st) == 0)\n\t\treturn 0;\n\n\treturn git_path_set_error(errno, path, \"stat\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__hashlink(git_oid *out, const char *path)\n{\n\tstruct stat st;\n\tint size;\n\tint result;\n\n\tif (git_path_lstat(path, &st) < 0)\n\t\treturn -1;\n\n\tif (!git__is_int(st.st_size) || (int)st.st_size < 0) {\n\t\tgiterr_set(GITERR_FILESYSTEM, \"File size overflow for 32-bit systems\");\n\t\treturn -1;\n\t}\n\n\tsize = (int)st.st_size;\n\n\tif (S_ISLNK(st.st_mode)) {\n\t\tchar *link_data;\n\t\tint read_len;\n\t\tsize_t alloc_size;\n\n\t\tGITERR_CHECK_ALLOC_ADD(&alloc_size, size, 1);\n\t\tlink_data = git__malloc(alloc_size);\n\t\tGITERR_CHECK_ALLOC(link_data);\n\n\t\tread_len = p_readlink(path, link_data, size);\n\t\tlink_data[size] = '\\0';\n\t\tif (read_len != size) {\n\t\t\tgiterr_set(GITERR_OS, \"Failed to read symlink data for '%s'\", path);\n\t\t\tgit__free(link_data);\n\t\t\treturn -1;\n\t\t}\n\n\t\tresult = git_odb_hash(out, link_data, size, GIT_OBJ_BLOB);\n\t\tgit__free(link_data);\n\t} else {\n\t\tint fd = git_futils_open_ro(path);\n\t\tif (fd < 0)\n\t\t\treturn -1;\n\t\tresult = git_odb__hashfd(out, fd, size, GIT_OBJ_BLOB);\n\t\tp_close(fd);\n\t}\n\n\treturn result;\n}"
  },
  {
    "function_name": "git_odb__hashfd_filtered",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "190-217",
    "snippet": "int git_odb__hashfd_filtered(\n\tgit_oid *out, git_file fd, size_t size, git_otype type, git_filter_list *fl)\n{\n\tint error;\n\tgit_buf raw = GIT_BUF_INIT;\n\n\tif (!fl)\n\t\treturn git_odb__hashfd(out, fd, size, type);\n\n\t/* size of data is used in header, so we have to read the whole file\n\t * into memory to apply filters before beginning to calculate the hash\n\t */\n\n\tif (!(error = git_futils_readbuffer_fd(&raw, fd, size))) {\n\t\tgit_buf post = GIT_BUF_INIT;\n\n\t\terror = git_filter_list_apply_to_data(&post, fl, &raw);\n\n\t\tgit_buf_free(&raw);\n\n\t\tif (!error)\n\t\t\terror = git_odb_hash(out, post.ptr, post.size, type);\n\n\t\tgit_buf_free(&post);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&post"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_hash",
          "args": [
            "out",
            "post.ptr",
            "post.size",
            "type"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "283-294",
          "snippet": "int git_odb_hash(git_oid *id, const void *data, size_t len, git_otype type)\n{\n\tgit_rawobj raw;\n\n\tassert(id);\n\n\traw.data = (void *)data;\n\traw.len = len;\n\traw.type = type;\n\n\treturn git_odb__hashobj(id, &raw);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_hash(git_oid *id, const void *data, size_t len, git_otype type)\n{\n\tgit_rawobj raw;\n\n\tassert(id);\n\n\traw.data = (void *)data;\n\traw.len = len;\n\traw.type = type;\n\n\treturn git_odb__hashobj(id, &raw);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filter_list_apply_to_data",
          "args": [
            "&post",
            "fl",
            "&raw"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_list_apply_to_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "713-735",
          "snippet": "int git_filter_list_apply_to_data(\n\tgit_buf *tgt, git_filter_list *filters, git_buf *src)\n{\n\tstruct buf_stream writer;\n\tint error;\n\n\tgit_buf_sanitize(tgt);\n\tgit_buf_sanitize(src);\n\n\tif (!filters) {\n\t\tgit_buf_attach_notowned(tgt, src->ptr, src->size);\n\t\treturn 0;\n\t}\n\n\tbuf_stream_init(&writer, tgt);\n\n\tif ((error = git_filter_list_stream_data(filters, src,\n\t\t&writer.parent)) < 0)\n\t\t\treturn error;\n\n\tassert(writer.complete);\n\treturn error;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_apply_to_data(\n\tgit_buf *tgt, git_filter_list *filters, git_buf *src)\n{\n\tstruct buf_stream writer;\n\tint error;\n\n\tgit_buf_sanitize(tgt);\n\tgit_buf_sanitize(src);\n\n\tif (!filters) {\n\t\tgit_buf_attach_notowned(tgt, src->ptr, src->size);\n\t\treturn 0;\n\t}\n\n\tbuf_stream_init(&writer, tgt);\n\n\tif ((error = git_filter_list_stream_data(filters, src,\n\t\t&writer.parent)) < 0)\n\t\t\treturn error;\n\n\tassert(writer.complete);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_readbuffer_fd",
          "args": [
            "&raw",
            "fd",
            "size"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_readbuffer_fd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "124-153",
          "snippet": "int git_futils_readbuffer_fd(git_buf *buf, git_file fd, size_t len)\n{\n\tssize_t read_size = 0;\n\tsize_t alloc_len;\n\n\tgit_buf_clear(buf);\n\n\tif (!git__is_ssizet(len)) {\n\t\tgiterr_set(GITERR_INVALID, \"Read too large.\");\n\t\treturn -1;\n\t}\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\n\t/* p_read loops internally to read len bytes */\n\tread_size = p_read(fd, buf->ptr, len);\n\n\tif (read_size != (ssize_t)len) {\n\t\tgiterr_set(GITERR_OS, \"Failed to read descriptor\");\n\t\tgit_buf_free(buf);\n\t\treturn -1;\n\t}\n\n\tbuf->ptr[read_size] = '\\0';\n\tbuf->size = read_size;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_readbuffer_fd(git_buf *buf, git_file fd, size_t len)\n{\n\tssize_t read_size = 0;\n\tsize_t alloc_len;\n\n\tgit_buf_clear(buf);\n\n\tif (!git__is_ssizet(len)) {\n\t\tgiterr_set(GITERR_INVALID, \"Read too large.\");\n\t\treturn -1;\n\t}\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\n\t/* p_read loops internally to read len bytes */\n\tread_size = p_read(fd, buf->ptr, len);\n\n\tif (read_size != (ssize_t)len) {\n\t\tgiterr_set(GITERR_OS, \"Failed to read descriptor\");\n\t\tgit_buf_free(buf);\n\t\treturn -1;\n\t}\n\n\tbuf->ptr[read_size] = '\\0';\n\tbuf->size = read_size;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__hashfd",
          "args": [
            "out",
            "fd",
            "size",
            "type"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__hashfd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "145-188",
          "snippet": "int git_odb__hashfd(git_oid *out, git_file fd, size_t size, git_otype type)\n{\n\tint hdr_len;\n\tchar hdr[64], buffer[FILEIO_BUFSIZE];\n\tgit_hash_ctx ctx;\n\tssize_t read_len = 0;\n\tint error = 0;\n\n\tif (!git_object_typeisloose(type)) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid object type for hash\");\n\t\treturn -1;\n\t}\n\n\tif ((error = git_hash_ctx_init(&ctx)) < 0)\n\t\treturn -1;\n\n\thdr_len = git_odb__format_object_header(hdr, sizeof(hdr), size, type);\n\n\tif ((error = git_hash_update(&ctx, hdr, hdr_len)) < 0)\n\t\tgoto done;\n\n\twhile (size > 0 && (read_len = p_read(fd, buffer, sizeof(buffer))) > 0) {\n\t\tif ((error = git_hash_update(&ctx, buffer, read_len)) < 0)\n\t\t\tgoto done;\n\n\t\tsize -= read_len;\n\t}\n\n\t/* If p_read returned an error code, the read obviously failed.\n\t * If size is not zero, the file was truncated after we originally\n\t * stat'd it, so we consider this a read failure too */\n\tif (read_len < 0 || size > 0) {\n\t\tgiterr_set(GITERR_OS, \"Error reading file for hashing\");\n\t\terror = -1;\n\n\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__hashfd(git_oid *out, git_file fd, size_t size, git_otype type)\n{\n\tint hdr_len;\n\tchar hdr[64], buffer[FILEIO_BUFSIZE];\n\tgit_hash_ctx ctx;\n\tssize_t read_len = 0;\n\tint error = 0;\n\n\tif (!git_object_typeisloose(type)) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid object type for hash\");\n\t\treturn -1;\n\t}\n\n\tif ((error = git_hash_ctx_init(&ctx)) < 0)\n\t\treturn -1;\n\n\thdr_len = git_odb__format_object_header(hdr, sizeof(hdr), size, type);\n\n\tif ((error = git_hash_update(&ctx, hdr, hdr_len)) < 0)\n\t\tgoto done;\n\n\twhile (size > 0 && (read_len = p_read(fd, buffer, sizeof(buffer))) > 0) {\n\t\tif ((error = git_hash_update(&ctx, buffer, read_len)) < 0)\n\t\t\tgoto done;\n\n\t\tsize -= read_len;\n\t}\n\n\t/* If p_read returned an error code, the read obviously failed.\n\t * If size is not zero, the file was truncated after we originally\n\t * stat'd it, so we consider this a read failure too */\n\tif (read_len < 0 || size > 0) {\n\t\tgiterr_set(GITERR_OS, \"Error reading file for hashing\");\n\t\terror = -1;\n\n\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__hashfd_filtered(\n\tgit_oid *out, git_file fd, size_t size, git_otype type, git_filter_list *fl)\n{\n\tint error;\n\tgit_buf raw = GIT_BUF_INIT;\n\n\tif (!fl)\n\t\treturn git_odb__hashfd(out, fd, size, type);\n\n\t/* size of data is used in header, so we have to read the whole file\n\t * into memory to apply filters before beginning to calculate the hash\n\t */\n\n\tif (!(error = git_futils_readbuffer_fd(&raw, fd, size))) {\n\t\tgit_buf post = GIT_BUF_INIT;\n\n\t\terror = git_filter_list_apply_to_data(&post, fl, &raw);\n\n\t\tgit_buf_free(&raw);\n\n\t\tif (!error)\n\t\t\terror = git_odb_hash(out, post.ptr, post.size, type);\n\n\t\tgit_buf_free(&post);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_odb__hashfd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "145-188",
    "snippet": "int git_odb__hashfd(git_oid *out, git_file fd, size_t size, git_otype type)\n{\n\tint hdr_len;\n\tchar hdr[64], buffer[FILEIO_BUFSIZE];\n\tgit_hash_ctx ctx;\n\tssize_t read_len = 0;\n\tint error = 0;\n\n\tif (!git_object_typeisloose(type)) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid object type for hash\");\n\t\treturn -1;\n\t}\n\n\tif ((error = git_hash_ctx_init(&ctx)) < 0)\n\t\treturn -1;\n\n\thdr_len = git_odb__format_object_header(hdr, sizeof(hdr), size, type);\n\n\tif ((error = git_hash_update(&ctx, hdr, hdr_len)) < 0)\n\t\tgoto done;\n\n\twhile (size > 0 && (read_len = p_read(fd, buffer, sizeof(buffer))) > 0) {\n\t\tif ((error = git_hash_update(&ctx, buffer, read_len)) < 0)\n\t\t\tgoto done;\n\n\t\tsize -= read_len;\n\t}\n\n\t/* If p_read returned an error code, the read obviously failed.\n\t * If size is not zero, the file was truncated after we originally\n\t * stat'd it, so we consider this a read failure too */\n\tif (read_len < 0 || size > 0) {\n\t\tgiterr_set(GITERR_OS, \"Error reading file for hashing\");\n\t\terror = -1;\n\n\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\treturn error;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_hash_ctx_cleanup",
          "args": [
            "&ctx"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_ctx_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "268-276",
          "snippet": "void git_hash_ctx_cleanup(git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\n\tif (ctx->type == CNG)\n\t\thash_ctx_cng_cleanup(ctx);\n\telse if(ctx->type == CRYPTOAPI)\n\t\thash_ctx_cryptoapi_cleanup(ctx);\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid git_hash_ctx_cleanup(git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\n\tif (ctx->type == CNG)\n\t\thash_ctx_cng_cleanup(ctx);\n\telse if(ctx->type == CRYPTOAPI)\n\t\thash_ctx_cryptoapi_cleanup(ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_hash_final",
          "args": [
            "out",
            "&ctx"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_openssl.h",
          "lines": "37-42",
          "snippet": "GIT_INLINE(int) git_hash_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\tSHA1_Final(out->id, &ctx->c);\n\treturn 0;\n}",
          "includes": [
            "#include <openssl/sha.h>",
            "#include \"hash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/sha.h>\n#include \"hash.h\"\n\nGIT_INLINE(int) git_hash_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\tSHA1_Final(out->id, &ctx->c);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Error reading file for hashing\""
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_hash_update",
          "args": [
            "&ctx",
            "buffer",
            "read_len"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_openssl.h",
          "lines": "30-35",
          "snippet": "GIT_INLINE(int) git_hash_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx);\n\tSHA1_Update(&ctx->c, data, len);\n\treturn 0;\n}",
          "includes": [
            "#include <openssl/sha.h>",
            "#include \"hash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/sha.h>\n#include \"hash.h\"\n\nGIT_INLINE(int) git_hash_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx);\n\tSHA1_Update(&ctx->c, data, len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_read",
          "args": [
            "fd",
            "buffer",
            "sizeof(buffer)"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "p_readdir_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.h",
          "lines": "126-131",
          "snippet": "GIT_INLINE(int) p_readdir_r(DIR *dirp, struct dirent *entry, struct dirent **result)\n{\n\tGIT_UNUSED(entry);\n\t*result = readdir(dirp);\n\treturn 0;\n}",
          "includes": [
            "#\tinclude <netdb.h>",
            "#include \"strnlen.h\"",
            "#\tinclude \"unix/posix.h\"",
            "#\tinclude \"win32/posix.h\"",
            "#include \"fnmatch.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <netdb.h>\n#include \"strnlen.h\"\n#\tinclude \"unix/posix.h\"\n#\tinclude \"win32/posix.h\"\n#include \"fnmatch.h\"\n#include <time.h>\n#include <fcntl.h>\n#include \"common.h\"\n\nGIT_INLINE(int) p_readdir_r(DIR *dirp, struct dirent *entry, struct dirent **result)\n{\n\tGIT_UNUSED(entry);\n\t*result = readdir(dirp);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__format_object_header",
          "args": [
            "hdr",
            "sizeof(hdr)",
            "size",
            "type"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__format_object_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "53-59",
          "snippet": "int git_odb__format_object_header(char *hdr, size_t n, git_off_t obj_len, git_otype obj_type)\n{\n\tconst char *type_str = git_object_type2string(obj_type);\n\tint len = p_snprintf(hdr, n, \"%s %lld\", type_str, (long long)obj_len);\n\tassert(len > 0 && len <= (int)n);\n\treturn len+1;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__format_object_header(char *hdr, size_t n, git_off_t obj_len, git_otype obj_type)\n{\n\tconst char *type_str = git_object_type2string(obj_type);\n\tint len = p_snprintf(hdr, n, \"%s %lld\", type_str, (long long)obj_len);\n\tassert(len > 0 && len <= (int)n);\n\treturn len+1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_hash_ctx_init",
          "args": [
            "&ctx"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_ctx_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "231-248",
          "snippet": "int git_hash_ctx_init(git_hash_ctx *ctx)\n{\n\tint error = 0;\n\n\tassert(ctx);\n\n\t/*\n\t * When compiled with GIT_THREADS, the global hash_prov data is\n\t * initialized with git_libgit2_init.  Otherwise, it must be initialized\n\t * at first use.\n\t */\n\tif (hash_prov.type == INVALID && (error = git_hash_global_init()) < 0)\n\t\treturn error;\n\n\tmemset(ctx, 0x0, sizeof(git_hash_ctx));\n\n\treturn (hash_prov.type == CNG) ? hash_ctx_cng_init(ctx) : hash_ctx_cryptoapi_init(ctx);\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nint git_hash_ctx_init(git_hash_ctx *ctx)\n{\n\tint error = 0;\n\n\tassert(ctx);\n\n\t/*\n\t * When compiled with GIT_THREADS, the global hash_prov data is\n\t * initialized with git_libgit2_init.  Otherwise, it must be initialized\n\t * at first use.\n\t */\n\tif (hash_prov.type == INVALID && (error = git_hash_global_init()) < 0)\n\t\treturn error;\n\n\tmemset(ctx, 0x0, sizeof(git_hash_ctx));\n\n\treturn (hash_prov.type == CNG) ? hash_ctx_cng_init(ctx) : hash_ctx_cryptoapi_init(ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_typeisloose",
          "args": [
            "type"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_typeisloose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "249-255",
          "snippet": "int git_object_typeisloose(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn 0;\n\n\treturn (git_objects_table[type].size > 0) ? 1 : 0;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nstatic git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};\n\nint git_object_typeisloose(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn 0;\n\n\treturn (git_objects_table[type].size > 0) ? 1 : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__hashfd(git_oid *out, git_file fd, size_t size, git_otype type)\n{\n\tint hdr_len;\n\tchar hdr[64], buffer[FILEIO_BUFSIZE];\n\tgit_hash_ctx ctx;\n\tssize_t read_len = 0;\n\tint error = 0;\n\n\tif (!git_object_typeisloose(type)) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid object type for hash\");\n\t\treturn -1;\n\t}\n\n\tif ((error = git_hash_ctx_init(&ctx)) < 0)\n\t\treturn -1;\n\n\thdr_len = git_odb__format_object_header(hdr, sizeof(hdr), size, type);\n\n\tif ((error = git_hash_update(&ctx, hdr, hdr_len)) < 0)\n\t\tgoto done;\n\n\twhile (size > 0 && (read_len = p_read(fd, buffer, sizeof(buffer))) > 0) {\n\t\tif ((error = git_hash_update(&ctx, buffer, read_len)) < 0)\n\t\t\tgoto done;\n\n\t\tsize -= read_len;\n\t}\n\n\t/* If p_read returned an error code, the read obviously failed.\n\t * If size is not zero, the file was truncated after we originally\n\t * stat'd it, so we consider this a read failure too */\n\tif (read_len < 0 || size > 0) {\n\t\tgiterr_set(GITERR_OS, \"Error reading file for hashing\");\n\t\terror = -1;\n\n\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\treturn error;\n}"
  },
  {
    "function_name": "git_odb_object_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "137-143",
    "snippet": "void git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_cached_obj_decref",
          "args": [
            "object"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "git_cached_obj_decref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "262-281",
          "snippet": "void git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
  },
  {
    "function_name": "git_odb_object_dup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "130-135",
    "snippet": "int git_odb_object_dup(git_odb_object **dest, git_odb_object *source)\n{\n\tgit_cached_obj_incref(source);\n\t*dest = source;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_cached_obj_incref",
          "args": [
            "source"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "git_cached_obj_incref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.h",
          "lines": "59-63",
          "snippet": "GIT_INLINE(void) git_cached_obj_incref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\tgit_atomic_inc(&obj->refcount);\n}",
          "includes": [
            "#include \"oidmap.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"oidmap.h\"\n#include \"thread-utils.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(void) git_cached_obj_incref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\tgit_atomic_inc(&obj->refcount);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_object_dup(git_odb_object **dest, git_odb_object *source)\n{\n\tgit_cached_obj_incref(source);\n\t*dest = source;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb_object_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "125-128",
    "snippet": "git_otype git_odb_object_type(git_odb_object *object)\n{\n\treturn object->cached.type;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\ngit_otype git_odb_object_type(git_odb_object *object)\n{\n\treturn object->cached.type;\n}"
  },
  {
    "function_name": "git_odb_object_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "120-123",
    "snippet": "size_t git_odb_object_size(git_odb_object *object)\n{\n\treturn object->cached.size;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nsize_t git_odb_object_size(git_odb_object *object)\n{\n\treturn object->cached.size;\n}"
  },
  {
    "function_name": "git_odb_object_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "115-118",
    "snippet": "const void *git_odb_object_data(git_odb_object *object)\n{\n\treturn object->buffer;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nconst void *git_odb_object_data(git_odb_object *object)\n{\n\treturn object->buffer;\n}"
  },
  {
    "function_name": "git_odb_object_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "110-113",
    "snippet": "const git_oid *git_odb_object_id(git_odb_object *object)\n{\n\treturn &object->cached.oid;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nconst git_oid *git_odb_object_id(git_odb_object *object)\n{\n\treturn &object->cached.oid;\n}"
  },
  {
    "function_name": "git_odb_object__free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "102-108",
    "snippet": "void git_odb_object__free(void *object)\n{\n\tif (object != NULL) {\n\t\tgit__free(((git_odb_object *)object)->buffer);\n\t\tgit__free(object);\n\t}\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "object"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_object__free(void *object)\n{\n\tif (object != NULL) {\n\t\tgit__free(((git_odb_object *)object)->buffer);\n\t\tgit__free(object);\n\t}\n}"
  },
  {
    "function_name": "odb_object__alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "88-100",
    "snippet": "static git_odb_object *odb_object__alloc(const git_oid *oid, git_rawobj *source)\n{\n\tgit_odb_object *object = git__calloc(1, sizeof(git_odb_object));\n\n\tif (object != NULL) {\n\t\tgit_oid_cpy(&object->cached.oid, oid);\n\t\tobject->cached.type = source->type;\n\t\tobject->cached.size = source->len;\n\t\tobject->buffer      = source->data;\n\t}\n\n\treturn object;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&object->cached.oid",
            "oid"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_odb_object)"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_odb_object *odb_object__alloc(const git_oid *oid, git_rawobj *source)\n{\n\tgit_odb_object *object = git__calloc(1, sizeof(git_odb_object));\n\n\tif (object != NULL) {\n\t\tgit_oid_cpy(&object->cached.oid, oid);\n\t\tobject->cached.type = source->type;\n\t\tobject->cached.size = source->len;\n\t\tobject->buffer      = source->data;\n\t}\n\n\treturn object;\n}"
  },
  {
    "function_name": "git_odb__hashobj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "61-85",
    "snippet": "int git_odb__hashobj(git_oid *id, git_rawobj *obj)\n{\n\tgit_buf_vec vec[2];\n\tchar header[64];\n\tint hdrlen;\n\n\tassert(id && obj);\n\n\tif (!git_object_typeisloose(obj->type))\n\t\treturn -1;\n\n\tif (!obj->data && obj->len != 0)\n\t\treturn -1;\n\n\thdrlen = git_odb__format_object_header(header, sizeof(header), obj->len, obj->type);\n\n\tvec[0].data = header;\n\tvec[0].len = hdrlen;\n\tvec[1].data = obj->data;\n\tvec[1].len = obj->len;\n\n\tgit_hash_vec(id, vec, 2);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_hash_vec",
          "args": [
            "id",
            "vec",
            "2"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_vec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash.c",
          "lines": "27-47",
          "snippet": "int git_hash_vec(git_oid *out, git_buf_vec *vec, size_t n)\n{\n\tgit_hash_ctx ctx;\n\tsize_t i;\n\tint error = 0;\n\n\tif (git_hash_ctx_init(&ctx) < 0)\n\t\treturn -1;\n\n\tfor (i = 0; i < n; i++) {\n\t\tif ((error = git_hash_update(&ctx, vec[i].data, vec[i].len)) < 0)\n\t\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\n\treturn error;\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"common.h\"\n\nint git_hash_vec(git_oid *out, git_buf_vec *vec, size_t n)\n{\n\tgit_hash_ctx ctx;\n\tsize_t i;\n\tint error = 0;\n\n\tif (git_hash_ctx_init(&ctx) < 0)\n\t\treturn -1;\n\n\tfor (i = 0; i < n; i++) {\n\t\tif ((error = git_hash_update(&ctx, vec[i].data, vec[i].len)) < 0)\n\t\t\tgoto done;\n\t}\n\n\terror = git_hash_final(out, &ctx);\n\ndone:\n\tgit_hash_ctx_cleanup(&ctx);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__format_object_header",
          "args": [
            "header",
            "sizeof(header)",
            "obj->len",
            "obj->type"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__format_object_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "53-59",
          "snippet": "int git_odb__format_object_header(char *hdr, size_t n, git_off_t obj_len, git_otype obj_type)\n{\n\tconst char *type_str = git_object_type2string(obj_type);\n\tint len = p_snprintf(hdr, n, \"%s %lld\", type_str, (long long)obj_len);\n\tassert(len > 0 && len <= (int)n);\n\treturn len+1;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__format_object_header(char *hdr, size_t n, git_off_t obj_len, git_otype obj_type)\n{\n\tconst char *type_str = git_object_type2string(obj_type);\n\tint len = p_snprintf(hdr, n, \"%s %lld\", type_str, (long long)obj_len);\n\tassert(len > 0 && len <= (int)n);\n\treturn len+1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_typeisloose",
          "args": [
            "obj->type"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_typeisloose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "249-255",
          "snippet": "int git_object_typeisloose(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn 0;\n\n\treturn (git_objects_table[type].size > 0) ? 1 : 0;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nstatic git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};\n\nint git_object_typeisloose(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn 0;\n\n\treturn (git_objects_table[type].size > 0) ? 1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "id && obj"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__hashobj(git_oid *id, git_rawobj *obj)\n{\n\tgit_buf_vec vec[2];\n\tchar header[64];\n\tint hdrlen;\n\n\tassert(id && obj);\n\n\tif (!git_object_typeisloose(obj->type))\n\t\treturn -1;\n\n\tif (!obj->data && obj->len != 0)\n\t\treturn -1;\n\n\thdrlen = git_odb__format_object_header(header, sizeof(header), obj->len, obj->type);\n\n\tvec[0].data = header;\n\tvec[0].len = hdrlen;\n\tvec[1].data = obj->data;\n\tvec[1].len = obj->len;\n\n\tgit_hash_vec(id, vec, 2);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_odb__format_object_header",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "53-59",
    "snippet": "int git_odb__format_object_header(char *hdr, size_t n, git_off_t obj_len, git_otype obj_type)\n{\n\tconst char *type_str = git_object_type2string(obj_type);\n\tint len = p_snprintf(hdr, n, \"%s %lld\", type_str, (long long)obj_len);\n\tassert(len > 0 && len <= (int)n);\n\treturn len+1;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "len > 0 && len <= (int)n"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_snprintf",
          "args": [
            "hdr",
            "n",
            "\"%s %lld\"",
            "type_str",
            "(long long)obj_len"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "p_snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "548-558",
          "snippet": "int p_snprintf(char *buffer, size_t count, const char *format, ...)\n{\n\tva_list va;\n\tint r;\n\n\tva_start(va, format);\n\tr = p_vsnprintf(buffer, count, format, va);\n\tva_end(va);\n\n\treturn r;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_snprintf(char *buffer, size_t count, const char *format, ...)\n{\n\tva_list va;\n\tint r;\n\n\tva_start(va, format);\n\tr = p_vsnprintf(buffer, count, format, va);\n\tva_end(va);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_type2string",
          "args": [
            "obj_type"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_type2string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "227-233",
          "snippet": "const char *git_object_type2string(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn \"\";\n\n\treturn git_objects_table[type].str;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nstatic git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};\n\nconst char *git_object_type2string(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn \"\";\n\n\treturn git_objects_table[type].str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__format_object_header(char *hdr, size_t n, git_off_t obj_len, git_otype obj_type)\n{\n\tconst char *type_str = git_object_type2string(obj_type);\n\tint len = p_snprintf(hdr, n, \"%s %lld\", type_str, (long long)obj_len);\n\tassert(len > 0 && len <= (int)n);\n\treturn len+1;\n}"
  },
  {
    "function_name": "odb_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
    "lines": "41-49",
    "snippet": "static git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"delta-apply.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include <zlib.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nstatic git_cache *odb_cache(git_odb *odb)\n{\n\tif (odb->rc.owner != NULL) {\n\t\tgit_repository *owner = odb->rc.owner;\n\t\treturn &owner->objects;\n\t}\n\n\treturn &odb->own_cache;\n}"
  }
]