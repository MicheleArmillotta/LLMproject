[
  {
    "function_name": "git_merge_file_result_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "339-346",
    "snippet": "void git_merge_file_result_free(git_merge_file_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tgit__free((char *)result->path);\n\tgit__free((char *)result->ptr);\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "(char *)result->ptr"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_merge_file_result_free(git_merge_file_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tgit__free((char *)result->path);\n\tgit__free((char *)result->ptr);\n}"
  },
  {
    "function_name": "git_merge_file_from_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "292-337",
    "snippet": "int git_merge_file_from_index(\n\tgit_merge_file_result *out,\n\tgit_repository *repo,\n\tconst git_index_entry *ancestor,\n\tconst git_index_entry *ours,\n\tconst git_index_entry *theirs,\n\tconst git_merge_file_options *options)\n{\n\tgit_merge_file_input *ancestor_ptr = NULL,\n\t\tancestor_input = {0}, our_input = {0}, their_input = {0};\n\tgit_odb *odb = NULL;\n\tgit_odb_object *odb_object[3] = { 0 };\n\tint error = 0;\n\n\tassert(out && repo && ours && theirs);\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tif ((error = git_repository_odb(&odb, repo)) < 0)\n\t\tgoto done;\n\n\tif (ancestor) {\n\t\tif ((error = git_merge_file__input_from_index(\n\t\t\t&ancestor_input, &odb_object[0], odb, ancestor)) < 0)\n\t\t\tgoto done;\n\n\t\tancestor_ptr = &ancestor_input;\n\t}\n\n\tif ((error = git_merge_file__input_from_index(\n\t\t\t&our_input, &odb_object[1], odb, ours)) < 0 ||\n\t\t(error = git_merge_file__input_from_index(\n\t\t\t&their_input, &odb_object[2], odb, theirs)) < 0)\n\t\tgoto done;\n\n\terror = merge_file__from_inputs(out,\n\t\tancestor_ptr, &our_input, &their_input, options);\n\ndone:\n\tgit_odb_object_free(odb_object[0]);\n\tgit_odb_object_free(odb_object[1]);\n\tgit_odb_object_free(odb_object[2]);\n\tgit_odb_free(odb);\n\n\treturn error;\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_free",
          "args": [
            "odb"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "619-625",
          "snippet": "void git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_object_free",
          "args": [
            "odb_object[2]"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "137-143",
          "snippet": "void git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "merge_file__from_inputs",
          "args": [
            "out",
            "ancestor_ptr",
            "&our_input",
            "&their_input",
            "options"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "merge_file__from_inputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "240-253",
          "snippet": "static int merge_file__from_inputs(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (merge_file__is_binary(ancestor) ||\n\t\tmerge_file__is_binary(ours) ||\n\t\tmerge_file__is_binary(theirs))\n\t\treturn merge_file__binary(out, ours, theirs, given_opts);\n\n\treturn merge_file__xdiff(out, ancestor, ours, theirs, given_opts);\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int merge_file__from_inputs(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (merge_file__is_binary(ancestor) ||\n\t\tmerge_file__is_binary(ours) ||\n\t\tmerge_file__is_binary(theirs))\n\t\treturn merge_file__binary(out, ours, theirs, given_opts);\n\n\treturn merge_file__xdiff(out, ancestor, ours, theirs, given_opts);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_merge_file__input_from_index",
          "args": [
            "&their_input",
            "&odb_object[2]",
            "odb",
            "theirs"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "git_merge_file__input_from_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "75-95",
          "snippet": "int git_merge_file__input_from_index(\n\tgit_merge_file_input *input_out,\n\tgit_odb_object **odb_object_out,\n\tgit_odb *odb,\n\tconst git_index_entry *entry)\n{\n\tint error = 0;\n\n\tassert(input_out && odb_object_out && odb && entry);\n\n\tif ((error = git_odb_read(odb_object_out, odb, &entry->id)) < 0)\n\t\tgoto done;\n\n\tinput_out->path = entry->path;\n\tinput_out->mode = entry->mode;\n\tinput_out->ptr = (char *)git_odb_object_data(*odb_object_out);\n\tinput_out->size = git_odb_object_size(*odb_object_out);\n\ndone:\n\treturn error;\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_merge_file__input_from_index(\n\tgit_merge_file_input *input_out,\n\tgit_odb_object **odb_object_out,\n\tgit_odb *odb,\n\tconst git_index_entry *entry)\n{\n\tint error = 0;\n\n\tassert(input_out && odb_object_out && odb && entry);\n\n\tif ((error = git_odb_read(odb_object_out, odb, &entry->id)) < 0)\n\t\tgoto done;\n\n\tinput_out->path = entry->path;\n\tinput_out->mode = entry->mode;\n\tinput_out->ptr = (char *)git_odb_object_data(*odb_object_out);\n\tinput_out->size = git_odb_object_size(*odb_object_out);\n\ndone:\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_odb",
          "args": [
            "&odb",
            "repo"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_odb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "764-771",
          "snippet": "int git_repository_odb(git_odb **out, git_repository *repo)\n{\n\tif (git_repository_odb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb(git_odb **out, git_repository *repo)\n{\n\tif (git_repository_odb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "out",
            "0x0",
            "sizeof(git_merge_file_result)"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo && ours && theirs"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_merge_file_from_index(\n\tgit_merge_file_result *out,\n\tgit_repository *repo,\n\tconst git_index_entry *ancestor,\n\tconst git_index_entry *ours,\n\tconst git_index_entry *theirs,\n\tconst git_merge_file_options *options)\n{\n\tgit_merge_file_input *ancestor_ptr = NULL,\n\t\tancestor_input = {0}, our_input = {0}, their_input = {0};\n\tgit_odb *odb = NULL;\n\tgit_odb_object *odb_object[3] = { 0 };\n\tint error = 0;\n\n\tassert(out && repo && ours && theirs);\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tif ((error = git_repository_odb(&odb, repo)) < 0)\n\t\tgoto done;\n\n\tif (ancestor) {\n\t\tif ((error = git_merge_file__input_from_index(\n\t\t\t&ancestor_input, &odb_object[0], odb, ancestor)) < 0)\n\t\t\tgoto done;\n\n\t\tancestor_ptr = &ancestor_input;\n\t}\n\n\tif ((error = git_merge_file__input_from_index(\n\t\t\t&our_input, &odb_object[1], odb, ours)) < 0 ||\n\t\t(error = git_merge_file__input_from_index(\n\t\t\t&their_input, &odb_object[2], odb, theirs)) < 0)\n\t\tgoto done;\n\n\terror = merge_file__from_inputs(out,\n\t\tancestor_ptr, &our_input, &their_input, options);\n\ndone:\n\tgit_odb_object_free(odb_object[0]);\n\tgit_odb_object_free(odb_object[1]);\n\tgit_odb_object_free(odb_object[2]);\n\tgit_odb_free(odb);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_merge_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "270-290",
    "snippet": "int git_merge_file(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *options)\n{\n\tgit_merge_file_input inputs[3] = { {0} };\n\n\tassert(out && ours && theirs);\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tif (ancestor)\n\t\tancestor = git_merge_file__normalize_inputs(&inputs[0], ancestor);\n\n\tours = git_merge_file__normalize_inputs(&inputs[1], ours);\n\ttheirs = git_merge_file__normalize_inputs(&inputs[2], theirs);\n\n\treturn merge_file__from_inputs(out, ancestor, ours, theirs, options);\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "merge_file__from_inputs",
          "args": [
            "out",
            "ancestor",
            "ours",
            "theirs",
            "options"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "merge_file__from_inputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "240-253",
          "snippet": "static int merge_file__from_inputs(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (merge_file__is_binary(ancestor) ||\n\t\tmerge_file__is_binary(ours) ||\n\t\tmerge_file__is_binary(theirs))\n\t\treturn merge_file__binary(out, ours, theirs, given_opts);\n\n\treturn merge_file__xdiff(out, ancestor, ours, theirs, given_opts);\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int merge_file__from_inputs(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (merge_file__is_binary(ancestor) ||\n\t\tmerge_file__is_binary(ours) ||\n\t\tmerge_file__is_binary(theirs))\n\t\treturn merge_file__binary(out, ours, theirs, given_opts);\n\n\treturn merge_file__xdiff(out, ancestor, ours, theirs, given_opts);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_merge_file__normalize_inputs",
          "args": [
            "&inputs[2]",
            "theirs"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "git_merge_file__normalize_inputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "255-268",
          "snippet": "static git_merge_file_input *git_merge_file__normalize_inputs(\n\tgit_merge_file_input *out,\n\tconst git_merge_file_input *given)\n{\n\tmemcpy(out, given, sizeof(git_merge_file_input));\n\n\tif (!out->path)\n\t\tout->path = \"file.txt\";\n\n\tif (!out->mode)\n\t\tout->mode = 0100644;\n\n\treturn out;\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic git_merge_file_input *git_merge_file__normalize_inputs(\n\tgit_merge_file_input *out,\n\tconst git_merge_file_input *given)\n{\n\tmemcpy(out, given, sizeof(git_merge_file_input));\n\n\tif (!out->path)\n\t\tout->path = \"file.txt\";\n\n\tif (!out->mode)\n\t\tout->mode = 0100644;\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "out",
            "0x0",
            "sizeof(git_merge_file_result)"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && ours && theirs"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_merge_file(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *options)\n{\n\tgit_merge_file_input inputs[3] = { {0} };\n\n\tassert(out && ours && theirs);\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tif (ancestor)\n\t\tancestor = git_merge_file__normalize_inputs(&inputs[0], ancestor);\n\n\tours = git_merge_file__normalize_inputs(&inputs[1], ours);\n\ttheirs = git_merge_file__normalize_inputs(&inputs[2], theirs);\n\n\treturn merge_file__from_inputs(out, ancestor, ours, theirs, options);\n}"
  },
  {
    "function_name": "git_merge_file__normalize_inputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "255-268",
    "snippet": "static git_merge_file_input *git_merge_file__normalize_inputs(\n\tgit_merge_file_input *out,\n\tconst git_merge_file_input *given)\n{\n\tmemcpy(out, given, sizeof(git_merge_file_input));\n\n\tif (!out->path)\n\t\tout->path = \"file.txt\";\n\n\tif (!out->mode)\n\t\tout->mode = 0100644;\n\n\treturn out;\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out",
            "given",
            "sizeof(git_merge_file_input)"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic git_merge_file_input *git_merge_file__normalize_inputs(\n\tgit_merge_file_input *out,\n\tconst git_merge_file_input *given)\n{\n\tmemcpy(out, given, sizeof(git_merge_file_input));\n\n\tif (!out->path)\n\t\tout->path = \"file.txt\";\n\n\tif (!out->mode)\n\t\tout->mode = 0100644;\n\n\treturn out;\n}"
  },
  {
    "function_name": "merge_file__from_inputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "240-253",
    "snippet": "static int merge_file__from_inputs(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (merge_file__is_binary(ancestor) ||\n\t\tmerge_file__is_binary(ours) ||\n\t\tmerge_file__is_binary(theirs))\n\t\treturn merge_file__binary(out, ours, theirs, given_opts);\n\n\treturn merge_file__xdiff(out, ancestor, ours, theirs, given_opts);\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "merge_file__xdiff",
          "args": [
            "out",
            "ancestor",
            "ours",
            "theirs",
            "given_opts"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "merge_file__xdiff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "109-196",
          "snippet": "static int merge_file__xdiff(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\txmparam_t xmparam;\n\tmmfile_t ancestor_mmfile = {0}, our_mmfile = {0}, their_mmfile = {0};\n\tmmbuffer_t mmbuffer;\n\tgit_merge_file_options options = GIT_MERGE_FILE_OPTIONS_INIT;\n\tconst char *path;\n\tint xdl_result;\n\tint error = 0;\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tmerge_file_normalize_opts(&options, given_opts);\n\n\tmemset(&xmparam, 0x0, sizeof(xmparam_t));\n\n\tif (ancestor) {\n\t\txmparam.ancestor = (options.ancestor_label) ?\n\t\t\toptions.ancestor_label : ancestor->path;\n\t\tancestor_mmfile.ptr = (char *)ancestor->ptr;\n\t\tancestor_mmfile.size = ancestor->size;\n\t}\n\n\txmparam.file1 = (options.our_label) ?\n\t\toptions.our_label : ours->path;\n\tour_mmfile.ptr = (char *)ours->ptr;\n\tour_mmfile.size = ours->size;\n\n\txmparam.file2 = (options.their_label) ?\n\t\toptions.their_label : theirs->path;\n\ttheir_mmfile.ptr = (char *)theirs->ptr;\n\ttheir_mmfile.size = theirs->size;\n\n\tif (options.favor == GIT_MERGE_FILE_FAVOR_OURS)\n\t\txmparam.favor = XDL_MERGE_FAVOR_OURS;\n\telse if (options.favor == GIT_MERGE_FILE_FAVOR_THEIRS)\n\t\txmparam.favor = XDL_MERGE_FAVOR_THEIRS;\n\telse if (options.favor == GIT_MERGE_FILE_FAVOR_UNION)\n\t\txmparam.favor = XDL_MERGE_FAVOR_UNION;\n\n\txmparam.level = (options.flags & GIT_MERGE_FILE_SIMPLIFY_ALNUM) ?\n\t\tXDL_MERGE_ZEALOUS_ALNUM : XDL_MERGE_ZEALOUS;\n\n\tif (options.flags & GIT_MERGE_FILE_STYLE_DIFF3)\n\t\txmparam.style = XDL_MERGE_DIFF3;\n\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE;\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE_CHANGE)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE_EOL)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (options.flags & GIT_MERGE_FILE_DIFF_PATIENCE)\n\t\txmparam.xpp.flags |= XDF_PATIENCE_DIFF;\n\n\tif (options.flags & GIT_MERGE_FILE_DIFF_MINIMAL)\n\t\txmparam.xpp.flags |= XDF_NEED_MINIMAL;\n\n\tif ((xdl_result = xdl_merge(&ancestor_mmfile, &our_mmfile,\n\t\t&their_mmfile, &xmparam, &mmbuffer)) < 0) {\n\t\tgiterr_set(GITERR_MERGE, \"Failed to merge files.\");\n\t\terror = -1;\n\t\tgoto done;\n\t}\n\n\tif ((path = merge_file_best_path(ancestor, ours, theirs)) != NULL &&\n\t\t(out->path = strdup(path)) == NULL) {\n\t\terror = -1;\n\t\tgoto done;\n\t}\n\n\tout->automergeable = (xdl_result == 0);\n\tout->ptr = (const char *)mmbuffer.ptr;\n\tout->len = mmbuffer.size;\n\tout->mode = merge_file_best_mode(ancestor, ours, theirs);\n\ndone:\n\tif (error < 0)\n\t\tgit_merge_file_result_free(out);\n\n\treturn error;\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int merge_file__xdiff(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\txmparam_t xmparam;\n\tmmfile_t ancestor_mmfile = {0}, our_mmfile = {0}, their_mmfile = {0};\n\tmmbuffer_t mmbuffer;\n\tgit_merge_file_options options = GIT_MERGE_FILE_OPTIONS_INIT;\n\tconst char *path;\n\tint xdl_result;\n\tint error = 0;\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tmerge_file_normalize_opts(&options, given_opts);\n\n\tmemset(&xmparam, 0x0, sizeof(xmparam_t));\n\n\tif (ancestor) {\n\t\txmparam.ancestor = (options.ancestor_label) ?\n\t\t\toptions.ancestor_label : ancestor->path;\n\t\tancestor_mmfile.ptr = (char *)ancestor->ptr;\n\t\tancestor_mmfile.size = ancestor->size;\n\t}\n\n\txmparam.file1 = (options.our_label) ?\n\t\toptions.our_label : ours->path;\n\tour_mmfile.ptr = (char *)ours->ptr;\n\tour_mmfile.size = ours->size;\n\n\txmparam.file2 = (options.their_label) ?\n\t\toptions.their_label : theirs->path;\n\ttheir_mmfile.ptr = (char *)theirs->ptr;\n\ttheir_mmfile.size = theirs->size;\n\n\tif (options.favor == GIT_MERGE_FILE_FAVOR_OURS)\n\t\txmparam.favor = XDL_MERGE_FAVOR_OURS;\n\telse if (options.favor == GIT_MERGE_FILE_FAVOR_THEIRS)\n\t\txmparam.favor = XDL_MERGE_FAVOR_THEIRS;\n\telse if (options.favor == GIT_MERGE_FILE_FAVOR_UNION)\n\t\txmparam.favor = XDL_MERGE_FAVOR_UNION;\n\n\txmparam.level = (options.flags & GIT_MERGE_FILE_SIMPLIFY_ALNUM) ?\n\t\tXDL_MERGE_ZEALOUS_ALNUM : XDL_MERGE_ZEALOUS;\n\n\tif (options.flags & GIT_MERGE_FILE_STYLE_DIFF3)\n\t\txmparam.style = XDL_MERGE_DIFF3;\n\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE;\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE_CHANGE)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE_EOL)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (options.flags & GIT_MERGE_FILE_DIFF_PATIENCE)\n\t\txmparam.xpp.flags |= XDF_PATIENCE_DIFF;\n\n\tif (options.flags & GIT_MERGE_FILE_DIFF_MINIMAL)\n\t\txmparam.xpp.flags |= XDF_NEED_MINIMAL;\n\n\tif ((xdl_result = xdl_merge(&ancestor_mmfile, &our_mmfile,\n\t\t&their_mmfile, &xmparam, &mmbuffer)) < 0) {\n\t\tgiterr_set(GITERR_MERGE, \"Failed to merge files.\");\n\t\terror = -1;\n\t\tgoto done;\n\t}\n\n\tif ((path = merge_file_best_path(ancestor, ours, theirs)) != NULL &&\n\t\t(out->path = strdup(path)) == NULL) {\n\t\terror = -1;\n\t\tgoto done;\n\t}\n\n\tout->automergeable = (xdl_result == 0);\n\tout->ptr = (const char *)mmbuffer.ptr;\n\tout->len = mmbuffer.size;\n\tout->mode = merge_file_best_mode(ancestor, ours, theirs);\n\ndone:\n\tif (error < 0)\n\t\tgit_merge_file_result_free(out);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "merge_file__binary",
          "args": [
            "out",
            "ours",
            "theirs",
            "given_opts"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "merge_file__binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "210-238",
          "snippet": "static int merge_file__binary(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tconst git_merge_file_input *favored = NULL;\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tif (given_opts && given_opts->favor == GIT_MERGE_FILE_FAVOR_OURS)\n\t\tfavored = ours;\n\telse if (given_opts && given_opts->favor == GIT_MERGE_FILE_FAVOR_THEIRS)\n\t\tfavored = theirs;\n\telse\n\t\tgoto done;\n\n\tif ((out->path = git__strdup(favored->path)) == NULL ||\n\t\t(out->ptr = git__malloc(favored->size)) == NULL)\n\t\tgoto done;\n\n\tmemcpy((char *)out->ptr, favored->ptr, favored->size);\n\tout->len = favored->size;\n\tout->mode = favored->mode;\n\tout->automergeable = 1;\n\ndone:\n\treturn 0;\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int merge_file__binary(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tconst git_merge_file_input *favored = NULL;\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tif (given_opts && given_opts->favor == GIT_MERGE_FILE_FAVOR_OURS)\n\t\tfavored = ours;\n\telse if (given_opts && given_opts->favor == GIT_MERGE_FILE_FAVOR_THEIRS)\n\t\tfavored = theirs;\n\telse\n\t\tgoto done;\n\n\tif ((out->path = git__strdup(favored->path)) == NULL ||\n\t\t(out->ptr = git__malloc(favored->size)) == NULL)\n\t\tgoto done;\n\n\tmemcpy((char *)out->ptr, favored->ptr, favored->size);\n\tout->len = favored->size;\n\tout->mode = favored->mode;\n\tout->automergeable = 1;\n\ndone:\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "merge_file__is_binary",
          "args": [
            "theirs"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "merge_file__is_binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "198-208",
          "snippet": "static bool merge_file__is_binary(const git_merge_file_input *file)\n{\n\tsize_t len = file ? file->size : 0;\n\n\tif (len > GIT_XDIFF_MAX_SIZE)\n\t\treturn true;\n\tif (len > GIT_MERGE_FILE_BINARY_SIZE)\n\t\tlen = GIT_MERGE_FILE_BINARY_SIZE;\n\n\treturn len ? (memchr(file->ptr, 0, len) != NULL) : false;\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define GIT_MERGE_FILE_BINARY_SIZE 8000"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\n#define GIT_MERGE_FILE_BINARY_SIZE 8000\n\nstatic bool merge_file__is_binary(const git_merge_file_input *file)\n{\n\tsize_t len = file ? file->size : 0;\n\n\tif (len > GIT_XDIFF_MAX_SIZE)\n\t\treturn true;\n\tif (len > GIT_MERGE_FILE_BINARY_SIZE)\n\t\tlen = GIT_MERGE_FILE_BINARY_SIZE;\n\n\treturn len ? (memchr(file->ptr, 0, len) != NULL) : false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int merge_file__from_inputs(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (merge_file__is_binary(ancestor) ||\n\t\tmerge_file__is_binary(ours) ||\n\t\tmerge_file__is_binary(theirs))\n\t\treturn merge_file__binary(out, ours, theirs, given_opts);\n\n\treturn merge_file__xdiff(out, ancestor, ours, theirs, given_opts);\n}"
  },
  {
    "function_name": "merge_file__binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "210-238",
    "snippet": "static int merge_file__binary(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tconst git_merge_file_input *favored = NULL;\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tif (given_opts && given_opts->favor == GIT_MERGE_FILE_FAVOR_OURS)\n\t\tfavored = ours;\n\telse if (given_opts && given_opts->favor == GIT_MERGE_FILE_FAVOR_THEIRS)\n\t\tfavored = theirs;\n\telse\n\t\tgoto done;\n\n\tif ((out->path = git__strdup(favored->path)) == NULL ||\n\t\t(out->ptr = git__malloc(favored->size)) == NULL)\n\t\tgoto done;\n\n\tmemcpy((char *)out->ptr, favored->ptr, favored->size);\n\tout->len = favored->size;\n\tout->mode = favored->mode;\n\tout->automergeable = 1;\n\ndone:\n\treturn 0;\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(char *)out->ptr",
            "favored->ptr",
            "favored->size"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "favored->size"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "favored->path"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "out",
            "0x0",
            "sizeof(git_merge_file_result)"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int merge_file__binary(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\tconst git_merge_file_input *favored = NULL;\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tif (given_opts && given_opts->favor == GIT_MERGE_FILE_FAVOR_OURS)\n\t\tfavored = ours;\n\telse if (given_opts && given_opts->favor == GIT_MERGE_FILE_FAVOR_THEIRS)\n\t\tfavored = theirs;\n\telse\n\t\tgoto done;\n\n\tif ((out->path = git__strdup(favored->path)) == NULL ||\n\t\t(out->ptr = git__malloc(favored->size)) == NULL)\n\t\tgoto done;\n\n\tmemcpy((char *)out->ptr, favored->ptr, favored->size);\n\tout->len = favored->size;\n\tout->mode = favored->mode;\n\tout->automergeable = 1;\n\ndone:\n\treturn 0;\n}"
  },
  {
    "function_name": "merge_file__is_binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "198-208",
    "snippet": "static bool merge_file__is_binary(const git_merge_file_input *file)\n{\n\tsize_t len = file ? file->size : 0;\n\n\tif (len > GIT_XDIFF_MAX_SIZE)\n\t\treturn true;\n\tif (len > GIT_MERGE_FILE_BINARY_SIZE)\n\t\tlen = GIT_MERGE_FILE_BINARY_SIZE;\n\n\treturn len ? (memchr(file->ptr, 0, len) != NULL) : false;\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define GIT_MERGE_FILE_BINARY_SIZE 8000"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "file->ptr",
            "0",
            "len"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\n#define GIT_MERGE_FILE_BINARY_SIZE 8000\n\nstatic bool merge_file__is_binary(const git_merge_file_input *file)\n{\n\tsize_t len = file ? file->size : 0;\n\n\tif (len > GIT_XDIFF_MAX_SIZE)\n\t\treturn true;\n\tif (len > GIT_MERGE_FILE_BINARY_SIZE)\n\t\tlen = GIT_MERGE_FILE_BINARY_SIZE;\n\n\treturn len ? (memchr(file->ptr, 0, len) != NULL) : false;\n}"
  },
  {
    "function_name": "merge_file__xdiff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "109-196",
    "snippet": "static int merge_file__xdiff(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\txmparam_t xmparam;\n\tmmfile_t ancestor_mmfile = {0}, our_mmfile = {0}, their_mmfile = {0};\n\tmmbuffer_t mmbuffer;\n\tgit_merge_file_options options = GIT_MERGE_FILE_OPTIONS_INIT;\n\tconst char *path;\n\tint xdl_result;\n\tint error = 0;\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tmerge_file_normalize_opts(&options, given_opts);\n\n\tmemset(&xmparam, 0x0, sizeof(xmparam_t));\n\n\tif (ancestor) {\n\t\txmparam.ancestor = (options.ancestor_label) ?\n\t\t\toptions.ancestor_label : ancestor->path;\n\t\tancestor_mmfile.ptr = (char *)ancestor->ptr;\n\t\tancestor_mmfile.size = ancestor->size;\n\t}\n\n\txmparam.file1 = (options.our_label) ?\n\t\toptions.our_label : ours->path;\n\tour_mmfile.ptr = (char *)ours->ptr;\n\tour_mmfile.size = ours->size;\n\n\txmparam.file2 = (options.their_label) ?\n\t\toptions.their_label : theirs->path;\n\ttheir_mmfile.ptr = (char *)theirs->ptr;\n\ttheir_mmfile.size = theirs->size;\n\n\tif (options.favor == GIT_MERGE_FILE_FAVOR_OURS)\n\t\txmparam.favor = XDL_MERGE_FAVOR_OURS;\n\telse if (options.favor == GIT_MERGE_FILE_FAVOR_THEIRS)\n\t\txmparam.favor = XDL_MERGE_FAVOR_THEIRS;\n\telse if (options.favor == GIT_MERGE_FILE_FAVOR_UNION)\n\t\txmparam.favor = XDL_MERGE_FAVOR_UNION;\n\n\txmparam.level = (options.flags & GIT_MERGE_FILE_SIMPLIFY_ALNUM) ?\n\t\tXDL_MERGE_ZEALOUS_ALNUM : XDL_MERGE_ZEALOUS;\n\n\tif (options.flags & GIT_MERGE_FILE_STYLE_DIFF3)\n\t\txmparam.style = XDL_MERGE_DIFF3;\n\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE;\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE_CHANGE)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE_EOL)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (options.flags & GIT_MERGE_FILE_DIFF_PATIENCE)\n\t\txmparam.xpp.flags |= XDF_PATIENCE_DIFF;\n\n\tif (options.flags & GIT_MERGE_FILE_DIFF_MINIMAL)\n\t\txmparam.xpp.flags |= XDF_NEED_MINIMAL;\n\n\tif ((xdl_result = xdl_merge(&ancestor_mmfile, &our_mmfile,\n\t\t&their_mmfile, &xmparam, &mmbuffer)) < 0) {\n\t\tgiterr_set(GITERR_MERGE, \"Failed to merge files.\");\n\t\terror = -1;\n\t\tgoto done;\n\t}\n\n\tif ((path = merge_file_best_path(ancestor, ours, theirs)) != NULL &&\n\t\t(out->path = strdup(path)) == NULL) {\n\t\terror = -1;\n\t\tgoto done;\n\t}\n\n\tout->automergeable = (xdl_result == 0);\n\tout->ptr = (const char *)mmbuffer.ptr;\n\tout->len = mmbuffer.size;\n\tout->mode = merge_file_best_mode(ancestor, ours, theirs);\n\ndone:\n\tif (error < 0)\n\t\tgit_merge_file_result_free(out);\n\n\treturn error;\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_merge_file_result_free",
          "args": [
            "out"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "git_merge_file_result_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "339-346",
          "snippet": "void git_merge_file_result_free(git_merge_file_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tgit__free((char *)result->path);\n\tgit__free((char *)result->ptr);\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_merge_file_result_free(git_merge_file_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tgit__free((char *)result->path);\n\tgit__free((char *)result->ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "merge_file_best_mode",
          "args": [
            "ancestor",
            "ours",
            "theirs"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "merge_file_best_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "49-73",
          "snippet": "GIT_INLINE(int) merge_file_best_mode(\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs)\n{\n\t/*\n\t * If ancestor didn't exist and either ours or theirs is executable,\n\t * assume executable.  Otherwise, if any mode changed from the ancestor,\n\t * use that one.\n\t */\n\tif (!ancestor) {\n\t\tif ((ours && ours->mode == GIT_FILEMODE_BLOB_EXECUTABLE) ||\n\t\t\t(theirs && theirs->mode == GIT_FILEMODE_BLOB_EXECUTABLE))\n\t\t\treturn GIT_FILEMODE_BLOB_EXECUTABLE;\n\n\t\treturn GIT_FILEMODE_BLOB;\n\t} else if (ours && theirs) {\n\t\tif (ancestor->mode == ours->mode)\n\t\t\treturn theirs->mode;\n\n\t\treturn ours->mode;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) merge_file_best_mode(\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs)\n{\n\t/*\n\t * If ancestor didn't exist and either ours or theirs is executable,\n\t * assume executable.  Otherwise, if any mode changed from the ancestor,\n\t * use that one.\n\t */\n\tif (!ancestor) {\n\t\tif ((ours && ours->mode == GIT_FILEMODE_BLOB_EXECUTABLE) ||\n\t\t\t(theirs && theirs->mode == GIT_FILEMODE_BLOB_EXECUTABLE))\n\t\t\treturn GIT_FILEMODE_BLOB_EXECUTABLE;\n\n\t\treturn GIT_FILEMODE_BLOB;\n\t} else if (ours && theirs) {\n\t\tif (ancestor->mode == ours->mode)\n\t\t\treturn theirs->mode;\n\n\t\treturn ours->mode;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "path"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "merge_file_best_path",
          "args": [
            "ancestor",
            "ours",
            "theirs"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "merge_file_best_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "29-47",
          "snippet": "GIT_INLINE(const char *) merge_file_best_path(\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs)\n{\n\tif (!ancestor) {\n\t\tif (ours && theirs && strcmp(ours->path, theirs->path) == 0)\n\t\t\treturn ours->path;\n\n\t\treturn NULL;\n\t}\n\n\tif (ours && strcmp(ancestor->path, ours->path) == 0)\n\t\treturn theirs ? theirs->path : NULL;\n\telse if(theirs && strcmp(ancestor->path, theirs->path) == 0)\n\t\treturn ours ? ours->path : NULL;\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) merge_file_best_path(\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs)\n{\n\tif (!ancestor) {\n\t\tif (ours && theirs && strcmp(ours->path, theirs->path) == 0)\n\t\t\treturn ours->path;\n\n\t\treturn NULL;\n\t}\n\n\tif (ours && strcmp(ancestor->path, ours->path) == 0)\n\t\treturn theirs ? theirs->path : NULL;\n\telse if(theirs && strcmp(ancestor->path, theirs->path) == 0)\n\t\treturn ours ? ours->path : NULL;\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_MERGE",
            "\"Failed to merge files.\""
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdl_merge",
          "args": [
            "&ancestor_mmfile",
            "&our_mmfile",
            "&their_mmfile",
            "&xmparam",
            "&mmbuffer"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xmerge.c",
          "lines": "625-678",
          "snippet": "int xdl_merge(mmfile_t *orig, mmfile_t *mf1, mmfile_t *mf2,\n\t\txmparam_t const *xmp, mmbuffer_t *result)\n{\n\txdchange_t *xscr1, *xscr2;\n\txdfenv_t xe1, xe2;\n\tint status;\n\txpparam_t const *xpp = &xmp->xpp;\n\n\tresult->ptr = NULL;\n\tresult->size = 0;\n\n\tif (xdl_do_diff(orig, mf1, xpp, &xe1) < 0) {\n\t\treturn -1;\n\t}\n\tif (xdl_do_diff(orig, mf2, xpp, &xe2) < 0) {\n\t\txdl_free_env(&xe1);\n\t\treturn -1;\n\t}\n\tif (xdl_change_compact(&xe1.xdf1, &xe1.xdf2, xpp->flags) < 0 ||\n\t    xdl_change_compact(&xe1.xdf2, &xe1.xdf1, xpp->flags) < 0 ||\n\t    xdl_build_script(&xe1, &xscr1) < 0) {\n\t\txdl_free_env(&xe1);\n\t\treturn -1;\n\t}\n\tif (xdl_change_compact(&xe2.xdf1, &xe2.xdf2, xpp->flags) < 0 ||\n\t    xdl_change_compact(&xe2.xdf2, &xe2.xdf1, xpp->flags) < 0 ||\n\t    xdl_build_script(&xe2, &xscr2) < 0) {\n\t\txdl_free_script(xscr1);\n\t\txdl_free_env(&xe1);\n\t\txdl_free_env(&xe2);\n\t\treturn -1;\n\t}\n\tstatus = 0;\n\tif (!xscr1) {\n\t\tresult->ptr = xdl_malloc(mf2->size);\n\t\tmemcpy(result->ptr, mf2->ptr, mf2->size);\n\t\tresult->size = mf2->size;\n\t} else if (!xscr2) {\n\t\tresult->ptr = xdl_malloc(mf1->size);\n\t\tmemcpy(result->ptr, mf1->ptr, mf1->size);\n\t\tresult->size = mf1->size;\n\t} else {\n\t\tstatus = xdl_do_merge(&xe1, xscr1,\n\t\t\t\t      &xe2, xscr2,\n\t\t\t\t      xmp, result);\n\t}\n\txdl_free_script(xscr1);\n\txdl_free_script(xscr2);\n\n\txdl_free_env(&xe1);\n\txdl_free_env(&xe2);\n\n\treturn status;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include \"xinclude.h\"\n\nint xdl_merge(mmfile_t *orig, mmfile_t *mf1, mmfile_t *mf2,\n\t\txmparam_t const *xmp, mmbuffer_t *result)\n{\n\txdchange_t *xscr1, *xscr2;\n\txdfenv_t xe1, xe2;\n\tint status;\n\txpparam_t const *xpp = &xmp->xpp;\n\n\tresult->ptr = NULL;\n\tresult->size = 0;\n\n\tif (xdl_do_diff(orig, mf1, xpp, &xe1) < 0) {\n\t\treturn -1;\n\t}\n\tif (xdl_do_diff(orig, mf2, xpp, &xe2) < 0) {\n\t\txdl_free_env(&xe1);\n\t\treturn -1;\n\t}\n\tif (xdl_change_compact(&xe1.xdf1, &xe1.xdf2, xpp->flags) < 0 ||\n\t    xdl_change_compact(&xe1.xdf2, &xe1.xdf1, xpp->flags) < 0 ||\n\t    xdl_build_script(&xe1, &xscr1) < 0) {\n\t\txdl_free_env(&xe1);\n\t\treturn -1;\n\t}\n\tif (xdl_change_compact(&xe2.xdf1, &xe2.xdf2, xpp->flags) < 0 ||\n\t    xdl_change_compact(&xe2.xdf2, &xe2.xdf1, xpp->flags) < 0 ||\n\t    xdl_build_script(&xe2, &xscr2) < 0) {\n\t\txdl_free_script(xscr1);\n\t\txdl_free_env(&xe1);\n\t\txdl_free_env(&xe2);\n\t\treturn -1;\n\t}\n\tstatus = 0;\n\tif (!xscr1) {\n\t\tresult->ptr = xdl_malloc(mf2->size);\n\t\tmemcpy(result->ptr, mf2->ptr, mf2->size);\n\t\tresult->size = mf2->size;\n\t} else if (!xscr2) {\n\t\tresult->ptr = xdl_malloc(mf1->size);\n\t\tmemcpy(result->ptr, mf1->ptr, mf1->size);\n\t\tresult->size = mf1->size;\n\t} else {\n\t\tstatus = xdl_do_merge(&xe1, xscr1,\n\t\t\t\t      &xe2, xscr2,\n\t\t\t\t      xmp, result);\n\t}\n\txdl_free_script(xscr1);\n\txdl_free_script(xscr2);\n\n\txdl_free_env(&xe1);\n\txdl_free_env(&xe2);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&xmparam",
            "0x0",
            "sizeof(xmparam_t)"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "merge_file_normalize_opts",
          "args": [
            "&options",
            "given_opts"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "merge_file_normalize_opts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
          "lines": "97-107",
          "snippet": "static void merge_file_normalize_opts(\n\tgit_merge_file_options *out,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (given_opts)\n\t\tmemcpy(out, given_opts, sizeof(git_merge_file_options));\n\telse {\n\t\tgit_merge_file_options default_opts = GIT_MERGE_FILE_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_merge_file_options));\n\t}\n}",
          "includes": [
            "#include \"xdiff/xdiff.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"index.h\"",
            "#include \"fileops.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic void merge_file_normalize_opts(\n\tgit_merge_file_options *out,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (given_opts)\n\t\tmemcpy(out, given_opts, sizeof(git_merge_file_options));\n\telse {\n\t\tgit_merge_file_options default_opts = GIT_MERGE_FILE_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_merge_file_options));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "out",
            "0x0",
            "sizeof(git_merge_file_result)"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int merge_file__xdiff(\n\tgit_merge_file_result *out,\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs,\n\tconst git_merge_file_options *given_opts)\n{\n\txmparam_t xmparam;\n\tmmfile_t ancestor_mmfile = {0}, our_mmfile = {0}, their_mmfile = {0};\n\tmmbuffer_t mmbuffer;\n\tgit_merge_file_options options = GIT_MERGE_FILE_OPTIONS_INIT;\n\tconst char *path;\n\tint xdl_result;\n\tint error = 0;\n\n\tmemset(out, 0x0, sizeof(git_merge_file_result));\n\n\tmerge_file_normalize_opts(&options, given_opts);\n\n\tmemset(&xmparam, 0x0, sizeof(xmparam_t));\n\n\tif (ancestor) {\n\t\txmparam.ancestor = (options.ancestor_label) ?\n\t\t\toptions.ancestor_label : ancestor->path;\n\t\tancestor_mmfile.ptr = (char *)ancestor->ptr;\n\t\tancestor_mmfile.size = ancestor->size;\n\t}\n\n\txmparam.file1 = (options.our_label) ?\n\t\toptions.our_label : ours->path;\n\tour_mmfile.ptr = (char *)ours->ptr;\n\tour_mmfile.size = ours->size;\n\n\txmparam.file2 = (options.their_label) ?\n\t\toptions.their_label : theirs->path;\n\ttheir_mmfile.ptr = (char *)theirs->ptr;\n\ttheir_mmfile.size = theirs->size;\n\n\tif (options.favor == GIT_MERGE_FILE_FAVOR_OURS)\n\t\txmparam.favor = XDL_MERGE_FAVOR_OURS;\n\telse if (options.favor == GIT_MERGE_FILE_FAVOR_THEIRS)\n\t\txmparam.favor = XDL_MERGE_FAVOR_THEIRS;\n\telse if (options.favor == GIT_MERGE_FILE_FAVOR_UNION)\n\t\txmparam.favor = XDL_MERGE_FAVOR_UNION;\n\n\txmparam.level = (options.flags & GIT_MERGE_FILE_SIMPLIFY_ALNUM) ?\n\t\tXDL_MERGE_ZEALOUS_ALNUM : XDL_MERGE_ZEALOUS;\n\n\tif (options.flags & GIT_MERGE_FILE_STYLE_DIFF3)\n\t\txmparam.style = XDL_MERGE_DIFF3;\n\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE;\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE_CHANGE)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (options.flags & GIT_MERGE_FILE_IGNORE_WHITESPACE_EOL)\n\t\txmparam.xpp.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (options.flags & GIT_MERGE_FILE_DIFF_PATIENCE)\n\t\txmparam.xpp.flags |= XDF_PATIENCE_DIFF;\n\n\tif (options.flags & GIT_MERGE_FILE_DIFF_MINIMAL)\n\t\txmparam.xpp.flags |= XDF_NEED_MINIMAL;\n\n\tif ((xdl_result = xdl_merge(&ancestor_mmfile, &our_mmfile,\n\t\t&their_mmfile, &xmparam, &mmbuffer)) < 0) {\n\t\tgiterr_set(GITERR_MERGE, \"Failed to merge files.\");\n\t\terror = -1;\n\t\tgoto done;\n\t}\n\n\tif ((path = merge_file_best_path(ancestor, ours, theirs)) != NULL &&\n\t\t(out->path = strdup(path)) == NULL) {\n\t\terror = -1;\n\t\tgoto done;\n\t}\n\n\tout->automergeable = (xdl_result == 0);\n\tout->ptr = (const char *)mmbuffer.ptr;\n\tout->len = mmbuffer.size;\n\tout->mode = merge_file_best_mode(ancestor, ours, theirs);\n\ndone:\n\tif (error < 0)\n\t\tgit_merge_file_result_free(out);\n\n\treturn error;\n}"
  },
  {
    "function_name": "merge_file_normalize_opts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "97-107",
    "snippet": "static void merge_file_normalize_opts(\n\tgit_merge_file_options *out,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (given_opts)\n\t\tmemcpy(out, given_opts, sizeof(git_merge_file_options));\n\telse {\n\t\tgit_merge_file_options default_opts = GIT_MERGE_FILE_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_merge_file_options));\n\t}\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out",
            "&default_opts",
            "sizeof(git_merge_file_options)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out",
            "given_opts",
            "sizeof(git_merge_file_options)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic void merge_file_normalize_opts(\n\tgit_merge_file_options *out,\n\tconst git_merge_file_options *given_opts)\n{\n\tif (given_opts)\n\t\tmemcpy(out, given_opts, sizeof(git_merge_file_options));\n\telse {\n\t\tgit_merge_file_options default_opts = GIT_MERGE_FILE_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_merge_file_options));\n\t}\n}"
  },
  {
    "function_name": "git_merge_file__input_from_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "75-95",
    "snippet": "int git_merge_file__input_from_index(\n\tgit_merge_file_input *input_out,\n\tgit_odb_object **odb_object_out,\n\tgit_odb *odb,\n\tconst git_index_entry *entry)\n{\n\tint error = 0;\n\n\tassert(input_out && odb_object_out && odb && entry);\n\n\tif ((error = git_odb_read(odb_object_out, odb, &entry->id)) < 0)\n\t\tgoto done;\n\n\tinput_out->path = entry->path;\n\tinput_out->mode = entry->mode;\n\tinput_out->ptr = (char *)git_odb_object_data(*odb_object_out);\n\tinput_out->size = git_odb_object_size(*odb_object_out);\n\ndone:\n\treturn error;\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_object_size",
          "args": [
            "*odb_object_out"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "120-123",
          "snippet": "size_t git_odb_object_size(git_odb_object *object)\n{\n\treturn object->cached.size;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nsize_t git_odb_object_size(git_odb_object *object)\n{\n\treturn object->cached.size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_object_data",
          "args": [
            "*odb_object_out"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "115-118",
          "snippet": "const void *git_odb_object_data(git_odb_object *object)\n{\n\treturn object->buffer;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nconst void *git_odb_object_data(git_odb_object *object)\n{\n\treturn object->buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_read",
          "args": [
            "odb_object_out",
            "odb",
            "&entry->id"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "862-881",
          "snippet": "int git_odb_read(git_odb_object **out, git_odb *db, const git_oid *id)\n{\n\tint error;\n\n\tassert(out && db && id);\n\n\t*out = git_cache_get_raw(odb_cache(db), id);\n\tif (*out != NULL)\n\t\treturn 0;\n\n\terror = odb_read_1(out, db, id, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_read_1(out, db, id, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id\", id, GIT_OID_HEXSZ);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_read(git_odb_object **out, git_odb *db, const git_oid *id)\n{\n\tint error;\n\n\tassert(out && db && id);\n\n\t*out = git_cache_get_raw(odb_cache(db), id);\n\tif (*out != NULL)\n\t\treturn 0;\n\n\terror = odb_read_1(out, db, id, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_read_1(out, db, id, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id\", id, GIT_OID_HEXSZ);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "input_out && odb_object_out && odb && entry"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_merge_file__input_from_index(\n\tgit_merge_file_input *input_out,\n\tgit_odb_object **odb_object_out,\n\tgit_odb *odb,\n\tconst git_index_entry *entry)\n{\n\tint error = 0;\n\n\tassert(input_out && odb_object_out && odb && entry);\n\n\tif ((error = git_odb_read(odb_object_out, odb, &entry->id)) < 0)\n\t\tgoto done;\n\n\tinput_out->path = entry->path;\n\tinput_out->mode = entry->mode;\n\tinput_out->ptr = (char *)git_odb_object_data(*odb_object_out);\n\tinput_out->size = git_odb_object_size(*odb_object_out);\n\ndone:\n\treturn error;\n}"
  },
  {
    "function_name": "merge_file_best_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "49-73",
    "snippet": "GIT_INLINE(int) merge_file_best_mode(\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs)\n{\n\t/*\n\t * If ancestor didn't exist and either ours or theirs is executable,\n\t * assume executable.  Otherwise, if any mode changed from the ancestor,\n\t * use that one.\n\t */\n\tif (!ancestor) {\n\t\tif ((ours && ours->mode == GIT_FILEMODE_BLOB_EXECUTABLE) ||\n\t\t\t(theirs && theirs->mode == GIT_FILEMODE_BLOB_EXECUTABLE))\n\t\t\treturn GIT_FILEMODE_BLOB_EXECUTABLE;\n\n\t\treturn GIT_FILEMODE_BLOB;\n\t} else if (ours && theirs) {\n\t\tif (ancestor->mode == ours->mode)\n\t\t\treturn theirs->mode;\n\n\t\treturn ours->mode;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) merge_file_best_mode(\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs)\n{\n\t/*\n\t * If ancestor didn't exist and either ours or theirs is executable,\n\t * assume executable.  Otherwise, if any mode changed from the ancestor,\n\t * use that one.\n\t */\n\tif (!ancestor) {\n\t\tif ((ours && ours->mode == GIT_FILEMODE_BLOB_EXECUTABLE) ||\n\t\t\t(theirs && theirs->mode == GIT_FILEMODE_BLOB_EXECUTABLE))\n\t\t\treturn GIT_FILEMODE_BLOB_EXECUTABLE;\n\n\t\treturn GIT_FILEMODE_BLOB;\n\t} else if (ours && theirs) {\n\t\tif (ancestor->mode == ours->mode)\n\t\t\treturn theirs->mode;\n\n\t\treturn ours->mode;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "merge_file_best_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge_file.c",
    "lines": "29-47",
    "snippet": "GIT_INLINE(const char *) merge_file_best_path(\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs)\n{\n\tif (!ancestor) {\n\t\tif (ours && theirs && strcmp(ours->path, theirs->path) == 0)\n\t\t\treturn ours->path;\n\n\t\treturn NULL;\n\t}\n\n\tif (ours && strcmp(ancestor->path, ours->path) == 0)\n\t\treturn theirs ? theirs->path : NULL;\n\telse if(theirs && strcmp(ancestor->path, theirs->path) == 0)\n\t\treturn ours ? ours->path : NULL;\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"xdiff/xdiff.h\"",
      "#include \"git2/merge.h\"",
      "#include \"git2/index.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"index.h\"",
      "#include \"fileops.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "ancestor->path",
            "theirs->path"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xdiff/xdiff.h\"\n#include \"git2/merge.h\"\n#include \"git2/index.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"diff_xdiff.h\"\n#include \"index.h\"\n#include \"fileops.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) merge_file_best_path(\n\tconst git_merge_file_input *ancestor,\n\tconst git_merge_file_input *ours,\n\tconst git_merge_file_input *theirs)\n{\n\tif (!ancestor) {\n\t\tif (ours && theirs && strcmp(ours->path, theirs->path) == 0)\n\t\t\treturn ours->path;\n\n\t\treturn NULL;\n\t}\n\n\tif (ours && strcmp(ancestor->path, ours->path) == 0)\n\t\treturn theirs ? theirs->path : NULL;\n\telse if(theirs && strcmp(ancestor->path, theirs->path) == 0)\n\t\treturn ours ? ours->path : NULL;\n\n\treturn NULL;\n}"
  }
]