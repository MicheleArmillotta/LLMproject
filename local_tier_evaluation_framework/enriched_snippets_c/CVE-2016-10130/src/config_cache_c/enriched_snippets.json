[
  {
    "function_name": "git_repository__cvar_cache_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
    "lines": "122-128",
    "snippet": "void git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}",
    "includes": [
      "#include \"filter.h\"",
      "#include \"vector.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"repository.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}"
  },
  {
    "function_name": "git_repository__cvar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
    "lines": "104-120",
    "snippet": "int git_repository__cvar(int *out, git_repository *repo, git_cvar_cached cvar)\n{\n\t*out = repo->cvar_cache[(int)cvar];\n\n\tif (*out == GIT_CVAR_NOT_CACHED) {\n\t\tint error;\n\t\tgit_config *config;\n\n\t\tif ((error = git_repository_config__weakptr(&config, repo)) < 0 ||\n\t\t\t(error = git_config__cvar(out, config, cvar)) < 0)\n\t\t\treturn error;\n\n\t\trepo->cvar_cache[(int)cvar] = *out;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"filter.h\"",
      "#include \"vector.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"repository.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config__cvar",
          "args": [
            "out",
            "config",
            "cvar"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__cvar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
          "lines": "83-102",
          "snippet": "int git_config__cvar(int *out, git_config *config, git_cvar_cached cvar)\n{\n\tint error = 0;\n\tstruct map_data *data = &_cvar_maps[(int)cvar];\n\tgit_config_entry *entry;\n\n\tif ((error = git_config__lookup_entry(&entry, config, data->cvar_name, false)) < 0)\n\t\treturn error;\n\n\tif (!entry)\n\t\t*out = data->default_value;\n\telse if (data->maps)\n\t\terror = git_config_lookup_map_value(\n\t\t\tout, data->maps, data->map_count, entry->value);\n\telse\n\t\terror = git_config_parse_bool(out, entry->value);\n\n\tgit_config_entry_free(entry);\n\treturn error;\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"vector.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"repository.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct map_data _cvar_maps[] = {\n\t{\"core.autocrlf\", _cvar_map_autocrlf, ARRAY_SIZE(_cvar_map_autocrlf), GIT_AUTO_CRLF_DEFAULT},\n\t{\"core.eol\", _cvar_map_eol, ARRAY_SIZE(_cvar_map_eol), GIT_EOL_DEFAULT},\n\t{\"core.symlinks\", NULL, 0, GIT_SYMLINKS_DEFAULT },\n\t{\"core.ignorecase\", NULL, 0, GIT_IGNORECASE_DEFAULT },\n\t{\"core.filemode\", NULL, 0, GIT_FILEMODE_DEFAULT },\n\t{\"core.ignorestat\", NULL, 0, GIT_IGNORESTAT_DEFAULT },\n\t{\"core.trustctime\", NULL, 0, GIT_TRUSTCTIME_DEFAULT },\n\t{\"core.abbrev\", _cvar_map_int, 1, GIT_ABBREV_DEFAULT },\n\t{\"core.precomposeunicode\", NULL, 0, GIT_PRECOMPOSE_DEFAULT },\n\t{\"core.safecrlf\", _cvar_map_safecrlf, ARRAY_SIZE(_cvar_map_safecrlf), GIT_SAFE_CRLF_DEFAULT},\n\t{\"core.logallrefupdates\", NULL, 0, GIT_LOGALLREFUPDATES_DEFAULT },\n\t{\"core.protecthfs\", NULL, 0, GIT_PROTECTHFS_DEFAULT },\n\t{\"core.protectntfs\", NULL, 0, GIT_PROTECTNTFS_DEFAULT },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct map_data _cvar_maps[] = {\n\t{\"core.autocrlf\", _cvar_map_autocrlf, ARRAY_SIZE(_cvar_map_autocrlf), GIT_AUTO_CRLF_DEFAULT},\n\t{\"core.eol\", _cvar_map_eol, ARRAY_SIZE(_cvar_map_eol), GIT_EOL_DEFAULT},\n\t{\"core.symlinks\", NULL, 0, GIT_SYMLINKS_DEFAULT },\n\t{\"core.ignorecase\", NULL, 0, GIT_IGNORECASE_DEFAULT },\n\t{\"core.filemode\", NULL, 0, GIT_FILEMODE_DEFAULT },\n\t{\"core.ignorestat\", NULL, 0, GIT_IGNORESTAT_DEFAULT },\n\t{\"core.trustctime\", NULL, 0, GIT_TRUSTCTIME_DEFAULT },\n\t{\"core.abbrev\", _cvar_map_int, 1, GIT_ABBREV_DEFAULT },\n\t{\"core.precomposeunicode\", NULL, 0, GIT_PRECOMPOSE_DEFAULT },\n\t{\"core.safecrlf\", _cvar_map_safecrlf, ARRAY_SIZE(_cvar_map_safecrlf), GIT_SAFE_CRLF_DEFAULT},\n\t{\"core.logallrefupdates\", NULL, 0, GIT_LOGALLREFUPDATES_DEFAULT },\n\t{\"core.protecthfs\", NULL, 0, GIT_PROTECTHFS_DEFAULT },\n\t{\"core.protectntfs\", NULL, 0, GIT_PROTECTNTFS_DEFAULT },\n};\n\nint git_config__cvar(int *out, git_config *config, git_cvar_cached cvar)\n{\n\tint error = 0;\n\tstruct map_data *data = &_cvar_maps[(int)cvar];\n\tgit_config_entry *entry;\n\n\tif ((error = git_config__lookup_entry(&entry, config, data->cvar_name, false)) < 0)\n\t\treturn error;\n\n\tif (!entry)\n\t\t*out = data->default_value;\n\telse if (data->maps)\n\t\terror = git_config_lookup_map_value(\n\t\t\tout, data->maps, data->map_count, entry->value);\n\telse\n\t\terror = git_config_parse_bool(out, entry->value);\n\n\tgit_config_entry_free(entry);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config__weakptr",
          "args": [
            "&config",
            "repo"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "661-705",
          "snippet": "int git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_repository__cvar(int *out, git_repository *repo, git_cvar_cached cvar)\n{\n\t*out = repo->cvar_cache[(int)cvar];\n\n\tif (*out == GIT_CVAR_NOT_CACHED) {\n\t\tint error;\n\t\tgit_config *config;\n\n\t\tif ((error = git_repository_config__weakptr(&config, repo)) < 0 ||\n\t\t\t(error = git_config__cvar(out, config, cvar)) < 0)\n\t\t\treturn error;\n\n\t\trepo->cvar_cache[(int)cvar] = *out;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_config__cvar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
    "lines": "83-102",
    "snippet": "int git_config__cvar(int *out, git_config *config, git_cvar_cached cvar)\n{\n\tint error = 0;\n\tstruct map_data *data = &_cvar_maps[(int)cvar];\n\tgit_config_entry *entry;\n\n\tif ((error = git_config__lookup_entry(&entry, config, data->cvar_name, false)) < 0)\n\t\treturn error;\n\n\tif (!entry)\n\t\t*out = data->default_value;\n\telse if (data->maps)\n\t\terror = git_config_lookup_map_value(\n\t\t\tout, data->maps, data->map_count, entry->value);\n\telse\n\t\terror = git_config_parse_bool(out, entry->value);\n\n\tgit_config_entry_free(entry);\n\treturn error;\n}",
    "includes": [
      "#include \"filter.h\"",
      "#include \"vector.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"repository.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct map_data _cvar_maps[] = {\n\t{\"core.autocrlf\", _cvar_map_autocrlf, ARRAY_SIZE(_cvar_map_autocrlf), GIT_AUTO_CRLF_DEFAULT},\n\t{\"core.eol\", _cvar_map_eol, ARRAY_SIZE(_cvar_map_eol), GIT_EOL_DEFAULT},\n\t{\"core.symlinks\", NULL, 0, GIT_SYMLINKS_DEFAULT },\n\t{\"core.ignorecase\", NULL, 0, GIT_IGNORECASE_DEFAULT },\n\t{\"core.filemode\", NULL, 0, GIT_FILEMODE_DEFAULT },\n\t{\"core.ignorestat\", NULL, 0, GIT_IGNORESTAT_DEFAULT },\n\t{\"core.trustctime\", NULL, 0, GIT_TRUSTCTIME_DEFAULT },\n\t{\"core.abbrev\", _cvar_map_int, 1, GIT_ABBREV_DEFAULT },\n\t{\"core.precomposeunicode\", NULL, 0, GIT_PRECOMPOSE_DEFAULT },\n\t{\"core.safecrlf\", _cvar_map_safecrlf, ARRAY_SIZE(_cvar_map_safecrlf), GIT_SAFE_CRLF_DEFAULT},\n\t{\"core.logallrefupdates\", NULL, 0, GIT_LOGALLREFUPDATES_DEFAULT },\n\t{\"core.protecthfs\", NULL, 0, GIT_PROTECTHFS_DEFAULT },\n\t{\"core.protectntfs\", NULL, 0, GIT_PROTECTNTFS_DEFAULT },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_bool",
          "args": [
            "out",
            "entry->value"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1263-1275",
          "snippet": "int git_config_parse_bool(int *out, const char *value)\n{\n\tif (git__parse_bool(out, value) == 0)\n\t\treturn 0;\n\n\tif (git_config_parse_int32(out, value) == 0) {\n\t\t*out = !!(*out);\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a boolean value\", value);\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_bool(int *out, const char *value)\n{\n\tif (git__parse_bool(out, value) == 0)\n\t\treturn 0;\n\n\tif (git_config_parse_int32(out, value) == 0) {\n\t\t*out = !!(*out);\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a boolean value\", value);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_lookup_map_value",
          "args": [
            "out",
            "data->maps",
            "data->map_count",
            "entry->value"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_lookup_map_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1197-1241",
          "snippet": "int git_config_lookup_map_value(\n\tint *out,\n\tconst git_cvar_map *maps,\n\tsize_t map_n,\n\tconst char *value)\n{\n\tsize_t i;\n\n\tif (!value)\n\t\tgoto fail_parse;\n\n\tfor (i = 0; i < map_n; ++i) {\n\t\tconst git_cvar_map *m = maps + i;\n\n\t\tswitch (m->cvar_type) {\n\t\tcase GIT_CVAR_FALSE:\n\t\tcase GIT_CVAR_TRUE: {\n\t\t\tint bool_val;\n\n\t\t\tif (git__parse_bool(&bool_val, value) == 0 &&\n\t\t\t\tbool_val == (int)m->cvar_type) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tcase GIT_CVAR_INT32:\n\t\t\tif (git_config_parse_int32(out, value) == 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\n\t\tcase GIT_CVAR_STRING:\n\t\t\tif (strcasecmp(value, m->str_match) == 0) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to map '%s'\", value);\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_lookup_map_value(\n\tint *out,\n\tconst git_cvar_map *maps,\n\tsize_t map_n,\n\tconst char *value)\n{\n\tsize_t i;\n\n\tif (!value)\n\t\tgoto fail_parse;\n\n\tfor (i = 0; i < map_n; ++i) {\n\t\tconst git_cvar_map *m = maps + i;\n\n\t\tswitch (m->cvar_type) {\n\t\tcase GIT_CVAR_FALSE:\n\t\tcase GIT_CVAR_TRUE: {\n\t\t\tint bool_val;\n\n\t\t\tif (git__parse_bool(&bool_val, value) == 0 &&\n\t\t\t\tbool_val == (int)m->cvar_type) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tcase GIT_CVAR_INT32:\n\t\t\tif (git_config_parse_int32(out, value) == 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\n\t\tcase GIT_CVAR_STRING:\n\t\t\tif (strcasecmp(value, m->str_match) == 0) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to map '%s'\", value);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config__lookup_entry",
          "args": [
            "&entry",
            "config",
            "data->cvar_name",
            "false"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__lookup_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "737-745",
          "snippet": "int git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct map_data _cvar_maps[] = {\n\t{\"core.autocrlf\", _cvar_map_autocrlf, ARRAY_SIZE(_cvar_map_autocrlf), GIT_AUTO_CRLF_DEFAULT},\n\t{\"core.eol\", _cvar_map_eol, ARRAY_SIZE(_cvar_map_eol), GIT_EOL_DEFAULT},\n\t{\"core.symlinks\", NULL, 0, GIT_SYMLINKS_DEFAULT },\n\t{\"core.ignorecase\", NULL, 0, GIT_IGNORECASE_DEFAULT },\n\t{\"core.filemode\", NULL, 0, GIT_FILEMODE_DEFAULT },\n\t{\"core.ignorestat\", NULL, 0, GIT_IGNORESTAT_DEFAULT },\n\t{\"core.trustctime\", NULL, 0, GIT_TRUSTCTIME_DEFAULT },\n\t{\"core.abbrev\", _cvar_map_int, 1, GIT_ABBREV_DEFAULT },\n\t{\"core.precomposeunicode\", NULL, 0, GIT_PRECOMPOSE_DEFAULT },\n\t{\"core.safecrlf\", _cvar_map_safecrlf, ARRAY_SIZE(_cvar_map_safecrlf), GIT_SAFE_CRLF_DEFAULT},\n\t{\"core.logallrefupdates\", NULL, 0, GIT_LOGALLREFUPDATES_DEFAULT },\n\t{\"core.protecthfs\", NULL, 0, GIT_PROTECTHFS_DEFAULT },\n\t{\"core.protectntfs\", NULL, 0, GIT_PROTECTNTFS_DEFAULT },\n};\n\nint git_config__cvar(int *out, git_config *config, git_cvar_cached cvar)\n{\n\tint error = 0;\n\tstruct map_data *data = &_cvar_maps[(int)cvar];\n\tgit_config_entry *entry;\n\n\tif ((error = git_config__lookup_entry(&entry, config, data->cvar_name, false)) < 0)\n\t\treturn error;\n\n\tif (!entry)\n\t\t*out = data->default_value;\n\telse if (data->maps)\n\t\terror = git_config_lookup_map_value(\n\t\t\tout, data->maps, data->map_count, entry->value);\n\telse\n\t\terror = git_config_parse_bool(out, entry->value);\n\n\tgit_config_entry_free(entry);\n\treturn error;\n}"
  }
]