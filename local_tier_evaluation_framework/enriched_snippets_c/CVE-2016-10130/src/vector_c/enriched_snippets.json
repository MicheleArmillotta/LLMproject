[
  {
    "function_name": "git_vector_verify_sorted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "348-361",
    "snippet": "int git_vector_verify_sorted(const git_vector *v)\n{\n\tsize_t i;\n\n\tif (!git_vector_is_sorted(v))\n\t\treturn -1;\n\n\tfor (i = 1; i < v->length; ++i) {\n\t\tif (v->_cmp(v->contents[i - 1], v->contents[i]) > 0)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v->_cmp",
          "args": [
            "v->contents[i - 1]",
            "v->contents[i]"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_is_sorted",
          "args": [
            "v"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_verify_sorted(const git_vector *v)\n{\n\tsize_t i;\n\n\tif (!git_vector_is_sorted(v))\n\t\treturn -1;\n\n\tfor (i = 1; i < v->length; ++i) {\n\t\tif (v->_cmp(v->contents[i - 1], v->contents[i]) > 0)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_vector_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "333-346",
    "snippet": "int git_vector_set(void **old, git_vector *v, size_t position, void *value)\n{\n\tif (position + 1 > v->length) {\n\t\tif (git_vector_resize_to(v, position + 1) < 0)\n\t\t\treturn -1;\n\t}\n\n\tif (old != NULL)\n\t\t*old = v->contents[position];\n\n\tv->contents[position] = value;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_resize_to",
          "args": [
            "v",
            "position + 1"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_resize_to",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "318-331",
          "snippet": "int git_vector_resize_to(git_vector *v, size_t new_length)\n{\n\tif (new_length > v->_alloc_size &&\n\t\tresize_vector(v, new_length) < 0)\n\t\treturn -1;\n\n\tif (new_length > v->length)\n\t\tmemset(&v->contents[v->length], 0,\n\t\t\tsizeof(void *) * (new_length - v->length));\n\n\tv->length = new_length;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_resize_to(git_vector *v, size_t new_length)\n{\n\tif (new_length > v->_alloc_size &&\n\t\tresize_vector(v, new_length) < 0)\n\t\treturn -1;\n\n\tif (new_length > v->length)\n\t\tmemset(&v->contents[v->length], 0,\n\t\t\tsizeof(void *) * (new_length - v->length));\n\n\tv->length = new_length;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_set(void **old, git_vector *v, size_t position, void *value)\n{\n\tif (position + 1 > v->length) {\n\t\tif (git_vector_resize_to(v, position + 1) < 0)\n\t\t\treturn -1;\n\t}\n\n\tif (old != NULL)\n\t\t*old = v->contents[position];\n\n\tv->contents[position] = value;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_vector_resize_to",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "318-331",
    "snippet": "int git_vector_resize_to(git_vector *v, size_t new_length)\n{\n\tif (new_length > v->_alloc_size &&\n\t\tresize_vector(v, new_length) < 0)\n\t\treturn -1;\n\n\tif (new_length > v->length)\n\t\tmemset(&v->contents[v->length], 0,\n\t\t\tsizeof(void *) * (new_length - v->length));\n\n\tv->length = new_length;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&v->contents[v->length]",
            "0",
            "sizeof(void *) * (new_length - v->length)"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resize_vector",
          "args": [
            "v",
            "new_length"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "resize_vector",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "30-41",
          "snippet": "GIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_resize_to(git_vector *v, size_t new_length)\n{\n\tif (new_length > v->_alloc_size &&\n\t\tresize_vector(v, new_length) < 0)\n\t\treturn -1;\n\n\tif (new_length > v->length)\n\t\tmemset(&v->contents[v->length], 0,\n\t\t\tsizeof(void *) * (new_length - v->length));\n\n\tv->length = new_length;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_vector_swap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "305-316",
    "snippet": "void git_vector_swap(git_vector *a, git_vector *b)\n{\n\tgit_vector t;\n\n\tassert(a && b);\n\n\tif (a != b) {\n\t\tmemcpy(&t, a, sizeof(t));\n\t\tmemcpy(a, b, sizeof(t));\n\t\tmemcpy(b, &t, sizeof(t));\n\t}\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "b",
            "&t",
            "sizeof(t)"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "a",
            "b",
            "sizeof(t)"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&t",
            "a",
            "sizeof(t)"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "a && b"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_swap(git_vector *a, git_vector *b)\n{\n\tgit_vector t;\n\n\tassert(a && b);\n\n\tif (a != b) {\n\t\tmemcpy(&t, a, sizeof(t));\n\t\tmemcpy(a, b, sizeof(t));\n\t\tmemcpy(b, &t, sizeof(t));\n\t}\n}"
  },
  {
    "function_name": "git_vector_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "298-303",
    "snippet": "void git_vector_clear(git_vector *v)\n{\n\tassert(v);\n\tv->length = 0;\n\tgit_vector_set_sorted(v, 1);\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_set_sorted",
          "args": [
            "v",
            "1"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_clear(git_vector *v)\n{\n\tassert(v);\n\tv->length = 0;\n\tgit_vector_set_sorted(v, 1);\n}"
  },
  {
    "function_name": "git_vector_remove_matching",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "281-296",
    "snippet": "void git_vector_remove_matching(\n\tgit_vector *v,\n\tint (*match)(const git_vector *v, size_t idx, void *payload),\n\tvoid *payload)\n{\n\tsize_t i, j;\n\n\tfor (i = 0, j = 0; j < v->length; ++j) {\n\t\tv->contents[i] = v->contents[j];\n\n\t\tif (!match(v, i, payload))\n\t\t\ti++;\n\t}\n\n\tv->length = i;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "match",
          "args": [
            "v",
            "i",
            "payload"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_remove_matching",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "281-296",
          "snippet": "void git_vector_remove_matching(\n\tgit_vector *v,\n\tint (*match)(const git_vector *v, size_t idx, void *payload),\n\tvoid *payload)\n{\n\tsize_t i, j;\n\n\tfor (i = 0, j = 0; j < v->length; ++j) {\n\t\tv->contents[i] = v->contents[j];\n\n\t\tif (!match(v, i, payload))\n\t\t\ti++;\n\t}\n\n\tv->length = i;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_remove_matching(\n\tgit_vector *v,\n\tint (*match)(const git_vector *v, size_t idx, void *payload),\n\tvoid *payload)\n{\n\tsize_t i, j;\n\n\tfor (i = 0, j = 0; j < v->length; ++j) {\n\t\tv->contents[i] = v->contents[j];\n\n\t\tif (!match(v, i, payload))\n\t\t\ti++;\n\t}\n\n\tv->length = i;\n}"
  },
  {
    "function_name": "git_vector_uniq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "258-279",
    "snippet": "void git_vector_uniq(git_vector *v, void  (*git_free_cb)(void *))\n{\n\tgit_vector_cmp cmp;\n\tsize_t i, j;\n\n\tif (v->length <= 1)\n\t\treturn;\n\n\tgit_vector_sort(v);\n\tcmp = v->_cmp ? v->_cmp : strict_comparison;\n\n\tfor (i = 0, j = 1 ; j < v->length; ++j)\n\t\tif (!cmp(v->contents[i], v->contents[j])) {\n\t\t\tif (git_free_cb)\n\t\t\t\tgit_free_cb(v->contents[i]);\n\n\t\t\tv->contents[i] = v->contents[j];\n\t\t} else\n\t\t\tv->contents[++i] = v->contents[j];\n\n\tv->length -= j - i - 1;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_free_cb",
          "args": [
            "v->contents[i]"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmp",
          "args": [
            "v->contents[i]",
            "v->contents[j]"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_set_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "107-113",
          "snippet": "GIT_INLINE(void) git_vector_set_cmp(git_vector *v, git_vector_cmp cmp)\n{\n\tif (cmp != v->_cmp) {\n\t\tv->_cmp = cmp;\n\t\tgit_vector_set_sorted(v, 0);\n\t}\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void) git_vector_set_cmp(git_vector *v, git_vector_cmp cmp)\n{\n\tif (cmp != v->_cmp) {\n\t\tv->_cmp = cmp;\n\t\tgit_vector_set_sorted(v, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_sort",
          "args": [
            "v"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_sort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "175-185",
          "snippet": "void git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_uniq(git_vector *v, void  (*git_free_cb)(void *))\n{\n\tgit_vector_cmp cmp;\n\tsize_t i, j;\n\n\tif (v->length <= 1)\n\t\treturn;\n\n\tgit_vector_sort(v);\n\tcmp = v->_cmp ? v->_cmp : strict_comparison;\n\n\tfor (i = 0, j = 1 ; j < v->length; ++j)\n\t\tif (!cmp(v->contents[i], v->contents[j])) {\n\t\t\tif (git_free_cb)\n\t\t\t\tgit_free_cb(v->contents[i]);\n\n\t\t\tv->contents[i] = v->contents[j];\n\t\t} else\n\t\t\tv->contents[++i] = v->contents[j];\n\n\tv->length -= j - i - 1;\n}"
  },
  {
    "function_name": "git_vector_pop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "252-256",
    "snippet": "void git_vector_pop(git_vector *v)\n{\n\tif (v->length > 0)\n\t\tv->length--;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_pop(git_vector *v)\n{\n\tif (v->length > 0)\n\t\tv->length--;\n}"
  },
  {
    "function_name": "git_vector_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "233-250",
    "snippet": "int git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "&v->contents[idx]",
            "&v->contents[idx + 1]",
            "shift_count * sizeof(void *)"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_vector_search",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "228-231",
    "snippet": "int git_vector_search(size_t *at_pos, const git_vector *v, const void *entry)\n{\n\treturn git_vector_search2(at_pos, v, v->_cmp ? v->_cmp : strict_comparison, entry);\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_search2",
          "args": [
            "at_pos",
            "v",
            "v->_cmp ? v->_cmp : strict_comparison",
            "entry"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_search2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "204-221",
          "snippet": "int git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_search(size_t *at_pos, const git_vector *v, const void *entry)\n{\n\treturn git_vector_search2(at_pos, v, v->_cmp ? v->_cmp : strict_comparison, entry);\n}"
  },
  {
    "function_name": "strict_comparison",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "223-226",
    "snippet": "static int strict_comparison(const void *a, const void *b)\n{\n\treturn (a == b) ? 0 : -1;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nstatic int strict_comparison(const void *a, const void *b)\n{\n\treturn (a == b) ? 0 : -1;\n}"
  },
  {
    "function_name": "git_vector_search2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "204-221",
    "snippet": "int git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "key_lookup",
          "args": [
            "key",
            "v->contents[i]"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v && key && key_lookup"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git_vector_bsearch2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "187-202",
    "snippet": "int git_vector_bsearch2(\n\tsize_t *at_pos,\n\tgit_vector *v,\n\tgit_vector_cmp key_lookup,\n\tconst void *key)\n{\n\tassert(v && key && key_lookup);\n\n\t/* need comparison function to sort the vector */\n\tif (!v->_cmp)\n\t\treturn -1;\n\n\tgit_vector_sort(v);\n\n\treturn git__bsearch(v->contents, v->length, key, key_lookup, at_pos);\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__bsearch",
          "args": [
            "v->contents",
            "v->length",
            "key",
            "key_lookup",
            "at_pos"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "git__bsearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "495-523",
          "snippet": "int git__bsearch(\n\tvoid **array,\n\tsize_t array_len,\n\tconst void *key,\n\tint (*compare)(const void *, const void *),\n\tsize_t *position)\n{\n\tsize_t lim;\n\tint cmp = -1;\n\tvoid **part, **base = array;\n\n\tfor (lim = array_len; lim != 0; lim >>= 1) {\n\t\tpart = base + (lim >> 1);\n\t\tcmp = (*compare)(key, *part);\n\t\tif (cmp == 0) {\n\t\t\tbase = part;\n\t\t\tbreak;\n\t\t}\n\t\tif (cmp > 0) { /* key > p; take right partition */\n\t\t\tbase = part + 1;\n\t\t\tlim--;\n\t\t} /* else take left partition */\n\t}\n\n\tif (position)\n\t\t*position = (base - array);\n\n\treturn (cmp == 0) ? 0 : GIT_ENOTFOUND;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__bsearch(\n\tvoid **array,\n\tsize_t array_len,\n\tconst void *key,\n\tint (*compare)(const void *, const void *),\n\tsize_t *position)\n{\n\tsize_t lim;\n\tint cmp = -1;\n\tvoid **part, **base = array;\n\n\tfor (lim = array_len; lim != 0; lim >>= 1) {\n\t\tpart = base + (lim >> 1);\n\t\tcmp = (*compare)(key, *part);\n\t\tif (cmp == 0) {\n\t\t\tbase = part;\n\t\t\tbreak;\n\t\t}\n\t\tif (cmp > 0) { /* key > p; take right partition */\n\t\t\tbase = part + 1;\n\t\t\tlim--;\n\t\t} /* else take left partition */\n\t}\n\n\tif (position)\n\t\t*position = (base - array);\n\n\treturn (cmp == 0) ? 0 : GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_sort",
          "args": [
            "v"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_sort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "175-185",
          "snippet": "void git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v && key && key_lookup"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_bsearch2(\n\tsize_t *at_pos,\n\tgit_vector *v,\n\tgit_vector_cmp key_lookup,\n\tconst void *key)\n{\n\tassert(v && key && key_lookup);\n\n\t/* need comparison function to sort the vector */\n\tif (!v->_cmp)\n\t\treturn -1;\n\n\tgit_vector_sort(v);\n\n\treturn git__bsearch(v->contents, v->length, key, key_lookup, at_pos);\n}"
  },
  {
    "function_name": "git_vector_sort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "175-185",
    "snippet": "void git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_set_sorted",
          "args": [
            "v",
            "1"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__tsort",
          "args": [
            "v->contents",
            "v->length",
            "v->_cmp"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "git__tsort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tsort.c",
          "lines": "382-385",
          "snippet": "void git__tsort(void **dst, size_t size, git__tsort_cmp cmp)\n{\n\tgit__tsort_r(dst, size, tsort_r_cmp, cmp);\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nvoid git__tsort(void **dst, size_t size, git__tsort_cmp cmp)\n{\n\tgit__tsort_r(dst, size, tsort_r_cmp, cmp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_is_sorted",
          "args": [
            "v"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}"
  },
  {
    "function_name": "git_vector_insert_sorted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "141-173",
    "snippet": "int git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "v->contents + pos + 1",
            "v->contents + pos",
            "(v->length - pos) * sizeof(void *)"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "on_dup",
          "args": [
            "&v->contents[pos]",
            "element"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "paths_on_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blame_git.c",
          "lines": "407-412",
          "snippet": "static int paths_on_dup(void **old, void *new)\n{\n\tGIT_UNUSED(old);\n\tgit__free(new);\n\treturn -1;\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"xdiff/xinclude.h\"",
            "#include \"blob.h\"",
            "#include \"commit.h\"",
            "#include \"blame_git.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"xdiff/xinclude.h\"\n#include \"blob.h\"\n#include \"commit.h\"\n#include \"blame_git.h\"\n\nstatic int paths_on_dup(void **old, void *new)\n{\n\tGIT_UNUSED(old);\n\tgit__free(new);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__bsearch",
          "args": [
            "v->contents",
            "v->length",
            "element",
            "v->_cmp",
            "&pos"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "git__bsearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "495-523",
          "snippet": "int git__bsearch(\n\tvoid **array,\n\tsize_t array_len,\n\tconst void *key,\n\tint (*compare)(const void *, const void *),\n\tsize_t *position)\n{\n\tsize_t lim;\n\tint cmp = -1;\n\tvoid **part, **base = array;\n\n\tfor (lim = array_len; lim != 0; lim >>= 1) {\n\t\tpart = base + (lim >> 1);\n\t\tcmp = (*compare)(key, *part);\n\t\tif (cmp == 0) {\n\t\t\tbase = part;\n\t\t\tbreak;\n\t\t}\n\t\tif (cmp > 0) { /* key > p; take right partition */\n\t\t\tbase = part + 1;\n\t\t\tlim--;\n\t\t} /* else take left partition */\n\t}\n\n\tif (position)\n\t\t*position = (base - array);\n\n\treturn (cmp == 0) ? 0 : GIT_ENOTFOUND;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__bsearch(\n\tvoid **array,\n\tsize_t array_len,\n\tconst void *key,\n\tint (*compare)(const void *, const void *),\n\tsize_t *position)\n{\n\tsize_t lim;\n\tint cmp = -1;\n\tvoid **part, **base = array;\n\n\tfor (lim = array_len; lim != 0; lim >>= 1) {\n\t\tpart = base + (lim >> 1);\n\t\tcmp = (*compare)(key, *part);\n\t\tif (cmp == 0) {\n\t\t\tbase = part;\n\t\t\tbreak;\n\t\t}\n\t\tif (cmp > 0) { /* key > p; take right partition */\n\t\t\tbase = part + 1;\n\t\t\tlim--;\n\t\t} /* else take left partition */\n\t}\n\n\tif (position)\n\t\t*position = (base - array);\n\n\treturn (cmp == 0) ? 0 : GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "resize_vector",
          "args": [
            "v",
            "compute_new_size(v)"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "resize_vector",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "30-41",
          "snippet": "GIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compute_new_size",
          "args": [
            "v"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "compute_new_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "14-28",
          "snippet": "GIT_INLINE(size_t) compute_new_size(git_vector *v)\n{\n\tsize_t new_size = v->_alloc_size;\n\n\t/* Use a resize factor of 1.5, which is quick to compute using integer\n\t * instructions and less than the golden ratio (1.618...) */\n\tif (new_size < MIN_ALLOCSIZE)\n\t\tnew_size = MIN_ALLOCSIZE;\n\telse if (new_size <= (SIZE_MAX / 3) * 2)\n\t\tnew_size += new_size / 2;\n\telse\n\t\tnew_size = SIZE_MAX;\n\n\treturn new_size;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nGIT_INLINE(size_t) compute_new_size(git_vector *v)\n{\n\tsize_t new_size = v->_alloc_size;\n\n\t/* Use a resize factor of 1.5, which is quick to compute using integer\n\t * instructions and less than the golden ratio (1.618...) */\n\tif (new_size < MIN_ALLOCSIZE)\n\t\tnew_size = MIN_ALLOCSIZE;\n\telse if (new_size <= (SIZE_MAX / 3) * 2)\n\t\tnew_size += new_size / 2;\n\telse\n\t\tnew_size = SIZE_MAX;\n\n\treturn new_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_sort",
          "args": [
            "v"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_sort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "175-185",
          "snippet": "void git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_is_sorted",
          "args": [
            "v"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v && v->_cmp"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_vector_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "126-139",
    "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_set_sorted",
          "args": [
            "v",
            "v->length <= 1"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resize_vector",
          "args": [
            "v",
            "compute_new_size(v)"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "resize_vector",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "30-41",
          "snippet": "GIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compute_new_size",
          "args": [
            "v"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "compute_new_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "14-28",
          "snippet": "GIT_INLINE(size_t) compute_new_size(git_vector *v)\n{\n\tsize_t new_size = v->_alloc_size;\n\n\t/* Use a resize factor of 1.5, which is quick to compute using integer\n\t * instructions and less than the golden ratio (1.618...) */\n\tif (new_size < MIN_ALLOCSIZE)\n\t\tnew_size = MIN_ALLOCSIZE;\n\telse if (new_size <= (SIZE_MAX / 3) * 2)\n\t\tnew_size += new_size / 2;\n\telse\n\t\tnew_size = SIZE_MAX;\n\n\treturn new_size;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nGIT_INLINE(size_t) compute_new_size(git_vector *v)\n{\n\tsize_t new_size = v->_alloc_size;\n\n\t/* Use a resize factor of 1.5, which is quick to compute using integer\n\t * instructions and less than the golden ratio (1.618...) */\n\tif (new_size < MIN_ALLOCSIZE)\n\t\tnew_size = MIN_ALLOCSIZE;\n\telse if (new_size <= (SIZE_MAX / 3) * 2)\n\t\tnew_size += new_size / 2;\n\telse\n\t\tnew_size = SIZE_MAX;\n\n\treturn new_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_vector_detach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "110-124",
    "snippet": "void **git_vector_detach(size_t *size, size_t *asize, git_vector *v)\n{\n\tvoid **data = v->contents;\n\n\tif (size)\n\t\t*size = v->length;\n\tif (asize)\n\t\t*asize = v->_alloc_size;\n\n\tv->_alloc_size = 0;\n\tv->length   = 0;\n\tv->contents = NULL;\n\n\treturn data;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid **git_vector_detach(size_t *size, size_t *asize, git_vector *v)\n{\n\tvoid **data = v->contents;\n\n\tif (size)\n\t\t*size = v->length;\n\tif (asize)\n\t\t*asize = v->_alloc_size;\n\n\tv->_alloc_size = 0;\n\tv->length   = 0;\n\tv->contents = NULL;\n\n\treturn data;\n}"
  },
  {
    "function_name": "git_vector_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "97-108",
    "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define MIN_ALLOCSIZE\t8"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "resize_vector",
          "args": [
            "v",
            "max(initial_size, MIN_ALLOCSIZE)"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "resize_vector",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "30-41",
          "snippet": "GIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "initial_size",
            "MIN_ALLOCSIZE"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_set_max_object_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "35-44",
          "snippet": "int git_cache_set_max_object_size(git_otype type, size_t size)\n{\n\tif (type < 0 || (size_t)type >= ARRAY_SIZE(git_cache__max_object_size)) {\n\t\tgiterr_set(GITERR_INVALID, \"type out of range\");\n\t\treturn -1;\n\t}\n\n\tgit_cache__max_object_size[type] = size;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};\n\nint git_cache_set_max_object_size(git_otype type, size_t size)\n{\n\tif (type < 0 || (size_t)type >= ARRAY_SIZE(git_cache__max_object_size)) {\n\t\tgiterr_set(GITERR_INVALID, \"type out of range\");\n\t\treturn -1;\n\t}\n\n\tgit_cache__max_object_size[type] = size;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
  },
  {
    "function_name": "git_vector_free_deep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "83-95",
    "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "v"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "v->contents[i]"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
  },
  {
    "function_name": "git_vector_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "72-81",
    "snippet": "void git_vector_free(git_vector *v)\n{\n\tassert(v);\n\n\tgit__free(v->contents);\n\tv->contents = NULL;\n\n\tv->length = 0;\n\tv->_alloc_size = 0;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "v->contents"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free(git_vector *v)\n{\n\tassert(v);\n\n\tgit__free(v->contents);\n\tv->contents = NULL;\n\n\tv->length = 0;\n\tv->_alloc_size = 0;\n}"
  },
  {
    "function_name": "git_vector_dup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "50-70",
    "snippet": "int git_vector_dup(git_vector *v, const git_vector *src, git_vector_cmp cmp)\n{\n\tsize_t bytes;\n\n\tassert(v && src);\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&bytes, src->length, sizeof(void *));\n\n\tv->_alloc_size = src->length;\n\tv->_cmp = cmp ? cmp : src->_cmp;\n\tv->length = src->length;\n\tv->flags  = src->flags;\n\tif (cmp != src->_cmp)\n\t\tgit_vector_set_sorted(v, 0);\n\tv->contents = git__malloc(bytes);\n\tGITERR_CHECK_ALLOC(v->contents);\n\n\tmemcpy(v->contents, src->contents, bytes);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "v->contents",
            "src->contents",
            "bytes"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "v->contents"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "bytes"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_set_sorted",
          "args": [
            "v",
            "0"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_MULTIPLY",
          "args": [
            "&bytes",
            "src->length",
            "sizeof(void *)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "v && src"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_dup(git_vector *v, const git_vector *src, git_vector_cmp cmp)\n{\n\tsize_t bytes;\n\n\tassert(v && src);\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&bytes, src->length, sizeof(void *));\n\n\tv->_alloc_size = src->length;\n\tv->_cmp = cmp ? cmp : src->_cmp;\n\tv->length = src->length;\n\tv->flags  = src->flags;\n\tif (cmp != src->_cmp)\n\t\tgit_vector_set_sorted(v, 0);\n\tv->contents = git__malloc(bytes);\n\tGITERR_CHECK_ALLOC(v->contents);\n\n\tmemcpy(v->contents, src->contents, bytes);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_vector_size_hint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "43-48",
    "snippet": "int git_vector_size_hint(git_vector *v, size_t size_hint)\n{\n\tif (v->_alloc_size >= size_hint)\n\t\treturn 0;\n\treturn resize_vector(v, size_hint);\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "resize_vector",
          "args": [
            "v",
            "size_hint"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "resize_vector",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "30-41",
          "snippet": "GIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_size_hint(git_vector *v, size_t size_hint)\n{\n\tif (v->_alloc_size >= size_hint)\n\t\treturn 0;\n\treturn resize_vector(v, size_hint);\n}"
  },
  {
    "function_name": "resize_vector",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "30-41",
    "snippet": "GIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "new_contents"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__reallocarray",
          "args": [
            "v->contents",
            "new_size",
            "sizeof(void *)"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "git__reallocarray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "227-232",
          "snippet": "GIT_INLINE(void *) git__reallocarray(void *ptr, size_t nelem, size_t elsize)\n{\n\tsize_t newsize;\n\treturn GIT_MULTIPLY_SIZET_OVERFLOW(&newsize, nelem, elsize) ?\n\t\tNULL : realloc(ptr, newsize);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__reallocarray(void *ptr, size_t nelem, size_t elsize)\n{\n\tsize_t newsize;\n\treturn GIT_MULTIPLY_SIZET_OVERFLOW(&newsize, nelem, elsize) ?\n\t\tNULL : realloc(ptr, newsize);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) resize_vector(git_vector *v, size_t new_size)\n{\n\tvoid *new_contents;\n\n\tnew_contents = git__reallocarray(v->contents, new_size, sizeof(void *));\n\tGITERR_CHECK_ALLOC(new_contents);\n\n\tv->_alloc_size = new_size;\n\tv->contents = new_contents;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "compute_new_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
    "lines": "14-28",
    "snippet": "GIT_INLINE(size_t) compute_new_size(git_vector *v)\n{\n\tsize_t new_size = v->_alloc_size;\n\n\t/* Use a resize factor of 1.5, which is quick to compute using integer\n\t * instructions and less than the golden ratio (1.618...) */\n\tif (new_size < MIN_ALLOCSIZE)\n\t\tnew_size = MIN_ALLOCSIZE;\n\telse if (new_size <= (SIZE_MAX / 3) * 2)\n\t\tnew_size += new_size / 2;\n\telse\n\t\tnew_size = SIZE_MAX;\n\n\treturn new_size;\n}",
    "includes": [
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define MIN_ALLOCSIZE\t8"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nGIT_INLINE(size_t) compute_new_size(git_vector *v)\n{\n\tsize_t new_size = v->_alloc_size;\n\n\t/* Use a resize factor of 1.5, which is quick to compute using integer\n\t * instructions and less than the golden ratio (1.618...) */\n\tif (new_size < MIN_ALLOCSIZE)\n\t\tnew_size = MIN_ALLOCSIZE;\n\telse if (new_size <= (SIZE_MAX / 3) * 2)\n\t\tnew_size += new_size / 2;\n\telse\n\t\tnew_size = SIZE_MAX;\n\n\treturn new_size;\n}"
  }
]