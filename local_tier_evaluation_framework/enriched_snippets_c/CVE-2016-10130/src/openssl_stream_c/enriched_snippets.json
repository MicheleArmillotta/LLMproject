[
  {
    "function_name": "git_openssl_stream_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "640-648",
    "snippet": "int git_openssl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(host);\n\tGIT_UNUSED(port);\n\n\tgiterr_set(GITERR_SSL, \"openssl is not supported in this version\");\n\treturn -1;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_SSL",
            "\"openssl is not supported in this version\""
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "port"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "host"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "out"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nint git_openssl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(host);\n\tGIT_UNUSED(port);\n\n\tgiterr_set(GITERR_SSL, \"openssl is not supported in this version\");\n\treturn -1;\n}"
  },
  {
    "function_name": "git_openssl_set_locking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "634-638",
    "snippet": "int git_openssl_set_locking(void)\n{\n\tgiterr_set(GITERR_SSL, \"libgit2 was not built with OpenSSL support\");\n\treturn -1;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_SSL",
            "\"libgit2 was not built with OpenSSL support\""
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nint git_openssl_set_locking(void)\n{\n\tgiterr_set(GITERR_SSL, \"libgit2 was not built with OpenSSL support\");\n\treturn -1;\n}"
  },
  {
    "function_name": "git_openssl_stream_global_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "629-632",
    "snippet": "int git_openssl_stream_global_init(void)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nint git_openssl_stream_global_init(void)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "git_openssl_stream_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "575-622",
    "snippet": "int git_openssl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tint error;\n\topenssl_stream *st;\n\n\tst = git__calloc(1, sizeof(openssl_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->io = NULL;\n#ifdef GIT_CURL\n\terror = git_curl_stream_new(&st->io, host, port);\n#else\n\terror = git_socket_stream_new(&st->io, host, port);\n#endif\n\n\tif (error < 0)\n\t\tgoto out_err;\n\n\tst->ssl = SSL_new(git__ssl_ctx);\n\tif (st->ssl == NULL) {\n\t\tgiterr_set(GITERR_SSL, \"failed to create ssl object\");\n\t\terror = -1;\n\t\tgoto out_err;\n\t}\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.encrypted = 1;\n\tst->parent.proxy_support = git_stream_supports_proxy(st->io);\n\tst->parent.connect = openssl_connect;\n\tst->parent.certificate = openssl_certificate;\n\tst->parent.set_proxy = openssl_set_proxy;\n\tst->parent.read = openssl_read;\n\tst->parent.write = openssl_write;\n\tst->parent.close = openssl_close;\n\tst->parent.free = openssl_free;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n\nout_err:\n\tgit_stream_free(st->io);\n\tgit__free(st);\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "st"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_stream_free",
          "args": [
            "st->io"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "63-69",
          "snippet": "GIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_stream_supports_proxy",
          "args": [
            "st->io"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_supports_proxy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "33-36",
          "snippet": "GIT_INLINE(int) git_stream_supports_proxy(git_stream *st)\n{\n\treturn st->proxy_support;\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_supports_proxy(git_stream *st)\n{\n\treturn st->proxy_support;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "st->host"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "host"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_SSL",
            "\"failed to create ssl object\""
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_new",
          "args": [
            "git__ssl_ctx"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_socket_stream_new",
          "args": [
            "&st->io",
            "host",
            "port"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "git_socket_stream_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "185-212",
          "snippet": "int git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_curl_stream_new",
          "args": [
            "&st->io",
            "host",
            "port"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "git_curl_stream_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "251-259",
          "snippet": "int git_curl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(host);\n\tGIT_UNUSED(port);\n\n\tgiterr_set(GITERR_NET, \"curl is not supported in this version\");\n\treturn -1;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nint git_curl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(host);\n\tGIT_UNUSED(port);\n\n\tgiterr_set(GITERR_NET, \"curl is not supported in this version\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "st"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(openssl_stream)"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nint git_openssl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tint error;\n\topenssl_stream *st;\n\n\tst = git__calloc(1, sizeof(openssl_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->io = NULL;\n#ifdef GIT_CURL\n\terror = git_curl_stream_new(&st->io, host, port);\n#else\n\terror = git_socket_stream_new(&st->io, host, port);\n#endif\n\n\tif (error < 0)\n\t\tgoto out_err;\n\n\tst->ssl = SSL_new(git__ssl_ctx);\n\tif (st->ssl == NULL) {\n\t\tgiterr_set(GITERR_SSL, \"failed to create ssl object\");\n\t\terror = -1;\n\t\tgoto out_err;\n\t}\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.encrypted = 1;\n\tst->parent.proxy_support = git_stream_supports_proxy(st->io);\n\tst->parent.connect = openssl_connect;\n\tst->parent.certificate = openssl_certificate;\n\tst->parent.set_proxy = openssl_set_proxy;\n\tst->parent.read = openssl_read;\n\tst->parent.write = openssl_write;\n\tst->parent.close = openssl_close;\n\tst->parent.free = openssl_free;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n\nout_err:\n\tgit_stream_free(st->io);\n\tgit__free(st);\n\n\treturn error;\n}"
  },
  {
    "function_name": "openssl_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "564-573",
    "snippet": "void openssl_free(git_stream *stream)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\n\tSSL_free(st->ssl);\n\tgit__free(st->host);\n\tgit__free(st->cert_info.data);\n\tgit_stream_free(st->io);\n\tgit__free(st);\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "st"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_stream_free",
          "args": [
            "st->io"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "63-69",
          "snippet": "GIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_free",
          "args": [
            "st->ssl"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nvoid openssl_free(git_stream *stream)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\n\tSSL_free(st->ssl);\n\tgit__free(st->host);\n\tgit__free(st->cert_info.data);\n\tgit_stream_free(st->io);\n\tgit__free(st);\n}"
  },
  {
    "function_name": "openssl_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "551-562",
    "snippet": "int openssl_close(git_stream *stream)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\tint ret;\n\n\tif (st->connected && (ret = ssl_teardown(st->ssl)) < 0)\n\t\treturn -1;\n\n\tst->connected = false;\n\n\treturn git_stream_close(st->io);\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_close",
          "args": [
            "st->io"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "58-61",
          "snippet": "GIT_INLINE(int) git_stream_close(git_stream *st)\n{\n\treturn st->close(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_close(git_stream *st)\n{\n\treturn st->close(st);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssl_teardown",
          "args": [
            "st->ssl"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "ssl_teardown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "292-303",
          "snippet": "static int ssl_teardown(SSL *ssl)\n{\n\tint ret;\n\n\tret = SSL_shutdown(ssl);\n\tif (ret < 0)\n\t\tret = ssl_set_error(ssl, ret);\n\telse\n\t\tret = 0;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int ssl_teardown(SSL *ssl)\n{\n\tint ret;\n\n\tret = SSL_shutdown(ssl);\n\tif (ret < 0)\n\t\tret = ssl_set_error(ssl, ret);\n\telse\n\t\tret = 0;\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nint openssl_close(git_stream *stream)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\tint ret;\n\n\tif (st->connected && (ret = ssl_teardown(st->ssl)) < 0)\n\t\treturn -1;\n\n\tst->connected = false;\n\n\treturn git_stream_close(st->io);\n}"
  },
  {
    "function_name": "openssl_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "539-549",
    "snippet": "ssize_t openssl_read(git_stream *stream, void *data, size_t len)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\tint ret;\n\n\tif ((ret = SSL_read(st->ssl, data, len)) <= 0) {\n\t\treturn ssl_set_error(st->ssl, ret);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssl_set_error",
          "args": [
            "st->ssl",
            "ret"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "ssl_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "247-290",
          "snippet": "static int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_read",
          "args": [
            "st->ssl",
            "data",
            "len"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nssize_t openssl_read(git_stream *stream, void *data, size_t len)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\tint ret;\n\n\tif ((ret = SSL_read(st->ssl, data, len)) <= 0) {\n\t\treturn ssl_set_error(st->ssl, ret);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "openssl_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "525-537",
    "snippet": "ssize_t openssl_write(git_stream *stream, const char *data, size_t len, int flags)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\tint ret;\n\n\tGIT_UNUSED(flags);\n\n\tif ((ret = SSL_write(st->ssl, data, len)) <= 0) {\n\t\treturn ssl_set_error(st->ssl, ret);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssl_set_error",
          "args": [
            "st->ssl",
            "ret"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "ssl_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "247-290",
          "snippet": "static int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_write",
          "args": [
            "st->ssl",
            "data",
            "len"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "flags"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nssize_t openssl_write(git_stream *stream, const char *data, size_t len, int flags)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\tint ret;\n\n\tGIT_UNUSED(flags);\n\n\tif ((ret = SSL_write(st->ssl, data, len)) <= 0) {\n\t\treturn ssl_set_error(st->ssl, ret);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "openssl_set_proxy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "518-523",
    "snippet": "static int openssl_set_proxy(git_stream *stream, const char *proxy_url)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\n\treturn git_stream_set_proxy(st->io, proxy_url);\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_set_proxy",
          "args": [
            "st->io",
            "proxy_url"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_set_proxy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "38-46",
          "snippet": "GIT_INLINE(int) git_stream_set_proxy(git_stream *st, const char *proxy_url)\n{\n\tif (!st->proxy_support) {\n\t\tgiterr_set(GITERR_INVALID, \"proxy not supported on this stream\");\n\t\treturn -1;\n\t}\n\n\treturn st->set_proxy(st, proxy_url);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_set_proxy(git_stream *st, const char *proxy_url)\n{\n\tif (!st->proxy_support) {\n\t\tgiterr_set(GITERR_INVALID, \"proxy not supported on this stream\");\n\t\treturn -1;\n\t}\n\n\treturn st->set_proxy(st, proxy_url);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int openssl_set_proxy(git_stream *stream, const char *proxy_url)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\n\treturn git_stream_set_proxy(st->io, proxy_url);\n}"
  },
  {
    "function_name": "openssl_certificate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "483-516",
    "snippet": "int openssl_certificate(git_cert **out, git_stream *stream)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\tint len;\n\tX509 *cert = SSL_get_peer_certificate(st->ssl);\n\tunsigned char *guard, *encoded_cert;\n\n\t/* Retrieve the length of the certificate first */\n\tlen = i2d_X509(cert, NULL);\n\tif (len < 0) {\n\t\tgiterr_set(GITERR_NET, \"failed to retrieve certificate information\");\n\t\treturn -1;\n\t}\n\n\tencoded_cert = git__malloc(len);\n\tGITERR_CHECK_ALLOC(encoded_cert);\n\t/* i2d_X509 makes 'guard' point to just after the data */\n\tguard = encoded_cert;\n\n\tlen = i2d_X509(cert, &guard);\n\tif (len < 0) {\n\t\tgit__free(encoded_cert);\n\t\tgiterr_set(GITERR_NET, \"failed to retrieve certificate information\");\n\t\treturn -1;\n\t}\n\n\tst->cert_info.parent.cert_type = GIT_CERT_X509;\n\tst->cert_info.data = encoded_cert;\n\tst->cert_info.len = len;\n\n\t*out = &st->cert_info.parent;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"failed to retrieve certificate information\""
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "encoded_cert"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "i2d_X509",
          "args": [
            "cert",
            "&guard"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "encoded_cert"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "len"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i2d_X509",
          "args": [
            "cert",
            "NULL"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_get_peer_certificate",
          "args": [
            "st->ssl"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nint openssl_certificate(git_cert **out, git_stream *stream)\n{\n\topenssl_stream *st = (openssl_stream *) stream;\n\tint len;\n\tX509 *cert = SSL_get_peer_certificate(st->ssl);\n\tunsigned char *guard, *encoded_cert;\n\n\t/* Retrieve the length of the certificate first */\n\tlen = i2d_X509(cert, NULL);\n\tif (len < 0) {\n\t\tgiterr_set(GITERR_NET, \"failed to retrieve certificate information\");\n\t\treturn -1;\n\t}\n\n\tencoded_cert = git__malloc(len);\n\tGITERR_CHECK_ALLOC(encoded_cert);\n\t/* i2d_X509 makes 'guard' point to just after the data */\n\tguard = encoded_cert;\n\n\tlen = i2d_X509(cert, &guard);\n\tif (len < 0) {\n\t\tgit__free(encoded_cert);\n\t\tgiterr_set(GITERR_NET, \"failed to retrieve certificate information\");\n\t\treturn -1;\n\t}\n\n\tst->cert_info.parent.cert_type = GIT_CERT_X509;\n\tst->cert_info.data = encoded_cert;\n\tst->cert_info.len = len;\n\n\t*out = &st->cert_info.parent;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "openssl_connect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "455-481",
    "snippet": "int openssl_connect(git_stream *stream)\n{\n\tint ret;\n\tBIO *bio;\n\topenssl_stream *st = (openssl_stream *) stream;\n\n\tif ((ret = git_stream_connect(st->io)) < 0)\n\t\treturn ret;\n\n\tst->connected = true;\n\n\tbio = BIO_new(git_stream_bio_method);\n\tGITERR_CHECK_ALLOC(bio);\n\n\tBIO_set_data(bio, st->io);\n\tSSL_set_bio(st->ssl, bio, bio);\n\n\t/* specify the host in case SNI is needed */\n#ifdef SSL_CTRL_SET_TLSEXT_HOSTNAME\n\tSSL_set_tlsext_host_name(st->ssl, st->host);\n#endif\n\n\tif ((ret = SSL_connect(st->ssl)) <= 0)\n\t\treturn ssl_set_error(st->ssl, ret);\n\n\treturn verify_server_cert(st->ssl, st->host);\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "verify_server_cert",
          "args": [
            "st->ssl",
            "st->host"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "verify_server_cert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "316-442",
          "snippet": "static int verify_server_cert(SSL *ssl, const char *host)\n{\n\tX509 *cert;\n\tX509_NAME *peer_name;\n\tASN1_STRING *str;\n\tunsigned char *peer_cn = NULL;\n\tint matched = -1, type = GEN_DNS;\n\tGENERAL_NAMES *alts;\n\tstruct in6_addr addr6;\n\tstruct in_addr addr4;\n\tvoid *addr;\n\tint i = -1,j;\n\n\tif (SSL_get_verify_result(ssl) != X509_V_OK) {\n\t\tgiterr_set(GITERR_SSL, \"The SSL certificate is invalid\");\n\t\treturn GIT_ECERTIFICATE;\n\t}\n\n\t/* Try to parse the host as an IP address to see if it is */\n\tif (p_inet_pton(AF_INET, host, &addr4)) {\n\t\ttype = GEN_IPADD;\n\t\taddr = &addr4;\n\t} else {\n\t\tif(p_inet_pton(AF_INET6, host, &addr6)) {\n\t\t\ttype = GEN_IPADD;\n\t\t\taddr = &addr6;\n\t\t}\n\t}\n\n\n\tcert = SSL_get_peer_certificate(ssl);\n\tif (!cert) {\n\t\tgiterr_set(GITERR_SSL, \"the server did not provide a certificate\");\n\t\treturn -1;\n\t}\n\n\t/* Check the alternative names */\n\talts = X509_get_ext_d2i(cert, NID_subject_alt_name, NULL, NULL);\n\tif (alts) {\n\t\tint num;\n\n\t\tnum = sk_GENERAL_NAME_num(alts);\n\t\tfor (i = 0; i < num && matched != 1; i++) {\n\t\t\tconst GENERAL_NAME *gn = sk_GENERAL_NAME_value(alts, i);\n\t\t\tconst char *name = (char *) ASN1_STRING_get0_data(gn->d.ia5);\n\t\t\tsize_t namelen = (size_t) ASN1_STRING_length(gn->d.ia5);\n\n\t\t\t/* Skip any names of a type we're not looking for */\n\t\t\tif (gn->type != type)\n\t\t\t\tcontinue;\n\n\t\t\tif (type == GEN_DNS) {\n\t\t\t\t/* If it contains embedded NULs, don't even try */\n\t\t\t\tif (memchr(name, '\\0', namelen))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (check_host_name(name, host) < 0)\n\t\t\t\t\tmatched = 0;\n\t\t\t\telse\n\t\t\t\t\tmatched = 1;\n\t\t\t} else if (type == GEN_IPADD) {\n\t\t\t\t/* Here name isn't so much a name but a binary representation of the IP */\n\t\t\t\tmatched = !!memcmp(name, addr, namelen);\n\t\t\t}\n\t\t}\n\t}\n\tGENERAL_NAMES_free(alts);\n\n\tif (matched == 0)\n\t\tgoto cert_fail_name;\n\n\tif (matched == 1)\n\t\treturn 0;\n\n\t/* If no alternative names are available, check the common name */\n\tpeer_name = X509_get_subject_name(cert);\n\tif (peer_name == NULL)\n\t\tgoto on_error;\n\n\tif (peer_name) {\n\t\t/* Get the index of the last CN entry */\n\t\twhile ((j = X509_NAME_get_index_by_NID(peer_name, NID_commonName, i)) >= 0)\n\t\t\ti = j;\n\t}\n\n\tif (i < 0)\n\t\tgoto on_error;\n\n\tstr = X509_NAME_ENTRY_get_data(X509_NAME_get_entry(peer_name, i));\n\tif (str == NULL)\n\t\tgoto on_error;\n\n\t/* Work around a bug in OpenSSL whereby ASN1_STRING_to_UTF8 fails if it's already in utf-8 */\n\tif (ASN1_STRING_type(str) == V_ASN1_UTF8STRING) {\n\t\tint size = ASN1_STRING_length(str);\n\n\t\tif (size > 0) {\n\t\t\tpeer_cn = OPENSSL_malloc(size + 1);\n\t\t\tGITERR_CHECK_ALLOC(peer_cn);\n\t\t\tmemcpy(peer_cn, ASN1_STRING_get0_data(str), size);\n\t\t\tpeer_cn[size] = '\\0';\n\t\t} else {\n\t\t\tgoto cert_fail_name;\n\t\t}\n\t} else {\n\t\tint size = ASN1_STRING_to_UTF8(&peer_cn, str);\n\t\tGITERR_CHECK_ALLOC(peer_cn);\n\t\tif (memchr(peer_cn, '\\0', size))\n\t\t\tgoto cert_fail_name;\n\t}\n\n\tif (check_host_name((char *)peer_cn, host) < 0)\n\t\tgoto cert_fail_name;\n\n\tOPENSSL_free(peer_cn);\n\n\treturn 0;\n\non_error:\n\tOPENSSL_free(peer_cn);\n\treturn ssl_set_error(ssl, 0);\n\ncert_fail_name:\n\tOPENSSL_free(peer_cn);\n\tgiterr_set(GITERR_SSL, \"hostname does not match certificate\");\n\treturn GIT_ECERTIFICATE;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int verify_server_cert(SSL *ssl, const char *host)\n{\n\tX509 *cert;\n\tX509_NAME *peer_name;\n\tASN1_STRING *str;\n\tunsigned char *peer_cn = NULL;\n\tint matched = -1, type = GEN_DNS;\n\tGENERAL_NAMES *alts;\n\tstruct in6_addr addr6;\n\tstruct in_addr addr4;\n\tvoid *addr;\n\tint i = -1,j;\n\n\tif (SSL_get_verify_result(ssl) != X509_V_OK) {\n\t\tgiterr_set(GITERR_SSL, \"The SSL certificate is invalid\");\n\t\treturn GIT_ECERTIFICATE;\n\t}\n\n\t/* Try to parse the host as an IP address to see if it is */\n\tif (p_inet_pton(AF_INET, host, &addr4)) {\n\t\ttype = GEN_IPADD;\n\t\taddr = &addr4;\n\t} else {\n\t\tif(p_inet_pton(AF_INET6, host, &addr6)) {\n\t\t\ttype = GEN_IPADD;\n\t\t\taddr = &addr6;\n\t\t}\n\t}\n\n\n\tcert = SSL_get_peer_certificate(ssl);\n\tif (!cert) {\n\t\tgiterr_set(GITERR_SSL, \"the server did not provide a certificate\");\n\t\treturn -1;\n\t}\n\n\t/* Check the alternative names */\n\talts = X509_get_ext_d2i(cert, NID_subject_alt_name, NULL, NULL);\n\tif (alts) {\n\t\tint num;\n\n\t\tnum = sk_GENERAL_NAME_num(alts);\n\t\tfor (i = 0; i < num && matched != 1; i++) {\n\t\t\tconst GENERAL_NAME *gn = sk_GENERAL_NAME_value(alts, i);\n\t\t\tconst char *name = (char *) ASN1_STRING_get0_data(gn->d.ia5);\n\t\t\tsize_t namelen = (size_t) ASN1_STRING_length(gn->d.ia5);\n\n\t\t\t/* Skip any names of a type we're not looking for */\n\t\t\tif (gn->type != type)\n\t\t\t\tcontinue;\n\n\t\t\tif (type == GEN_DNS) {\n\t\t\t\t/* If it contains embedded NULs, don't even try */\n\t\t\t\tif (memchr(name, '\\0', namelen))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (check_host_name(name, host) < 0)\n\t\t\t\t\tmatched = 0;\n\t\t\t\telse\n\t\t\t\t\tmatched = 1;\n\t\t\t} else if (type == GEN_IPADD) {\n\t\t\t\t/* Here name isn't so much a name but a binary representation of the IP */\n\t\t\t\tmatched = !!memcmp(name, addr, namelen);\n\t\t\t}\n\t\t}\n\t}\n\tGENERAL_NAMES_free(alts);\n\n\tif (matched == 0)\n\t\tgoto cert_fail_name;\n\n\tif (matched == 1)\n\t\treturn 0;\n\n\t/* If no alternative names are available, check the common name */\n\tpeer_name = X509_get_subject_name(cert);\n\tif (peer_name == NULL)\n\t\tgoto on_error;\n\n\tif (peer_name) {\n\t\t/* Get the index of the last CN entry */\n\t\twhile ((j = X509_NAME_get_index_by_NID(peer_name, NID_commonName, i)) >= 0)\n\t\t\ti = j;\n\t}\n\n\tif (i < 0)\n\t\tgoto on_error;\n\n\tstr = X509_NAME_ENTRY_get_data(X509_NAME_get_entry(peer_name, i));\n\tif (str == NULL)\n\t\tgoto on_error;\n\n\t/* Work around a bug in OpenSSL whereby ASN1_STRING_to_UTF8 fails if it's already in utf-8 */\n\tif (ASN1_STRING_type(str) == V_ASN1_UTF8STRING) {\n\t\tint size = ASN1_STRING_length(str);\n\n\t\tif (size > 0) {\n\t\t\tpeer_cn = OPENSSL_malloc(size + 1);\n\t\t\tGITERR_CHECK_ALLOC(peer_cn);\n\t\t\tmemcpy(peer_cn, ASN1_STRING_get0_data(str), size);\n\t\t\tpeer_cn[size] = '\\0';\n\t\t} else {\n\t\t\tgoto cert_fail_name;\n\t\t}\n\t} else {\n\t\tint size = ASN1_STRING_to_UTF8(&peer_cn, str);\n\t\tGITERR_CHECK_ALLOC(peer_cn);\n\t\tif (memchr(peer_cn, '\\0', size))\n\t\t\tgoto cert_fail_name;\n\t}\n\n\tif (check_host_name((char *)peer_cn, host) < 0)\n\t\tgoto cert_fail_name;\n\n\tOPENSSL_free(peer_cn);\n\n\treturn 0;\n\non_error:\n\tOPENSSL_free(peer_cn);\n\treturn ssl_set_error(ssl, 0);\n\ncert_fail_name:\n\tOPENSSL_free(peer_cn);\n\tgiterr_set(GITERR_SSL, \"hostname does not match certificate\");\n\treturn GIT_ECERTIFICATE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssl_set_error",
          "args": [
            "st->ssl",
            "ret"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "ssl_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "247-290",
          "snippet": "static int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_connect",
          "args": [
            "st->ssl"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_set_tlsext_host_name",
          "args": [
            "st->ssl",
            "st->host"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_set_bio",
          "args": [
            "st->ssl",
            "bio",
            "bio"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BIO_set_data",
          "args": [
            "bio",
            "st->io"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_set_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "104-107",
          "snippet": "GIT_INLINE(void) BIO_set_data(BIO *a, void *ptr)\n{\n\ta->ptr = ptr;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(void) BIO_set_data(BIO *a, void *ptr)\n{\n\ta->ptr = ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "bio"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BIO_new",
          "args": [
            "git_stream_bio_method"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_stream_connect",
          "args": [
            "st->io"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_connect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "13-16",
          "snippet": "GIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nint openssl_connect(git_stream *stream)\n{\n\tint ret;\n\tBIO *bio;\n\topenssl_stream *st = (openssl_stream *) stream;\n\n\tif ((ret = git_stream_connect(st->io)) < 0)\n\t\treturn ret;\n\n\tst->connected = true;\n\n\tbio = BIO_new(git_stream_bio_method);\n\tGITERR_CHECK_ALLOC(bio);\n\n\tBIO_set_data(bio, st->io);\n\tSSL_set_bio(st->ssl, bio, bio);\n\n\t/* specify the host in case SNI is needed */\n#ifdef SSL_CTRL_SET_TLSEXT_HOSTNAME\n\tSSL_set_tlsext_host_name(st->ssl, st->host);\n#endif\n\n\tif ((ret = SSL_connect(st->ssl)) <= 0)\n\t\treturn ssl_set_error(st->ssl, ret);\n\n\treturn verify_server_cert(st->ssl, st->host);\n}"
  },
  {
    "function_name": "verify_server_cert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "316-442",
    "snippet": "static int verify_server_cert(SSL *ssl, const char *host)\n{\n\tX509 *cert;\n\tX509_NAME *peer_name;\n\tASN1_STRING *str;\n\tunsigned char *peer_cn = NULL;\n\tint matched = -1, type = GEN_DNS;\n\tGENERAL_NAMES *alts;\n\tstruct in6_addr addr6;\n\tstruct in_addr addr4;\n\tvoid *addr;\n\tint i = -1,j;\n\n\tif (SSL_get_verify_result(ssl) != X509_V_OK) {\n\t\tgiterr_set(GITERR_SSL, \"The SSL certificate is invalid\");\n\t\treturn GIT_ECERTIFICATE;\n\t}\n\n\t/* Try to parse the host as an IP address to see if it is */\n\tif (p_inet_pton(AF_INET, host, &addr4)) {\n\t\ttype = GEN_IPADD;\n\t\taddr = &addr4;\n\t} else {\n\t\tif(p_inet_pton(AF_INET6, host, &addr6)) {\n\t\t\ttype = GEN_IPADD;\n\t\t\taddr = &addr6;\n\t\t}\n\t}\n\n\n\tcert = SSL_get_peer_certificate(ssl);\n\tif (!cert) {\n\t\tgiterr_set(GITERR_SSL, \"the server did not provide a certificate\");\n\t\treturn -1;\n\t}\n\n\t/* Check the alternative names */\n\talts = X509_get_ext_d2i(cert, NID_subject_alt_name, NULL, NULL);\n\tif (alts) {\n\t\tint num;\n\n\t\tnum = sk_GENERAL_NAME_num(alts);\n\t\tfor (i = 0; i < num && matched != 1; i++) {\n\t\t\tconst GENERAL_NAME *gn = sk_GENERAL_NAME_value(alts, i);\n\t\t\tconst char *name = (char *) ASN1_STRING_get0_data(gn->d.ia5);\n\t\t\tsize_t namelen = (size_t) ASN1_STRING_length(gn->d.ia5);\n\n\t\t\t/* Skip any names of a type we're not looking for */\n\t\t\tif (gn->type != type)\n\t\t\t\tcontinue;\n\n\t\t\tif (type == GEN_DNS) {\n\t\t\t\t/* If it contains embedded NULs, don't even try */\n\t\t\t\tif (memchr(name, '\\0', namelen))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (check_host_name(name, host) < 0)\n\t\t\t\t\tmatched = 0;\n\t\t\t\telse\n\t\t\t\t\tmatched = 1;\n\t\t\t} else if (type == GEN_IPADD) {\n\t\t\t\t/* Here name isn't so much a name but a binary representation of the IP */\n\t\t\t\tmatched = !!memcmp(name, addr, namelen);\n\t\t\t}\n\t\t}\n\t}\n\tGENERAL_NAMES_free(alts);\n\n\tif (matched == 0)\n\t\tgoto cert_fail_name;\n\n\tif (matched == 1)\n\t\treturn 0;\n\n\t/* If no alternative names are available, check the common name */\n\tpeer_name = X509_get_subject_name(cert);\n\tif (peer_name == NULL)\n\t\tgoto on_error;\n\n\tif (peer_name) {\n\t\t/* Get the index of the last CN entry */\n\t\twhile ((j = X509_NAME_get_index_by_NID(peer_name, NID_commonName, i)) >= 0)\n\t\t\ti = j;\n\t}\n\n\tif (i < 0)\n\t\tgoto on_error;\n\n\tstr = X509_NAME_ENTRY_get_data(X509_NAME_get_entry(peer_name, i));\n\tif (str == NULL)\n\t\tgoto on_error;\n\n\t/* Work around a bug in OpenSSL whereby ASN1_STRING_to_UTF8 fails if it's already in utf-8 */\n\tif (ASN1_STRING_type(str) == V_ASN1_UTF8STRING) {\n\t\tint size = ASN1_STRING_length(str);\n\n\t\tif (size > 0) {\n\t\t\tpeer_cn = OPENSSL_malloc(size + 1);\n\t\t\tGITERR_CHECK_ALLOC(peer_cn);\n\t\t\tmemcpy(peer_cn, ASN1_STRING_get0_data(str), size);\n\t\t\tpeer_cn[size] = '\\0';\n\t\t} else {\n\t\t\tgoto cert_fail_name;\n\t\t}\n\t} else {\n\t\tint size = ASN1_STRING_to_UTF8(&peer_cn, str);\n\t\tGITERR_CHECK_ALLOC(peer_cn);\n\t\tif (memchr(peer_cn, '\\0', size))\n\t\t\tgoto cert_fail_name;\n\t}\n\n\tif (check_host_name((char *)peer_cn, host) < 0)\n\t\tgoto cert_fail_name;\n\n\tOPENSSL_free(peer_cn);\n\n\treturn 0;\n\non_error:\n\tOPENSSL_free(peer_cn);\n\treturn ssl_set_error(ssl, 0);\n\ncert_fail_name:\n\tOPENSSL_free(peer_cn);\n\tgiterr_set(GITERR_SSL, \"hostname does not match certificate\");\n\treturn GIT_ECERTIFICATE;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_SSL",
            "\"hostname does not match certificate\""
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "OPENSSL_free",
          "args": [
            "peer_cn"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssl_set_error",
          "args": [
            "ssl",
            "0"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "ssl_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "247-290",
          "snippet": "static int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "OPENSSL_free",
          "args": [
            "peer_cn"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OPENSSL_free",
          "args": [
            "peer_cn"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_host_name",
          "args": [
            "(char *)peer_cn",
            "host"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "check_host_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "305-314",
          "snippet": "static int check_host_name(const char *name, const char *host)\n{\n\tif (!strcasecmp(name, host))\n\t\treturn 0;\n\n\tif (gitno__match_host(name, host) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int check_host_name(const char *name, const char *host)\n{\n\tif (!strcasecmp(name, host))\n\t\treturn 0;\n\n\tif (gitno__match_host(name, host) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "peer_cn",
            "'\\0'",
            "size"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "peer_cn"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASN1_STRING_to_UTF8",
          "args": [
            "&peer_cn",
            "str"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "peer_cn",
            "ASN1_STRING_get0_data(str)",
            "size"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASN1_STRING_get0_data",
          "args": [
            "str"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "ASN1_STRING_get0_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "114-117",
          "snippet": "GIT_INLINE(const unsigned char *) ASN1_STRING_get0_data(const ASN1_STRING *x)\n{\n\treturn ASN1_STRING_data((ASN1_STRING *)x);\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(const unsigned char *) ASN1_STRING_get0_data(const ASN1_STRING *x)\n{\n\treturn ASN1_STRING_data((ASN1_STRING *)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "peer_cn"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OPENSSL_malloc",
          "args": [
            "size + 1"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASN1_STRING_length",
          "args": [
            "str"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASN1_STRING_type",
          "args": [
            "str"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "X509_NAME_ENTRY_get_data",
          "args": [
            "X509_NAME_get_entry(peer_name, i)"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "X509_NAME_get_entry",
          "args": [
            "peer_name",
            "i"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "X509_NAME_get_index_by_NID",
          "args": [
            "peer_name",
            "NID_commonName",
            "i"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "X509_get_subject_name",
          "args": [
            "cert"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GENERAL_NAMES_free",
          "args": [
            "alts"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "name",
            "addr",
            "namelen"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "name",
            "'\\0'",
            "namelen"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASN1_STRING_length",
          "args": [
            "gn->d.ia5"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sk_GENERAL_NAME_value",
          "args": [
            "alts",
            "i"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sk_GENERAL_NAME_num",
          "args": [
            "alts"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "X509_get_ext_d2i",
          "args": [
            "cert",
            "NID_subject_alt_name",
            "NULL",
            "NULL"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_get_peer_certificate",
          "args": [
            "ssl"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_inet_pton",
          "args": [
            "AF_INET6",
            "host",
            "&addr6"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "p_inet_pton",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "687-723",
          "snippet": "int p_inet_pton(int af, const char *src, void *dst)\n{\n\tstruct sockaddr_storage sin;\n\tvoid *addr;\n\tint sin_len = sizeof(struct sockaddr_storage), addr_len;\n\tint error = 0;\n\n\tif (af == AF_INET) {\n\t\taddr = &((struct sockaddr_in *)&sin)->sin_addr;\n\t\taddr_len = sizeof(struct in_addr);\n\t} else if (af == AF_INET6) {\n\t\taddr = &((struct sockaddr_in6 *)&sin)->sin6_addr;\n\t\taddr_len = sizeof(struct in6_addr);\n\t} else {\n\t\terrno = EAFNOSUPPORT;\n\t\treturn -1;\n\t}\n\n\tif ((error = WSAStringToAddressA((LPSTR)src, af, NULL, (LPSOCKADDR)&sin, &sin_len)) == 0) {\n\t\tmemcpy(dst, addr, addr_len);\n\t\treturn 1;\n\t}\n\n\tswitch(WSAGetLastError()) {\n\tcase WSAEINVAL:\n\t\treturn 0;\n\tcase WSAEFAULT:\n\t\terrno = ENOSPC;\n\t\treturn -1;\n\tcase WSA_NOT_ENOUGH_MEMORY:\n\t\terrno = ENOMEM;\n\t\treturn -1;\n\t}\n\n\terrno = EINVAL;\n\treturn -1;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_inet_pton(int af, const char *src, void *dst)\n{\n\tstruct sockaddr_storage sin;\n\tvoid *addr;\n\tint sin_len = sizeof(struct sockaddr_storage), addr_len;\n\tint error = 0;\n\n\tif (af == AF_INET) {\n\t\taddr = &((struct sockaddr_in *)&sin)->sin_addr;\n\t\taddr_len = sizeof(struct in_addr);\n\t} else if (af == AF_INET6) {\n\t\taddr = &((struct sockaddr_in6 *)&sin)->sin6_addr;\n\t\taddr_len = sizeof(struct in6_addr);\n\t} else {\n\t\terrno = EAFNOSUPPORT;\n\t\treturn -1;\n\t}\n\n\tif ((error = WSAStringToAddressA((LPSTR)src, af, NULL, (LPSOCKADDR)&sin, &sin_len)) == 0) {\n\t\tmemcpy(dst, addr, addr_len);\n\t\treturn 1;\n\t}\n\n\tswitch(WSAGetLastError()) {\n\tcase WSAEINVAL:\n\t\treturn 0;\n\tcase WSAEFAULT:\n\t\terrno = ENOSPC;\n\t\treturn -1;\n\tcase WSA_NOT_ENOUGH_MEMORY:\n\t\terrno = ENOMEM;\n\t\treturn -1;\n\t}\n\n\terrno = EINVAL;\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_get_verify_result",
          "args": [
            "ssl"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int verify_server_cert(SSL *ssl, const char *host)\n{\n\tX509 *cert;\n\tX509_NAME *peer_name;\n\tASN1_STRING *str;\n\tunsigned char *peer_cn = NULL;\n\tint matched = -1, type = GEN_DNS;\n\tGENERAL_NAMES *alts;\n\tstruct in6_addr addr6;\n\tstruct in_addr addr4;\n\tvoid *addr;\n\tint i = -1,j;\n\n\tif (SSL_get_verify_result(ssl) != X509_V_OK) {\n\t\tgiterr_set(GITERR_SSL, \"The SSL certificate is invalid\");\n\t\treturn GIT_ECERTIFICATE;\n\t}\n\n\t/* Try to parse the host as an IP address to see if it is */\n\tif (p_inet_pton(AF_INET, host, &addr4)) {\n\t\ttype = GEN_IPADD;\n\t\taddr = &addr4;\n\t} else {\n\t\tif(p_inet_pton(AF_INET6, host, &addr6)) {\n\t\t\ttype = GEN_IPADD;\n\t\t\taddr = &addr6;\n\t\t}\n\t}\n\n\n\tcert = SSL_get_peer_certificate(ssl);\n\tif (!cert) {\n\t\tgiterr_set(GITERR_SSL, \"the server did not provide a certificate\");\n\t\treturn -1;\n\t}\n\n\t/* Check the alternative names */\n\talts = X509_get_ext_d2i(cert, NID_subject_alt_name, NULL, NULL);\n\tif (alts) {\n\t\tint num;\n\n\t\tnum = sk_GENERAL_NAME_num(alts);\n\t\tfor (i = 0; i < num && matched != 1; i++) {\n\t\t\tconst GENERAL_NAME *gn = sk_GENERAL_NAME_value(alts, i);\n\t\t\tconst char *name = (char *) ASN1_STRING_get0_data(gn->d.ia5);\n\t\t\tsize_t namelen = (size_t) ASN1_STRING_length(gn->d.ia5);\n\n\t\t\t/* Skip any names of a type we're not looking for */\n\t\t\tif (gn->type != type)\n\t\t\t\tcontinue;\n\n\t\t\tif (type == GEN_DNS) {\n\t\t\t\t/* If it contains embedded NULs, don't even try */\n\t\t\t\tif (memchr(name, '\\0', namelen))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (check_host_name(name, host) < 0)\n\t\t\t\t\tmatched = 0;\n\t\t\t\telse\n\t\t\t\t\tmatched = 1;\n\t\t\t} else if (type == GEN_IPADD) {\n\t\t\t\t/* Here name isn't so much a name but a binary representation of the IP */\n\t\t\t\tmatched = !!memcmp(name, addr, namelen);\n\t\t\t}\n\t\t}\n\t}\n\tGENERAL_NAMES_free(alts);\n\n\tif (matched == 0)\n\t\tgoto cert_fail_name;\n\n\tif (matched == 1)\n\t\treturn 0;\n\n\t/* If no alternative names are available, check the common name */\n\tpeer_name = X509_get_subject_name(cert);\n\tif (peer_name == NULL)\n\t\tgoto on_error;\n\n\tif (peer_name) {\n\t\t/* Get the index of the last CN entry */\n\t\twhile ((j = X509_NAME_get_index_by_NID(peer_name, NID_commonName, i)) >= 0)\n\t\t\ti = j;\n\t}\n\n\tif (i < 0)\n\t\tgoto on_error;\n\n\tstr = X509_NAME_ENTRY_get_data(X509_NAME_get_entry(peer_name, i));\n\tif (str == NULL)\n\t\tgoto on_error;\n\n\t/* Work around a bug in OpenSSL whereby ASN1_STRING_to_UTF8 fails if it's already in utf-8 */\n\tif (ASN1_STRING_type(str) == V_ASN1_UTF8STRING) {\n\t\tint size = ASN1_STRING_length(str);\n\n\t\tif (size > 0) {\n\t\t\tpeer_cn = OPENSSL_malloc(size + 1);\n\t\t\tGITERR_CHECK_ALLOC(peer_cn);\n\t\t\tmemcpy(peer_cn, ASN1_STRING_get0_data(str), size);\n\t\t\tpeer_cn[size] = '\\0';\n\t\t} else {\n\t\t\tgoto cert_fail_name;\n\t\t}\n\t} else {\n\t\tint size = ASN1_STRING_to_UTF8(&peer_cn, str);\n\t\tGITERR_CHECK_ALLOC(peer_cn);\n\t\tif (memchr(peer_cn, '\\0', size))\n\t\t\tgoto cert_fail_name;\n\t}\n\n\tif (check_host_name((char *)peer_cn, host) < 0)\n\t\tgoto cert_fail_name;\n\n\tOPENSSL_free(peer_cn);\n\n\treturn 0;\n\non_error:\n\tOPENSSL_free(peer_cn);\n\treturn ssl_set_error(ssl, 0);\n\ncert_fail_name:\n\tOPENSSL_free(peer_cn);\n\tgiterr_set(GITERR_SSL, \"hostname does not match certificate\");\n\treturn GIT_ECERTIFICATE;\n}"
  },
  {
    "function_name": "check_host_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "305-314",
    "snippet": "static int check_host_name(const char *name, const char *host)\n{\n\tif (!strcasecmp(name, host))\n\t\treturn 0;\n\n\tif (gitno__match_host(name, host) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gitno__match_host",
          "args": [
            "name",
            "host"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "gitno__match_host",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "84-120",
          "snippet": "int gitno__match_host(const char *pattern, const char *host)\n{\n\tfor (;;) {\n\t\tchar c = git__tolower(*pattern++);\n\n\t\tif (c == '\\0')\n\t\t\treturn *host ? -1 : 0;\n\n\t\tif (c == '*') {\n\t\t\tc = *pattern;\n\t\t\t/* '*' at the end matches everything left */\n\t\t\tif (c == '\\0')\n\t\t\t\treturn 0;\n\n\t/*\n\t * We've found a pattern, so move towards the next matching\n\t * char. The '.' is handled specially because wildcards aren't\n\t * allowed to cross subdomains.\n\t */\n\n\t\t\twhile(*host) {\n\t\t\t\tchar h = git__tolower(*host);\n\t\t\t\tif (c == h)\n\t\t\t\t\treturn gitno__match_host(pattern, host++);\n\t\t\t\tif (h == '.')\n\t\t\t\t\treturn gitno__match_host(pattern, host);\n\t\t\t\thost++;\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (c != git__tolower(*host++))\n\t\t\treturn -1;\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "#include \"global.h\"",
            "#include \"http_parser.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"netops.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nint gitno__match_host(const char *pattern, const char *host)\n{\n\tfor (;;) {\n\t\tchar c = git__tolower(*pattern++);\n\n\t\tif (c == '\\0')\n\t\t\treturn *host ? -1 : 0;\n\n\t\tif (c == '*') {\n\t\t\tc = *pattern;\n\t\t\t/* '*' at the end matches everything left */\n\t\t\tif (c == '\\0')\n\t\t\t\treturn 0;\n\n\t/*\n\t * We've found a pattern, so move towards the next matching\n\t * char. The '.' is handled specially because wildcards aren't\n\t * allowed to cross subdomains.\n\t */\n\n\t\t\twhile(*host) {\n\t\t\t\tchar h = git__tolower(*host);\n\t\t\t\tif (c == h)\n\t\t\t\t\treturn gitno__match_host(pattern, host++);\n\t\t\t\tif (h == '.')\n\t\t\t\t\treturn gitno__match_host(pattern, host);\n\t\t\t\thost++;\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (c != git__tolower(*host++))\n\t\t\treturn -1;\n\t}\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "name",
            "host"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcasecmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "567-570",
          "snippet": "int git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int check_host_name(const char *name, const char *host)\n{\n\tif (!strcasecmp(name, host))\n\t\treturn 0;\n\n\tif (gitno__match_host(name, host) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ssl_teardown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "292-303",
    "snippet": "static int ssl_teardown(SSL *ssl)\n{\n\tint ret;\n\n\tret = SSL_shutdown(ssl);\n\tif (ret < 0)\n\t\tret = ssl_set_error(ssl, ret);\n\telse\n\t\tret = 0;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssl_set_error",
          "args": [
            "ssl",
            "ret"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "ssl_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "247-290",
          "snippet": "static int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_shutdown",
          "args": [
            "ssl"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int ssl_teardown(SSL *ssl)\n{\n\tint ret;\n\n\tret = SSL_shutdown(ssl);\n\tif (ret < 0)\n\t\tret = ssl_set_error(ssl, ret);\n\telse\n\t\tret = 0;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ssl_set_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "247-290",
    "snippet": "static int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"SSL error: unknown error\""
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"SSL error: %s\"",
            "ERR_error_string(e, NULL)"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_error_string",
          "args": [
            "e",
            "NULL"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_get_error",
          "args": [],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_error_string",
          "args": [
            "e",
            "NULL"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_get_error",
          "args": [],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "err != SSL_ERROR_WANT_WRITE"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "err != SSL_ERROR_WANT_READ"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_get_error",
          "args": [
            "ssl",
            "error"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int ssl_set_error(SSL *ssl, int error)\n{\n\tint err;\n\tunsigned long e;\n\n\terr = SSL_get_error(ssl, error);\n\n\tassert(err != SSL_ERROR_WANT_READ);\n\tassert(err != SSL_ERROR_WANT_WRITE);\n\n\tswitch (err) {\n\tcase SSL_ERROR_WANT_CONNECT:\n\tcase SSL_ERROR_WANT_ACCEPT:\n\t\tgiterr_set(GITERR_NET, \"SSL error: connection failure\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_WANT_X509_LOOKUP:\n\t\tgiterr_set(GITERR_NET, \"SSL error: x509 error\\n\");\n\t\tbreak;\n\tcase SSL_ERROR_SYSCALL:\n\t\te = ERR_get_error();\n\t\tif (e > 0) {\n\t\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\t\tERR_error_string(e, NULL));\n\t\t\tbreak;\n\t\t} else if (error < 0) {\n\t\t\tgiterr_set(GITERR_OS, \"SSL error: syscall failure\");\n\t\t\tbreak;\n\t\t}\n\t\tgiterr_set(GITERR_NET, \"SSL error: received early EOF\");\n\t\treturn GIT_EEOF;\n\t\tbreak;\n\tcase SSL_ERROR_SSL:\n\t\te = ERR_get_error();\n\t\tgiterr_set(GITERR_NET, \"SSL error: %s\",\n\t\t\t\tERR_error_string(e, NULL));\n\t\tbreak;\n\tcase SSL_ERROR_NONE:\n\tcase SSL_ERROR_ZERO_RETURN:\n\tdefault:\n\t\tgiterr_set(GITERR_NET, \"SSL error: unknown error\");\n\t\tbreak;\n\t}\n\treturn -1;\n}"
  },
  {
    "function_name": "init_bio_method",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "230-245",
    "snippet": "static int init_bio_method(void)\n{\n\t/* Set up the BIO_METHOD we use for wrapping our own stream implementations */\n\tgit_stream_bio_method = BIO_meth_new(BIO_TYPE_SOURCE_SINK | BIO_get_new_index(), \"git_stream\");\n\tGITERR_CHECK_ALLOC(git_stream_bio_method);\n\n\tBIO_meth_set_write(git_stream_bio_method, bio_write);\n\tBIO_meth_set_read(git_stream_bio_method, bio_read);\n\tBIO_meth_set_puts(git_stream_bio_method, bio_puts);\n\tBIO_meth_set_gets(git_stream_bio_method, bio_gets);\n\tBIO_meth_set_ctrl(git_stream_bio_method, bio_ctrl);\n\tBIO_meth_set_create(git_stream_bio_method, bio_create);\n\tBIO_meth_set_destroy(git_stream_bio_method, bio_destroy);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BIO_meth_set_destroy",
          "args": [
            "git_stream_bio_method",
            "bio_destroy"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_meth_set_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "87-91",
          "snippet": "GIT_INLINE(int) BIO_meth_set_destroy(BIO_METHOD *biom, int (*destroy) (BIO *))\n{\n\tbiom->destroy = destroy;\n\treturn 1;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(int) BIO_meth_set_destroy(BIO_METHOD *biom, int (*destroy) (BIO *))\n{\n\tbiom->destroy = destroy;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_meth_set_create",
          "args": [
            "git_stream_bio_method",
            "bio_create"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_meth_set_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "81-85",
          "snippet": "GIT_INLINE(int) BIO_meth_set_create(BIO_METHOD *biom, int (*create) (BIO *))\n{\n\tbiom->create = create;\n\treturn 1;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(int) BIO_meth_set_create(BIO_METHOD *biom, int (*create) (BIO *))\n{\n\tbiom->create = create;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_meth_set_ctrl",
          "args": [
            "git_stream_bio_method",
            "bio_ctrl"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_meth_set_ctrl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "75-79",
          "snippet": "GIT_INLINE(int) BIO_meth_set_ctrl(BIO_METHOD *biom, long (*ctrl) (BIO *, int, long, void *))\n{\n\tbiom->ctrl = ctrl;\n\treturn 1;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(int) BIO_meth_set_ctrl(BIO_METHOD *biom, long (*ctrl) (BIO *, int, long, void *))\n{\n\tbiom->ctrl = ctrl;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_meth_set_gets",
          "args": [
            "git_stream_bio_method",
            "bio_gets"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_meth_set_gets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "68-73",
          "snippet": "GIT_INLINE(int) BIO_meth_set_gets(BIO_METHOD *biom, int (*gets) (BIO *, char *, int))\n\n{\n\tbiom->bgets = gets;\n\treturn 1;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(int) BIO_meth_set_gets(BIO_METHOD *biom, int (*gets) (BIO *, char *, int))\n\n{\n\tbiom->bgets = gets;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_meth_set_puts",
          "args": [
            "git_stream_bio_method",
            "bio_puts"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_meth_set_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "62-66",
          "snippet": "GIT_INLINE(int) BIO_meth_set_puts(BIO_METHOD *biom, int (*puts) (BIO *, const char *))\n{\n\tbiom->bputs = puts;\n\treturn 1;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(int) BIO_meth_set_puts(BIO_METHOD *biom, int (*puts) (BIO *, const char *))\n{\n\tbiom->bputs = puts;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_meth_set_read",
          "args": [
            "git_stream_bio_method",
            "bio_read"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_meth_set_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "56-60",
          "snippet": "GIT_INLINE(int) BIO_meth_set_read(BIO_METHOD *biom, int (*read) (BIO *, char *, int))\n{\n\tbiom->bread = read;\n\treturn 1;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(int) BIO_meth_set_read(BIO_METHOD *biom, int (*read) (BIO *, char *, int))\n{\n\tbiom->bread = read;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_meth_set_write",
          "args": [
            "git_stream_bio_method",
            "bio_write"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_meth_set_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "50-54",
          "snippet": "GIT_INLINE(int) BIO_meth_set_write(BIO_METHOD *biom, int (*write) (BIO *, const char *, int))\n{\n\tbiom->bwrite = write;\n\treturn 1;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(int) BIO_meth_set_write(BIO_METHOD *biom, int (*write) (BIO *, const char *, int))\n{\n\tbiom->bwrite = write;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "git_stream_bio_method"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BIO_meth_new",
          "args": [
            "BIO_TYPE_SOURCE_SINK | BIO_get_new_index()",
            "\"git_stream\""
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_meth_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "32-43",
          "snippet": "GIT_INLINE(BIO_METHOD*) BIO_meth_new(int type, const char *name)\n{\n\tBIO_METHOD *meth = git__calloc(1, sizeof(BIO_METHOD));\n\tif (!meth) {\n\t\treturn NULL;\n\t}\n\n\tmeth->type = type;\n\tmeth->name = name;\n\n\treturn meth;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(BIO_METHOD*) BIO_meth_new(int type, const char *name)\n{\n\tBIO_METHOD *meth = git__calloc(1, sizeof(BIO_METHOD));\n\tif (!meth) {\n\t\treturn NULL;\n\t}\n\n\tmeth->type = type;\n\tmeth->name = name;\n\n\treturn meth;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_get_new_index",
          "args": [],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_get_new_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "93-97",
          "snippet": "GIT_INLINE(int) BIO_get_new_index(void)\n{\n\t/* This exists as of 1.1 so before we'd just have 0 */\n\treturn 0;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(int) BIO_get_new_index(void)\n{\n\t/* This exists as of 1.1 so before we'd just have 0 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int init_bio_method(void)\n{\n\t/* Set up the BIO_METHOD we use for wrapping our own stream implementations */\n\tgit_stream_bio_method = BIO_meth_new(BIO_TYPE_SOURCE_SINK | BIO_get_new_index(), \"git_stream\");\n\tGITERR_CHECK_ALLOC(git_stream_bio_method);\n\n\tBIO_meth_set_write(git_stream_bio_method, bio_write);\n\tBIO_meth_set_read(git_stream_bio_method, bio_read);\n\tBIO_meth_set_puts(git_stream_bio_method, bio_puts);\n\tBIO_meth_set_gets(git_stream_bio_method, bio_gets);\n\tBIO_meth_set_ctrl(git_stream_bio_method, bio_ctrl);\n\tBIO_meth_set_create(git_stream_bio_method, bio_create);\n\tBIO_meth_set_destroy(git_stream_bio_method, bio_destroy);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "bio_puts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "225-228",
    "snippet": "static int bio_puts(BIO *b, const char *str)\n{\n\treturn bio_write(b, str, strlen(str));\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bio_write",
          "args": [
            "b",
            "str",
            "strlen(str)"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "bio_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "198-203",
          "snippet": "static int bio_write(BIO *b, const char *buf, int len)\n{\n\tgit_stream *io = (git_stream *) BIO_get_data(b);\n\n\treturn (int) git_stream_write(io, buf, len, 0);\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int bio_write(BIO *b, const char *buf, int len)\n{\n\tgit_stream *io = (git_stream *) BIO_get_data(b);\n\n\treturn (int) git_stream_write(io, buf, len, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int bio_puts(BIO *b, const char *str)\n{\n\treturn bio_write(b, str, strlen(str));\n}"
  },
  {
    "function_name": "bio_gets",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "217-223",
    "snippet": "static int bio_gets(BIO *b, char *buf, int len)\n{\n\tGIT_UNUSED(b);\n\tGIT_UNUSED(buf);\n\tGIT_UNUSED(len);\n\treturn -1;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "len"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "buf"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "b"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int bio_gets(BIO *b, char *buf, int len)\n{\n\tGIT_UNUSED(b);\n\tGIT_UNUSED(buf);\n\tGIT_UNUSED(len);\n\treturn -1;\n}"
  },
  {
    "function_name": "bio_ctrl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "205-215",
    "snippet": "static long bio_ctrl(BIO *b, int cmd, long num, void *ptr)\n{\n\tGIT_UNUSED(b);\n\tGIT_UNUSED(num);\n\tGIT_UNUSED(ptr);\n\n\tif (cmd == BIO_CTRL_FLUSH)\n\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "ptr"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "num"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "b"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic long bio_ctrl(BIO *b, int cmd, long num, void *ptr)\n{\n\tGIT_UNUSED(b);\n\tGIT_UNUSED(num);\n\tGIT_UNUSED(ptr);\n\n\tif (cmd == BIO_CTRL_FLUSH)\n\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "bio_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "198-203",
    "snippet": "static int bio_write(BIO *b, const char *buf, int len)\n{\n\tgit_stream *io = (git_stream *) BIO_get_data(b);\n\n\treturn (int) git_stream_write(io, buf, len, 0);\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_write",
          "args": [
            "io",
            "buf",
            "len",
            "0"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "53-56",
          "snippet": "GIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_get_data",
          "args": [
            "b"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_get_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "109-112",
          "snippet": "GIT_INLINE(void*) BIO_get_data(BIO *a)\n{\n\treturn a->ptr;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(void*) BIO_get_data(BIO *a)\n{\n\treturn a->ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int bio_write(BIO *b, const char *buf, int len)\n{\n\tgit_stream *io = (git_stream *) BIO_get_data(b);\n\n\treturn (int) git_stream_write(io, buf, len, 0);\n}"
  },
  {
    "function_name": "bio_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "191-196",
    "snippet": "static int bio_read(BIO *b, char *buf, int len)\n{\n\tgit_stream *io = (git_stream *) BIO_get_data(b);\n\n\treturn (int) git_stream_read(io, buf, len);\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_read",
          "args": [
            "io",
            "buf",
            "len"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "48-51",
          "snippet": "GIT_INLINE(ssize_t) git_stream_read(git_stream *st, void *data, size_t len)\n{\n\treturn st->read(st, data, len);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(ssize_t) git_stream_read(git_stream *st, void *data, size_t len)\n{\n\treturn st->read(st, data, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_get_data",
          "args": [
            "b"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_get_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "109-112",
          "snippet": "GIT_INLINE(void*) BIO_get_data(BIO *a)\n{\n\treturn a->ptr;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(void*) BIO_get_data(BIO *a)\n{\n\treturn a->ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int bio_read(BIO *b, char *buf, int len)\n{\n\tgit_stream *io = (git_stream *) BIO_get_data(b);\n\n\treturn (int) git_stream_read(io, buf, len);\n}"
  },
  {
    "function_name": "bio_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "181-189",
    "snippet": "static int bio_destroy(BIO *b)\n{\n\tif (!b)\n\t\treturn 0;\n\n\tBIO_set_data(b, NULL);\n\n\treturn 1;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BIO_set_data",
          "args": [
            "b",
            "NULL"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_set_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "104-107",
          "snippet": "GIT_INLINE(void) BIO_set_data(BIO *a, void *ptr)\n{\n\ta->ptr = ptr;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(void) BIO_set_data(BIO *a, void *ptr)\n{\n\ta->ptr = ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int bio_destroy(BIO *b)\n{\n\tif (!b)\n\t\treturn 0;\n\n\tBIO_set_data(b, NULL);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "bio_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "173-179",
    "snippet": "static int bio_create(BIO *b)\n{\n\tBIO_set_init(b, 1);\n\tBIO_set_data(b, NULL);\n\n\treturn 1;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BIO_set_data",
          "args": [
            "b",
            "NULL"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_set_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "104-107",
          "snippet": "GIT_INLINE(void) BIO_set_data(BIO *a, void *ptr)\n{\n\ta->ptr = ptr;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(void) BIO_set_data(BIO *a, void *ptr)\n{\n\ta->ptr = ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIO_set_init",
          "args": [
            "b",
            "1"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_set_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "99-102",
          "snippet": "GIT_INLINE(void) BIO_set_init(BIO *b, int init)\n{\n\tb->init = init;\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(void) BIO_set_init(BIO *b, int init)\n{\n\tb->init = init;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int bio_create(BIO *b)\n{\n\tBIO_set_init(b, 1);\n\tBIO_set_data(b, NULL);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "git_openssl_set_locking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "147-170",
    "snippet": "int git_openssl_set_locking(void)\n{\n#ifdef GIT_THREADS\n\tint num_locks, i;\n\n\tnum_locks = CRYPTO_num_locks();\n\topenssl_locks = git__calloc(num_locks, sizeof(git_mutex));\n\tGITERR_CHECK_ALLOC(openssl_locks);\n\n\tfor (i = 0; i < num_locks; i++) {\n\t\tif (git_mutex_init(&openssl_locks[i]) != 0) {\n\t\t\tgiterr_set(GITERR_SSL, \"failed to initialize openssl locks\");\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tCRYPTO_set_locking_callback(openssl_locking_function);\n\tgit__on_shutdown(shutdown_ssl_locking);\n\treturn 0;\n#else\n\tgiterr_set(GITERR_THREAD, \"libgit2 as not built with threads\");\n\treturn -1;\n#endif\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_THREAD",
            "\"libgit2 as not built with threads\""
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__on_shutdown",
          "args": [
            "shutdown_ssl_locking"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "git__on_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "32-37",
          "snippet": "void git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MAX_SHUTDOWN_CB 8"
          ],
          "globals_used": [
            "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
            "static git_atomic git__n_shutdown_callbacks;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\n#define MAX_SHUTDOWN_CB 8\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\n\nvoid git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CRYPTO_set_locking_callback",
          "args": [
            "openssl_locking_function"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_mutex_init",
          "args": [
            "&openssl_locks[i]"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "140-141",
          "snippet": "GIT_INLINE(int) git_mutex_init(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [
            "#define git_mutex unsigned int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\n#define git_mutex unsigned int\n\nGIT_INLINE(int) git_mutex_init(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "openssl_locks"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "num_locks",
            "sizeof(git_mutex)"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CRYPTO_num_locks",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nint git_openssl_set_locking(void)\n{\n#ifdef GIT_THREADS\n\tint num_locks, i;\n\n\tnum_locks = CRYPTO_num_locks();\n\topenssl_locks = git__calloc(num_locks, sizeof(git_mutex));\n\tGITERR_CHECK_ALLOC(openssl_locks);\n\n\tfor (i = 0; i < num_locks; i++) {\n\t\tif (git_mutex_init(&openssl_locks[i]) != 0) {\n\t\t\tgiterr_set(GITERR_SSL, \"failed to initialize openssl locks\");\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tCRYPTO_set_locking_callback(openssl_locking_function);\n\tgit__on_shutdown(shutdown_ssl_locking);\n\treturn 0;\n#else\n\tgiterr_set(GITERR_THREAD, \"libgit2 as not built with threads\");\n\treturn -1;\n#endif\n}"
  },
  {
    "function_name": "git_openssl_stream_global_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "95-145",
    "snippet": "int git_openssl_stream_global_init(void)\n{\n#ifdef GIT_OPENSSL\n\tlong ssl_opts = SSL_OP_NO_SSLv2 | SSL_OP_NO_SSLv3;\n\tconst char *ciphers = git_libgit2__ssl_ciphers();\n\n\t/* Older OpenSSL and MacOS OpenSSL doesn't have this */\n#ifdef SSL_OP_NO_COMPRESSION\n\tssl_opts |= SSL_OP_NO_COMPRESSION;\n#endif\n\n\tSSL_load_error_strings();\n\tOpenSSL_add_ssl_algorithms();\n\t/*\n\t * Load SSLv{2,3} and TLSv1 so that we can talk with servers\n\t * which use the SSL hellos, which are often used for\n\t * compatibility. We then disable SSL so we only allow OpenSSL\n\t * to speak TLSv1 to perform the encryption itself.\n\t */\n\tgit__ssl_ctx = SSL_CTX_new(SSLv23_method());\n\tSSL_CTX_set_options(git__ssl_ctx, ssl_opts);\n\tSSL_CTX_set_mode(git__ssl_ctx, SSL_MODE_AUTO_RETRY);\n\tSSL_CTX_set_verify(git__ssl_ctx, SSL_VERIFY_NONE, NULL);\n\tif (!SSL_CTX_set_default_verify_paths(git__ssl_ctx)) {\n\t\tSSL_CTX_free(git__ssl_ctx);\n\t\tgit__ssl_ctx = NULL;\n\t\treturn -1;\n\t}\n\n\tif (!ciphers) {\n\t\tciphers = GIT_SSL_DEFAULT_CIPHERS;\n\t}\n\n\tif(!SSL_CTX_set_cipher_list(git__ssl_ctx, ciphers)) {\n\t\tSSL_CTX_free(git__ssl_ctx);\n\t\tgit__ssl_ctx = NULL;\n\t\treturn -1;\n\t}\n\n\tif (init_bio_method() < 0) {\n\t\tSSL_CTX_free(git__ssl_ctx);\n\t\tgit__ssl_ctx = NULL;\n\t\treturn -1;\n\t}\n\n#endif\n\n\tgit__on_shutdown(shutdown_ssl);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [
      "#define GIT_SSL_DEFAULT_CIPHERS \"ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-DSS-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA:DHE-DSS-AES128-SHA256:DHE-DSS-AES256-SHA256:DHE-DSS-AES128-SHA:DHE-DSS-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__on_shutdown",
          "args": [
            "shutdown_ssl"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "git__on_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "32-37",
          "snippet": "void git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MAX_SHUTDOWN_CB 8"
          ],
          "globals_used": [
            "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
            "static git_atomic git__n_shutdown_callbacks;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\n#define MAX_SHUTDOWN_CB 8\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\n\nvoid git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_CTX_free",
          "args": [
            "git__ssl_ctx"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_bio_method",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "init_bio_method",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "230-245",
          "snippet": "static int init_bio_method(void)\n{\n\t/* Set up the BIO_METHOD we use for wrapping our own stream implementations */\n\tgit_stream_bio_method = BIO_meth_new(BIO_TYPE_SOURCE_SINK | BIO_get_new_index(), \"git_stream\");\n\tGITERR_CHECK_ALLOC(git_stream_bio_method);\n\n\tBIO_meth_set_write(git_stream_bio_method, bio_write);\n\tBIO_meth_set_read(git_stream_bio_method, bio_read);\n\tBIO_meth_set_puts(git_stream_bio_method, bio_puts);\n\tBIO_meth_set_gets(git_stream_bio_method, bio_gets);\n\tBIO_meth_set_ctrl(git_stream_bio_method, bio_ctrl);\n\tBIO_meth_set_create(git_stream_bio_method, bio_create);\n\tBIO_meth_set_destroy(git_stream_bio_method, bio_destroy);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic int init_bio_method(void)\n{\n\t/* Set up the BIO_METHOD we use for wrapping our own stream implementations */\n\tgit_stream_bio_method = BIO_meth_new(BIO_TYPE_SOURCE_SINK | BIO_get_new_index(), \"git_stream\");\n\tGITERR_CHECK_ALLOC(git_stream_bio_method);\n\n\tBIO_meth_set_write(git_stream_bio_method, bio_write);\n\tBIO_meth_set_read(git_stream_bio_method, bio_read);\n\tBIO_meth_set_puts(git_stream_bio_method, bio_puts);\n\tBIO_meth_set_gets(git_stream_bio_method, bio_gets);\n\tBIO_meth_set_ctrl(git_stream_bio_method, bio_ctrl);\n\tBIO_meth_set_create(git_stream_bio_method, bio_create);\n\tBIO_meth_set_destroy(git_stream_bio_method, bio_destroy);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_CTX_free",
          "args": [
            "git__ssl_ctx"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_CTX_set_cipher_list",
          "args": [
            "git__ssl_ctx",
            "ciphers"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_CTX_free",
          "args": [
            "git__ssl_ctx"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_CTX_set_default_verify_paths",
          "args": [
            "git__ssl_ctx"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_CTX_set_verify",
          "args": [
            "git__ssl_ctx",
            "SSL_VERIFY_NONE",
            "NULL"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_CTX_set_mode",
          "args": [
            "git__ssl_ctx",
            "SSL_MODE_AUTO_RETRY"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_CTX_set_options",
          "args": [
            "git__ssl_ctx",
            "ssl_opts"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_CTX_new",
          "args": [
            "SSLv23_method()"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSLv23_method",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OpenSSL_add_ssl_algorithms",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_load_error_strings",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_libgit2__ssl_ciphers",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "git_libgit2__ssl_ciphers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/settings.c",
          "lines": "81-84",
          "snippet": "const char *git_libgit2__ssl_ciphers()\n{\n\treturn git__ssl_ciphers;\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"global.h\"",
            "#include \"cache.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\"",
            "#include <git2.h>",
            "# include <openssl/err.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern char *git__ssl_ciphers;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"global.h\"\n#include \"cache.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n#include <git2.h>\n# include <openssl/err.h>\n\nextern char *git__ssl_ciphers;\n\nconst char *git_libgit2__ssl_ciphers()\n{\n\treturn git__ssl_ciphers;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\n#define GIT_SSL_DEFAULT_CIPHERS \"ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-DSS-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA:DHE-DSS-AES128-SHA256:DHE-DSS-AES256-SHA256:DHE-DSS-AES128-SHA:DHE-DSS-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA\"\n\nint git_openssl_stream_global_init(void)\n{\n#ifdef GIT_OPENSSL\n\tlong ssl_opts = SSL_OP_NO_SSLv2 | SSL_OP_NO_SSLv3;\n\tconst char *ciphers = git_libgit2__ssl_ciphers();\n\n\t/* Older OpenSSL and MacOS OpenSSL doesn't have this */\n#ifdef SSL_OP_NO_COMPRESSION\n\tssl_opts |= SSL_OP_NO_COMPRESSION;\n#endif\n\n\tSSL_load_error_strings();\n\tOpenSSL_add_ssl_algorithms();\n\t/*\n\t * Load SSLv{2,3} and TLSv1 so that we can talk with servers\n\t * which use the SSL hellos, which are often used for\n\t * compatibility. We then disable SSL so we only allow OpenSSL\n\t * to speak TLSv1 to perform the encryption itself.\n\t */\n\tgit__ssl_ctx = SSL_CTX_new(SSLv23_method());\n\tSSL_CTX_set_options(git__ssl_ctx, ssl_opts);\n\tSSL_CTX_set_mode(git__ssl_ctx, SSL_MODE_AUTO_RETRY);\n\tSSL_CTX_set_verify(git__ssl_ctx, SSL_VERIFY_NONE, NULL);\n\tif (!SSL_CTX_set_default_verify_paths(git__ssl_ctx)) {\n\t\tSSL_CTX_free(git__ssl_ctx);\n\t\tgit__ssl_ctx = NULL;\n\t\treturn -1;\n\t}\n\n\tif (!ciphers) {\n\t\tciphers = GIT_SSL_DEFAULT_CIPHERS;\n\t}\n\n\tif(!SSL_CTX_set_cipher_list(git__ssl_ctx, ciphers)) {\n\t\tSSL_CTX_free(git__ssl_ctx);\n\t\tgit__ssl_ctx = NULL;\n\t\treturn -1;\n\t}\n\n\tif (init_bio_method() < 0) {\n\t\tSSL_CTX_free(git__ssl_ctx);\n\t\tgit__ssl_ctx = NULL;\n\t\treturn -1;\n\t}\n\n#endif\n\n\tgit__on_shutdown(shutdown_ssl);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "shutdown_ssl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "82-93",
    "snippet": "static void shutdown_ssl(void)\n{\n\tif (git_stream_bio_method) {\n\t\tBIO_meth_free(git_stream_bio_method);\n\t\tgit_stream_bio_method = NULL;\n\t}\n\n\tif (git__ssl_ctx) {\n\t\tSSL_CTX_free(git__ssl_ctx);\n\t\tgit__ssl_ctx = NULL;\n\t}\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SSL_CTX_free",
          "args": [
            "git__ssl_ctx"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BIO_meth_free",
          "args": [
            "git_stream_bio_method"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "BIO_meth_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.h",
          "lines": "45-48",
          "snippet": "GIT_INLINE(void) BIO_meth_free(BIO_METHOD *biom)\n{\n\tgit__free(biom);\n}",
          "includes": [
            "# include <openssl/bio.h>",
            "# include <openssl/x509v3.h>",
            "# include <openssl/err.h>",
            "# include <openssl/ssl.h>",
            "#include \"git2/sys/stream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <openssl/bio.h>\n# include <openssl/x509v3.h>\n# include <openssl/err.h>\n# include <openssl/ssl.h>\n#include \"git2/sys/stream.h\"\n\nGIT_INLINE(void) BIO_meth_free(BIO_METHOD *biom)\n{\n\tgit__free(biom);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic void shutdown_ssl(void)\n{\n\tif (git_stream_bio_method) {\n\t\tBIO_meth_free(git_stream_bio_method);\n\t\tgit_stream_bio_method = NULL;\n\t}\n\n\tif (git__ssl_ctx) {\n\t\tSSL_CTX_free(git__ssl_ctx);\n\t\tgit__ssl_ctx = NULL;\n\t}\n}"
  },
  {
    "function_name": "shutdown_ssl_locking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "61-71",
    "snippet": "static void shutdown_ssl_locking(void)\n{\n\tint num_locks, i;\n\n\tnum_locks = CRYPTO_num_locks();\n\tCRYPTO_set_locking_callback(NULL);\n\n\tfor (i = 0; i < num_locks; ++i)\n\t\tgit_mutex_free(openssl_locks);\n\tgit__free(openssl_locks);\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "openssl_locks"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_mutex_free",
          "args": [
            "openssl_locks"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "104-108",
          "snippet": "int git_mutex_free(git_mutex *mutex)\n{\n\tDeleteCriticalSection(mutex);\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nint git_mutex_free(git_mutex *mutex)\n{\n\tDeleteCriticalSection(mutex);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CRYPTO_set_locking_callback",
          "args": [
            "NULL"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTO_num_locks",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic void shutdown_ssl_locking(void)\n{\n\tint num_locks, i;\n\n\tnum_locks = CRYPTO_num_locks();\n\tCRYPTO_set_locking_callback(NULL);\n\n\tfor (i = 0; i < num_locks; ++i)\n\t\tgit_mutex_free(openssl_locks);\n\tgit__free(openssl_locks);\n}"
  },
  {
    "function_name": "openssl_locking_function",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
    "lines": "44-59",
    "snippet": "static void openssl_locking_function(\n\tint mode, int n, const char *file, int line)\n{\n\tint lock;\n\n\tGIT_UNUSED(file);\n\tGIT_UNUSED(line);\n\n\tlock = mode & CRYPTO_LOCK;\n\n\tif (lock) {\n\t\tgit_mutex_lock(&openssl_locks[n]);\n\t} else {\n\t\tgit_mutex_unlock(&openssl_locks[n]);\n\t}\n}",
    "includes": [
      "#include \"git2/sys/openssl.h\"",
      "#include \"stream.h\"",
      "#include <openssl/bio.h>",
      "#include <openssl/x509v3.h>",
      "#include <openssl/err.h>",
      "#include <openssl/ssl.h>",
      "# include <netinet/in.h>",
      "# include <sys/socket.h>",
      "# include <sys/types.h>",
      "# include \"curl_stream.h\"",
      "#include \"git2/sys/openssl.h\"",
      "#include \"git2/transport.h\"",
      "#include \"netops.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_mutex_unlock",
          "args": [
            "&openssl_locks[n]"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "116-120",
          "snippet": "int git_mutex_unlock(git_mutex *mutex)\n{\n\tLeaveCriticalSection(mutex);\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nint git_mutex_unlock(git_mutex *mutex)\n{\n\tLeaveCriticalSection(mutex);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_mutex_lock",
          "args": [
            "&openssl_locks[n]"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "142-143",
          "snippet": "GIT_INLINE(int) git_mutex_lock(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [
            "#define git_mutex unsigned int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\n#define git_mutex unsigned int\n\nGIT_INLINE(int) git_mutex_lock(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "line"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "file"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nstatic void openssl_locking_function(\n\tint mode, int n, const char *file, int line)\n{\n\tint lock;\n\n\tGIT_UNUSED(file);\n\tGIT_UNUSED(line);\n\n\tlock = mode & CRYPTO_LOCK;\n\n\tif (lock) {\n\t\tgit_mutex_lock(&openssl_locks[n]);\n\t} else {\n\t\tgit_mutex_unlock(&openssl_locks[n]);\n\t}\n}"
  }
]