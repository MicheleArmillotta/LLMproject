[
  {
    "function_name": "git_iterator_ignore_case",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "248-251",
    "snippet": "GIT_INLINE(bool) git_iterator_ignore_case(git_iterator *iter)\n{\n\treturn ((iter->flags & GIT_ITERATOR_IGNORE_CASE) != 0);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_iterator_ignore_case(git_iterator *iter)\n{\n\treturn ((iter->flags & GIT_ITERATOR_IGNORE_CASE) != 0);\n}"
  },
  {
    "function_name": "git_iterator_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "243-246",
    "snippet": "GIT_INLINE(git_iterator_flag_t) git_iterator_flags(git_iterator *iter)\n{\n\treturn iter->flags;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_iterator_flag_t) git_iterator_flags(git_iterator *iter)\n{\n\treturn iter->flags;\n}"
  },
  {
    "function_name": "git_iterator_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "238-241",
    "snippet": "GIT_INLINE(git_repository *) git_iterator_owner(git_iterator *iter)\n{\n\treturn iter->repo;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_repository *) git_iterator_owner(git_iterator *iter)\n{\n\treturn iter->repo;\n}"
  },
  {
    "function_name": "git_iterator_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "233-236",
    "snippet": "GIT_INLINE(git_iterator_type_t) git_iterator_type(git_iterator *iter)\n{\n\treturn iter->type;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_iterator_type_t) git_iterator_type(git_iterator *iter)\n{\n\treturn iter->type;\n}"
  },
  {
    "function_name": "git_iterator_at_end",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "228-231",
    "snippet": "GIT_INLINE(int) git_iterator_at_end(git_iterator *iter)\n{\n\treturn iter->cb->at_end(iter);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->cb->at_end",
          "args": [
            "iter"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_at_end(git_iterator *iter)\n{\n\treturn iter->cb->at_end(iter);\n}"
  },
  {
    "function_name": "git_iterator_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "217-221",
    "snippet": "GIT_INLINE(int) git_iterator_reset(\n\tgit_iterator *iter, const char *start, const char *end)\n{\n\treturn iter->cb->reset(iter, start, end);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->cb->reset",
          "args": [
            "iter",
            "start",
            "end"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_reset(\n\tgit_iterator *iter, const char *start, const char *end)\n{\n\treturn iter->cb->reset(iter, start, end);\n}"
  },
  {
    "function_name": "git_iterator_seek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "204-208",
    "snippet": "GIT_INLINE(int) git_iterator_seek(\n\tgit_iterator *iter, const char *prefix)\n{\n\treturn iter->cb->seek(iter, prefix);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->cb->seek",
          "args": [
            "iter",
            "prefix"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_seek(\n\tgit_iterator *iter, const char *prefix)\n{\n\treturn iter->cb->seek(iter, prefix);\n}"
  },
  {
    "function_name": "git_iterator_advance_into_or_over",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "192-201",
    "snippet": "GIT_INLINE(int) git_iterator_advance_into_or_over(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\tint error = iter->cb->advance_into(entry, iter);\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = iter->cb->advance(entry, iter);\n\t}\n\treturn error;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->cb->advance",
          "args": [
            "entry",
            "iter"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->cb->advance_into",
          "args": [
            "entry",
            "iter"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_advance_into_or_over(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\tint error = iter->cb->advance_into(entry, iter);\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = iter->cb->advance(entry, iter);\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "git_iterator_advance_into",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "178-182",
    "snippet": "GIT_INLINE(int) git_iterator_advance_into(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\treturn iter->cb->advance_into(entry, iter);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->cb->advance_into",
          "args": [
            "entry",
            "iter"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_advance_into(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\treturn iter->cb->advance_into(entry, iter);\n}"
  },
  {
    "function_name": "git_iterator_advance",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "157-161",
    "snippet": "GIT_INLINE(int) git_iterator_advance(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\treturn iter->cb->advance(entry, iter);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->cb->advance",
          "args": [
            "entry",
            "iter"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_advance(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\treturn iter->cb->advance(entry, iter);\n}"
  },
  {
    "function_name": "git_iterator_current",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "144-148",
    "snippet": "GIT_INLINE(int) git_iterator_current(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\treturn iter->cb->current(entry, iter);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->cb->current",
          "args": [
            "entry",
            "iter"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_current(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\treturn iter->cb->current(entry, iter);\n}"
  },
  {
    "function_name": "git_iterator_for_workdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
    "lines": "113-121",
    "snippet": "GIT_INLINE(int) git_iterator_for_workdir(\n\tgit_iterator **out,\n\tgit_repository *repo,\n\tgit_index *index,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\treturn git_iterator_for_workdir_ext(out, repo, NULL, index, tree, options);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include \"git2/index.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_iterator_for_workdir_ext",
          "args": [
            "out",
            "repo",
            "NULL",
            "index",
            "tree",
            "options"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_for_workdir_ext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "1815-1869",
          "snippet": "int git_iterator_for_workdir_ext(\n\tgit_iterator **out,\n\tgit_repository *repo,\n\tconst char *repo_workdir,\n\tgit_index *index,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\tint error, precompose = 0;\n\tworkdir_iterator *wi;\n\n\tif (!repo_workdir) {\n\t\tif (git_repository__ensure_not_bare(repo, \"scan working directory\") < 0)\n\t\t\treturn GIT_EBAREREPO;\n\t\trepo_workdir = git_repository_workdir(repo);\n\t}\n\n\t/* initialize as an fs iterator then do overrides */\n\twi = git__calloc(1, sizeof(workdir_iterator));\n\tGITERR_CHECK_ALLOC(wi);\n\tITERATOR_BASE_INIT((&wi->fi), fs, FS, repo);\n\n\twi->fi.base.type = GIT_ITERATOR_TYPE_WORKDIR;\n\twi->fi.cb.free = workdir_iterator__free;\n\twi->fi.enter_dir_cb = workdir_iterator__enter_dir;\n\twi->fi.leave_dir_cb = workdir_iterator__leave_dir;\n\twi->fi.update_entry_cb = workdir_iterator__update_entry;\n\n\tif ((error = iterator__update_ignore_case((git_iterator *)wi, options ? options->flags : 0)) < 0 ||\n\t\t(error = git_ignore__for_path(repo, \".gitignore\", &wi->ignores)) < 0)\n\t{\n\t\tgit_iterator_free((git_iterator *)wi);\n\t\treturn error;\n\t}\n\n\tif (tree && (error = git_object_dup((git_object **)&wi->tree, (git_object *)tree)) < 0)\n\t\treturn error;\n\n\twi->index = index;\n\tif (index && (error = git_index_snapshot_new(&wi->index_snapshot, index)) < 0) {\n\t\tgit_iterator_free((git_iterator *)wi);\n\t\treturn error;\n\t}\n\twi->entry_srch = iterator__ignore_case(wi) ?\n\t\tgit_index_entry_isrch : git_index_entry_srch;\n\n\n\t/* try to look up precompose and set flag if appropriate */\n\tif (git_repository__cvar(&precompose, repo, GIT_CVAR_PRECOMPOSE) < 0)\n\t\tgiterr_clear();\n\telse if (precompose)\n\t\twi->fi.base.flags |= GIT_ITERATOR_PRECOMPOSE_UNICODE;\n\n\treturn fs_iterator__initialize(out, &wi->fi, repo_workdir);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int fs_iterator__update_entry(fs_iterator *fi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nstatic int fs_iterator__update_entry(fs_iterator *fi);\n\nint git_iterator_for_workdir_ext(\n\tgit_iterator **out,\n\tgit_repository *repo,\n\tconst char *repo_workdir,\n\tgit_index *index,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\tint error, precompose = 0;\n\tworkdir_iterator *wi;\n\n\tif (!repo_workdir) {\n\t\tif (git_repository__ensure_not_bare(repo, \"scan working directory\") < 0)\n\t\t\treturn GIT_EBAREREPO;\n\t\trepo_workdir = git_repository_workdir(repo);\n\t}\n\n\t/* initialize as an fs iterator then do overrides */\n\twi = git__calloc(1, sizeof(workdir_iterator));\n\tGITERR_CHECK_ALLOC(wi);\n\tITERATOR_BASE_INIT((&wi->fi), fs, FS, repo);\n\n\twi->fi.base.type = GIT_ITERATOR_TYPE_WORKDIR;\n\twi->fi.cb.free = workdir_iterator__free;\n\twi->fi.enter_dir_cb = workdir_iterator__enter_dir;\n\twi->fi.leave_dir_cb = workdir_iterator__leave_dir;\n\twi->fi.update_entry_cb = workdir_iterator__update_entry;\n\n\tif ((error = iterator__update_ignore_case((git_iterator *)wi, options ? options->flags : 0)) < 0 ||\n\t\t(error = git_ignore__for_path(repo, \".gitignore\", &wi->ignores)) < 0)\n\t{\n\t\tgit_iterator_free((git_iterator *)wi);\n\t\treturn error;\n\t}\n\n\tif (tree && (error = git_object_dup((git_object **)&wi->tree, (git_object *)tree)) < 0)\n\t\treturn error;\n\n\twi->index = index;\n\tif (index && (error = git_index_snapshot_new(&wi->index_snapshot, index)) < 0) {\n\t\tgit_iterator_free((git_iterator *)wi);\n\t\treturn error;\n\t}\n\twi->entry_srch = iterator__ignore_case(wi) ?\n\t\tgit_index_entry_isrch : git_index_entry_srch;\n\n\n\t/* try to look up precompose and set flag if appropriate */\n\tif (git_repository__cvar(&precompose, repo, GIT_CVAR_PRECOMPOSE) < 0)\n\t\tgiterr_clear();\n\telse if (precompose)\n\t\twi->fi.base.flags |= GIT_ITERATOR_PRECOMPOSE_UNICODE;\n\n\treturn fs_iterator__initialize(out, &wi->fi, repo_workdir);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_for_workdir(\n\tgit_iterator **out,\n\tgit_repository *repo,\n\tgit_index *index,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\treturn git_iterator_for_workdir_ext(out, repo, NULL, index, tree, options);\n}"
  }
]