[
  {
    "function_name": "p_realpath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/unix/realpath.c",
    "lines": "16-29",
    "snippet": "char *p_realpath(const char *pathname, char *resolved)\n{\n\tchar *ret;\n\tif ((ret = realpath(pathname, resolved)) == NULL)\n\t\treturn NULL;\n\n#ifdef __OpenBSD__\n\t/* The OpenBSD realpath function behaves differently,\n\t * figure out if the file exists */\n\tif (access(ret, F_OK) < 0)\n\t\tret = NULL;\n#endif\n\treturn ret;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <git2/common.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "access",
          "args": [
            "ret",
            "F_OK"
          ],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "p_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "574-582",
          "snippet": "int p_access(const char* path, mode_t mode)\n{\n\tgit_win32_path buf;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\treturn _waccess(buf, mode & WIN32_MODE_MASK);\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [
            "#define WIN32_MODE_MASK (_S_IREAD | _S_IWRITE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\n#define WIN32_MODE_MASK (_S_IREAD | _S_IWRITE)\n\nint p_access(const char* path, mode_t mode)\n{\n\tgit_win32_path buf;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\treturn _waccess(buf, mode & WIN32_MODE_MASK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "realpath",
          "args": [
            "pathname",
            "resolved"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "p_realpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/unix/realpath.c",
          "lines": "16-29",
          "snippet": "char *p_realpath(const char *pathname, char *resolved)\n{\n\tchar *ret;\n\tif ((ret = realpath(pathname, resolved)) == NULL)\n\t\treturn NULL;\n\n#ifdef __OpenBSD__\n\t/* The OpenBSD realpath function behaves differently,\n\t * figure out if the file exists */\n\tif (access(ret, F_OK) < 0)\n\t\tret = NULL;\n#endif\n\treturn ret;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <git2/common.h>\n\nchar *p_realpath(const char *pathname, char *resolved)\n{\n\tchar *ret;\n\tif ((ret = realpath(pathname, resolved)) == NULL)\n\t\treturn NULL;\n\n#ifdef __OpenBSD__\n\t/* The OpenBSD realpath function behaves differently,\n\t * figure out if the file exists */\n\tif (access(ret, F_OK) < 0)\n\t\tret = NULL;\n#endif\n\treturn ret;\n}"
  }
]