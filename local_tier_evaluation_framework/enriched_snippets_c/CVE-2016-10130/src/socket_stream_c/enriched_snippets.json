[
  {
    "function_name": "git_socket_stream_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
    "lines": "185-212",
    "snippet": "int git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}",
    "includes": [
      "#\tinclude <ws2tcpip.h>",
      "#\tinclude <winsock2.h>",
      "#       include <arpa/inet.h>",
      "#\tinclude <netinet/in.h>",
      "#\tinclude <netdb.h>",
      "#\tinclude <sys/time.h>",
      "#\tinclude <sys/select.h>",
      "#\tinclude <sys/socket.h>",
      "#\tinclude <sys/types.h>",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"netops.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "st->port"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "port"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "st->host"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "st"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_socket_stream)"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && host"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}"
  },
  {
    "function_name": "socket_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
    "lines": "176-183",
    "snippet": "void socket_free(git_stream *stream)\n{\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\n\tgit__free(st->host);\n\tgit__free(st->port);\n\tgit__free(st);\n}",
    "includes": [
      "#\tinclude <ws2tcpip.h>",
      "#\tinclude <winsock2.h>",
      "#       include <arpa/inet.h>",
      "#\tinclude <netinet/in.h>",
      "#\tinclude <netdb.h>",
      "#\tinclude <sys/time.h>",
      "#\tinclude <sys/select.h>",
      "#\tinclude <sys/socket.h>",
      "#\tinclude <sys/types.h>",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"netops.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "st"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid socket_free(git_stream *stream)\n{\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\n\tgit__free(st->host);\n\tgit__free(st->port);\n\tgit__free(st);\n}"
  },
  {
    "function_name": "socket_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
    "lines": "165-174",
    "snippet": "int socket_close(git_stream *stream)\n{\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\tint error;\n\n\terror = close_socket(st->s);\n\tst->s = INVALID_SOCKET;\n\n\treturn error;\n}",
    "includes": [
      "#\tinclude <ws2tcpip.h>",
      "#\tinclude <winsock2.h>",
      "#       include <arpa/inet.h>",
      "#\tinclude <netinet/in.h>",
      "#\tinclude <netdb.h>",
      "#\tinclude <sys/time.h>",
      "#\tinclude <sys/select.h>",
      "#\tinclude <sys/socket.h>",
      "#\tinclude <sys/types.h>",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"netops.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close_socket",
          "args": [
            "st->s"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "close_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "50-69",
          "snippet": "static int close_socket(GIT_SOCKET s)\n{\n\tif (s == INVALID_SOCKET)\n\t\treturn 0;\n\n#ifdef GIT_WIN32\n\tif (SOCKET_ERROR == closesocket(s))\n\t\treturn -1;\n\n\tif (0 != WSACleanup()) {\n\t\tgiterr_set(GITERR_OS, \"Winsock cleanup failed\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n#else\n\treturn close(s);\n#endif\n\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic int close_socket(GIT_SOCKET s)\n{\n\tif (s == INVALID_SOCKET)\n\t\treturn 0;\n\n#ifdef GIT_WIN32\n\tif (SOCKET_ERROR == closesocket(s))\n\t\treturn -1;\n\n\tif (0 != WSACleanup()) {\n\t\tgiterr_set(GITERR_OS, \"Winsock cleanup failed\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n#else\n\treturn close(s);\n#endif\n\n}"
        }
      }
    ],
    "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint socket_close(git_stream *stream)\n{\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\tint error;\n\n\terror = close_socket(st->s);\n\tst->s = INVALID_SOCKET;\n\n\treturn error;\n}"
  },
  {
    "function_name": "socket_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
    "lines": "154-163",
    "snippet": "ssize_t socket_read(git_stream *stream, void *data, size_t len)\n{\n\tssize_t ret;\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\n\tif ((ret = p_recv(st->s, data, len, 0)) < 0)\n\t\tnet_set_error(\"Error receiving socket data\");\n\n\treturn ret;\n}",
    "includes": [
      "#\tinclude <ws2tcpip.h>",
      "#\tinclude <winsock2.h>",
      "#       include <arpa/inet.h>",
      "#\tinclude <netinet/in.h>",
      "#\tinclude <netdb.h>",
      "#\tinclude <sys/time.h>",
      "#\tinclude <sys/select.h>",
      "#\tinclude <sys/socket.h>",
      "#\tinclude <sys/types.h>",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"netops.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "net_set_error",
          "args": [
            "\"Error receiving socket data\""
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "net_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "44-47",
          "snippet": "static void net_set_error(const char *str)\n{\n\tgiterr_set(GITERR_NET, \"%s: %s\", str, strerror(errno));\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic void net_set_error(const char *str)\n{\n\tgiterr_set(GITERR_NET, \"%s: %s\", str, strerror(errno));\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_recv",
          "args": [
            "st->s",
            "data",
            "len",
            "0"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "p_recv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "642-648",
          "snippet": "int p_recv(GIT_SOCKET socket, void *buffer, size_t length, int flags)\n{\n\tif ((size_t)((int)length) != length)\n\t\treturn -1; /* giterr_set will be done by caller */\n\n\treturn recv(socket, buffer, (int)length, flags);\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_recv(GIT_SOCKET socket, void *buffer, size_t length, int flags)\n{\n\tif ((size_t)((int)length) != length)\n\t\treturn -1; /* giterr_set will be done by caller */\n\n\treturn recv(socket, buffer, (int)length, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nssize_t socket_read(git_stream *stream, void *data, size_t len)\n{\n\tssize_t ret;\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\n\tif ((ret = p_recv(st->s, data, len, 0)) < 0)\n\t\tnet_set_error(\"Error receiving socket data\");\n\n\treturn ret;\n}"
  },
  {
    "function_name": "socket_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
    "lines": "134-152",
    "snippet": "ssize_t socket_write(git_stream *stream, const char *data, size_t len, int flags)\n{\n\tssize_t ret;\n\tsize_t off = 0;\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\n\twhile (off < len) {\n\t\terrno = 0;\n\t\tret = p_send(st->s, data + off, len - off, flags);\n\t\tif (ret < 0) {\n\t\t\tnet_set_error(\"Error sending data\");\n\t\t\treturn -1;\n\t\t}\n\n\t\toff += ret;\n\t}\n\n\treturn off;\n}",
    "includes": [
      "#\tinclude <ws2tcpip.h>",
      "#\tinclude <winsock2.h>",
      "#       include <arpa/inet.h>",
      "#\tinclude <netinet/in.h>",
      "#\tinclude <netdb.h>",
      "#\tinclude <sys/time.h>",
      "#\tinclude <sys/select.h>",
      "#\tinclude <sys/socket.h>",
      "#\tinclude <sys/types.h>",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"netops.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "net_set_error",
          "args": [
            "\"Error sending data\""
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "net_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "44-47",
          "snippet": "static void net_set_error(const char *str)\n{\n\tgiterr_set(GITERR_NET, \"%s: %s\", str, strerror(errno));\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic void net_set_error(const char *str)\n{\n\tgiterr_set(GITERR_NET, \"%s: %s\", str, strerror(errno));\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_send",
          "args": [
            "st->s",
            "data + off",
            "len - off",
            "flags"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "p_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "650-656",
          "snippet": "int p_send(GIT_SOCKET socket, const void *buffer, size_t length, int flags)\n{\n\tif ((size_t)((int)length) != length)\n\t\treturn -1; /* giterr_set will be done by caller */\n\n\treturn send(socket, buffer, (int)length, flags);\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_send(GIT_SOCKET socket, const void *buffer, size_t length, int flags)\n{\n\tif ((size_t)((int)length) != length)\n\t\treturn -1; /* giterr_set will be done by caller */\n\n\treturn send(socket, buffer, (int)length, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nssize_t socket_write(git_stream *stream, const char *data, size_t len, int flags)\n{\n\tssize_t ret;\n\tsize_t off = 0;\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\n\twhile (off < len) {\n\t\terrno = 0;\n\t\tret = p_send(st->s, data + off, len - off, flags);\n\t\tif (ret < 0) {\n\t\t\tnet_set_error(\"Error sending data\");\n\t\t\treturn -1;\n\t\t}\n\n\t\toff += ret;\n\t}\n\n\treturn off;\n}"
  },
  {
    "function_name": "socket_connect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
    "lines": "71-132",
    "snippet": "int socket_connect(git_stream *stream)\n{\n\tstruct addrinfo *info = NULL, *p;\n\tstruct addrinfo hints;\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\tGIT_SOCKET s = INVALID_SOCKET;\n\tint ret;\n\n#ifdef GIT_WIN32\n\t/* on win32, the WSA context needs to be initialized\n\t * before any socket calls can be performed */\n\tWSADATA wsd;\n\n\tif (WSAStartup(MAKEWORD(2,2), &wsd) != 0) {\n\t\tgiterr_set(GITERR_OS, \"Winsock init failed\");\n\t\treturn -1;\n\t}\n\n\tif (LOBYTE(wsd.wVersion) != 2 || HIBYTE(wsd.wVersion) != 2) {\n\t\tWSACleanup();\n\t\tgiterr_set(GITERR_OS, \"Winsock init failed\");\n\t\treturn -1;\n\t}\n#endif\n\n\tmemset(&hints, 0x0, sizeof(struct addrinfo));\n\thints.ai_socktype = SOCK_STREAM;\n\thints.ai_family = AF_UNSPEC;\n\n\tif ((ret = p_getaddrinfo(st->host, st->port, &hints, &info)) != 0) {\n\t\tgiterr_set(GITERR_NET,\n\t\t\t   \"Failed to resolve address for %s: %s\", st->host, p_gai_strerror(ret));\n\t\treturn -1;\n\t}\n\n\tfor (p = info; p != NULL; p = p->ai_next) {\n\t\ts = socket(p->ai_family, p->ai_socktype, p->ai_protocol);\n\n\t\tif (s == INVALID_SOCKET) {\n\t\t\tnet_set_error(\"error creating socket\");\n\t\t\tbreak;\n\t\t}\n\n\t\tif (connect(s, p->ai_addr, (socklen_t)p->ai_addrlen) == 0)\n\t\t\tbreak;\n\n\t\t/* If we can't connect, try the next one */\n\t\tclose_socket(s);\n\t\ts = INVALID_SOCKET;\n\t}\n\n\t/* Oops, we couldn't connect to any address */\n\tif (s == INVALID_SOCKET && p == NULL) {\n\t\tgiterr_set(GITERR_OS, \"Failed to connect to %s\", st->host);\n\t\tp_freeaddrinfo(info);\n\t\treturn -1;\n\t}\n\n\tst->s = s;\n\tp_freeaddrinfo(info);\n\treturn 0;\n}",
    "includes": [
      "#\tinclude <ws2tcpip.h>",
      "#\tinclude <winsock2.h>",
      "#       include <arpa/inet.h>",
      "#\tinclude <netinet/in.h>",
      "#\tinclude <netdb.h>",
      "#\tinclude <sys/time.h>",
      "#\tinclude <sys/select.h>",
      "#\tinclude <sys/socket.h>",
      "#\tinclude <sys/types.h>",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"netops.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p_freeaddrinfo",
          "args": [
            "info"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "p_freeaddrinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "81-92",
          "snippet": "void p_freeaddrinfo(struct addrinfo *info)\n{\n\tstruct addrinfo *p, *next;\n\n\tp = info;\n\n\twhile(p != NULL) {\n\t\tnext = p->ai_next;\n\t\tfree(p);\n\t\tp = next;\n\t}\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid p_freeaddrinfo(struct addrinfo *info)\n{\n\tstruct addrinfo *p, *next;\n\n\tp = info;\n\n\twhile(p != NULL) {\n\t\tnext = p->ai_next;\n\t\tfree(p);\n\t\tp = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Failed to connect to %s\"",
            "st->host"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "close_socket",
          "args": [
            "s"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "close_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "50-69",
          "snippet": "static int close_socket(GIT_SOCKET s)\n{\n\tif (s == INVALID_SOCKET)\n\t\treturn 0;\n\n#ifdef GIT_WIN32\n\tif (SOCKET_ERROR == closesocket(s))\n\t\treturn -1;\n\n\tif (0 != WSACleanup()) {\n\t\tgiterr_set(GITERR_OS, \"Winsock cleanup failed\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n#else\n\treturn close(s);\n#endif\n\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic int close_socket(GIT_SOCKET s)\n{\n\tif (s == INVALID_SOCKET)\n\t\treturn 0;\n\n#ifdef GIT_WIN32\n\tif (SOCKET_ERROR == closesocket(s))\n\t\treturn -1;\n\n\tif (0 != WSACleanup()) {\n\t\tgiterr_set(GITERR_OS, \"Winsock cleanup failed\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n#else\n\treturn close(s);\n#endif\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "s",
            "p->ai_addr",
            "(socklen_t)p->ai_addrlen"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "gitno_connection_data_from_url",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "125-198",
          "snippet": "int gitno_connection_data_from_url(\n\t\tgitno_connection_data *data,\n\t\tconst char *url,\n\t\tconst char *service_suffix)\n{\n\tint error = -1;\n\tconst char *default_port = NULL, *path_search_start = NULL;\n\tchar *original_host = NULL;\n\n\t/* service_suffix is optional */\n\tassert(data && url);\n\n\t/* Save these for comparison later */\n\toriginal_host = data->host;\n\tdata->host = NULL;\n\tgitno_connection_data_free_ptrs(data);\n\n\tif (!git__prefixcmp(url, prefix_http)) {\n\t\tpath_search_start = url + strlen(prefix_http);\n\t\tdefault_port = \"80\";\n\n\t\tif (data->use_ssl) {\n\t\t\tgiterr_set(GITERR_NET, \"Redirect from HTTPS to HTTP is not allowed\");\n\t\t\tgoto cleanup;\n\t\t}\n\t} else if (!git__prefixcmp(url, prefix_https)) {\n\t\tpath_search_start = url + strlen(prefix_https);\n\t\tdefault_port = \"443\";\n\t\tdata->use_ssl = true;\n\t} else if (url[0] == '/')\n\t\tdefault_port = data->use_ssl ? \"443\" : \"80\";\n\n\tif (!default_port) {\n\t\tgiterr_set(GITERR_NET, \"Unrecognized URL prefix\");\n\t\tgoto cleanup;\n\t}\n\n\terror = gitno_extract_url_parts(\n\t\t&data->host, &data->port, &data->path, &data->user, &data->pass,\n\t\turl, default_port);\n\n\tif (url[0] == '/') {\n\t\t/* Relative redirect; reuse original host name and port */\n\t\tpath_search_start = url;\n\t\tgit__free(data->host);\n\t\tdata->host = original_host;\n\t\toriginal_host = NULL;\n\t}\n\n\tif (!error) {\n\t\tconst char *path = strchr(path_search_start, '/');\n\t\tsize_t pathlen = strlen(path);\n\t\tsize_t suffixlen = service_suffix ? strlen(service_suffix) : 0;\n\n\t\tif (suffixlen &&\n\t\t    !memcmp(path + pathlen - suffixlen, service_suffix, suffixlen)) {\n\t\t\tgit__free(data->path);\n\t\t\tdata->path = git__strndup(path, pathlen - suffixlen);\n\t\t} else {\n\t\t\tgit__free(data->path);\n\t\t\tdata->path = git__strdup(path);\n\t\t}\n\n\t\t/* Check for errors in the resulting data */\n\t\tif (original_host && url[0] != '/' && strcmp(original_host, data->host)) {\n\t\t\tgiterr_set(GITERR_NET, \"Cross host redirect not allowed\");\n\t\t\terror = -1;\n\t\t}\n\t}\n\ncleanup:\n\tif (original_host) git__free(original_host);\n\treturn error;\n}",
          "includes": [
            "#include \"global.h\"",
            "#include \"http_parser.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"netops.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *prefix_http = \"http://\";",
            "static const char *prefix_https = \"https://\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nstatic const char *prefix_http = \"http://\";\nstatic const char *prefix_https = \"https://\";\n\nint gitno_connection_data_from_url(\n\t\tgitno_connection_data *data,\n\t\tconst char *url,\n\t\tconst char *service_suffix)\n{\n\tint error = -1;\n\tconst char *default_port = NULL, *path_search_start = NULL;\n\tchar *original_host = NULL;\n\n\t/* service_suffix is optional */\n\tassert(data && url);\n\n\t/* Save these for comparison later */\n\toriginal_host = data->host;\n\tdata->host = NULL;\n\tgitno_connection_data_free_ptrs(data);\n\n\tif (!git__prefixcmp(url, prefix_http)) {\n\t\tpath_search_start = url + strlen(prefix_http);\n\t\tdefault_port = \"80\";\n\n\t\tif (data->use_ssl) {\n\t\t\tgiterr_set(GITERR_NET, \"Redirect from HTTPS to HTTP is not allowed\");\n\t\t\tgoto cleanup;\n\t\t}\n\t} else if (!git__prefixcmp(url, prefix_https)) {\n\t\tpath_search_start = url + strlen(prefix_https);\n\t\tdefault_port = \"443\";\n\t\tdata->use_ssl = true;\n\t} else if (url[0] == '/')\n\t\tdefault_port = data->use_ssl ? \"443\" : \"80\";\n\n\tif (!default_port) {\n\t\tgiterr_set(GITERR_NET, \"Unrecognized URL prefix\");\n\t\tgoto cleanup;\n\t}\n\n\terror = gitno_extract_url_parts(\n\t\t&data->host, &data->port, &data->path, &data->user, &data->pass,\n\t\turl, default_port);\n\n\tif (url[0] == '/') {\n\t\t/* Relative redirect; reuse original host name and port */\n\t\tpath_search_start = url;\n\t\tgit__free(data->host);\n\t\tdata->host = original_host;\n\t\toriginal_host = NULL;\n\t}\n\n\tif (!error) {\n\t\tconst char *path = strchr(path_search_start, '/');\n\t\tsize_t pathlen = strlen(path);\n\t\tsize_t suffixlen = service_suffix ? strlen(service_suffix) : 0;\n\n\t\tif (suffixlen &&\n\t\t    !memcmp(path + pathlen - suffixlen, service_suffix, suffixlen)) {\n\t\t\tgit__free(data->path);\n\t\t\tdata->path = git__strndup(path, pathlen - suffixlen);\n\t\t} else {\n\t\t\tgit__free(data->path);\n\t\t\tdata->path = git__strdup(path);\n\t\t}\n\n\t\t/* Check for errors in the resulting data */\n\t\tif (original_host && url[0] != '/' && strcmp(original_host, data->host)) {\n\t\t\tgiterr_set(GITERR_NET, \"Cross host redirect not allowed\");\n\t\t\terror = -1;\n\t\t}\n\t}\n\ncleanup:\n\tif (original_host) git__free(original_host);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_set_error",
          "args": [
            "\"error creating socket\""
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "net_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "44-47",
          "snippet": "static void net_set_error(const char *str)\n{\n\tgiterr_set(GITERR_NET, \"%s: %s\", str, strerror(errno));\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic void net_set_error(const char *str)\n{\n\tgiterr_set(GITERR_NET, \"%s: %s\", str, strerror(errno));\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "p->ai_family",
            "p->ai_socktype",
            "p->ai_protocol"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "git_socket_stream_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "185-212",
          "snippet": "int git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_gai_strerror",
          "args": [
            "ret"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "p_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "94-101",
          "snippet": "const char *p_gai_strerror(int ret)\n{\n\tswitch(ret) {\n\tcase -1: return \"Out of memory\"; break;\n\tcase -2: return \"Address lookup failed\"; break;\n\tdefault: return \"Unknown error\"; break;\n\t}\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nconst char *p_gai_strerror(int ret)\n{\n\tswitch(ret) {\n\tcase -1: return \"Out of memory\"; break;\n\tcase -2: return \"Address lookup failed\"; break;\n\tdefault: return \"Unknown error\"; break;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_getaddrinfo",
          "args": [
            "st->host",
            "st->port",
            "&hints",
            "&info"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "p_getaddrinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "17-79",
          "snippet": "int p_getaddrinfo(\n\tconst char *host,\n\tconst char *port,\n\tstruct addrinfo *hints,\n\tstruct addrinfo **info)\n{\n\tstruct addrinfo *ainfo, *ai;\n\tint p = 0;\n\n\tGIT_UNUSED(hints);\n\n\tif ((ainfo = malloc(sizeof(struct addrinfo))) == NULL)\n\t\treturn -1;\n\n\tif ((ainfo->ai_hostent = gethostbyname(host)) == NULL) {\n\t\tfree(ainfo);\n\t\treturn -2;\n\t}\n\n\tainfo->ai_servent = getservbyname(port, 0);\n\n\tif (ainfo->ai_servent)\n\t\tainfo->ai_port = ainfo->ai_servent->s_port;\n\telse\n\t\tainfo->ai_port = atol(port);\n\n\tmemcpy(&ainfo->ai_addr_in.sin_addr,\n\t\t\tainfo->ai_hostent->h_addr_list[0],\n\t\t\tainfo->ai_hostent->h_length);\n\n\tainfo->ai_protocol = 0;\n\tainfo->ai_socktype = hints->ai_socktype;\n\tainfo->ai_family = ainfo->ai_hostent->h_addrtype;\n\tainfo->ai_addr_in.sin_family = ainfo->ai_family;\n\tainfo->ai_addr_in.sin_port = ainfo->ai_port;\n\tainfo->ai_addr = (struct addrinfo *)&ainfo->ai_addr_in;\n\tainfo->ai_addrlen = sizeof(struct sockaddr_in);\n\n\t*info = ainfo;\n\n\tif (ainfo->ai_hostent->h_addr_list[1] == NULL) {\n\t\tainfo->ai_next = NULL;\n\t\treturn 0;\n\t}\n\n\tai = ainfo;\n\n\tfor (p = 1; ainfo->ai_hostent->h_addr_list[p] != NULL; p++) {\n\t\tif (!(ai->ai_next = malloc(sizeof(struct addrinfo)))) {\n\t\t\tp_freeaddrinfo(ainfo);\n\t\t\treturn -1;\n\t\t}\n\t\tmemcpy(ai->ai_next, ainfo, sizeof(struct addrinfo));\n\t\tmemcpy(&ai->ai_next->ai_addr_in.sin_addr,\n\t\t\tainfo->ai_hostent->h_addr_list[p],\n\t\t\tainfo->ai_hostent->h_length);\n\t\tai->ai_next->ai_addr = (struct addrinfo *)&ai->ai_next->ai_addr_in;\n\t\tai = ai->ai_next;\n\t}\n\n\tai->ai_next = NULL;\n\treturn 0;\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_getaddrinfo(\n\tconst char *host,\n\tconst char *port,\n\tstruct addrinfo *hints,\n\tstruct addrinfo **info)\n{\n\tstruct addrinfo *ainfo, *ai;\n\tint p = 0;\n\n\tGIT_UNUSED(hints);\n\n\tif ((ainfo = malloc(sizeof(struct addrinfo))) == NULL)\n\t\treturn -1;\n\n\tif ((ainfo->ai_hostent = gethostbyname(host)) == NULL) {\n\t\tfree(ainfo);\n\t\treturn -2;\n\t}\n\n\tainfo->ai_servent = getservbyname(port, 0);\n\n\tif (ainfo->ai_servent)\n\t\tainfo->ai_port = ainfo->ai_servent->s_port;\n\telse\n\t\tainfo->ai_port = atol(port);\n\n\tmemcpy(&ainfo->ai_addr_in.sin_addr,\n\t\t\tainfo->ai_hostent->h_addr_list[0],\n\t\t\tainfo->ai_hostent->h_length);\n\n\tainfo->ai_protocol = 0;\n\tainfo->ai_socktype = hints->ai_socktype;\n\tainfo->ai_family = ainfo->ai_hostent->h_addrtype;\n\tainfo->ai_addr_in.sin_family = ainfo->ai_family;\n\tainfo->ai_addr_in.sin_port = ainfo->ai_port;\n\tainfo->ai_addr = (struct addrinfo *)&ainfo->ai_addr_in;\n\tainfo->ai_addrlen = sizeof(struct sockaddr_in);\n\n\t*info = ainfo;\n\n\tif (ainfo->ai_hostent->h_addr_list[1] == NULL) {\n\t\tainfo->ai_next = NULL;\n\t\treturn 0;\n\t}\n\n\tai = ainfo;\n\n\tfor (p = 1; ainfo->ai_hostent->h_addr_list[p] != NULL; p++) {\n\t\tif (!(ai->ai_next = malloc(sizeof(struct addrinfo)))) {\n\t\t\tp_freeaddrinfo(ainfo);\n\t\t\treturn -1;\n\t\t}\n\t\tmemcpy(ai->ai_next, ainfo, sizeof(struct addrinfo));\n\t\tmemcpy(&ai->ai_next->ai_addr_in.sin_addr,\n\t\t\tainfo->ai_hostent->h_addr_list[p],\n\t\t\tainfo->ai_hostent->h_length);\n\t\tai->ai_next->ai_addr = (struct addrinfo *)&ai->ai_next->ai_addr_in;\n\t\tai = ai->ai_next;\n\t}\n\n\tai->ai_next = NULL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&hints",
            "0x0",
            "sizeof(struct addrinfo)"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Winsock init failed\""
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WSACleanup",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HIBYTE",
          "args": [
            "wsd.wVersion"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOBYTE",
          "args": [
            "wsd.wVersion"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WSAStartup",
          "args": [
            "MAKEWORD(2,2)",
            "&wsd"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAKEWORD",
          "args": [
            "2",
            "2"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint socket_connect(git_stream *stream)\n{\n\tstruct addrinfo *info = NULL, *p;\n\tstruct addrinfo hints;\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\tGIT_SOCKET s = INVALID_SOCKET;\n\tint ret;\n\n#ifdef GIT_WIN32\n\t/* on win32, the WSA context needs to be initialized\n\t * before any socket calls can be performed */\n\tWSADATA wsd;\n\n\tif (WSAStartup(MAKEWORD(2,2), &wsd) != 0) {\n\t\tgiterr_set(GITERR_OS, \"Winsock init failed\");\n\t\treturn -1;\n\t}\n\n\tif (LOBYTE(wsd.wVersion) != 2 || HIBYTE(wsd.wVersion) != 2) {\n\t\tWSACleanup();\n\t\tgiterr_set(GITERR_OS, \"Winsock init failed\");\n\t\treturn -1;\n\t}\n#endif\n\n\tmemset(&hints, 0x0, sizeof(struct addrinfo));\n\thints.ai_socktype = SOCK_STREAM;\n\thints.ai_family = AF_UNSPEC;\n\n\tif ((ret = p_getaddrinfo(st->host, st->port, &hints, &info)) != 0) {\n\t\tgiterr_set(GITERR_NET,\n\t\t\t   \"Failed to resolve address for %s: %s\", st->host, p_gai_strerror(ret));\n\t\treturn -1;\n\t}\n\n\tfor (p = info; p != NULL; p = p->ai_next) {\n\t\ts = socket(p->ai_family, p->ai_socktype, p->ai_protocol);\n\n\t\tif (s == INVALID_SOCKET) {\n\t\t\tnet_set_error(\"error creating socket\");\n\t\t\tbreak;\n\t\t}\n\n\t\tif (connect(s, p->ai_addr, (socklen_t)p->ai_addrlen) == 0)\n\t\t\tbreak;\n\n\t\t/* If we can't connect, try the next one */\n\t\tclose_socket(s);\n\t\ts = INVALID_SOCKET;\n\t}\n\n\t/* Oops, we couldn't connect to any address */\n\tif (s == INVALID_SOCKET && p == NULL) {\n\t\tgiterr_set(GITERR_OS, \"Failed to connect to %s\", st->host);\n\t\tp_freeaddrinfo(info);\n\t\treturn -1;\n\t}\n\n\tst->s = s;\n\tp_freeaddrinfo(info);\n\treturn 0;\n}"
  },
  {
    "function_name": "close_socket",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
    "lines": "50-69",
    "snippet": "static int close_socket(GIT_SOCKET s)\n{\n\tif (s == INVALID_SOCKET)\n\t\treturn 0;\n\n#ifdef GIT_WIN32\n\tif (SOCKET_ERROR == closesocket(s))\n\t\treturn -1;\n\n\tif (0 != WSACleanup()) {\n\t\tgiterr_set(GITERR_OS, \"Winsock cleanup failed\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n#else\n\treturn close(s);\n#endif\n\n}",
    "includes": [
      "#\tinclude <ws2tcpip.h>",
      "#\tinclude <winsock2.h>",
      "#       include <arpa/inet.h>",
      "#\tinclude <netinet/in.h>",
      "#\tinclude <netdb.h>",
      "#\tinclude <sys/time.h>",
      "#\tinclude <sys/select.h>",
      "#\tinclude <sys/socket.h>",
      "#\tinclude <sys/types.h>",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"netops.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "s"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "socket_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "165-174",
          "snippet": "int socket_close(git_stream *stream)\n{\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\tint error;\n\n\terror = close_socket(st->s);\n\tst->s = INVALID_SOCKET;\n\n\treturn error;\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint socket_close(git_stream *stream)\n{\n\tgit_socket_stream *st = (git_socket_stream *) stream;\n\tint error;\n\n\terror = close_socket(st->s);\n\tst->s = INVALID_SOCKET;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Winsock cleanup failed\""
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WSACleanup",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "closesocket",
          "args": [
            "s"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic int close_socket(GIT_SOCKET s)\n{\n\tif (s == INVALID_SOCKET)\n\t\treturn 0;\n\n#ifdef GIT_WIN32\n\tif (SOCKET_ERROR == closesocket(s))\n\t\treturn -1;\n\n\tif (0 != WSACleanup()) {\n\t\tgiterr_set(GITERR_OS, \"Winsock cleanup failed\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n#else\n\treturn close(s);\n#endif\n\n}"
  },
  {
    "function_name": "net_set_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
    "lines": "44-47",
    "snippet": "static void net_set_error(const char *str)\n{\n\tgiterr_set(GITERR_NET, \"%s: %s\", str, strerror(errno));\n}",
    "includes": [
      "#\tinclude <ws2tcpip.h>",
      "#\tinclude <winsock2.h>",
      "#       include <arpa/inet.h>",
      "#\tinclude <netinet/in.h>",
      "#\tinclude <netdb.h>",
      "#\tinclude <sys/time.h>",
      "#\tinclude <sys/select.h>",
      "#\tinclude <sys/socket.h>",
      "#\tinclude <sys/types.h>",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"netops.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"%s: %s\"",
            "str",
            "strerror(errno)"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "p_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "94-101",
          "snippet": "const char *p_gai_strerror(int ret)\n{\n\tswitch(ret) {\n\tcase -1: return \"Out of memory\"; break;\n\tcase -2: return \"Address lookup failed\"; break;\n\tdefault: return \"Unknown error\"; break;\n\t}\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nconst char *p_gai_strerror(int ret)\n{\n\tswitch(ret) {\n\tcase -1: return \"Out of memory\"; break;\n\tcase -2: return \"Address lookup failed\"; break;\n\tdefault: return \"Unknown error\"; break;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic void net_set_error(const char *str)\n{\n\tgiterr_set(GITERR_NET, \"%s: %s\", str, strerror(errno));\n}"
  },
  {
    "function_name": "net_set_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
    "lines": "31-42",
    "snippet": "static void net_set_error(const char *str)\n{\n\tint error = WSAGetLastError();\n\tchar * win32_error = git_win32_get_error_message(error);\n\n\tif (win32_error) {\n\t\tgiterr_set(GITERR_NET, \"%s: %s\", str, win32_error);\n\t\tgit__free(win32_error);\n\t} else {\n\t\tgiterr_set(GITERR_NET, str);\n\t}\n}",
    "includes": [
      "#\tinclude <ws2tcpip.h>",
      "#\tinclude <winsock2.h>",
      "#       include <arpa/inet.h>",
      "#\tinclude <netinet/in.h>",
      "#\tinclude <netdb.h>",
      "#\tinclude <sys/time.h>",
      "#\tinclude <sys/select.h>",
      "#\tinclude <sys/socket.h>",
      "#\tinclude <sys/types.h>",
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"netops.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "str"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "win32_error"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"%s: %s\"",
            "str",
            "win32_error"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32_get_error_message",
          "args": [
            "error"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32_get_error_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/error.c",
          "lines": "16-53",
          "snippet": "char *git_win32_get_error_message(DWORD error_code)\n{\n\tLPWSTR lpMsgBuf = NULL;\n\tHMODULE hModule = NULL;\n\tchar *utf8_msg = NULL;\n\tDWORD dwFlags =\n\t\tFORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_IGNORE_INSERTS;\n\n\tif (!error_code)\n\t\treturn NULL;\n\n#ifdef GIT_WINHTTP\n\t/* Errors raised by WinHTTP are not in the system resource table */\n\tif (error_code >= WINHTTP_ERROR_BASE &&\n\t\terror_code <= WINHTTP_ERROR_LAST)\n\t\thModule = GetModuleHandleW(L\"winhttp\");\n#endif\n\n\tGIT_UNUSED(hModule);\n\n\tif (hModule)\n\t\tdwFlags |= FORMAT_MESSAGE_FROM_HMODULE;\n\telse\n\t\tdwFlags |= FORMAT_MESSAGE_FROM_SYSTEM;\n\n\tif (FormatMessageW(dwFlags, hModule, error_code,\n\t\tMAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),\n\t\t(LPWSTR)&lpMsgBuf, 0, NULL)) {\n\t\t/* Convert the message to UTF-8. If this fails, we will\n\t\t * return NULL, which is a condition expected by the caller */\n\t\tif (git__utf16_to_8_alloc(&utf8_msg, lpMsgBuf) < 0)\n\t\t\tutf8_msg = NULL;\n\n\t\tLocalFree(lpMsgBuf);\n\t}\n\n\treturn utf8_msg;\n}",
          "includes": [
            "# include <winhttp.h>",
            "#include \"utf-conv.h\"",
            "#include \"error.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <winhttp.h>\n#include \"utf-conv.h\"\n#include \"error.h\"\n#include \"common.h\"\n\nchar *git_win32_get_error_message(DWORD error_code)\n{\n\tLPWSTR lpMsgBuf = NULL;\n\tHMODULE hModule = NULL;\n\tchar *utf8_msg = NULL;\n\tDWORD dwFlags =\n\t\tFORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_IGNORE_INSERTS;\n\n\tif (!error_code)\n\t\treturn NULL;\n\n#ifdef GIT_WINHTTP\n\t/* Errors raised by WinHTTP are not in the system resource table */\n\tif (error_code >= WINHTTP_ERROR_BASE &&\n\t\terror_code <= WINHTTP_ERROR_LAST)\n\t\thModule = GetModuleHandleW(L\"winhttp\");\n#endif\n\n\tGIT_UNUSED(hModule);\n\n\tif (hModule)\n\t\tdwFlags |= FORMAT_MESSAGE_FROM_HMODULE;\n\telse\n\t\tdwFlags |= FORMAT_MESSAGE_FROM_SYSTEM;\n\n\tif (FormatMessageW(dwFlags, hModule, error_code,\n\t\tMAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),\n\t\t(LPWSTR)&lpMsgBuf, 0, NULL)) {\n\t\t/* Convert the message to UTF-8. If this fails, we will\n\t\t * return NULL, which is a condition expected by the caller */\n\t\tif (git__utf16_to_8_alloc(&utf8_msg, lpMsgBuf) < 0)\n\t\t\tutf8_msg = NULL;\n\n\t\tLocalFree(lpMsgBuf);\n\t}\n\n\treturn utf8_msg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WSAGetLastError",
          "args": [],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic void net_set_error(const char *str)\n{\n\tint error = WSAGetLastError();\n\tchar * win32_error = git_win32_get_error_message(error);\n\n\tif (win32_error) {\n\t\tgiterr_set(GITERR_NET, \"%s: %s\", str, win32_error);\n\t\tgit__free(win32_error);\n\t} else {\n\t\tgiterr_set(GITERR_NET, str);\n\t}\n}"
  }
]