[
  {
    "function_name": "git_pathspec_match_list_failed_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "714-720",
    "snippet": "const char * git_pathspec_match_list_failed_entry(\n\tconst git_pathspec_match_list *m, size_t pos)\n{\n\tchar **entry = m ? git_array_get(m->failures, pos) : NULL;\n\n\treturn entry ? *entry : NULL;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "m->failures",
            "pos"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nconst char * git_pathspec_match_list_failed_entry(\n\tconst git_pathspec_match_list *m, size_t pos)\n{\n\tchar **entry = m ? git_array_get(m->failures, pos) : NULL;\n\n\treturn entry ? *entry : NULL;\n}"
  },
  {
    "function_name": "git_pathspec_match_list_failed_entrycount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "708-712",
    "snippet": "size_t git_pathspec_match_list_failed_entrycount(\n\tconst git_pathspec_match_list *m)\n{\n\treturn m ? git_array_size(m->failures) : 0;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "m->failures"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nsize_t git_pathspec_match_list_failed_entrycount(\n\tconst git_pathspec_match_list *m)\n{\n\treturn m ? git_array_size(m->failures) : 0;\n}"
  },
  {
    "function_name": "git_pathspec_match_list_diff_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "698-706",
    "snippet": "const git_diff_delta *git_pathspec_match_list_diff_entry(\n\tconst git_pathspec_match_list *m, size_t pos)\n{\n\tif (!m || m->datatype != PATHSPEC_DATATYPE_DIFF ||\n\t\t!git_array_valid_index(m->matches, pos))\n\t\treturn NULL;\n\n\treturn *((const git_diff_delta **)git_array_get(m->matches, pos));\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "m->matches",
            "pos"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_valid_index",
          "args": [
            "m->matches",
            "pos"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nconst git_diff_delta *git_pathspec_match_list_diff_entry(\n\tconst git_pathspec_match_list *m, size_t pos)\n{\n\tif (!m || m->datatype != PATHSPEC_DATATYPE_DIFF ||\n\t\t!git_array_valid_index(m->matches, pos))\n\t\treturn NULL;\n\n\treturn *((const git_diff_delta **)git_array_get(m->matches, pos));\n}"
  },
  {
    "function_name": "git_pathspec_match_list_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "688-696",
    "snippet": "const char *git_pathspec_match_list_entry(\n\tconst git_pathspec_match_list *m, size_t pos)\n{\n\tif (!m || m->datatype != PATHSPEC_DATATYPE_STRINGS ||\n\t\t!git_array_valid_index(m->matches, pos))\n\t\treturn NULL;\n\n\treturn *((const char **)git_array_get(m->matches, pos));\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "m->matches",
            "pos"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_valid_index",
          "args": [
            "m->matches",
            "pos"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nconst char *git_pathspec_match_list_entry(\n\tconst git_pathspec_match_list *m, size_t pos)\n{\n\tif (!m || m->datatype != PATHSPEC_DATATYPE_STRINGS ||\n\t\t!git_array_valid_index(m->matches, pos))\n\t\treturn NULL;\n\n\treturn *((const char **)git_array_get(m->matches, pos));\n}"
  },
  {
    "function_name": "git_pathspec_match_list_entrycount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "682-686",
    "snippet": "size_t git_pathspec_match_list_entrycount(\n\tconst git_pathspec_match_list *m)\n{\n\treturn m ? git_array_size(m->matches) : 0;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "m->matches"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nsize_t git_pathspec_match_list_entrycount(\n\tconst git_pathspec_match_list *m)\n{\n\treturn m ? git_array_size(m->matches) : 0;\n}"
  },
  {
    "function_name": "git_pathspec_match_list_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "676-680",
    "snippet": "void git_pathspec_match_list_free(git_pathspec_match_list *m)\n{\n\tif (m)\n\t\tpathspec_match_free(m);\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pathspec_match_free",
          "args": [
            "m"
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "297-309",
          "snippet": "static void pathspec_match_free(git_pathspec_match_list *m)\n{\n\tif (!m)\n\t\treturn;\n\n\tgit_pathspec_free(m->pathspec);\n\tm->pathspec = NULL;\n\n\tgit_array_clear(m->matches);\n\tgit_array_clear(m->failures);\n\tgit_pool_clear(&m->pool);\n\tgit__free(m);\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic void pathspec_match_free(git_pathspec_match_list *m)\n{\n\tif (!m)\n\t\treturn;\n\n\tgit_pathspec_free(m->pathspec);\n\tm->pathspec = NULL;\n\n\tgit_array_clear(m->matches);\n\tgit_array_clear(m->failures);\n\tgit_pool_clear(&m->pool);\n\tgit__free(m);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nvoid git_pathspec_match_list_free(git_pathspec_match_list *m)\n{\n\tif (m)\n\t\tpathspec_match_free(m);\n}"
  },
  {
    "function_name": "git_pathspec_match_diff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "583-674",
    "snippet": "int git_pathspec_match_diff(\n\tgit_pathspec_match_list **out,\n\tgit_diff *diff,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t i, pos, used_ct = 0, found_deltas = 0;\n\tconst git_diff_delta *delta, **match;\n\tgit_bitvec used_patterns;\n\n\tassert(diff);\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_DIFF);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_diff_is_sorted_icase(diff));\n\n\tgit_vector_foreach(&diff->deltas, i, delta) {\n\t\t/* search for match with delta */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, delta->old_file.path, delta->new_file.path);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result)\n\t\t\tcontinue;\n\n\t\t++found_deltas;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1,\n\t\t\t\tdelta->old_file.path, delta->new_file.path);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched delta into matches array */\n\t\tif (!(match = (const git_diff_delta **)git_array_alloc(m->matches))) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t} else {\n\t\t\t*match = delta;\n\t\t}\n\t}\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_deltas) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching deltas were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pathspec_match_free",
          "args": [
            "m"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "297-309",
          "snippet": "static void pathspec_match_free(git_pathspec_match_list *m)\n{\n\tif (!m)\n\t\treturn;\n\n\tgit_pathspec_free(m->pathspec);\n\tm->pathspec = NULL;\n\n\tgit_array_clear(m->matches);\n\tgit_array_clear(m->failures);\n\tgit_pool_clear(&m->pool);\n\tgit__free(m);\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic void pathspec_match_free(git_pathspec_match_list *m)\n{\n\tif (!m)\n\t\treturn;\n\n\tgit_pathspec_free(m->pathspec);\n\tm->pathspec = NULL;\n\n\tgit_array_clear(m->matches);\n\tgit_array_clear(m->failures);\n\tgit_pool_clear(&m->pool);\n\tgit__free(m);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_bitvec_free",
          "args": [
            "&used_patterns"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "git_bitvec_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
          "lines": "69-73",
          "snippet": "GIT_INLINE(void) git_bitvec_free(git_bitvec *bv)\n{\n\tif (bv->length)\n\t\tgit__free(bv->u.words);\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void) git_bitvec_free(git_bitvec *bv)\n{\n\tif (bv->length)\n\t\tgit__free(bv->u.words);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"No matching deltas were found\""
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_build_failure_array",
          "args": [
            "&m->failures",
            "patterns",
            "&used_patterns",
            "&m->pool"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_build_failure_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "369-393",
          "snippet": "static int pathspec_build_failure_array(\n\tgit_pathspec_string_array_t *failures,\n\tgit_vector *patterns,\n\tgit_bitvec *used,\n\tgit_pool *pool)\n{\n\tsize_t pos;\n\tchar **failed;\n\tconst git_attr_fnmatch *pat;\n\n\tfor (pos = 0; pos < patterns->length; ++pos) {\n\t\tif (git_bitvec_get(used, pos))\n\t\t\tcontinue;\n\n\t\tif ((failed = git_array_alloc(*failures)) == NULL)\n\t\t\treturn -1;\n\n\t\tpat = git_vector_get(patterns, pos);\n\n\t\tif ((*failed = git_pool_strdup(pool, pat->pattern)) == NULL)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_build_failure_array(\n\tgit_pathspec_string_array_t *failures,\n\tgit_vector *patterns,\n\tgit_bitvec *used,\n\tgit_pool *pool)\n{\n\tsize_t pos;\n\tchar **failed;\n\tconst git_attr_fnmatch *pat;\n\n\tfor (pos = 0; pos < patterns->length; ++pos) {\n\t\tif (git_bitvec_get(used, pos))\n\t\t\tcontinue;\n\n\t\tif ((failed = git_array_alloc(*failures)) == NULL)\n\t\t\treturn -1;\n\n\t\tpat = git_vector_get(patterns, pos);\n\n\t\tif ((*failed = git_pool_strdup(pool, pat->pattern)) == NULL)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "m->matches"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathspec_mark_remaining",
          "args": [
            "&used_patterns",
            "patterns",
            "&ctxt",
            "pos + 1",
            "delta->old_file.path",
            "delta->new_file.path"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_mark_remaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "341-367",
          "snippet": "static size_t pathspec_mark_remaining(\n\tgit_bitvec *used,\n\tgit_vector *patterns,\n\tstruct pathspec_match_context *ctxt,\n\tsize_t start,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tsize_t count = 0;\n\n\tif (path1 == path0)\n\t\tpath1 = NULL;\n\n\tfor (; start < patterns->length; ++start) {\n\t\tconst git_attr_fnmatch *pat = git_vector_get(patterns, start);\n\n\t\tif (git_bitvec_get(used, start))\n\t\t\tcontinue;\n\n\t\tif (path0 && pathspec_match_one(pat, ctxt, path0) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t\telse if (path1 && pathspec_match_one(pat, ctxt, path1) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t}\n\n\treturn count;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic size_t pathspec_mark_remaining(\n\tgit_bitvec *used,\n\tgit_vector *patterns,\n\tstruct pathspec_match_context *ctxt,\n\tsize_t start,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tsize_t count = 0;\n\n\tif (path1 == path0)\n\t\tpath1 = NULL;\n\n\tfor (; start < patterns->length; ++start) {\n\t\tconst git_attr_fnmatch *pat = git_vector_get(patterns, start);\n\n\t\tif (git_bitvec_get(used, start))\n\t\t\tcontinue;\n\n\t\tif (path0 && pathspec_match_one(pat, ctxt, path0) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t\telse if (path1 && pathspec_match_one(pat, ctxt, path1) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t}\n\n\treturn count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_mark_pattern",
          "args": [
            "&used_patterns",
            "pos"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_mark_pattern",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "331-339",
          "snippet": "GIT_INLINE(size_t) pathspec_mark_pattern(git_bitvec *used, size_t pos)\n{\n\tif (!git_bitvec_get(used, pos)) {\n\t\tgit_bitvec_set(used, pos, true);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nGIT_INLINE(size_t) pathspec_mark_pattern(git_bitvec *used, size_t pos)\n{\n\tif (!git_bitvec_get(used, pos)) {\n\t\tgit_bitvec_set(used, pos, true);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pathspec__match_at",
          "args": [
            "&pos",
            "patterns",
            "&ctxt",
            "delta->old_file.path",
            "delta->new_file.path"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec__match_at",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "173-193",
          "snippet": "static int git_pathspec__match_at(\n\tsize_t *matched_at,\n\tconst git_vector *vspec,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tint result = GIT_ENOTFOUND;\n\tsize_t i = 0;\n\tconst git_attr_fnmatch *match;\n\n\tgit_vector_foreach(vspec, i, match) {\n\t\tif (path0 && (result = pathspec_match_one(match, ctxt, path0)) >= 0)\n\t\t\tbreak;\n\t\tif (path1 && (result = pathspec_match_one(match, ctxt, path1)) >= 0)\n\t\t\tbreak;\n\t}\n\n\t*matched_at = i;\n\treturn result;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int git_pathspec__match_at(\n\tsize_t *matched_at,\n\tconst git_vector *vspec,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tint result = GIT_ENOTFOUND;\n\tsize_t i = 0;\n\tconst git_attr_fnmatch *match;\n\n\tgit_vector_foreach(vspec, i, match) {\n\t\tif (path0 && (result = pathspec_match_one(match, ctxt, path0)) >= 0)\n\t\t\tbreak;\n\t\tif (path1 && (result = pathspec_match_one(match, ctxt, path1)) >= 0)\n\t\t\tbreak;\n\t}\n\n\t*matched_at = i;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&diff->deltas",
            "i",
            "delta"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathspec_match_context_init",
          "args": [
            "&ctxt",
            "(flags & GIT_PATHSPEC_NO_GLOB) != 0",
            "git_diff_is_sorted_icase(diff)"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_context_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "117-136",
          "snippet": "static void pathspec_match_context_init(\n\tstruct pathspec_match_context *ctxt,\n\tbool disable_fnmatch,\n\tbool casefold)\n{\n\tif (disable_fnmatch)\n\t\tctxt->fnmatch_flags = -1;\n\telse if (casefold)\n\t\tctxt->fnmatch_flags = FNM_CASEFOLD;\n\telse\n\t\tctxt->fnmatch_flags = 0;\n\n\tif (casefold) {\n\t\tctxt->strcomp  = git__strcasecmp;\n\t\tctxt->strncomp = git__strncasecmp;\n\t} else {\n\t\tctxt->strcomp  = git__strcmp;\n\t\tctxt->strncomp = git__strncmp;\n\t}\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic void pathspec_match_context_init(\n\tstruct pathspec_match_context *ctxt,\n\tbool disable_fnmatch,\n\tbool casefold)\n{\n\tif (disable_fnmatch)\n\t\tctxt->fnmatch_flags = -1;\n\telse if (casefold)\n\t\tctxt->fnmatch_flags = FNM_CASEFOLD;\n\telse\n\t\tctxt->fnmatch_flags = 0;\n\n\tif (casefold) {\n\t\tctxt->strcomp  = git__strcasecmp;\n\t\tctxt->strncomp = git__strncasecmp;\n\t} else {\n\t\tctxt->strcomp  = git__strcmp;\n\t\tctxt->strncomp = git__strncmp;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_is_sorted_icase",
          "args": [
            "diff"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_is_sorted_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "1512-1515",
          "snippet": "int git_diff_is_sorted_icase(const git_diff *diff)\n{\n\treturn (diff->opts.flags & GIT_DIFF_IGNORE_CASE) != 0;\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_diff_is_sorted_icase(const git_diff *diff)\n{\n\treturn (diff->opts.flags & GIT_DIFF_IGNORE_CASE) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "m"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathspec_match_alloc",
          "args": [
            "ps",
            "PATHSPEC_DATATYPE_DIFF"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "311-329",
          "snippet": "static git_pathspec_match_list *pathspec_match_alloc(\n\tgit_pathspec *ps, int datatype)\n{\n\tgit_pathspec_match_list *m = git__calloc(1, sizeof(git_pathspec_match_list));\n\tif (!m)\n\t\treturn NULL;\n\n\tgit_pool_init(&m->pool, 1);\n\n\t/* need to keep reference to pathspec and increment refcount because\n\t * failures array stores pointers to the pattern strings of the\n\t * pathspec that had no matches\n\t */\n\tGIT_REFCOUNT_INC(ps);\n\tm->pathspec = ps;\n\tm->datatype = datatype;\n\n\treturn m;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic git_pathspec_match_list *pathspec_match_alloc(\n\tgit_pathspec *ps, int datatype)\n{\n\tgit_pathspec_match_list *m = git__calloc(1, sizeof(git_pathspec_match_list));\n\tif (!m)\n\t\treturn NULL;\n\n\tgit_pool_init(&m->pool, 1);\n\n\t/* need to keep reference to pathspec and increment refcount because\n\t * failures array stores pointers to the pattern strings of the\n\t * pathspec that had no matches\n\t */\n\tGIT_REFCOUNT_INC(ps);\n\tm->pathspec = ps;\n\tm->datatype = datatype;\n\n\treturn m;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_bitvec_init",
          "args": [
            "&used_patterns",
            "patterns->length"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "git_bitvec_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
          "lines": "27-39",
          "snippet": "GIT_INLINE(int) git_bitvec_init(git_bitvec *bv, size_t capacity)\n{\n\tmemset(bv, 0x0, sizeof(*bv));\n\n\tif (capacity >= 64) {\n\t\tbv->length = (capacity / 64) + 1;\n\t\tbv->u.words = git__calloc(bv->length, sizeof(uint64_t));\n\t\tif (!bv->u.words)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(int) git_bitvec_init(git_bitvec *bv, size_t capacity)\n{\n\tmemset(bv, 0x0, sizeof(*bv));\n\n\tif (capacity >= 64) {\n\t\tbv->length = (capacity / 64) + 1;\n\t\tbv->u.words = git__calloc(bv->length, sizeof(uint64_t));\n\t\tif (!bv->u.words)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "diff"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec_match_diff(\n\tgit_pathspec_match_list **out,\n\tgit_diff *diff,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t i, pos, used_ct = 0, found_deltas = 0;\n\tconst git_diff_delta *delta, **match;\n\tgit_bitvec used_patterns;\n\n\tassert(diff);\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_DIFF);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_diff_is_sorted_icase(diff));\n\n\tgit_vector_foreach(&diff->deltas, i, delta) {\n\t\t/* search for match with delta */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, delta->old_file.path, delta->new_file.path);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result)\n\t\t\tcontinue;\n\n\t\t++found_deltas;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1,\n\t\t\t\tdelta->old_file.path, delta->new_file.path);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched delta into matches array */\n\t\tif (!(match = (const git_diff_delta **)git_array_alloc(m->matches))) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t} else {\n\t\t\t*match = delta;\n\t\t}\n\t}\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_deltas) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching deltas were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_pathspec_match_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "561-581",
    "snippet": "int git_pathspec_match_tree(\n\tgit_pathspec_match_list **out,\n\tgit_tree *tree,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tgit_iterator *iter;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error = 0;\n\n\tassert(tree);\n\n\titer_opts.flags = pathspec_match_iter_flags(flags);\n\n\tif (!(error = git_iterator_for_tree(&iter, tree, &iter_opts))) {\n\t\terror = pathspec_match_from_iterator(out, iter, flags, ps);\n\t\tgit_iterator_free(iter);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_iterator_free",
          "args": [
            "iter"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "1871-1885",
          "snippet": "void git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nvoid git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_match_from_iterator",
          "args": [
            "out",
            "iter",
            "flags",
            "ps"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_from_iterator",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "395-503",
          "snippet": "static int pathspec_match_from_iterator(\n\tgit_pathspec_match_list **out,\n\tgit_iterator *iter,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tconst git_index_entry *entry = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t pos, used_ct = 0, found_files = 0;\n\tgit_index *index = NULL;\n\tgit_bitvec used_patterns;\n\tchar **file;\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_STRINGS);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tif ((error = git_iterator_reset(iter, ps->prefix, ps->prefix)) < 0)\n\t\tgoto done;\n\n\tif (git_iterator_type(iter) == GIT_ITERATOR_TYPE_WORKDIR &&\n\t\t(error = git_repository_index__weakptr(\n\t\t\t&index, git_iterator_owner(iter))) < 0)\n\t\tgoto done;\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_iterator_ignore_case(iter));\n\n\twhile (!(error = git_iterator_advance(&entry, iter))) {\n\t\t/* search for match with entry->path */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, entry->path, NULL);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result) {\n\t\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check if path is ignored and untracked */\n\t\tif (index != NULL &&\n\t\t\tgit_iterator_current_is_ignored(iter) &&\n\t\t\tgit_index__find_pos(NULL, index, entry->path, 0, GIT_INDEX_STAGE_ANY) < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t++found_files;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1, entry->path, NULL);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched path into matches array */\n\t\tif ((file = (char **)git_array_alloc(m->matches)) == NULL ||\n\t\t\t(*file = git_pool_strdup(&m->pool, entry->path)) == NULL) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\tgoto done;\n\terror = 0;\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_files) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching files were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_match_from_iterator(\n\tgit_pathspec_match_list **out,\n\tgit_iterator *iter,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tconst git_index_entry *entry = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t pos, used_ct = 0, found_files = 0;\n\tgit_index *index = NULL;\n\tgit_bitvec used_patterns;\n\tchar **file;\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_STRINGS);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tif ((error = git_iterator_reset(iter, ps->prefix, ps->prefix)) < 0)\n\t\tgoto done;\n\n\tif (git_iterator_type(iter) == GIT_ITERATOR_TYPE_WORKDIR &&\n\t\t(error = git_repository_index__weakptr(\n\t\t\t&index, git_iterator_owner(iter))) < 0)\n\t\tgoto done;\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_iterator_ignore_case(iter));\n\n\twhile (!(error = git_iterator_advance(&entry, iter))) {\n\t\t/* search for match with entry->path */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, entry->path, NULL);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result) {\n\t\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check if path is ignored and untracked */\n\t\tif (index != NULL &&\n\t\t\tgit_iterator_current_is_ignored(iter) &&\n\t\t\tgit_index__find_pos(NULL, index, entry->path, 0, GIT_INDEX_STAGE_ANY) < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t++found_files;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1, entry->path, NULL);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched path into matches array */\n\t\tif ((file = (char **)git_array_alloc(m->matches)) == NULL ||\n\t\t\t(*file = git_pool_strdup(&m->pool, entry->path)) == NULL) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\tgoto done;\n\terror = 0;\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_files) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching files were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_for_tree",
          "args": [
            "&iter",
            "tree",
            "&iter_opts"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_for_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "809-843",
          "snippet": "int git_iterator_for_tree(\n\tgit_iterator **iter,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\tint error;\n\ttree_iterator *ti;\n\n\tif (tree == NULL)\n\t\treturn git_iterator_for_nothing(iter, options);\n\n\tif ((error = git_object_dup((git_object **)&tree, (git_object *)tree)) < 0)\n\t\treturn error;\n\n\tti = git__calloc(1, sizeof(tree_iterator));\n\tGITERR_CHECK_ALLOC(ti);\n\n\tITERATOR_BASE_INIT(ti, tree, TREE, git_tree_owner(tree));\n\n\tif ((error = iterator__update_ignore_case((git_iterator *)ti, options ? options->flags : 0)) < 0)\n\t\tgoto fail;\n\n\tgit_pool_init(&ti->pool, sizeof(tree_iterator_entry));\n\n\tif ((error = tree_iterator__create_root_frame(ti, tree)) < 0 ||\n\t\t(error = tree_iterator__push_frame(ti)) < 0) /* expand root now */\n\t\tgoto fail;\n\n\t*iter = (git_iterator *)ti;\n\treturn 0;\n\nfail:\n\tgit_iterator_free((git_iterator *)ti);\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nint git_iterator_for_tree(\n\tgit_iterator **iter,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\tint error;\n\ttree_iterator *ti;\n\n\tif (tree == NULL)\n\t\treturn git_iterator_for_nothing(iter, options);\n\n\tif ((error = git_object_dup((git_object **)&tree, (git_object *)tree)) < 0)\n\t\treturn error;\n\n\tti = git__calloc(1, sizeof(tree_iterator));\n\tGITERR_CHECK_ALLOC(ti);\n\n\tITERATOR_BASE_INIT(ti, tree, TREE, git_tree_owner(tree));\n\n\tif ((error = iterator__update_ignore_case((git_iterator *)ti, options ? options->flags : 0)) < 0)\n\t\tgoto fail;\n\n\tgit_pool_init(&ti->pool, sizeof(tree_iterator_entry));\n\n\tif ((error = tree_iterator__create_root_frame(ti, tree)) < 0 ||\n\t\t(error = tree_iterator__push_frame(ti)) < 0) /* expand root now */\n\t\tgoto fail;\n\n\t*iter = (git_iterator *)ti;\n\treturn 0;\n\nfail:\n\tgit_iterator_free((git_iterator *)ti);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_match_iter_flags",
          "args": [
            "flags"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_iter_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "505-515",
          "snippet": "static git_iterator_flag_t pathspec_match_iter_flags(uint32_t flags)\n{\n\tgit_iterator_flag_t f = 0;\n\n\tif ((flags & GIT_PATHSPEC_IGNORE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_IGNORE_CASE;\n\telse if ((flags & GIT_PATHSPEC_USE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\treturn f;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic git_iterator_flag_t pathspec_match_iter_flags(uint32_t flags)\n{\n\tgit_iterator_flag_t f = 0;\n\n\tif ((flags & GIT_PATHSPEC_IGNORE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_IGNORE_CASE;\n\telse if ((flags & GIT_PATHSPEC_USE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\treturn f;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "tree"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec_match_tree(\n\tgit_pathspec_match_list **out,\n\tgit_tree *tree,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tgit_iterator *iter;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error = 0;\n\n\tassert(tree);\n\n\titer_opts.flags = pathspec_match_iter_flags(flags);\n\n\tif (!(error = git_iterator_for_tree(&iter, tree, &iter_opts))) {\n\t\terror = pathspec_match_from_iterator(out, iter, flags, ps);\n\t\tgit_iterator_free(iter);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_pathspec_match_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "539-559",
    "snippet": "int git_pathspec_match_index(\n\tgit_pathspec_match_list **out,\n\tgit_index *index,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tgit_iterator *iter;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error = 0;\n\n\tassert(index);\n\n\titer_opts.flags = pathspec_match_iter_flags(flags);\n\n\tif (!(error = git_iterator_for_index(&iter, git_index_owner(index), index, &iter_opts))) {\n\t\terror = pathspec_match_from_iterator(out, iter, flags, ps);\n\t\tgit_iterator_free(iter);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_iterator_free",
          "args": [
            "iter"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "1871-1885",
          "snippet": "void git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nvoid git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_match_from_iterator",
          "args": [
            "out",
            "iter",
            "flags",
            "ps"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_from_iterator",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "395-503",
          "snippet": "static int pathspec_match_from_iterator(\n\tgit_pathspec_match_list **out,\n\tgit_iterator *iter,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tconst git_index_entry *entry = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t pos, used_ct = 0, found_files = 0;\n\tgit_index *index = NULL;\n\tgit_bitvec used_patterns;\n\tchar **file;\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_STRINGS);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tif ((error = git_iterator_reset(iter, ps->prefix, ps->prefix)) < 0)\n\t\tgoto done;\n\n\tif (git_iterator_type(iter) == GIT_ITERATOR_TYPE_WORKDIR &&\n\t\t(error = git_repository_index__weakptr(\n\t\t\t&index, git_iterator_owner(iter))) < 0)\n\t\tgoto done;\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_iterator_ignore_case(iter));\n\n\twhile (!(error = git_iterator_advance(&entry, iter))) {\n\t\t/* search for match with entry->path */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, entry->path, NULL);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result) {\n\t\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check if path is ignored and untracked */\n\t\tif (index != NULL &&\n\t\t\tgit_iterator_current_is_ignored(iter) &&\n\t\t\tgit_index__find_pos(NULL, index, entry->path, 0, GIT_INDEX_STAGE_ANY) < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t++found_files;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1, entry->path, NULL);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched path into matches array */\n\t\tif ((file = (char **)git_array_alloc(m->matches)) == NULL ||\n\t\t\t(*file = git_pool_strdup(&m->pool, entry->path)) == NULL) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\tgoto done;\n\terror = 0;\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_files) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching files were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_match_from_iterator(\n\tgit_pathspec_match_list **out,\n\tgit_iterator *iter,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tconst git_index_entry *entry = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t pos, used_ct = 0, found_files = 0;\n\tgit_index *index = NULL;\n\tgit_bitvec used_patterns;\n\tchar **file;\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_STRINGS);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tif ((error = git_iterator_reset(iter, ps->prefix, ps->prefix)) < 0)\n\t\tgoto done;\n\n\tif (git_iterator_type(iter) == GIT_ITERATOR_TYPE_WORKDIR &&\n\t\t(error = git_repository_index__weakptr(\n\t\t\t&index, git_iterator_owner(iter))) < 0)\n\t\tgoto done;\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_iterator_ignore_case(iter));\n\n\twhile (!(error = git_iterator_advance(&entry, iter))) {\n\t\t/* search for match with entry->path */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, entry->path, NULL);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result) {\n\t\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check if path is ignored and untracked */\n\t\tif (index != NULL &&\n\t\t\tgit_iterator_current_is_ignored(iter) &&\n\t\t\tgit_index__find_pos(NULL, index, entry->path, 0, GIT_INDEX_STAGE_ANY) < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t++found_files;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1, entry->path, NULL);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched path into matches array */\n\t\tif ((file = (char **)git_array_alloc(m->matches)) == NULL ||\n\t\t\t(*file = git_pool_strdup(&m->pool, entry->path)) == NULL) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\tgoto done;\n\terror = 0;\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_files) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching files were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_for_index",
          "args": [
            "&iter",
            "git_index_owner(index)",
            "index",
            "&iter_opts"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_for_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "1087-1124",
          "snippet": "int git_iterator_for_index(\n\tgit_iterator **iter,\n\tgit_repository *repo,\n\tgit_index  *index,\n\tgit_iterator_options *options)\n{\n\tint error = 0;\n\tindex_iterator *ii = git__calloc(1, sizeof(index_iterator));\n\tGITERR_CHECK_ALLOC(ii);\n\n\tif ((error = git_index_snapshot_new(&ii->entries, index)) < 0) {\n\t\tgit__free(ii);\n\t\treturn error;\n\t}\n\tii->index = index;\n\n\tITERATOR_BASE_INIT(ii, index, INDEX, repo);\n\n\tif ((error = iterator__update_ignore_case((git_iterator *)ii, options ? options->flags : 0)) < 0) {\n\t\tgit_iterator_free((git_iterator *)ii);\n\t\treturn error;\n\t}\n\n\tii->entry_srch = iterator__ignore_case(ii) ?\n\t\tgit_index_entry_isrch : git_index_entry_srch;\n\n\tgit_vector_set_cmp(&ii->entries, iterator__ignore_case(ii) ?\n\t\tgit_index_entry_icmp : git_index_entry_cmp);\n\tgit_vector_sort(&ii->entries);\n\n\tgit_buf_init(&ii->partial, 0);\n\tii->tree_entry.mode = GIT_FILEMODE_TREE;\n\n\tindex_iterator__reset((git_iterator *)ii, NULL, NULL);\n\n\t*iter = (git_iterator *)ii;\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nint git_iterator_for_index(\n\tgit_iterator **iter,\n\tgit_repository *repo,\n\tgit_index  *index,\n\tgit_iterator_options *options)\n{\n\tint error = 0;\n\tindex_iterator *ii = git__calloc(1, sizeof(index_iterator));\n\tGITERR_CHECK_ALLOC(ii);\n\n\tif ((error = git_index_snapshot_new(&ii->entries, index)) < 0) {\n\t\tgit__free(ii);\n\t\treturn error;\n\t}\n\tii->index = index;\n\n\tITERATOR_BASE_INIT(ii, index, INDEX, repo);\n\n\tif ((error = iterator__update_ignore_case((git_iterator *)ii, options ? options->flags : 0)) < 0) {\n\t\tgit_iterator_free((git_iterator *)ii);\n\t\treturn error;\n\t}\n\n\tii->entry_srch = iterator__ignore_case(ii) ?\n\t\tgit_index_entry_isrch : git_index_entry_srch;\n\n\tgit_vector_set_cmp(&ii->entries, iterator__ignore_case(ii) ?\n\t\tgit_index_entry_icmp : git_index_entry_cmp);\n\tgit_vector_sort(&ii->entries);\n\n\tgit_buf_init(&ii->partial, 0);\n\tii->tree_entry.mode = GIT_FILEMODE_TREE;\n\n\tindex_iterator__reset((git_iterator *)ii, NULL, NULL);\n\n\t*iter = (git_iterator *)ii;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_owner",
          "args": [
            "index"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "3064-3067",
          "snippet": "git_repository *git_index_owner(const git_index *index)\n{\n\treturn INDEX_OWNER(index);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\ngit_repository *git_index_owner(const git_index *index)\n{\n\treturn INDEX_OWNER(index);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_match_iter_flags",
          "args": [
            "flags"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_iter_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "505-515",
          "snippet": "static git_iterator_flag_t pathspec_match_iter_flags(uint32_t flags)\n{\n\tgit_iterator_flag_t f = 0;\n\n\tif ((flags & GIT_PATHSPEC_IGNORE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_IGNORE_CASE;\n\telse if ((flags & GIT_PATHSPEC_USE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\treturn f;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic git_iterator_flag_t pathspec_match_iter_flags(uint32_t flags)\n{\n\tgit_iterator_flag_t f = 0;\n\n\tif ((flags & GIT_PATHSPEC_IGNORE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_IGNORE_CASE;\n\telse if ((flags & GIT_PATHSPEC_USE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\treturn f;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "index"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec_match_index(\n\tgit_pathspec_match_list **out,\n\tgit_index *index,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tgit_iterator *iter;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error = 0;\n\n\tassert(index);\n\n\titer_opts.flags = pathspec_match_iter_flags(flags);\n\n\tif (!(error = git_iterator_for_index(&iter, git_index_owner(index), index, &iter_opts))) {\n\t\terror = pathspec_match_from_iterator(out, iter, flags, ps);\n\t\tgit_iterator_free(iter);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_pathspec_match_workdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "517-537",
    "snippet": "int git_pathspec_match_workdir(\n\tgit_pathspec_match_list **out,\n\tgit_repository *repo,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tgit_iterator *iter;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error = 0;\n\n\tassert(repo);\n\n\titer_opts.flags = pathspec_match_iter_flags(flags);\n\n\tif (!(error = git_iterator_for_workdir(&iter, repo, NULL, NULL, &iter_opts))) {\n\t\terror = pathspec_match_from_iterator(out, iter, flags, ps);\n\t\tgit_iterator_free(iter);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_iterator_free",
          "args": [
            "iter"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "1871-1885",
          "snippet": "void git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nvoid git_iterator_free(git_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->cb->free(iter);\n\n\tgit_vector_free(&iter->pathlist);\n\tgit__free(iter->start);\n\tgit__free(iter->end);\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tgit__free(iter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_match_from_iterator",
          "args": [
            "out",
            "iter",
            "flags",
            "ps"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_from_iterator",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "395-503",
          "snippet": "static int pathspec_match_from_iterator(\n\tgit_pathspec_match_list **out,\n\tgit_iterator *iter,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tconst git_index_entry *entry = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t pos, used_ct = 0, found_files = 0;\n\tgit_index *index = NULL;\n\tgit_bitvec used_patterns;\n\tchar **file;\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_STRINGS);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tif ((error = git_iterator_reset(iter, ps->prefix, ps->prefix)) < 0)\n\t\tgoto done;\n\n\tif (git_iterator_type(iter) == GIT_ITERATOR_TYPE_WORKDIR &&\n\t\t(error = git_repository_index__weakptr(\n\t\t\t&index, git_iterator_owner(iter))) < 0)\n\t\tgoto done;\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_iterator_ignore_case(iter));\n\n\twhile (!(error = git_iterator_advance(&entry, iter))) {\n\t\t/* search for match with entry->path */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, entry->path, NULL);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result) {\n\t\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check if path is ignored and untracked */\n\t\tif (index != NULL &&\n\t\t\tgit_iterator_current_is_ignored(iter) &&\n\t\t\tgit_index__find_pos(NULL, index, entry->path, 0, GIT_INDEX_STAGE_ANY) < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t++found_files;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1, entry->path, NULL);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched path into matches array */\n\t\tif ((file = (char **)git_array_alloc(m->matches)) == NULL ||\n\t\t\t(*file = git_pool_strdup(&m->pool, entry->path)) == NULL) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\tgoto done;\n\terror = 0;\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_files) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching files were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_match_from_iterator(\n\tgit_pathspec_match_list **out,\n\tgit_iterator *iter,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tconst git_index_entry *entry = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t pos, used_ct = 0, found_files = 0;\n\tgit_index *index = NULL;\n\tgit_bitvec used_patterns;\n\tchar **file;\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_STRINGS);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tif ((error = git_iterator_reset(iter, ps->prefix, ps->prefix)) < 0)\n\t\tgoto done;\n\n\tif (git_iterator_type(iter) == GIT_ITERATOR_TYPE_WORKDIR &&\n\t\t(error = git_repository_index__weakptr(\n\t\t\t&index, git_iterator_owner(iter))) < 0)\n\t\tgoto done;\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_iterator_ignore_case(iter));\n\n\twhile (!(error = git_iterator_advance(&entry, iter))) {\n\t\t/* search for match with entry->path */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, entry->path, NULL);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result) {\n\t\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check if path is ignored and untracked */\n\t\tif (index != NULL &&\n\t\t\tgit_iterator_current_is_ignored(iter) &&\n\t\t\tgit_index__find_pos(NULL, index, entry->path, 0, GIT_INDEX_STAGE_ANY) < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t++found_files;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1, entry->path, NULL);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched path into matches array */\n\t\tif ((file = (char **)git_array_alloc(m->matches)) == NULL ||\n\t\t\t(*file = git_pool_strdup(&m->pool, entry->path)) == NULL) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\tgoto done;\n\terror = 0;\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_files) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching files were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_for_workdir",
          "args": [
            "&iter",
            "repo",
            "NULL",
            "NULL",
            "&iter_opts"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_for_workdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
          "lines": "113-121",
          "snippet": "GIT_INLINE(int) git_iterator_for_workdir(\n\tgit_iterator **out,\n\tgit_repository *repo,\n\tgit_index *index,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\treturn git_iterator_for_workdir_ext(out, repo, NULL, index, tree, options);\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"buffer.h\"",
            "#include \"vector.h\"",
            "#include \"git2/index.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_for_workdir(\n\tgit_iterator **out,\n\tgit_repository *repo,\n\tgit_index *index,\n\tgit_tree *tree,\n\tgit_iterator_options *options)\n{\n\treturn git_iterator_for_workdir_ext(out, repo, NULL, index, tree, options);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_match_iter_flags",
          "args": [
            "flags"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_iter_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "505-515",
          "snippet": "static git_iterator_flag_t pathspec_match_iter_flags(uint32_t flags)\n{\n\tgit_iterator_flag_t f = 0;\n\n\tif ((flags & GIT_PATHSPEC_IGNORE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_IGNORE_CASE;\n\telse if ((flags & GIT_PATHSPEC_USE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\treturn f;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic git_iterator_flag_t pathspec_match_iter_flags(uint32_t flags)\n{\n\tgit_iterator_flag_t f = 0;\n\n\tif ((flags & GIT_PATHSPEC_IGNORE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_IGNORE_CASE;\n\telse if ((flags & GIT_PATHSPEC_USE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\treturn f;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec_match_workdir(\n\tgit_pathspec_match_list **out,\n\tgit_repository *repo,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tgit_iterator *iter;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error = 0;\n\n\tassert(repo);\n\n\titer_opts.flags = pathspec_match_iter_flags(flags);\n\n\tif (!(error = git_iterator_for_workdir(&iter, repo, NULL, NULL, &iter_opts))) {\n\t\terror = pathspec_match_from_iterator(out, iter, flags, ps);\n\t\tgit_iterator_free(iter);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "pathspec_match_iter_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "505-515",
    "snippet": "static git_iterator_flag_t pathspec_match_iter_flags(uint32_t flags)\n{\n\tgit_iterator_flag_t f = 0;\n\n\tif ((flags & GIT_PATHSPEC_IGNORE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_IGNORE_CASE;\n\telse if ((flags & GIT_PATHSPEC_USE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\treturn f;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic git_iterator_flag_t pathspec_match_iter_flags(uint32_t flags)\n{\n\tgit_iterator_flag_t f = 0;\n\n\tif ((flags & GIT_PATHSPEC_IGNORE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_IGNORE_CASE;\n\telse if ((flags & GIT_PATHSPEC_USE_CASE) != 0)\n\t\tf |= GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\treturn f;\n}"
  },
  {
    "function_name": "pathspec_match_from_iterator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "395-503",
    "snippet": "static int pathspec_match_from_iterator(\n\tgit_pathspec_match_list **out,\n\tgit_iterator *iter,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tconst git_index_entry *entry = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t pos, used_ct = 0, found_files = 0;\n\tgit_index *index = NULL;\n\tgit_bitvec used_patterns;\n\tchar **file;\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_STRINGS);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tif ((error = git_iterator_reset(iter, ps->prefix, ps->prefix)) < 0)\n\t\tgoto done;\n\n\tif (git_iterator_type(iter) == GIT_ITERATOR_TYPE_WORKDIR &&\n\t\t(error = git_repository_index__weakptr(\n\t\t\t&index, git_iterator_owner(iter))) < 0)\n\t\tgoto done;\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_iterator_ignore_case(iter));\n\n\twhile (!(error = git_iterator_advance(&entry, iter))) {\n\t\t/* search for match with entry->path */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, entry->path, NULL);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result) {\n\t\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check if path is ignored and untracked */\n\t\tif (index != NULL &&\n\t\t\tgit_iterator_current_is_ignored(iter) &&\n\t\t\tgit_index__find_pos(NULL, index, entry->path, 0, GIT_INDEX_STAGE_ANY) < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t++found_files;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1, entry->path, NULL);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched path into matches array */\n\t\tif ((file = (char **)git_array_alloc(m->matches)) == NULL ||\n\t\t\t(*file = git_pool_strdup(&m->pool, entry->path)) == NULL) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\tgoto done;\n\terror = 0;\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_files) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching files were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pathspec_match_free",
          "args": [
            "m"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "297-309",
          "snippet": "static void pathspec_match_free(git_pathspec_match_list *m)\n{\n\tif (!m)\n\t\treturn;\n\n\tgit_pathspec_free(m->pathspec);\n\tm->pathspec = NULL;\n\n\tgit_array_clear(m->matches);\n\tgit_array_clear(m->failures);\n\tgit_pool_clear(&m->pool);\n\tgit__free(m);\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic void pathspec_match_free(git_pathspec_match_list *m)\n{\n\tif (!m)\n\t\treturn;\n\n\tgit_pathspec_free(m->pathspec);\n\tm->pathspec = NULL;\n\n\tgit_array_clear(m->matches);\n\tgit_array_clear(m->failures);\n\tgit_pool_clear(&m->pool);\n\tgit__free(m);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_bitvec_free",
          "args": [
            "&used_patterns"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "git_bitvec_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
          "lines": "69-73",
          "snippet": "GIT_INLINE(void) git_bitvec_free(git_bitvec *bv)\n{\n\tif (bv->length)\n\t\tgit__free(bv->u.words);\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void) git_bitvec_free(git_bitvec *bv)\n{\n\tif (bv->length)\n\t\tgit__free(bv->u.words);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"No matching files were found\""
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_build_failure_array",
          "args": [
            "&m->failures",
            "patterns",
            "&used_patterns",
            "&m->pool"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_build_failure_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "369-393",
          "snippet": "static int pathspec_build_failure_array(\n\tgit_pathspec_string_array_t *failures,\n\tgit_vector *patterns,\n\tgit_bitvec *used,\n\tgit_pool *pool)\n{\n\tsize_t pos;\n\tchar **failed;\n\tconst git_attr_fnmatch *pat;\n\n\tfor (pos = 0; pos < patterns->length; ++pos) {\n\t\tif (git_bitvec_get(used, pos))\n\t\t\tcontinue;\n\n\t\tif ((failed = git_array_alloc(*failures)) == NULL)\n\t\t\treturn -1;\n\n\t\tpat = git_vector_get(patterns, pos);\n\n\t\tif ((*failed = git_pool_strdup(pool, pat->pattern)) == NULL)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_build_failure_array(\n\tgit_pathspec_string_array_t *failures,\n\tgit_vector *patterns,\n\tgit_bitvec *used,\n\tgit_pool *pool)\n{\n\tsize_t pos;\n\tchar **failed;\n\tconst git_attr_fnmatch *pat;\n\n\tfor (pos = 0; pos < patterns->length; ++pos) {\n\t\tif (git_bitvec_get(used, pos))\n\t\t\tcontinue;\n\n\t\tif ((failed = git_array_alloc(*failures)) == NULL)\n\t\t\treturn -1;\n\n\t\tpat = git_vector_get(patterns, pos);\n\n\t\tif ((*failed = git_pool_strdup(pool, pat->pattern)) == NULL)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pool_strdup",
          "args": [
            "&m->pool",
            "entry->path"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_strdup_safe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "213-216",
          "snippet": "char *git_pool_strdup_safe(git_pool *pool, const char *str)\n{\n\treturn str ? git_pool_strdup(pool, str) : NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nchar *git_pool_strdup_safe(git_pool *pool, const char *str)\n{\n\treturn str ? git_pool_strdup(pool, str) : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "m->matches"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathspec_mark_remaining",
          "args": [
            "&used_patterns",
            "patterns",
            "&ctxt",
            "pos + 1",
            "entry->path",
            "NULL"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_mark_remaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "341-367",
          "snippet": "static size_t pathspec_mark_remaining(\n\tgit_bitvec *used,\n\tgit_vector *patterns,\n\tstruct pathspec_match_context *ctxt,\n\tsize_t start,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tsize_t count = 0;\n\n\tif (path1 == path0)\n\t\tpath1 = NULL;\n\n\tfor (; start < patterns->length; ++start) {\n\t\tconst git_attr_fnmatch *pat = git_vector_get(patterns, start);\n\n\t\tif (git_bitvec_get(used, start))\n\t\t\tcontinue;\n\n\t\tif (path0 && pathspec_match_one(pat, ctxt, path0) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t\telse if (path1 && pathspec_match_one(pat, ctxt, path1) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t}\n\n\treturn count;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic size_t pathspec_mark_remaining(\n\tgit_bitvec *used,\n\tgit_vector *patterns,\n\tstruct pathspec_match_context *ctxt,\n\tsize_t start,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tsize_t count = 0;\n\n\tif (path1 == path0)\n\t\tpath1 = NULL;\n\n\tfor (; start < patterns->length; ++start) {\n\t\tconst git_attr_fnmatch *pat = git_vector_get(patterns, start);\n\n\t\tif (git_bitvec_get(used, start))\n\t\t\tcontinue;\n\n\t\tif (path0 && pathspec_match_one(pat, ctxt, path0) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t\telse if (path1 && pathspec_match_one(pat, ctxt, path1) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t}\n\n\treturn count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_mark_pattern",
          "args": [
            "&used_patterns",
            "pos"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_mark_pattern",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "331-339",
          "snippet": "GIT_INLINE(size_t) pathspec_mark_pattern(git_bitvec *used, size_t pos)\n{\n\tif (!git_bitvec_get(used, pos)) {\n\t\tgit_bitvec_set(used, pos, true);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nGIT_INLINE(size_t) pathspec_mark_pattern(git_bitvec *used, size_t pos)\n{\n\tif (!git_bitvec_get(used, pos)) {\n\t\tgit_bitvec_set(used, pos, true);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index__find_pos",
          "args": [
            "NULL",
            "index",
            "entry->path",
            "0",
            "GIT_INDEX_STAGE_ANY"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "git_index__find_pos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "1670-1675",
          "snippet": "int git_index__find_pos(\n\tsize_t *out, git_index *index, const char *path, size_t path_len, int stage)\n{\n\tassert(index && path);\n\treturn index_find(out, index, path, path_len, stage);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nint git_index__find_pos(\n\tsize_t *out, git_index *index, const char *path, size_t path_len, int stage)\n{\n\tassert(index && path);\n\treturn index_find(out, index, path, path_len, stage);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_current_is_ignored",
          "args": [
            "iter"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_current_is_ignored",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.c",
          "lines": "1974-1987",
          "snippet": "bool git_iterator_current_is_ignored(git_iterator *iter)\n{\n\tworkdir_iterator *wi = (workdir_iterator *)iter;\n\n\tif (iter->type != GIT_ITERATOR_TYPE_WORKDIR)\n\t\treturn false;\n\n\tif (wi->is_ignored != GIT_IGNORE_UNCHECKED)\n\t\treturn (bool)(wi->is_ignored == GIT_IGNORE_TRUE);\n\n\tworkdir_iterator_update_is_ignored(wi);\n\n\treturn (bool)(wi->is_ignored == GIT_IGNORE_TRUE);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"submodule.h\"",
            "#include \"buffer.h\"",
            "#include \"ignore.h\"",
            "#include \"index.h\"",
            "#include \"tree.h\"",
            "#include \"iterator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"submodule.h\"\n#include \"buffer.h\"\n#include \"ignore.h\"\n#include \"index.h\"\n#include \"tree.h\"\n#include \"iterator.h\"\n\nbool git_iterator_current_is_ignored(git_iterator *iter)\n{\n\tworkdir_iterator *wi = (workdir_iterator *)iter;\n\n\tif (iter->type != GIT_ITERATOR_TYPE_WORKDIR)\n\t\treturn false;\n\n\tif (wi->is_ignored != GIT_IGNORE_UNCHECKED)\n\t\treturn (bool)(wi->is_ignored == GIT_IGNORE_TRUE);\n\n\tworkdir_iterator_update_is_ignored(wi);\n\n\treturn (bool)(wi->is_ignored == GIT_IGNORE_TRUE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pathspec__match_at",
          "args": [
            "&pos",
            "patterns",
            "&ctxt",
            "entry->path",
            "NULL"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec__match_at",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "173-193",
          "snippet": "static int git_pathspec__match_at(\n\tsize_t *matched_at,\n\tconst git_vector *vspec,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tint result = GIT_ENOTFOUND;\n\tsize_t i = 0;\n\tconst git_attr_fnmatch *match;\n\n\tgit_vector_foreach(vspec, i, match) {\n\t\tif (path0 && (result = pathspec_match_one(match, ctxt, path0)) >= 0)\n\t\t\tbreak;\n\t\tif (path1 && (result = pathspec_match_one(match, ctxt, path1)) >= 0)\n\t\t\tbreak;\n\t}\n\n\t*matched_at = i;\n\treturn result;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int git_pathspec__match_at(\n\tsize_t *matched_at,\n\tconst git_vector *vspec,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tint result = GIT_ENOTFOUND;\n\tsize_t i = 0;\n\tconst git_attr_fnmatch *match;\n\n\tgit_vector_foreach(vspec, i, match) {\n\t\tif (path0 && (result = pathspec_match_one(match, ctxt, path0)) >= 0)\n\t\t\tbreak;\n\t\tif (path1 && (result = pathspec_match_one(match, ctxt, path1)) >= 0)\n\t\t\tbreak;\n\t}\n\n\t*matched_at = i;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_advance",
          "args": [
            "&entry",
            "iter"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_advance_into_or_over",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
          "lines": "192-201",
          "snippet": "GIT_INLINE(int) git_iterator_advance_into_or_over(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\tint error = iter->cb->advance_into(entry, iter);\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = iter->cb->advance(entry, iter);\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"buffer.h\"",
            "#include \"vector.h\"",
            "#include \"git2/index.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_advance_into_or_over(\n\tconst git_index_entry **entry, git_iterator *iter)\n{\n\tint error = iter->cb->advance_into(entry, iter);\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = iter->cb->advance(entry, iter);\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_match_context_init",
          "args": [
            "&ctxt",
            "(flags & GIT_PATHSPEC_NO_GLOB) != 0",
            "git_iterator_ignore_case(iter)"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_context_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "117-136",
          "snippet": "static void pathspec_match_context_init(\n\tstruct pathspec_match_context *ctxt,\n\tbool disable_fnmatch,\n\tbool casefold)\n{\n\tif (disable_fnmatch)\n\t\tctxt->fnmatch_flags = -1;\n\telse if (casefold)\n\t\tctxt->fnmatch_flags = FNM_CASEFOLD;\n\telse\n\t\tctxt->fnmatch_flags = 0;\n\n\tif (casefold) {\n\t\tctxt->strcomp  = git__strcasecmp;\n\t\tctxt->strncomp = git__strncasecmp;\n\t} else {\n\t\tctxt->strcomp  = git__strcmp;\n\t\tctxt->strncomp = git__strncmp;\n\t}\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic void pathspec_match_context_init(\n\tstruct pathspec_match_context *ctxt,\n\tbool disable_fnmatch,\n\tbool casefold)\n{\n\tif (disable_fnmatch)\n\t\tctxt->fnmatch_flags = -1;\n\telse if (casefold)\n\t\tctxt->fnmatch_flags = FNM_CASEFOLD;\n\telse\n\t\tctxt->fnmatch_flags = 0;\n\n\tif (casefold) {\n\t\tctxt->strcomp  = git__strcasecmp;\n\t\tctxt->strncomp = git__strncasecmp;\n\t} else {\n\t\tctxt->strcomp  = git__strcmp;\n\t\tctxt->strncomp = git__strncmp;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_ignore_case",
          "args": [
            "iter"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_ignore_case",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
          "lines": "248-251",
          "snippet": "GIT_INLINE(bool) git_iterator_ignore_case(git_iterator *iter)\n{\n\treturn ((iter->flags & GIT_ITERATOR_IGNORE_CASE) != 0);\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"buffer.h\"",
            "#include \"vector.h\"",
            "#include \"git2/index.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_iterator_ignore_case(git_iterator *iter)\n{\n\treturn ((iter->flags & GIT_ITERATOR_IGNORE_CASE) != 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_index__weakptr",
          "args": [
            "&index",
            "git_iterator_owner(iter)"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_index__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "819-850",
          "snippet": "int git_repository_index__weakptr(git_index **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_index == NULL) {\n\t\tgit_buf index_path = GIT_BUF_INIT;\n\t\tgit_index *index;\n\n\t\tif ((error = git_buf_joinpath(&index_path, repo->path_repository, GIT_INDEX_FILE)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_index_open(&index, index_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(index, repo);\n\n\t\t\tindex = git__compare_and_swap(&repo->_index, NULL, index);\n\t\t\tif (index != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(index, NULL);\n\t\t\t\tgit_index_free(index);\n\t\t\t}\n\n\t\t\terror = git_index_set_caps(repo->_index, GIT_INDEXCAP_FROM_OWNER);\n\t\t}\n\n\t\tgit_buf_free(&index_path);\n\t}\n\n\t*out = repo->_index;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_index__weakptr(git_index **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_index == NULL) {\n\t\tgit_buf index_path = GIT_BUF_INIT;\n\t\tgit_index *index;\n\n\t\tif ((error = git_buf_joinpath(&index_path, repo->path_repository, GIT_INDEX_FILE)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_index_open(&index, index_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(index, repo);\n\n\t\t\tindex = git__compare_and_swap(&repo->_index, NULL, index);\n\t\t\tif (index != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(index, NULL);\n\t\t\t\tgit_index_free(index);\n\t\t\t}\n\n\t\t\terror = git_index_set_caps(repo->_index, GIT_INDEXCAP_FROM_OWNER);\n\t\t}\n\n\t\tgit_buf_free(&index_path);\n\t}\n\n\t*out = repo->_index;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_owner",
          "args": [
            "iter"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
          "lines": "238-241",
          "snippet": "GIT_INLINE(git_repository *) git_iterator_owner(git_iterator *iter)\n{\n\treturn iter->repo;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"buffer.h\"",
            "#include \"vector.h\"",
            "#include \"git2/index.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_repository *) git_iterator_owner(git_iterator *iter)\n{\n\treturn iter->repo;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_type",
          "args": [
            "iter"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
          "lines": "233-236",
          "snippet": "GIT_INLINE(git_iterator_type_t) git_iterator_type(git_iterator *iter)\n{\n\treturn iter->type;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"buffer.h\"",
            "#include \"vector.h\"",
            "#include \"git2/index.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_iterator_type_t) git_iterator_type(git_iterator *iter)\n{\n\treturn iter->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_iterator_reset",
          "args": [
            "iter",
            "ps->prefix",
            "ps->prefix"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "git_iterator_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/iterator.h",
          "lines": "217-221",
          "snippet": "GIT_INLINE(int) git_iterator_reset(\n\tgit_iterator *iter, const char *start, const char *end)\n{\n\treturn iter->cb->reset(iter, start, end);\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"buffer.h\"",
            "#include \"vector.h\"",
            "#include \"git2/index.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include \"git2/index.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_iterator_reset(\n\tgit_iterator *iter, const char *start, const char *end)\n{\n\treturn iter->cb->reset(iter, start, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "m"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathspec_match_alloc",
          "args": [
            "ps",
            "PATHSPEC_DATATYPE_STRINGS"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "311-329",
          "snippet": "static git_pathspec_match_list *pathspec_match_alloc(\n\tgit_pathspec *ps, int datatype)\n{\n\tgit_pathspec_match_list *m = git__calloc(1, sizeof(git_pathspec_match_list));\n\tif (!m)\n\t\treturn NULL;\n\n\tgit_pool_init(&m->pool, 1);\n\n\t/* need to keep reference to pathspec and increment refcount because\n\t * failures array stores pointers to the pattern strings of the\n\t * pathspec that had no matches\n\t */\n\tGIT_REFCOUNT_INC(ps);\n\tm->pathspec = ps;\n\tm->datatype = datatype;\n\n\treturn m;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic git_pathspec_match_list *pathspec_match_alloc(\n\tgit_pathspec *ps, int datatype)\n{\n\tgit_pathspec_match_list *m = git__calloc(1, sizeof(git_pathspec_match_list));\n\tif (!m)\n\t\treturn NULL;\n\n\tgit_pool_init(&m->pool, 1);\n\n\t/* need to keep reference to pathspec and increment refcount because\n\t * failures array stores pointers to the pattern strings of the\n\t * pathspec that had no matches\n\t */\n\tGIT_REFCOUNT_INC(ps);\n\tm->pathspec = ps;\n\tm->datatype = datatype;\n\n\treturn m;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_bitvec_init",
          "args": [
            "&used_patterns",
            "patterns->length"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "git_bitvec_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
          "lines": "27-39",
          "snippet": "GIT_INLINE(int) git_bitvec_init(git_bitvec *bv, size_t capacity)\n{\n\tmemset(bv, 0x0, sizeof(*bv));\n\n\tif (capacity >= 64) {\n\t\tbv->length = (capacity / 64) + 1;\n\t\tbv->u.words = git__calloc(bv->length, sizeof(uint64_t));\n\t\tif (!bv->u.words)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(int) git_bitvec_init(git_bitvec *bv, size_t capacity)\n{\n\tmemset(bv, 0x0, sizeof(*bv));\n\n\tif (capacity >= 64) {\n\t\tbv->length = (capacity / 64) + 1;\n\t\tbv->u.words = git__calloc(bv->length, sizeof(uint64_t));\n\t\tif (!bv->u.words)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_match_from_iterator(\n\tgit_pathspec_match_list **out,\n\tgit_iterator *iter,\n\tuint32_t flags,\n\tgit_pathspec *ps)\n{\n\tint error = 0;\n\tgit_pathspec_match_list *m = NULL;\n\tconst git_index_entry *entry = NULL;\n\tstruct pathspec_match_context ctxt;\n\tgit_vector *patterns = &ps->pathspec;\n\tbool find_failures = out && (flags & GIT_PATHSPEC_FIND_FAILURES) != 0;\n\tbool failures_only = !out || (flags & GIT_PATHSPEC_FAILURES_ONLY) != 0;\n\tsize_t pos, used_ct = 0, found_files = 0;\n\tgit_index *index = NULL;\n\tgit_bitvec used_patterns;\n\tchar **file;\n\n\tif (git_bitvec_init(&used_patterns, patterns->length) < 0)\n\t\treturn -1;\n\n\tif (out) {\n\t\t*out = m = pathspec_match_alloc(ps, PATHSPEC_DATATYPE_STRINGS);\n\t\tGITERR_CHECK_ALLOC(m);\n\t}\n\n\tif ((error = git_iterator_reset(iter, ps->prefix, ps->prefix)) < 0)\n\t\tgoto done;\n\n\tif (git_iterator_type(iter) == GIT_ITERATOR_TYPE_WORKDIR &&\n\t\t(error = git_repository_index__weakptr(\n\t\t\t&index, git_iterator_owner(iter))) < 0)\n\t\tgoto done;\n\n\tpathspec_match_context_init(\n\t\t&ctxt, (flags & GIT_PATHSPEC_NO_GLOB) != 0,\n\t\tgit_iterator_ignore_case(iter));\n\n\twhile (!(error = git_iterator_advance(&entry, iter))) {\n\t\t/* search for match with entry->path */\n\t\tint result = git_pathspec__match_at(\n\t\t\t&pos, patterns, &ctxt, entry->path, NULL);\n\n\t\t/* no matches for this path */\n\t\tif (result < 0)\n\t\t\tcontinue;\n\n\t\t/* if result was a negative pattern match, then don't list file */\n\t\tif (!result) {\n\t\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check if path is ignored and untracked */\n\t\tif (index != NULL &&\n\t\t\tgit_iterator_current_is_ignored(iter) &&\n\t\t\tgit_index__find_pos(NULL, index, entry->path, 0, GIT_INDEX_STAGE_ANY) < 0)\n\t\t\tcontinue;\n\n\t\t/* mark the matched pattern as used */\n\t\tused_ct += pathspec_mark_pattern(&used_patterns, pos);\n\t\t++found_files;\n\n\t\t/* if find_failures is on, check if any later patterns also match */\n\t\tif (find_failures && used_ct < patterns->length)\n\t\t\tused_ct += pathspec_mark_remaining(\n\t\t\t\t&used_patterns, patterns, &ctxt, pos + 1, entry->path, NULL);\n\n\t\t/* if only looking at failures, exit early or just continue */\n\t\tif (failures_only || !out) {\n\t\t\tif (used_ct == patterns->length)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* insert matched path into matches array */\n\t\tif ((file = (char **)git_array_alloc(m->matches)) == NULL ||\n\t\t\t(*file = git_pool_strdup(&m->pool, entry->path)) == NULL) {\n\t\t\terror = -1;\n\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\tgoto done;\n\terror = 0;\n\n\t/* insert patterns that had no matches into failures array */\n\tif (find_failures && used_ct < patterns->length &&\n\t\t(error = pathspec_build_failure_array(\n\t\t\t&m->failures, patterns, &used_patterns, &m->pool)) < 0)\n\t\tgoto done;\n\n\t/* if every pattern failed to match, then we have failed */\n\tif ((flags & GIT_PATHSPEC_NO_MATCH_ERROR) != 0 && !found_files) {\n\t\tgiterr_set(GITERR_INVALID, \"No matching files were found\");\n\t\terror = GIT_ENOTFOUND;\n\t}\n\ndone:\n\tgit_bitvec_free(&used_patterns);\n\n\tif (error < 0) {\n\t\tpathspec_match_free(m);\n\t\tif (out) *out = NULL;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "pathspec_build_failure_array",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "369-393",
    "snippet": "static int pathspec_build_failure_array(\n\tgit_pathspec_string_array_t *failures,\n\tgit_vector *patterns,\n\tgit_bitvec *used,\n\tgit_pool *pool)\n{\n\tsize_t pos;\n\tchar **failed;\n\tconst git_attr_fnmatch *pat;\n\n\tfor (pos = 0; pos < patterns->length; ++pos) {\n\t\tif (git_bitvec_get(used, pos))\n\t\t\tcontinue;\n\n\t\tif ((failed = git_array_alloc(*failures)) == NULL)\n\t\t\treturn -1;\n\n\t\tpat = git_vector_get(patterns, pos);\n\n\t\tif ((*failed = git_pool_strdup(pool, pat->pattern)) == NULL)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pool_strdup",
          "args": [
            "pool",
            "pat->pattern"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_strdup_safe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "213-216",
          "snippet": "char *git_pool_strdup_safe(git_pool *pool, const char *str)\n{\n\treturn str ? git_pool_strdup(pool, str) : NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nchar *git_pool_strdup_safe(git_pool *pool, const char *str)\n{\n\treturn str ? git_pool_strdup(pool, str) : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "patterns",
            "pos"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "*failures"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_bitvec_get",
          "args": [
            "used",
            "pos"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "git_bitvec_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
          "lines": "55-59",
          "snippet": "GIT_INLINE(bool) git_bitvec_get(git_bitvec *bv, size_t bit)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\treturn (*word & GIT_BITVEC_MASK(bit)) != 0;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(bool) git_bitvec_get(git_bitvec *bv, size_t bit)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\treturn (*word & GIT_BITVEC_MASK(bit)) != 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_build_failure_array(\n\tgit_pathspec_string_array_t *failures,\n\tgit_vector *patterns,\n\tgit_bitvec *used,\n\tgit_pool *pool)\n{\n\tsize_t pos;\n\tchar **failed;\n\tconst git_attr_fnmatch *pat;\n\n\tfor (pos = 0; pos < patterns->length; ++pos) {\n\t\tif (git_bitvec_get(used, pos))\n\t\t\tcontinue;\n\n\t\tif ((failed = git_array_alloc(*failures)) == NULL)\n\t\t\treturn -1;\n\n\t\tpat = git_vector_get(patterns, pos);\n\n\t\tif ((*failed = git_pool_strdup(pool, pat->pattern)) == NULL)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "pathspec_mark_remaining",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "341-367",
    "snippet": "static size_t pathspec_mark_remaining(\n\tgit_bitvec *used,\n\tgit_vector *patterns,\n\tstruct pathspec_match_context *ctxt,\n\tsize_t start,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tsize_t count = 0;\n\n\tif (path1 == path0)\n\t\tpath1 = NULL;\n\n\tfor (; start < patterns->length; ++start) {\n\t\tconst git_attr_fnmatch *pat = git_vector_get(patterns, start);\n\n\t\tif (git_bitvec_get(used, start))\n\t\t\tcontinue;\n\n\t\tif (path0 && pathspec_match_one(pat, ctxt, path0) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t\telse if (path1 && pathspec_match_one(pat, ctxt, path1) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t}\n\n\treturn count;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pathspec_mark_pattern",
          "args": [
            "used",
            "start"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_mark_pattern",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "331-339",
          "snippet": "GIT_INLINE(size_t) pathspec_mark_pattern(git_bitvec *used, size_t pos)\n{\n\tif (!git_bitvec_get(used, pos)) {\n\t\tgit_bitvec_set(used, pos, true);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nGIT_INLINE(size_t) pathspec_mark_pattern(git_bitvec *used, size_t pos)\n{\n\tif (!git_bitvec_get(used, pos)) {\n\t\tgit_bitvec_set(used, pos, true);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_match_one",
          "args": [
            "pat",
            "ctxt",
            "path1"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "138-171",
          "snippet": "static int pathspec_match_one(\n\tconst git_attr_fnmatch *match,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path)\n{\n\tint result = (match->flags & GIT_ATTR_FNMATCH_MATCH_ALL) ? 0 : FNM_NOMATCH;\n\n\tif (result == FNM_NOMATCH)\n\t\tresult = ctxt->strcomp(match->pattern, path) ? FNM_NOMATCH : 0;\n\n\tif (ctxt->fnmatch_flags >= 0 && result == FNM_NOMATCH)\n\t\tresult = p_fnmatch(match->pattern, path, ctxt->fnmatch_flags);\n\n\t/* if we didn't match, look for exact dirname prefix match */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_HASWILD) == 0 &&\n\t\tctxt->strncomp(path, match->pattern, match->length) == 0 &&\n\t\tpath[match->length] == '/')\n\t\tresult = 0;\n\n\t/* if we didn't match and this is a negative match, check for exact\n\t * match of filename with leading '!'\n\t */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_NEGATIVE) != 0 &&\n\t\t*path == '!' &&\n\t\tctxt->strncomp(path + 1, match->pattern, match->length) == 0 &&\n\t\t(!path[match->length + 1] || path[match->length + 1] == '/'))\n\t\treturn 1;\n\n\tif (result == 0)\n\t\treturn (match->flags & GIT_ATTR_FNMATCH_NEGATIVE) ? 0 : 1;\n\treturn -1;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_match_one(\n\tconst git_attr_fnmatch *match,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path)\n{\n\tint result = (match->flags & GIT_ATTR_FNMATCH_MATCH_ALL) ? 0 : FNM_NOMATCH;\n\n\tif (result == FNM_NOMATCH)\n\t\tresult = ctxt->strcomp(match->pattern, path) ? FNM_NOMATCH : 0;\n\n\tif (ctxt->fnmatch_flags >= 0 && result == FNM_NOMATCH)\n\t\tresult = p_fnmatch(match->pattern, path, ctxt->fnmatch_flags);\n\n\t/* if we didn't match, look for exact dirname prefix match */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_HASWILD) == 0 &&\n\t\tctxt->strncomp(path, match->pattern, match->length) == 0 &&\n\t\tpath[match->length] == '/')\n\t\tresult = 0;\n\n\t/* if we didn't match and this is a negative match, check for exact\n\t * match of filename with leading '!'\n\t */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_NEGATIVE) != 0 &&\n\t\t*path == '!' &&\n\t\tctxt->strncomp(path + 1, match->pattern, match->length) == 0 &&\n\t\t(!path[match->length + 1] || path[match->length + 1] == '/'))\n\t\treturn 1;\n\n\tif (result == 0)\n\t\treturn (match->flags & GIT_ATTR_FNMATCH_NEGATIVE) ? 0 : 1;\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_bitvec_get",
          "args": [
            "used",
            "start"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "git_bitvec_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
          "lines": "55-59",
          "snippet": "GIT_INLINE(bool) git_bitvec_get(git_bitvec *bv, size_t bit)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\treturn (*word & GIT_BITVEC_MASK(bit)) != 0;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(bool) git_bitvec_get(git_bitvec *bv, size_t bit)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\treturn (*word & GIT_BITVEC_MASK(bit)) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "patterns",
            "start"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic size_t pathspec_mark_remaining(\n\tgit_bitvec *used,\n\tgit_vector *patterns,\n\tstruct pathspec_match_context *ctxt,\n\tsize_t start,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tsize_t count = 0;\n\n\tif (path1 == path0)\n\t\tpath1 = NULL;\n\n\tfor (; start < patterns->length; ++start) {\n\t\tconst git_attr_fnmatch *pat = git_vector_get(patterns, start);\n\n\t\tif (git_bitvec_get(used, start))\n\t\t\tcontinue;\n\n\t\tif (path0 && pathspec_match_one(pat, ctxt, path0) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t\telse if (path1 && pathspec_match_one(pat, ctxt, path1) > 0)\n\t\t\tcount += pathspec_mark_pattern(used, start);\n\t}\n\n\treturn count;\n}"
  },
  {
    "function_name": "pathspec_mark_pattern",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "331-339",
    "snippet": "GIT_INLINE(size_t) pathspec_mark_pattern(git_bitvec *used, size_t pos)\n{\n\tif (!git_bitvec_get(used, pos)) {\n\t\tgit_bitvec_set(used, pos, true);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_bitvec_set",
          "args": [
            "used",
            "pos",
            "true"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "git_bitvec_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
          "lines": "44-53",
          "snippet": "GIT_INLINE(void) git_bitvec_set(git_bitvec *bv, size_t bit, bool on)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\tuint64_t mask = GIT_BITVEC_MASK(bit);\n\n\tif (on)\n\t\t*word |= mask;\n\telse\n\t\t*word &= ~mask;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void) git_bitvec_set(git_bitvec *bv, size_t bit, bool on)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\tuint64_t mask = GIT_BITVEC_MASK(bit);\n\n\tif (on)\n\t\t*word |= mask;\n\telse\n\t\t*word &= ~mask;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_bitvec_get",
          "args": [
            "used",
            "pos"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "git_bitvec_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
          "lines": "55-59",
          "snippet": "GIT_INLINE(bool) git_bitvec_get(git_bitvec *bv, size_t bit)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\treturn (*word & GIT_BITVEC_MASK(bit)) != 0;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(bool) git_bitvec_get(git_bitvec *bv, size_t bit)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\treturn (*word & GIT_BITVEC_MASK(bit)) != 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nGIT_INLINE(size_t) pathspec_mark_pattern(git_bitvec *used, size_t pos)\n{\n\tif (!git_bitvec_get(used, pos)) {\n\t\tgit_bitvec_set(used, pos, true);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "pathspec_match_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "311-329",
    "snippet": "static git_pathspec_match_list *pathspec_match_alloc(\n\tgit_pathspec *ps, int datatype)\n{\n\tgit_pathspec_match_list *m = git__calloc(1, sizeof(git_pathspec_match_list));\n\tif (!m)\n\t\treturn NULL;\n\n\tgit_pool_init(&m->pool, 1);\n\n\t/* need to keep reference to pathspec and increment refcount because\n\t * failures array stores pointers to the pattern strings of the\n\t * pathspec that had no matches\n\t */\n\tGIT_REFCOUNT_INC(ps);\n\tm->pathspec = ps;\n\tm->datatype = datatype;\n\n\treturn m;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "ps"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pool_init",
          "args": [
            "&m->pool",
            "1"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "120-129",
          "snippet": "void git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_pathspec_match_list)"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic git_pathspec_match_list *pathspec_match_alloc(\n\tgit_pathspec *ps, int datatype)\n{\n\tgit_pathspec_match_list *m = git__calloc(1, sizeof(git_pathspec_match_list));\n\tif (!m)\n\t\treturn NULL;\n\n\tgit_pool_init(&m->pool, 1);\n\n\t/* need to keep reference to pathspec and increment refcount because\n\t * failures array stores pointers to the pattern strings of the\n\t * pathspec that had no matches\n\t */\n\tGIT_REFCOUNT_INC(ps);\n\tm->pathspec = ps;\n\tm->datatype = datatype;\n\n\treturn m;\n}"
  },
  {
    "function_name": "pathspec_match_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "297-309",
    "snippet": "static void pathspec_match_free(git_pathspec_match_list *m)\n{\n\tif (!m)\n\t\treturn;\n\n\tgit_pathspec_free(m->pathspec);\n\tm->pathspec = NULL;\n\n\tgit_array_clear(m->matches);\n\tgit_array_clear(m->failures);\n\tgit_pool_clear(&m->pool);\n\tgit__free(m);\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "m"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pool_clear",
          "args": [
            "&m->pool"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "131-134",
          "snippet": "void git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "m->failures"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "m->matches"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pathspec_free",
          "args": [
            "m->pathspec"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "278-283",
          "snippet": "void git_pathspec_free(git_pathspec *ps)\n{\n\tif (!ps)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(ps, pathspec_free);\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nvoid git_pathspec_free(git_pathspec *ps)\n{\n\tif (!ps)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(ps, pathspec_free);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic void pathspec_match_free(git_pathspec_match_list *m)\n{\n\tif (!m)\n\t\treturn;\n\n\tgit_pathspec_free(m->pathspec);\n\tm->pathspec = NULL;\n\n\tgit_array_clear(m->matches);\n\tgit_array_clear(m->failures);\n\tgit_pool_clear(&m->pool);\n\tgit__free(m);\n}"
  },
  {
    "function_name": "git_pathspec_matches_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "285-295",
    "snippet": "int git_pathspec_matches_path(\n\tconst git_pathspec *ps, uint32_t flags, const char *path)\n{\n\tbool no_fnmatch = (flags & GIT_PATHSPEC_NO_GLOB) != 0;\n\tbool casefold =  (flags & GIT_PATHSPEC_IGNORE_CASE) != 0;\n\n\tassert(ps && path);\n\n\treturn (0 != git_pathspec__match(\n\t\t&ps->pathspec, path, no_fnmatch, casefold, NULL, NULL));\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pathspec__match",
          "args": [
            "&ps->pathspec",
            "path",
            "no_fnmatch",
            "casefold",
            "NULL",
            "NULL"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec__match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "196-230",
          "snippet": "bool git_pathspec__match(\n\tconst git_vector *vspec,\n\tconst char *path,\n\tbool disable_fnmatch,\n\tbool casefold,\n\tconst char **matched_pathspec,\n\tsize_t *matched_at)\n{\n\tint result;\n\tsize_t pos;\n\tstruct pathspec_match_context ctxt;\n\n\tif (matched_pathspec)\n\t\t*matched_pathspec = NULL;\n\tif (matched_at)\n\t\t*matched_at = GIT_PATHSPEC_NOMATCH;\n\n\tif (!vspec || !vspec->length)\n\t\treturn true;\n\n\tpathspec_match_context_init(&ctxt, disable_fnmatch, casefold);\n\n\tresult = git_pathspec__match_at(&pos, vspec, &ctxt, path, NULL);\n\tif (result >= 0) {\n\t\tif (matched_pathspec) {\n\t\t\tconst git_attr_fnmatch *match = git_vector_get(vspec, pos);\n\t\t\t*matched_pathspec = match->pattern;\n\t\t}\n\n\t\tif (matched_at)\n\t\t\t*matched_at = pos;\n\t}\n\n\treturn (result > 0);\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nbool git_pathspec__match(\n\tconst git_vector *vspec,\n\tconst char *path,\n\tbool disable_fnmatch,\n\tbool casefold,\n\tconst char **matched_pathspec,\n\tsize_t *matched_at)\n{\n\tint result;\n\tsize_t pos;\n\tstruct pathspec_match_context ctxt;\n\n\tif (matched_pathspec)\n\t\t*matched_pathspec = NULL;\n\tif (matched_at)\n\t\t*matched_at = GIT_PATHSPEC_NOMATCH;\n\n\tif (!vspec || !vspec->length)\n\t\treturn true;\n\n\tpathspec_match_context_init(&ctxt, disable_fnmatch, casefold);\n\n\tresult = git_pathspec__match_at(&pos, vspec, &ctxt, path, NULL);\n\tif (result >= 0) {\n\t\tif (matched_pathspec) {\n\t\t\tconst git_attr_fnmatch *match = git_vector_get(vspec, pos);\n\t\t\t*matched_pathspec = match->pattern;\n\t\t}\n\n\t\tif (matched_at)\n\t\t\t*matched_at = pos;\n\t}\n\n\treturn (result > 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ps && path"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec_matches_path(\n\tconst git_pathspec *ps, uint32_t flags, const char *path)\n{\n\tbool no_fnmatch = (flags & GIT_PATHSPEC_NO_GLOB) != 0;\n\tbool casefold =  (flags & GIT_PATHSPEC_IGNORE_CASE) != 0;\n\n\tassert(ps && path);\n\n\treturn (0 != git_pathspec__match(\n\t\t&ps->pathspec, path, no_fnmatch, casefold, NULL, NULL));\n}"
  },
  {
    "function_name": "git_pathspec_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "278-283",
    "snippet": "void git_pathspec_free(git_pathspec *ps)\n{\n\tif (!ps)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(ps, pathspec_free);\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_DEC",
          "args": [
            "ps",
            "pathspec_free"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nvoid git_pathspec_free(git_pathspec *ps)\n{\n\tif (!ps)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(ps, pathspec_free);\n}"
  },
  {
    "function_name": "pathspec_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "272-276",
    "snippet": "static void pathspec_free(git_pathspec *ps)\n{\n\tgit_pathspec__clear(ps);\n\tgit__free(ps);\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "ps"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pathspec__clear",
          "args": [
            "ps"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec__clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "248-254",
          "snippet": "void git_pathspec__clear(git_pathspec *ps)\n{\n\tgit__free(ps->prefix);\n\tgit_pathspec__vfree(&ps->pathspec);\n\tgit_pool_clear(&ps->pool);\n\tmemset(ps, 0, sizeof(*ps));\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nvoid git_pathspec__clear(git_pathspec *ps)\n{\n\tgit__free(ps->prefix);\n\tgit_pathspec__vfree(&ps->pathspec);\n\tgit_pool_clear(&ps->pool);\n\tmemset(ps, 0, sizeof(*ps));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic void pathspec_free(git_pathspec *ps)\n{\n\tgit_pathspec__clear(ps);\n\tgit__free(ps);\n}"
  },
  {
    "function_name": "git_pathspec_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "256-270",
    "snippet": "int git_pathspec_new(git_pathspec **out, const git_strarray *pathspec)\n{\n\tint error = 0;\n\tgit_pathspec *ps = git__malloc(sizeof(git_pathspec));\n\tGITERR_CHECK_ALLOC(ps);\n\n\tif ((error = git_pathspec__init(ps, pathspec)) < 0) {\n\t\tgit__free(ps);\n\t\treturn error;\n\t}\n\n\tGIT_REFCOUNT_INC(ps);\n\t*out = ps;\n\treturn 0;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "ps"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "ps"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pathspec__init",
          "args": [
            "ps",
            "pathspec"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec__init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "233-246",
          "snippet": "int git_pathspec__init(git_pathspec *ps, const git_strarray *paths)\n{\n\tint error = 0;\n\n\tmemset(ps, 0, sizeof(*ps));\n\n\tps->prefix = git_pathspec_prefix(paths);\n\tgit_pool_init(&ps->pool, 1);\n\n\tif ((error = git_pathspec__vinit(&ps->pathspec, paths, &ps->pool)) < 0)\n\t\tgit_pathspec__clear(ps);\n\n\treturn error;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec__init(git_pathspec *ps, const git_strarray *paths)\n{\n\tint error = 0;\n\n\tmemset(ps, 0, sizeof(*ps));\n\n\tps->prefix = git_pathspec_prefix(paths);\n\tgit_pool_init(&ps->pool, 1);\n\n\tif ((error = git_pathspec__vinit(&ps->pathspec, paths, &ps->pool)) < 0)\n\t\tgit_pathspec__clear(ps);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "ps"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(git_pathspec)"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec_new(git_pathspec **out, const git_strarray *pathspec)\n{\n\tint error = 0;\n\tgit_pathspec *ps = git__malloc(sizeof(git_pathspec));\n\tGITERR_CHECK_ALLOC(ps);\n\n\tif ((error = git_pathspec__init(ps, pathspec)) < 0) {\n\t\tgit__free(ps);\n\t\treturn error;\n\t}\n\n\tGIT_REFCOUNT_INC(ps);\n\t*out = ps;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_pathspec__clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "248-254",
    "snippet": "void git_pathspec__clear(git_pathspec *ps)\n{\n\tgit__free(ps->prefix);\n\tgit_pathspec__vfree(&ps->pathspec);\n\tgit_pool_clear(&ps->pool);\n\tmemset(ps, 0, sizeof(*ps));\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ps",
            "0",
            "sizeof(*ps)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pool_clear",
          "args": [
            "&ps->pool"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "131-134",
          "snippet": "void git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pathspec__vfree",
          "args": [
            "&ps->pathspec"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec__vfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "106-109",
          "snippet": "void git_pathspec__vfree(git_vector *vspec)\n{\n\tgit_vector_free_deep(vspec);\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nvoid git_pathspec__vfree(git_vector *vspec)\n{\n\tgit_vector_free_deep(vspec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "ps->prefix"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nvoid git_pathspec__clear(git_pathspec *ps)\n{\n\tgit__free(ps->prefix);\n\tgit_pathspec__vfree(&ps->pathspec);\n\tgit_pool_clear(&ps->pool);\n\tmemset(ps, 0, sizeof(*ps));\n}"
  },
  {
    "function_name": "git_pathspec__init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "233-246",
    "snippet": "int git_pathspec__init(git_pathspec *ps, const git_strarray *paths)\n{\n\tint error = 0;\n\n\tmemset(ps, 0, sizeof(*ps));\n\n\tps->prefix = git_pathspec_prefix(paths);\n\tgit_pool_init(&ps->pool, 1);\n\n\tif ((error = git_pathspec__vinit(&ps->pathspec, paths, &ps->pool)) < 0)\n\t\tgit_pathspec__clear(ps);\n\n\treturn error;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pathspec__clear",
          "args": [
            "ps"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec__clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "248-254",
          "snippet": "void git_pathspec__clear(git_pathspec *ps)\n{\n\tgit__free(ps->prefix);\n\tgit_pathspec__vfree(&ps->pathspec);\n\tgit_pool_clear(&ps->pool);\n\tmemset(ps, 0, sizeof(*ps));\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nvoid git_pathspec__clear(git_pathspec *ps)\n{\n\tgit__free(ps->prefix);\n\tgit_pathspec__vfree(&ps->pathspec);\n\tgit_pool_clear(&ps->pool);\n\tmemset(ps, 0, sizeof(*ps));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pathspec__vinit",
          "args": [
            "&ps->pathspec",
            "paths",
            "&ps->pool"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec__vinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "66-103",
          "snippet": "int git_pathspec__vinit(\n\tgit_vector *vspec, const git_strarray *strspec, git_pool *strpool)\n{\n\tsize_t i;\n\n\tmemset(vspec, 0, sizeof(*vspec));\n\n\tif (git_pathspec_is_empty(strspec))\n\t\treturn 0;\n\n\tif (git_vector_init(vspec, strspec->count, NULL) < 0)\n\t\treturn -1;\n\n\tfor (i = 0; i < strspec->count; ++i) {\n\t\tint ret;\n\t\tconst char *pattern = strspec->strings[i];\n\t\tgit_attr_fnmatch *match = git__calloc(1, sizeof(git_attr_fnmatch));\n\t\tif (!match)\n\t\t\treturn -1;\n\n\t\tmatch->flags = GIT_ATTR_FNMATCH_ALLOWSPACE |\n\t\t\tGIT_ATTR_FNMATCH_ALLOWNEG | GIT_ATTR_FNMATCH_NOLEADINGDIR;\n\n\t\tret = git_attr_fnmatch__parse(match, strpool, NULL, &pattern);\n\t\tif (ret == GIT_ENOTFOUND) {\n\t\t\tgit__free(match);\n\t\t\tcontinue;\n\t\t} else if (ret < 0) {\n\t\t\tgit__free(match);\n\t\t\treturn ret;\n\t\t}\n\n\t\tif (git_vector_insert(vspec, match) < 0)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec__vinit(\n\tgit_vector *vspec, const git_strarray *strspec, git_pool *strpool)\n{\n\tsize_t i;\n\n\tmemset(vspec, 0, sizeof(*vspec));\n\n\tif (git_pathspec_is_empty(strspec))\n\t\treturn 0;\n\n\tif (git_vector_init(vspec, strspec->count, NULL) < 0)\n\t\treturn -1;\n\n\tfor (i = 0; i < strspec->count; ++i) {\n\t\tint ret;\n\t\tconst char *pattern = strspec->strings[i];\n\t\tgit_attr_fnmatch *match = git__calloc(1, sizeof(git_attr_fnmatch));\n\t\tif (!match)\n\t\t\treturn -1;\n\n\t\tmatch->flags = GIT_ATTR_FNMATCH_ALLOWSPACE |\n\t\t\tGIT_ATTR_FNMATCH_ALLOWNEG | GIT_ATTR_FNMATCH_NOLEADINGDIR;\n\n\t\tret = git_attr_fnmatch__parse(match, strpool, NULL, &pattern);\n\t\tif (ret == GIT_ENOTFOUND) {\n\t\t\tgit__free(match);\n\t\t\tcontinue;\n\t\t} else if (ret < 0) {\n\t\t\tgit__free(match);\n\t\t\treturn ret;\n\t\t}\n\n\t\tif (git_vector_insert(vspec, match) < 0)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pool_init",
          "args": [
            "&ps->pool",
            "1"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "120-129",
          "snippet": "void git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pathspec_prefix",
          "args": [
            "paths"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "20-45",
          "snippet": "char *git_pathspec_prefix(const git_strarray *pathspec)\n{\n\tgit_buf prefix = GIT_BUF_INIT;\n\tconst char *scan;\n\n\tif (!pathspec || !pathspec->count ||\n\t\tgit_buf_text_common_prefix(&prefix, pathspec) < 0)\n\t\treturn NULL;\n\n\t/* diff prefix will only be leading non-wildcards */\n\tfor (scan = prefix.ptr; *scan; ++scan) {\n\t\tif (git__iswildcard(*scan) &&\n\t\t\t(scan == prefix.ptr || (*(scan - 1) != '\\\\')))\n\t\t\tbreak;\n\t}\n\tgit_buf_truncate(&prefix, scan - prefix.ptr);\n\n\tif (prefix.size <= 0) {\n\t\tgit_buf_free(&prefix);\n\t\treturn NULL;\n\t}\n\n\tgit_buf_text_unescape(&prefix);\n\n\treturn git_buf_detach(&prefix);\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nchar *git_pathspec_prefix(const git_strarray *pathspec)\n{\n\tgit_buf prefix = GIT_BUF_INIT;\n\tconst char *scan;\n\n\tif (!pathspec || !pathspec->count ||\n\t\tgit_buf_text_common_prefix(&prefix, pathspec) < 0)\n\t\treturn NULL;\n\n\t/* diff prefix will only be leading non-wildcards */\n\tfor (scan = prefix.ptr; *scan; ++scan) {\n\t\tif (git__iswildcard(*scan) &&\n\t\t\t(scan == prefix.ptr || (*(scan - 1) != '\\\\')))\n\t\t\tbreak;\n\t}\n\tgit_buf_truncate(&prefix, scan - prefix.ptr);\n\n\tif (prefix.size <= 0) {\n\t\tgit_buf_free(&prefix);\n\t\treturn NULL;\n\t}\n\n\tgit_buf_text_unescape(&prefix);\n\n\treturn git_buf_detach(&prefix);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ps",
            "0",
            "sizeof(*ps)"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec__init(git_pathspec *ps, const git_strarray *paths)\n{\n\tint error = 0;\n\n\tmemset(ps, 0, sizeof(*ps));\n\n\tps->prefix = git_pathspec_prefix(paths);\n\tgit_pool_init(&ps->pool, 1);\n\n\tif ((error = git_pathspec__vinit(&ps->pathspec, paths, &ps->pool)) < 0)\n\t\tgit_pathspec__clear(ps);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_pathspec__match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "196-230",
    "snippet": "bool git_pathspec__match(\n\tconst git_vector *vspec,\n\tconst char *path,\n\tbool disable_fnmatch,\n\tbool casefold,\n\tconst char **matched_pathspec,\n\tsize_t *matched_at)\n{\n\tint result;\n\tsize_t pos;\n\tstruct pathspec_match_context ctxt;\n\n\tif (matched_pathspec)\n\t\t*matched_pathspec = NULL;\n\tif (matched_at)\n\t\t*matched_at = GIT_PATHSPEC_NOMATCH;\n\n\tif (!vspec || !vspec->length)\n\t\treturn true;\n\n\tpathspec_match_context_init(&ctxt, disable_fnmatch, casefold);\n\n\tresult = git_pathspec__match_at(&pos, vspec, &ctxt, path, NULL);\n\tif (result >= 0) {\n\t\tif (matched_pathspec) {\n\t\t\tconst git_attr_fnmatch *match = git_vector_get(vspec, pos);\n\t\t\t*matched_pathspec = match->pattern;\n\t\t}\n\n\t\tif (matched_at)\n\t\t\t*matched_at = pos;\n\t}\n\n\treturn (result > 0);\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "vspec",
            "pos"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pathspec__match_at",
          "args": [
            "&pos",
            "vspec",
            "&ctxt",
            "path",
            "NULL"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec__match_at",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "173-193",
          "snippet": "static int git_pathspec__match_at(\n\tsize_t *matched_at,\n\tconst git_vector *vspec,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tint result = GIT_ENOTFOUND;\n\tsize_t i = 0;\n\tconst git_attr_fnmatch *match;\n\n\tgit_vector_foreach(vspec, i, match) {\n\t\tif (path0 && (result = pathspec_match_one(match, ctxt, path0)) >= 0)\n\t\t\tbreak;\n\t\tif (path1 && (result = pathspec_match_one(match, ctxt, path1)) >= 0)\n\t\t\tbreak;\n\t}\n\n\t*matched_at = i;\n\treturn result;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int git_pathspec__match_at(\n\tsize_t *matched_at,\n\tconst git_vector *vspec,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tint result = GIT_ENOTFOUND;\n\tsize_t i = 0;\n\tconst git_attr_fnmatch *match;\n\n\tgit_vector_foreach(vspec, i, match) {\n\t\tif (path0 && (result = pathspec_match_one(match, ctxt, path0)) >= 0)\n\t\t\tbreak;\n\t\tif (path1 && (result = pathspec_match_one(match, ctxt, path1)) >= 0)\n\t\t\tbreak;\n\t}\n\n\t*matched_at = i;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathspec_match_context_init",
          "args": [
            "&ctxt",
            "disable_fnmatch",
            "casefold"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_context_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "117-136",
          "snippet": "static void pathspec_match_context_init(\n\tstruct pathspec_match_context *ctxt,\n\tbool disable_fnmatch,\n\tbool casefold)\n{\n\tif (disable_fnmatch)\n\t\tctxt->fnmatch_flags = -1;\n\telse if (casefold)\n\t\tctxt->fnmatch_flags = FNM_CASEFOLD;\n\telse\n\t\tctxt->fnmatch_flags = 0;\n\n\tif (casefold) {\n\t\tctxt->strcomp  = git__strcasecmp;\n\t\tctxt->strncomp = git__strncasecmp;\n\t} else {\n\t\tctxt->strcomp  = git__strcmp;\n\t\tctxt->strncomp = git__strncmp;\n\t}\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic void pathspec_match_context_init(\n\tstruct pathspec_match_context *ctxt,\n\tbool disable_fnmatch,\n\tbool casefold)\n{\n\tif (disable_fnmatch)\n\t\tctxt->fnmatch_flags = -1;\n\telse if (casefold)\n\t\tctxt->fnmatch_flags = FNM_CASEFOLD;\n\telse\n\t\tctxt->fnmatch_flags = 0;\n\n\tif (casefold) {\n\t\tctxt->strcomp  = git__strcasecmp;\n\t\tctxt->strncomp = git__strncasecmp;\n\t} else {\n\t\tctxt->strcomp  = git__strcmp;\n\t\tctxt->strncomp = git__strncmp;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nbool git_pathspec__match(\n\tconst git_vector *vspec,\n\tconst char *path,\n\tbool disable_fnmatch,\n\tbool casefold,\n\tconst char **matched_pathspec,\n\tsize_t *matched_at)\n{\n\tint result;\n\tsize_t pos;\n\tstruct pathspec_match_context ctxt;\n\n\tif (matched_pathspec)\n\t\t*matched_pathspec = NULL;\n\tif (matched_at)\n\t\t*matched_at = GIT_PATHSPEC_NOMATCH;\n\n\tif (!vspec || !vspec->length)\n\t\treturn true;\n\n\tpathspec_match_context_init(&ctxt, disable_fnmatch, casefold);\n\n\tresult = git_pathspec__match_at(&pos, vspec, &ctxt, path, NULL);\n\tif (result >= 0) {\n\t\tif (matched_pathspec) {\n\t\t\tconst git_attr_fnmatch *match = git_vector_get(vspec, pos);\n\t\t\t*matched_pathspec = match->pattern;\n\t\t}\n\n\t\tif (matched_at)\n\t\t\t*matched_at = pos;\n\t}\n\n\treturn (result > 0);\n}"
  },
  {
    "function_name": "git_pathspec__match_at",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "173-193",
    "snippet": "static int git_pathspec__match_at(\n\tsize_t *matched_at,\n\tconst git_vector *vspec,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tint result = GIT_ENOTFOUND;\n\tsize_t i = 0;\n\tconst git_attr_fnmatch *match;\n\n\tgit_vector_foreach(vspec, i, match) {\n\t\tif (path0 && (result = pathspec_match_one(match, ctxt, path0)) >= 0)\n\t\t\tbreak;\n\t\tif (path1 && (result = pathspec_match_one(match, ctxt, path1)) >= 0)\n\t\t\tbreak;\n\t}\n\n\t*matched_at = i;\n\treturn result;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pathspec_match_one",
          "args": [
            "match",
            "ctxt",
            "path1"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "pathspec_match_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "138-171",
          "snippet": "static int pathspec_match_one(\n\tconst git_attr_fnmatch *match,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path)\n{\n\tint result = (match->flags & GIT_ATTR_FNMATCH_MATCH_ALL) ? 0 : FNM_NOMATCH;\n\n\tif (result == FNM_NOMATCH)\n\t\tresult = ctxt->strcomp(match->pattern, path) ? FNM_NOMATCH : 0;\n\n\tif (ctxt->fnmatch_flags >= 0 && result == FNM_NOMATCH)\n\t\tresult = p_fnmatch(match->pattern, path, ctxt->fnmatch_flags);\n\n\t/* if we didn't match, look for exact dirname prefix match */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_HASWILD) == 0 &&\n\t\tctxt->strncomp(path, match->pattern, match->length) == 0 &&\n\t\tpath[match->length] == '/')\n\t\tresult = 0;\n\n\t/* if we didn't match and this is a negative match, check for exact\n\t * match of filename with leading '!'\n\t */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_NEGATIVE) != 0 &&\n\t\t*path == '!' &&\n\t\tctxt->strncomp(path + 1, match->pattern, match->length) == 0 &&\n\t\t(!path[match->length + 1] || path[match->length + 1] == '/'))\n\t\treturn 1;\n\n\tif (result == 0)\n\t\treturn (match->flags & GIT_ATTR_FNMATCH_NEGATIVE) ? 0 : 1;\n\treturn -1;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_match_one(\n\tconst git_attr_fnmatch *match,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path)\n{\n\tint result = (match->flags & GIT_ATTR_FNMATCH_MATCH_ALL) ? 0 : FNM_NOMATCH;\n\n\tif (result == FNM_NOMATCH)\n\t\tresult = ctxt->strcomp(match->pattern, path) ? FNM_NOMATCH : 0;\n\n\tif (ctxt->fnmatch_flags >= 0 && result == FNM_NOMATCH)\n\t\tresult = p_fnmatch(match->pattern, path, ctxt->fnmatch_flags);\n\n\t/* if we didn't match, look for exact dirname prefix match */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_HASWILD) == 0 &&\n\t\tctxt->strncomp(path, match->pattern, match->length) == 0 &&\n\t\tpath[match->length] == '/')\n\t\tresult = 0;\n\n\t/* if we didn't match and this is a negative match, check for exact\n\t * match of filename with leading '!'\n\t */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_NEGATIVE) != 0 &&\n\t\t*path == '!' &&\n\t\tctxt->strncomp(path + 1, match->pattern, match->length) == 0 &&\n\t\t(!path[match->length + 1] || path[match->length + 1] == '/'))\n\t\treturn 1;\n\n\tif (result == 0)\n\t\treturn (match->flags & GIT_ATTR_FNMATCH_NEGATIVE) ? 0 : 1;\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "vspec",
            "i",
            "match"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int git_pathspec__match_at(\n\tsize_t *matched_at,\n\tconst git_vector *vspec,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path0,\n\tconst char *path1)\n{\n\tint result = GIT_ENOTFOUND;\n\tsize_t i = 0;\n\tconst git_attr_fnmatch *match;\n\n\tgit_vector_foreach(vspec, i, match) {\n\t\tif (path0 && (result = pathspec_match_one(match, ctxt, path0)) >= 0)\n\t\t\tbreak;\n\t\tif (path1 && (result = pathspec_match_one(match, ctxt, path1)) >= 0)\n\t\t\tbreak;\n\t}\n\n\t*matched_at = i;\n\treturn result;\n}"
  },
  {
    "function_name": "pathspec_match_one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "138-171",
    "snippet": "static int pathspec_match_one(\n\tconst git_attr_fnmatch *match,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path)\n{\n\tint result = (match->flags & GIT_ATTR_FNMATCH_MATCH_ALL) ? 0 : FNM_NOMATCH;\n\n\tif (result == FNM_NOMATCH)\n\t\tresult = ctxt->strcomp(match->pattern, path) ? FNM_NOMATCH : 0;\n\n\tif (ctxt->fnmatch_flags >= 0 && result == FNM_NOMATCH)\n\t\tresult = p_fnmatch(match->pattern, path, ctxt->fnmatch_flags);\n\n\t/* if we didn't match, look for exact dirname prefix match */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_HASWILD) == 0 &&\n\t\tctxt->strncomp(path, match->pattern, match->length) == 0 &&\n\t\tpath[match->length] == '/')\n\t\tresult = 0;\n\n\t/* if we didn't match and this is a negative match, check for exact\n\t * match of filename with leading '!'\n\t */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_NEGATIVE) != 0 &&\n\t\t*path == '!' &&\n\t\tctxt->strncomp(path + 1, match->pattern, match->length) == 0 &&\n\t\t(!path[match->length + 1] || path[match->length + 1] == '/'))\n\t\treturn 1;\n\n\tif (result == 0)\n\t\treturn (match->flags & GIT_ATTR_FNMATCH_NEGATIVE) ? 0 : 1;\n\treturn -1;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ctxt->strncomp",
          "args": [
            "path + 1",
            "match->pattern",
            "match->length"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctxt->strncomp",
          "args": [
            "path",
            "match->pattern",
            "match->length"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_fnmatch",
          "args": [
            "match->pattern",
            "path",
            "ctxt->fnmatch_flags"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "p_fnmatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fnmatch.c",
          "lines": "230-234",
          "snippet": "int\np_fnmatch(const char *pattern, const char *string, int flags)\n{\n\t\treturn p_fnmatchx(pattern, string, flags, 64);\n}",
          "includes": [
            "#include \"fnmatch.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fnmatch.h\"\n#include <string.h>\n#include <stdio.h>\n#include <ctype.h>\n\nint\np_fnmatch(const char *pattern, const char *string, int flags)\n{\n\t\treturn p_fnmatchx(pattern, string, flags, 64);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctxt->strcomp",
          "args": [
            "match->pattern",
            "path"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic int pathspec_match_one(\n\tconst git_attr_fnmatch *match,\n\tstruct pathspec_match_context *ctxt,\n\tconst char *path)\n{\n\tint result = (match->flags & GIT_ATTR_FNMATCH_MATCH_ALL) ? 0 : FNM_NOMATCH;\n\n\tif (result == FNM_NOMATCH)\n\t\tresult = ctxt->strcomp(match->pattern, path) ? FNM_NOMATCH : 0;\n\n\tif (ctxt->fnmatch_flags >= 0 && result == FNM_NOMATCH)\n\t\tresult = p_fnmatch(match->pattern, path, ctxt->fnmatch_flags);\n\n\t/* if we didn't match, look for exact dirname prefix match */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_HASWILD) == 0 &&\n\t\tctxt->strncomp(path, match->pattern, match->length) == 0 &&\n\t\tpath[match->length] == '/')\n\t\tresult = 0;\n\n\t/* if we didn't match and this is a negative match, check for exact\n\t * match of filename with leading '!'\n\t */\n\tif (result == FNM_NOMATCH &&\n\t\t(match->flags & GIT_ATTR_FNMATCH_NEGATIVE) != 0 &&\n\t\t*path == '!' &&\n\t\tctxt->strncomp(path + 1, match->pattern, match->length) == 0 &&\n\t\t(!path[match->length + 1] || path[match->length + 1] == '/'))\n\t\treturn 1;\n\n\tif (result == 0)\n\t\treturn (match->flags & GIT_ATTR_FNMATCH_NEGATIVE) ? 0 : 1;\n\treturn -1;\n}"
  },
  {
    "function_name": "pathspec_match_context_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "117-136",
    "snippet": "static void pathspec_match_context_init(\n\tstruct pathspec_match_context *ctxt,\n\tbool disable_fnmatch,\n\tbool casefold)\n{\n\tif (disable_fnmatch)\n\t\tctxt->fnmatch_flags = -1;\n\telse if (casefold)\n\t\tctxt->fnmatch_flags = FNM_CASEFOLD;\n\telse\n\t\tctxt->fnmatch_flags = 0;\n\n\tif (casefold) {\n\t\tctxt->strcomp  = git__strcasecmp;\n\t\tctxt->strncomp = git__strncasecmp;\n\t} else {\n\t\tctxt->strcomp  = git__strcmp;\n\t\tctxt->strncomp = git__strncmp;\n\t}\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nstatic void pathspec_match_context_init(\n\tstruct pathspec_match_context *ctxt,\n\tbool disable_fnmatch,\n\tbool casefold)\n{\n\tif (disable_fnmatch)\n\t\tctxt->fnmatch_flags = -1;\n\telse if (casefold)\n\t\tctxt->fnmatch_flags = FNM_CASEFOLD;\n\telse\n\t\tctxt->fnmatch_flags = 0;\n\n\tif (casefold) {\n\t\tctxt->strcomp  = git__strcasecmp;\n\t\tctxt->strncomp = git__strncasecmp;\n\t} else {\n\t\tctxt->strcomp  = git__strcmp;\n\t\tctxt->strncomp = git__strncmp;\n\t}\n}"
  },
  {
    "function_name": "git_pathspec__vfree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "106-109",
    "snippet": "void git_pathspec__vfree(git_vector *vspec)\n{\n\tgit_vector_free_deep(vspec);\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_free_deep",
          "args": [
            "vspec"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nvoid git_pathspec__vfree(git_vector *vspec)\n{\n\tgit_vector_free_deep(vspec);\n}"
  },
  {
    "function_name": "git_pathspec__vinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "66-103",
    "snippet": "int git_pathspec__vinit(\n\tgit_vector *vspec, const git_strarray *strspec, git_pool *strpool)\n{\n\tsize_t i;\n\n\tmemset(vspec, 0, sizeof(*vspec));\n\n\tif (git_pathspec_is_empty(strspec))\n\t\treturn 0;\n\n\tif (git_vector_init(vspec, strspec->count, NULL) < 0)\n\t\treturn -1;\n\n\tfor (i = 0; i < strspec->count; ++i) {\n\t\tint ret;\n\t\tconst char *pattern = strspec->strings[i];\n\t\tgit_attr_fnmatch *match = git__calloc(1, sizeof(git_attr_fnmatch));\n\t\tif (!match)\n\t\t\treturn -1;\n\n\t\tmatch->flags = GIT_ATTR_FNMATCH_ALLOWSPACE |\n\t\t\tGIT_ATTR_FNMATCH_ALLOWNEG | GIT_ATTR_FNMATCH_NOLEADINGDIR;\n\n\t\tret = git_attr_fnmatch__parse(match, strpool, NULL, &pattern);\n\t\tif (ret == GIT_ENOTFOUND) {\n\t\t\tgit__free(match);\n\t\t\tcontinue;\n\t\t} else if (ret < 0) {\n\t\t\tgit__free(match);\n\t\t\treturn ret;\n\t\t}\n\n\t\tif (git_vector_insert(vspec, match) < 0)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "vspec",
            "match"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "match"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_attr_fnmatch__parse",
          "args": [
            "match",
            "strpool",
            "NULL",
            "&pattern"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_fnmatch__parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr_file.c",
          "lines": "552-663",
          "snippet": "int git_attr_fnmatch__parse(\n\tgit_attr_fnmatch *spec,\n\tgit_pool *pool,\n\tconst char *context,\n\tconst char **base)\n{\n\tconst char *pattern, *scan;\n\tint slash_count, allow_space;\n\n\tassert(spec && base && *base);\n\n\tif (parse_optimized_patterns(spec, pool, *base))\n\t\treturn 0;\n\n\tspec->flags = (spec->flags & GIT_ATTR_FNMATCH__INCOMING);\n\tallow_space = ((spec->flags & GIT_ATTR_FNMATCH_ALLOWSPACE) != 0);\n\n\tpattern = *base;\n\n\twhile (git__isspace(*pattern)) pattern++;\n\tif (!*pattern || *pattern == '#') {\n\t\t*base = git__next_line(pattern);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (*pattern == '[' && (spec->flags & GIT_ATTR_FNMATCH_ALLOWMACRO) != 0) {\n\t\tif (strncmp(pattern, \"[attr]\", 6) == 0) {\n\t\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_MACRO;\n\t\t\tpattern += 6;\n\t\t}\n\t\t/* else a character range like [a-e]* which is accepted */\n\t}\n\n\tif (*pattern == '!' && (spec->flags & GIT_ATTR_FNMATCH_ALLOWNEG) != 0) {\n\t\tspec->flags = spec->flags |\n\t\t\tGIT_ATTR_FNMATCH_NEGATIVE | GIT_ATTR_FNMATCH_LEADINGDIR;\n\t\tpattern++;\n\t}\n\n\tslash_count = 0;\n\tfor (scan = pattern; *scan != '\\0'; ++scan) {\n\t\t/* scan until (non-escaped) white space */\n\t\tif (git__isspace(*scan) && *(scan - 1) != '\\\\') {\n\t\t\tif (!allow_space || (*scan != ' ' && *scan != '\\t' && *scan != '\\r'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (*scan == '/') {\n\t\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_FULLPATH;\n\t\t\tslash_count++;\n\t\t\tif (pattern == scan)\n\t\t\t\tpattern++;\n\t\t}\n\t\t/* remember if we see an unescaped wildcard in pattern */\n\t\telse if (git__iswildcard(*scan) &&\n\t\t\t(scan == pattern || (*(scan - 1) != '\\\\')))\n\t\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_HASWILD;\n\t}\n\n\t*base = scan;\n\n\tif ((spec->length = scan - pattern) == 0)\n\t\treturn GIT_ENOTFOUND;\n\n\t/*\n\t * Remove one trailing \\r in case this is a CRLF delimited\n\t * file, in the case of Icon\\r\\r\\n, we still leave the first\n\t * \\r there to match against.\n\t */\n\tif (pattern[spec->length - 1] == '\\r')\n\t\tif (--spec->length == 0)\n\t\t\treturn GIT_ENOTFOUND;\n\n\tif (pattern[spec->length - 1] == '/') {\n\t\tspec->length--;\n\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_DIRECTORY;\n\t\tif (--slash_count <= 0)\n\t\t\tspec->flags = spec->flags & ~GIT_ATTR_FNMATCH_FULLPATH;\n\t}\n\tif ((spec->flags & GIT_ATTR_FNMATCH_NOLEADINGDIR) == 0 &&\n\t\tspec->length >= 2 &&\n\t\tpattern[spec->length - 1] == '*' &&\n\t\tpattern[spec->length - 2] == '/') {\n\t\tspec->length -= 2;\n\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_LEADINGDIR;\n\t\t/* leave FULLPATH match on, however */\n\t}\n\n\tif (context) {\n\t\tchar *slash = strrchr(context, '/');\n\t\tsize_t len;\n\t\tif (slash) {\n\t\t\t/* include the slash for easier matching */\n\t\t\tlen = slash - context + 1;\n\t\t\tspec->containing_dir = git_pool_strndup(pool, context, len);\n\t\t\tspec->containing_dir_length = len;\n\t\t}\n\t}\n\n\tspec->pattern = git_pool_strndup(pool, pattern, spec->length);\n\n\tif (!spec->pattern) {\n\t\t*base = git__next_line(pattern);\n\t\treturn -1;\n\t} else {\n\t\t/* strip '\\' that might have be used for internal whitespace */\n\t\tspec->length = git__unescape(spec->pattern);\n\t\t/* TODO: convert remaining '\\' into '/' for POSIX ??? */\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/blob.h\"",
            "#include \"attrcache.h\"",
            "#include \"attr_file.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool parse_optimized_patterns(\n\tgit_attr_fnmatch *spec,\n\tgit_pool *pool,\n\tconst char *pattern);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"index.h\"\n#include \"git2/tree.h\"\n#include \"git2/blob.h\"\n#include \"attrcache.h\"\n#include \"attr_file.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic bool parse_optimized_patterns(\n\tgit_attr_fnmatch *spec,\n\tgit_pool *pool,\n\tconst char *pattern);\n\nint git_attr_fnmatch__parse(\n\tgit_attr_fnmatch *spec,\n\tgit_pool *pool,\n\tconst char *context,\n\tconst char **base)\n{\n\tconst char *pattern, *scan;\n\tint slash_count, allow_space;\n\n\tassert(spec && base && *base);\n\n\tif (parse_optimized_patterns(spec, pool, *base))\n\t\treturn 0;\n\n\tspec->flags = (spec->flags & GIT_ATTR_FNMATCH__INCOMING);\n\tallow_space = ((spec->flags & GIT_ATTR_FNMATCH_ALLOWSPACE) != 0);\n\n\tpattern = *base;\n\n\twhile (git__isspace(*pattern)) pattern++;\n\tif (!*pattern || *pattern == '#') {\n\t\t*base = git__next_line(pattern);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (*pattern == '[' && (spec->flags & GIT_ATTR_FNMATCH_ALLOWMACRO) != 0) {\n\t\tif (strncmp(pattern, \"[attr]\", 6) == 0) {\n\t\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_MACRO;\n\t\t\tpattern += 6;\n\t\t}\n\t\t/* else a character range like [a-e]* which is accepted */\n\t}\n\n\tif (*pattern == '!' && (spec->flags & GIT_ATTR_FNMATCH_ALLOWNEG) != 0) {\n\t\tspec->flags = spec->flags |\n\t\t\tGIT_ATTR_FNMATCH_NEGATIVE | GIT_ATTR_FNMATCH_LEADINGDIR;\n\t\tpattern++;\n\t}\n\n\tslash_count = 0;\n\tfor (scan = pattern; *scan != '\\0'; ++scan) {\n\t\t/* scan until (non-escaped) white space */\n\t\tif (git__isspace(*scan) && *(scan - 1) != '\\\\') {\n\t\t\tif (!allow_space || (*scan != ' ' && *scan != '\\t' && *scan != '\\r'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (*scan == '/') {\n\t\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_FULLPATH;\n\t\t\tslash_count++;\n\t\t\tif (pattern == scan)\n\t\t\t\tpattern++;\n\t\t}\n\t\t/* remember if we see an unescaped wildcard in pattern */\n\t\telse if (git__iswildcard(*scan) &&\n\t\t\t(scan == pattern || (*(scan - 1) != '\\\\')))\n\t\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_HASWILD;\n\t}\n\n\t*base = scan;\n\n\tif ((spec->length = scan - pattern) == 0)\n\t\treturn GIT_ENOTFOUND;\n\n\t/*\n\t * Remove one trailing \\r in case this is a CRLF delimited\n\t * file, in the case of Icon\\r\\r\\n, we still leave the first\n\t * \\r there to match against.\n\t */\n\tif (pattern[spec->length - 1] == '\\r')\n\t\tif (--spec->length == 0)\n\t\t\treturn GIT_ENOTFOUND;\n\n\tif (pattern[spec->length - 1] == '/') {\n\t\tspec->length--;\n\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_DIRECTORY;\n\t\tif (--slash_count <= 0)\n\t\t\tspec->flags = spec->flags & ~GIT_ATTR_FNMATCH_FULLPATH;\n\t}\n\tif ((spec->flags & GIT_ATTR_FNMATCH_NOLEADINGDIR) == 0 &&\n\t\tspec->length >= 2 &&\n\t\tpattern[spec->length - 1] == '*' &&\n\t\tpattern[spec->length - 2] == '/') {\n\t\tspec->length -= 2;\n\t\tspec->flags = spec->flags | GIT_ATTR_FNMATCH_LEADINGDIR;\n\t\t/* leave FULLPATH match on, however */\n\t}\n\n\tif (context) {\n\t\tchar *slash = strrchr(context, '/');\n\t\tsize_t len;\n\t\tif (slash) {\n\t\t\t/* include the slash for easier matching */\n\t\t\tlen = slash - context + 1;\n\t\t\tspec->containing_dir = git_pool_strndup(pool, context, len);\n\t\t\tspec->containing_dir_length = len;\n\t\t}\n\t}\n\n\tspec->pattern = git_pool_strndup(pool, pattern, spec->length);\n\n\tif (!spec->pattern) {\n\t\t*base = git__next_line(pattern);\n\t\treturn -1;\n\t} else {\n\t\t/* strip '\\' that might have be used for internal whitespace */\n\t\tspec->length = git__unescape(spec->pattern);\n\t\t/* TODO: convert remaining '\\' into '/' for POSIX ??? */\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_attr_fnmatch)"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "vspec",
            "strspec->count",
            "NULL"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pathspec_is_empty",
          "args": [
            "strspec"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "git_pathspec_is_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
          "lines": "48-63",
          "snippet": "bool git_pathspec_is_empty(const git_strarray *pathspec)\n{\n\tsize_t i;\n\n\tif (pathspec == NULL)\n\t\treturn true;\n\n\tfor (i = 0; i < pathspec->count; ++i) {\n\t\tconst char *str = pathspec->strings[i];\n\n\t\tif (str && str[0])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"bitvec.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"iterator.h\"",
            "#include \"attr_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"pathspec.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/pathspec.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nbool git_pathspec_is_empty(const git_strarray *pathspec)\n{\n\tsize_t i;\n\n\tif (pathspec == NULL)\n\t\treturn true;\n\n\tfor (i = 0; i < pathspec->count; ++i) {\n\t\tconst char *str = pathspec->strings[i];\n\n\t\tif (str && str[0])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "vspec",
            "0",
            "sizeof(*vspec)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nint git_pathspec__vinit(\n\tgit_vector *vspec, const git_strarray *strspec, git_pool *strpool)\n{\n\tsize_t i;\n\n\tmemset(vspec, 0, sizeof(*vspec));\n\n\tif (git_pathspec_is_empty(strspec))\n\t\treturn 0;\n\n\tif (git_vector_init(vspec, strspec->count, NULL) < 0)\n\t\treturn -1;\n\n\tfor (i = 0; i < strspec->count; ++i) {\n\t\tint ret;\n\t\tconst char *pattern = strspec->strings[i];\n\t\tgit_attr_fnmatch *match = git__calloc(1, sizeof(git_attr_fnmatch));\n\t\tif (!match)\n\t\t\treturn -1;\n\n\t\tmatch->flags = GIT_ATTR_FNMATCH_ALLOWSPACE |\n\t\t\tGIT_ATTR_FNMATCH_ALLOWNEG | GIT_ATTR_FNMATCH_NOLEADINGDIR;\n\n\t\tret = git_attr_fnmatch__parse(match, strpool, NULL, &pattern);\n\t\tif (ret == GIT_ENOTFOUND) {\n\t\t\tgit__free(match);\n\t\t\tcontinue;\n\t\t} else if (ret < 0) {\n\t\t\tgit__free(match);\n\t\t\treturn ret;\n\t\t}\n\n\t\tif (git_vector_insert(vspec, match) < 0)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_pathspec_is_empty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "48-63",
    "snippet": "bool git_pathspec_is_empty(const git_strarray *pathspec)\n{\n\tsize_t i;\n\n\tif (pathspec == NULL)\n\t\treturn true;\n\n\tfor (i = 0; i < pathspec->count; ++i) {\n\t\tconst char *str = pathspec->strings[i];\n\n\t\tif (str && str[0])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nbool git_pathspec_is_empty(const git_strarray *pathspec)\n{\n\tsize_t i;\n\n\tif (pathspec == NULL)\n\t\treturn true;\n\n\tfor (i = 0; i < pathspec->count; ++i) {\n\t\tconst char *str = pathspec->strings[i];\n\n\t\tif (str && str[0])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "git_pathspec_prefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pathspec.c",
    "lines": "20-45",
    "snippet": "char *git_pathspec_prefix(const git_strarray *pathspec)\n{\n\tgit_buf prefix = GIT_BUF_INIT;\n\tconst char *scan;\n\n\tif (!pathspec || !pathspec->count ||\n\t\tgit_buf_text_common_prefix(&prefix, pathspec) < 0)\n\t\treturn NULL;\n\n\t/* diff prefix will only be leading non-wildcards */\n\tfor (scan = prefix.ptr; *scan; ++scan) {\n\t\tif (git__iswildcard(*scan) &&\n\t\t\t(scan == prefix.ptr || (*(scan - 1) != '\\\\')))\n\t\t\tbreak;\n\t}\n\tgit_buf_truncate(&prefix, scan - prefix.ptr);\n\n\tif (prefix.size <= 0) {\n\t\tgit_buf_free(&prefix);\n\t\treturn NULL;\n\t}\n\n\tgit_buf_text_unescape(&prefix);\n\n\treturn git_buf_detach(&prefix);\n}",
    "includes": [
      "#include \"diff.h\"",
      "#include \"bitvec.h\"",
      "#include \"index.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"attr_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"pathspec.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/pathspec.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&prefix"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_text_unescape",
          "args": [
            "&prefix"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_text_unescape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buf_text.c",
          "lines": "59-62",
          "snippet": "void git_buf_text_unescape(git_buf *buf)\n{\n\tbuf->size = git__unescape(buf->ptr);\n}",
          "includes": [
            "#include \"buf_text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n\nvoid git_buf_text_unescape(git_buf *buf)\n{\n\tbuf->size = git__unescape(buf->ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&prefix"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_truncate",
          "args": [
            "&prefix",
            "scan - prefix.ptr"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "446-454",
          "snippet": "void git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__iswildcard",
          "args": [
            "*scan"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "git__iswildcard",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "464-467",
          "snippet": "GIT_INLINE(bool) git__iswildcard(int c)\n{\n\treturn (c == '*' || c == '?' || c == '[');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__iswildcard(int c)\n{\n\treturn (c == '*' || c == '?' || c == '[');\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_text_common_prefix",
          "args": [
            "&prefix",
            "pathspec"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_text_common_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buf_text.c",
          "lines": "155-183",
          "snippet": "int git_buf_text_common_prefix(git_buf *buf, const git_strarray *strings)\n{\n\tsize_t i;\n\tconst char *str, *pfx;\n\n\tgit_buf_clear(buf);\n\n\tif (!strings || !strings->count)\n\t\treturn 0;\n\n\t/* initialize common prefix to first string */\n\tif (git_buf_sets(buf, strings->strings[0]) < 0)\n\t\treturn -1;\n\n\t/* go through the rest of the strings, truncating to shared prefix */\n\tfor (i = 1; i < strings->count; ++i) {\n\n\t\tfor (str = strings->strings[i], pfx = buf->ptr;\n\t\t\t *str && *str == *pfx; str++, pfx++)\n\t\t\t/* scanning */;\n\n\t\tgit_buf_truncate(buf, pfx - buf->ptr);\n\n\t\tif (!buf->size)\n\t\t\tbreak;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"buf_text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n\nint git_buf_text_common_prefix(git_buf *buf, const git_strarray *strings)\n{\n\tsize_t i;\n\tconst char *str, *pfx;\n\n\tgit_buf_clear(buf);\n\n\tif (!strings || !strings->count)\n\t\treturn 0;\n\n\t/* initialize common prefix to first string */\n\tif (git_buf_sets(buf, strings->strings[0]) < 0)\n\t\treturn -1;\n\n\t/* go through the rest of the strings, truncating to shared prefix */\n\tfor (i = 1; i < strings->count; ++i) {\n\n\t\tfor (str = strings->strings[i], pfx = buf->ptr;\n\t\t\t *str && *str == *pfx; str++, pfx++)\n\t\t\t/* scanning */;\n\n\t\tgit_buf_truncate(buf, pfx - buf->ptr);\n\n\t\tif (!buf->size)\n\t\t\tbreak;\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff.h\"\n#include \"bitvec.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"attr_file.h\"\n#include \"buf_text.h\"\n#include \"pathspec.h\"\n#include \"git2/diff.h\"\n#include \"git2/pathspec.h\"\n\nchar *git_pathspec_prefix(const git_strarray *pathspec)\n{\n\tgit_buf prefix = GIT_BUF_INIT;\n\tconst char *scan;\n\n\tif (!pathspec || !pathspec->count ||\n\t\tgit_buf_text_common_prefix(&prefix, pathspec) < 0)\n\t\treturn NULL;\n\n\t/* diff prefix will only be leading non-wildcards */\n\tfor (scan = prefix.ptr; *scan; ++scan) {\n\t\tif (git__iswildcard(*scan) &&\n\t\t\t(scan == prefix.ptr || (*(scan - 1) != '\\\\')))\n\t\t\tbreak;\n\t}\n\tgit_buf_truncate(&prefix, scan - prefix.ptr);\n\n\tif (prefix.size <= 0) {\n\t\tgit_buf_free(&prefix);\n\t\treturn NULL;\n\t}\n\n\tgit_buf_text_unescape(&prefix);\n\n\treturn git_buf_detach(&prefix);\n}"
  }
]