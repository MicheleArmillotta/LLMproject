[
  {
    "function_name": "git_diff_stats_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "327-335",
    "snippet": "void git_diff_stats_free(git_diff_stats *stats)\n{\n\tif (stats == NULL)\n\t\treturn;\n\n\tgit_diff_free(stats->diff); /* bumped refcount in constructor */\n\tgit__free(stats->filestats);\n\tgit__free(stats);\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "stats"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_free",
          "args": [
            "stats->diff"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "576-582",
          "snippet": "void git_diff_free(git_diff *diff)\n{\n\tif (!diff)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(diff, diff_list_free);\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nvoid git_diff_free(git_diff *diff)\n{\n\tif (!diff)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(diff, diff_list_free);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_diff_stats_free(git_diff_stats *stats)\n{\n\tif (stats == NULL)\n\t\treturn;\n\n\tgit_diff_free(stats->diff); /* bumped refcount in constructor */\n\tgit__free(stats->filestats);\n\tgit__free(stats);\n}"
  },
  {
    "function_name": "git_diff_stats_to_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "256-325",
    "snippet": "int git_diff_stats_to_buf(\n\tgit_buf *out,\n\tconst git_diff_stats *stats,\n\tgit_diff_stats_format_t format,\n\tsize_t width)\n{\n\tint error = 0;\n\tsize_t i;\n\tconst git_diff_delta *delta;\n\n\tassert(out && stats);\n\n\tif (format & GIT_DIFF_STATS_NUMBER) {\n\t\tfor (i = 0; i < stats->files_changed; ++i) {\n\t\t\tif ((delta = git_diff_get_delta(stats->diff, i)) == NULL)\n\t\t\t\tcontinue;\n\n\t\t\terror = git_diff_file_stats__number_to_buf(\n\t\t\t\tout, delta, &stats->filestats[i]);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\tif (format & GIT_DIFF_STATS_FULL) {\n\t\tif (width > 0) {\n\t\t\tif (width > stats->max_name + stats->max_digits + 5)\n\t\t\t\twidth -= (stats->max_name + stats->max_digits + 5);\n\t\t\tif (width < STATS_FULL_MIN_SCALE)\n\t\t\t\twidth = STATS_FULL_MIN_SCALE;\n\t\t}\n\t\tif (width > stats->max_filestat)\n\t\t\twidth = 0;\n\n\t\tfor (i = 0; i < stats->files_changed; ++i) {\n\t\t\tif ((delta = git_diff_get_delta(stats->diff, i)) == NULL)\n\t\t\t\tcontinue;\n\n\t\t\terror = git_diff_file_stats__full_to_buf(\n\t\t\t\tout, delta, &stats->filestats[i], stats, width);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\tif (format & GIT_DIFF_STATS_FULL || format & GIT_DIFF_STATS_SHORT) {\n\t\terror = git_buf_printf(\n\t\t\tout, \" %\" PRIuZ \" file%s changed, %\" PRIuZ\n\t\t\t\" insertion%s(+), %\" PRIuZ \" deletion%s(-)\\n\",\n\t\t\tstats->files_changed, stats->files_changed != 1 ? \"s\" : \"\",\n\t\t\tstats->insertions, stats->insertions != 1 ? \"s\" : \"\",\n\t\t\tstats->deletions, stats->deletions != 1 ? \"s\" : \"\");\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\t}\n\n\tif (format & GIT_DIFF_STATS_INCLUDE_SUMMARY) {\n\t\tfor (i = 0; i < stats->files_changed; ++i) {\n\t\t\tif ((delta = git_diff_get_delta(stats->diff, i)) == NULL)\n\t\t\t\tcontinue;\n\n\t\t\terror = git_diff_file_stats__summary_to_buf(out, delta);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define STATS_FULL_MIN_SCALE 7"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_diff_file_stats__summary_to_buf",
          "args": [
            "out",
            "delta"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_file_stats__summary_to_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
          "lines": "137-157",
          "snippet": "int git_diff_file_stats__summary_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta)\n{\n\tif (delta->old_file.mode != delta->new_file.mode) {\n\t\tif (delta->old_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \" create mode %06o %s\\n\",\n\t\t\t\tdelta->new_file.mode, delta->new_file.path);\n\t\t}\n\t\telse if (delta->new_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \" delete mode %06o %s\\n\",\n\t\t\t\tdelta->old_file.mode, delta->old_file.path);\n\t\t}\n\t\telse {\n\t\t\tgit_buf_printf(out, \" mode change %06o => %06o %s\\n\",\n\t\t\t\tdelta->old_file.mode, delta->new_file.mode, delta->new_file.path);\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nint git_diff_file_stats__summary_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta)\n{\n\tif (delta->old_file.mode != delta->new_file.mode) {\n\t\tif (delta->old_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \" create mode %06o %s\\n\",\n\t\t\t\tdelta->new_file.mode, delta->new_file.path);\n\t\t}\n\t\telse if (delta->new_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \" delete mode %06o %s\\n\",\n\t\t\t\tdelta->old_file.mode, delta->old_file.path);\n\t\t}\n\t\telse {\n\t\t\tgit_buf_printf(out, \" mode change %06o => %06o %s\\n\",\n\t\t\t\tdelta->old_file.mode, delta->new_file.mode, delta->new_file.path);\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_get_delta",
          "args": [
            "stats->diff",
            "i"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_get_delta",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "1506-1510",
          "snippet": "const git_diff_delta *git_diff_get_delta(const git_diff *diff, size_t idx)\n{\n\tassert(diff);\n\treturn git_vector_get(&diff->deltas, idx);\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nconst git_diff_delta *git_diff_get_delta(const git_diff *diff, size_t idx)\n{\n\tassert(diff);\n\treturn git_vector_get(&diff->deltas, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "out",
            "\" %\" PRIuZ \" file%s changed, %\" PRIuZ\n\t\t\t\" insertion%s(+), %\" PRIuZ \" deletion%s(-)\\n\"",
            "stats->files_changed",
            "stats->files_changed != 1 ? \"s\" : \"\"",
            "stats->insertions",
            "stats->insertions != 1 ? \"s\" : \"\"",
            "stats->deletions",
            "stats->deletions != 1 ? \"s\" : \"\""
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_file_stats__full_to_buf",
          "args": [
            "out",
            "delta",
            "&stats->filestats[i]",
            "stats",
            "width"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_file_stats__full_to_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
          "lines": "47-118",
          "snippet": "int git_diff_file_stats__full_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst diff_file_stats *filestat,\n\tconst git_diff_stats *stats,\n\tsize_t width)\n{\n\tconst char *old_path = NULL, *new_path = NULL;\n\tsize_t padding, old_size, new_size;\n\n\told_path = delta->old_file.path;\n\tnew_path = delta->new_file.path;\n\told_size = delta->old_file.size;\n\tnew_size = delta->new_file.size;\n\n\tif (git_buf_printf(out, \" %s\", old_path) < 0)\n\t\tgoto on_error;\n\n\tif (strcmp(old_path, new_path) != 0) {\n\t\tpadding = stats->max_name - strlen(old_path) - strlen(new_path);\n\n\t\tif (git_buf_printf(out, DIFF_RENAME_FILE_SEPARATOR \"%s\", new_path) < 0)\n\t\t\tgoto on_error;\n\t} else {\n\t\tpadding = stats->max_name - strlen(old_path);\n\n\t\tif (stats->renames > 0)\n\t\t\tpadding += strlen(DIFF_RENAME_FILE_SEPARATOR);\n\t}\n\n\tif (git_buf_putcn(out, ' ', padding) < 0 ||\n\t\tgit_buf_puts(out, \" | \") < 0)\n\t\tgoto on_error;\n\n\tif (delta->flags & GIT_DIFF_FLAG_BINARY) {\n\t\tif (git_buf_printf(out,\n\t\t\t\t\"Bin %\" PRIuZ \" -> %\" PRIuZ \" bytes\", old_size, new_size) < 0)\n\t\t\tgoto on_error;\n\t}\n\telse {\n\t\tif (git_buf_printf(out,\n\t\t\t\t\"%*\" PRIuZ, stats->max_digits,\n\t\t\t\tfilestat->insertions + filestat->deletions) < 0)\n\t\t\tgoto on_error;\n\n\t\tif (filestat->insertions || filestat->deletions) {\n\t\t\tif (git_buf_putc(out, ' ') < 0)\n\t\t\t\tgoto on_error;\n\n\t\t\tif (!width) {\n\t\t\t\tif (git_buf_putcn(out, '+', filestat->insertions) < 0 ||\n\t\t\t\t\tgit_buf_putcn(out, '-', filestat->deletions) < 0)\n\t\t\t\t\tgoto on_error;\n\t\t\t} else {\n\t\t\t\tsize_t total = filestat->insertions + filestat->deletions;\n\t\t\t\tsize_t full = (total * width + stats->max_filestat / 2) /\n\t\t\t\t\tstats->max_filestat;\n\t\t\t\tsize_t plus = full * filestat->insertions / total;\n\t\t\t\tsize_t minus = full - plus;\n\n\t\t\t\tif (git_buf_putcn(out, '+', max(plus,  1)) < 0 ||\n\t\t\t\t\tgit_buf_putcn(out, '-', max(minus, 1)) < 0)\n\t\t\t\t\tgoto on_error;\n\t\t\t}\n\t\t}\n\t}\n\n\tgit_buf_putc(out, '\\n');\n\non_error:\n\treturn (git_buf_oom(out) ? -1 : 0);\n}",
          "includes": [
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define DIFF_RENAME_FILE_SEPARATOR \" => \""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\n#define DIFF_RENAME_FILE_SEPARATOR \" => \"\n\nint git_diff_file_stats__full_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst diff_file_stats *filestat,\n\tconst git_diff_stats *stats,\n\tsize_t width)\n{\n\tconst char *old_path = NULL, *new_path = NULL;\n\tsize_t padding, old_size, new_size;\n\n\told_path = delta->old_file.path;\n\tnew_path = delta->new_file.path;\n\told_size = delta->old_file.size;\n\tnew_size = delta->new_file.size;\n\n\tif (git_buf_printf(out, \" %s\", old_path) < 0)\n\t\tgoto on_error;\n\n\tif (strcmp(old_path, new_path) != 0) {\n\t\tpadding = stats->max_name - strlen(old_path) - strlen(new_path);\n\n\t\tif (git_buf_printf(out, DIFF_RENAME_FILE_SEPARATOR \"%s\", new_path) < 0)\n\t\t\tgoto on_error;\n\t} else {\n\t\tpadding = stats->max_name - strlen(old_path);\n\n\t\tif (stats->renames > 0)\n\t\t\tpadding += strlen(DIFF_RENAME_FILE_SEPARATOR);\n\t}\n\n\tif (git_buf_putcn(out, ' ', padding) < 0 ||\n\t\tgit_buf_puts(out, \" | \") < 0)\n\t\tgoto on_error;\n\n\tif (delta->flags & GIT_DIFF_FLAG_BINARY) {\n\t\tif (git_buf_printf(out,\n\t\t\t\t\"Bin %\" PRIuZ \" -> %\" PRIuZ \" bytes\", old_size, new_size) < 0)\n\t\t\tgoto on_error;\n\t}\n\telse {\n\t\tif (git_buf_printf(out,\n\t\t\t\t\"%*\" PRIuZ, stats->max_digits,\n\t\t\t\tfilestat->insertions + filestat->deletions) < 0)\n\t\t\tgoto on_error;\n\n\t\tif (filestat->insertions || filestat->deletions) {\n\t\t\tif (git_buf_putc(out, ' ') < 0)\n\t\t\t\tgoto on_error;\n\n\t\t\tif (!width) {\n\t\t\t\tif (git_buf_putcn(out, '+', filestat->insertions) < 0 ||\n\t\t\t\t\tgit_buf_putcn(out, '-', filestat->deletions) < 0)\n\t\t\t\t\tgoto on_error;\n\t\t\t} else {\n\t\t\t\tsize_t total = filestat->insertions + filestat->deletions;\n\t\t\t\tsize_t full = (total * width + stats->max_filestat / 2) /\n\t\t\t\t\tstats->max_filestat;\n\t\t\t\tsize_t plus = full * filestat->insertions / total;\n\t\t\t\tsize_t minus = full - plus;\n\n\t\t\t\tif (git_buf_putcn(out, '+', max(plus,  1)) < 0 ||\n\t\t\t\t\tgit_buf_putcn(out, '-', max(minus, 1)) < 0)\n\t\t\t\t\tgoto on_error;\n\t\t\t}\n\t\t}\n\t}\n\n\tgit_buf_putc(out, '\\n');\n\non_error:\n\treturn (git_buf_oom(out) ? -1 : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_file_stats__number_to_buf",
          "args": [
            "out",
            "delta",
            "&stats->filestats[i]"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_file_stats__number_to_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
          "lines": "120-135",
          "snippet": "int git_diff_file_stats__number_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst diff_file_stats *filestats)\n{\n\tint error;\n\tconst char *path = delta->new_file.path;\n\n\tif (delta->flags & GIT_DIFF_FLAG_BINARY)\n\t\terror = git_buf_printf(out, \"%-8c\" \"%-8c\" \"%s\\n\", '-', '-', path);\n\telse\n\t\terror = git_buf_printf(out, \"%-8\" PRIuZ \"%-8\" PRIuZ \"%s\\n\",\n\t\t\tfilestats->insertions, filestats->deletions, path);\n\n\treturn error;\n}",
          "includes": [
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nint git_diff_file_stats__number_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst diff_file_stats *filestats)\n{\n\tint error;\n\tconst char *path = delta->new_file.path;\n\n\tif (delta->flags & GIT_DIFF_FLAG_BINARY)\n\t\terror = git_buf_printf(out, \"%-8c\" \"%-8c\" \"%s\\n\", '-', '-', path);\n\telse\n\t\terror = git_buf_printf(out, \"%-8\" PRIuZ \"%-8\" PRIuZ \"%s\\n\",\n\t\t\tfilestats->insertions, filestats->deletions, path);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && stats"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\n#define STATS_FULL_MIN_SCALE 7\n\nint git_diff_stats_to_buf(\n\tgit_buf *out,\n\tconst git_diff_stats *stats,\n\tgit_diff_stats_format_t format,\n\tsize_t width)\n{\n\tint error = 0;\n\tsize_t i;\n\tconst git_diff_delta *delta;\n\n\tassert(out && stats);\n\n\tif (format & GIT_DIFF_STATS_NUMBER) {\n\t\tfor (i = 0; i < stats->files_changed; ++i) {\n\t\t\tif ((delta = git_diff_get_delta(stats->diff, i)) == NULL)\n\t\t\t\tcontinue;\n\n\t\t\terror = git_diff_file_stats__number_to_buf(\n\t\t\t\tout, delta, &stats->filestats[i]);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\tif (format & GIT_DIFF_STATS_FULL) {\n\t\tif (width > 0) {\n\t\t\tif (width > stats->max_name + stats->max_digits + 5)\n\t\t\t\twidth -= (stats->max_name + stats->max_digits + 5);\n\t\t\tif (width < STATS_FULL_MIN_SCALE)\n\t\t\t\twidth = STATS_FULL_MIN_SCALE;\n\t\t}\n\t\tif (width > stats->max_filestat)\n\t\t\twidth = 0;\n\n\t\tfor (i = 0; i < stats->files_changed; ++i) {\n\t\t\tif ((delta = git_diff_get_delta(stats->diff, i)) == NULL)\n\t\t\t\tcontinue;\n\n\t\t\terror = git_diff_file_stats__full_to_buf(\n\t\t\t\tout, delta, &stats->filestats[i], stats, width);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\tif (format & GIT_DIFF_STATS_FULL || format & GIT_DIFF_STATS_SHORT) {\n\t\terror = git_buf_printf(\n\t\t\tout, \" %\" PRIuZ \" file%s changed, %\" PRIuZ\n\t\t\t\" insertion%s(+), %\" PRIuZ \" deletion%s(-)\\n\",\n\t\t\tstats->files_changed, stats->files_changed != 1 ? \"s\" : \"\",\n\t\t\tstats->insertions, stats->insertions != 1 ? \"s\" : \"\",\n\t\t\tstats->deletions, stats->deletions != 1 ? \"s\" : \"\");\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\t}\n\n\tif (format & GIT_DIFF_STATS_INCLUDE_SUMMARY) {\n\t\tfor (i = 0; i < stats->files_changed; ++i) {\n\t\t\tif ((delta = git_diff_get_delta(stats->diff, i)) == NULL)\n\t\t\t\tcontinue;\n\n\t\t\terror = git_diff_file_stats__summary_to_buf(out, delta);\n\t\t\tif (error < 0)\n\t\t\t\treturn error;\n\t\t}\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_diff_stats_deletions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "248-254",
    "snippet": "size_t git_diff_stats_deletions(\n\tconst git_diff_stats *stats)\n{\n\tassert(stats);\n\n\treturn stats->deletions;\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "stats"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nsize_t git_diff_stats_deletions(\n\tconst git_diff_stats *stats)\n{\n\tassert(stats);\n\n\treturn stats->deletions;\n}"
  },
  {
    "function_name": "git_diff_stats_insertions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "240-246",
    "snippet": "size_t git_diff_stats_insertions(\n\tconst git_diff_stats *stats)\n{\n\tassert(stats);\n\n\treturn stats->insertions;\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "stats"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nsize_t git_diff_stats_insertions(\n\tconst git_diff_stats *stats)\n{\n\tassert(stats);\n\n\treturn stats->insertions;\n}"
  },
  {
    "function_name": "git_diff_stats_files_changed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "232-238",
    "snippet": "size_t git_diff_stats_files_changed(\n\tconst git_diff_stats *stats)\n{\n\tassert(stats);\n\n\treturn stats->files_changed;\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "stats"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nsize_t git_diff_stats_files_changed(\n\tconst git_diff_stats *stats)\n{\n\tassert(stats);\n\n\treturn stats->files_changed;\n}"
  },
  {
    "function_name": "git_diff_get_stats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "159-230",
    "snippet": "int git_diff_get_stats(\n\tgit_diff_stats **out,\n\tgit_diff *diff)\n{\n\tsize_t i, deltas;\n\tsize_t total_insertions = 0, total_deletions = 0;\n\tgit_diff_stats *stats = NULL;\n\tint error = 0;\n\n\tassert(out && diff);\n\n\tstats = git__calloc(1, sizeof(git_diff_stats));\n\tGITERR_CHECK_ALLOC(stats);\n\n\tdeltas = git_diff_num_deltas(diff);\n\n\tstats->filestats = git__calloc(deltas, sizeof(diff_file_stats));\n\tif (!stats->filestats) {\n\t\tgit__free(stats);\n\t\treturn -1;\n\t}\n\n\tstats->diff = diff;\n\tGIT_REFCOUNT_INC(diff);\n\n\tfor (i = 0; i < deltas && !error; ++i) {\n\t\tgit_patch *patch = NULL;\n\t\tsize_t add = 0, remove = 0, namelen;\n\t\tconst git_diff_delta *delta;\n\n\t\tif ((error = git_patch_from_diff(&patch, diff, i)) < 0)\n\t\t\tbreak;\n\n\t\t/* keep a count of renames because it will affect formatting */\n\t\tdelta = git_patch_get_delta(patch);\n\n\t\tnamelen = strlen(delta->new_file.path);\n\t\tif (strcmp(delta->old_file.path, delta->new_file.path) != 0) {\n\t\t\tnamelen += strlen(delta->old_file.path);\n\t\t\tstats->renames++;\n\t\t}\n\n\t\t/* and, of course, count the line stats */\n\t\terror = git_patch_line_stats(NULL, &add, &remove, patch);\n\n\t\tgit_patch_free(patch);\n\n\t\tstats->filestats[i].insertions = add;\n\t\tstats->filestats[i].deletions = remove;\n\n\t\ttotal_insertions += add;\n\t\ttotal_deletions += remove;\n\n\t\tif (stats->max_name < namelen)\n\t\t\tstats->max_name = namelen;\n\t\tif (stats->max_filestat < add + remove)\n\t\t\tstats->max_filestat = add + remove;\n\t}\n\n\tstats->files_changed = deltas;\n\tstats->insertions = total_insertions;\n\tstats->deletions = total_deletions;\n\tstats->max_digits = digits_for_value(stats->max_filestat + 1);\n\n\tif (error < 0) {\n\t\tgit_diff_stats_free(stats);\n\t\tstats = NULL;\n\t}\n\n\t*out = stats;\n\treturn error;\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_diff_stats_free",
          "args": [
            "stats"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_stats_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
          "lines": "327-335",
          "snippet": "void git_diff_stats_free(git_diff_stats *stats)\n{\n\tif (stats == NULL)\n\t\treturn;\n\n\tgit_diff_free(stats->diff); /* bumped refcount in constructor */\n\tgit__free(stats->filestats);\n\tgit__free(stats);\n}",
          "includes": [
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_diff_stats_free(git_diff_stats *stats)\n{\n\tif (stats == NULL)\n\t\treturn;\n\n\tgit_diff_free(stats->diff); /* bumped refcount in constructor */\n\tgit__free(stats->filestats);\n\tgit__free(stats);\n}"
        }
      },
      {
        "call_info": {
          "callee": "digits_for_value",
          "args": [
            "stats->max_filestat + 1"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "digits_for_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
          "lines": "34-45",
          "snippet": "static int digits_for_value(size_t val)\n{\n\tint count = 1;\n\tsize_t placevalue = 10;\n\n\twhile (val >= placevalue) {\n\t\t++count;\n\t\tplacevalue *= 10;\n\t}\n\n\treturn count;\n}",
          "includes": [
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nstatic int digits_for_value(size_t val)\n{\n\tint count = 1;\n\tsize_t placevalue = 10;\n\n\twhile (val >= placevalue) {\n\t\t++count;\n\t\tplacevalue *= 10;\n\t}\n\n\treturn count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_patch_free",
          "args": [
            "patch"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "788-792",
          "snippet": "void git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_patch_line_stats",
          "args": [
            "NULL",
            "&add",
            "&remove",
            "patch"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_line_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "806-841",
          "snippet": "int git_patch_line_stats(\n\tsize_t *total_ctxt,\n\tsize_t *total_adds,\n\tsize_t *total_dels,\n\tconst git_patch *patch)\n{\n\tsize_t totals[3], idx;\n\n\tmemset(totals, 0, sizeof(totals));\n\n\tfor (idx = 0; idx < git_array_size(patch->lines); ++idx) {\n\t\tgit_diff_line *line = git_array_get(patch->lines, idx);\n\t\tif (!line)\n\t\t\tcontinue;\n\n\t\tswitch (line->origin) {\n\t\tcase GIT_DIFF_LINE_CONTEXT:  totals[0]++; break;\n\t\tcase GIT_DIFF_LINE_ADDITION: totals[1]++; break;\n\t\tcase GIT_DIFF_LINE_DELETION: totals[2]++; break;\n\t\tdefault:\n\t\t\t/* diff --stat and --numstat don't count EOFNL marks because\n\t\t\t * they will always be paired with a ADDITION or DELETION line.\n\t\t\t */\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (total_ctxt)\n\t\t*total_ctxt = totals[0];\n\tif (total_adds)\n\t\t*total_adds = totals[1];\n\tif (total_dels)\n\t\t*total_dels = totals[2];\n\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_line_stats(\n\tsize_t *total_ctxt,\n\tsize_t *total_adds,\n\tsize_t *total_dels,\n\tconst git_patch *patch)\n{\n\tsize_t totals[3], idx;\n\n\tmemset(totals, 0, sizeof(totals));\n\n\tfor (idx = 0; idx < git_array_size(patch->lines); ++idx) {\n\t\tgit_diff_line *line = git_array_get(patch->lines, idx);\n\t\tif (!line)\n\t\t\tcontinue;\n\n\t\tswitch (line->origin) {\n\t\tcase GIT_DIFF_LINE_CONTEXT:  totals[0]++; break;\n\t\tcase GIT_DIFF_LINE_ADDITION: totals[1]++; break;\n\t\tcase GIT_DIFF_LINE_DELETION: totals[2]++; break;\n\t\tdefault:\n\t\t\t/* diff --stat and --numstat don't count EOFNL marks because\n\t\t\t * they will always be paired with a ADDITION or DELETION line.\n\t\t\t */\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (total_ctxt)\n\t\t*total_ctxt = totals[0];\n\tif (total_adds)\n\t\t*total_adds = totals[1];\n\tif (total_dels)\n\t\t*total_dels = totals[2];\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "delta->old_file.path"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "delta->old_file.path",
            "delta->new_file.path"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "delta->new_file.path"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_patch_get_delta",
          "args": [
            "patch"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_get_delta",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "794-798",
          "snippet": "const git_diff_delta *git_patch_get_delta(const git_patch *patch)\n{\n\tassert(patch);\n\treturn patch->delta;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nconst git_diff_delta *git_patch_get_delta(const git_patch *patch)\n{\n\tassert(patch);\n\treturn patch->delta;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_patch_from_diff",
          "args": [
            "&patch",
            "diff",
            "i"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_from_diff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "735-786",
          "snippet": "int git_patch_from_diff(\n\tgit_patch **patch_ptr, git_diff *diff, size_t idx)\n{\n\tint error = 0;\n\tgit_xdiff_output xo;\n\tgit_diff_delta *delta = NULL;\n\tgit_patch *patch = NULL;\n\n\tif (patch_ptr) *patch_ptr = NULL;\n\n\tif (diff_required(diff, \"git_patch_from_diff\") < 0)\n\t\treturn -1;\n\n\tdelta = git_vector_get(&diff->deltas, idx);\n\tif (!delta) {\n\t\tgiterr_set(GITERR_INVALID, \"Index out of range for delta in diff\");\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (git_diff_delta__should_skip(&diff->opts, delta))\n\t\treturn 0;\n\n\t/* don't load the patch data unless we need it for binary check */\n\tif (!patch_ptr &&\n\t\t((delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0 ||\n\t\t (diff->opts.flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0))\n\t\treturn 0;\n\n\tif ((error = diff_patch_alloc_from_diff(&patch, diff, idx)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, patch);\n\tgit_xdiff_init(&xo, &diff->opts);\n\n\terror = diff_patch_invoke_file_callback(patch, &xo.output);\n\n\tif (!error)\n\t\terror = diff_patch_generate(patch, &xo.output);\n\n\tif (!error) {\n\t\t/* TODO: if cumulative diff size is < 0.5 total size, flatten patch */\n\t\t/* TODO: and unload the file content */\n\t}\n\n\tif (error || !patch_ptr)\n\t\tgit_patch_free(patch);\n\telse\n\t\t*patch_ptr = patch;\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_from_diff(\n\tgit_patch **patch_ptr, git_diff *diff, size_t idx)\n{\n\tint error = 0;\n\tgit_xdiff_output xo;\n\tgit_diff_delta *delta = NULL;\n\tgit_patch *patch = NULL;\n\n\tif (patch_ptr) *patch_ptr = NULL;\n\n\tif (diff_required(diff, \"git_patch_from_diff\") < 0)\n\t\treturn -1;\n\n\tdelta = git_vector_get(&diff->deltas, idx);\n\tif (!delta) {\n\t\tgiterr_set(GITERR_INVALID, \"Index out of range for delta in diff\");\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (git_diff_delta__should_skip(&diff->opts, delta))\n\t\treturn 0;\n\n\t/* don't load the patch data unless we need it for binary check */\n\tif (!patch_ptr &&\n\t\t((delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0 ||\n\t\t (diff->opts.flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0))\n\t\treturn 0;\n\n\tif ((error = diff_patch_alloc_from_diff(&patch, diff, idx)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, patch);\n\tgit_xdiff_init(&xo, &diff->opts);\n\n\terror = diff_patch_invoke_file_callback(patch, &xo.output);\n\n\tif (!error)\n\t\terror = diff_patch_generate(patch, &xo.output);\n\n\tif (!error) {\n\t\t/* TODO: if cumulative diff size is < 0.5 total size, flatten patch */\n\t\t/* TODO: and unload the file content */\n\t}\n\n\tif (error || !patch_ptr)\n\t\tgit_patch_free(patch);\n\telse\n\t\t*patch_ptr = patch;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "diff"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "stats"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "deltas",
            "sizeof(diff_file_stats)"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_num_deltas",
          "args": [
            "diff"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_num_deltas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "1486-1490",
          "snippet": "size_t git_diff_num_deltas(const git_diff *diff)\n{\n\tassert(diff);\n\treturn diff->deltas.length;\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nsize_t git_diff_num_deltas(const git_diff *diff)\n{\n\tassert(diff);\n\treturn diff->deltas.length;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "stats"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && diff"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nint git_diff_get_stats(\n\tgit_diff_stats **out,\n\tgit_diff *diff)\n{\n\tsize_t i, deltas;\n\tsize_t total_insertions = 0, total_deletions = 0;\n\tgit_diff_stats *stats = NULL;\n\tint error = 0;\n\n\tassert(out && diff);\n\n\tstats = git__calloc(1, sizeof(git_diff_stats));\n\tGITERR_CHECK_ALLOC(stats);\n\n\tdeltas = git_diff_num_deltas(diff);\n\n\tstats->filestats = git__calloc(deltas, sizeof(diff_file_stats));\n\tif (!stats->filestats) {\n\t\tgit__free(stats);\n\t\treturn -1;\n\t}\n\n\tstats->diff = diff;\n\tGIT_REFCOUNT_INC(diff);\n\n\tfor (i = 0; i < deltas && !error; ++i) {\n\t\tgit_patch *patch = NULL;\n\t\tsize_t add = 0, remove = 0, namelen;\n\t\tconst git_diff_delta *delta;\n\n\t\tif ((error = git_patch_from_diff(&patch, diff, i)) < 0)\n\t\t\tbreak;\n\n\t\t/* keep a count of renames because it will affect formatting */\n\t\tdelta = git_patch_get_delta(patch);\n\n\t\tnamelen = strlen(delta->new_file.path);\n\t\tif (strcmp(delta->old_file.path, delta->new_file.path) != 0) {\n\t\t\tnamelen += strlen(delta->old_file.path);\n\t\t\tstats->renames++;\n\t\t}\n\n\t\t/* and, of course, count the line stats */\n\t\terror = git_patch_line_stats(NULL, &add, &remove, patch);\n\n\t\tgit_patch_free(patch);\n\n\t\tstats->filestats[i].insertions = add;\n\t\tstats->filestats[i].deletions = remove;\n\n\t\ttotal_insertions += add;\n\t\ttotal_deletions += remove;\n\n\t\tif (stats->max_name < namelen)\n\t\t\tstats->max_name = namelen;\n\t\tif (stats->max_filestat < add + remove)\n\t\t\tstats->max_filestat = add + remove;\n\t}\n\n\tstats->files_changed = deltas;\n\tstats->insertions = total_insertions;\n\tstats->deletions = total_deletions;\n\tstats->max_digits = digits_for_value(stats->max_filestat + 1);\n\n\tif (error < 0) {\n\t\tgit_diff_stats_free(stats);\n\t\tstats = NULL;\n\t}\n\n\t*out = stats;\n\treturn error;\n}"
  },
  {
    "function_name": "git_diff_file_stats__summary_to_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "137-157",
    "snippet": "int git_diff_file_stats__summary_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta)\n{\n\tif (delta->old_file.mode != delta->new_file.mode) {\n\t\tif (delta->old_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \" create mode %06o %s\\n\",\n\t\t\t\tdelta->new_file.mode, delta->new_file.path);\n\t\t}\n\t\telse if (delta->new_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \" delete mode %06o %s\\n\",\n\t\t\t\tdelta->old_file.mode, delta->old_file.path);\n\t\t}\n\t\telse {\n\t\t\tgit_buf_printf(out, \" mode change %06o => %06o %s\\n\",\n\t\t\t\tdelta->old_file.mode, delta->new_file.mode, delta->new_file.path);\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "out",
            "\" mode change %06o => %06o %s\\n\"",
            "delta->old_file.mode",
            "delta->new_file.mode",
            "delta->new_file.path"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nint git_diff_file_stats__summary_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta)\n{\n\tif (delta->old_file.mode != delta->new_file.mode) {\n\t\tif (delta->old_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \" create mode %06o %s\\n\",\n\t\t\t\tdelta->new_file.mode, delta->new_file.path);\n\t\t}\n\t\telse if (delta->new_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \" delete mode %06o %s\\n\",\n\t\t\t\tdelta->old_file.mode, delta->old_file.path);\n\t\t}\n\t\telse {\n\t\t\tgit_buf_printf(out, \" mode change %06o => %06o %s\\n\",\n\t\t\t\tdelta->old_file.mode, delta->new_file.mode, delta->new_file.path);\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_diff_file_stats__number_to_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "120-135",
    "snippet": "int git_diff_file_stats__number_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst diff_file_stats *filestats)\n{\n\tint error;\n\tconst char *path = delta->new_file.path;\n\n\tif (delta->flags & GIT_DIFF_FLAG_BINARY)\n\t\terror = git_buf_printf(out, \"%-8c\" \"%-8c\" \"%s\\n\", '-', '-', path);\n\telse\n\t\terror = git_buf_printf(out, \"%-8\" PRIuZ \"%-8\" PRIuZ \"%s\\n\",\n\t\t\tfilestats->insertions, filestats->deletions, path);\n\n\treturn error;\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "out",
            "\"%-8\" PRIuZ \"%-8\" PRIuZ \"%s\\n\"",
            "filestats->insertions",
            "filestats->deletions",
            "path"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nint git_diff_file_stats__number_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst diff_file_stats *filestats)\n{\n\tint error;\n\tconst char *path = delta->new_file.path;\n\n\tif (delta->flags & GIT_DIFF_FLAG_BINARY)\n\t\terror = git_buf_printf(out, \"%-8c\" \"%-8c\" \"%s\\n\", '-', '-', path);\n\telse\n\t\terror = git_buf_printf(out, \"%-8\" PRIuZ \"%-8\" PRIuZ \"%s\\n\",\n\t\t\tfilestats->insertions, filestats->deletions, path);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_diff_file_stats__full_to_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "47-118",
    "snippet": "int git_diff_file_stats__full_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst diff_file_stats *filestat,\n\tconst git_diff_stats *stats,\n\tsize_t width)\n{\n\tconst char *old_path = NULL, *new_path = NULL;\n\tsize_t padding, old_size, new_size;\n\n\told_path = delta->old_file.path;\n\tnew_path = delta->new_file.path;\n\told_size = delta->old_file.size;\n\tnew_size = delta->new_file.size;\n\n\tif (git_buf_printf(out, \" %s\", old_path) < 0)\n\t\tgoto on_error;\n\n\tif (strcmp(old_path, new_path) != 0) {\n\t\tpadding = stats->max_name - strlen(old_path) - strlen(new_path);\n\n\t\tif (git_buf_printf(out, DIFF_RENAME_FILE_SEPARATOR \"%s\", new_path) < 0)\n\t\t\tgoto on_error;\n\t} else {\n\t\tpadding = stats->max_name - strlen(old_path);\n\n\t\tif (stats->renames > 0)\n\t\t\tpadding += strlen(DIFF_RENAME_FILE_SEPARATOR);\n\t}\n\n\tif (git_buf_putcn(out, ' ', padding) < 0 ||\n\t\tgit_buf_puts(out, \" | \") < 0)\n\t\tgoto on_error;\n\n\tif (delta->flags & GIT_DIFF_FLAG_BINARY) {\n\t\tif (git_buf_printf(out,\n\t\t\t\t\"Bin %\" PRIuZ \" -> %\" PRIuZ \" bytes\", old_size, new_size) < 0)\n\t\t\tgoto on_error;\n\t}\n\telse {\n\t\tif (git_buf_printf(out,\n\t\t\t\t\"%*\" PRIuZ, stats->max_digits,\n\t\t\t\tfilestat->insertions + filestat->deletions) < 0)\n\t\t\tgoto on_error;\n\n\t\tif (filestat->insertions || filestat->deletions) {\n\t\t\tif (git_buf_putc(out, ' ') < 0)\n\t\t\t\tgoto on_error;\n\n\t\t\tif (!width) {\n\t\t\t\tif (git_buf_putcn(out, '+', filestat->insertions) < 0 ||\n\t\t\t\t\tgit_buf_putcn(out, '-', filestat->deletions) < 0)\n\t\t\t\t\tgoto on_error;\n\t\t\t} else {\n\t\t\t\tsize_t total = filestat->insertions + filestat->deletions;\n\t\t\t\tsize_t full = (total * width + stats->max_filestat / 2) /\n\t\t\t\t\tstats->max_filestat;\n\t\t\t\tsize_t plus = full * filestat->insertions / total;\n\t\t\t\tsize_t minus = full - plus;\n\n\t\t\t\tif (git_buf_putcn(out, '+', max(plus,  1)) < 0 ||\n\t\t\t\t\tgit_buf_putcn(out, '-', max(minus, 1)) < 0)\n\t\t\t\t\tgoto on_error;\n\t\t\t}\n\t\t}\n\t}\n\n\tgit_buf_putc(out, '\\n');\n\non_error:\n\treturn (git_buf_oom(out) ? -1 : 0);\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define DIFF_RENAME_FILE_SEPARATOR \" => \""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "out",
            "'\\n'"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_putcn",
          "args": [
            "out",
            "'-'",
            "max(minus, 1)"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putcn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "196-206",
          "snippet": "int git_buf_putcn(git_buf *buf, char c, size_t len)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\tENSURE_SIZE(buf, new_size);\n\tmemset(buf->ptr + buf->size, c, len);\n\tbuf->size += len;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putcn(git_buf *buf, char c, size_t len)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\tENSURE_SIZE(buf, new_size);\n\tmemset(buf->ptr + buf->size, c, len);\n\tbuf->size += len;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "minus",
            "1"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_set_max_object_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "35-44",
          "snippet": "int git_cache_set_max_object_size(git_otype type, size_t size)\n{\n\tif (type < 0 || (size_t)type >= ARRAY_SIZE(git_cache__max_object_size)) {\n\t\tgiterr_set(GITERR_INVALID, \"type out of range\");\n\t\treturn -1;\n\t}\n\n\tgit_cache__max_object_size[type] = size;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};\n\nint git_cache_set_max_object_size(git_otype type, size_t size)\n{\n\tif (type < 0 || (size_t)type >= ARRAY_SIZE(git_cache__max_object_size)) {\n\t\tgiterr_set(GITERR_INVALID, \"type out of range\");\n\t\treturn -1;\n\t}\n\n\tgit_cache__max_object_size[type] = size;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "out",
            "\"%*\" PRIuZ",
            "stats->max_digits",
            "filestat->insertions + filestat->deletions"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "out",
            "\" | \""
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "DIFF_RENAME_FILE_SEPARATOR"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "old_path"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "new_path"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "old_path"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "old_path",
            "new_path"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\n#define DIFF_RENAME_FILE_SEPARATOR \" => \"\n\nint git_diff_file_stats__full_to_buf(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst diff_file_stats *filestat,\n\tconst git_diff_stats *stats,\n\tsize_t width)\n{\n\tconst char *old_path = NULL, *new_path = NULL;\n\tsize_t padding, old_size, new_size;\n\n\told_path = delta->old_file.path;\n\tnew_path = delta->new_file.path;\n\told_size = delta->old_file.size;\n\tnew_size = delta->new_file.size;\n\n\tif (git_buf_printf(out, \" %s\", old_path) < 0)\n\t\tgoto on_error;\n\n\tif (strcmp(old_path, new_path) != 0) {\n\t\tpadding = stats->max_name - strlen(old_path) - strlen(new_path);\n\n\t\tif (git_buf_printf(out, DIFF_RENAME_FILE_SEPARATOR \"%s\", new_path) < 0)\n\t\t\tgoto on_error;\n\t} else {\n\t\tpadding = stats->max_name - strlen(old_path);\n\n\t\tif (stats->renames > 0)\n\t\t\tpadding += strlen(DIFF_RENAME_FILE_SEPARATOR);\n\t}\n\n\tif (git_buf_putcn(out, ' ', padding) < 0 ||\n\t\tgit_buf_puts(out, \" | \") < 0)\n\t\tgoto on_error;\n\n\tif (delta->flags & GIT_DIFF_FLAG_BINARY) {\n\t\tif (git_buf_printf(out,\n\t\t\t\t\"Bin %\" PRIuZ \" -> %\" PRIuZ \" bytes\", old_size, new_size) < 0)\n\t\t\tgoto on_error;\n\t}\n\telse {\n\t\tif (git_buf_printf(out,\n\t\t\t\t\"%*\" PRIuZ, stats->max_digits,\n\t\t\t\tfilestat->insertions + filestat->deletions) < 0)\n\t\t\tgoto on_error;\n\n\t\tif (filestat->insertions || filestat->deletions) {\n\t\t\tif (git_buf_putc(out, ' ') < 0)\n\t\t\t\tgoto on_error;\n\n\t\t\tif (!width) {\n\t\t\t\tif (git_buf_putcn(out, '+', filestat->insertions) < 0 ||\n\t\t\t\t\tgit_buf_putcn(out, '-', filestat->deletions) < 0)\n\t\t\t\t\tgoto on_error;\n\t\t\t} else {\n\t\t\t\tsize_t total = filestat->insertions + filestat->deletions;\n\t\t\t\tsize_t full = (total * width + stats->max_filestat / 2) /\n\t\t\t\t\tstats->max_filestat;\n\t\t\t\tsize_t plus = full * filestat->insertions / total;\n\t\t\t\tsize_t minus = full - plus;\n\n\t\t\t\tif (git_buf_putcn(out, '+', max(plus,  1)) < 0 ||\n\t\t\t\t\tgit_buf_putcn(out, '-', max(minus, 1)) < 0)\n\t\t\t\t\tgoto on_error;\n\t\t\t}\n\t\t}\n\t}\n\n\tgit_buf_putc(out, '\\n');\n\non_error:\n\treturn (git_buf_oom(out) ? -1 : 0);\n}"
  },
  {
    "function_name": "digits_for_value",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_stats.c",
    "lines": "34-45",
    "snippet": "static int digits_for_value(size_t val)\n{\n\tint count = 1;\n\tsize_t placevalue = 10;\n\n\twhile (val >= placevalue) {\n\t\t++count;\n\t\tplacevalue *= 10;\n\t}\n\n\treturn count;\n}",
    "includes": [
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"vector.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"vector.h\"\n#include \"common.h\"\n\nstatic int digits_for_value(size_t val)\n{\n\tint count = 1;\n\tsize_t placevalue = 10;\n\n\twhile (val >= placevalue) {\n\t\t++count;\n\t\tplacevalue *= 10;\n\t}\n\n\treturn count;\n}"
  }
]