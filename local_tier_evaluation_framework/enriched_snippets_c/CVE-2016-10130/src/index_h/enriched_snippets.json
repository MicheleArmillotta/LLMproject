[
  {
    "function_name": "git_index__filestamp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.h",
    "lines": "121-124",
    "snippet": "GIT_INLINE(const git_futils_filestamp *) git_index__filestamp(git_index *index)\n{\n   return &index->stamp;\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/odb.h\"",
      "#include \"tree-cache.h\"",
      "#include \"idxmap.h\"",
      "#include \"vector.h\"",
      "#include \"filebuf.h\"",
      "#include \"fileops.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/odb.h\"\n#include \"tree-cache.h\"\n#include \"idxmap.h\"\n#include \"vector.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n\nGIT_INLINE(const git_futils_filestamp *) git_index__filestamp(git_index *index)\n{\n   return &index->stamp;\n}"
  },
  {
    "function_name": "git_index_entry_newer_than_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.h",
    "lines": "86-104",
    "snippet": "GIT_INLINE(bool) git_index_entry_newer_than_index(\n\tconst git_index_entry *entry, git_index *index)\n{\n\t/* If we never read the index, we can't have this race either */\n\tif (!index || index->stamp.mtime.tv_sec == 0)\n\t\treturn false;\n\n\t/* If the timestamp is the same or newer than the index, it's racy */\n#if defined(GIT_USE_NSEC)\n\tif ((int32_t)index->stamp.mtime.tv_sec < entry->mtime.seconds)\n\t\treturn true;\n\telse if ((int32_t)index->stamp.mtime.tv_sec > entry->mtime.seconds)\n\t\treturn false;\n\telse\n\t\treturn (uint32_t)index->stamp.mtime.tv_nsec <= entry->mtime.nanoseconds;\n#else\n\treturn ((int32_t)index->stamp.mtime.tv_sec) <= entry->mtime.seconds;\n#endif\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/odb.h\"",
      "#include \"tree-cache.h\"",
      "#include \"idxmap.h\"",
      "#include \"vector.h\"",
      "#include \"filebuf.h\"",
      "#include \"fileops.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/odb.h\"\n#include \"tree-cache.h\"\n#include \"idxmap.h\"\n#include \"vector.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n\nGIT_INLINE(bool) git_index_entry_newer_than_index(\n\tconst git_index_entry *entry, git_index *index)\n{\n\t/* If we never read the index, we can't have this race either */\n\tif (!index || index->stamp.mtime.tv_sec == 0)\n\t\treturn false;\n\n\t/* If the timestamp is the same or newer than the index, it's racy */\n#if defined(GIT_USE_NSEC)\n\tif ((int32_t)index->stamp.mtime.tv_sec < entry->mtime.seconds)\n\t\treturn true;\n\telse if ((int32_t)index->stamp.mtime.tv_sec > entry->mtime.seconds)\n\t\treturn false;\n\telse\n\t\treturn (uint32_t)index->stamp.mtime.tv_nsec <= entry->mtime.nanoseconds;\n#else\n\treturn ((int32_t)index->stamp.mtime.tv_sec) <= entry->mtime.seconds;\n#endif\n}"
  },
  {
    "function_name": "git_index_time_eq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.h",
    "lines": "68-79",
    "snippet": "GIT_INLINE(bool) git_index_time_eq(const git_index_time *one, const git_index_time *two)\n{\n\tif (one->seconds != two->seconds)\n\t\treturn false;\n\n#ifdef GIT_USE_NSEC\n\tif (one->nanoseconds != two->nanoseconds)\n\t\treturn false;\n#endif\n\n\treturn true;\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/odb.h\"",
      "#include \"tree-cache.h\"",
      "#include \"idxmap.h\"",
      "#include \"vector.h\"",
      "#include \"filebuf.h\"",
      "#include \"fileops.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/odb.h\"\n#include \"tree-cache.h\"\n#include \"idxmap.h\"\n#include \"vector.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n\nGIT_INLINE(bool) git_index_time_eq(const git_index_time *one, const git_index_time *two)\n{\n\tif (one->seconds != two->seconds)\n\t\treturn false;\n\n#ifdef GIT_USE_NSEC\n\tif (one->nanoseconds != two->nanoseconds)\n\t\treturn false;\n#endif\n\n\treturn true;\n}"
  }
]