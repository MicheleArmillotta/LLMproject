[
  {
    "function_name": "git_win32__find_programdata_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "219-227",
    "snippet": "int git_win32__find_programdata_dirs(git_buf *out)\n{\n\tstatic const wchar_t *programdata_tmpls[2] = {\n\t\tL\"%PROGRAMDATA%\\\\Git\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, programdata_tmpls);\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "win32_find_existing_dirs",
          "args": [
            "out",
            "programdata_tmpls"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "win32_find_existing_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "140-163",
          "snippet": "static int win32_find_existing_dirs(\n\tgit_buf *out, const wchar_t *tmpl[])\n{\n\t_findfile_path path16;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tgit_buf_clear(out);\n\n\tfor (; *tmpl != NULL; tmpl++) {\n\t\tif (!git_win32__expand_path(&path16, *tmpl) &&\n\t\t\tpath16.path[0] != L'%' &&\n\t\t\t!_waccess(path16.path, F_OK))\n\t\t{\n\t\t\twin32_path_to_8(&buf, path16.path);\n\n\t\t\tif (buf.size)\n\t\t\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\t\t}\n\t}\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_find_existing_dirs(\n\tgit_buf *out, const wchar_t *tmpl[])\n{\n\t_findfile_path path16;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tgit_buf_clear(out);\n\n\tfor (; *tmpl != NULL; tmpl++) {\n\t\tif (!git_win32__expand_path(&path16, *tmpl) &&\n\t\t\tpath16.path[0] != L'%' &&\n\t\t\t!_waccess(path16.path, F_OK))\n\t\t{\n\t\t\twin32_path_to_8(&buf, path16.path);\n\n\t\t\tif (buf.size)\n\t\t\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\t\t}\n\t}\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nint git_win32__find_programdata_dirs(git_buf *out)\n{\n\tstatic const wchar_t *programdata_tmpls[2] = {\n\t\tL\"%PROGRAMDATA%\\\\Git\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, programdata_tmpls);\n}"
  },
  {
    "function_name": "git_win32__find_xdg_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "204-217",
    "snippet": "int git_win32__find_xdg_dirs(git_buf *out)\n{\n\tstatic const wchar_t *global_tmpls[7] = {\n\t\tL\"%XDG_CONFIG_HOME%\\\\git\",\n\t\tL\"%APPDATA%\\\\git\",\n\t\tL\"%LOCALAPPDATA%\\\\git\",\n\t\tL\"%HOME%\\\\.config\\\\git\",\n\t\tL\"%HOMEDRIVE%%HOMEPATH%\\\\.config\\\\git\",\n\t\tL\"%USERPROFILE%\\\\.config\\\\git\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, global_tmpls);\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "win32_find_existing_dirs",
          "args": [
            "out",
            "global_tmpls"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "win32_find_existing_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "140-163",
          "snippet": "static int win32_find_existing_dirs(\n\tgit_buf *out, const wchar_t *tmpl[])\n{\n\t_findfile_path path16;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tgit_buf_clear(out);\n\n\tfor (; *tmpl != NULL; tmpl++) {\n\t\tif (!git_win32__expand_path(&path16, *tmpl) &&\n\t\t\tpath16.path[0] != L'%' &&\n\t\t\t!_waccess(path16.path, F_OK))\n\t\t{\n\t\t\twin32_path_to_8(&buf, path16.path);\n\n\t\t\tif (buf.size)\n\t\t\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\t\t}\n\t}\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_find_existing_dirs(\n\tgit_buf *out, const wchar_t *tmpl[])\n{\n\t_findfile_path path16;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tgit_buf_clear(out);\n\n\tfor (; *tmpl != NULL; tmpl++) {\n\t\tif (!git_win32__expand_path(&path16, *tmpl) &&\n\t\t\tpath16.path[0] != L'%' &&\n\t\t\t!_waccess(path16.path, F_OK))\n\t\t{\n\t\t\twin32_path_to_8(&buf, path16.path);\n\n\t\t\tif (buf.size)\n\t\t\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\t\t}\n\t}\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nint git_win32__find_xdg_dirs(git_buf *out)\n{\n\tstatic const wchar_t *global_tmpls[7] = {\n\t\tL\"%XDG_CONFIG_HOME%\\\\git\",\n\t\tL\"%APPDATA%\\\\git\",\n\t\tL\"%LOCALAPPDATA%\\\\git\",\n\t\tL\"%HOME%\\\\.config\\\\git\",\n\t\tL\"%HOMEDRIVE%%HOMEPATH%\\\\.config\\\\git\",\n\t\tL\"%USERPROFILE%\\\\.config\\\\git\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, global_tmpls);\n}"
  },
  {
    "function_name": "git_win32__find_global_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "192-202",
    "snippet": "int git_win32__find_global_dirs(git_buf *out)\n{\n\tstatic const wchar_t *global_tmpls[4] = {\n\t\tL\"%HOME%\\\\\",\n\t\tL\"%HOMEDRIVE%%HOMEPATH%\\\\\",\n\t\tL\"%USERPROFILE%\\\\\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, global_tmpls);\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "win32_find_existing_dirs",
          "args": [
            "out",
            "global_tmpls"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "win32_find_existing_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "140-163",
          "snippet": "static int win32_find_existing_dirs(\n\tgit_buf *out, const wchar_t *tmpl[])\n{\n\t_findfile_path path16;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tgit_buf_clear(out);\n\n\tfor (; *tmpl != NULL; tmpl++) {\n\t\tif (!git_win32__expand_path(&path16, *tmpl) &&\n\t\t\tpath16.path[0] != L'%' &&\n\t\t\t!_waccess(path16.path, F_OK))\n\t\t{\n\t\t\twin32_path_to_8(&buf, path16.path);\n\n\t\t\tif (buf.size)\n\t\t\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\t\t}\n\t}\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_find_existing_dirs(\n\tgit_buf *out, const wchar_t *tmpl[])\n{\n\t_findfile_path path16;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tgit_buf_clear(out);\n\n\tfor (; *tmpl != NULL; tmpl++) {\n\t\tif (!git_win32__expand_path(&path16, *tmpl) &&\n\t\t\tpath16.path[0] != L'%' &&\n\t\t\t!_waccess(path16.path, F_OK))\n\t\t{\n\t\t\twin32_path_to_8(&buf, path16.path);\n\n\t\t\tif (buf.size)\n\t\t\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\t\t}\n\t}\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nint git_win32__find_global_dirs(git_buf *out)\n{\n\tstatic const wchar_t *global_tmpls[4] = {\n\t\tL\"%HOME%\\\\\",\n\t\tL\"%HOMEDRIVE%%HOMEPATH%\\\\\",\n\t\tL\"%USERPROFILE%\\\\\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, global_tmpls);\n}"
  },
  {
    "function_name": "git_win32__find_system_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "165-190",
    "snippet": "int git_win32__find_system_dirs(git_buf *out, const wchar_t *subdir)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\n\t/* directories where git.exe & git.cmd are found */\n\tif (!win32_find_git_in_path(&buf, L\"git.exe\", subdir) && buf.size)\n\t\tgit_buf_set(out, buf.ptr, buf.size);\n\telse\n\t\tgit_buf_clear(out);\n\n\tif (!win32_find_git_in_path(&buf, L\"git.cmd\", subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\t/* directories where git is installed according to registry */\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_CURRENT_USER, REG_MSYSGIT_INSTALL_LOCAL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_LOCAL_MACHINE, REG_MSYSGIT_INSTALL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [
      "#define REG_MSYSGIT_INSTALL L\"SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\"",
      "#define REG_MSYSGIT_INSTALL REG_MSYSGIT_INSTALL_LOCAL",
      "#define REG_MSYSGIT_INSTALL_LOCAL L\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_join",
          "args": [
            "out",
            "GIT_PATH_LIST_SEPARATOR",
            "out->ptr",
            "buf.ptr"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "607-655",
          "snippet": "int git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "win32_find_git_in_registry",
          "args": [
            "&buf",
            "HKEY_LOCAL_MACHINE",
            "REG_MSYSGIT_INSTALL",
            "subdir"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "win32_find_git_in_registry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "105-138",
          "snippet": "static int win32_find_git_in_registry(\n\tgit_buf *buf, const HKEY hive, const wchar_t *key, const wchar_t *subdir)\n{\n\tHKEY hKey;\n\tint error = GIT_ENOTFOUND;\n\n\tassert(buf);\n\n\tif (!RegOpenKeyExW(hive, key, 0, KEY_READ, &hKey)) {\n\t\tDWORD dwType, cbData;\n\t\tgit_win32_path path;\n\n\t\t/* Ensure that the buffer is big enough to have the suffix attached\n\t\t * after we receive the result. */\n\t\tcbData = (DWORD)(sizeof(path) - wcslen(subdir) * sizeof(wchar_t));\n\n\t\t/* InstallLocation points to the root of the git directory */\n\t\tif (!RegQueryValueExW(hKey, L\"InstallLocation\", NULL, &dwType, (LPBYTE)path, &cbData) &&\n\t\t\tdwType == REG_SZ) {\n\n\t\t\t/* Append the suffix */\n\t\t\twcscat(path, subdir);\n\n\t\t\t/* Convert to UTF-8, with forward slashes, and output the path\n\t\t\t * to the provided buffer */\n\t\t\tif (!win32_path_to_8(buf, path))\n\t\t\t\terror = 0;\n\t\t}\n\n\t\tRegCloseKey(hKey);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_find_git_in_registry(\n\tgit_buf *buf, const HKEY hive, const wchar_t *key, const wchar_t *subdir)\n{\n\tHKEY hKey;\n\tint error = GIT_ENOTFOUND;\n\n\tassert(buf);\n\n\tif (!RegOpenKeyExW(hive, key, 0, KEY_READ, &hKey)) {\n\t\tDWORD dwType, cbData;\n\t\tgit_win32_path path;\n\n\t\t/* Ensure that the buffer is big enough to have the suffix attached\n\t\t * after we receive the result. */\n\t\tcbData = (DWORD)(sizeof(path) - wcslen(subdir) * sizeof(wchar_t));\n\n\t\t/* InstallLocation points to the root of the git directory */\n\t\tif (!RegQueryValueExW(hKey, L\"InstallLocation\", NULL, &dwType, (LPBYTE)path, &cbData) &&\n\t\t\tdwType == REG_SZ) {\n\n\t\t\t/* Append the suffix */\n\t\t\twcscat(path, subdir);\n\n\t\t\t/* Convert to UTF-8, with forward slashes, and output the path\n\t\t\t * to the provided buffer */\n\t\t\tif (!win32_path_to_8(buf, path))\n\t\t\t\terror = 0;\n\t\t}\n\n\t\tRegCloseKey(hKey);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "win32_find_git_in_path",
          "args": [
            "&buf",
            "L\"git.cmd\"",
            "subdir"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "win32_find_git_in_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "70-103",
          "snippet": "static int win32_find_git_in_path(git_buf *buf, const wchar_t *gitexe, const wchar_t *subdir)\n{\n\twchar_t *env = _wgetenv(L\"PATH\"), lastch;\n\t_findfile_path root;\n\tsize_t gitexe_len = wcslen(gitexe);\n\n\tif (!env)\n\t\treturn -1;\n\n\twhile ((env = win32_walkpath(env, root.path, MAX_PATH-1)) && *root.path) {\n\t\troot.len = (DWORD)wcslen(root.path);\n\t\tlastch = root.path[root.len - 1];\n\n\t\t/* ensure trailing slash (MAX_PATH-1 to walkpath guarantees space) */\n\t\tif (lastch != L'/' && lastch != L'\\\\') {\n\t\t\troot.path[root.len++] = L'\\\\';\n\t\t\troot.path[root.len]   = L'\\0';\n\t\t}\n\n\t\tif (root.len + gitexe_len >= MAX_PATH)\n\t\t\tcontinue;\n\t\twcscpy(&root.path[root.len], gitexe);\n\n\t\tif (_waccess(root.path, F_OK) == 0 && root.len > 5) {\n\t\t\t/* replace \"bin\\\\\" or \"cmd\\\\\" with subdir */\n\t\t\twcscpy(&root.path[root.len - 4], subdir);\n\n\t\t\twin32_path_to_8(buf, root.path);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_find_git_in_path(git_buf *buf, const wchar_t *gitexe, const wchar_t *subdir)\n{\n\twchar_t *env = _wgetenv(L\"PATH\"), lastch;\n\t_findfile_path root;\n\tsize_t gitexe_len = wcslen(gitexe);\n\n\tif (!env)\n\t\treturn -1;\n\n\twhile ((env = win32_walkpath(env, root.path, MAX_PATH-1)) && *root.path) {\n\t\troot.len = (DWORD)wcslen(root.path);\n\t\tlastch = root.path[root.len - 1];\n\n\t\t/* ensure trailing slash (MAX_PATH-1 to walkpath guarantees space) */\n\t\tif (lastch != L'/' && lastch != L'\\\\') {\n\t\t\troot.path[root.len++] = L'\\\\';\n\t\t\troot.path[root.len]   = L'\\0';\n\t\t}\n\n\t\tif (root.len + gitexe_len >= MAX_PATH)\n\t\t\tcontinue;\n\t\twcscpy(&root.path[root.len], gitexe);\n\n\t\tif (_waccess(root.path, F_OK) == 0 && root.len > 5) {\n\t\t\t/* replace \"bin\\\\\" or \"cmd\\\\\" with subdir */\n\t\t\twcscpy(&root.path[root.len - 4], subdir);\n\n\t\t\twin32_path_to_8(buf, root.path);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_set",
          "args": [
            "out",
            "buf.ptr",
            "buf.size"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "150-169",
          "snippet": "int git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\n#define REG_MSYSGIT_INSTALL L\"SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\"\n#define REG_MSYSGIT_INSTALL REG_MSYSGIT_INSTALL_LOCAL\n#define REG_MSYSGIT_INSTALL_LOCAL L\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\"\n\nint git_win32__find_system_dirs(git_buf *out, const wchar_t *subdir)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\n\t/* directories where git.exe & git.cmd are found */\n\tif (!win32_find_git_in_path(&buf, L\"git.exe\", subdir) && buf.size)\n\t\tgit_buf_set(out, buf.ptr, buf.size);\n\telse\n\t\tgit_buf_clear(out);\n\n\tif (!win32_find_git_in_path(&buf, L\"git.cmd\", subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\t/* directories where git is installed according to registry */\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_CURRENT_USER, REG_MSYSGIT_INSTALL_LOCAL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_LOCAL_MACHINE, REG_MSYSGIT_INSTALL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}"
  },
  {
    "function_name": "win32_find_existing_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "140-163",
    "snippet": "static int win32_find_existing_dirs(\n\tgit_buf *out, const wchar_t *tmpl[])\n{\n\t_findfile_path path16;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tgit_buf_clear(out);\n\n\tfor (; *tmpl != NULL; tmpl++) {\n\t\tif (!git_win32__expand_path(&path16, *tmpl) &&\n\t\t\tpath16.path[0] != L'%' &&\n\t\t\t!_waccess(path16.path, F_OK))\n\t\t{\n\t\t\twin32_path_to_8(&buf, path16.path);\n\n\t\t\tif (buf.size)\n\t\t\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\t\t}\n\t}\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_join",
          "args": [
            "out",
            "GIT_PATH_LIST_SEPARATOR",
            "out->ptr",
            "buf.ptr"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "607-655",
          "snippet": "int git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "win32_path_to_8",
          "args": [
            "&buf",
            "path16.path"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "win32_path_to_8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "36-49",
          "snippet": "static int win32_path_to_8(git_buf *dest, const wchar_t *src)\n{\n\tgit_win32_utf8_path utf8_path;\n\n\tif (git_win32_path_to_utf8(utf8_path, src) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to convert path to UTF-8\");\n\t\treturn -1;\n\t}\n\n\t/* Convert backslashes to forward slashes */\n\tgit_path_mkposix(utf8_path);\n\n\treturn git_buf_sets(dest, utf8_path);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_path_to_8(git_buf *dest, const wchar_t *src)\n{\n\tgit_win32_utf8_path utf8_path;\n\n\tif (git_win32_path_to_utf8(utf8_path, src) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to convert path to UTF-8\");\n\t\treturn -1;\n\t}\n\n\t/* Convert backslashes to forward slashes */\n\tgit_path_mkposix(utf8_path);\n\n\treturn git_buf_sets(dest, utf8_path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_waccess",
          "args": [
            "path16.path",
            "F_OK"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_win32__expand_path",
          "args": [
            "&path16",
            "*tmpl"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__expand_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "26-34",
          "snippet": "static int git_win32__expand_path(_findfile_path *dest, const wchar_t *src)\n{\n\tdest->len = ExpandEnvironmentStringsW(src, dest->path, ARRAY_SIZE(dest->path));\n\n\tif (!dest->len || dest->len > ARRAY_SIZE(dest->path))\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int git_win32__expand_path(_findfile_path *dest, const wchar_t *src)\n{\n\tdest->len = ExpandEnvironmentStringsW(src, dest->path, ARRAY_SIZE(dest->path));\n\n\tif (!dest->len || dest->len > ARRAY_SIZE(dest->path))\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_find_existing_dirs(\n\tgit_buf *out, const wchar_t *tmpl[])\n{\n\t_findfile_path path16;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tgit_buf_clear(out);\n\n\tfor (; *tmpl != NULL; tmpl++) {\n\t\tif (!git_win32__expand_path(&path16, *tmpl) &&\n\t\t\tpath16.path[0] != L'%' &&\n\t\t\t!_waccess(path16.path, F_OK))\n\t\t{\n\t\t\twin32_path_to_8(&buf, path16.path);\n\n\t\t\tif (buf.size)\n\t\t\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\t\t}\n\t}\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}"
  },
  {
    "function_name": "win32_find_git_in_registry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "105-138",
    "snippet": "static int win32_find_git_in_registry(\n\tgit_buf *buf, const HKEY hive, const wchar_t *key, const wchar_t *subdir)\n{\n\tHKEY hKey;\n\tint error = GIT_ENOTFOUND;\n\n\tassert(buf);\n\n\tif (!RegOpenKeyExW(hive, key, 0, KEY_READ, &hKey)) {\n\t\tDWORD dwType, cbData;\n\t\tgit_win32_path path;\n\n\t\t/* Ensure that the buffer is big enough to have the suffix attached\n\t\t * after we receive the result. */\n\t\tcbData = (DWORD)(sizeof(path) - wcslen(subdir) * sizeof(wchar_t));\n\n\t\t/* InstallLocation points to the root of the git directory */\n\t\tif (!RegQueryValueExW(hKey, L\"InstallLocation\", NULL, &dwType, (LPBYTE)path, &cbData) &&\n\t\t\tdwType == REG_SZ) {\n\n\t\t\t/* Append the suffix */\n\t\t\twcscat(path, subdir);\n\n\t\t\t/* Convert to UTF-8, with forward slashes, and output the path\n\t\t\t * to the provided buffer */\n\t\t\tif (!win32_path_to_8(buf, path))\n\t\t\t\terror = 0;\n\t\t}\n\n\t\tRegCloseKey(hKey);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RegCloseKey",
          "args": [
            "hKey"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "win32_path_to_8",
          "args": [
            "buf",
            "path"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "win32_path_to_8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "36-49",
          "snippet": "static int win32_path_to_8(git_buf *dest, const wchar_t *src)\n{\n\tgit_win32_utf8_path utf8_path;\n\n\tif (git_win32_path_to_utf8(utf8_path, src) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to convert path to UTF-8\");\n\t\treturn -1;\n\t}\n\n\t/* Convert backslashes to forward slashes */\n\tgit_path_mkposix(utf8_path);\n\n\treturn git_buf_sets(dest, utf8_path);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_path_to_8(git_buf *dest, const wchar_t *src)\n{\n\tgit_win32_utf8_path utf8_path;\n\n\tif (git_win32_path_to_utf8(utf8_path, src) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to convert path to UTF-8\");\n\t\treturn -1;\n\t}\n\n\t/* Convert backslashes to forward slashes */\n\tgit_path_mkposix(utf8_path);\n\n\treturn git_buf_sets(dest, utf8_path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wcscat",
          "args": [
            "path",
            "subdir"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegQueryValueExW",
          "args": [
            "hKey",
            "L\"InstallLocation\"",
            "NULL",
            "&dwType",
            "(LPBYTE)path",
            "&cbData"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sizeof(path) - wcslen(subdir) * sizeof(wchar_t)"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wcslen",
          "args": [
            "subdir"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegOpenKeyExW",
          "args": [
            "hive",
            "key",
            "0",
            "KEY_READ",
            "&hKey"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "buf"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_find_git_in_registry(\n\tgit_buf *buf, const HKEY hive, const wchar_t *key, const wchar_t *subdir)\n{\n\tHKEY hKey;\n\tint error = GIT_ENOTFOUND;\n\n\tassert(buf);\n\n\tif (!RegOpenKeyExW(hive, key, 0, KEY_READ, &hKey)) {\n\t\tDWORD dwType, cbData;\n\t\tgit_win32_path path;\n\n\t\t/* Ensure that the buffer is big enough to have the suffix attached\n\t\t * after we receive the result. */\n\t\tcbData = (DWORD)(sizeof(path) - wcslen(subdir) * sizeof(wchar_t));\n\n\t\t/* InstallLocation points to the root of the git directory */\n\t\tif (!RegQueryValueExW(hKey, L\"InstallLocation\", NULL, &dwType, (LPBYTE)path, &cbData) &&\n\t\t\tdwType == REG_SZ) {\n\n\t\t\t/* Append the suffix */\n\t\t\twcscat(path, subdir);\n\n\t\t\t/* Convert to UTF-8, with forward slashes, and output the path\n\t\t\t * to the provided buffer */\n\t\t\tif (!win32_path_to_8(buf, path))\n\t\t\t\terror = 0;\n\t\t}\n\n\t\tRegCloseKey(hKey);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "win32_find_git_in_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "70-103",
    "snippet": "static int win32_find_git_in_path(git_buf *buf, const wchar_t *gitexe, const wchar_t *subdir)\n{\n\twchar_t *env = _wgetenv(L\"PATH\"), lastch;\n\t_findfile_path root;\n\tsize_t gitexe_len = wcslen(gitexe);\n\n\tif (!env)\n\t\treturn -1;\n\n\twhile ((env = win32_walkpath(env, root.path, MAX_PATH-1)) && *root.path) {\n\t\troot.len = (DWORD)wcslen(root.path);\n\t\tlastch = root.path[root.len - 1];\n\n\t\t/* ensure trailing slash (MAX_PATH-1 to walkpath guarantees space) */\n\t\tif (lastch != L'/' && lastch != L'\\\\') {\n\t\t\troot.path[root.len++] = L'\\\\';\n\t\t\troot.path[root.len]   = L'\\0';\n\t\t}\n\n\t\tif (root.len + gitexe_len >= MAX_PATH)\n\t\t\tcontinue;\n\t\twcscpy(&root.path[root.len], gitexe);\n\n\t\tif (_waccess(root.path, F_OK) == 0 && root.len > 5) {\n\t\t\t/* replace \"bin\\\\\" or \"cmd\\\\\" with subdir */\n\t\t\twcscpy(&root.path[root.len - 4], subdir);\n\n\t\t\twin32_path_to_8(buf, root.path);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "win32_path_to_8",
          "args": [
            "buf",
            "root.path"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "win32_path_to_8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "36-49",
          "snippet": "static int win32_path_to_8(git_buf *dest, const wchar_t *src)\n{\n\tgit_win32_utf8_path utf8_path;\n\n\tif (git_win32_path_to_utf8(utf8_path, src) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to convert path to UTF-8\");\n\t\treturn -1;\n\t}\n\n\t/* Convert backslashes to forward slashes */\n\tgit_path_mkposix(utf8_path);\n\n\treturn git_buf_sets(dest, utf8_path);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_path_to_8(git_buf *dest, const wchar_t *src)\n{\n\tgit_win32_utf8_path utf8_path;\n\n\tif (git_win32_path_to_utf8(utf8_path, src) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to convert path to UTF-8\");\n\t\treturn -1;\n\t}\n\n\t/* Convert backslashes to forward slashes */\n\tgit_path_mkposix(utf8_path);\n\n\treturn git_buf_sets(dest, utf8_path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wcscpy",
          "args": [
            "&root.path[root.len - 4]",
            "subdir"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_waccess",
          "args": [
            "root.path",
            "F_OK"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wcscpy",
          "args": [
            "&root.path[root.len]",
            "gitexe"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wcslen",
          "args": [
            "root.path"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "win32_walkpath",
          "args": [
            "env",
            "root.path",
            "MAX_PATH-1"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "win32_walkpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "51-68",
          "snippet": "static wchar_t* win32_walkpath(wchar_t *path, wchar_t *buf, size_t buflen)\n{\n\twchar_t term, *base = path;\n\n\tassert(path && buf && buflen);\n\n\tterm = (*path == L'\"') ? *path++ : L';';\n\n\tfor (buflen--; *path && *path != term && buflen; buflen--)\n\t\t*buf++ = *path++;\n\n\t*buf = L'\\0'; /* reserved a byte via initial subtract */\n\n\twhile (*path == term || *path == L';')\n\t\tpath++;\n\n\treturn (path != base) ? path : NULL;\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic wchar_t* win32_walkpath(wchar_t *path, wchar_t *buf, size_t buflen)\n{\n\twchar_t term, *base = path;\n\n\tassert(path && buf && buflen);\n\n\tterm = (*path == L'\"') ? *path++ : L';';\n\n\tfor (buflen--; *path && *path != term && buflen; buflen--)\n\t\t*buf++ = *path++;\n\n\t*buf = L'\\0'; /* reserved a byte via initial subtract */\n\n\twhile (*path == term || *path == L';')\n\t\tpath++;\n\n\treturn (path != base) ? path : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wcslen",
          "args": [
            "gitexe"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_wgetenv",
          "args": [
            "L\"PATH\""
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_find_git_in_path(git_buf *buf, const wchar_t *gitexe, const wchar_t *subdir)\n{\n\twchar_t *env = _wgetenv(L\"PATH\"), lastch;\n\t_findfile_path root;\n\tsize_t gitexe_len = wcslen(gitexe);\n\n\tif (!env)\n\t\treturn -1;\n\n\twhile ((env = win32_walkpath(env, root.path, MAX_PATH-1)) && *root.path) {\n\t\troot.len = (DWORD)wcslen(root.path);\n\t\tlastch = root.path[root.len - 1];\n\n\t\t/* ensure trailing slash (MAX_PATH-1 to walkpath guarantees space) */\n\t\tif (lastch != L'/' && lastch != L'\\\\') {\n\t\t\troot.path[root.len++] = L'\\\\';\n\t\t\troot.path[root.len]   = L'\\0';\n\t\t}\n\n\t\tif (root.len + gitexe_len >= MAX_PATH)\n\t\t\tcontinue;\n\t\twcscpy(&root.path[root.len], gitexe);\n\n\t\tif (_waccess(root.path, F_OK) == 0 && root.len > 5) {\n\t\t\t/* replace \"bin\\\\\" or \"cmd\\\\\" with subdir */\n\t\t\twcscpy(&root.path[root.len - 4], subdir);\n\n\t\t\twin32_path_to_8(buf, root.path);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "win32_walkpath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "51-68",
    "snippet": "static wchar_t* win32_walkpath(wchar_t *path, wchar_t *buf, size_t buflen)\n{\n\twchar_t term, *base = path;\n\n\tassert(path && buf && buflen);\n\n\tterm = (*path == L'\"') ? *path++ : L';';\n\n\tfor (buflen--; *path && *path != term && buflen; buflen--)\n\t\t*buf++ = *path++;\n\n\t*buf = L'\\0'; /* reserved a byte via initial subtract */\n\n\twhile (*path == term || *path == L';')\n\t\tpath++;\n\n\treturn (path != base) ? path : NULL;\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "path && buf && buflen"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic wchar_t* win32_walkpath(wchar_t *path, wchar_t *buf, size_t buflen)\n{\n\twchar_t term, *base = path;\n\n\tassert(path && buf && buflen);\n\n\tterm = (*path == L'\"') ? *path++ : L';';\n\n\tfor (buflen--; *path && *path != term && buflen; buflen--)\n\t\t*buf++ = *path++;\n\n\t*buf = L'\\0'; /* reserved a byte via initial subtract */\n\n\twhile (*path == term || *path == L';')\n\t\tpath++;\n\n\treturn (path != base) ? path : NULL;\n}"
  },
  {
    "function_name": "win32_path_to_8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "36-49",
    "snippet": "static int win32_path_to_8(git_buf *dest, const wchar_t *src)\n{\n\tgit_win32_utf8_path utf8_path;\n\n\tif (git_win32_path_to_utf8(utf8_path, src) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to convert path to UTF-8\");\n\t\treturn -1;\n\t}\n\n\t/* Convert backslashes to forward slashes */\n\tgit_path_mkposix(utf8_path);\n\n\treturn git_buf_sets(dest, utf8_path);\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_sets",
          "args": [
            "dest",
            "utf8_path"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "181-184",
          "snippet": "int git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_mkposix",
          "args": [
            "utf8_path"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_mkposix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.h",
          "lines": "110-118",
          "snippet": "GIT_INLINE(void) git_path_mkposix(char *path)\n{\n\twhile (*path) {\n\t\tif (*path == '\\\\')\n\t\t\t*path = '/';\n\n\t\tpath++;\n\t}\n}",
          "includes": [
            "#include <iconv.h>",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iconv.h>\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) git_path_mkposix(char *path)\n{\n\twhile (*path) {\n\t\tif (*path == '\\\\')\n\t\t\t*path = '/';\n\n\t\tpath++;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Unable to convert path to UTF-8\""
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32_path_to_utf8",
          "args": [
            "utf8_path",
            "src"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32_path_to_utf8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/path_w32.c",
          "lines": "255-279",
          "snippet": "int git_win32_path_to_utf8(git_win32_utf8_path dest, const wchar_t *src)\n{\n\tchar *out = dest;\n\tint len;\n\n\t/* Strip NT namespacing \"\\\\?\\\" */\n\tif (path__is_nt_namespace(src)) {\n\t\tsrc += 4;\n\n\t\t/* \"\\\\?\\UNC\\server\\share\" -> \"\\\\server\\share\" */\n\t\tif (wcsncmp(src, L\"UNC\\\\\", 4) == 0) {\n\t\t\tsrc += 4;\n\n\t\t\tmemcpy(dest, \"\\\\\\\\\", 2);\n\t\t\tout = dest + 2;\n\t\t}\n\t}\n\n\tif ((len = git__utf16_to_8(out, GIT_WIN_PATH_UTF8, src)) < 0)\n\t\treturn len;\n\n\tgit_path_mkposix(dest);\n\n\treturn len;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"reparse.h\"",
            "#include \"posix.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"reparse.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_win32_path_to_utf8(git_win32_utf8_path dest, const wchar_t *src)\n{\n\tchar *out = dest;\n\tint len;\n\n\t/* Strip NT namespacing \"\\\\?\\\" */\n\tif (path__is_nt_namespace(src)) {\n\t\tsrc += 4;\n\n\t\t/* \"\\\\?\\UNC\\server\\share\" -> \"\\\\server\\share\" */\n\t\tif (wcsncmp(src, L\"UNC\\\\\", 4) == 0) {\n\t\t\tsrc += 4;\n\n\t\t\tmemcpy(dest, \"\\\\\\\\\", 2);\n\t\t\tout = dest + 2;\n\t\t}\n\t}\n\n\tif ((len = git__utf16_to_8(out, GIT_WIN_PATH_UTF8, src)) < 0)\n\t\treturn len;\n\n\tgit_path_mkposix(dest);\n\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int win32_path_to_8(git_buf *dest, const wchar_t *src)\n{\n\tgit_win32_utf8_path utf8_path;\n\n\tif (git_win32_path_to_utf8(utf8_path, src) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to convert path to UTF-8\");\n\t\treturn -1;\n\t}\n\n\t/* Convert backslashes to forward slashes */\n\tgit_path_mkposix(utf8_path);\n\n\treturn git_buf_sets(dest, utf8_path);\n}"
  },
  {
    "function_name": "git_win32__expand_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
    "lines": "26-34",
    "snippet": "static int git_win32__expand_path(_findfile_path *dest, const wchar_t *src)\n{\n\tdest->len = ExpandEnvironmentStringsW(src, dest->path, ARRAY_SIZE(dest->path));\n\n\tif (!dest->len || dest->len > ARRAY_SIZE(dest->path))\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"findfile.h\"",
      "#include \"path.h\"",
      "#include \"utf-conv.h\"",
      "#include \"path_w32.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "dest->path"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ExpandEnvironmentStringsW",
          "args": [
            "src",
            "dest->path",
            "ARRAY_SIZE(dest->path)"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "dest->path"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nstatic int git_win32__expand_path(_findfile_path *dest, const wchar_t *src)\n{\n\tdest->len = ExpandEnvironmentStringsW(src, dest->path, ARRAY_SIZE(dest->path));\n\n\tif (!dest->len || dest->len > ARRAY_SIZE(dest->path))\n\t\treturn -1;\n\n\treturn 0;\n}"
  }
]