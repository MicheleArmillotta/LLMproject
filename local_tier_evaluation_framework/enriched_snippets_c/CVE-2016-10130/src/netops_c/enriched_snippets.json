[
  {
    "function_name": "gitno_extract_url_parts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "227-286",
    "snippet": "int gitno_extract_url_parts(\n\t\tchar **host,\n\t\tchar **port,\n\t\tchar **path,\n\t\tchar **username,\n\t\tchar **password,\n\t\tconst char *url,\n\t\tconst char *default_port)\n{\n\tstruct http_parser_url u = {0};\n\tconst char *_host, *_port, *_path, *_userinfo;\n\n\tif (http_parser_parse_url(url, strlen(url), false, &u)) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL '%s'\", url);\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\t_host = url+u.field_data[UF_HOST].off;\n\t_port = url+u.field_data[UF_PORT].off;\n\t_path = url+u.field_data[UF_PATH].off;\n\t_userinfo = url+u.field_data[UF_USERINFO].off;\n\n\tif (u.field_set & (1 << UF_HOST)) {\n\t\t*host = git__substrdup(_host, u.field_data[UF_HOST].len);\n\t\tGITERR_CHECK_ALLOC(*host);\n\t}\n\n\tif (u.field_set & (1 << UF_PORT))\n\t\t*port = git__substrdup(_port, u.field_data[UF_PORT].len);\n\telse\n\t\t*port = git__strdup(default_port);\n\tGITERR_CHECK_ALLOC(*port);\n\n\tif (u.field_set & (1 << UF_PATH)) {\n\t\t*path = git__substrdup(_path, u.field_data[UF_PATH].len);\n\t\tGITERR_CHECK_ALLOC(*path);\n\t} else {\n\t\tgit__free(*port);\n\t\t*port = NULL;\n\t\tgit__free(*host);\n\t\t*host = NULL;\n\t\tgiterr_set(GITERR_NET, \"invalid url, missing path\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (u.field_set & (1 << UF_USERINFO)) {\n\t\tconst char *colon = memchr(_userinfo, ':', u.field_data[UF_USERINFO].len);\n\t\tif (colon) {\n\t\t\t*username = unescape(git__substrdup(_userinfo, colon - _userinfo));\n\t\t\t*password = unescape(git__substrdup(colon+1, u.field_data[UF_USERINFO].len - (colon+1-_userinfo)));\n\t\t\tGITERR_CHECK_ALLOC(*password);\n\t\t} else {\n\t\t\t*username = git__substrdup(_userinfo, u.field_data[UF_USERINFO].len);\n\t\t}\n\t\tGITERR_CHECK_ALLOC(*username);\n\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "*username"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__substrdup",
          "args": [
            "_userinfo",
            "u.field_data[UF_USERINFO].len"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "git__substrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "201-213",
          "snippet": "GIT_INLINE(char *) git__substrdup(const char *start, size_t n)\n{\n\tchar *ptr;\n\tsize_t alloclen;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclen, n, 1) ||\n\t\t!(ptr = git__malloc(alloclen)))\n\t\treturn NULL;\n\n\tmemcpy(ptr, start, n);\n\tptr[n] = '\\0';\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__substrdup(const char *start, size_t n)\n{\n\tchar *ptr;\n\tsize_t alloclen;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclen, n, 1) ||\n\t\t!(ptr = git__malloc(alloclen)))\n\t\treturn NULL;\n\n\tmemcpy(ptr, start, n);\n\tptr[n] = '\\0';\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "*password"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unescape",
          "args": [
            "git__substrdup(colon+1, u.field_data[UF_USERINFO].len - (colon+1-_userinfo))"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "unescape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "210-225",
          "snippet": "static char* unescape(char *str)\n{\n\tint x, y;\n\tint len = (int)strlen(str);\n\n\tfor (x=y=0; str[y]; ++x, ++y) {\n\t\tif ((str[x] = str[y]) == '%') {\n\t\t\tif (y < len-2 && isxdigit(str[y+1]) && isxdigit(str[y+2])) {\n\t\t\t\tstr[x] = (hex2c(str[y+1]) << 4) + hex2c(str[y+2]);\n\t\t\t\ty += 2;\n\t\t\t}\n\t\t}\n\t}\n\tstr[x] = '\\0';\n\treturn str;\n}",
          "includes": [
            "#include \"global.h\"",
            "#include \"http_parser.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"netops.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nstatic char* unescape(char *str)\n{\n\tint x, y;\n\tint len = (int)strlen(str);\n\n\tfor (x=y=0; str[y]; ++x, ++y) {\n\t\tif ((str[x] = str[y]) == '%') {\n\t\t\tif (y < len-2 && isxdigit(str[y+1]) && isxdigit(str[y+2])) {\n\t\t\t\tstr[x] = (hex2c(str[y+1]) << 4) + hex2c(str[y+2]);\n\t\t\t\ty += 2;\n\t\t\t}\n\t\t}\n\t}\n\tstr[x] = '\\0';\n\treturn str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "_userinfo",
            "':'",
            "u.field_data[UF_USERINFO].len"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"invalid url, missing path\""
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "*host"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "*path"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "*port"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "default_port"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "*host"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"Malformed URL '%s'\"",
            "url"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "http_parser_parse_url",
          "args": [
            "url",
            "strlen(url)",
            "false",
            "&u"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "url"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nint gitno_extract_url_parts(\n\t\tchar **host,\n\t\tchar **port,\n\t\tchar **path,\n\t\tchar **username,\n\t\tchar **password,\n\t\tconst char *url,\n\t\tconst char *default_port)\n{\n\tstruct http_parser_url u = {0};\n\tconst char *_host, *_port, *_path, *_userinfo;\n\n\tif (http_parser_parse_url(url, strlen(url), false, &u)) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL '%s'\", url);\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\t_host = url+u.field_data[UF_HOST].off;\n\t_port = url+u.field_data[UF_PORT].off;\n\t_path = url+u.field_data[UF_PATH].off;\n\t_userinfo = url+u.field_data[UF_USERINFO].off;\n\n\tif (u.field_set & (1 << UF_HOST)) {\n\t\t*host = git__substrdup(_host, u.field_data[UF_HOST].len);\n\t\tGITERR_CHECK_ALLOC(*host);\n\t}\n\n\tif (u.field_set & (1 << UF_PORT))\n\t\t*port = git__substrdup(_port, u.field_data[UF_PORT].len);\n\telse\n\t\t*port = git__strdup(default_port);\n\tGITERR_CHECK_ALLOC(*port);\n\n\tif (u.field_set & (1 << UF_PATH)) {\n\t\t*path = git__substrdup(_path, u.field_data[UF_PATH].len);\n\t\tGITERR_CHECK_ALLOC(*path);\n\t} else {\n\t\tgit__free(*port);\n\t\t*port = NULL;\n\t\tgit__free(*host);\n\t\t*host = NULL;\n\t\tgiterr_set(GITERR_NET, \"invalid url, missing path\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (u.field_set & (1 << UF_USERINFO)) {\n\t\tconst char *colon = memchr(_userinfo, ':', u.field_data[UF_USERINFO].len);\n\t\tif (colon) {\n\t\t\t*username = unescape(git__substrdup(_userinfo, colon - _userinfo));\n\t\t\t*password = unescape(git__substrdup(colon+1, u.field_data[UF_USERINFO].len - (colon+1-_userinfo)));\n\t\t\tGITERR_CHECK_ALLOC(*password);\n\t\t} else {\n\t\t\t*username = git__substrdup(_userinfo, u.field_data[UF_USERINFO].len);\n\t\t}\n\t\tGITERR_CHECK_ALLOC(*username);\n\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "unescape",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "210-225",
    "snippet": "static char* unescape(char *str)\n{\n\tint x, y;\n\tint len = (int)strlen(str);\n\n\tfor (x=y=0; str[y]; ++x, ++y) {\n\t\tif ((str[x] = str[y]) == '%') {\n\t\t\tif (y < len-2 && isxdigit(str[y+1]) && isxdigit(str[y+2])) {\n\t\t\t\tstr[x] = (hex2c(str[y+1]) << 4) + hex2c(str[y+2]);\n\t\t\t\ty += 2;\n\t\t\t}\n\t\t}\n\t}\n\tstr[x] = '\\0';\n\treturn str;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hex2c",
          "args": [
            "str[y+2]"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hex2c",
          "args": [
            "str[y+1]"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isxdigit",
          "args": [
            "str[y+2]"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isxdigit",
          "args": [
            "str[y+1]"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nstatic char* unescape(char *str)\n{\n\tint x, y;\n\tint len = (int)strlen(str);\n\n\tfor (x=y=0; str[y]; ++x, ++y) {\n\t\tif ((str[x] = str[y]) == '%') {\n\t\t\tif (y < len-2 && isxdigit(str[y+1]) && isxdigit(str[y+2])) {\n\t\t\t\tstr[x] = (hex2c(str[y+1]) << 4) + hex2c(str[y+2]);\n\t\t\t\ty += 2;\n\t\t\t}\n\t\t}\n\t}\n\tstr[x] = '\\0';\n\treturn str;\n}"
  },
  {
    "function_name": "gitno_connection_data_free_ptrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "200-207",
    "snippet": "void gitno_connection_data_free_ptrs(gitno_connection_data *d)\n{\n\tgit__free(d->host); d->host = NULL;\n\tgit__free(d->port); d->port = NULL;\n\tgit__free(d->path); d->path = NULL;\n\tgit__free(d->user); d->user = NULL;\n\tgit__free(d->pass); d->pass = NULL;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "d->pass"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nvoid gitno_connection_data_free_ptrs(gitno_connection_data *d)\n{\n\tgit__free(d->host); d->host = NULL;\n\tgit__free(d->port); d->port = NULL;\n\tgit__free(d->path); d->path = NULL;\n\tgit__free(d->user); d->user = NULL;\n\tgit__free(d->pass); d->pass = NULL;\n}"
  },
  {
    "function_name": "gitno_connection_data_from_url",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "125-198",
    "snippet": "int gitno_connection_data_from_url(\n\t\tgitno_connection_data *data,\n\t\tconst char *url,\n\t\tconst char *service_suffix)\n{\n\tint error = -1;\n\tconst char *default_port = NULL, *path_search_start = NULL;\n\tchar *original_host = NULL;\n\n\t/* service_suffix is optional */\n\tassert(data && url);\n\n\t/* Save these for comparison later */\n\toriginal_host = data->host;\n\tdata->host = NULL;\n\tgitno_connection_data_free_ptrs(data);\n\n\tif (!git__prefixcmp(url, prefix_http)) {\n\t\tpath_search_start = url + strlen(prefix_http);\n\t\tdefault_port = \"80\";\n\n\t\tif (data->use_ssl) {\n\t\t\tgiterr_set(GITERR_NET, \"Redirect from HTTPS to HTTP is not allowed\");\n\t\t\tgoto cleanup;\n\t\t}\n\t} else if (!git__prefixcmp(url, prefix_https)) {\n\t\tpath_search_start = url + strlen(prefix_https);\n\t\tdefault_port = \"443\";\n\t\tdata->use_ssl = true;\n\t} else if (url[0] == '/')\n\t\tdefault_port = data->use_ssl ? \"443\" : \"80\";\n\n\tif (!default_port) {\n\t\tgiterr_set(GITERR_NET, \"Unrecognized URL prefix\");\n\t\tgoto cleanup;\n\t}\n\n\terror = gitno_extract_url_parts(\n\t\t&data->host, &data->port, &data->path, &data->user, &data->pass,\n\t\turl, default_port);\n\n\tif (url[0] == '/') {\n\t\t/* Relative redirect; reuse original host name and port */\n\t\tpath_search_start = url;\n\t\tgit__free(data->host);\n\t\tdata->host = original_host;\n\t\toriginal_host = NULL;\n\t}\n\n\tif (!error) {\n\t\tconst char *path = strchr(path_search_start, '/');\n\t\tsize_t pathlen = strlen(path);\n\t\tsize_t suffixlen = service_suffix ? strlen(service_suffix) : 0;\n\n\t\tif (suffixlen &&\n\t\t    !memcmp(path + pathlen - suffixlen, service_suffix, suffixlen)) {\n\t\t\tgit__free(data->path);\n\t\t\tdata->path = git__strndup(path, pathlen - suffixlen);\n\t\t} else {\n\t\t\tgit__free(data->path);\n\t\t\tdata->path = git__strdup(path);\n\t\t}\n\n\t\t/* Check for errors in the resulting data */\n\t\tif (original_host && url[0] != '/' && strcmp(original_host, data->host)) {\n\t\t\tgiterr_set(GITERR_NET, \"Cross host redirect not allowed\");\n\t\t\terror = -1;\n\t\t}\n\t}\n\ncleanup:\n\tif (original_host) git__free(original_host);\n\treturn error;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *prefix_http = \"http://\";",
      "static const char *prefix_https = \"https://\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "original_host"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"Cross host redirect not allowed\""
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "original_host",
            "data->host"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "path"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strndup",
          "args": [
            "path",
            "pathlen - suffixlen"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "git__strndup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "181-198",
          "snippet": "GIT_INLINE(char *) git__strndup(const char *str, size_t n)\n{\n\tsize_t length = 0, alloclength;\n\tchar *ptr;\n\n\tlength = p_strnlen(str, n);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclength, length, 1) ||\n\t\t!(ptr = git__malloc(alloclength)))\n\t\treturn NULL;\n\n\tif (length)\n\t\tmemcpy(ptr, str, length);\n\n\tptr[length] = '\\0';\n\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strndup(const char *str, size_t n)\n{\n\tsize_t length = 0, alloclength;\n\tchar *ptr;\n\n\tlength = p_strnlen(str, n);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclength, length, 1) ||\n\t\t!(ptr = git__malloc(alloclength)))\n\t\treturn NULL;\n\n\tif (length)\n\t\tmemcpy(ptr, str, length);\n\n\tptr[length] = '\\0';\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "path + pathlen - suffixlen",
            "service_suffix",
            "suffixlen"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "service_suffix"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "path"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "path_search_start",
            "'/'"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gitno_extract_url_parts",
          "args": [
            "&data->host",
            "&data->port",
            "&data->path",
            "&data->user",
            "&data->pass",
            "url",
            "default_port"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "gitno_extract_url_parts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "227-286",
          "snippet": "int gitno_extract_url_parts(\n\t\tchar **host,\n\t\tchar **port,\n\t\tchar **path,\n\t\tchar **username,\n\t\tchar **password,\n\t\tconst char *url,\n\t\tconst char *default_port)\n{\n\tstruct http_parser_url u = {0};\n\tconst char *_host, *_port, *_path, *_userinfo;\n\n\tif (http_parser_parse_url(url, strlen(url), false, &u)) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL '%s'\", url);\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\t_host = url+u.field_data[UF_HOST].off;\n\t_port = url+u.field_data[UF_PORT].off;\n\t_path = url+u.field_data[UF_PATH].off;\n\t_userinfo = url+u.field_data[UF_USERINFO].off;\n\n\tif (u.field_set & (1 << UF_HOST)) {\n\t\t*host = git__substrdup(_host, u.field_data[UF_HOST].len);\n\t\tGITERR_CHECK_ALLOC(*host);\n\t}\n\n\tif (u.field_set & (1 << UF_PORT))\n\t\t*port = git__substrdup(_port, u.field_data[UF_PORT].len);\n\telse\n\t\t*port = git__strdup(default_port);\n\tGITERR_CHECK_ALLOC(*port);\n\n\tif (u.field_set & (1 << UF_PATH)) {\n\t\t*path = git__substrdup(_path, u.field_data[UF_PATH].len);\n\t\tGITERR_CHECK_ALLOC(*path);\n\t} else {\n\t\tgit__free(*port);\n\t\t*port = NULL;\n\t\tgit__free(*host);\n\t\t*host = NULL;\n\t\tgiterr_set(GITERR_NET, \"invalid url, missing path\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (u.field_set & (1 << UF_USERINFO)) {\n\t\tconst char *colon = memchr(_userinfo, ':', u.field_data[UF_USERINFO].len);\n\t\tif (colon) {\n\t\t\t*username = unescape(git__substrdup(_userinfo, colon - _userinfo));\n\t\t\t*password = unescape(git__substrdup(colon+1, u.field_data[UF_USERINFO].len - (colon+1-_userinfo)));\n\t\t\tGITERR_CHECK_ALLOC(*password);\n\t\t} else {\n\t\t\t*username = git__substrdup(_userinfo, u.field_data[UF_USERINFO].len);\n\t\t}\n\t\tGITERR_CHECK_ALLOC(*username);\n\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"global.h\"",
            "#include \"http_parser.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"netops.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nint gitno_extract_url_parts(\n\t\tchar **host,\n\t\tchar **port,\n\t\tchar **path,\n\t\tchar **username,\n\t\tchar **password,\n\t\tconst char *url,\n\t\tconst char *default_port)\n{\n\tstruct http_parser_url u = {0};\n\tconst char *_host, *_port, *_path, *_userinfo;\n\n\tif (http_parser_parse_url(url, strlen(url), false, &u)) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL '%s'\", url);\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\t_host = url+u.field_data[UF_HOST].off;\n\t_port = url+u.field_data[UF_PORT].off;\n\t_path = url+u.field_data[UF_PATH].off;\n\t_userinfo = url+u.field_data[UF_USERINFO].off;\n\n\tif (u.field_set & (1 << UF_HOST)) {\n\t\t*host = git__substrdup(_host, u.field_data[UF_HOST].len);\n\t\tGITERR_CHECK_ALLOC(*host);\n\t}\n\n\tif (u.field_set & (1 << UF_PORT))\n\t\t*port = git__substrdup(_port, u.field_data[UF_PORT].len);\n\telse\n\t\t*port = git__strdup(default_port);\n\tGITERR_CHECK_ALLOC(*port);\n\n\tif (u.field_set & (1 << UF_PATH)) {\n\t\t*path = git__substrdup(_path, u.field_data[UF_PATH].len);\n\t\tGITERR_CHECK_ALLOC(*path);\n\t} else {\n\t\tgit__free(*port);\n\t\t*port = NULL;\n\t\tgit__free(*host);\n\t\t*host = NULL;\n\t\tgiterr_set(GITERR_NET, \"invalid url, missing path\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (u.field_set & (1 << UF_USERINFO)) {\n\t\tconst char *colon = memchr(_userinfo, ':', u.field_data[UF_USERINFO].len);\n\t\tif (colon) {\n\t\t\t*username = unescape(git__substrdup(_userinfo, colon - _userinfo));\n\t\t\t*password = unescape(git__substrdup(colon+1, u.field_data[UF_USERINFO].len - (colon+1-_userinfo)));\n\t\t\tGITERR_CHECK_ALLOC(*password);\n\t\t} else {\n\t\t\t*username = git__substrdup(_userinfo, u.field_data[UF_USERINFO].len);\n\t\t}\n\t\tGITERR_CHECK_ALLOC(*username);\n\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prefix_https"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__prefixcmp",
          "args": [
            "url",
            "prefix_https"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "git__prefixcmp_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "252-255",
          "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prefix_http"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gitno_connection_data_free_ptrs",
          "args": [
            "data"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "gitno_connection_data_free_ptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "200-207",
          "snippet": "void gitno_connection_data_free_ptrs(gitno_connection_data *d)\n{\n\tgit__free(d->host); d->host = NULL;\n\tgit__free(d->port); d->port = NULL;\n\tgit__free(d->path); d->path = NULL;\n\tgit__free(d->user); d->user = NULL;\n\tgit__free(d->pass); d->pass = NULL;\n}",
          "includes": [
            "#include \"global.h\"",
            "#include \"http_parser.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"netops.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nvoid gitno_connection_data_free_ptrs(gitno_connection_data *d)\n{\n\tgit__free(d->host); d->host = NULL;\n\tgit__free(d->port); d->port = NULL;\n\tgit__free(d->path); d->path = NULL;\n\tgit__free(d->user); d->user = NULL;\n\tgit__free(d->pass); d->pass = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "data && url"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nstatic const char *prefix_http = \"http://\";\nstatic const char *prefix_https = \"https://\";\n\nint gitno_connection_data_from_url(\n\t\tgitno_connection_data *data,\n\t\tconst char *url,\n\t\tconst char *service_suffix)\n{\n\tint error = -1;\n\tconst char *default_port = NULL, *path_search_start = NULL;\n\tchar *original_host = NULL;\n\n\t/* service_suffix is optional */\n\tassert(data && url);\n\n\t/* Save these for comparison later */\n\toriginal_host = data->host;\n\tdata->host = NULL;\n\tgitno_connection_data_free_ptrs(data);\n\n\tif (!git__prefixcmp(url, prefix_http)) {\n\t\tpath_search_start = url + strlen(prefix_http);\n\t\tdefault_port = \"80\";\n\n\t\tif (data->use_ssl) {\n\t\t\tgiterr_set(GITERR_NET, \"Redirect from HTTPS to HTTP is not allowed\");\n\t\t\tgoto cleanup;\n\t\t}\n\t} else if (!git__prefixcmp(url, prefix_https)) {\n\t\tpath_search_start = url + strlen(prefix_https);\n\t\tdefault_port = \"443\";\n\t\tdata->use_ssl = true;\n\t} else if (url[0] == '/')\n\t\tdefault_port = data->use_ssl ? \"443\" : \"80\";\n\n\tif (!default_port) {\n\t\tgiterr_set(GITERR_NET, \"Unrecognized URL prefix\");\n\t\tgoto cleanup;\n\t}\n\n\terror = gitno_extract_url_parts(\n\t\t&data->host, &data->port, &data->path, &data->user, &data->pass,\n\t\turl, default_port);\n\n\tif (url[0] == '/') {\n\t\t/* Relative redirect; reuse original host name and port */\n\t\tpath_search_start = url;\n\t\tgit__free(data->host);\n\t\tdata->host = original_host;\n\t\toriginal_host = NULL;\n\t}\n\n\tif (!error) {\n\t\tconst char *path = strchr(path_search_start, '/');\n\t\tsize_t pathlen = strlen(path);\n\t\tsize_t suffixlen = service_suffix ? strlen(service_suffix) : 0;\n\n\t\tif (suffixlen &&\n\t\t    !memcmp(path + pathlen - suffixlen, service_suffix, suffixlen)) {\n\t\t\tgit__free(data->path);\n\t\t\tdata->path = git__strndup(path, pathlen - suffixlen);\n\t\t} else {\n\t\t\tgit__free(data->path);\n\t\t\tdata->path = git__strdup(path);\n\t\t}\n\n\t\t/* Check for errors in the resulting data */\n\t\tif (original_host && url[0] != '/' && strcmp(original_host, data->host)) {\n\t\t\tgiterr_set(GITERR_NET, \"Cross host redirect not allowed\");\n\t\t\terror = -1;\n\t\t}\n\t}\n\ncleanup:\n\tif (original_host) git__free(original_host);\n\treturn error;\n}"
  },
  {
    "function_name": "gitno__match_host",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "84-120",
    "snippet": "int gitno__match_host(const char *pattern, const char *host)\n{\n\tfor (;;) {\n\t\tchar c = git__tolower(*pattern++);\n\n\t\tif (c == '\\0')\n\t\t\treturn *host ? -1 : 0;\n\n\t\tif (c == '*') {\n\t\t\tc = *pattern;\n\t\t\t/* '*' at the end matches everything left */\n\t\t\tif (c == '\\0')\n\t\t\t\treturn 0;\n\n\t/*\n\t * We've found a pattern, so move towards the next matching\n\t * char. The '.' is handled specially because wildcards aren't\n\t * allowed to cross subdomains.\n\t */\n\n\t\t\twhile(*host) {\n\t\t\t\tchar h = git__tolower(*host);\n\t\t\t\tif (c == h)\n\t\t\t\t\treturn gitno__match_host(pattern, host++);\n\t\t\t\tif (h == '.')\n\t\t\t\t\treturn gitno__match_host(pattern, host);\n\t\t\t\thost++;\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (c != git__tolower(*host++))\n\t\t\treturn -1;\n\t}\n\n\treturn -1;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__tolower",
          "args": [
            "*host++"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "git__tolower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "285-288",
          "snippet": "GIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gitno__match_host",
          "args": [
            "pattern",
            "host"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "gitno__match_host",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "84-120",
          "snippet": "int gitno__match_host(const char *pattern, const char *host)\n{\n\tfor (;;) {\n\t\tchar c = git__tolower(*pattern++);\n\n\t\tif (c == '\\0')\n\t\t\treturn *host ? -1 : 0;\n\n\t\tif (c == '*') {\n\t\t\tc = *pattern;\n\t\t\t/* '*' at the end matches everything left */\n\t\t\tif (c == '\\0')\n\t\t\t\treturn 0;\n\n\t/*\n\t * We've found a pattern, so move towards the next matching\n\t * char. The '.' is handled specially because wildcards aren't\n\t * allowed to cross subdomains.\n\t */\n\n\t\t\twhile(*host) {\n\t\t\t\tchar h = git__tolower(*host);\n\t\t\t\tif (c == h)\n\t\t\t\t\treturn gitno__match_host(pattern, host++);\n\t\t\t\tif (h == '.')\n\t\t\t\t\treturn gitno__match_host(pattern, host);\n\t\t\t\thost++;\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (c != git__tolower(*host++))\n\t\t\treturn -1;\n\t}\n\n\treturn -1;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nint gitno__match_host(const char *pattern, const char *host)\n{\n\tfor (;;) {\n\t\tchar c = git__tolower(*pattern++);\n\n\t\tif (c == '\\0')\n\t\t\treturn *host ? -1 : 0;\n\n\t\tif (c == '*') {\n\t\t\tc = *pattern;\n\t\t\t/* '*' at the end matches everything left */\n\t\t\tif (c == '\\0')\n\t\t\t\treturn 0;\n\n\t/*\n\t * We've found a pattern, so move towards the next matching\n\t * char. The '.' is handled specially because wildcards aren't\n\t * allowed to cross subdomains.\n\t */\n\n\t\t\twhile(*host) {\n\t\t\t\tchar h = git__tolower(*host);\n\t\t\t\tif (c == h)\n\t\t\t\t\treturn gitno__match_host(pattern, host++);\n\t\t\t\tif (h == '.')\n\t\t\t\t\treturn gitno__match_host(pattern, host);\n\t\t\t\thost++;\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (c != git__tolower(*host++))\n\t\t\treturn -1;\n\t}\n\n\treturn -1;\n}"
  },
  {
    "function_name": "gitno_consume_n",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "76-81",
    "snippet": "void gitno_consume_n(gitno_buffer *buf, size_t cons)\n{\n\tmemmove(buf->data, buf->data + cons, buf->len - buf->offset);\n\tmemset(buf->data + cons, 0x0, buf->len - buf->offset);\n\tbuf->offset -= cons;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf->data + cons",
            "0x0",
            "buf->len - buf->offset"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "buf->data",
            "buf->data + cons",
            "buf->len - buf->offset"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nvoid gitno_consume_n(gitno_buffer *buf, size_t cons)\n{\n\tmemmove(buf->data, buf->data + cons, buf->len - buf->offset);\n\tmemset(buf->data + cons, 0x0, buf->len - buf->offset);\n\tbuf->offset -= cons;\n}"
  },
  {
    "function_name": "gitno_consume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "61-73",
    "snippet": "void gitno_consume(gitno_buffer *buf, const char *ptr)\n{\n\tsize_t consumed;\n\n\tassert(ptr - buf->data >= 0);\n\tassert(ptr - buf->data <= (int) buf->len);\n\n\tconsumed = ptr - buf->data;\n\n\tmemmove(buf->data, ptr, buf->offset - consumed);\n\tmemset(buf->data + buf->offset, 0x0, buf->len - buf->offset);\n\tbuf->offset -= consumed;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf->data + buf->offset",
            "0x0",
            "buf->len - buf->offset"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "buf->data",
            "ptr",
            "buf->offset - consumed"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ptr - buf->data <= (int) buf->len"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ptr - buf->data >= 0"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nvoid gitno_consume(gitno_buffer *buf, const char *ptr)\n{\n\tsize_t consumed;\n\n\tassert(ptr - buf->data >= 0);\n\tassert(ptr - buf->data <= (int) buf->len);\n\n\tconsumed = ptr - buf->data;\n\n\tmemmove(buf->data, ptr, buf->offset - consumed);\n\tmemset(buf->data + buf->offset, 0x0, buf->len - buf->offset);\n\tbuf->offset -= consumed;\n}"
  },
  {
    "function_name": "gitno_buffer_setup_fromstream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "50-58",
    "snippet": "void gitno_buffer_setup_fromstream(git_stream *st, gitno_buffer *buf, char *data, size_t len)\n{\n\tmemset(data, 0x0, len);\n\tbuf->data = data;\n\tbuf->len = len;\n\tbuf->offset = 0;\n\tbuf->recv = recv_stream;\n\tbuf->cb_data = st;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data",
            "0x0",
            "len"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nvoid gitno_buffer_setup_fromstream(git_stream *st, gitno_buffer *buf, char *data, size_t len)\n{\n\tmemset(data, 0x0, len);\n\tbuf->data = data;\n\tbuf->len = len;\n\tbuf->offset = 0;\n\tbuf->recv = recv_stream;\n\tbuf->cb_data = st;\n}"
  },
  {
    "function_name": "recv_stream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "37-48",
    "snippet": "static int recv_stream(gitno_buffer *buf)\n{\n\tgit_stream *io = (git_stream *) buf->cb_data;\n\tint ret;\n\n\tret = git_stream_read(io, buf->data + buf->offset, buf->len - buf->offset);\n\tif (ret < 0)\n\t\treturn -1;\n\n\tbuf->offset += ret;\n\treturn ret;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_read",
          "args": [
            "io",
            "buf->data + buf->offset",
            "buf->len - buf->offset"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "48-51",
          "snippet": "GIT_INLINE(ssize_t) git_stream_read(git_stream *st, void *data, size_t len)\n{\n\treturn st->read(st, data, len);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(ssize_t) git_stream_read(git_stream *st, void *data, size_t len)\n{\n\treturn st->read(st, data, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nstatic int recv_stream(gitno_buffer *buf)\n{\n\tgit_stream *io = (git_stream *) buf->cb_data;\n\tint ret;\n\n\tret = git_stream_read(io, buf->data + buf->offset, buf->len - buf->offset);\n\tif (ret < 0)\n\t\treturn -1;\n\n\tbuf->offset += ret;\n\treturn ret;\n}"
  },
  {
    "function_name": "gitno_buffer_setup_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "23-35",
    "snippet": "void gitno_buffer_setup_callback(\n\tgitno_buffer *buf,\n\tchar *data,\n\tsize_t len,\n\tint (*recv)(gitno_buffer *buf), void *cb_data)\n{\n\tmemset(data, 0x0, len);\n\tbuf->data = data;\n\tbuf->len = len;\n\tbuf->offset = 0;\n\tbuf->recv = recv;\n\tbuf->cb_data = cb_data;\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data",
            "0x0",
            "len"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nvoid gitno_buffer_setup_callback(\n\tgitno_buffer *buf,\n\tchar *data,\n\tsize_t len,\n\tint (*recv)(gitno_buffer *buf), void *cb_data)\n{\n\tmemset(data, 0x0, len);\n\tbuf->data = data;\n\tbuf->len = len;\n\tbuf->offset = 0;\n\tbuf->recv = recv;\n\tbuf->cb_data = cb_data;\n}"
  },
  {
    "function_name": "gitno_recv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
    "lines": "18-21",
    "snippet": "int gitno_recv(gitno_buffer *buf)\n{\n\treturn buf->recv(buf);\n}",
    "includes": [
      "#include \"global.h\"",
      "#include \"http_parser.h\"",
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"netops.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "buf->recv",
          "args": [
            "buf"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nint gitno_recv(gitno_buffer *buf)\n{\n\treturn buf->recv(buf);\n}"
  }
]