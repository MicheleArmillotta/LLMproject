[
  {
    "function_name": "git_filter_list_stream_blob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "1000-1014",
    "snippet": "int git_filter_list_stream_blob(\n\tgit_filter_list *filters,\n\tgit_blob *blob,\n\tgit_writestream *target)\n{\n\tgit_buf in = GIT_BUF_INIT;\n\n\tif (buf_from_blob(&in, blob) < 0)\n\t\treturn -1;\n\n\tif (filters)\n\t\tgit_oid_cpy(&filters->source.oid, git_blob_id(blob));\n\n\treturn git_filter_list_stream_data(filters, &in, target);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_filter_list_stream_data",
          "args": [
            "filters",
            "&in",
            "target"
          ],
          "line": 1013
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_list_stream_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "977-998",
          "snippet": "int git_filter_list_stream_data(\n\tgit_filter_list *filters,\n\tgit_buf *data,\n\tgit_writestream *target)\n{\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tint error = 0, close_error;\n\n\tgit_buf_sanitize(data);\n\n\tif ((error = stream_list_init(&stream_start, &filter_streams, filters, target)) < 0)\n\t\tgoto out;\n\n\terror = stream_start->write(stream_start, data->ptr, data->size);\n\nout:\n\tclose_error = stream_start->close(stream_start);\n\tstream_list_free(&filter_streams);\n\t/* propagate the stream init or write error */\n\treturn error < 0 ? error : close_error;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_stream_data(\n\tgit_filter_list *filters,\n\tgit_buf *data,\n\tgit_writestream *target)\n{\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tint error = 0, close_error;\n\n\tgit_buf_sanitize(data);\n\n\tif ((error = stream_list_init(&stream_start, &filter_streams, filters, target)) < 0)\n\t\tgoto out;\n\n\terror = stream_start->write(stream_start, data->ptr, data->size);\n\nout:\n\tclose_error = stream_start->close(stream_start);\n\tstream_list_free(&filter_streams);\n\t/* propagate the stream init or write error */\n\treturn error < 0 ? error : close_error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&filters->source.oid",
            "git_blob_id(blob)"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_id",
          "args": [
            "blob"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "121-124",
          "snippet": "const git_oid *git_blob_id(const git_blob *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_blob_id(const git_blob *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buf_from_blob",
          "args": [
            "&in",
            "blob"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "buf_from_blob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "756-767",
          "snippet": "static int buf_from_blob(git_buf *out, git_blob *blob)\n{\n\tgit_off_t rawsize = git_blob_rawsize(blob);\n\n\tif (!git__is_sizet(rawsize)) {\n\t\tgiterr_set(GITERR_OS, \"Blob is too large to filter\");\n\t\treturn -1;\n\t}\n\n\tgit_buf_attach_notowned(out, git_blob_rawcontent(blob), (size_t)rawsize);\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int buf_from_blob(git_buf *out, git_blob *blob)\n{\n\tgit_off_t rawsize = git_blob_rawsize(blob);\n\n\tif (!git__is_sizet(rawsize)) {\n\t\tgiterr_set(GITERR_OS, \"Blob is too large to filter\");\n\t\treturn -1;\n\t}\n\n\tgit_buf_attach_notowned(out, git_blob_rawcontent(blob), (size_t)rawsize);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_stream_blob(\n\tgit_filter_list *filters,\n\tgit_blob *blob,\n\tgit_writestream *target)\n{\n\tgit_buf in = GIT_BUF_INIT;\n\n\tif (buf_from_blob(&in, blob) < 0)\n\t\treturn -1;\n\n\tif (filters)\n\t\tgit_oid_cpy(&filters->source.oid, git_blob_id(blob));\n\n\treturn git_filter_list_stream_data(filters, &in, target);\n}"
  },
  {
    "function_name": "git_filter_list_stream_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "977-998",
    "snippet": "int git_filter_list_stream_data(\n\tgit_filter_list *filters,\n\tgit_buf *data,\n\tgit_writestream *target)\n{\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tint error = 0, close_error;\n\n\tgit_buf_sanitize(data);\n\n\tif ((error = stream_list_init(&stream_start, &filter_streams, filters, target)) < 0)\n\t\tgoto out;\n\n\terror = stream_start->write(stream_start, data->ptr, data->size);\n\nout:\n\tclose_error = stream_start->close(stream_start);\n\tstream_list_free(&filter_streams);\n\t/* propagate the stream init or write error */\n\treturn error < 0 ? error : close_error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stream_list_free",
          "args": [
            "&filter_streams"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "stream_list_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "924-932",
          "snippet": "void stream_list_free(git_vector *streams)\n{\n\tgit_writestream *stream;\n\tsize_t i;\n\n\tgit_vector_foreach(streams, i, stream)\n\t\tstream->free(stream);\n\tgit_vector_free(streams);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid stream_list_free(git_vector *streams)\n{\n\tgit_writestream *stream;\n\tsize_t i;\n\n\tgit_vector_foreach(streams, i, stream)\n\t\tstream->free(stream);\n\tgit_vector_free(streams);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stream_start->close",
          "args": [
            "stream_start"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream_start->write",
          "args": [
            "stream_start",
            "data->ptr",
            "data->size"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream_list_init",
          "args": [
            "&stream_start",
            "&filter_streams",
            "filters",
            "target"
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "stream_list_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "875-922",
          "snippet": "static int stream_list_init(\n\tgit_writestream **out,\n\tgit_vector *streams,\n\tgit_filter_list *filters,\n\tgit_writestream *target)\n{\n\tgit_writestream *last_stream = target;\n\tsize_t i;\n\tint error = 0;\n\n\t*out = NULL;\n\n\tif (!filters) {\n\t\t*out = target;\n\t\treturn 0;\n\t}\n\n\t/* Create filters last to first to get the chaining direction */\n\tfor (i = 0; i < git_array_size(filters->filters); ++i) {\n\t\tsize_t filter_idx = (filters->source.mode == GIT_FILTER_TO_WORKTREE) ?\n\t\t\tgit_array_size(filters->filters) - 1 - i : i;\n\t\tgit_filter_entry *fe = git_array_get(filters->filters, filter_idx);\n\t\tgit_writestream *filter_stream;\n\t\t\n\t\tassert(fe->filter->stream || fe->filter->apply);\n\n\t\t/* If necessary, create a stream that proxies the traditional\n\t\t * application.\n\t\t */\n\t\tif (fe->filter->stream)\n\t\t\terror = fe->filter->stream(&filter_stream, fe->filter,\n\t\t\t\t&fe->payload, &filters->source, last_stream);\n\t\telse\n\t\t\t/* Create a stream that proxies the one-shot apply */\n\t\t\terror = proxy_stream_init(&filter_stream, fe->filter,\n\t\t\t\tfilters->temp_buf, &fe->payload, &filters->source,\n\t\t\t\tlast_stream);\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\tgit_vector_insert(streams, filter_stream);\n\t\tlast_stream = filter_stream;\n\t}\n\n\t*out = last_stream;\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int stream_list_init(\n\tgit_writestream **out,\n\tgit_vector *streams,\n\tgit_filter_list *filters,\n\tgit_writestream *target)\n{\n\tgit_writestream *last_stream = target;\n\tsize_t i;\n\tint error = 0;\n\n\t*out = NULL;\n\n\tif (!filters) {\n\t\t*out = target;\n\t\treturn 0;\n\t}\n\n\t/* Create filters last to first to get the chaining direction */\n\tfor (i = 0; i < git_array_size(filters->filters); ++i) {\n\t\tsize_t filter_idx = (filters->source.mode == GIT_FILTER_TO_WORKTREE) ?\n\t\t\tgit_array_size(filters->filters) - 1 - i : i;\n\t\tgit_filter_entry *fe = git_array_get(filters->filters, filter_idx);\n\t\tgit_writestream *filter_stream;\n\t\t\n\t\tassert(fe->filter->stream || fe->filter->apply);\n\n\t\t/* If necessary, create a stream that proxies the traditional\n\t\t * application.\n\t\t */\n\t\tif (fe->filter->stream)\n\t\t\terror = fe->filter->stream(&filter_stream, fe->filter,\n\t\t\t\t&fe->payload, &filters->source, last_stream);\n\t\telse\n\t\t\t/* Create a stream that proxies the one-shot apply */\n\t\t\terror = proxy_stream_init(&filter_stream, fe->filter,\n\t\t\t\tfilters->temp_buf, &fe->payload, &filters->source,\n\t\t\t\tlast_stream);\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\tgit_vector_insert(streams, filter_stream);\n\t\tlast_stream = filter_stream;\n\t}\n\n\t*out = last_stream;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "data"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_stream_data(\n\tgit_filter_list *filters,\n\tgit_buf *data,\n\tgit_writestream *target)\n{\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tint error = 0, close_error;\n\n\tgit_buf_sanitize(data);\n\n\tif ((error = stream_list_init(&stream_start, &filter_streams, filters, target)) < 0)\n\t\tgoto out;\n\n\terror = stream_start->write(stream_start, data->ptr, data->size);\n\nout:\n\tclose_error = stream_start->close(stream_start);\n\tstream_list_free(&filter_streams);\n\t/* propagate the stream init or write error */\n\treturn error < 0 ? error : close_error;\n}"
  },
  {
    "function_name": "git_filter_list_stream_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "934-975",
    "snippet": "int git_filter_list_stream_file(\n\tgit_filter_list *filters,\n\tgit_repository *repo,\n\tconst char *path,\n\tgit_writestream *target)\n{\n\tchar buf[FILTERIO_BUFSIZE];\n\tgit_buf abspath = GIT_BUF_INIT;\n\tconst char *base = repo ? git_repository_workdir(repo) : NULL;\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tssize_t readlen;\n\tint fd = -1, error;\n\n\tif ((error = stream_list_init(\n\t\t\t&stream_start, &filter_streams, filters, target)) < 0 ||\n\t\t(error = git_path_join_unrooted(&abspath, path, base, NULL)) < 0)\n\t\tgoto done;\n\n\tif ((fd = git_futils_open_ro(abspath.ptr)) < 0) {\n\t\terror = fd;\n\t\tgoto done;\n\t}\n\n\twhile ((readlen = p_read(fd, buf, sizeof(buf))) > 0) {\n\t\tif ((error = stream_start->write(stream_start, buf, readlen)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif (!readlen)\n\t\terror = stream_start->close(stream_start);\n\telse if (readlen < 0)\n\t\terror = readlen;\n\n\ndone:\n\tif (fd >= 0)\n\t\tp_close(fd);\n\tstream_list_free(&filter_streams);\n\tgit_buf_free(&abspath);\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&abspath"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stream_list_free",
          "args": [
            "&filter_streams"
          ],
          "line": 972
        },
        "resolved": true,
        "details": {
          "function_name": "stream_list_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "924-932",
          "snippet": "void stream_list_free(git_vector *streams)\n{\n\tgit_writestream *stream;\n\tsize_t i;\n\n\tgit_vector_foreach(streams, i, stream)\n\t\tstream->free(stream);\n\tgit_vector_free(streams);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid stream_list_free(git_vector *streams)\n{\n\tgit_writestream *stream;\n\tsize_t i;\n\n\tgit_vector_foreach(streams, i, stream)\n\t\tstream->free(stream);\n\tgit_vector_free(streams);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_close",
          "args": [
            "fd"
          ],
          "line": 971
        },
        "resolved": true,
        "details": {
          "function_name": "winhttp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/winhttp.c",
          "lines": "1359-1377",
          "snippet": "static int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}",
          "includes": [
            "#include <urlmon.h>",
            "#include <objbase.h>",
            "#include <winhttp.h>",
            "#include <wincrypt.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"remote.h\"",
            "#include \"smart.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <urlmon.h>\n#include <objbase.h>\n#include <winhttp.h>\n#include <wincrypt.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"remote.h\"\n#include \"smart.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"git2.h\"\n\nstatic int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stream_start->close",
          "args": [
            "stream_start"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream_start->write",
          "args": [
            "stream_start",
            "buf",
            "readlen"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_read",
          "args": [
            "fd",
            "buf",
            "sizeof(buf)"
          ],
          "line": 958
        },
        "resolved": true,
        "details": {
          "function_name": "p_readdir_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.h",
          "lines": "126-131",
          "snippet": "GIT_INLINE(int) p_readdir_r(DIR *dirp, struct dirent *entry, struct dirent **result)\n{\n\tGIT_UNUSED(entry);\n\t*result = readdir(dirp);\n\treturn 0;\n}",
          "includes": [
            "#\tinclude <netdb.h>",
            "#include \"strnlen.h\"",
            "#\tinclude \"unix/posix.h\"",
            "#\tinclude \"win32/posix.h\"",
            "#include \"fnmatch.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <netdb.h>\n#include \"strnlen.h\"\n#\tinclude \"unix/posix.h\"\n#\tinclude \"win32/posix.h\"\n#include \"fnmatch.h\"\n#include <time.h>\n#include <fcntl.h>\n#include \"common.h\"\n\nGIT_INLINE(int) p_readdir_r(DIR *dirp, struct dirent *entry, struct dirent **result)\n{\n\tGIT_UNUSED(entry);\n\t*result = readdir(dirp);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_open_ro",
          "args": [
            "abspath.ptr"
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_open_ro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "90-96",
          "snippet": "int git_futils_open_ro(const char *path)\n{\n\tint fd = p_open(path, O_RDONLY);\n\tif (fd < 0)\n\t\treturn git_path_set_error(errno, path, \"open\");\n\treturn fd;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_open_ro(const char *path)\n{\n\tint fd = p_open(path, O_RDONLY);\n\tif (fd < 0)\n\t\treturn git_path_set_error(errno, path, \"open\");\n\treturn fd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_join_unrooted",
          "args": [
            "&abspath",
            "path",
            "base",
            "NULL"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_join_unrooted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "279-307",
          "snippet": "int git_path_join_unrooted(\n\tgit_buf *path_out, const char *path, const char *base, ssize_t *root_at)\n{\n\tssize_t root;\n\n\tassert(path && path_out);\n\n\troot = (ssize_t)git_path_root(path);\n\n\tif (base != NULL && root < 0) {\n\t\tif (git_buf_joinpath(path_out, base, path) < 0)\n\t\t\treturn -1;\n\n\t\troot = (ssize_t)strlen(base);\n\t} else {\n\t\tif (git_buf_sets(path_out, path) < 0)\n\t\t\treturn -1;\n\n\t\tif (root < 0)\n\t\t\troot = 0;\n\t\telse if (base)\n\t\t\tgit_path_equal_or_prefixed(base, path, &root);\n\t}\n\n\tif (root_at)\n\t\t*root_at = root;\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_join_unrooted(\n\tgit_buf *path_out, const char *path, const char *base, ssize_t *root_at)\n{\n\tssize_t root;\n\n\tassert(path && path_out);\n\n\troot = (ssize_t)git_path_root(path);\n\n\tif (base != NULL && root < 0) {\n\t\tif (git_buf_joinpath(path_out, base, path) < 0)\n\t\t\treturn -1;\n\n\t\troot = (ssize_t)strlen(base);\n\t} else {\n\t\tif (git_buf_sets(path_out, path) < 0)\n\t\t\treturn -1;\n\n\t\tif (root < 0)\n\t\t\troot = 0;\n\t\telse if (base)\n\t\t\tgit_path_equal_or_prefixed(base, path, &root);\n\t}\n\n\tif (root_at)\n\t\t*root_at = root;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "stream_list_init",
          "args": [
            "&stream_start",
            "&filter_streams",
            "filters",
            "target"
          ],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "stream_list_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "875-922",
          "snippet": "static int stream_list_init(\n\tgit_writestream **out,\n\tgit_vector *streams,\n\tgit_filter_list *filters,\n\tgit_writestream *target)\n{\n\tgit_writestream *last_stream = target;\n\tsize_t i;\n\tint error = 0;\n\n\t*out = NULL;\n\n\tif (!filters) {\n\t\t*out = target;\n\t\treturn 0;\n\t}\n\n\t/* Create filters last to first to get the chaining direction */\n\tfor (i = 0; i < git_array_size(filters->filters); ++i) {\n\t\tsize_t filter_idx = (filters->source.mode == GIT_FILTER_TO_WORKTREE) ?\n\t\t\tgit_array_size(filters->filters) - 1 - i : i;\n\t\tgit_filter_entry *fe = git_array_get(filters->filters, filter_idx);\n\t\tgit_writestream *filter_stream;\n\t\t\n\t\tassert(fe->filter->stream || fe->filter->apply);\n\n\t\t/* If necessary, create a stream that proxies the traditional\n\t\t * application.\n\t\t */\n\t\tif (fe->filter->stream)\n\t\t\terror = fe->filter->stream(&filter_stream, fe->filter,\n\t\t\t\t&fe->payload, &filters->source, last_stream);\n\t\telse\n\t\t\t/* Create a stream that proxies the one-shot apply */\n\t\t\terror = proxy_stream_init(&filter_stream, fe->filter,\n\t\t\t\tfilters->temp_buf, &fe->payload, &filters->source,\n\t\t\t\tlast_stream);\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\tgit_vector_insert(streams, filter_stream);\n\t\tlast_stream = filter_stream;\n\t}\n\n\t*out = last_stream;\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int stream_list_init(\n\tgit_writestream **out,\n\tgit_vector *streams,\n\tgit_filter_list *filters,\n\tgit_writestream *target)\n{\n\tgit_writestream *last_stream = target;\n\tsize_t i;\n\tint error = 0;\n\n\t*out = NULL;\n\n\tif (!filters) {\n\t\t*out = target;\n\t\treturn 0;\n\t}\n\n\t/* Create filters last to first to get the chaining direction */\n\tfor (i = 0; i < git_array_size(filters->filters); ++i) {\n\t\tsize_t filter_idx = (filters->source.mode == GIT_FILTER_TO_WORKTREE) ?\n\t\t\tgit_array_size(filters->filters) - 1 - i : i;\n\t\tgit_filter_entry *fe = git_array_get(filters->filters, filter_idx);\n\t\tgit_writestream *filter_stream;\n\t\t\n\t\tassert(fe->filter->stream || fe->filter->apply);\n\n\t\t/* If necessary, create a stream that proxies the traditional\n\t\t * application.\n\t\t */\n\t\tif (fe->filter->stream)\n\t\t\terror = fe->filter->stream(&filter_stream, fe->filter,\n\t\t\t\t&fe->payload, &filters->source, last_stream);\n\t\telse\n\t\t\t/* Create a stream that proxies the one-shot apply */\n\t\t\terror = proxy_stream_init(&filter_stream, fe->filter,\n\t\t\t\tfilters->temp_buf, &fe->payload, &filters->source,\n\t\t\t\tlast_stream);\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\tgit_vector_insert(streams, filter_stream);\n\t\tlast_stream = filter_stream;\n\t}\n\n\t*out = last_stream;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_workdir",
          "args": [
            "repo"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_workdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1828-1836",
          "snippet": "const char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_stream_file(\n\tgit_filter_list *filters,\n\tgit_repository *repo,\n\tconst char *path,\n\tgit_writestream *target)\n{\n\tchar buf[FILTERIO_BUFSIZE];\n\tgit_buf abspath = GIT_BUF_INIT;\n\tconst char *base = repo ? git_repository_workdir(repo) : NULL;\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tssize_t readlen;\n\tint fd = -1, error;\n\n\tif ((error = stream_list_init(\n\t\t\t&stream_start, &filter_streams, filters, target)) < 0 ||\n\t\t(error = git_path_join_unrooted(&abspath, path, base, NULL)) < 0)\n\t\tgoto done;\n\n\tif ((fd = git_futils_open_ro(abspath.ptr)) < 0) {\n\t\terror = fd;\n\t\tgoto done;\n\t}\n\n\twhile ((readlen = p_read(fd, buf, sizeof(buf))) > 0) {\n\t\tif ((error = stream_start->write(stream_start, buf, readlen)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif (!readlen)\n\t\terror = stream_start->close(stream_start);\n\telse if (readlen < 0)\n\t\terror = readlen;\n\n\ndone:\n\tif (fd >= 0)\n\t\tp_close(fd);\n\tstream_list_free(&filter_streams);\n\tgit_buf_free(&abspath);\n\treturn error;\n}"
  },
  {
    "function_name": "stream_list_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "924-932",
    "snippet": "void stream_list_free(git_vector *streams)\n{\n\tgit_writestream *stream;\n\tsize_t i;\n\n\tgit_vector_foreach(streams, i, stream)\n\t\tstream->free(stream);\n\tgit_vector_free(streams);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "streams"
          ],
          "line": 931
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "stream"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "streams",
            "i",
            "stream"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid stream_list_free(git_vector *streams)\n{\n\tgit_writestream *stream;\n\tsize_t i;\n\n\tgit_vector_foreach(streams, i, stream)\n\t\tstream->free(stream);\n\tgit_vector_free(streams);\n}"
  },
  {
    "function_name": "stream_list_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "875-922",
    "snippet": "static int stream_list_init(\n\tgit_writestream **out,\n\tgit_vector *streams,\n\tgit_filter_list *filters,\n\tgit_writestream *target)\n{\n\tgit_writestream *last_stream = target;\n\tsize_t i;\n\tint error = 0;\n\n\t*out = NULL;\n\n\tif (!filters) {\n\t\t*out = target;\n\t\treturn 0;\n\t}\n\n\t/* Create filters last to first to get the chaining direction */\n\tfor (i = 0; i < git_array_size(filters->filters); ++i) {\n\t\tsize_t filter_idx = (filters->source.mode == GIT_FILTER_TO_WORKTREE) ?\n\t\t\tgit_array_size(filters->filters) - 1 - i : i;\n\t\tgit_filter_entry *fe = git_array_get(filters->filters, filter_idx);\n\t\tgit_writestream *filter_stream;\n\t\t\n\t\tassert(fe->filter->stream || fe->filter->apply);\n\n\t\t/* If necessary, create a stream that proxies the traditional\n\t\t * application.\n\t\t */\n\t\tif (fe->filter->stream)\n\t\t\terror = fe->filter->stream(&filter_stream, fe->filter,\n\t\t\t\t&fe->payload, &filters->source, last_stream);\n\t\telse\n\t\t\t/* Create a stream that proxies the one-shot apply */\n\t\t\terror = proxy_stream_init(&filter_stream, fe->filter,\n\t\t\t\tfilters->temp_buf, &fe->payload, &filters->source,\n\t\t\t\tlast_stream);\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\tgit_vector_insert(streams, filter_stream);\n\t\tlast_stream = filter_stream;\n\t}\n\n\t*out = last_stream;\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "streams",
            "filter_stream"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "proxy_stream_init",
          "args": [
            "&filter_stream",
            "fe->filter",
            "filters->temp_buf",
            "&fe->payload",
            "&filters->source",
            "last_stream"
          ],
          "line": 909
        },
        "resolved": true,
        "details": {
          "function_name": "proxy_stream_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "848-873",
          "snippet": "static int proxy_stream_init(\n\tgit_writestream **out,\n\tgit_filter *filter,\n\tgit_buf *temp_buf,\n\tvoid **payload,\n\tconst git_filter_source *source,\n\tgit_writestream *target)\n{\n\tstruct proxy_stream *proxy_stream = git__calloc(1, sizeof(struct proxy_stream));\n\tGITERR_CHECK_ALLOC(proxy_stream);\n\n\tproxy_stream->parent.write = proxy_stream_write;\n\tproxy_stream->parent.close = proxy_stream_close;\n\tproxy_stream->parent.free = proxy_stream_free;\n\tproxy_stream->filter = filter;\n\tproxy_stream->payload = payload;\n\tproxy_stream->source = source;\n\tproxy_stream->target = target;\n\tproxy_stream->output = temp_buf ? temp_buf : &proxy_stream->temp_buf;\n\n\tif (temp_buf)\n\t\tgit_buf_clear(temp_buf);\n\n\t*out = (git_writestream *)proxy_stream;\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int proxy_stream_init(\n\tgit_writestream **out,\n\tgit_filter *filter,\n\tgit_buf *temp_buf,\n\tvoid **payload,\n\tconst git_filter_source *source,\n\tgit_writestream *target)\n{\n\tstruct proxy_stream *proxy_stream = git__calloc(1, sizeof(struct proxy_stream));\n\tGITERR_CHECK_ALLOC(proxy_stream);\n\n\tproxy_stream->parent.write = proxy_stream_write;\n\tproxy_stream->parent.close = proxy_stream_close;\n\tproxy_stream->parent.free = proxy_stream_free;\n\tproxy_stream->filter = filter;\n\tproxy_stream->payload = payload;\n\tproxy_stream->source = source;\n\tproxy_stream->target = target;\n\tproxy_stream->output = temp_buf ? temp_buf : &proxy_stream->temp_buf;\n\n\tif (temp_buf)\n\t\tgit_buf_clear(temp_buf);\n\n\t*out = (git_writestream *)proxy_stream;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe->filter->stream",
          "args": [
            "&filter_stream",
            "fe->filter",
            "&fe->payload",
            "&filters->source",
            "last_stream"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "fe->filter->stream || fe->filter->apply"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "filters->filters",
            "filter_idx"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "filters->filters"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "filters->filters"
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int stream_list_init(\n\tgit_writestream **out,\n\tgit_vector *streams,\n\tgit_filter_list *filters,\n\tgit_writestream *target)\n{\n\tgit_writestream *last_stream = target;\n\tsize_t i;\n\tint error = 0;\n\n\t*out = NULL;\n\n\tif (!filters) {\n\t\t*out = target;\n\t\treturn 0;\n\t}\n\n\t/* Create filters last to first to get the chaining direction */\n\tfor (i = 0; i < git_array_size(filters->filters); ++i) {\n\t\tsize_t filter_idx = (filters->source.mode == GIT_FILTER_TO_WORKTREE) ?\n\t\t\tgit_array_size(filters->filters) - 1 - i : i;\n\t\tgit_filter_entry *fe = git_array_get(filters->filters, filter_idx);\n\t\tgit_writestream *filter_stream;\n\t\t\n\t\tassert(fe->filter->stream || fe->filter->apply);\n\n\t\t/* If necessary, create a stream that proxies the traditional\n\t\t * application.\n\t\t */\n\t\tif (fe->filter->stream)\n\t\t\terror = fe->filter->stream(&filter_stream, fe->filter,\n\t\t\t\t&fe->payload, &filters->source, last_stream);\n\t\telse\n\t\t\t/* Create a stream that proxies the one-shot apply */\n\t\t\terror = proxy_stream_init(&filter_stream, fe->filter,\n\t\t\t\tfilters->temp_buf, &fe->payload, &filters->source,\n\t\t\t\tlast_stream);\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\tgit_vector_insert(streams, filter_stream);\n\t\tlast_stream = filter_stream;\n\t}\n\n\t*out = last_stream;\n\treturn 0;\n}"
  },
  {
    "function_name": "proxy_stream_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "848-873",
    "snippet": "static int proxy_stream_init(\n\tgit_writestream **out,\n\tgit_filter *filter,\n\tgit_buf *temp_buf,\n\tvoid **payload,\n\tconst git_filter_source *source,\n\tgit_writestream *target)\n{\n\tstruct proxy_stream *proxy_stream = git__calloc(1, sizeof(struct proxy_stream));\n\tGITERR_CHECK_ALLOC(proxy_stream);\n\n\tproxy_stream->parent.write = proxy_stream_write;\n\tproxy_stream->parent.close = proxy_stream_close;\n\tproxy_stream->parent.free = proxy_stream_free;\n\tproxy_stream->filter = filter;\n\tproxy_stream->payload = payload;\n\tproxy_stream->source = source;\n\tproxy_stream->target = target;\n\tproxy_stream->output = temp_buf ? temp_buf : &proxy_stream->temp_buf;\n\n\tif (temp_buf)\n\t\tgit_buf_clear(temp_buf);\n\n\t*out = (git_writestream *)proxy_stream;\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "temp_buf"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "proxy_stream"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(struct proxy_stream)"
          ],
          "line": 856
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int proxy_stream_init(\n\tgit_writestream **out,\n\tgit_filter *filter,\n\tgit_buf *temp_buf,\n\tvoid **payload,\n\tconst git_filter_source *source,\n\tgit_writestream *target)\n{\n\tstruct proxy_stream *proxy_stream = git__calloc(1, sizeof(struct proxy_stream));\n\tGITERR_CHECK_ALLOC(proxy_stream);\n\n\tproxy_stream->parent.write = proxy_stream_write;\n\tproxy_stream->parent.close = proxy_stream_close;\n\tproxy_stream->parent.free = proxy_stream_free;\n\tproxy_stream->filter = filter;\n\tproxy_stream->payload = payload;\n\tproxy_stream->source = source;\n\tproxy_stream->target = target;\n\tproxy_stream->output = temp_buf ? temp_buf : &proxy_stream->temp_buf;\n\n\tif (temp_buf)\n\t\tgit_buf_clear(temp_buf);\n\n\t*out = (git_writestream *)proxy_stream;\n\treturn 0;\n}"
  },
  {
    "function_name": "proxy_stream_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "838-846",
    "snippet": "static void proxy_stream_free(git_writestream *s)\n{\n\tstruct proxy_stream *proxy_stream = (struct proxy_stream *)s;\n\tassert(proxy_stream);\n\n\tgit_buf_free(&proxy_stream->input);\n\tgit_buf_free(&proxy_stream->temp_buf);\n\tgit__free(proxy_stream);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "proxy_stream"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&proxy_stream->temp_buf"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "proxy_stream"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic void proxy_stream_free(git_writestream *s)\n{\n\tstruct proxy_stream *proxy_stream = (struct proxy_stream *)s;\n\tassert(proxy_stream);\n\n\tgit_buf_free(&proxy_stream->input);\n\tgit_buf_free(&proxy_stream->temp_buf);\n\tgit__free(proxy_stream);\n}"
  },
  {
    "function_name": "proxy_stream_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "807-836",
    "snippet": "static int proxy_stream_close(git_writestream *s)\n{\n\tstruct proxy_stream *proxy_stream = (struct proxy_stream *)s;\n\tgit_buf *writebuf;\n\tint error;\n\n\tassert(proxy_stream);\n\n\terror = proxy_stream->filter->apply(\n\t\tproxy_stream->filter,\n\t\tproxy_stream->payload,\n\t\tproxy_stream->output,\n\t\t&proxy_stream->input,\n\t\tproxy_stream->source);\n\n\tif (error == GIT_PASSTHROUGH) {\n\t\twritebuf = &proxy_stream->input;\n\t} else if (error == 0) {\n\t\tgit_buf_sanitize(proxy_stream->output);\n\t\twritebuf = proxy_stream->output;\n\t} else {\n\t\treturn error;\n\t}\n\n\tif ((error = proxy_stream->target->write(\n\t\t\tproxy_stream->target, writebuf->ptr, writebuf->size)) == 0)\n\t\terror = proxy_stream->target->close(proxy_stream->target);\n\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proxy_stream->target->close",
          "args": [
            "proxy_stream->target"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxy_stream->target->write",
          "args": [
            "proxy_stream->target",
            "writebuf->ptr",
            "writebuf->size"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "proxy_stream->output"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "proxy_stream->filter->apply",
          "args": [
            "proxy_stream->filter",
            "proxy_stream->payload",
            "proxy_stream->output",
            "&proxy_stream->input",
            "proxy_stream->source"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "proxy_stream"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int proxy_stream_close(git_writestream *s)\n{\n\tstruct proxy_stream *proxy_stream = (struct proxy_stream *)s;\n\tgit_buf *writebuf;\n\tint error;\n\n\tassert(proxy_stream);\n\n\terror = proxy_stream->filter->apply(\n\t\tproxy_stream->filter,\n\t\tproxy_stream->payload,\n\t\tproxy_stream->output,\n\t\t&proxy_stream->input,\n\t\tproxy_stream->source);\n\n\tif (error == GIT_PASSTHROUGH) {\n\t\twritebuf = &proxy_stream->input;\n\t} else if (error == 0) {\n\t\tgit_buf_sanitize(proxy_stream->output);\n\t\twritebuf = proxy_stream->output;\n\t} else {\n\t\treturn error;\n\t}\n\n\tif ((error = proxy_stream->target->write(\n\t\t\tproxy_stream->target, writebuf->ptr, writebuf->size)) == 0)\n\t\terror = proxy_stream->target->close(proxy_stream->target);\n\n\treturn error;\n}"
  },
  {
    "function_name": "proxy_stream_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "798-805",
    "snippet": "static int proxy_stream_write(\n\tgit_writestream *s, const char *buffer, size_t len)\n{\n\tstruct proxy_stream *proxy_stream = (struct proxy_stream *)s;\n\tassert(proxy_stream);\n\n\treturn git_buf_put(&proxy_stream->input, buffer, len);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "&proxy_stream->input",
            "buffer",
            "len"
          ],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "proxy_stream"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int proxy_stream_write(\n\tgit_writestream *s, const char *buffer, size_t len)\n{\n\tstruct proxy_stream *proxy_stream = (struct proxy_stream *)s;\n\tassert(proxy_stream);\n\n\treturn git_buf_put(&proxy_stream->input, buffer, len);\n}"
  },
  {
    "function_name": "git_filter_list_apply_to_blob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "769-785",
    "snippet": "int git_filter_list_apply_to_blob(\n\tgit_buf *out,\n\tgit_filter_list *filters,\n\tgit_blob *blob)\n{\n\tstruct buf_stream writer;\n\tint error;\n\n\tbuf_stream_init(&writer, out);\n\n\tif ((error = git_filter_list_stream_blob(\n\t\tfilters, blob, &writer.parent)) < 0)\n\t\t\treturn error;\n\n\tassert(writer.complete);\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "writer.complete"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_filter_list_stream_blob",
          "args": [
            "filters",
            "blob",
            "&writer.parent"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_list_stream_blob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "1000-1014",
          "snippet": "int git_filter_list_stream_blob(\n\tgit_filter_list *filters,\n\tgit_blob *blob,\n\tgit_writestream *target)\n{\n\tgit_buf in = GIT_BUF_INIT;\n\n\tif (buf_from_blob(&in, blob) < 0)\n\t\treturn -1;\n\n\tif (filters)\n\t\tgit_oid_cpy(&filters->source.oid, git_blob_id(blob));\n\n\treturn git_filter_list_stream_data(filters, &in, target);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_stream_blob(\n\tgit_filter_list *filters,\n\tgit_blob *blob,\n\tgit_writestream *target)\n{\n\tgit_buf in = GIT_BUF_INIT;\n\n\tif (buf_from_blob(&in, blob) < 0)\n\t\treturn -1;\n\n\tif (filters)\n\t\tgit_oid_cpy(&filters->source.oid, git_blob_id(blob));\n\n\treturn git_filter_list_stream_data(filters, &in, target);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buf_stream_init",
          "args": [
            "&writer",
            "out"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "buf_stream_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "701-711",
          "snippet": "static void buf_stream_init(struct buf_stream *writer, git_buf *target)\n{\n\tmemset(writer, 0, sizeof(struct buf_stream));\n\n\twriter->parent.write = buf_stream_write;\n\twriter->parent.close = buf_stream_close;\n\twriter->parent.free = buf_stream_free;\n\twriter->target = target;\n\n\tgit_buf_clear(target);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic void buf_stream_init(struct buf_stream *writer, git_buf *target)\n{\n\tmemset(writer, 0, sizeof(struct buf_stream));\n\n\twriter->parent.write = buf_stream_write;\n\twriter->parent.close = buf_stream_close;\n\twriter->parent.free = buf_stream_free;\n\twriter->target = target;\n\n\tgit_buf_clear(target);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_apply_to_blob(\n\tgit_buf *out,\n\tgit_filter_list *filters,\n\tgit_blob *blob)\n{\n\tstruct buf_stream writer;\n\tint error;\n\n\tbuf_stream_init(&writer, out);\n\n\tif ((error = git_filter_list_stream_blob(\n\t\tfilters, blob, &writer.parent)) < 0)\n\t\t\treturn error;\n\n\tassert(writer.complete);\n\treturn error;\n}"
  },
  {
    "function_name": "buf_from_blob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "756-767",
    "snippet": "static int buf_from_blob(git_buf *out, git_blob *blob)\n{\n\tgit_off_t rawsize = git_blob_rawsize(blob);\n\n\tif (!git__is_sizet(rawsize)) {\n\t\tgiterr_set(GITERR_OS, \"Blob is too large to filter\");\n\t\treturn -1;\n\t}\n\n\tgit_buf_attach_notowned(out, git_blob_rawcontent(blob), (size_t)rawsize);\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_attach_notowned",
          "args": [
            "out",
            "git_blob_rawcontent(blob)",
            "(size_t)rawsize"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_attach_notowned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "505-517",
          "snippet": "void git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_rawcontent",
          "args": [
            "blob"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_rawcontent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blob.c",
          "lines": "19-23",
          "snippet": "const void *git_blob_rawcontent(const git_blob *blob)\n{\n\tassert(blob);\n\treturn git_odb_object_data(blob->odb_object);\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"filter.h\"",
            "#include \"blob.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"filter.h\"\n#include \"blob.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nconst void *git_blob_rawcontent(const git_blob *blob)\n{\n\tassert(blob);\n\treturn git_odb_object_data(blob->odb_object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Blob is too large to filter\""
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__is_sizet",
          "args": [
            "rawsize"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "git__is_sizet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/integer.h",
          "lines": "11-15",
          "snippet": "GIT_INLINE(int) git__is_sizet(git_off_t p)\n{\n\tsize_t r = (size_t)p;\n\treturn p == (git_off_t)r;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "GIT_INLINE(int) git__is_sizet(git_off_t p)\n{\n\tsize_t r = (size_t)p;\n\treturn p == (git_off_t)r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_rawsize",
          "args": [
            "blob"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_rawsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/blob.c",
          "lines": "25-29",
          "snippet": "git_off_t git_blob_rawsize(const git_blob *blob)\n{\n\tassert(blob);\n\treturn (git_off_t)git_odb_object_size(blob->odb_object);\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"filter.h\"",
            "#include \"blob.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"filter.h\"\n#include \"blob.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\ngit_off_t git_blob_rawsize(const git_blob *blob)\n{\n\tassert(blob);\n\treturn (git_off_t)git_odb_object_size(blob->odb_object);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int buf_from_blob(git_buf *out, git_blob *blob)\n{\n\tgit_off_t rawsize = git_blob_rawsize(blob);\n\n\tif (!git__is_sizet(rawsize)) {\n\t\tgiterr_set(GITERR_OS, \"Blob is too large to filter\");\n\t\treturn -1;\n\t}\n\n\tgit_buf_attach_notowned(out, git_blob_rawcontent(blob), (size_t)rawsize);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_filter_list_apply_to_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "737-754",
    "snippet": "int git_filter_list_apply_to_file(\n\tgit_buf *out,\n\tgit_filter_list *filters,\n\tgit_repository *repo,\n\tconst char *path)\n{\n\tstruct buf_stream writer;\n\tint error;\n\n\tbuf_stream_init(&writer, out);\n\n\tif ((error = git_filter_list_stream_file(\n\t\tfilters, repo, path, &writer.parent)) < 0)\n\t\t\treturn error;\n\n\tassert(writer.complete);\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "writer.complete"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_filter_list_stream_file",
          "args": [
            "filters",
            "repo",
            "path",
            "&writer.parent"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_list_stream_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "934-975",
          "snippet": "int git_filter_list_stream_file(\n\tgit_filter_list *filters,\n\tgit_repository *repo,\n\tconst char *path,\n\tgit_writestream *target)\n{\n\tchar buf[FILTERIO_BUFSIZE];\n\tgit_buf abspath = GIT_BUF_INIT;\n\tconst char *base = repo ? git_repository_workdir(repo) : NULL;\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tssize_t readlen;\n\tint fd = -1, error;\n\n\tif ((error = stream_list_init(\n\t\t\t&stream_start, &filter_streams, filters, target)) < 0 ||\n\t\t(error = git_path_join_unrooted(&abspath, path, base, NULL)) < 0)\n\t\tgoto done;\n\n\tif ((fd = git_futils_open_ro(abspath.ptr)) < 0) {\n\t\terror = fd;\n\t\tgoto done;\n\t}\n\n\twhile ((readlen = p_read(fd, buf, sizeof(buf))) > 0) {\n\t\tif ((error = stream_start->write(stream_start, buf, readlen)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif (!readlen)\n\t\terror = stream_start->close(stream_start);\n\telse if (readlen < 0)\n\t\terror = readlen;\n\n\ndone:\n\tif (fd >= 0)\n\t\tp_close(fd);\n\tstream_list_free(&filter_streams);\n\tgit_buf_free(&abspath);\n\treturn error;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_stream_file(\n\tgit_filter_list *filters,\n\tgit_repository *repo,\n\tconst char *path,\n\tgit_writestream *target)\n{\n\tchar buf[FILTERIO_BUFSIZE];\n\tgit_buf abspath = GIT_BUF_INIT;\n\tconst char *base = repo ? git_repository_workdir(repo) : NULL;\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tssize_t readlen;\n\tint fd = -1, error;\n\n\tif ((error = stream_list_init(\n\t\t\t&stream_start, &filter_streams, filters, target)) < 0 ||\n\t\t(error = git_path_join_unrooted(&abspath, path, base, NULL)) < 0)\n\t\tgoto done;\n\n\tif ((fd = git_futils_open_ro(abspath.ptr)) < 0) {\n\t\terror = fd;\n\t\tgoto done;\n\t}\n\n\twhile ((readlen = p_read(fd, buf, sizeof(buf))) > 0) {\n\t\tif ((error = stream_start->write(stream_start, buf, readlen)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif (!readlen)\n\t\terror = stream_start->close(stream_start);\n\telse if (readlen < 0)\n\t\terror = readlen;\n\n\ndone:\n\tif (fd >= 0)\n\t\tp_close(fd);\n\tstream_list_free(&filter_streams);\n\tgit_buf_free(&abspath);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buf_stream_init",
          "args": [
            "&writer",
            "out"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "buf_stream_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "701-711",
          "snippet": "static void buf_stream_init(struct buf_stream *writer, git_buf *target)\n{\n\tmemset(writer, 0, sizeof(struct buf_stream));\n\n\twriter->parent.write = buf_stream_write;\n\twriter->parent.close = buf_stream_close;\n\twriter->parent.free = buf_stream_free;\n\twriter->target = target;\n\n\tgit_buf_clear(target);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic void buf_stream_init(struct buf_stream *writer, git_buf *target)\n{\n\tmemset(writer, 0, sizeof(struct buf_stream));\n\n\twriter->parent.write = buf_stream_write;\n\twriter->parent.close = buf_stream_close;\n\twriter->parent.free = buf_stream_free;\n\twriter->target = target;\n\n\tgit_buf_clear(target);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_apply_to_file(\n\tgit_buf *out,\n\tgit_filter_list *filters,\n\tgit_repository *repo,\n\tconst char *path)\n{\n\tstruct buf_stream writer;\n\tint error;\n\n\tbuf_stream_init(&writer, out);\n\n\tif ((error = git_filter_list_stream_file(\n\t\tfilters, repo, path, &writer.parent)) < 0)\n\t\t\treturn error;\n\n\tassert(writer.complete);\n\treturn error;\n}"
  },
  {
    "function_name": "git_filter_list_apply_to_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "713-735",
    "snippet": "int git_filter_list_apply_to_data(\n\tgit_buf *tgt, git_filter_list *filters, git_buf *src)\n{\n\tstruct buf_stream writer;\n\tint error;\n\n\tgit_buf_sanitize(tgt);\n\tgit_buf_sanitize(src);\n\n\tif (!filters) {\n\t\tgit_buf_attach_notowned(tgt, src->ptr, src->size);\n\t\treturn 0;\n\t}\n\n\tbuf_stream_init(&writer, tgt);\n\n\tif ((error = git_filter_list_stream_data(filters, src,\n\t\t&writer.parent)) < 0)\n\t\t\treturn error;\n\n\tassert(writer.complete);\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "writer.complete"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_filter_list_stream_data",
          "args": [
            "filters",
            "src",
            "&writer.parent"
          ],
          "line": 729
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_list_stream_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "977-998",
          "snippet": "int git_filter_list_stream_data(\n\tgit_filter_list *filters,\n\tgit_buf *data,\n\tgit_writestream *target)\n{\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tint error = 0, close_error;\n\n\tgit_buf_sanitize(data);\n\n\tif ((error = stream_list_init(&stream_start, &filter_streams, filters, target)) < 0)\n\t\tgoto out;\n\n\terror = stream_start->write(stream_start, data->ptr, data->size);\n\nout:\n\tclose_error = stream_start->close(stream_start);\n\tstream_list_free(&filter_streams);\n\t/* propagate the stream init or write error */\n\treturn error < 0 ? error : close_error;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_stream_data(\n\tgit_filter_list *filters,\n\tgit_buf *data,\n\tgit_writestream *target)\n{\n\tgit_vector filter_streams = GIT_VECTOR_INIT;\n\tgit_writestream *stream_start;\n\tint error = 0, close_error;\n\n\tgit_buf_sanitize(data);\n\n\tif ((error = stream_list_init(&stream_start, &filter_streams, filters, target)) < 0)\n\t\tgoto out;\n\n\terror = stream_start->write(stream_start, data->ptr, data->size);\n\nout:\n\tclose_error = stream_start->close(stream_start);\n\tstream_list_free(&filter_streams);\n\t/* propagate the stream init or write error */\n\treturn error < 0 ? error : close_error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buf_stream_init",
          "args": [
            "&writer",
            "tgt"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "buf_stream_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "701-711",
          "snippet": "static void buf_stream_init(struct buf_stream *writer, git_buf *target)\n{\n\tmemset(writer, 0, sizeof(struct buf_stream));\n\n\twriter->parent.write = buf_stream_write;\n\twriter->parent.close = buf_stream_close;\n\twriter->parent.free = buf_stream_free;\n\twriter->target = target;\n\n\tgit_buf_clear(target);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic void buf_stream_init(struct buf_stream *writer, git_buf *target)\n{\n\tmemset(writer, 0, sizeof(struct buf_stream));\n\n\twriter->parent.write = buf_stream_write;\n\twriter->parent.close = buf_stream_close;\n\twriter->parent.free = buf_stream_free;\n\twriter->target = target;\n\n\tgit_buf_clear(target);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_attach_notowned",
          "args": [
            "tgt",
            "src->ptr",
            "src->size"
          ],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_attach_notowned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "505-517",
          "snippet": "void git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "src"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_apply_to_data(\n\tgit_buf *tgt, git_filter_list *filters, git_buf *src)\n{\n\tstruct buf_stream writer;\n\tint error;\n\n\tgit_buf_sanitize(tgt);\n\tgit_buf_sanitize(src);\n\n\tif (!filters) {\n\t\tgit_buf_attach_notowned(tgt, src->ptr, src->size);\n\t\treturn 0;\n\t}\n\n\tbuf_stream_init(&writer, tgt);\n\n\tif ((error = git_filter_list_stream_data(filters, src,\n\t\t&writer.parent)) < 0)\n\t\t\treturn error;\n\n\tassert(writer.complete);\n\treturn error;\n}"
  },
  {
    "function_name": "buf_stream_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "701-711",
    "snippet": "static void buf_stream_init(struct buf_stream *writer, git_buf *target)\n{\n\tmemset(writer, 0, sizeof(struct buf_stream));\n\n\twriter->parent.write = buf_stream_write;\n\twriter->parent.close = buf_stream_close;\n\twriter->parent.free = buf_stream_free;\n\twriter->target = target;\n\n\tgit_buf_clear(target);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "target"
          ],
          "line": 710
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "writer",
            "0",
            "sizeof(struct buf_stream)"
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic void buf_stream_init(struct buf_stream *writer, git_buf *target)\n{\n\tmemset(writer, 0, sizeof(struct buf_stream));\n\n\twriter->parent.write = buf_stream_write;\n\twriter->parent.close = buf_stream_close;\n\twriter->parent.free = buf_stream_free;\n\twriter->target = target;\n\n\tgit_buf_clear(target);\n}"
  },
  {
    "function_name": "buf_stream_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "696-699",
    "snippet": "static void buf_stream_free(git_writestream *s)\n{\n\tGIT_UNUSED(s);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "s"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic void buf_stream_free(git_writestream *s)\n{\n\tGIT_UNUSED(s);\n}"
  },
  {
    "function_name": "buf_stream_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "685-694",
    "snippet": "static int buf_stream_close(git_writestream *s)\n{\n\tstruct buf_stream *buf_stream = (struct buf_stream *)s;\n\tassert(buf_stream);\n\n\tassert(buf_stream->complete == 0);\n\tbuf_stream->complete = 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "buf_stream->complete == 0"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "buf_stream"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int buf_stream_close(git_writestream *s)\n{\n\tstruct buf_stream *buf_stream = (struct buf_stream *)s;\n\tassert(buf_stream);\n\n\tassert(buf_stream->complete == 0);\n\tbuf_stream->complete = 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "buf_stream_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "674-683",
    "snippet": "static int buf_stream_write(\n\tgit_writestream *s, const char *buffer, size_t len)\n{\n\tstruct buf_stream *buf_stream = (struct buf_stream *)s;\n\tassert(buf_stream);\n\n\tassert(buf_stream->complete == 0);\n\n\treturn git_buf_put(buf_stream->target, buffer, len);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "buf_stream->target",
            "buffer",
            "len"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "buf_stream->complete == 0"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "buf_stream"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int buf_stream_write(\n\tgit_writestream *s, const char *buffer, size_t len)\n{\n\tstruct buf_stream *buf_stream = (struct buf_stream *)s;\n\tassert(buf_stream);\n\n\tassert(buf_stream->complete == 0);\n\n\treturn git_buf_put(buf_stream->target, buffer, len);\n}"
  },
  {
    "function_name": "git_filter_list_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "663-666",
    "snippet": "size_t git_filter_list_length(const git_filter_list *fl)\n{\n\treturn fl ? git_array_size(fl->filters) : 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "fl->filters"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nsize_t git_filter_list_length(const git_filter_list *fl)\n{\n\treturn fl ? git_array_size(fl->filters) : 0;\n}"
  },
  {
    "function_name": "git_filter_list_push",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "625-661",
    "snippet": "int git_filter_list_push(\n\tgit_filter_list *fl, git_filter *filter, void *payload)\n{\n\tint error = 0;\n\tsize_t pos;\n\tgit_filter_def *fdef = NULL;\n\tgit_filter_entry *fe;\n\n\tassert(fl && filter);\n\n\tif (git_rwlock_rdlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tif (git_vector_search2(\n\t\t\t&pos, &filter_registry.filters,\n\t\t\tfilter_def_filter_key_check, filter) == 0)\n\t\tfdef = git_vector_get(&filter_registry.filters, pos);\n\n\tgit_rwlock_rdunlock(&filter_registry.lock);\n\n\tif (fdef == NULL) {\n\t\tgiterr_set(GITERR_FILTER, \"Cannot use an unregistered filter\");\n\t\treturn -1;\n\t}\n\n\tif (!fdef->initialized && (error = filter_initialize(fdef)) < 0)\n\t\treturn error;\n\n\tfe = git_array_alloc(fl->filters);\n\tGITERR_CHECK_ALLOC(fe);\n\tfe->filter  = filter;\n\tfe->payload = payload;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "fe"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "fl->filters"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter_initialize",
          "args": [
            "fdef"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "filter_initialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "330-341",
          "snippet": "static int filter_initialize(git_filter_def *fdef)\n{\n\tint error = 0;\n\n\tif (!fdef->initialized && fdef->filter && fdef->filter->initialize) {\n\t\tif ((error = fdef->filter->initialize(fdef->filter)) < 0)\n\t\t\treturn error;\n\t}\n\n\tfdef->initialized = true;\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_initialize(git_filter_def *fdef)\n{\n\tint error = 0;\n\n\tif (!fdef->initialized && fdef->filter && fdef->filter->initialize) {\n\t\tif ((error = fdef->filter->initialize(fdef->filter)) < 0)\n\t\t\treturn error;\n\t}\n\n\tfdef->initialized = true;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_FILTER",
            "\"Cannot use an unregistered filter\""
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_rdunlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_rdunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "203-211",
          "snippet": "int git_rwlock_rdunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_shared)\n\t\twin32_srwlock_release_shared(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_release_shared;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_release_shared;\n\nint git_rwlock_rdunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_shared)\n\t\twin32_srwlock_release_shared(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&filter_registry.filters",
            "pos"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_search2",
          "args": [
            "&pos",
            "&filter_registry.filters",
            "filter_def_filter_key_check",
            "filter"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_search2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "204-221",
          "snippet": "int git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_rdlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_rdlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "193-201",
          "snippet": "int git_rwlock_rdlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_shared)\n\t\twin32_srwlock_acquire_shared(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_acquire_shared;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_acquire_shared;\n\nint git_rwlock_rdlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_shared)\n\t\twin32_srwlock_acquire_shared(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "fl && filter"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nint git_filter_list_push(\n\tgit_filter_list *fl, git_filter *filter, void *payload)\n{\n\tint error = 0;\n\tsize_t pos;\n\tgit_filter_def *fdef = NULL;\n\tgit_filter_entry *fe;\n\n\tassert(fl && filter);\n\n\tif (git_rwlock_rdlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tif (git_vector_search2(\n\t\t\t&pos, &filter_registry.filters,\n\t\t\tfilter_def_filter_key_check, filter) == 0)\n\t\tfdef = git_vector_get(&filter_registry.filters, pos);\n\n\tgit_rwlock_rdunlock(&filter_registry.lock);\n\n\tif (fdef == NULL) {\n\t\tgiterr_set(GITERR_FILTER, \"Cannot use an unregistered filter\");\n\t\treturn -1;\n\t}\n\n\tif (!fdef->initialized && (error = filter_initialize(fdef)) < 0)\n\t\treturn error;\n\n\tfe = git_array_alloc(fl->filters);\n\tGITERR_CHECK_ALLOC(fe);\n\tfe->filter  = filter;\n\tfe->payload = payload;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_filter_list_contains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "606-623",
    "snippet": "int git_filter_list_contains(\n\tgit_filter_list *fl,\n\tconst char *name)\n{\n\tsize_t i;\n\n\tassert(name);\n\n\tif (!fl)\n\t\treturn 0;\n\n\tfor (i = 0; i < fl->filters.size; i++) {\n\t\tif (strcmp(fl->filters.ptr[i].filter_name, name) == 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "fl->filters.ptr[i].filter_name",
            "name"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "name"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_contains(\n\tgit_filter_list *fl,\n\tconst char *name)\n{\n\tsize_t i;\n\n\tassert(name);\n\n\tif (!fl)\n\t\treturn 0;\n\n\tfor (i = 0; i < fl->filters.size; i++) {\n\t\tif (strcmp(fl->filters.ptr[i].filter_name, name) == 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_filter_list_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "589-604",
    "snippet": "void git_filter_list_free(git_filter_list *fl)\n{\n\tuint32_t i;\n\n\tif (!fl)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(fl->filters); ++i) {\n\t\tgit_filter_entry *fe = git_array_get(fl->filters, i);\n\t\tif (fe->filter->cleanup)\n\t\t\tfe->filter->cleanup(fe->filter, fe->payload);\n\t}\n\n\tgit_array_clear(fl->filters);\n\tgit__free(fl);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "fl"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "fl->filters"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fe->filter->cleanup",
          "args": [
            "fe->filter",
            "fe->payload"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "fl->filters",
            "i"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "fl->filters"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid git_filter_list_free(git_filter_list *fl)\n{\n\tuint32_t i;\n\n\tif (!fl)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(fl->filters); ++i) {\n\t\tgit_filter_entry *fe = git_array_get(fl->filters, i);\n\t\tif (fe->filter->cleanup)\n\t\t\tfe->filter->cleanup(fe->filter, fe->payload);\n\t}\n\n\tgit_array_clear(fl->filters);\n\tgit__free(fl);\n}"
  },
  {
    "function_name": "git_filter_list_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "573-587",
    "snippet": "int git_filter_list_load(\n\tgit_filter_list **filters,\n\tgit_repository *repo,\n\tgit_blob *blob, /* can be NULL */\n\tconst char *path,\n\tgit_filter_mode_t mode,\n\tuint32_t flags)\n{\n\tgit_filter_options filter_opts = GIT_FILTER_OPTIONS_INIT;\n\n\tfilter_opts.flags = flags;\n\n\treturn git_filter_list__load_ext(\n\t\tfilters, repo, blob, path, mode, &filter_opts);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_filter_list__load_ext",
          "args": [
            "filters",
            "repo",
            "blob",
            "path",
            "mode",
            "&filter_opts"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_list__load_ext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "485-571",
          "snippet": "int git_filter_list__load_ext(\n\tgit_filter_list **filters,\n\tgit_repository *repo,\n\tgit_blob *blob, /* can be NULL */\n\tconst char *path,\n\tgit_filter_mode_t mode,\n\tgit_filter_options *filter_opts)\n{\n\tint error = 0;\n\tgit_filter_list *fl = NULL;\n\tgit_filter_source src = { 0 };\n\tgit_filter_entry *fe;\n\tsize_t idx;\n\tgit_filter_def *fdef;\n\n\tif (git_rwlock_rdlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tsrc.repo = repo;\n\tsrc.path = path;\n\tsrc.mode = mode;\n\tsrc.flags = filter_opts->flags;\n\n\tif (blob)\n\t\tgit_oid_cpy(&src.oid, git_blob_id(blob));\n\n\tgit_vector_foreach(&filter_registry.filters, idx, fdef) {\n\t\tconst char **values = NULL;\n\t\tvoid *payload = NULL;\n\n\t\tif (!fdef || !fdef->filter)\n\t\t\tcontinue;\n\n\t\tif (fdef->nattrs > 0) {\n\t\t\terror = filter_list_check_attributes(\n\t\t\t\t&values, repo, filter_opts->attr_session, fdef, &src);\n\n\t\t\tif (error == GIT_ENOTFOUND) {\n\t\t\t\terror = 0;\n\t\t\t\tcontinue;\n\t\t\t} else if (error < 0)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (!fdef->initialized && (error = filter_initialize(fdef)) < 0)\n\t\t\tbreak;\n\n\t\tif (fdef->filter->check)\n\t\t\terror = fdef->filter->check(\n\t\t\t\tfdef->filter, &payload, &src, values);\n\n\t\tgit__free((void *)values);\n\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = 0;\n\t\telse if (error < 0)\n\t\t\tbreak;\n\t\telse {\n\t\t\tif (!fl) {\n\t\t\t\tif ((error = filter_list_new(&fl, &src)) < 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\tfl->temp_buf = filter_opts->temp_buf;\n\t\t\t}\n\n\t\t\tfe = git_array_alloc(fl->filters);\n\t\t\tGITERR_CHECK_ALLOC(fe);\n\n\t\t\tfe->filter = fdef->filter;\n\t\t\tfe->filter_name = fdef->filter_name;\n\t\t\tfe->payload = payload;\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&filter_registry.lock);\n\n\tif (error && fl != NULL) {\n\t\tgit_array_clear(fl->filters);\n\t\tgit__free(fl);\n\t\tfl = NULL;\n\t}\n\n\t*filters = fl;\n\treturn error;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_filter_registry filter_registry;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nint git_filter_list__load_ext(\n\tgit_filter_list **filters,\n\tgit_repository *repo,\n\tgit_blob *blob, /* can be NULL */\n\tconst char *path,\n\tgit_filter_mode_t mode,\n\tgit_filter_options *filter_opts)\n{\n\tint error = 0;\n\tgit_filter_list *fl = NULL;\n\tgit_filter_source src = { 0 };\n\tgit_filter_entry *fe;\n\tsize_t idx;\n\tgit_filter_def *fdef;\n\n\tif (git_rwlock_rdlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tsrc.repo = repo;\n\tsrc.path = path;\n\tsrc.mode = mode;\n\tsrc.flags = filter_opts->flags;\n\n\tif (blob)\n\t\tgit_oid_cpy(&src.oid, git_blob_id(blob));\n\n\tgit_vector_foreach(&filter_registry.filters, idx, fdef) {\n\t\tconst char **values = NULL;\n\t\tvoid *payload = NULL;\n\n\t\tif (!fdef || !fdef->filter)\n\t\t\tcontinue;\n\n\t\tif (fdef->nattrs > 0) {\n\t\t\terror = filter_list_check_attributes(\n\t\t\t\t&values, repo, filter_opts->attr_session, fdef, &src);\n\n\t\t\tif (error == GIT_ENOTFOUND) {\n\t\t\t\terror = 0;\n\t\t\t\tcontinue;\n\t\t\t} else if (error < 0)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (!fdef->initialized && (error = filter_initialize(fdef)) < 0)\n\t\t\tbreak;\n\n\t\tif (fdef->filter->check)\n\t\t\terror = fdef->filter->check(\n\t\t\t\tfdef->filter, &payload, &src, values);\n\n\t\tgit__free((void *)values);\n\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = 0;\n\t\telse if (error < 0)\n\t\t\tbreak;\n\t\telse {\n\t\t\tif (!fl) {\n\t\t\t\tif ((error = filter_list_new(&fl, &src)) < 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\tfl->temp_buf = filter_opts->temp_buf;\n\t\t\t}\n\n\t\t\tfe = git_array_alloc(fl->filters);\n\t\t\tGITERR_CHECK_ALLOC(fe);\n\n\t\t\tfe->filter = fdef->filter;\n\t\t\tfe->filter_name = fdef->filter_name;\n\t\t\tfe->payload = payload;\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&filter_registry.lock);\n\n\tif (error && fl != NULL) {\n\t\tgit_array_clear(fl->filters);\n\t\tgit__free(fl);\n\t\tfl = NULL;\n\t}\n\n\t*filters = fl;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_load(\n\tgit_filter_list **filters,\n\tgit_repository *repo,\n\tgit_blob *blob, /* can be NULL */\n\tconst char *path,\n\tgit_filter_mode_t mode,\n\tuint32_t flags)\n{\n\tgit_filter_options filter_opts = GIT_FILTER_OPTIONS_INIT;\n\n\tfilter_opts.flags = flags;\n\n\treturn git_filter_list__load_ext(\n\t\tfilters, repo, blob, path, mode, &filter_opts);\n}"
  },
  {
    "function_name": "git_filter_list__load_ext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "485-571",
    "snippet": "int git_filter_list__load_ext(\n\tgit_filter_list **filters,\n\tgit_repository *repo,\n\tgit_blob *blob, /* can be NULL */\n\tconst char *path,\n\tgit_filter_mode_t mode,\n\tgit_filter_options *filter_opts)\n{\n\tint error = 0;\n\tgit_filter_list *fl = NULL;\n\tgit_filter_source src = { 0 };\n\tgit_filter_entry *fe;\n\tsize_t idx;\n\tgit_filter_def *fdef;\n\n\tif (git_rwlock_rdlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tsrc.repo = repo;\n\tsrc.path = path;\n\tsrc.mode = mode;\n\tsrc.flags = filter_opts->flags;\n\n\tif (blob)\n\t\tgit_oid_cpy(&src.oid, git_blob_id(blob));\n\n\tgit_vector_foreach(&filter_registry.filters, idx, fdef) {\n\t\tconst char **values = NULL;\n\t\tvoid *payload = NULL;\n\n\t\tif (!fdef || !fdef->filter)\n\t\t\tcontinue;\n\n\t\tif (fdef->nattrs > 0) {\n\t\t\terror = filter_list_check_attributes(\n\t\t\t\t&values, repo, filter_opts->attr_session, fdef, &src);\n\n\t\t\tif (error == GIT_ENOTFOUND) {\n\t\t\t\terror = 0;\n\t\t\t\tcontinue;\n\t\t\t} else if (error < 0)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (!fdef->initialized && (error = filter_initialize(fdef)) < 0)\n\t\t\tbreak;\n\n\t\tif (fdef->filter->check)\n\t\t\terror = fdef->filter->check(\n\t\t\t\tfdef->filter, &payload, &src, values);\n\n\t\tgit__free((void *)values);\n\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = 0;\n\t\telse if (error < 0)\n\t\t\tbreak;\n\t\telse {\n\t\t\tif (!fl) {\n\t\t\t\tif ((error = filter_list_new(&fl, &src)) < 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\tfl->temp_buf = filter_opts->temp_buf;\n\t\t\t}\n\n\t\t\tfe = git_array_alloc(fl->filters);\n\t\t\tGITERR_CHECK_ALLOC(fe);\n\n\t\t\tfe->filter = fdef->filter;\n\t\t\tfe->filter_name = fdef->filter_name;\n\t\t\tfe->payload = payload;\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&filter_registry.lock);\n\n\tif (error && fl != NULL) {\n\t\tgit_array_clear(fl->filters);\n\t\tgit__free(fl);\n\t\tfl = NULL;\n\t}\n\n\t*filters = fl;\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "fl"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "fl->filters"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_rwlock_rdunlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_rdunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "203-211",
          "snippet": "int git_rwlock_rdunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_shared)\n\t\twin32_srwlock_release_shared(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_release_shared;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_release_shared;\n\nint git_rwlock_rdunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_shared)\n\t\twin32_srwlock_release_shared(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "fe"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "fl->filters"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter_list_new",
          "args": [
            "&fl",
            "&src"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "filter_list_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "400-421",
          "snippet": "static int filter_list_new(\n\tgit_filter_list **out, const git_filter_source *src)\n{\n\tgit_filter_list *fl = NULL;\n\tsize_t pathlen = src->path ? strlen(src->path) : 0, alloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, sizeof(git_filter_list), pathlen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tfl = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(fl);\n\n\tif (src->path)\n\t\tmemcpy(fl->path, src->path, pathlen);\n\tfl->source.repo = src->repo;\n\tfl->source.path = fl->path;\n\tfl->source.mode = src->mode;\n\tfl->source.flags = src->flags;\n\n\t*out = fl;\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_list_new(\n\tgit_filter_list **out, const git_filter_source *src)\n{\n\tgit_filter_list *fl = NULL;\n\tsize_t pathlen = src->path ? strlen(src->path) : 0, alloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, sizeof(git_filter_list), pathlen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tfl = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(fl);\n\n\tif (src->path)\n\t\tmemcpy(fl->path, src->path, pathlen);\n\tfl->source.repo = src->repo;\n\tfl->source.path = fl->path;\n\tfl->source.mode = src->mode;\n\tfl->source.flags = src->flags;\n\n\t*out = fl;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdef->filter->check",
          "args": [
            "fdef->filter",
            "&payload",
            "&src",
            "values"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter_initialize",
          "args": [
            "fdef"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "filter_initialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "330-341",
          "snippet": "static int filter_initialize(git_filter_def *fdef)\n{\n\tint error = 0;\n\n\tif (!fdef->initialized && fdef->filter && fdef->filter->initialize) {\n\t\tif ((error = fdef->filter->initialize(fdef->filter)) < 0)\n\t\t\treturn error;\n\t}\n\n\tfdef->initialized = true;\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_initialize(git_filter_def *fdef)\n{\n\tint error = 0;\n\n\tif (!fdef->initialized && fdef->filter && fdef->filter->initialize) {\n\t\tif ((error = fdef->filter->initialize(fdef->filter)) < 0)\n\t\t\treturn error;\n\t}\n\n\tfdef->initialized = true;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_list_check_attributes",
          "args": [
            "&values",
            "repo",
            "filter_opts->attr_session",
            "fdef",
            "&src"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "filter_list_check_attributes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "423-469",
          "snippet": "static int filter_list_check_attributes(\n\tconst char ***out,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_filter_def *fdef,\n\tconst git_filter_source *src)\n{\n\tint error;\n\tsize_t i;\n\tconst char **strs = git__calloc(fdef->nattrs, sizeof(const char *));\n\tGITERR_CHECK_ALLOC(strs);\n\n\terror = git_attr_get_many_with_session(\n\t\tstrs, repo, attr_session, 0, src->path, fdef->nattrs, fdef->attrs);\n\n\t/* if no values were found but no matches are needed, it's okay! */\n\tif (error == GIT_ENOTFOUND && !fdef->nmatches) {\n\t\tgiterr_clear();\n\t\tgit__free((void *)strs);\n\t\treturn 0;\n\t}\n\n\tfor (i = 0; !error && i < fdef->nattrs; ++i) {\n\t\tconst char *want = fdef->attrs[fdef->nattrs + i];\n\t\tgit_attr_t want_type, found_type;\n\n\t\tif (!want)\n\t\t\tcontinue;\n\n\t\twant_type  = git_attr_value(want);\n\t\tfound_type = git_attr_value(strs[i]);\n\n\t\tif (want_type != found_type)\n\t\t\terror = GIT_ENOTFOUND;\n\t\telse if (want_type == GIT_ATTR_VALUE_T &&\n\t\t\t\tstrcmp(want, strs[i]) &&\n\t\t\t\tstrcmp(want, \"*\"))\n\t\t\terror = GIT_ENOTFOUND;\n\t}\n\n\tif (error)\n\t\tgit__free((void *)strs);\n\telse\n\t\t*out = strs;\n\n\treturn error;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_list_check_attributes(\n\tconst char ***out,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_filter_def *fdef,\n\tconst git_filter_source *src)\n{\n\tint error;\n\tsize_t i;\n\tconst char **strs = git__calloc(fdef->nattrs, sizeof(const char *));\n\tGITERR_CHECK_ALLOC(strs);\n\n\terror = git_attr_get_many_with_session(\n\t\tstrs, repo, attr_session, 0, src->path, fdef->nattrs, fdef->attrs);\n\n\t/* if no values were found but no matches are needed, it's okay! */\n\tif (error == GIT_ENOTFOUND && !fdef->nmatches) {\n\t\tgiterr_clear();\n\t\tgit__free((void *)strs);\n\t\treturn 0;\n\t}\n\n\tfor (i = 0; !error && i < fdef->nattrs; ++i) {\n\t\tconst char *want = fdef->attrs[fdef->nattrs + i];\n\t\tgit_attr_t want_type, found_type;\n\n\t\tif (!want)\n\t\t\tcontinue;\n\n\t\twant_type  = git_attr_value(want);\n\t\tfound_type = git_attr_value(strs[i]);\n\n\t\tif (want_type != found_type)\n\t\t\terror = GIT_ENOTFOUND;\n\t\telse if (want_type == GIT_ATTR_VALUE_T &&\n\t\t\t\tstrcmp(want, strs[i]) &&\n\t\t\t\tstrcmp(want, \"*\"))\n\t\t\terror = GIT_ENOTFOUND;\n\t}\n\n\tif (error)\n\t\tgit__free((void *)strs);\n\telse\n\t\t*out = strs;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&filter_registry.filters",
            "idx",
            "fdef"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&src.oid",
            "git_blob_id(blob)"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_id",
          "args": [
            "blob"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "121-124",
          "snippet": "const git_oid *git_blob_id(const git_blob *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_blob_id(const git_blob *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"failed to lock filter registry\""
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_rdlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_rdlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "193-201",
          "snippet": "int git_rwlock_rdlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_shared)\n\t\twin32_srwlock_acquire_shared(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_acquire_shared;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_acquire_shared;\n\nint git_rwlock_rdlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_shared)\n\t\twin32_srwlock_acquire_shared(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nint git_filter_list__load_ext(\n\tgit_filter_list **filters,\n\tgit_repository *repo,\n\tgit_blob *blob, /* can be NULL */\n\tconst char *path,\n\tgit_filter_mode_t mode,\n\tgit_filter_options *filter_opts)\n{\n\tint error = 0;\n\tgit_filter_list *fl = NULL;\n\tgit_filter_source src = { 0 };\n\tgit_filter_entry *fe;\n\tsize_t idx;\n\tgit_filter_def *fdef;\n\n\tif (git_rwlock_rdlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tsrc.repo = repo;\n\tsrc.path = path;\n\tsrc.mode = mode;\n\tsrc.flags = filter_opts->flags;\n\n\tif (blob)\n\t\tgit_oid_cpy(&src.oid, git_blob_id(blob));\n\n\tgit_vector_foreach(&filter_registry.filters, idx, fdef) {\n\t\tconst char **values = NULL;\n\t\tvoid *payload = NULL;\n\n\t\tif (!fdef || !fdef->filter)\n\t\t\tcontinue;\n\n\t\tif (fdef->nattrs > 0) {\n\t\t\terror = filter_list_check_attributes(\n\t\t\t\t&values, repo, filter_opts->attr_session, fdef, &src);\n\n\t\t\tif (error == GIT_ENOTFOUND) {\n\t\t\t\terror = 0;\n\t\t\t\tcontinue;\n\t\t\t} else if (error < 0)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (!fdef->initialized && (error = filter_initialize(fdef)) < 0)\n\t\t\tbreak;\n\n\t\tif (fdef->filter->check)\n\t\t\terror = fdef->filter->check(\n\t\t\t\tfdef->filter, &payload, &src, values);\n\n\t\tgit__free((void *)values);\n\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = 0;\n\t\telse if (error < 0)\n\t\t\tbreak;\n\t\telse {\n\t\t\tif (!fl) {\n\t\t\t\tif ((error = filter_list_new(&fl, &src)) < 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\tfl->temp_buf = filter_opts->temp_buf;\n\t\t\t}\n\n\t\t\tfe = git_array_alloc(fl->filters);\n\t\t\tGITERR_CHECK_ALLOC(fe);\n\n\t\t\tfe->filter = fdef->filter;\n\t\t\tfe->filter_name = fdef->filter_name;\n\t\t\tfe->payload = payload;\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&filter_registry.lock);\n\n\tif (error && fl != NULL) {\n\t\tgit_array_clear(fl->filters);\n\t\tgit__free(fl);\n\t\tfl = NULL;\n\t}\n\n\t*filters = fl;\n\treturn error;\n}"
  },
  {
    "function_name": "git_filter_list_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "471-483",
    "snippet": "int git_filter_list_new(\n\tgit_filter_list **out,\n\tgit_repository *repo,\n\tgit_filter_mode_t mode,\n\tuint32_t flags)\n{\n\tgit_filter_source src = { 0 };\n\tsrc.repo = repo;\n\tsrc.path = NULL;\n\tsrc.mode = mode;\n\tsrc.flags = flags;\n\treturn filter_list_new(out, &src);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "filter_list_new",
          "args": [
            "out",
            "&src"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "filter_list_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "400-421",
          "snippet": "static int filter_list_new(\n\tgit_filter_list **out, const git_filter_source *src)\n{\n\tgit_filter_list *fl = NULL;\n\tsize_t pathlen = src->path ? strlen(src->path) : 0, alloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, sizeof(git_filter_list), pathlen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tfl = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(fl);\n\n\tif (src->path)\n\t\tmemcpy(fl->path, src->path, pathlen);\n\tfl->source.repo = src->repo;\n\tfl->source.path = fl->path;\n\tfl->source.mode = src->mode;\n\tfl->source.flags = src->flags;\n\n\t*out = fl;\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_list_new(\n\tgit_filter_list **out, const git_filter_source *src)\n{\n\tgit_filter_list *fl = NULL;\n\tsize_t pathlen = src->path ? strlen(src->path) : 0, alloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, sizeof(git_filter_list), pathlen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tfl = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(fl);\n\n\tif (src->path)\n\t\tmemcpy(fl->path, src->path, pathlen);\n\tfl->source.repo = src->repo;\n\tfl->source.path = fl->path;\n\tfl->source.mode = src->mode;\n\tfl->source.flags = src->flags;\n\n\t*out = fl;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_new(\n\tgit_filter_list **out,\n\tgit_repository *repo,\n\tgit_filter_mode_t mode,\n\tuint32_t flags)\n{\n\tgit_filter_source src = { 0 };\n\tsrc.repo = repo;\n\tsrc.path = NULL;\n\tsrc.mode = mode;\n\tsrc.flags = flags;\n\treturn filter_list_new(out, &src);\n}"
  },
  {
    "function_name": "filter_list_check_attributes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "423-469",
    "snippet": "static int filter_list_check_attributes(\n\tconst char ***out,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_filter_def *fdef,\n\tconst git_filter_source *src)\n{\n\tint error;\n\tsize_t i;\n\tconst char **strs = git__calloc(fdef->nattrs, sizeof(const char *));\n\tGITERR_CHECK_ALLOC(strs);\n\n\terror = git_attr_get_many_with_session(\n\t\tstrs, repo, attr_session, 0, src->path, fdef->nattrs, fdef->attrs);\n\n\t/* if no values were found but no matches are needed, it's okay! */\n\tif (error == GIT_ENOTFOUND && !fdef->nmatches) {\n\t\tgiterr_clear();\n\t\tgit__free((void *)strs);\n\t\treturn 0;\n\t}\n\n\tfor (i = 0; !error && i < fdef->nattrs; ++i) {\n\t\tconst char *want = fdef->attrs[fdef->nattrs + i];\n\t\tgit_attr_t want_type, found_type;\n\n\t\tif (!want)\n\t\t\tcontinue;\n\n\t\twant_type  = git_attr_value(want);\n\t\tfound_type = git_attr_value(strs[i]);\n\n\t\tif (want_type != found_type)\n\t\t\terror = GIT_ENOTFOUND;\n\t\telse if (want_type == GIT_ATTR_VALUE_T &&\n\t\t\t\tstrcmp(want, strs[i]) &&\n\t\t\t\tstrcmp(want, \"*\"))\n\t\t\terror = GIT_ENOTFOUND;\n\t}\n\n\tif (error)\n\t\tgit__free((void *)strs);\n\telse\n\t\t*out = strs;\n\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "(void *)strs"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "want",
            "\"*\""
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_attr_value",
          "args": [
            "strs[i]"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr.c",
          "lines": "16-28",
          "snippet": "git_attr_t git_attr_value(const char *attr)\n{\n\tif (attr == NULL || attr == git_attr__unset)\n\t\treturn GIT_ATTR_UNSPECIFIED_T;\n\n\tif (attr == git_attr__true)\n\t\treturn GIT_ATTR_TRUE_T;\n\n\tif (attr == git_attr__false)\n\t\treturn GIT_ATTR_FALSE_T;\n\n\treturn GIT_ATTR_VALUE_T;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"git2/oid.h\"",
            "#include \"ignore.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "GIT__USE_STRMAP\n\nconst char *git_attr__true  = \"[internal]__TRUE__\";",
            "const char *git_attr__false = \"[internal]__FALSE__\";",
            "const char *git_attr__unset = \"[internal]__UNSET__\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"git2/oid.h\"\n#include \"ignore.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT__USE_STRMAP\n\nconst char *git_attr__true  = \"[internal]__TRUE__\";\nconst char *git_attr__false = \"[internal]__FALSE__\";\nconst char *git_attr__unset = \"[internal]__UNSET__\";\n\ngit_attr_t git_attr_value(const char *attr)\n{\n\tif (attr == NULL || attr == git_attr__unset)\n\t\treturn GIT_ATTR_UNSPECIFIED_T;\n\n\tif (attr == git_attr__true)\n\t\treturn GIT_ATTR_TRUE_T;\n\n\tif (attr == git_attr__false)\n\t\treturn GIT_ATTR_FALSE_T;\n\n\treturn GIT_ATTR_VALUE_T;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_attr_get_many_with_session",
          "args": [
            "strs",
            "repo",
            "attr_session",
            "0",
            "src->path",
            "fdef->nattrs",
            "fdef->attrs"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_get_many_with_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr.c",
          "lines": "94-164",
          "snippet": "int git_attr_get_many_with_session(\n\tconst char **values,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tuint32_t flags,\n\tconst char *pathname,\n\tsize_t num_attr,\n\tconst char **names)\n{\n\tint error;\n\tgit_attr_path path;\n\tgit_vector files = GIT_VECTOR_INIT;\n\tsize_t i, j, k;\n\tgit_attr_file *file;\n\tgit_attr_rule *rule;\n\tattr_get_many_info *info = NULL;\n\tsize_t num_found = 0;\n\n\tif (!num_attr)\n\t\treturn 0;\n\n\tassert(values && repo && names);\n\n\tif (git_attr_path__init(&path, pathname, git_repository_workdir(repo), GIT_DIR_FLAG_UNKNOWN) < 0)\n\t\treturn -1;\n\n\tif ((error = collect_attr_files(repo, attr_session, flags, pathname, &files)) < 0)\n\t\tgoto cleanup;\n\n\tinfo = git__calloc(num_attr, sizeof(attr_get_many_info));\n\tGITERR_CHECK_ALLOC(info);\n\n\tgit_vector_foreach(&files, i, file) {\n\n\t\tgit_attr_file__foreach_matching_rule(file, &path, j, rule) {\n\n\t\t\tfor (k = 0; k < num_attr; k++) {\n\t\t\t\tsize_t pos;\n\n\t\t\t\tif (info[k].found != NULL) /* already found assignment */\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (!info[k].name.name) {\n\t\t\t\t\tinfo[k].name.name = names[k];\n\t\t\t\t\tinfo[k].name.name_hash = git_attr_file__name_hash(names[k]);\n\t\t\t\t}\n\n\t\t\t\tif (!git_vector_bsearch(&pos, &rule->assigns, &info[k].name)) {\n\t\t\t\t\tinfo[k].found = (git_attr_assignment *)\n\t\t\t\t\t\tgit_vector_get(&rule->assigns, pos);\n\t\t\t\t\tvalues[k] = info[k].found->value;\n\n\t\t\t\t\tif (++num_found == num_attr)\n\t\t\t\t\t\tgoto cleanup;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (k = 0; k < num_attr; k++) {\n\t\tif (!info[k].found)\n\t\t\tvalues[k] = NULL;\n\t}\n\ncleanup:\n\trelease_attr_files(&files);\n\tgit_attr_path__free(&path);\n\tgit__free(info);\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"git2/oid.h\"",
            "#include \"ignore.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int collect_attr_files(\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tuint32_t flags,\n\tconst char *path,\n\tgit_vector *files);",
            "static void release_attr_files(git_vector *files);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"git2/oid.h\"\n#include \"ignore.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int collect_attr_files(\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tuint32_t flags,\n\tconst char *path,\n\tgit_vector *files);\nstatic void release_attr_files(git_vector *files);\n\nint git_attr_get_many_with_session(\n\tconst char **values,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tuint32_t flags,\n\tconst char *pathname,\n\tsize_t num_attr,\n\tconst char **names)\n{\n\tint error;\n\tgit_attr_path path;\n\tgit_vector files = GIT_VECTOR_INIT;\n\tsize_t i, j, k;\n\tgit_attr_file *file;\n\tgit_attr_rule *rule;\n\tattr_get_many_info *info = NULL;\n\tsize_t num_found = 0;\n\n\tif (!num_attr)\n\t\treturn 0;\n\n\tassert(values && repo && names);\n\n\tif (git_attr_path__init(&path, pathname, git_repository_workdir(repo), GIT_DIR_FLAG_UNKNOWN) < 0)\n\t\treturn -1;\n\n\tif ((error = collect_attr_files(repo, attr_session, flags, pathname, &files)) < 0)\n\t\tgoto cleanup;\n\n\tinfo = git__calloc(num_attr, sizeof(attr_get_many_info));\n\tGITERR_CHECK_ALLOC(info);\n\n\tgit_vector_foreach(&files, i, file) {\n\n\t\tgit_attr_file__foreach_matching_rule(file, &path, j, rule) {\n\n\t\t\tfor (k = 0; k < num_attr; k++) {\n\t\t\t\tsize_t pos;\n\n\t\t\t\tif (info[k].found != NULL) /* already found assignment */\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (!info[k].name.name) {\n\t\t\t\t\tinfo[k].name.name = names[k];\n\t\t\t\t\tinfo[k].name.name_hash = git_attr_file__name_hash(names[k]);\n\t\t\t\t}\n\n\t\t\t\tif (!git_vector_bsearch(&pos, &rule->assigns, &info[k].name)) {\n\t\t\t\t\tinfo[k].found = (git_attr_assignment *)\n\t\t\t\t\t\tgit_vector_get(&rule->assigns, pos);\n\t\t\t\t\tvalues[k] = info[k].found->value;\n\n\t\t\t\t\tif (++num_found == num_attr)\n\t\t\t\t\t\tgoto cleanup;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (k = 0; k < num_attr; k++) {\n\t\tif (!info[k].found)\n\t\t\tvalues[k] = NULL;\n\t}\n\ncleanup:\n\trelease_attr_files(&files);\n\tgit_attr_path__free(&path);\n\tgit__free(info);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "strs"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "fdef->nattrs",
            "sizeof(const char *)"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_list_check_attributes(\n\tconst char ***out,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_filter_def *fdef,\n\tconst git_filter_source *src)\n{\n\tint error;\n\tsize_t i;\n\tconst char **strs = git__calloc(fdef->nattrs, sizeof(const char *));\n\tGITERR_CHECK_ALLOC(strs);\n\n\terror = git_attr_get_many_with_session(\n\t\tstrs, repo, attr_session, 0, src->path, fdef->nattrs, fdef->attrs);\n\n\t/* if no values were found but no matches are needed, it's okay! */\n\tif (error == GIT_ENOTFOUND && !fdef->nmatches) {\n\t\tgiterr_clear();\n\t\tgit__free((void *)strs);\n\t\treturn 0;\n\t}\n\n\tfor (i = 0; !error && i < fdef->nattrs; ++i) {\n\t\tconst char *want = fdef->attrs[fdef->nattrs + i];\n\t\tgit_attr_t want_type, found_type;\n\n\t\tif (!want)\n\t\t\tcontinue;\n\n\t\twant_type  = git_attr_value(want);\n\t\tfound_type = git_attr_value(strs[i]);\n\n\t\tif (want_type != found_type)\n\t\t\terror = GIT_ENOTFOUND;\n\t\telse if (want_type == GIT_ATTR_VALUE_T &&\n\t\t\t\tstrcmp(want, strs[i]) &&\n\t\t\t\tstrcmp(want, \"*\"))\n\t\t\terror = GIT_ENOTFOUND;\n\t}\n\n\tif (error)\n\t\tgit__free((void *)strs);\n\telse\n\t\t*out = strs;\n\n\treturn error;\n}"
  },
  {
    "function_name": "filter_list_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "400-421",
    "snippet": "static int filter_list_new(\n\tgit_filter_list **out, const git_filter_source *src)\n{\n\tgit_filter_list *fl = NULL;\n\tsize_t pathlen = src->path ? strlen(src->path) : 0, alloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, sizeof(git_filter_list), pathlen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tfl = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(fl);\n\n\tif (src->path)\n\t\tmemcpy(fl->path, src->path, pathlen);\n\tfl->source.repo = src->repo;\n\tfl->source.path = fl->path;\n\tfl->source.mode = src->mode;\n\tfl->source.flags = src->flags;\n\n\t*out = fl;\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fl->path",
            "src->path",
            "pathlen"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "fl"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "alloclen"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloclen",
            "alloclen",
            "1"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloclen",
            "sizeof(git_filter_list)",
            "pathlen"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "src->path"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_list_new(\n\tgit_filter_list **out, const git_filter_source *src)\n{\n\tgit_filter_list *fl = NULL;\n\tsize_t pathlen = src->path ? strlen(src->path) : 0, alloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, sizeof(git_filter_list), pathlen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tfl = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(fl);\n\n\tif (src->path)\n\t\tmemcpy(fl->path, src->path, pathlen);\n\tfl->source.repo = src->repo;\n\tfl->source.path = fl->path;\n\tfl->source.mode = src->mode;\n\tfl->source.flags = src->flags;\n\n\t*out = fl;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_filter_source_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "395-398",
    "snippet": "uint32_t git_filter_source_flags(const git_filter_source *src)\n{\n\treturn src->flags;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nuint32_t git_filter_source_flags(const git_filter_source *src)\n{\n\treturn src->flags;\n}"
  },
  {
    "function_name": "git_filter_source_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "390-393",
    "snippet": "git_filter_mode_t git_filter_source_mode(const git_filter_source *src)\n{\n\treturn src->mode;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\ngit_filter_mode_t git_filter_source_mode(const git_filter_source *src)\n{\n\treturn src->mode;\n}"
  },
  {
    "function_name": "git_filter_source_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "385-388",
    "snippet": "const git_oid *git_filter_source_id(const git_filter_source *src)\n{\n\treturn git_oid_iszero(&src->oid) ? NULL : &src->oid;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_iszero",
          "args": [
            "&src->oid"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_iszero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "239-247",
          "snippet": "int git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nconst git_oid *git_filter_source_id(const git_filter_source *src)\n{\n\treturn git_oid_iszero(&src->oid) ? NULL : &src->oid;\n}"
  },
  {
    "function_name": "git_filter_source_filemode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "380-383",
    "snippet": "uint16_t git_filter_source_filemode(const git_filter_source *src)\n{\n\treturn src->filemode;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nuint16_t git_filter_source_filemode(const git_filter_source *src)\n{\n\treturn src->filemode;\n}"
  },
  {
    "function_name": "git_filter_source_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "375-378",
    "snippet": "const char *git_filter_source_path(const git_filter_source *src)\n{\n\treturn src->path;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nconst char *git_filter_source_path(const git_filter_source *src)\n{\n\treturn src->path;\n}"
  },
  {
    "function_name": "git_filter_source_repo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "370-373",
    "snippet": "git_repository *git_filter_source_repo(const git_filter_source *src)\n{\n\treturn src->repo;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\ngit_repository *git_filter_source_repo(const git_filter_source *src)\n{\n\treturn src->repo;\n}"
  },
  {
    "function_name": "git_filter_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "365-368",
    "snippet": "void git_filter_free(git_filter *filter)\n{\n\tgit__free(filter);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "filter"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid git_filter_free(git_filter *filter)\n{\n\tgit__free(filter);\n}"
  },
  {
    "function_name": "git_filter_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "343-363",
    "snippet": "git_filter *git_filter_lookup(const char *name)\n{\n\tsize_t pos;\n\tgit_filter_def *fdef;\n\tgit_filter *filter = NULL;\n\n\tif (git_rwlock_rdlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn NULL;\n\t}\n\n\tif ((fdef = filter_registry_lookup(&pos, name)) == NULL ||\n\t\t(!fdef->initialized && filter_initialize(fdef) < 0))\n\t\tgoto done;\n\n\tfilter = fdef->filter;\n\ndone:\n\tgit_rwlock_rdunlock(&filter_registry.lock);\n\treturn filter;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_rwlock_rdunlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_rdunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "203-211",
          "snippet": "int git_rwlock_rdunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_shared)\n\t\twin32_srwlock_release_shared(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_release_shared;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_release_shared;\n\nint git_rwlock_rdunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_shared)\n\t\twin32_srwlock_release_shared(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_initialize",
          "args": [
            "fdef"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "filter_initialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "330-341",
          "snippet": "static int filter_initialize(git_filter_def *fdef)\n{\n\tint error = 0;\n\n\tif (!fdef->initialized && fdef->filter && fdef->filter->initialize) {\n\t\tif ((error = fdef->filter->initialize(fdef->filter)) < 0)\n\t\t\treturn error;\n\t}\n\n\tfdef->initialized = true;\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_initialize(git_filter_def *fdef)\n{\n\tint error = 0;\n\n\tif (!fdef->initialized && fdef->filter && fdef->filter->initialize) {\n\t\tif ((error = fdef->filter->initialize(fdef->filter)) < 0)\n\t\t\treturn error;\n\t}\n\n\tfdef->initialized = true;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_registry_lookup",
          "args": [
            "&pos",
            "name"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "filter_registry_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "252-260",
          "snippet": "static git_filter_def *filter_registry_lookup(size_t *pos, const char *name)\n{\n\tgit_filter_def *fdef = NULL;\n\n\tif (!filter_registry_find(pos, name))\n\t\tfdef = git_vector_get(&filter_registry.filters, *pos);\n\n\treturn fdef;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_filter_registry filter_registry;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nstatic git_filter_def *filter_registry_lookup(size_t *pos, const char *name)\n{\n\tgit_filter_def *fdef = NULL;\n\n\tif (!filter_registry_find(pos, name))\n\t\tfdef = git_vector_get(&filter_registry.filters, *pos);\n\n\treturn fdef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"failed to lock filter registry\""
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_rdlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_rdlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "193-201",
          "snippet": "int git_rwlock_rdlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_shared)\n\t\twin32_srwlock_acquire_shared(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_acquire_shared;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_acquire_shared;\n\nint git_rwlock_rdlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_shared)\n\t\twin32_srwlock_acquire_shared(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\ngit_filter *git_filter_lookup(const char *name)\n{\n\tsize_t pos;\n\tgit_filter_def *fdef;\n\tgit_filter *filter = NULL;\n\n\tif (git_rwlock_rdlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn NULL;\n\t}\n\n\tif ((fdef = filter_registry_lookup(&pos, name)) == NULL ||\n\t\t(!fdef->initialized && filter_initialize(fdef) < 0))\n\t\tgoto done;\n\n\tfilter = fdef->filter;\n\ndone:\n\tgit_rwlock_rdunlock(&filter_registry.lock);\n\treturn filter;\n}"
  },
  {
    "function_name": "filter_initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "330-341",
    "snippet": "static int filter_initialize(git_filter_def *fdef)\n{\n\tint error = 0;\n\n\tif (!fdef->initialized && fdef->filter && fdef->filter->initialize) {\n\t\tif ((error = fdef->filter->initialize(fdef->filter)) < 0)\n\t\t\treturn error;\n\t}\n\n\tfdef->initialized = true;\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdef->filter->initialize",
          "args": [
            "fdef->filter"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_initialize(git_filter_def *fdef)\n{\n\tint error = 0;\n\n\tif (!fdef->initialized && fdef->filter && fdef->filter->initialize) {\n\t\tif ((error = fdef->filter->initialize(fdef->filter)) < 0)\n\t\t\treturn error;\n\t}\n\n\tfdef->initialized = true;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_filter_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "289-328",
    "snippet": "int git_filter_unregister(const char *name)\n{\n\tsize_t pos;\n\tgit_filter_def *fdef;\n\tint error = 0;\n\n\tassert(name);\n\n\t/* cannot unregister default filters */\n\tif (!strcmp(GIT_FILTER_CRLF, name) || !strcmp(GIT_FILTER_IDENT, name)) {\n\t\tgiterr_set(GITERR_FILTER, \"Cannot unregister filter '%s'\", name);\n\t\treturn -1;\n\t}\n\n\tif (git_rwlock_wrlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tif ((fdef = filter_registry_lookup(&pos, name)) == NULL) {\n\t\tgiterr_set(GITERR_FILTER, \"Cannot find filter '%s' to unregister\", name);\n\t\terror = GIT_ENOTFOUND;\n\t\tgoto done;\n\t}\n\n\tgit_vector_remove(&filter_registry.filters, pos);\n\n\tif (fdef->initialized && fdef->filter && fdef->filter->shutdown) {\n\t\tfdef->filter->shutdown(fdef->filter);\n\t\tfdef->initialized = false;\n\t}\n\n\tgit__free(fdef->filter_name);\n\tgit__free(fdef->attrdata);\n\tgit__free(fdef);\n\ndone:\n\tgit_rwlock_wrunlock(&filter_registry.lock);\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_rwlock_wrunlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "223-231",
          "snippet": "int git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_release_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_release_exclusive;\n\nint git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "fdef"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdef->filter->shutdown",
          "args": [
            "fdef->filter"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_remove",
          "args": [
            "&filter_registry.filters",
            "pos"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "233-250",
          "snippet": "int git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_FILTER",
            "\"Cannot find filter '%s' to unregister\"",
            "name"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_registry_lookup",
          "args": [
            "&pos",
            "name"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "filter_registry_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "252-260",
          "snippet": "static git_filter_def *filter_registry_lookup(size_t *pos, const char *name)\n{\n\tgit_filter_def *fdef = NULL;\n\n\tif (!filter_registry_find(pos, name))\n\t\tfdef = git_vector_get(&filter_registry.filters, *pos);\n\n\treturn fdef;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_filter_registry filter_registry;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nstatic git_filter_def *filter_registry_lookup(size_t *pos, const char *name)\n{\n\tgit_filter_def *fdef = NULL;\n\n\tif (!filter_registry_find(pos, name))\n\t\tfdef = git_vector_get(&filter_registry.filters, *pos);\n\n\treturn fdef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"failed to lock filter registry\""
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_wrlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "213-221",
          "snippet": "int git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_acquire_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_acquire_exclusive;\n\nint git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "GIT_FILTER_IDENT",
            "name"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "name"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nint git_filter_unregister(const char *name)\n{\n\tsize_t pos;\n\tgit_filter_def *fdef;\n\tint error = 0;\n\n\tassert(name);\n\n\t/* cannot unregister default filters */\n\tif (!strcmp(GIT_FILTER_CRLF, name) || !strcmp(GIT_FILTER_IDENT, name)) {\n\t\tgiterr_set(GITERR_FILTER, \"Cannot unregister filter '%s'\", name);\n\t\treturn -1;\n\t}\n\n\tif (git_rwlock_wrlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tif ((fdef = filter_registry_lookup(&pos, name)) == NULL) {\n\t\tgiterr_set(GITERR_FILTER, \"Cannot find filter '%s' to unregister\", name);\n\t\terror = GIT_ENOTFOUND;\n\t\tgoto done;\n\t}\n\n\tgit_vector_remove(&filter_registry.filters, pos);\n\n\tif (fdef->initialized && fdef->filter && fdef->filter->shutdown) {\n\t\tfdef->filter->shutdown(fdef->filter);\n\t\tfdef->initialized = false;\n\t}\n\n\tgit__free(fdef->filter_name);\n\tgit__free(fdef->attrdata);\n\tgit__free(fdef);\n\ndone:\n\tgit_rwlock_wrunlock(&filter_registry.lock);\n\treturn error;\n}"
  },
  {
    "function_name": "git_filter_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "263-287",
    "snippet": "int git_filter_register(\n\tconst char *name, git_filter *filter, int priority)\n{\n\tint error;\n\n\tassert(name && filter);\n\n\tif (git_rwlock_wrlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tif (!filter_registry_find(NULL, name)) {\n\t\tgiterr_set(\n\t\t\tGITERR_FILTER, \"attempt to reregister existing filter '%s'\", name);\n\t\terror = GIT_EEXISTS;\n\t\tgoto done;\n\t}\n\n\terror = filter_registry_insert(name, filter, priority);\n\ndone:\n\tgit_rwlock_wrunlock(&filter_registry.lock);\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_rwlock_wrunlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "223-231",
          "snippet": "int git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_release_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_release_exclusive;\n\nint git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_registry_insert",
          "args": [
            "name",
            "filter",
            "priority"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "filter_registry_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "149-186",
          "snippet": "static int filter_registry_insert(\n\tconst char *name, git_filter *filter, int priority)\n{\n\tgit_filter_def *fdef;\n\tsize_t nattr = 0, nmatch = 0, alloc_len;\n\tgit_buf attrs = GIT_BUF_INIT;\n\n\tif (filter_def_scan_attrs(&attrs, &nattr, &nmatch, filter->attributes) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, nattr, 2);\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, alloc_len, sizeof(char *));\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, sizeof(git_filter_def));\n\n\tfdef = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(fdef);\n\n\tfdef->filter_name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(fdef->filter_name);\n\n\tfdef->filter      = filter;\n\tfdef->priority    = priority;\n\tfdef->nattrs      = nattr;\n\tfdef->nmatches    = nmatch;\n\tfdef->attrdata    = git_buf_detach(&attrs);\n\n\tfilter_def_set_attrs(fdef);\n\n\tif (git_vector_insert(&filter_registry.filters, fdef) < 0) {\n\t\tgit__free(fdef->filter_name);\n\t\tgit__free(fdef->attrdata);\n\t\tgit__free(fdef);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&filter_registry.filters);\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_filter_registry filter_registry;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nstatic int filter_registry_insert(\n\tconst char *name, git_filter *filter, int priority)\n{\n\tgit_filter_def *fdef;\n\tsize_t nattr = 0, nmatch = 0, alloc_len;\n\tgit_buf attrs = GIT_BUF_INIT;\n\n\tif (filter_def_scan_attrs(&attrs, &nattr, &nmatch, filter->attributes) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, nattr, 2);\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, alloc_len, sizeof(char *));\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, sizeof(git_filter_def));\n\n\tfdef = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(fdef);\n\n\tfdef->filter_name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(fdef->filter_name);\n\n\tfdef->filter      = filter;\n\tfdef->priority    = priority;\n\tfdef->nattrs      = nattr;\n\tfdef->nmatches    = nmatch;\n\tfdef->attrdata    = git_buf_detach(&attrs);\n\n\tfilter_def_set_attrs(fdef);\n\n\tif (git_vector_insert(&filter_registry.filters, fdef) < 0) {\n\t\tgit__free(fdef->filter_name);\n\t\tgit__free(fdef->attrdata);\n\t\tgit__free(fdef);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&filter_registry.filters);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_FILTER",
            "\"attempt to reregister existing filter '%s'\"",
            "name"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_registry_find",
          "args": [
            "NULL",
            "name"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "filter_registry_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "245-249",
          "snippet": "static int filter_registry_find(size_t *pos, const char *name)\n{\n\treturn git_vector_search2(\n\t\tpos, &filter_registry.filters, filter_def_name_key_check, name);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_filter_registry filter_registry;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nstatic int filter_registry_find(size_t *pos, const char *name)\n{\n\treturn git_vector_search2(\n\t\tpos, &filter_registry.filters, filter_def_name_key_check, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"failed to lock filter registry\""
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_wrlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "213-221",
          "snippet": "int git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_acquire_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_acquire_exclusive;\n\nint git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "name && filter"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nint git_filter_register(\n\tconst char *name, git_filter *filter, int priority)\n{\n\tint error;\n\n\tassert(name && filter);\n\n\tif (git_rwlock_wrlock(&filter_registry.lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"failed to lock filter registry\");\n\t\treturn -1;\n\t}\n\n\tif (!filter_registry_find(NULL, name)) {\n\t\tgiterr_set(\n\t\t\tGITERR_FILTER, \"attempt to reregister existing filter '%s'\", name);\n\t\terror = GIT_EEXISTS;\n\t\tgoto done;\n\t}\n\n\terror = filter_registry_insert(name, filter, priority);\n\ndone:\n\tgit_rwlock_wrunlock(&filter_registry.lock);\n\treturn error;\n}"
  },
  {
    "function_name": "filter_registry_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "252-260",
    "snippet": "static git_filter_def *filter_registry_lookup(size_t *pos, const char *name)\n{\n\tgit_filter_def *fdef = NULL;\n\n\tif (!filter_registry_find(pos, name))\n\t\tfdef = git_vector_get(&filter_registry.filters, *pos);\n\n\treturn fdef;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&filter_registry.filters",
            "*pos"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_registry_find",
          "args": [
            "pos",
            "name"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "filter_registry_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "245-249",
          "snippet": "static int filter_registry_find(size_t *pos, const char *name)\n{\n\treturn git_vector_search2(\n\t\tpos, &filter_registry.filters, filter_def_name_key_check, name);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_filter_registry filter_registry;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nstatic int filter_registry_find(size_t *pos, const char *name)\n{\n\treturn git_vector_search2(\n\t\tpos, &filter_registry.filters, filter_def_name_key_check, name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nstatic git_filter_def *filter_registry_lookup(size_t *pos, const char *name)\n{\n\tgit_filter_def *fdef = NULL;\n\n\tif (!filter_registry_find(pos, name))\n\t\tfdef = git_vector_get(&filter_registry.filters, *pos);\n\n\treturn fdef;\n}"
  },
  {
    "function_name": "filter_registry_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "245-249",
    "snippet": "static int filter_registry_find(size_t *pos, const char *name)\n{\n\treturn git_vector_search2(\n\t\tpos, &filter_registry.filters, filter_def_name_key_check, name);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_search2",
          "args": [
            "pos",
            "&filter_registry.filters",
            "filter_def_name_key_check",
            "name"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_search2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "204-221",
          "snippet": "int git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_search2(\n\tsize_t *at_pos, const git_vector *v, git_vector_cmp key_lookup, const void *key)\n{\n\tsize_t i;\n\n\tassert(v && key && key_lookup);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tif (key_lookup(key, v->contents[i]) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\treturn GIT_ENOTFOUND;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nstatic int filter_registry_find(size_t *pos, const char *name)\n{\n\treturn git_vector_search2(\n\t\tpos, &filter_registry.filters, filter_def_name_key_check, name);\n}"
  },
  {
    "function_name": "git_filter_global_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "219-242",
    "snippet": "static void git_filter_global_shutdown(void)\n{\n\tsize_t pos;\n\tgit_filter_def *fdef;\n\n\tif (git_rwlock_wrlock(&filter_registry.lock) < 0)\n\t\treturn;\n\n\tgit_vector_foreach(&filter_registry.filters, pos, fdef) {\n\t\tif (fdef->filter && fdef->filter->shutdown) {\n\t\t\tfdef->filter->shutdown(fdef->filter);\n\t\t\tfdef->initialized = false;\n\t\t}\n\n\t\tgit__free(fdef->filter_name);\n\t\tgit__free(fdef->attrdata);\n\t\tgit__free(fdef);\n\t}\n\n\tgit_vector_free(&filter_registry.filters);\n\n\tgit_rwlock_wrunlock(&filter_registry.lock);\n\tgit_rwlock_free(&filter_registry.lock);\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;",
      "static void git_filter_global_shutdown(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_rwlock_free",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "233-239",
          "snippet": "int git_rwlock_free(git_rwlock *lock)\n{\n\tif (!win32_srwlock_initialize)\n\t\tDeleteCriticalSection(&lock->native.csec);\n\tgit__memzero(lock, sizeof(*lock));\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_initialize;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_initialize;\n\nint git_rwlock_free(git_rwlock *lock)\n{\n\tif (!win32_srwlock_initialize)\n\t\tDeleteCriticalSection(&lock->native.csec);\n\tgit__memzero(lock, sizeof(*lock));\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_wrunlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "223-231",
          "snippet": "int git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_release_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_release_exclusive;\n\nint git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "&filter_registry.filters"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "fdef"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdef->filter->shutdown",
          "args": [
            "fdef->filter"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&filter_registry.filters",
            "pos",
            "fdef"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_rwlock_wrlock",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "213-221",
          "snippet": "int git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_acquire_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_acquire_exclusive;\n\nint git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\nstatic void git_filter_global_shutdown(void);\n\nstatic void git_filter_global_shutdown(void)\n{\n\tsize_t pos;\n\tgit_filter_def *fdef;\n\n\tif (git_rwlock_wrlock(&filter_registry.lock) < 0)\n\t\treturn;\n\n\tgit_vector_foreach(&filter_registry.filters, pos, fdef) {\n\t\tif (fdef->filter && fdef->filter->shutdown) {\n\t\t\tfdef->filter->shutdown(fdef->filter);\n\t\t\tfdef->initialized = false;\n\t\t}\n\n\t\tgit__free(fdef->filter_name);\n\t\tgit__free(fdef->attrdata);\n\t\tgit__free(fdef);\n\t}\n\n\tgit_vector_free(&filter_registry.filters);\n\n\tgit_rwlock_wrunlock(&filter_registry.lock);\n\tgit_rwlock_free(&filter_registry.lock);\n}"
  },
  {
    "function_name": "git_filter_global_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "188-217",
    "snippet": "int git_filter_global_init(void)\n{\n\tgit_filter *crlf = NULL, *ident = NULL;\n\tint error = 0;\n\n\tif (git_rwlock_init(&filter_registry.lock) < 0)\n\t\treturn -1;\n\n\tif ((error = git_vector_init(&filter_registry.filters, 2,\n\t\tfilter_def_priority_cmp)) < 0)\n\t\tgoto done;\n\n\tif ((crlf = git_crlf_filter_new()) == NULL ||\n\t\tfilter_registry_insert(\n\t\t\tGIT_FILTER_CRLF, crlf, GIT_FILTER_CRLF_PRIORITY) < 0 ||\n\t\t(ident = git_ident_filter_new()) == NULL ||\n\t\tfilter_registry_insert(\n\t\t\tGIT_FILTER_IDENT, ident, GIT_FILTER_IDENT_PRIORITY) < 0)\n\t\terror = -1;\n\n\tgit__on_shutdown(git_filter_global_shutdown);\n\ndone:\n\tif (error) {\n\t\tgit_filter_free(crlf);\n\t\tgit_filter_free(ident);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;",
      "static void git_filter_global_shutdown(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_filter_free",
          "args": [
            "ident"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "365-368",
          "snippet": "void git_filter_free(git_filter *filter)\n{\n\tgit__free(filter);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid git_filter_free(git_filter *filter)\n{\n\tgit__free(filter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__on_shutdown",
          "args": [
            "git_filter_global_shutdown"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "git__on_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "32-37",
          "snippet": "void git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MAX_SHUTDOWN_CB 8"
          ],
          "globals_used": [
            "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
            "static git_atomic git__n_shutdown_callbacks;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\n#define MAX_SHUTDOWN_CB 8\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\n\nvoid git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_registry_insert",
          "args": [
            "GIT_FILTER_IDENT",
            "ident",
            "GIT_FILTER_IDENT_PRIORITY"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "filter_registry_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "149-186",
          "snippet": "static int filter_registry_insert(\n\tconst char *name, git_filter *filter, int priority)\n{\n\tgit_filter_def *fdef;\n\tsize_t nattr = 0, nmatch = 0, alloc_len;\n\tgit_buf attrs = GIT_BUF_INIT;\n\n\tif (filter_def_scan_attrs(&attrs, &nattr, &nmatch, filter->attributes) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, nattr, 2);\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, alloc_len, sizeof(char *));\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, sizeof(git_filter_def));\n\n\tfdef = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(fdef);\n\n\tfdef->filter_name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(fdef->filter_name);\n\n\tfdef->filter      = filter;\n\tfdef->priority    = priority;\n\tfdef->nattrs      = nattr;\n\tfdef->nmatches    = nmatch;\n\tfdef->attrdata    = git_buf_detach(&attrs);\n\n\tfilter_def_set_attrs(fdef);\n\n\tif (git_vector_insert(&filter_registry.filters, fdef) < 0) {\n\t\tgit__free(fdef->filter_name);\n\t\tgit__free(fdef->attrdata);\n\t\tgit__free(fdef);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&filter_registry.filters);\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_filter_registry filter_registry;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nstatic int filter_registry_insert(\n\tconst char *name, git_filter *filter, int priority)\n{\n\tgit_filter_def *fdef;\n\tsize_t nattr = 0, nmatch = 0, alloc_len;\n\tgit_buf attrs = GIT_BUF_INIT;\n\n\tif (filter_def_scan_attrs(&attrs, &nattr, &nmatch, filter->attributes) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, nattr, 2);\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, alloc_len, sizeof(char *));\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, sizeof(git_filter_def));\n\n\tfdef = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(fdef);\n\n\tfdef->filter_name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(fdef->filter_name);\n\n\tfdef->filter      = filter;\n\tfdef->priority    = priority;\n\tfdef->nattrs      = nattr;\n\tfdef->nmatches    = nmatch;\n\tfdef->attrdata    = git_buf_detach(&attrs);\n\n\tfilter_def_set_attrs(fdef);\n\n\tif (git_vector_insert(&filter_registry.filters, fdef) < 0) {\n\t\tgit__free(fdef->filter_name);\n\t\tgit__free(fdef->attrdata);\n\t\tgit__free(fdef);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&filter_registry.filters);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_ident_filter_new",
          "args": [],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "git_ident_filter_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
          "lines": "115-127",
          "snippet": "git_filter *git_ident_filter_new(void)\n{\n\tgit_filter *f = git__calloc(1, sizeof(git_filter));\n\tif (f == NULL)\n\t\treturn NULL;\n\n\tf->version = GIT_FILTER_VERSION;\n\tf->attributes = \"+ident\"; /* apply to files with ident attribute set */\n\tf->shutdown = git_filter_free;\n\tf->apply    = ident_apply;\n\n\treturn f;\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"filter.h\"",
            "#include \"git2/sys/filter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\ngit_filter *git_ident_filter_new(void)\n{\n\tgit_filter *f = git__calloc(1, sizeof(git_filter));\n\tif (f == NULL)\n\t\treturn NULL;\n\n\tf->version = GIT_FILTER_VERSION;\n\tf->attributes = \"+ident\"; /* apply to files with ident attribute set */\n\tf->shutdown = git_filter_free;\n\tf->apply    = ident_apply;\n\n\treturn f;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_crlf_filter_new",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "git_crlf_filter_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/crlf.c",
          "lines": "367-382",
          "snippet": "git_filter *git_crlf_filter_new(void)\n{\n\tstruct crlf_filter *f = git__calloc(1, sizeof(struct crlf_filter));\n\tif (f == NULL)\n\t\treturn NULL;\n\n\tf->f.version = GIT_FILTER_VERSION;\n\tf->f.attributes = \"crlf eol text\";\n\tf->f.initialize = NULL;\n\tf->f.shutdown = git_filter_free;\n\tf->f.check    = crlf_check;\n\tf->f.apply    = crlf_apply;\n\tf->f.cleanup  = crlf_cleanup;\n\n\treturn (git_filter *)f;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"buf_text.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/attr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"buf_text.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n#include \"git2/sys/filter.h\"\n#include \"git2/index.h\"\n#include \"git2/blob.h\"\n#include \"git2/attr.h\"\n\ngit_filter *git_crlf_filter_new(void)\n{\n\tstruct crlf_filter *f = git__calloc(1, sizeof(struct crlf_filter));\n\tif (f == NULL)\n\t\treturn NULL;\n\n\tf->f.version = GIT_FILTER_VERSION;\n\tf->f.attributes = \"crlf eol text\";\n\tf->f.initialize = NULL;\n\tf->f.shutdown = git_filter_free;\n\tf->f.check    = crlf_check;\n\tf->f.apply    = crlf_apply;\n\tf->f.cleanup  = crlf_cleanup;\n\n\treturn (git_filter *)f;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "&filter_registry.filters",
            "2",
            "filter_def_priority_cmp"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_init",
          "args": [
            "&filter_registry.lock"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "183-191",
          "snippet": "int git_rwlock_init(git_rwlock *GIT_RESTRICT lock)\n{\n\tif (win32_srwlock_initialize)\n\t\twin32_srwlock_initialize(&lock->native.srwl);\n\telse\n\t\tInitializeCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_initialize;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_initialize;\n\nint git_rwlock_init(git_rwlock *GIT_RESTRICT lock)\n{\n\tif (win32_srwlock_initialize)\n\t\twin32_srwlock_initialize(&lock->native.srwl);\n\telse\n\t\tInitializeCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\nstatic void git_filter_global_shutdown(void);\n\nint git_filter_global_init(void)\n{\n\tgit_filter *crlf = NULL, *ident = NULL;\n\tint error = 0;\n\n\tif (git_rwlock_init(&filter_registry.lock) < 0)\n\t\treturn -1;\n\n\tif ((error = git_vector_init(&filter_registry.filters, 2,\n\t\tfilter_def_priority_cmp)) < 0)\n\t\tgoto done;\n\n\tif ((crlf = git_crlf_filter_new()) == NULL ||\n\t\tfilter_registry_insert(\n\t\t\tGIT_FILTER_CRLF, crlf, GIT_FILTER_CRLF_PRIORITY) < 0 ||\n\t\t(ident = git_ident_filter_new()) == NULL ||\n\t\tfilter_registry_insert(\n\t\t\tGIT_FILTER_IDENT, ident, GIT_FILTER_IDENT_PRIORITY) < 0)\n\t\terror = -1;\n\n\tgit__on_shutdown(git_filter_global_shutdown);\n\ndone:\n\tif (error) {\n\t\tgit_filter_free(crlf);\n\t\tgit_filter_free(ident);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "filter_registry_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "149-186",
    "snippet": "static int filter_registry_insert(\n\tconst char *name, git_filter *filter, int priority)\n{\n\tgit_filter_def *fdef;\n\tsize_t nattr = 0, nmatch = 0, alloc_len;\n\tgit_buf attrs = GIT_BUF_INIT;\n\n\tif (filter_def_scan_attrs(&attrs, &nattr, &nmatch, filter->attributes) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, nattr, 2);\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, alloc_len, sizeof(char *));\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, sizeof(git_filter_def));\n\n\tfdef = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(fdef);\n\n\tfdef->filter_name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(fdef->filter_name);\n\n\tfdef->filter      = filter;\n\tfdef->priority    = priority;\n\tfdef->nattrs      = nattr;\n\tfdef->nmatches    = nmatch;\n\tfdef->attrdata    = git_buf_detach(&attrs);\n\n\tfilter_def_set_attrs(fdef);\n\n\tif (git_vector_insert(&filter_registry.filters, fdef) < 0) {\n\t\tgit__free(fdef->filter_name);\n\t\tgit__free(fdef->attrdata);\n\t\tgit__free(fdef);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&filter_registry.filters);\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_filter_registry filter_registry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_sort",
          "args": [
            "&filter_registry.filters"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_sort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "175-185",
          "snippet": "void git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "fdef"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&filter_registry.filters",
            "fdef"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_def_set_attrs",
          "args": [
            "fdef"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "filter_def_set_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "103-133",
          "snippet": "static void filter_def_set_attrs(git_filter_def *fdef)\n{\n\tchar *scan = fdef->attrdata;\n\tsize_t i;\n\n\tfor (i = 0; i < fdef->nattrs; ++i) {\n\t\tconst char *name, *value;\n\n\t\tswitch (*scan) {\n\t\tcase '=':\n\t\t\tname = scan + 1;\n\t\t\tfor (scan++; *scan != '='; scan++) /* find '=' */;\n\t\t\t*scan++ = '\\0';\n\t\t\tvalue = scan;\n\t\t\tbreak;\n\t\tcase '-':\n\t\t\tname = scan + 1; value = git_attr__false; break;\n\t\tcase '+':\n\t\t\tname = scan + 1; value = git_attr__true;  break;\n\t\tcase '!':\n\t\t\tname = scan + 1; value = git_attr__unset; break;\n\t\tdefault:\n\t\t\tname = scan;     value = NULL; break;\n\t\t}\n\n\t\tfdef->attrs[i] = name;\n\t\tfdef->attrs[i + fdef->nattrs] = value;\n\n\t\tscan += strlen(scan) + 1;\n\t}\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic void filter_def_set_attrs(git_filter_def *fdef)\n{\n\tchar *scan = fdef->attrdata;\n\tsize_t i;\n\n\tfor (i = 0; i < fdef->nattrs; ++i) {\n\t\tconst char *name, *value;\n\n\t\tswitch (*scan) {\n\t\tcase '=':\n\t\t\tname = scan + 1;\n\t\t\tfor (scan++; *scan != '='; scan++) /* find '=' */;\n\t\t\t*scan++ = '\\0';\n\t\t\tvalue = scan;\n\t\t\tbreak;\n\t\tcase '-':\n\t\t\tname = scan + 1; value = git_attr__false; break;\n\t\tcase '+':\n\t\t\tname = scan + 1; value = git_attr__true;  break;\n\t\tcase '!':\n\t\t\tname = scan + 1; value = git_attr__unset; break;\n\t\tdefault:\n\t\t\tname = scan;     value = NULL; break;\n\t\t}\n\n\t\tfdef->attrs[i] = name;\n\t\tfdef->attrs[i + fdef->nattrs] = value;\n\n\t\tscan += strlen(scan) + 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&attrs"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "fdef->filter_name"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "name"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "fdef"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "alloc_len"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloc_len",
            "alloc_len",
            "sizeof(git_filter_def)"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_MULTIPLY",
          "args": [
            "&alloc_len",
            "alloc_len",
            "sizeof(char *)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_MULTIPLY",
          "args": [
            "&alloc_len",
            "nattr",
            "2"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter_def_scan_attrs",
          "args": [
            "&attrs",
            "&nattr",
            "&nmatch",
            "filter->attributes"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "filter_def_scan_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "69-101",
          "snippet": "static int filter_def_scan_attrs(\n\tgit_buf *attrs, size_t *nattr, size_t *nmatch, const char *attr_str)\n{\n\tconst char *start, *scan = attr_str;\n\tint has_eq;\n\n\t*nattr = *nmatch = 0;\n\n\tif (!scan)\n\t\treturn 0;\n\n\twhile (*scan) {\n\t\twhile (git__isspace(*scan)) scan++;\n\n\t\tfor (start = scan, has_eq = 0; *scan && !git__isspace(*scan); ++scan) {\n\t\t\tif (*scan == '=')\n\t\t\t\thas_eq = 1;\n\t\t}\n\n\t\tif (scan > start) {\n\t\t\t(*nattr)++;\n\t\t\tif (has_eq || *start == '-' || *start == '+' || *start == '!')\n\t\t\t\t(*nmatch)++;\n\n\t\t\tif (has_eq)\n\t\t\t\tgit_buf_putc(attrs, '=');\n\t\t\tgit_buf_put(attrs, start, scan - start);\n\t\t\tgit_buf_putc(attrs, '\\0');\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_def_scan_attrs(\n\tgit_buf *attrs, size_t *nattr, size_t *nmatch, const char *attr_str)\n{\n\tconst char *start, *scan = attr_str;\n\tint has_eq;\n\n\t*nattr = *nmatch = 0;\n\n\tif (!scan)\n\t\treturn 0;\n\n\twhile (*scan) {\n\t\twhile (git__isspace(*scan)) scan++;\n\n\t\tfor (start = scan, has_eq = 0; *scan && !git__isspace(*scan); ++scan) {\n\t\t\tif (*scan == '=')\n\t\t\t\thas_eq = 1;\n\t\t}\n\n\t\tif (scan > start) {\n\t\t\t(*nattr)++;\n\t\t\tif (has_eq || *start == '-' || *start == '+' || *start == '!')\n\t\t\t\t(*nmatch)++;\n\n\t\t\tif (has_eq)\n\t\t\t\tgit_buf_putc(attrs, '=');\n\t\t\tgit_buf_put(attrs, start, scan - start);\n\t\t\tgit_buf_putc(attrs, '\\0');\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\n\nstatic int filter_registry_insert(\n\tconst char *name, git_filter *filter, int priority)\n{\n\tgit_filter_def *fdef;\n\tsize_t nattr = 0, nmatch = 0, alloc_len;\n\tgit_buf attrs = GIT_BUF_INIT;\n\n\tif (filter_def_scan_attrs(&attrs, &nattr, &nmatch, filter->attributes) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, nattr, 2);\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloc_len, alloc_len, sizeof(char *));\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, sizeof(git_filter_def));\n\n\tfdef = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(fdef);\n\n\tfdef->filter_name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(fdef->filter_name);\n\n\tfdef->filter      = filter;\n\tfdef->priority    = priority;\n\tfdef->nattrs      = nattr;\n\tfdef->nmatches    = nmatch;\n\tfdef->attrdata    = git_buf_detach(&attrs);\n\n\tfilter_def_set_attrs(fdef);\n\n\tif (git_vector_insert(&filter_registry.filters, fdef) < 0) {\n\t\tgit__free(fdef->filter_name);\n\t\tgit__free(fdef->attrdata);\n\t\tgit__free(fdef);\n\t\treturn -1;\n\t}\n\n\tgit_vector_sort(&filter_registry.filters);\n\treturn 0;\n}"
  },
  {
    "function_name": "filter_def_filter_key_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "142-146",
    "snippet": "static int filter_def_filter_key_check(const void *key, const void *fdef)\n{\n\tconst void *filter = fdef ? ((const git_filter_def *)fdef)->filter : NULL;\n\treturn (key == filter) ? 0 : -1;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_def_filter_key_check(const void *key, const void *fdef)\n{\n\tconst void *filter = fdef ? ((const git_filter_def *)fdef)->filter : NULL;\n\treturn (key == filter) ? 0 : -1;\n}"
  },
  {
    "function_name": "filter_def_name_key_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "135-140",
    "snippet": "static int filter_def_name_key_check(const void *key, const void *fdef)\n{\n\tconst char *name =\n\t\tfdef ? ((const git_filter_def *)fdef)->filter_name : NULL;\n\treturn name ? git__strcmp(key, name) : -1;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__strcmp",
          "args": [
            "key",
            "name"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_def_name_key_check(const void *key, const void *fdef)\n{\n\tconst char *name =\n\t\tfdef ? ((const git_filter_def *)fdef)->filter_name : NULL;\n\treturn name ? git__strcmp(key, name) : -1;\n}"
  },
  {
    "function_name": "filter_def_set_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "103-133",
    "snippet": "static void filter_def_set_attrs(git_filter_def *fdef)\n{\n\tchar *scan = fdef->attrdata;\n\tsize_t i;\n\n\tfor (i = 0; i < fdef->nattrs; ++i) {\n\t\tconst char *name, *value;\n\n\t\tswitch (*scan) {\n\t\tcase '=':\n\t\t\tname = scan + 1;\n\t\t\tfor (scan++; *scan != '='; scan++) /* find '=' */;\n\t\t\t*scan++ = '\\0';\n\t\t\tvalue = scan;\n\t\t\tbreak;\n\t\tcase '-':\n\t\t\tname = scan + 1; value = git_attr__false; break;\n\t\tcase '+':\n\t\t\tname = scan + 1; value = git_attr__true;  break;\n\t\tcase '!':\n\t\t\tname = scan + 1; value = git_attr__unset; break;\n\t\tdefault:\n\t\t\tname = scan;     value = NULL; break;\n\t\t}\n\n\t\tfdef->attrs[i] = name;\n\t\tfdef->attrs[i + fdef->nattrs] = value;\n\n\t\tscan += strlen(scan) + 1;\n\t}\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "scan"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic void filter_def_set_attrs(git_filter_def *fdef)\n{\n\tchar *scan = fdef->attrdata;\n\tsize_t i;\n\n\tfor (i = 0; i < fdef->nattrs; ++i) {\n\t\tconst char *name, *value;\n\n\t\tswitch (*scan) {\n\t\tcase '=':\n\t\t\tname = scan + 1;\n\t\t\tfor (scan++; *scan != '='; scan++) /* find '=' */;\n\t\t\t*scan++ = '\\0';\n\t\t\tvalue = scan;\n\t\t\tbreak;\n\t\tcase '-':\n\t\t\tname = scan + 1; value = git_attr__false; break;\n\t\tcase '+':\n\t\t\tname = scan + 1; value = git_attr__true;  break;\n\t\tcase '!':\n\t\t\tname = scan + 1; value = git_attr__unset; break;\n\t\tdefault:\n\t\t\tname = scan;     value = NULL; break;\n\t\t}\n\n\t\tfdef->attrs[i] = name;\n\t\tfdef->attrs[i + fdef->nattrs] = value;\n\n\t\tscan += strlen(scan) + 1;\n\t}\n}"
  },
  {
    "function_name": "filter_def_scan_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "69-101",
    "snippet": "static int filter_def_scan_attrs(\n\tgit_buf *attrs, size_t *nattr, size_t *nmatch, const char *attr_str)\n{\n\tconst char *start, *scan = attr_str;\n\tint has_eq;\n\n\t*nattr = *nmatch = 0;\n\n\tif (!scan)\n\t\treturn 0;\n\n\twhile (*scan) {\n\t\twhile (git__isspace(*scan)) scan++;\n\n\t\tfor (start = scan, has_eq = 0; *scan && !git__isspace(*scan); ++scan) {\n\t\t\tif (*scan == '=')\n\t\t\t\thas_eq = 1;\n\t\t}\n\n\t\tif (scan > start) {\n\t\t\t(*nattr)++;\n\t\t\tif (has_eq || *start == '-' || *start == '+' || *start == '!')\n\t\t\t\t(*nmatch)++;\n\n\t\t\tif (has_eq)\n\t\t\t\tgit_buf_putc(attrs, '=');\n\t\t\tgit_buf_put(attrs, start, scan - start);\n\t\t\tgit_buf_putc(attrs, '\\0');\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "attrs",
            "'\\0'"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "attrs",
            "start",
            "scan - start"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__isspace",
          "args": [
            "*scan"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "git__isspace_nonlf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "459-462",
          "snippet": "GIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_def_scan_attrs(\n\tgit_buf *attrs, size_t *nattr, size_t *nmatch, const char *attr_str)\n{\n\tconst char *start, *scan = attr_str;\n\tint has_eq;\n\n\t*nattr = *nmatch = 0;\n\n\tif (!scan)\n\t\treturn 0;\n\n\twhile (*scan) {\n\t\twhile (git__isspace(*scan)) scan++;\n\n\t\tfor (start = scan, has_eq = 0; *scan && !git__isspace(*scan); ++scan) {\n\t\t\tif (*scan == '=')\n\t\t\t\thas_eq = 1;\n\t\t}\n\n\t\tif (scan > start) {\n\t\t\t(*nattr)++;\n\t\t\tif (has_eq || *start == '-' || *start == '+' || *start == '!')\n\t\t\t\t(*nmatch)++;\n\n\t\t\tif (has_eq)\n\t\t\t\tgit_buf_putc(attrs, '=');\n\t\t\tgit_buf_put(attrs, start, scan - start);\n\t\t\tgit_buf_putc(attrs, '\\0');\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "filter_def_priority_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
    "lines": "52-57",
    "snippet": "static int filter_def_priority_cmp(const void *a, const void *b)\n{\n\tint pa = ((const git_filter_def *)a)->priority;\n\tint pb = ((const git_filter_def *)b)->priority;\n\treturn (pa < pb) ? -1 : (pa > pb) ? 1 : 0;\n}",
    "includes": [
      "#include \"array.h\"",
      "#include \"attr_file.h\"",
      "#include \"blob.h\"",
      "#include \"git2/config.h\"",
      "#include \"git2/sys/filter.h\"",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"filter.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic int filter_def_priority_cmp(const void *a, const void *b)\n{\n\tint pa = ((const git_filter_def *)a)->priority;\n\tint pb = ((const git_filter_def *)b)->priority;\n\treturn (pa < pb) ? -1 : (pa > pb) ? 1 : 0;\n}"
  }
]