[
  {
    "function_name": "git_diff_find_context_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "516-522",
    "snippet": "void git_diff_find_context_clear(git_diff_find_context_payload *payload)\n{\n\tif (payload) {\n\t\tgit_buf_free(&payload->line);\n\t\tpayload->driver = NULL;\n\t}\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&payload->line"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_find_context_clear(git_diff_find_context_payload *payload)\n{\n\tif (payload) {\n\t\tgit_buf_free(&payload->line);\n\t\tpayload->driver = NULL;\n\t}\n}"
  },
  {
    "function_name": "git_diff_find_context_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "500-514",
    "snippet": "void git_diff_find_context_init(\n\tgit_diff_find_context_fn *findfn_out,\n\tgit_diff_find_context_payload *payload_out,\n\tgit_diff_driver *driver)\n{\n\t*findfn_out = driver ? diff_context_find : NULL;\n\n\tmemset(payload_out, 0, sizeof(*payload_out));\n\tif (driver) {\n\t\tpayload_out->driver = driver;\n\t\tpayload_out->match_line = (driver->type == DIFF_DRIVER_PATTERNLIST) ?\n\t\t\tdiff_context_line__pattern_match : diff_context_line__simple;\n\t\tgit_buf_init(&payload_out->line, 0);\n\t}\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_init",
          "args": [
            "&payload_out->line",
            "0"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "25-33",
          "snippet": "void git_buf_init(git_buf *buf, size_t initial_size)\n{\n\tbuf->asize = 0;\n\tbuf->size = 0;\n\tbuf->ptr = git_buf__initbuf;\n\n\tif (initial_size)\n\t\tgit_buf_grow(buf, initial_size);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_init(git_buf *buf, size_t initial_size)\n{\n\tbuf->asize = 0;\n\tbuf->size = 0;\n\tbuf->ptr = git_buf__initbuf;\n\n\tif (initial_size)\n\t\tgit_buf_grow(buf, initial_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "payload_out",
            "0",
            "sizeof(*payload_out)"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_find_context_init(\n\tgit_diff_find_context_fn *findfn_out,\n\tgit_diff_find_context_payload *payload_out,\n\tgit_diff_driver *driver)\n{\n\t*findfn_out = driver ? diff_context_find : NULL;\n\n\tmemset(payload_out, 0, sizeof(*payload_out));\n\tif (driver) {\n\t\tpayload_out->driver = driver;\n\t\tpayload_out->match_line = (driver->type == DIFF_DRIVER_PATTERNLIST) ?\n\t\t\tdiff_context_line__pattern_match : diff_context_line__simple;\n\t\tgit_buf_init(&payload_out->line, 0);\n\t}\n}"
  },
  {
    "function_name": "diff_context_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "474-498",
    "snippet": "static long diff_context_find(\n\tconst char *line,\n\tlong line_len,\n\tchar *out,\n\tlong out_size,\n\tvoid *payload)\n{\n\tgit_diff_find_context_payload *ctxt = payload;\n\n\tif (git_buf_set(&ctxt->line, line, (size_t)line_len) < 0)\n\t\treturn -1;\n\tgit_buf_rtrim(&ctxt->line);\n\n\tif (!ctxt->line.size)\n\t\treturn -1;\n\n\tif (!ctxt->match_line || !ctxt->match_line(ctxt->driver, &ctxt->line))\n\t\treturn -1;\n\n\tif (out_size > (long)ctxt->line.size)\n\t\tout_size = (long)ctxt->line.size;\n\tmemcpy(out, ctxt->line.ptr, (size_t)out_size);\n\n\treturn out_size;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out",
            "ctxt->line.ptr",
            "(size_t)out_size"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctxt->match_line",
          "args": [
            "ctxt->driver",
            "&ctxt->line"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_rtrim",
          "args": [
            "&ctxt->line"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_rtrim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "718-729",
          "snippet": "void git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_set",
          "args": [
            "&ctxt->line",
            "line",
            "(size_t)line_len"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "150-169",
          "snippet": "int git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic long diff_context_find(\n\tconst char *line,\n\tlong line_len,\n\tchar *out,\n\tlong out_size,\n\tvoid *payload)\n{\n\tgit_diff_find_context_payload *ctxt = payload;\n\n\tif (git_buf_set(&ctxt->line, line, (size_t)line_len) < 0)\n\t\treturn -1;\n\tgit_buf_rtrim(&ctxt->line);\n\n\tif (!ctxt->line.size)\n\t\treturn -1;\n\n\tif (!ctxt->match_line || !ctxt->match_line(ctxt->driver, &ctxt->line))\n\t\treturn -1;\n\n\tif (out_size > (long)ctxt->line.size)\n\t\tout_size = (long)ctxt->line.size;\n\tmemcpy(out, ctxt->line.ptr, (size_t)out_size);\n\n\treturn out_size;\n}"
  },
  {
    "function_name": "diff_context_line__pattern_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "448-472",
    "snippet": "static int diff_context_line__pattern_match(\n\tgit_diff_driver *driver, git_buf *line)\n{\n\tsize_t i, maxi = git_array_size(driver->fn_patterns);\n\tregmatch_t pmatch[2];\n\n\tfor (i = 0; i < maxi; ++i) {\n\t\tgit_diff_driver_pattern *pat = git_array_get(driver->fn_patterns, i);\n\n\t\tif (!regexec(&pat->re, line->ptr, 2, pmatch, 0)) {\n\t\t\tif (pat->flags & REG_NEGATE)\n\t\t\t\treturn false;\n\n\t\t\t/* use pmatch data to trim line data */\n\t\t\ti = (pmatch[1].rm_so >= 0) ? 1 : 0;\n\t\t\tgit_buf_consume(line, git_buf_cstr(line) + pmatch[i].rm_so);\n\t\t\tgit_buf_truncate(line, pmatch[i].rm_eo - pmatch[i].rm_so);\n\t\t\tgit_buf_rtrim(line);\n\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_rtrim",
          "args": [
            "line"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_rtrim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "718-729",
          "snippet": "void git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_truncate",
          "args": [
            "line",
            "pmatch[i].rm_eo - pmatch[i].rm_so"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "446-454",
          "snippet": "void git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_consume",
          "args": [
            "line",
            "git_buf_cstr(line) + pmatch[i].rm_so"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_consume",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "436-444",
          "snippet": "void git_buf_consume(git_buf *buf, const char *end)\n{\n\tif (end > buf->ptr && end <= buf->ptr + buf->size) {\n\t\tsize_t consumed = end - buf->ptr;\n\t\tmemmove(buf->ptr, end, buf->size - consumed);\n\t\tbuf->size -= consumed;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_consume(git_buf *buf, const char *end)\n{\n\tif (end > buf->ptr && end <= buf->ptr + buf->size) {\n\t\tsize_t consumed = end - buf->ptr;\n\t\tmemmove(buf->ptr, end, buf->size - consumed);\n\t\tbuf->size -= consumed;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "line"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "regexec",
          "args": [
            "&pat->re",
            "line->ptr",
            "2",
            "pmatch",
            "0"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "driver->fn_patterns",
            "i"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "driver->fn_patterns"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_context_line__pattern_match(\n\tgit_diff_driver *driver, git_buf *line)\n{\n\tsize_t i, maxi = git_array_size(driver->fn_patterns);\n\tregmatch_t pmatch[2];\n\n\tfor (i = 0; i < maxi; ++i) {\n\t\tgit_diff_driver_pattern *pat = git_array_get(driver->fn_patterns, i);\n\n\t\tif (!regexec(&pat->re, line->ptr, 2, pmatch, 0)) {\n\t\t\tif (pat->flags & REG_NEGATE)\n\t\t\t\treturn false;\n\n\t\t\t/* use pmatch data to trim line data */\n\t\t\ti = (pmatch[1].rm_so >= 0) ? 1 : 0;\n\t\t\tgit_buf_consume(line, git_buf_cstr(line) + pmatch[i].rm_so);\n\t\t\tgit_buf_truncate(line, pmatch[i].rm_eo - pmatch[i].rm_so);\n\t\t\tgit_buf_rtrim(line);\n\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "diff_context_line__simple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "440-446",
    "snippet": "static int diff_context_line__simple(\n\tgit_diff_driver *driver, git_buf *line)\n{\n\tchar firstch = line->ptr[0];\n\tGIT_UNUSED(driver);\n\treturn (git__isalpha(firstch) || firstch == '_' || firstch == '$');\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__isalpha",
          "args": [
            "firstch"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "git__isalpha",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "444-447",
          "snippet": "GIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "driver"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_context_line__simple(\n\tgit_diff_driver *driver, git_buf *line)\n{\n\tchar firstch = line->ptr[0];\n\tGIT_UNUSED(driver);\n\treturn (git__isalpha(firstch) || firstch == '_' || firstch == '$');\n}"
  },
  {
    "function_name": "git_diff_driver_content_is_binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "418-438",
    "snippet": "int git_diff_driver_content_is_binary(\n\tgit_diff_driver *driver, const char *content, size_t content_len)\n{\n\tgit_buf search = GIT_BUF_INIT;\n\n\tGIT_UNUSED(driver);\n\n\tgit_buf_attach_notowned(&search, content,\n\t\tmin(content_len, GIT_FILTER_BYTES_TO_CHECK_NUL));\n\n\t/* TODO: provide encoding / binary detection callbacks that can\n\t * be UTF-8 aware, etc.  For now, instead of trying to be smart,\n\t * let's just use the simple NUL-byte detection that core git uses.\n\t */\n\n\t/* previously was: if (git_buf_text_is_binary(&search)) */\n\tif (git_buf_text_contains_nul(&search))\n\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_text_contains_nul",
          "args": [
            "&search"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_text_contains_nul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buf_text.c",
          "lines": "213-216",
          "snippet": "bool git_buf_text_contains_nul(const git_buf *buf)\n{\n\treturn (memchr(buf->ptr, '\\0', buf->size) != NULL);\n}",
          "includes": [
            "#include \"buf_text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n\nbool git_buf_text_contains_nul(const git_buf *buf)\n{\n\treturn (memchr(buf->ptr, '\\0', buf->size) != NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_attach_notowned",
          "args": [
            "&search",
            "content",
            "min(content_len, GIT_FILTER_BYTES_TO_CHECK_NUL)"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_attach_notowned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "505-517",
          "snippet": "void git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "content_len",
            "GIT_FILTER_BYTES_TO_CHECK_NUL"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "homing_search_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "130-143",
          "snippet": "static int homing_search_cmp(const void *key, const void *array_member)\n{\n\tconst struct tree_key_search *ksearch = key;\n\tconst git_tree_entry *entry = array_member;\n\n\tconst uint16_t len1 = ksearch->filename_len;\n\tconst uint16_t len2 = entry->filename_len;\n\n\treturn memcmp(\n\t\tksearch->filename,\n\t\tentry->filename,\n\t\tlen1 < len2 ? len1 : len2\n\t);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int homing_search_cmp(const void *key, const void *array_member)\n{\n\tconst struct tree_key_search *ksearch = key;\n\tconst git_tree_entry *entry = array_member;\n\n\tconst uint16_t len1 = ksearch->filename_len;\n\tconst uint16_t len2 = entry->filename_len;\n\n\treturn memcmp(\n\t\tksearch->filename,\n\t\tentry->filename,\n\t\tlen1 < len2 ? len1 : len2\n\t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "driver"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nint git_diff_driver_content_is_binary(\n\tgit_diff_driver *driver, const char *content, size_t content_len)\n{\n\tgit_buf search = GIT_BUF_INIT;\n\n\tGIT_UNUSED(driver);\n\n\tgit_buf_attach_notowned(&search, content,\n\t\tmin(content_len, GIT_FILTER_BYTES_TO_CHECK_NUL));\n\n\t/* TODO: provide encoding / binary detection callbacks that can\n\t * be UTF-8 aware, etc.  For now, instead of trying to be smart,\n\t * let's just use the simple NUL-byte detection that core git uses.\n\t */\n\n\t/* previously was: if (git_buf_text_is_binary(&search)) */\n\tif (git_buf_text_contains_nul(&search))\n\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_diff_driver_update_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "409-416",
    "snippet": "void git_diff_driver_update_options(\n\tuint32_t *option_flags, git_diff_driver *driver)\n{\n\tif ((*option_flags & FORCE_DIFFABLE) == 0)\n\t\t*option_flags |= driver->binary_flags;\n\n\t*option_flags |= driver->other_flags;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define FORCE_DIFFABLE (GIT_DIFF_FORCE_TEXT | GIT_DIFF_FORCE_BINARY)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\n#define FORCE_DIFFABLE (GIT_DIFF_FORCE_TEXT | GIT_DIFF_FORCE_BINARY)\n\nvoid git_diff_driver_update_options(\n\tuint32_t *option_flags, git_diff_driver *driver)\n{\n\tif ((*option_flags & FORCE_DIFFABLE) == 0)\n\t\t*option_flags |= driver->binary_flags;\n\n\t*option_flags |= driver->other_flags;\n}"
  },
  {
    "function_name": "git_diff_driver_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "393-407",
    "snippet": "void git_diff_driver_free(git_diff_driver *driver)\n{\n\tsize_t i;\n\n\tif (!driver)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(driver->fn_patterns); ++i)\n\t\tregfree(& git_array_get(driver->fn_patterns, i)->re);\n\tgit_array_clear(driver->fn_patterns);\n\n\tregfree(&driver->word_pattern);\n\n\tgit__free(driver);\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "driver"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "regfree",
          "args": [
            "&driver->word_pattern"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "driver->fn_patterns"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "regfree",
          "args": [
            "& git_array_get(driver->fn_patterns, i)->re"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "driver->fn_patterns",
            "i"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "driver->fn_patterns"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_driver_free(git_diff_driver *driver)\n{\n\tsize_t i;\n\n\tif (!driver)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(driver->fn_patterns); ++i)\n\t\tregfree(& git_array_get(driver->fn_patterns, i)->re);\n\tgit_array_clear(driver->fn_patterns);\n\n\tregfree(&driver->word_pattern);\n\n\tgit__free(driver);\n}"
  },
  {
    "function_name": "git_diff_driver_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "359-391",
    "snippet": "int git_diff_driver_lookup(\n\tgit_diff_driver **out, git_repository *repo, const char *path)\n{\n\tint error = 0;\n\tconst char *value;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif (!repo || !path || !strlen(path))\n\t\t/* just use the auto value */;\n\telse if ((error = git_attr_get(&value, repo, 0, path, \"diff\")) < 0)\n\t\t/* return error below */;\n\telse if (GIT_ATTR_UNSPECIFIED(value))\n\t\t/* just use the auto value */;\n\telse if (GIT_ATTR_FALSE(value))\n\t\t*out = &global_drivers[DIFF_DRIVER_BINARY];\n\telse if (GIT_ATTR_TRUE(value))\n\t\t*out = &global_drivers[DIFF_DRIVER_TEXT];\n\n\t/* otherwise look for driver information in config and build driver */\n\telse if ((error = git_diff_driver_load(out, repo, value)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\terror = 0;\n\t\t\tgiterr_clear();\n\t\t}\n\t}\n\n\tif (!*out)\n\t\t*out = &global_drivers[DIFF_DRIVER_AUTO];\n\n\treturn error;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "enum {\n\tDIFF_DRIVER_AUTO = 0,\n\tDIFF_DRIVER_BINARY = 1,\n\tDIFF_DRIVER_TEXT = 2,\n\tDIFF_DRIVER_PATTERNLIST = 3,\n} git_diff_driver_t;",
      "static git_diff_driver global_drivers[3] = {\n\t{ DIFF_DRIVER_AUTO,   0, 0, },\n\t{ DIFF_DRIVER_BINARY, GIT_DIFF_FORCE_BINARY, 0 },\n\t{ DIFF_DRIVER_TEXT,   GIT_DIFF_FORCE_TEXT, 0 },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_driver_load",
          "args": [
            "out",
            "repo",
            "value"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_driver_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "234-357",
          "snippet": "static int git_diff_driver_load(\n\tgit_diff_driver **out, git_repository *repo, const char *driver_name)\n{\n\tint error = 0;\n\tgit_diff_driver_registry *reg;\n\tgit_diff_driver *drv = NULL;\n\tsize_t namelen;\n\tkhiter_t pos;\n\tgit_config *cfg = NULL;\n\tgit_buf name = GIT_BUF_INIT;\n\tgit_config_entry *ce = NULL;\n\tbool found_driver = false;\n\n\tif ((reg = git_repository_driver_registry(repo)) == NULL)\n\t\treturn -1;\n\n\tpos = git_strmap_lookup_index(reg->drivers, driver_name);\n\tif (git_strmap_valid_index(reg->drivers, pos)) {\n\t\t*out = git_strmap_value_at(reg->drivers, pos);\n\t\treturn 0;\n\t}\n\n\tif ((error = diff_driver_alloc(&drv, &namelen, driver_name)) < 0)\n\t\tgoto done;\n\n\tdrv->type = DIFF_DRIVER_AUTO;\n\n\t/* if you can't read config for repo, just use default driver */\n\tif (git_repository_config_snapshot(&cfg, repo) < 0) {\n\t\tgiterr_clear();\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_printf(&name, \"diff.%s.binary\", driver_name)) < 0)\n\t\tgoto done;\n\n\tswitch (git_config__get_bool_force(cfg, name.ptr, -1)) {\n\tcase true:\n\t\t/* if diff.<driver>.binary is true, just return the binary driver */\n\t\t*out = &global_drivers[DIFF_DRIVER_BINARY];\n\t\tgoto done;\n\tcase false:\n\t\t/* if diff.<driver>.binary is false, force binary checks off */\n\t\t/* but still may have custom function context patterns, etc. */\n\t\tdrv->binary_flags = GIT_DIFF_FORCE_TEXT;\n\t\tfound_driver = true;\n\t\tbreak;\n\tdefault:\n\t\t/* diff.<driver>.binary unspecified or \"auto\", so just continue */\n\t\tbreak;\n\t}\n\n\t/* TODO: warn if diff.<name>.command or diff.<name>.textconv are set */\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"xfuncname\", strlen(\"xfuncname\"));\n\tif ((error = git_config_get_multivar_foreach(\n\t\t\tcfg, name.ptr, NULL, diff_driver_xfuncname, drv)) < 0) {\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\t\tgiterr_clear(); /* no diff.<driver>.xfuncname, so just continue */\n\t}\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"funcname\", strlen(\"funcname\"));\n\tif ((error = git_config_get_multivar_foreach(\n\t\t\tcfg, name.ptr, NULL, diff_driver_funcname, drv)) < 0) {\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\t\tgiterr_clear(); /* no diff.<driver>.funcname, so just continue */\n\t}\n\n\t/* if we found any patterns, set driver type to use correct callback */\n\tif (git_array_size(drv->fn_patterns) > 0) {\n\t\tdrv->type = DIFF_DRIVER_PATTERNLIST;\n\t\tfound_driver = true;\n\t}\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"wordregex\", strlen(\"wordregex\"));\n\tif ((error = git_config__lookup_entry(&ce, cfg, name.ptr, false)) < 0)\n\t\tgoto done;\n\tif (!ce || !ce->value)\n\t\t/* no diff.<driver>.wordregex, so just continue */;\n\telse if (!(error = regcomp(&drv->word_pattern, ce->value, REG_EXTENDED)))\n\t\tfound_driver = true;\n\telse {\n\t\t/* TODO: warn about bad regex instead of failure */\n\t\terror = giterr_set_regex(&drv->word_pattern, error);\n\t\tgoto done;\n\t}\n\n\t/* TODO: look up diff.<driver>.algorithm to turn on minimal / patience\n\t * diff in drv->other_flags\n\t */\n\n\t/* if no driver config found at all, fall back on AUTO driver */\n\tif (!found_driver)\n\t\tgoto done;\n\n\t/* store driver in registry */\n\tgit_strmap_insert(reg->drivers, drv->name, drv, error);\n\tif (error < 0)\n\t\tgoto done;\n\terror = 0;\n\n\t*out = drv;\n\ndone:\n\tgit_config_entry_free(ce);\n\tgit_buf_free(&name);\n\tgit_config_free(cfg);\n\n\tif (!*out) {\n\t\tint error2 = git_diff_driver_builtin(out, reg, driver_name);\n\t\tif (!error)\n\t\t\terror = error2;\n\t}\n\n\tif (drv && drv != *out)\n\t\tgit_diff_driver_free(drv);\n\n\treturn error;\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "enum {\n\tDIFF_DRIVER_AUTO = 0,\n\tDIFF_DRIVER_BINARY = 1,\n\tDIFF_DRIVER_TEXT = 2,\n\tDIFF_DRIVER_PATTERNLIST = 3,\n} git_diff_driver_t;",
            "static git_diff_driver global_drivers[3] = {\n\t{ DIFF_DRIVER_AUTO,   0, 0, },\n\t{ DIFF_DRIVER_BINARY, GIT_DIFF_FORCE_BINARY, 0 },\n\t{ DIFF_DRIVER_TEXT,   GIT_DIFF_FORCE_TEXT, 0 },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nenum {\n\tDIFF_DRIVER_AUTO = 0,\n\tDIFF_DRIVER_BINARY = 1,\n\tDIFF_DRIVER_TEXT = 2,\n\tDIFF_DRIVER_PATTERNLIST = 3,\n} git_diff_driver_t;\nstatic git_diff_driver global_drivers[3] = {\n\t{ DIFF_DRIVER_AUTO,   0, 0, },\n\t{ DIFF_DRIVER_BINARY, GIT_DIFF_FORCE_BINARY, 0 },\n\t{ DIFF_DRIVER_TEXT,   GIT_DIFF_FORCE_TEXT, 0 },\n};\n\nstatic int git_diff_driver_load(\n\tgit_diff_driver **out, git_repository *repo, const char *driver_name)\n{\n\tint error = 0;\n\tgit_diff_driver_registry *reg;\n\tgit_diff_driver *drv = NULL;\n\tsize_t namelen;\n\tkhiter_t pos;\n\tgit_config *cfg = NULL;\n\tgit_buf name = GIT_BUF_INIT;\n\tgit_config_entry *ce = NULL;\n\tbool found_driver = false;\n\n\tif ((reg = git_repository_driver_registry(repo)) == NULL)\n\t\treturn -1;\n\n\tpos = git_strmap_lookup_index(reg->drivers, driver_name);\n\tif (git_strmap_valid_index(reg->drivers, pos)) {\n\t\t*out = git_strmap_value_at(reg->drivers, pos);\n\t\treturn 0;\n\t}\n\n\tif ((error = diff_driver_alloc(&drv, &namelen, driver_name)) < 0)\n\t\tgoto done;\n\n\tdrv->type = DIFF_DRIVER_AUTO;\n\n\t/* if you can't read config for repo, just use default driver */\n\tif (git_repository_config_snapshot(&cfg, repo) < 0) {\n\t\tgiterr_clear();\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_printf(&name, \"diff.%s.binary\", driver_name)) < 0)\n\t\tgoto done;\n\n\tswitch (git_config__get_bool_force(cfg, name.ptr, -1)) {\n\tcase true:\n\t\t/* if diff.<driver>.binary is true, just return the binary driver */\n\t\t*out = &global_drivers[DIFF_DRIVER_BINARY];\n\t\tgoto done;\n\tcase false:\n\t\t/* if diff.<driver>.binary is false, force binary checks off */\n\t\t/* but still may have custom function context patterns, etc. */\n\t\tdrv->binary_flags = GIT_DIFF_FORCE_TEXT;\n\t\tfound_driver = true;\n\t\tbreak;\n\tdefault:\n\t\t/* diff.<driver>.binary unspecified or \"auto\", so just continue */\n\t\tbreak;\n\t}\n\n\t/* TODO: warn if diff.<name>.command or diff.<name>.textconv are set */\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"xfuncname\", strlen(\"xfuncname\"));\n\tif ((error = git_config_get_multivar_foreach(\n\t\t\tcfg, name.ptr, NULL, diff_driver_xfuncname, drv)) < 0) {\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\t\tgiterr_clear(); /* no diff.<driver>.xfuncname, so just continue */\n\t}\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"funcname\", strlen(\"funcname\"));\n\tif ((error = git_config_get_multivar_foreach(\n\t\t\tcfg, name.ptr, NULL, diff_driver_funcname, drv)) < 0) {\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\t\tgiterr_clear(); /* no diff.<driver>.funcname, so just continue */\n\t}\n\n\t/* if we found any patterns, set driver type to use correct callback */\n\tif (git_array_size(drv->fn_patterns) > 0) {\n\t\tdrv->type = DIFF_DRIVER_PATTERNLIST;\n\t\tfound_driver = true;\n\t}\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"wordregex\", strlen(\"wordregex\"));\n\tif ((error = git_config__lookup_entry(&ce, cfg, name.ptr, false)) < 0)\n\t\tgoto done;\n\tif (!ce || !ce->value)\n\t\t/* no diff.<driver>.wordregex, so just continue */;\n\telse if (!(error = regcomp(&drv->word_pattern, ce->value, REG_EXTENDED)))\n\t\tfound_driver = true;\n\telse {\n\t\t/* TODO: warn about bad regex instead of failure */\n\t\terror = giterr_set_regex(&drv->word_pattern, error);\n\t\tgoto done;\n\t}\n\n\t/* TODO: look up diff.<driver>.algorithm to turn on minimal / patience\n\t * diff in drv->other_flags\n\t */\n\n\t/* if no driver config found at all, fall back on AUTO driver */\n\tif (!found_driver)\n\t\tgoto done;\n\n\t/* store driver in registry */\n\tgit_strmap_insert(reg->drivers, drv->name, drv, error);\n\tif (error < 0)\n\t\tgoto done;\n\terror = 0;\n\n\t*out = drv;\n\ndone:\n\tgit_config_entry_free(ce);\n\tgit_buf_free(&name);\n\tgit_config_free(cfg);\n\n\tif (!*out) {\n\t\tint error2 = git_diff_driver_builtin(out, reg, driver_name);\n\t\tif (!error)\n\t\t\terror = error2;\n\t}\n\n\tif (drv && drv != *out)\n\t\tgit_diff_driver_free(drv);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_ATTR_TRUE",
          "args": [
            "value"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_ATTR_FALSE",
          "args": [
            "value"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_ATTR_UNSPECIFIED",
          "args": [
            "value"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_attr_get",
          "args": [
            "&value",
            "repo",
            "0",
            "path",
            "\"diff\""
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr.c",
          "lines": "39-86",
          "snippet": "int git_attr_get(\n\tconst char **value,\n\tgit_repository *repo,\n\tuint32_t flags,\n\tconst char *pathname,\n\tconst char *name)\n{\n\tint error;\n\tgit_attr_path path;\n\tgit_vector files = GIT_VECTOR_INIT;\n\tsize_t i, j;\n\tgit_attr_file *file;\n\tgit_attr_name attr;\n\tgit_attr_rule *rule;\n\n\tassert(value && repo && name);\n\n\t*value = NULL;\n\n\tif (git_attr_path__init(&path, pathname, git_repository_workdir(repo), GIT_DIR_FLAG_UNKNOWN) < 0)\n\t\treturn -1;\n\n\tif ((error = collect_attr_files(repo, NULL, flags, pathname, &files)) < 0)\n\t\tgoto cleanup;\n\n\tmemset(&attr, 0, sizeof(attr));\n\tattr.name = name;\n\tattr.name_hash = git_attr_file__name_hash(name);\n\n\tgit_vector_foreach(&files, i, file) {\n\n\t\tgit_attr_file__foreach_matching_rule(file, &path, j, rule) {\n\t\t\tsize_t pos;\n\n\t\t\tif (!git_vector_bsearch(&pos, &rule->assigns, &attr)) {\n\t\t\t\t*value = ((git_attr_assignment *)git_vector_get(\n\t\t\t\t\t\t\t  &rule->assigns, pos))->value;\n\t\t\t\tgoto cleanup;\n\t\t\t}\n\t\t}\n\t}\n\ncleanup:\n\trelease_attr_files(&files);\n\tgit_attr_path__free(&path);\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"git2/oid.h\"",
            "#include \"ignore.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int collect_attr_files(\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tuint32_t flags,\n\tconst char *path,\n\tgit_vector *files);",
            "static void release_attr_files(git_vector *files);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"git2/oid.h\"\n#include \"ignore.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int collect_attr_files(\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tuint32_t flags,\n\tconst char *path,\n\tgit_vector *files);\nstatic void release_attr_files(git_vector *files);\n\nint git_attr_get(\n\tconst char **value,\n\tgit_repository *repo,\n\tuint32_t flags,\n\tconst char *pathname,\n\tconst char *name)\n{\n\tint error;\n\tgit_attr_path path;\n\tgit_vector files = GIT_VECTOR_INIT;\n\tsize_t i, j;\n\tgit_attr_file *file;\n\tgit_attr_name attr;\n\tgit_attr_rule *rule;\n\n\tassert(value && repo && name);\n\n\t*value = NULL;\n\n\tif (git_attr_path__init(&path, pathname, git_repository_workdir(repo), GIT_DIR_FLAG_UNKNOWN) < 0)\n\t\treturn -1;\n\n\tif ((error = collect_attr_files(repo, NULL, flags, pathname, &files)) < 0)\n\t\tgoto cleanup;\n\n\tmemset(&attr, 0, sizeof(attr));\n\tattr.name = name;\n\tattr.name_hash = git_attr_file__name_hash(name);\n\n\tgit_vector_foreach(&files, i, file) {\n\n\t\tgit_attr_file__foreach_matching_rule(file, &path, j, rule) {\n\t\t\tsize_t pos;\n\n\t\t\tif (!git_vector_bsearch(&pos, &rule->assigns, &attr)) {\n\t\t\t\t*value = ((git_attr_assignment *)git_vector_get(\n\t\t\t\t\t\t\t  &rule->assigns, pos))->value;\n\t\t\t\tgoto cleanup;\n\t\t\t}\n\t\t}\n\t}\n\ncleanup:\n\trelease_attr_files(&files);\n\tgit_attr_path__free(&path);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "path"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nenum {\n\tDIFF_DRIVER_AUTO = 0,\n\tDIFF_DRIVER_BINARY = 1,\n\tDIFF_DRIVER_TEXT = 2,\n\tDIFF_DRIVER_PATTERNLIST = 3,\n} git_diff_driver_t;\nstatic git_diff_driver global_drivers[3] = {\n\t{ DIFF_DRIVER_AUTO,   0, 0, },\n\t{ DIFF_DRIVER_BINARY, GIT_DIFF_FORCE_BINARY, 0 },\n\t{ DIFF_DRIVER_TEXT,   GIT_DIFF_FORCE_TEXT, 0 },\n};\n\nint git_diff_driver_lookup(\n\tgit_diff_driver **out, git_repository *repo, const char *path)\n{\n\tint error = 0;\n\tconst char *value;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif (!repo || !path || !strlen(path))\n\t\t/* just use the auto value */;\n\telse if ((error = git_attr_get(&value, repo, 0, path, \"diff\")) < 0)\n\t\t/* return error below */;\n\telse if (GIT_ATTR_UNSPECIFIED(value))\n\t\t/* just use the auto value */;\n\telse if (GIT_ATTR_FALSE(value))\n\t\t*out = &global_drivers[DIFF_DRIVER_BINARY];\n\telse if (GIT_ATTR_TRUE(value))\n\t\t*out = &global_drivers[DIFF_DRIVER_TEXT];\n\n\t/* otherwise look for driver information in config and build driver */\n\telse if ((error = git_diff_driver_load(out, repo, value)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\terror = 0;\n\t\t\tgiterr_clear();\n\t\t}\n\t}\n\n\tif (!*out)\n\t\t*out = &global_drivers[DIFF_DRIVER_AUTO];\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_diff_driver_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "234-357",
    "snippet": "static int git_diff_driver_load(\n\tgit_diff_driver **out, git_repository *repo, const char *driver_name)\n{\n\tint error = 0;\n\tgit_diff_driver_registry *reg;\n\tgit_diff_driver *drv = NULL;\n\tsize_t namelen;\n\tkhiter_t pos;\n\tgit_config *cfg = NULL;\n\tgit_buf name = GIT_BUF_INIT;\n\tgit_config_entry *ce = NULL;\n\tbool found_driver = false;\n\n\tif ((reg = git_repository_driver_registry(repo)) == NULL)\n\t\treturn -1;\n\n\tpos = git_strmap_lookup_index(reg->drivers, driver_name);\n\tif (git_strmap_valid_index(reg->drivers, pos)) {\n\t\t*out = git_strmap_value_at(reg->drivers, pos);\n\t\treturn 0;\n\t}\n\n\tif ((error = diff_driver_alloc(&drv, &namelen, driver_name)) < 0)\n\t\tgoto done;\n\n\tdrv->type = DIFF_DRIVER_AUTO;\n\n\t/* if you can't read config for repo, just use default driver */\n\tif (git_repository_config_snapshot(&cfg, repo) < 0) {\n\t\tgiterr_clear();\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_printf(&name, \"diff.%s.binary\", driver_name)) < 0)\n\t\tgoto done;\n\n\tswitch (git_config__get_bool_force(cfg, name.ptr, -1)) {\n\tcase true:\n\t\t/* if diff.<driver>.binary is true, just return the binary driver */\n\t\t*out = &global_drivers[DIFF_DRIVER_BINARY];\n\t\tgoto done;\n\tcase false:\n\t\t/* if diff.<driver>.binary is false, force binary checks off */\n\t\t/* but still may have custom function context patterns, etc. */\n\t\tdrv->binary_flags = GIT_DIFF_FORCE_TEXT;\n\t\tfound_driver = true;\n\t\tbreak;\n\tdefault:\n\t\t/* diff.<driver>.binary unspecified or \"auto\", so just continue */\n\t\tbreak;\n\t}\n\n\t/* TODO: warn if diff.<name>.command or diff.<name>.textconv are set */\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"xfuncname\", strlen(\"xfuncname\"));\n\tif ((error = git_config_get_multivar_foreach(\n\t\t\tcfg, name.ptr, NULL, diff_driver_xfuncname, drv)) < 0) {\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\t\tgiterr_clear(); /* no diff.<driver>.xfuncname, so just continue */\n\t}\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"funcname\", strlen(\"funcname\"));\n\tif ((error = git_config_get_multivar_foreach(\n\t\t\tcfg, name.ptr, NULL, diff_driver_funcname, drv)) < 0) {\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\t\tgiterr_clear(); /* no diff.<driver>.funcname, so just continue */\n\t}\n\n\t/* if we found any patterns, set driver type to use correct callback */\n\tif (git_array_size(drv->fn_patterns) > 0) {\n\t\tdrv->type = DIFF_DRIVER_PATTERNLIST;\n\t\tfound_driver = true;\n\t}\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"wordregex\", strlen(\"wordregex\"));\n\tif ((error = git_config__lookup_entry(&ce, cfg, name.ptr, false)) < 0)\n\t\tgoto done;\n\tif (!ce || !ce->value)\n\t\t/* no diff.<driver>.wordregex, so just continue */;\n\telse if (!(error = regcomp(&drv->word_pattern, ce->value, REG_EXTENDED)))\n\t\tfound_driver = true;\n\telse {\n\t\t/* TODO: warn about bad regex instead of failure */\n\t\terror = giterr_set_regex(&drv->word_pattern, error);\n\t\tgoto done;\n\t}\n\n\t/* TODO: look up diff.<driver>.algorithm to turn on minimal / patience\n\t * diff in drv->other_flags\n\t */\n\n\t/* if no driver config found at all, fall back on AUTO driver */\n\tif (!found_driver)\n\t\tgoto done;\n\n\t/* store driver in registry */\n\tgit_strmap_insert(reg->drivers, drv->name, drv, error);\n\tif (error < 0)\n\t\tgoto done;\n\terror = 0;\n\n\t*out = drv;\n\ndone:\n\tgit_config_entry_free(ce);\n\tgit_buf_free(&name);\n\tgit_config_free(cfg);\n\n\tif (!*out) {\n\t\tint error2 = git_diff_driver_builtin(out, reg, driver_name);\n\t\tif (!error)\n\t\t\terror = error2;\n\t}\n\n\tif (drv && drv != *out)\n\t\tgit_diff_driver_free(drv);\n\n\treturn error;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "enum {\n\tDIFF_DRIVER_AUTO = 0,\n\tDIFF_DRIVER_BINARY = 1,\n\tDIFF_DRIVER_TEXT = 2,\n\tDIFF_DRIVER_PATTERNLIST = 3,\n} git_diff_driver_t;",
      "static git_diff_driver global_drivers[3] = {\n\t{ DIFF_DRIVER_AUTO,   0, 0, },\n\t{ DIFF_DRIVER_BINARY, GIT_DIFF_FORCE_BINARY, 0 },\n\t{ DIFF_DRIVER_TEXT,   GIT_DIFF_FORCE_TEXT, 0 },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_diff_driver_free",
          "args": [
            "drv"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_driver_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "393-407",
          "snippet": "void git_diff_driver_free(git_diff_driver *driver)\n{\n\tsize_t i;\n\n\tif (!driver)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(driver->fn_patterns); ++i)\n\t\tregfree(& git_array_get(driver->fn_patterns, i)->re);\n\tgit_array_clear(driver->fn_patterns);\n\n\tregfree(&driver->word_pattern);\n\n\tgit__free(driver);\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_driver_free(git_diff_driver *driver)\n{\n\tsize_t i;\n\n\tif (!driver)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(driver->fn_patterns); ++i)\n\t\tregfree(& git_array_get(driver->fn_patterns, i)->re);\n\tgit_array_clear(driver->fn_patterns);\n\n\tregfree(&driver->word_pattern);\n\n\tgit__free(driver);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_driver_builtin",
          "args": [
            "out",
            "reg",
            "driver_name"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_driver_builtin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "184-232",
          "snippet": "static int git_diff_driver_builtin(\n\tgit_diff_driver **out,\n\tgit_diff_driver_registry *reg,\n\tconst char *driver_name)\n{\n\tint error = 0;\n\tgit_diff_driver_definition *ddef = NULL;\n\tgit_diff_driver *drv = NULL;\n\tsize_t idx;\n\n\tfor (idx = 0; idx < ARRAY_SIZE(builtin_defs); ++idx) {\n\t\tif (!strcasecmp(driver_name, builtin_defs[idx].name)) {\n\t\t\tddef = &builtin_defs[idx];\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (!ddef)\n\t\tgoto done;\n\n\tif ((error = diff_driver_alloc(&drv, NULL, ddef->name)) < 0)\n\t\tgoto done;\n\n\tdrv->type = DIFF_DRIVER_PATTERNLIST;\n\n\tif (ddef->fns &&\n\t\t(error = diff_driver_add_patterns(\n\t\t\tdrv, ddef->fns, ddef->flags | REG_EXTENDED)) < 0)\n\t\tgoto done;\n\n\tif (ddef->words &&\n\t\t(error = regcomp(\n\t\t\t&drv->word_pattern, ddef->words, ddef->flags | REG_EXTENDED)))\n\t{\n\t\terror = giterr_set_regex(&drv->word_pattern, error);\n\t\tgoto done;\n\t}\n\n\tgit_strmap_insert(reg->drivers, drv->name, drv, error);\n\tif (error > 0)\n\t\terror = 0;\n\ndone:\n\tif (error && drv)\n\t\tgit_diff_driver_free(drv);\n\telse\n\t\t*out = drv;\n\n\treturn error;\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int git_diff_driver_builtin(\n\tgit_diff_driver **out,\n\tgit_diff_driver_registry *reg,\n\tconst char *driver_name)\n{\n\tint error = 0;\n\tgit_diff_driver_definition *ddef = NULL;\n\tgit_diff_driver *drv = NULL;\n\tsize_t idx;\n\n\tfor (idx = 0; idx < ARRAY_SIZE(builtin_defs); ++idx) {\n\t\tif (!strcasecmp(driver_name, builtin_defs[idx].name)) {\n\t\t\tddef = &builtin_defs[idx];\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (!ddef)\n\t\tgoto done;\n\n\tif ((error = diff_driver_alloc(&drv, NULL, ddef->name)) < 0)\n\t\tgoto done;\n\n\tdrv->type = DIFF_DRIVER_PATTERNLIST;\n\n\tif (ddef->fns &&\n\t\t(error = diff_driver_add_patterns(\n\t\t\tdrv, ddef->fns, ddef->flags | REG_EXTENDED)) < 0)\n\t\tgoto done;\n\n\tif (ddef->words &&\n\t\t(error = regcomp(\n\t\t\t&drv->word_pattern, ddef->words, ddef->flags | REG_EXTENDED)))\n\t{\n\t\terror = giterr_set_regex(&drv->word_pattern, error);\n\t\tgoto done;\n\t}\n\n\tgit_strmap_insert(reg->drivers, drv->name, drv, error);\n\tif (error > 0)\n\t\terror = 0;\n\ndone:\n\tif (error && drv)\n\t\tgit_diff_driver_free(drv);\n\telse\n\t\t*out = drv;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "cfg"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&name"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "ce"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_insert",
          "args": [
            "reg->drivers",
            "drv->name",
            "drv",
            "error"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set_regex",
          "args": [
            "&drv->word_pattern",
            "error"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_regex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "106-119",
          "snippet": "int giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "regcomp",
          "args": [
            "&drv->word_pattern",
            "ce->value",
            "REG_EXTENDED"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_config__lookup_entry",
          "args": [
            "&ce",
            "cfg",
            "name.ptr",
            "false"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__lookup_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "737-745",
          "snippet": "int git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "&name",
            "\"wordregex\"",
            "strlen(\"wordregex\")"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"wordregex\""
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_truncate",
          "args": [
            "&name",
            "namelen + strlen(\"diff..\")"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "446-454",
          "snippet": "void git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"diff..\""
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "drv->fn_patterns"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_get_multivar_foreach",
          "args": [
            "cfg",
            "name.ptr",
            "NULL",
            "diff_driver_funcname",
            "drv"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_get_multivar_foreach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "920-949",
          "snippet": "int git_config_get_multivar_foreach(\n\tconst git_config *cfg, const char *name, const char *regexp,\n\tgit_config_foreach_cb cb, void *payload)\n{\n\tint err, found;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((err = git_config_multivar_iterator_new(&iter, cfg, name, regexp)) < 0)\n\t\treturn err;\n\n\tfound = 0;\n\twhile ((err = iter->next(&entry, iter)) == 0) {\n\t\tfound = 1;\n\n\t\tif ((err = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(err);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\titer->free(iter);\n\tif (err == GIT_ITEROVER)\n\t\terr = 0;\n\n\tif (found == 0 && err == 0)\n\t\terr = config_error_notfound(name);\n\n\treturn err;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_multivar_foreach(\n\tconst git_config *cfg, const char *name, const char *regexp,\n\tgit_config_foreach_cb cb, void *payload)\n{\n\tint err, found;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((err = git_config_multivar_iterator_new(&iter, cfg, name, regexp)) < 0)\n\t\treturn err;\n\n\tfound = 0;\n\twhile ((err = iter->next(&entry, iter)) == 0) {\n\t\tfound = 1;\n\n\t\tif ((err = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(err);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\titer->free(iter);\n\tif (err == GIT_ITEROVER)\n\t\terr = 0;\n\n\tif (found == 0 && err == 0)\n\t\terr = config_error_notfound(name);\n\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"funcname\""
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"diff..\""
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"xfuncname\""
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"diff..\""
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_config__get_bool_force",
          "args": [
            "cfg",
            "name.ptr",
            "-1"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__get_bool_force",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "890-903",
          "snippet": "int git_config__get_bool_force(\n\tconst git_config *cfg, const char *key, int fallback_value)\n{\n\tint val = fallback_value;\n\tgit_config_entry *entry;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\n\tif (entry && git_config_parse_bool(&val, entry->value) < 0)\n\t\tgiterr_clear();\n\n\tgit_config_entry_free(entry);\n\treturn val;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__get_bool_force(\n\tconst git_config *cfg, const char *key, int fallback_value)\n{\n\tint val = fallback_value;\n\tgit_config_entry *entry;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\n\tif (entry && git_config_parse_bool(&val, entry->value) < 0)\n\t\tgiterr_clear();\n\n\tgit_config_entry_free(entry);\n\treturn val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "&name",
            "\"diff.%s.binary\"",
            "driver_name"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config_snapshot",
          "args": [
            "&cfg",
            "repo"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config_snapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "716-725",
          "snippet": "int git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_driver_alloc",
          "args": [
            "&drv",
            "&namelen",
            "driver_name"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "diff_driver_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "160-182",
          "snippet": "static int diff_driver_alloc(\n\tgit_diff_driver **out, size_t *namelen_out, const char *name)\n{\n\tgit_diff_driver *driver;\n\tsize_t driverlen = sizeof(git_diff_driver),\n\t\tnamelen = strlen(name),\n\t\talloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, driverlen, namelen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tdriver = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(driver);\n\n\tmemcpy(driver->name, name, namelen);\n\n\t*out = driver;\n\n\tif (namelen_out)\n\t\t*namelen_out = namelen;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_driver_alloc(\n\tgit_diff_driver **out, size_t *namelen_out, const char *name)\n{\n\tgit_diff_driver *driver;\n\tsize_t driverlen = sizeof(git_diff_driver),\n\t\tnamelen = strlen(name),\n\t\talloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, driverlen, namelen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tdriver = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(driver);\n\n\tmemcpy(driver->name, name, namelen);\n\n\t*out = driver;\n\n\tif (namelen_out)\n\t\t*namelen_out = namelen;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_value_at",
          "args": [
            "reg->drivers",
            "pos"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_valid_index",
          "args": [
            "reg->drivers",
            "pos"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_lookup_index",
          "args": [
            "reg->drivers",
            "driver_name"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_driver_registry",
          "args": [
            "repo"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_driver_registry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "143-158",
          "snippet": "static git_diff_driver_registry *git_repository_driver_registry(\n\tgit_repository *repo)\n{\n\tif (!repo->diff_drivers) {\n\t\tgit_diff_driver_registry *reg = git_diff_driver_registry_new();\n\t\treg = git__compare_and_swap(&repo->diff_drivers, NULL, reg);\n\n\t\tif (reg != NULL) /* if we race, free losing allocation */\n\t\t\tgit_diff_driver_registry_free(reg);\n\t}\n\n\tif (!repo->diff_drivers)\n\t\tgiterr_set(GITERR_REPOSITORY, \"Unable to create diff driver registry\");\n\n\treturn repo->diff_drivers;\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic git_diff_driver_registry *git_repository_driver_registry(\n\tgit_repository *repo)\n{\n\tif (!repo->diff_drivers) {\n\t\tgit_diff_driver_registry *reg = git_diff_driver_registry_new();\n\t\treg = git__compare_and_swap(&repo->diff_drivers, NULL, reg);\n\n\t\tif (reg != NULL) /* if we race, free losing allocation */\n\t\t\tgit_diff_driver_registry_free(reg);\n\t}\n\n\tif (!repo->diff_drivers)\n\t\tgiterr_set(GITERR_REPOSITORY, \"Unable to create diff driver registry\");\n\n\treturn repo->diff_drivers;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nenum {\n\tDIFF_DRIVER_AUTO = 0,\n\tDIFF_DRIVER_BINARY = 1,\n\tDIFF_DRIVER_TEXT = 2,\n\tDIFF_DRIVER_PATTERNLIST = 3,\n} git_diff_driver_t;\nstatic git_diff_driver global_drivers[3] = {\n\t{ DIFF_DRIVER_AUTO,   0, 0, },\n\t{ DIFF_DRIVER_BINARY, GIT_DIFF_FORCE_BINARY, 0 },\n\t{ DIFF_DRIVER_TEXT,   GIT_DIFF_FORCE_TEXT, 0 },\n};\n\nstatic int git_diff_driver_load(\n\tgit_diff_driver **out, git_repository *repo, const char *driver_name)\n{\n\tint error = 0;\n\tgit_diff_driver_registry *reg;\n\tgit_diff_driver *drv = NULL;\n\tsize_t namelen;\n\tkhiter_t pos;\n\tgit_config *cfg = NULL;\n\tgit_buf name = GIT_BUF_INIT;\n\tgit_config_entry *ce = NULL;\n\tbool found_driver = false;\n\n\tif ((reg = git_repository_driver_registry(repo)) == NULL)\n\t\treturn -1;\n\n\tpos = git_strmap_lookup_index(reg->drivers, driver_name);\n\tif (git_strmap_valid_index(reg->drivers, pos)) {\n\t\t*out = git_strmap_value_at(reg->drivers, pos);\n\t\treturn 0;\n\t}\n\n\tif ((error = diff_driver_alloc(&drv, &namelen, driver_name)) < 0)\n\t\tgoto done;\n\n\tdrv->type = DIFF_DRIVER_AUTO;\n\n\t/* if you can't read config for repo, just use default driver */\n\tif (git_repository_config_snapshot(&cfg, repo) < 0) {\n\t\tgiterr_clear();\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_printf(&name, \"diff.%s.binary\", driver_name)) < 0)\n\t\tgoto done;\n\n\tswitch (git_config__get_bool_force(cfg, name.ptr, -1)) {\n\tcase true:\n\t\t/* if diff.<driver>.binary is true, just return the binary driver */\n\t\t*out = &global_drivers[DIFF_DRIVER_BINARY];\n\t\tgoto done;\n\tcase false:\n\t\t/* if diff.<driver>.binary is false, force binary checks off */\n\t\t/* but still may have custom function context patterns, etc. */\n\t\tdrv->binary_flags = GIT_DIFF_FORCE_TEXT;\n\t\tfound_driver = true;\n\t\tbreak;\n\tdefault:\n\t\t/* diff.<driver>.binary unspecified or \"auto\", so just continue */\n\t\tbreak;\n\t}\n\n\t/* TODO: warn if diff.<name>.command or diff.<name>.textconv are set */\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"xfuncname\", strlen(\"xfuncname\"));\n\tif ((error = git_config_get_multivar_foreach(\n\t\t\tcfg, name.ptr, NULL, diff_driver_xfuncname, drv)) < 0) {\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\t\tgiterr_clear(); /* no diff.<driver>.xfuncname, so just continue */\n\t}\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"funcname\", strlen(\"funcname\"));\n\tif ((error = git_config_get_multivar_foreach(\n\t\t\tcfg, name.ptr, NULL, diff_driver_funcname, drv)) < 0) {\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\t\tgiterr_clear(); /* no diff.<driver>.funcname, so just continue */\n\t}\n\n\t/* if we found any patterns, set driver type to use correct callback */\n\tif (git_array_size(drv->fn_patterns) > 0) {\n\t\tdrv->type = DIFF_DRIVER_PATTERNLIST;\n\t\tfound_driver = true;\n\t}\n\n\tgit_buf_truncate(&name, namelen + strlen(\"diff..\"));\n\tgit_buf_put(&name, \"wordregex\", strlen(\"wordregex\"));\n\tif ((error = git_config__lookup_entry(&ce, cfg, name.ptr, false)) < 0)\n\t\tgoto done;\n\tif (!ce || !ce->value)\n\t\t/* no diff.<driver>.wordregex, so just continue */;\n\telse if (!(error = regcomp(&drv->word_pattern, ce->value, REG_EXTENDED)))\n\t\tfound_driver = true;\n\telse {\n\t\t/* TODO: warn about bad regex instead of failure */\n\t\terror = giterr_set_regex(&drv->word_pattern, error);\n\t\tgoto done;\n\t}\n\n\t/* TODO: look up diff.<driver>.algorithm to turn on minimal / patience\n\t * diff in drv->other_flags\n\t */\n\n\t/* if no driver config found at all, fall back on AUTO driver */\n\tif (!found_driver)\n\t\tgoto done;\n\n\t/* store driver in registry */\n\tgit_strmap_insert(reg->drivers, drv->name, drv, error);\n\tif (error < 0)\n\t\tgoto done;\n\terror = 0;\n\n\t*out = drv;\n\ndone:\n\tgit_config_entry_free(ce);\n\tgit_buf_free(&name);\n\tgit_config_free(cfg);\n\n\tif (!*out) {\n\t\tint error2 = git_diff_driver_builtin(out, reg, driver_name);\n\t\tif (!error)\n\t\t\terror = error2;\n\t}\n\n\tif (drv && drv != *out)\n\t\tgit_diff_driver_free(drv);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_diff_driver_builtin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "184-232",
    "snippet": "static int git_diff_driver_builtin(\n\tgit_diff_driver **out,\n\tgit_diff_driver_registry *reg,\n\tconst char *driver_name)\n{\n\tint error = 0;\n\tgit_diff_driver_definition *ddef = NULL;\n\tgit_diff_driver *drv = NULL;\n\tsize_t idx;\n\n\tfor (idx = 0; idx < ARRAY_SIZE(builtin_defs); ++idx) {\n\t\tif (!strcasecmp(driver_name, builtin_defs[idx].name)) {\n\t\t\tddef = &builtin_defs[idx];\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (!ddef)\n\t\tgoto done;\n\n\tif ((error = diff_driver_alloc(&drv, NULL, ddef->name)) < 0)\n\t\tgoto done;\n\n\tdrv->type = DIFF_DRIVER_PATTERNLIST;\n\n\tif (ddef->fns &&\n\t\t(error = diff_driver_add_patterns(\n\t\t\tdrv, ddef->fns, ddef->flags | REG_EXTENDED)) < 0)\n\t\tgoto done;\n\n\tif (ddef->words &&\n\t\t(error = regcomp(\n\t\t\t&drv->word_pattern, ddef->words, ddef->flags | REG_EXTENDED)))\n\t{\n\t\terror = giterr_set_regex(&drv->word_pattern, error);\n\t\tgoto done;\n\t}\n\n\tgit_strmap_insert(reg->drivers, drv->name, drv, error);\n\tif (error > 0)\n\t\terror = 0;\n\ndone:\n\tif (error && drv)\n\t\tgit_diff_driver_free(drv);\n\telse\n\t\t*out = drv;\n\n\treturn error;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_diff_driver_free",
          "args": [
            "drv"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_driver_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "393-407",
          "snippet": "void git_diff_driver_free(git_diff_driver *driver)\n{\n\tsize_t i;\n\n\tif (!driver)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(driver->fn_patterns); ++i)\n\t\tregfree(& git_array_get(driver->fn_patterns, i)->re);\n\tgit_array_clear(driver->fn_patterns);\n\n\tregfree(&driver->word_pattern);\n\n\tgit__free(driver);\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_driver_free(git_diff_driver *driver)\n{\n\tsize_t i;\n\n\tif (!driver)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(driver->fn_patterns); ++i)\n\t\tregfree(& git_array_get(driver->fn_patterns, i)->re);\n\tgit_array_clear(driver->fn_patterns);\n\n\tregfree(&driver->word_pattern);\n\n\tgit__free(driver);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_insert",
          "args": [
            "reg->drivers",
            "drv->name",
            "drv",
            "error"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set_regex",
          "args": [
            "&drv->word_pattern",
            "error"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_regex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "106-119",
          "snippet": "int giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "regcomp",
          "args": [
            "&drv->word_pattern",
            "ddef->words",
            "ddef->flags | REG_EXTENDED"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diff_driver_add_patterns",
          "args": [
            "drv",
            "ddef->fns",
            "ddef->flags | REG_EXTENDED"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "diff_driver_add_patterns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "89-131",
          "snippet": "static int diff_driver_add_patterns(\n\tgit_diff_driver *drv, const char *regex_str, int regex_flags)\n{\n\tint error = 0;\n\tconst char *scan, *end;\n\tgit_diff_driver_pattern *pat = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tfor (scan = regex_str; scan; scan = end) {\n\t\t/* get pattern to fill in */\n\t\tif ((pat = git_array_alloc(drv->fn_patterns)) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tpat->flags = regex_flags;\n\t\tif (*scan == '!') {\n\t\t\tpat->flags |= REG_NEGATE;\n\t\t\t++scan;\n\t\t}\n\n\t\tif ((end = strchr(scan, '\\n')) != NULL) {\n\t\t\terror = git_buf_set(&buf, scan, end - scan);\n\t\t\tend++;\n\t\t} else {\n\t\t\terror = git_buf_sets(&buf, scan);\n\t\t}\n\t\tif (error < 0)\n\t\t\tbreak;\n\n\t\tif ((error = regcomp(&pat->re, buf.ptr, regex_flags)) != 0) {\n\t\t\t/*\n\t\t\t * TODO: issue a warning\n\t\t\t */\n\t\t}\n\t}\n\n\tif (error && pat != NULL)\n\t\t(void)git_array_pop(drv->fn_patterns); /* release last item */\n\tgit_buf_free(&buf);\n\n\t/* We want to ignore bad patterns, so return success regardless */\n\treturn 0;\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_driver_add_patterns(\n\tgit_diff_driver *drv, const char *regex_str, int regex_flags)\n{\n\tint error = 0;\n\tconst char *scan, *end;\n\tgit_diff_driver_pattern *pat = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tfor (scan = regex_str; scan; scan = end) {\n\t\t/* get pattern to fill in */\n\t\tif ((pat = git_array_alloc(drv->fn_patterns)) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tpat->flags = regex_flags;\n\t\tif (*scan == '!') {\n\t\t\tpat->flags |= REG_NEGATE;\n\t\t\t++scan;\n\t\t}\n\n\t\tif ((end = strchr(scan, '\\n')) != NULL) {\n\t\t\terror = git_buf_set(&buf, scan, end - scan);\n\t\t\tend++;\n\t\t} else {\n\t\t\terror = git_buf_sets(&buf, scan);\n\t\t}\n\t\tif (error < 0)\n\t\t\tbreak;\n\n\t\tif ((error = regcomp(&pat->re, buf.ptr, regex_flags)) != 0) {\n\t\t\t/*\n\t\t\t * TODO: issue a warning\n\t\t\t */\n\t\t}\n\t}\n\n\tif (error && pat != NULL)\n\t\t(void)git_array_pop(drv->fn_patterns); /* release last item */\n\tgit_buf_free(&buf);\n\n\t/* We want to ignore bad patterns, so return success regardless */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_driver_alloc",
          "args": [
            "&drv",
            "NULL",
            "ddef->name"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "diff_driver_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "160-182",
          "snippet": "static int diff_driver_alloc(\n\tgit_diff_driver **out, size_t *namelen_out, const char *name)\n{\n\tgit_diff_driver *driver;\n\tsize_t driverlen = sizeof(git_diff_driver),\n\t\tnamelen = strlen(name),\n\t\talloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, driverlen, namelen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tdriver = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(driver);\n\n\tmemcpy(driver->name, name, namelen);\n\n\t*out = driver;\n\n\tif (namelen_out)\n\t\t*namelen_out = namelen;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_driver_alloc(\n\tgit_diff_driver **out, size_t *namelen_out, const char *name)\n{\n\tgit_diff_driver *driver;\n\tsize_t driverlen = sizeof(git_diff_driver),\n\t\tnamelen = strlen(name),\n\t\talloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, driverlen, namelen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tdriver = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(driver);\n\n\tmemcpy(driver->name, name, namelen);\n\n\t*out = driver;\n\n\tif (namelen_out)\n\t\t*namelen_out = namelen;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "driver_name",
            "builtin_defs[idx].name"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcasecmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "567-570",
          "snippet": "int git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "builtin_defs"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int git_diff_driver_builtin(\n\tgit_diff_driver **out,\n\tgit_diff_driver_registry *reg,\n\tconst char *driver_name)\n{\n\tint error = 0;\n\tgit_diff_driver_definition *ddef = NULL;\n\tgit_diff_driver *drv = NULL;\n\tsize_t idx;\n\n\tfor (idx = 0; idx < ARRAY_SIZE(builtin_defs); ++idx) {\n\t\tif (!strcasecmp(driver_name, builtin_defs[idx].name)) {\n\t\t\tddef = &builtin_defs[idx];\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (!ddef)\n\t\tgoto done;\n\n\tif ((error = diff_driver_alloc(&drv, NULL, ddef->name)) < 0)\n\t\tgoto done;\n\n\tdrv->type = DIFF_DRIVER_PATTERNLIST;\n\n\tif (ddef->fns &&\n\t\t(error = diff_driver_add_patterns(\n\t\t\tdrv, ddef->fns, ddef->flags | REG_EXTENDED)) < 0)\n\t\tgoto done;\n\n\tif (ddef->words &&\n\t\t(error = regcomp(\n\t\t\t&drv->word_pattern, ddef->words, ddef->flags | REG_EXTENDED)))\n\t{\n\t\terror = giterr_set_regex(&drv->word_pattern, error);\n\t\tgoto done;\n\t}\n\n\tgit_strmap_insert(reg->drivers, drv->name, drv, error);\n\tif (error > 0)\n\t\terror = 0;\n\ndone:\n\tif (error && drv)\n\t\tgit_diff_driver_free(drv);\n\telse\n\t\t*out = drv;\n\n\treturn error;\n}"
  },
  {
    "function_name": "diff_driver_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "160-182",
    "snippet": "static int diff_driver_alloc(\n\tgit_diff_driver **out, size_t *namelen_out, const char *name)\n{\n\tgit_diff_driver *driver;\n\tsize_t driverlen = sizeof(git_diff_driver),\n\t\tnamelen = strlen(name),\n\t\talloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, driverlen, namelen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tdriver = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(driver);\n\n\tmemcpy(driver->name, name, namelen);\n\n\t*out = driver;\n\n\tif (namelen_out)\n\t\t*namelen_out = namelen;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "driver->name",
            "name",
            "namelen"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "driver"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "alloclen"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloclen",
            "alloclen",
            "1"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloclen",
            "driverlen",
            "namelen"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_driver_alloc(\n\tgit_diff_driver **out, size_t *namelen_out, const char *name)\n{\n\tgit_diff_driver *driver;\n\tsize_t driverlen = sizeof(git_diff_driver),\n\t\tnamelen = strlen(name),\n\t\talloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, driverlen, namelen);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tdriver = git__calloc(1, alloclen);\n\tGITERR_CHECK_ALLOC(driver);\n\n\tmemcpy(driver->name, name, namelen);\n\n\t*out = driver;\n\n\tif (namelen_out)\n\t\t*namelen_out = namelen;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_driver_registry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "143-158",
    "snippet": "static git_diff_driver_registry *git_repository_driver_registry(\n\tgit_repository *repo)\n{\n\tif (!repo->diff_drivers) {\n\t\tgit_diff_driver_registry *reg = git_diff_driver_registry_new();\n\t\treg = git__compare_and_swap(&repo->diff_drivers, NULL, reg);\n\n\t\tif (reg != NULL) /* if we race, free losing allocation */\n\t\t\tgit_diff_driver_registry_free(reg);\n\t}\n\n\tif (!repo->diff_drivers)\n\t\tgiterr_set(GITERR_REPOSITORY, \"Unable to create diff driver registry\");\n\n\treturn repo->diff_drivers;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"Unable to create diff driver registry\""
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_driver_registry_free",
          "args": [
            "reg"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_driver_registry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "77-87",
          "snippet": "void git_diff_driver_registry_free(git_diff_driver_registry *reg)\n{\n\tgit_diff_driver *drv;\n\n\tif (!reg)\n\t\treturn;\n\n\tgit_strmap_foreach_value(reg->drivers, drv, git_diff_driver_free(drv));\n\tgit_strmap_free(reg->drivers);\n\tgit__free(reg);\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_driver_registry_free(git_diff_driver_registry *reg)\n{\n\tgit_diff_driver *drv;\n\n\tif (!reg)\n\t\treturn;\n\n\tgit_strmap_foreach_value(reg->drivers, drv, git_diff_driver_free(drv));\n\tgit_strmap_free(reg->drivers);\n\tgit__free(reg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__compare_and_swap",
          "args": [
            "&repo->diff_drivers",
            "NULL",
            "reg"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_diff_driver_registry_new",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_driver_registry_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "62-75",
          "snippet": "git_diff_driver_registry *git_diff_driver_registry_new()\n{\n\tgit_diff_driver_registry *reg =\n\t\tgit__calloc(1, sizeof(git_diff_driver_registry));\n\tif (!reg)\n\t\treturn NULL;\n\n\tif (git_strmap_alloc(&reg->drivers) < 0) {\n\t\tgit_diff_driver_registry_free(reg);\n\t\treturn NULL;\n\t}\n\n\treturn reg;\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\ngit_diff_driver_registry *git_diff_driver_registry_new()\n{\n\tgit_diff_driver_registry *reg =\n\t\tgit__calloc(1, sizeof(git_diff_driver_registry));\n\tif (!reg)\n\t\treturn NULL;\n\n\tif (git_strmap_alloc(&reg->drivers) < 0) {\n\t\tgit_diff_driver_registry_free(reg);\n\t\treturn NULL;\n\t}\n\n\treturn reg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic git_diff_driver_registry *git_repository_driver_registry(\n\tgit_repository *repo)\n{\n\tif (!repo->diff_drivers) {\n\t\tgit_diff_driver_registry *reg = git_diff_driver_registry_new();\n\t\treg = git__compare_and_swap(&repo->diff_drivers, NULL, reg);\n\n\t\tif (reg != NULL) /* if we race, free losing allocation */\n\t\t\tgit_diff_driver_registry_free(reg);\n\t}\n\n\tif (!repo->diff_drivers)\n\t\tgiterr_set(GITERR_REPOSITORY, \"Unable to create diff driver registry\");\n\n\treturn repo->diff_drivers;\n}"
  },
  {
    "function_name": "diff_driver_funcname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "138-141",
    "snippet": "static int diff_driver_funcname(const git_config_entry *entry, void *payload)\n{\n\treturn diff_driver_add_patterns(payload, entry->value, 0);\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_driver_add_patterns",
          "args": [
            "payload",
            "entry->value",
            "0"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "diff_driver_add_patterns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "89-131",
          "snippet": "static int diff_driver_add_patterns(\n\tgit_diff_driver *drv, const char *regex_str, int regex_flags)\n{\n\tint error = 0;\n\tconst char *scan, *end;\n\tgit_diff_driver_pattern *pat = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tfor (scan = regex_str; scan; scan = end) {\n\t\t/* get pattern to fill in */\n\t\tif ((pat = git_array_alloc(drv->fn_patterns)) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tpat->flags = regex_flags;\n\t\tif (*scan == '!') {\n\t\t\tpat->flags |= REG_NEGATE;\n\t\t\t++scan;\n\t\t}\n\n\t\tif ((end = strchr(scan, '\\n')) != NULL) {\n\t\t\terror = git_buf_set(&buf, scan, end - scan);\n\t\t\tend++;\n\t\t} else {\n\t\t\terror = git_buf_sets(&buf, scan);\n\t\t}\n\t\tif (error < 0)\n\t\t\tbreak;\n\n\t\tif ((error = regcomp(&pat->re, buf.ptr, regex_flags)) != 0) {\n\t\t\t/*\n\t\t\t * TODO: issue a warning\n\t\t\t */\n\t\t}\n\t}\n\n\tif (error && pat != NULL)\n\t\t(void)git_array_pop(drv->fn_patterns); /* release last item */\n\tgit_buf_free(&buf);\n\n\t/* We want to ignore bad patterns, so return success regardless */\n\treturn 0;\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_driver_add_patterns(\n\tgit_diff_driver *drv, const char *regex_str, int regex_flags)\n{\n\tint error = 0;\n\tconst char *scan, *end;\n\tgit_diff_driver_pattern *pat = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tfor (scan = regex_str; scan; scan = end) {\n\t\t/* get pattern to fill in */\n\t\tif ((pat = git_array_alloc(drv->fn_patterns)) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tpat->flags = regex_flags;\n\t\tif (*scan == '!') {\n\t\t\tpat->flags |= REG_NEGATE;\n\t\t\t++scan;\n\t\t}\n\n\t\tif ((end = strchr(scan, '\\n')) != NULL) {\n\t\t\terror = git_buf_set(&buf, scan, end - scan);\n\t\t\tend++;\n\t\t} else {\n\t\t\terror = git_buf_sets(&buf, scan);\n\t\t}\n\t\tif (error < 0)\n\t\t\tbreak;\n\n\t\tif ((error = regcomp(&pat->re, buf.ptr, regex_flags)) != 0) {\n\t\t\t/*\n\t\t\t * TODO: issue a warning\n\t\t\t */\n\t\t}\n\t}\n\n\tif (error && pat != NULL)\n\t\t(void)git_array_pop(drv->fn_patterns); /* release last item */\n\tgit_buf_free(&buf);\n\n\t/* We want to ignore bad patterns, so return success regardless */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_driver_funcname(const git_config_entry *entry, void *payload)\n{\n\treturn diff_driver_add_patterns(payload, entry->value, 0);\n}"
  },
  {
    "function_name": "diff_driver_xfuncname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "133-136",
    "snippet": "static int diff_driver_xfuncname(const git_config_entry *entry, void *payload)\n{\n\treturn diff_driver_add_patterns(payload, entry->value, REG_EXTENDED);\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_driver_add_patterns",
          "args": [
            "payload",
            "entry->value",
            "REG_EXTENDED"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "diff_driver_add_patterns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "89-131",
          "snippet": "static int diff_driver_add_patterns(\n\tgit_diff_driver *drv, const char *regex_str, int regex_flags)\n{\n\tint error = 0;\n\tconst char *scan, *end;\n\tgit_diff_driver_pattern *pat = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tfor (scan = regex_str; scan; scan = end) {\n\t\t/* get pattern to fill in */\n\t\tif ((pat = git_array_alloc(drv->fn_patterns)) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tpat->flags = regex_flags;\n\t\tif (*scan == '!') {\n\t\t\tpat->flags |= REG_NEGATE;\n\t\t\t++scan;\n\t\t}\n\n\t\tif ((end = strchr(scan, '\\n')) != NULL) {\n\t\t\terror = git_buf_set(&buf, scan, end - scan);\n\t\t\tend++;\n\t\t} else {\n\t\t\terror = git_buf_sets(&buf, scan);\n\t\t}\n\t\tif (error < 0)\n\t\t\tbreak;\n\n\t\tif ((error = regcomp(&pat->re, buf.ptr, regex_flags)) != 0) {\n\t\t\t/*\n\t\t\t * TODO: issue a warning\n\t\t\t */\n\t\t}\n\t}\n\n\tif (error && pat != NULL)\n\t\t(void)git_array_pop(drv->fn_patterns); /* release last item */\n\tgit_buf_free(&buf);\n\n\t/* We want to ignore bad patterns, so return success regardless */\n\treturn 0;\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_driver_add_patterns(\n\tgit_diff_driver *drv, const char *regex_str, int regex_flags)\n{\n\tint error = 0;\n\tconst char *scan, *end;\n\tgit_diff_driver_pattern *pat = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tfor (scan = regex_str; scan; scan = end) {\n\t\t/* get pattern to fill in */\n\t\tif ((pat = git_array_alloc(drv->fn_patterns)) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tpat->flags = regex_flags;\n\t\tif (*scan == '!') {\n\t\t\tpat->flags |= REG_NEGATE;\n\t\t\t++scan;\n\t\t}\n\n\t\tif ((end = strchr(scan, '\\n')) != NULL) {\n\t\t\terror = git_buf_set(&buf, scan, end - scan);\n\t\t\tend++;\n\t\t} else {\n\t\t\terror = git_buf_sets(&buf, scan);\n\t\t}\n\t\tif (error < 0)\n\t\t\tbreak;\n\n\t\tif ((error = regcomp(&pat->re, buf.ptr, regex_flags)) != 0) {\n\t\t\t/*\n\t\t\t * TODO: issue a warning\n\t\t\t */\n\t\t}\n\t}\n\n\tif (error && pat != NULL)\n\t\t(void)git_array_pop(drv->fn_patterns); /* release last item */\n\tgit_buf_free(&buf);\n\n\t/* We want to ignore bad patterns, so return success regardless */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_driver_xfuncname(const git_config_entry *entry, void *payload)\n{\n\treturn diff_driver_add_patterns(payload, entry->value, REG_EXTENDED);\n}"
  },
  {
    "function_name": "diff_driver_add_patterns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "89-131",
    "snippet": "static int diff_driver_add_patterns(\n\tgit_diff_driver *drv, const char *regex_str, int regex_flags)\n{\n\tint error = 0;\n\tconst char *scan, *end;\n\tgit_diff_driver_pattern *pat = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tfor (scan = regex_str; scan; scan = end) {\n\t\t/* get pattern to fill in */\n\t\tif ((pat = git_array_alloc(drv->fn_patterns)) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tpat->flags = regex_flags;\n\t\tif (*scan == '!') {\n\t\t\tpat->flags |= REG_NEGATE;\n\t\t\t++scan;\n\t\t}\n\n\t\tif ((end = strchr(scan, '\\n')) != NULL) {\n\t\t\terror = git_buf_set(&buf, scan, end - scan);\n\t\t\tend++;\n\t\t} else {\n\t\t\terror = git_buf_sets(&buf, scan);\n\t\t}\n\t\tif (error < 0)\n\t\t\tbreak;\n\n\t\tif ((error = regcomp(&pat->re, buf.ptr, regex_flags)) != 0) {\n\t\t\t/*\n\t\t\t * TODO: issue a warning\n\t\t\t */\n\t\t}\n\t}\n\n\tif (error && pat != NULL)\n\t\t(void)git_array_pop(drv->fn_patterns); /* release last item */\n\tgit_buf_free(&buf);\n\n\t/* We want to ignore bad patterns, so return success regardless */\n\treturn 0;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_pop",
          "args": [
            "drv->fn_patterns"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "regcomp",
          "args": [
            "&pat->re",
            "buf.ptr",
            "regex_flags"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_sets",
          "args": [
            "&buf",
            "scan"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "181-184",
          "snippet": "int git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_set",
          "args": [
            "&buf",
            "scan",
            "end - scan"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "150-169",
          "snippet": "int git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "scan",
            "'\\n'"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "drv->fn_patterns"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nstatic int diff_driver_add_patterns(\n\tgit_diff_driver *drv, const char *regex_str, int regex_flags)\n{\n\tint error = 0;\n\tconst char *scan, *end;\n\tgit_diff_driver_pattern *pat = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tfor (scan = regex_str; scan; scan = end) {\n\t\t/* get pattern to fill in */\n\t\tif ((pat = git_array_alloc(drv->fn_patterns)) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tpat->flags = regex_flags;\n\t\tif (*scan == '!') {\n\t\t\tpat->flags |= REG_NEGATE;\n\t\t\t++scan;\n\t\t}\n\n\t\tif ((end = strchr(scan, '\\n')) != NULL) {\n\t\t\terror = git_buf_set(&buf, scan, end - scan);\n\t\t\tend++;\n\t\t} else {\n\t\t\terror = git_buf_sets(&buf, scan);\n\t\t}\n\t\tif (error < 0)\n\t\t\tbreak;\n\n\t\tif ((error = regcomp(&pat->re, buf.ptr, regex_flags)) != 0) {\n\t\t\t/*\n\t\t\t * TODO: issue a warning\n\t\t\t */\n\t\t}\n\t}\n\n\tif (error && pat != NULL)\n\t\t(void)git_array_pop(drv->fn_patterns); /* release last item */\n\tgit_buf_free(&buf);\n\n\t/* We want to ignore bad patterns, so return success regardless */\n\treturn 0;\n}"
  },
  {
    "function_name": "git_diff_driver_registry_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "77-87",
    "snippet": "void git_diff_driver_registry_free(git_diff_driver_registry *reg)\n{\n\tgit_diff_driver *drv;\n\n\tif (!reg)\n\t\treturn;\n\n\tgit_strmap_foreach_value(reg->drivers, drv, git_diff_driver_free(drv));\n\tgit_strmap_free(reg->drivers);\n\tgit__free(reg);\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "reg"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_free",
          "args": [
            "reg->drivers"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_foreach_value",
          "args": [
            "reg->drivers",
            "drv",
            "git_diff_driver_free(drv)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_diff_driver_free",
          "args": [
            "drv"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_driver_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "393-407",
          "snippet": "void git_diff_driver_free(git_diff_driver *driver)\n{\n\tsize_t i;\n\n\tif (!driver)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(driver->fn_patterns); ++i)\n\t\tregfree(& git_array_get(driver->fn_patterns, i)->re);\n\tgit_array_clear(driver->fn_patterns);\n\n\tregfree(&driver->word_pattern);\n\n\tgit__free(driver);\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_driver_free(git_diff_driver *driver)\n{\n\tsize_t i;\n\n\tif (!driver)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(driver->fn_patterns); ++i)\n\t\tregfree(& git_array_get(driver->fn_patterns, i)->re);\n\tgit_array_clear(driver->fn_patterns);\n\n\tregfree(&driver->word_pattern);\n\n\tgit__free(driver);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_driver_registry_free(git_diff_driver_registry *reg)\n{\n\tgit_diff_driver *drv;\n\n\tif (!reg)\n\t\treturn;\n\n\tgit_strmap_foreach_value(reg->drivers, drv, git_diff_driver_free(drv));\n\tgit_strmap_free(reg->drivers);\n\tgit__free(reg);\n}"
  },
  {
    "function_name": "git_diff_driver_registry_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
    "lines": "62-75",
    "snippet": "git_diff_driver_registry *git_diff_driver_registry_new()\n{\n\tgit_diff_driver_registry *reg =\n\t\tgit__calloc(1, sizeof(git_diff_driver_registry));\n\tif (!reg)\n\t\treturn NULL;\n\n\tif (git_strmap_alloc(&reg->drivers) < 0) {\n\t\tgit_diff_driver_registry_free(reg);\n\t\treturn NULL;\n\t}\n\n\treturn reg;\n}",
    "includes": [
      "#include \"userdiff.h\"",
      "#include \"repository.h\"",
      "#include \"config.h\"",
      "#include \"buf_text.h\"",
      "#include \"map.h\"",
      "#include \"strmap.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"git2/attr.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_diff_driver_registry_free",
          "args": [
            "reg"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_driver_registry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "77-87",
          "snippet": "void git_diff_driver_registry_free(git_diff_driver_registry *reg)\n{\n\tgit_diff_driver *drv;\n\n\tif (!reg)\n\t\treturn;\n\n\tgit_strmap_foreach_value(reg->drivers, drv, git_diff_driver_free(drv));\n\tgit_strmap_free(reg->drivers);\n\tgit__free(reg);\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_driver_registry_free(git_diff_driver_registry *reg)\n{\n\tgit_diff_driver *drv;\n\n\tif (!reg)\n\t\treturn;\n\n\tgit_strmap_foreach_value(reg->drivers, drv, git_diff_driver_free(drv));\n\tgit_strmap_free(reg->drivers);\n\tgit__free(reg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_alloc",
          "args": [
            "&reg->drivers"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_diff_driver_registry)"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\ngit_diff_driver_registry *git_diff_driver_registry_new()\n{\n\tgit_diff_driver_registry *reg =\n\t\tgit__calloc(1, sizeof(git_diff_driver_registry));\n\tif (!reg)\n\t\treturn NULL;\n\n\tif (git_strmap_alloc(&reg->drivers) < 0) {\n\t\tgit_diff_driver_registry_free(reg);\n\t\treturn NULL;\n\t}\n\n\treturn reg;\n}"
  }
]