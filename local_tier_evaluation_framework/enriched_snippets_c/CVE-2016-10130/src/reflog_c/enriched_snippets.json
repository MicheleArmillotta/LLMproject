[
  {
    "function_name": "git_reflog_drop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "186-232",
    "snippet": "int git_reflog_drop(git_reflog *reflog, size_t idx, int rewrite_previous_entry)\n{\n\tsize_t entrycount;\n\tgit_reflog_entry *entry, *previous;\n\n\tentrycount = git_reflog_entrycount(reflog);\n\n\tentry = (git_reflog_entry *)git_reflog_entry_byindex(reflog, idx);\n\n\tif (entry == NULL) {\n\t\tgiterr_set(GITERR_REFERENCE, \"No reflog entry at index %\"PRIuZ, idx);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tgit_reflog_entry__free(entry);\n\n\tif (git_vector_remove(\n\t\t\t&reflog->entries, reflog_inverse_index(idx, entrycount)) < 0)\n\t\treturn -1;\n\n\tif (!rewrite_previous_entry)\n\t\treturn 0;\n\n\t/* No need to rewrite anything when removing the most recent entry */\n\tif (idx == 0)\n\t\treturn 0;\n\n\t/* Have the latest entry just been dropped? */\n\tif (entrycount == 1)\n\t\treturn 0;\n\n\tentry = (git_reflog_entry *)git_reflog_entry_byindex(reflog, idx - 1);\n\n\t/* If the oldest entry has just been removed... */\n\tif (idx == entrycount - 1) {\n\t\t/* ...clear the oid_old member of the \"new\" oldest entry */\n\t\tif (git_oid_fromstr(&entry->oid_old, GIT_OID_HEX_ZERO) < 0)\n\t\t\treturn -1;\n\n\t\treturn 0;\n\t}\n\n\tprevious = (git_reflog_entry *)git_reflog_entry_byindex(reflog, idx);\n\tgit_oid_cpy(&entry->oid_old, &previous->oid_cur);\n\n\treturn 0;\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&entry->oid_old",
            "&previous->oid_cur"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reflog_entry_byindex",
          "args": [
            "reflog",
            "idx"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "git_reflog_entry_byindex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
          "lines": "151-160",
          "snippet": "const git_reflog_entry * git_reflog_entry_byindex(const git_reflog *reflog, size_t idx)\n{\n\tassert(reflog);\n\n\tif (idx >= reflog->entries.length)\n\t\treturn NULL;\n\n\treturn git_vector_get(\n\t\t&reflog->entries, reflog_inverse_index(idx, reflog->entries.length));\n}",
          "includes": [
            "#include <git2/sys/refdb_backend.h>",
            "#include \"refdb.h\"",
            "#include \"signature.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"reflog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nconst git_reflog_entry * git_reflog_entry_byindex(const git_reflog *reflog, size_t idx)\n{\n\tassert(reflog);\n\n\tif (idx >= reflog->entries.length)\n\t\treturn NULL;\n\n\treturn git_vector_get(\n\t\t&reflog->entries, reflog_inverse_index(idx, reflog->entries.length));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fromstr",
          "args": [
            "&entry->oid_old",
            "GIT_OID_HEX_ZERO"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "54-57",
          "snippet": "int git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_remove",
          "args": [
            "&reflog->entries",
            "reflog_inverse_index(idx, entrycount)"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "233-250",
          "snippet": "int git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reflog_inverse_index",
          "args": [
            "idx",
            "entrycount"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "reflog_inverse_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.h",
          "lines": "35-38",
          "snippet": "GIT_INLINE(size_t) reflog_inverse_index(size_t idx, size_t total)\n{\n\treturn (total - 1) - idx;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"git2/reflog.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"git2/reflog.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) reflog_inverse_index(size_t idx, size_t total)\n{\n\treturn (total - 1) - idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reflog_entry__free",
          "args": [
            "entry"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "git_reflog_entry__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
          "lines": "21-27",
          "snippet": "void git_reflog_entry__free(git_reflog_entry *entry)\n{\n\tgit_signature_free(entry->committer);\n\n\tgit__free(entry->msg);\n\tgit__free(entry);\n}",
          "includes": [
            "#include <git2/sys/refdb_backend.h>",
            "#include \"refdb.h\"",
            "#include \"signature.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"reflog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nvoid git_reflog_entry__free(git_reflog_entry *entry)\n{\n\tgit_signature_free(entry->committer);\n\n\tgit__free(entry->msg);\n\tgit__free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REFERENCE",
            "\"No reflog entry at index %\"PRIuZ",
            "idx"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reflog_entrycount",
          "args": [
            "reflog"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "git_reflog_entrycount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
          "lines": "145-149",
          "snippet": "size_t git_reflog_entrycount(git_reflog *reflog)\n{\n\tassert(reflog);\n\treturn reflog->entries.length;\n}",
          "includes": [
            "#include <git2/sys/refdb_backend.h>",
            "#include \"refdb.h\"",
            "#include \"signature.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"reflog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nsize_t git_reflog_entrycount(git_reflog *reflog)\n{\n\tassert(reflog);\n\treturn reflog->entries.length;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nint git_reflog_drop(git_reflog *reflog, size_t idx, int rewrite_previous_entry)\n{\n\tsize_t entrycount;\n\tgit_reflog_entry *entry, *previous;\n\n\tentrycount = git_reflog_entrycount(reflog);\n\n\tentry = (git_reflog_entry *)git_reflog_entry_byindex(reflog, idx);\n\n\tif (entry == NULL) {\n\t\tgiterr_set(GITERR_REFERENCE, \"No reflog entry at index %\"PRIuZ, idx);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tgit_reflog_entry__free(entry);\n\n\tif (git_vector_remove(\n\t\t\t&reflog->entries, reflog_inverse_index(idx, entrycount)) < 0)\n\t\treturn -1;\n\n\tif (!rewrite_previous_entry)\n\t\treturn 0;\n\n\t/* No need to rewrite anything when removing the most recent entry */\n\tif (idx == 0)\n\t\treturn 0;\n\n\t/* Have the latest entry just been dropped? */\n\tif (entrycount == 1)\n\t\treturn 0;\n\n\tentry = (git_reflog_entry *)git_reflog_entry_byindex(reflog, idx - 1);\n\n\t/* If the oldest entry has just been removed... */\n\tif (idx == entrycount - 1) {\n\t\t/* ...clear the oid_old member of the \"new\" oldest entry */\n\t\tif (git_oid_fromstr(&entry->oid_old, GIT_OID_HEX_ZERO) < 0)\n\t\t\treturn -1;\n\n\t\treturn 0;\n\t}\n\n\tprevious = (git_reflog_entry *)git_reflog_entry_byindex(reflog, idx);\n\tgit_oid_cpy(&entry->oid_old, &previous->oid_cur);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_reflog_entry_message",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "180-184",
    "snippet": "const char * git_reflog_entry_message(const git_reflog_entry *entry)\n{\n\tassert(entry);\n\treturn entry->msg;\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "entry"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nconst char * git_reflog_entry_message(const git_reflog_entry *entry)\n{\n\tassert(entry);\n\treturn entry->msg;\n}"
  },
  {
    "function_name": "git_reflog_entry_committer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "174-178",
    "snippet": "const git_signature * git_reflog_entry_committer(const git_reflog_entry *entry)\n{\n\tassert(entry);\n\treturn entry->committer;\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "entry"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nconst git_signature * git_reflog_entry_committer(const git_reflog_entry *entry)\n{\n\tassert(entry);\n\treturn entry->committer;\n}"
  },
  {
    "function_name": "git_reflog_entry_id_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "168-172",
    "snippet": "const git_oid * git_reflog_entry_id_new(const git_reflog_entry *entry)\n{\n\tassert(entry);\n\treturn &entry->oid_cur;\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "entry"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nconst git_oid * git_reflog_entry_id_new(const git_reflog_entry *entry)\n{\n\tassert(entry);\n\treturn &entry->oid_cur;\n}"
  },
  {
    "function_name": "git_reflog_entry_id_old",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "162-166",
    "snippet": "const git_oid * git_reflog_entry_id_old(const git_reflog_entry *entry)\n{\n\tassert(entry);\n\treturn &entry->oid_old;\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "entry"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nconst git_oid * git_reflog_entry_id_old(const git_reflog_entry *entry)\n{\n\tassert(entry);\n\treturn &entry->oid_old;\n}"
  },
  {
    "function_name": "git_reflog_entry_byindex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "151-160",
    "snippet": "const git_reflog_entry * git_reflog_entry_byindex(const git_reflog *reflog, size_t idx)\n{\n\tassert(reflog);\n\n\tif (idx >= reflog->entries.length)\n\t\treturn NULL;\n\n\treturn git_vector_get(\n\t\t&reflog->entries, reflog_inverse_index(idx, reflog->entries.length));\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&reflog->entries",
            "reflog_inverse_index(idx, reflog->entries.length)"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reflog_inverse_index",
          "args": [
            "idx",
            "reflog->entries.length"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "reflog_inverse_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.h",
          "lines": "35-38",
          "snippet": "GIT_INLINE(size_t) reflog_inverse_index(size_t idx, size_t total)\n{\n\treturn (total - 1) - idx;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"git2/reflog.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"git2/reflog.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) reflog_inverse_index(size_t idx, size_t total)\n{\n\treturn (total - 1) - idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "reflog"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nconst git_reflog_entry * git_reflog_entry_byindex(const git_reflog *reflog, size_t idx)\n{\n\tassert(reflog);\n\n\tif (idx >= reflog->entries.length)\n\t\treturn NULL;\n\n\treturn git_vector_get(\n\t\t&reflog->entries, reflog_inverse_index(idx, reflog->entries.length));\n}"
  },
  {
    "function_name": "git_reflog_entrycount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "145-149",
    "snippet": "size_t git_reflog_entrycount(git_reflog *reflog)\n{\n\tassert(reflog);\n\treturn reflog->entries.length;\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "reflog"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nsize_t git_reflog_entrycount(git_reflog *reflog)\n{\n\tassert(reflog);\n\treturn reflog->entries.length;\n}"
  },
  {
    "function_name": "git_reflog_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "134-143",
    "snippet": "int git_reflog_delete(git_repository *repo, const char *name)\n{\n\tgit_refdb *refdb;\n\tint error;\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn -1;\n\n\treturn refdb->backend->reflog_delete(refdb->backend, name);\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "refdb->backend->reflog_delete",
          "args": [
            "refdb->backend",
            "name"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_refdb__weakptr",
          "args": [
            "&refdb",
            "repo"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_refdb__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "779-802",
          "snippet": "int git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nint git_reflog_delete(git_repository *repo, const char *name)\n{\n\tgit_refdb *refdb;\n\tint error;\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn -1;\n\n\treturn refdb->backend->reflog_delete(refdb->backend, name);\n}"
  },
  {
    "function_name": "git_reflog_rename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "123-132",
    "snippet": "int git_reflog_rename(git_repository *repo, const char *old_name, const char *new_name)\n{\n\tgit_refdb *refdb;\n\tint error;\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn -1;\n\n\treturn refdb->backend->reflog_rename(refdb->backend, old_name, new_name);\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "refdb->backend->reflog_rename",
          "args": [
            "refdb->backend",
            "old_name",
            "new_name"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_refdb__weakptr",
          "args": [
            "&refdb",
            "repo"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_refdb__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "779-802",
          "snippet": "int git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nint git_reflog_rename(git_repository *repo, const char *old_name, const char *new_name)\n{\n\tgit_refdb *refdb;\n\tint error;\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn -1;\n\n\treturn refdb->backend->reflog_rename(refdb->backend, old_name, new_name);\n}"
  },
  {
    "function_name": "git_reflog_append",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "74-121",
    "snippet": "int git_reflog_append(git_reflog *reflog, const git_oid *new_oid, const git_signature *committer, const char *msg)\n{\n\tgit_reflog_entry *entry;\n\tconst git_reflog_entry *previous;\n\tconst char *newline;\n\n\tassert(reflog && new_oid && committer);\n\n\tentry = git__calloc(1, sizeof(git_reflog_entry));\n\tGITERR_CHECK_ALLOC(entry);\n\n\tif ((git_signature_dup(&entry->committer, committer)) < 0)\n\t\tgoto cleanup;\n\n\tif (msg != NULL) {\n\t\tif ((entry->msg = git__strdup(msg)) == NULL)\n\t\t\tgoto cleanup;\n\n\t\tnewline = strchr(msg, '\\n');\n\n\t\tif (newline) {\n\t\t\tif (newline[1] != '\\0') {\n\t\t\t\tgiterr_set(GITERR_INVALID, \"Reflog message cannot contain newline\");\n\t\t\t\tgoto cleanup;\n\t\t\t}\n\n\t\t\tentry->msg[newline - msg] = '\\0';\n\t\t}\n\t}\n\n\tprevious = git_reflog_entry_byindex(reflog, 0);\n\n\tif (previous == NULL)\n\t\tgit_oid_fromstr(&entry->oid_old, GIT_OID_HEX_ZERO);\n\telse\n\t\tgit_oid_cpy(&entry->oid_old, &previous->oid_cur);\n\n\tgit_oid_cpy(&entry->oid_cur, new_oid);\n\n\tif (git_vector_insert(&reflog->entries, entry) < 0)\n\t\tgoto cleanup;\n\n\treturn 0;\n\ncleanup:\n\tgit_reflog_entry__free(entry);\n\treturn -1;\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reflog_entry__free",
          "args": [
            "entry"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "git_reflog_entry__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
          "lines": "21-27",
          "snippet": "void git_reflog_entry__free(git_reflog_entry *entry)\n{\n\tgit_signature_free(entry->committer);\n\n\tgit__free(entry->msg);\n\tgit__free(entry);\n}",
          "includes": [
            "#include <git2/sys/refdb_backend.h>",
            "#include \"refdb.h\"",
            "#include \"signature.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"reflog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nvoid git_reflog_entry__free(git_reflog_entry *entry)\n{\n\tgit_signature_free(entry->committer);\n\n\tgit__free(entry->msg);\n\tgit__free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&reflog->entries",
            "entry"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&entry->oid_cur",
            "new_oid"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fromstr",
          "args": [
            "&entry->oid_old",
            "GIT_OID_HEX_ZERO"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "54-57",
          "snippet": "int git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reflog_entry_byindex",
          "args": [
            "reflog",
            "0"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "git_reflog_entry_byindex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
          "lines": "151-160",
          "snippet": "const git_reflog_entry * git_reflog_entry_byindex(const git_reflog *reflog, size_t idx)\n{\n\tassert(reflog);\n\n\tif (idx >= reflog->entries.length)\n\t\treturn NULL;\n\n\treturn git_vector_get(\n\t\t&reflog->entries, reflog_inverse_index(idx, reflog->entries.length));\n}",
          "includes": [
            "#include <git2/sys/refdb_backend.h>",
            "#include \"refdb.h\"",
            "#include \"signature.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"reflog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nconst git_reflog_entry * git_reflog_entry_byindex(const git_reflog *reflog, size_t idx)\n{\n\tassert(reflog);\n\n\tif (idx >= reflog->entries.length)\n\t\treturn NULL;\n\n\treturn git_vector_get(\n\t\t&reflog->entries, reflog_inverse_index(idx, reflog->entries.length));\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Reflog message cannot contain newline\""
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "msg",
            "'\\n'"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "msg"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_signature_dup",
          "args": [
            "&entry->committer",
            "committer"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "98-120",
          "snippet": "int git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "entry"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_reflog_entry)"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "reflog && new_oid && committer"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nint git_reflog_append(git_reflog *reflog, const git_oid *new_oid, const git_signature *committer, const char *msg)\n{\n\tgit_reflog_entry *entry;\n\tconst git_reflog_entry *previous;\n\tconst char *newline;\n\n\tassert(reflog && new_oid && committer);\n\n\tentry = git__calloc(1, sizeof(git_reflog_entry));\n\tGITERR_CHECK_ALLOC(entry);\n\n\tif ((git_signature_dup(&entry->committer, committer)) < 0)\n\t\tgoto cleanup;\n\n\tif (msg != NULL) {\n\t\tif ((entry->msg = git__strdup(msg)) == NULL)\n\t\t\tgoto cleanup;\n\n\t\tnewline = strchr(msg, '\\n');\n\n\t\tif (newline) {\n\t\t\tif (newline[1] != '\\0') {\n\t\t\t\tgiterr_set(GITERR_INVALID, \"Reflog message cannot contain newline\");\n\t\t\t\tgoto cleanup;\n\t\t\t}\n\n\t\t\tentry->msg[newline - msg] = '\\0';\n\t\t}\n\t}\n\n\tprevious = git_reflog_entry_byindex(reflog, 0);\n\n\tif (previous == NULL)\n\t\tgit_oid_fromstr(&entry->oid_old, GIT_OID_HEX_ZERO);\n\telse\n\t\tgit_oid_cpy(&entry->oid_old, &previous->oid_cur);\n\n\tgit_oid_cpy(&entry->oid_cur, new_oid);\n\n\tif (git_vector_insert(&reflog->entries, entry) < 0)\n\t\tgoto cleanup;\n\n\treturn 0;\n\ncleanup:\n\tgit_reflog_entry__free(entry);\n\treturn -1;\n}"
  },
  {
    "function_name": "git_reflog_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "64-72",
    "snippet": "int git_reflog_write(git_reflog *reflog)\n{\n\tgit_refdb *db;\n\n\tassert(reflog && reflog->db);\n\n\tdb = reflog->db;\n\treturn db->backend->reflog_write(db->backend, reflog);\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->backend->reflog_write",
          "args": [
            "db->backend",
            "reflog"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "reflog && reflog->db"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nint git_reflog_write(git_reflog *reflog)\n{\n\tgit_refdb *db;\n\n\tassert(reflog && reflog->db);\n\n\tdb = reflog->db;\n\treturn db->backend->reflog_write(db->backend, reflog);\n}"
  },
  {
    "function_name": "git_reflog_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "51-62",
    "snippet": "int git_reflog_read(git_reflog **reflog, git_repository *repo,  const char *name)\n{\n\tgit_refdb *refdb;\n\tint error;\n\n\tassert(reflog && repo && name);\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn error;\n\n\treturn git_refdb_reflog_read(reflog, refdb, name);\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_refdb_reflog_read",
          "args": [
            "reflog",
            "refdb",
            "name"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "git_refdb_reflog_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
          "lines": "206-219",
          "snippet": "int git_refdb_reflog_read(git_reflog **out, git_refdb *db,  const char *name)\n{\n\tint error;\n\n\tassert(db && db->backend);\n\n\tif ((error = db->backend->reflog_read(out, db->backend, name)) < 0)\n\t\treturn error;\n\n\tGIT_REFCOUNT_INC(db);\n\t(*out)->db = db;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"reflog.h\"",
            "#include \"refs.h\"",
            "#include \"refdb.h\"",
            "#include \"hash.h\"",
            "#include \"git2/sys/refdb_backend.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/object.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_reflog_read(git_reflog **out, git_refdb *db,  const char *name)\n{\n\tint error;\n\n\tassert(db && db->backend);\n\n\tif ((error = db->backend->reflog_read(out, db->backend, name)) < 0)\n\t\treturn error;\n\n\tGIT_REFCOUNT_INC(db);\n\t(*out)->db = db;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_refdb__weakptr",
          "args": [
            "&refdb",
            "repo"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_refdb__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "779-802",
          "snippet": "int git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "reflog && repo && name"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nint git_reflog_read(git_reflog **reflog, git_repository *repo,  const char *name)\n{\n\tgit_refdb *refdb;\n\tint error;\n\n\tassert(reflog && repo && name);\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn error;\n\n\treturn git_refdb_reflog_read(reflog, refdb, name);\n}"
  },
  {
    "function_name": "git_reflog_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "29-49",
    "snippet": "void git_reflog_free(git_reflog *reflog)\n{\n\tsize_t i;\n\tgit_reflog_entry *entry;\n\n\tif (reflog == NULL)\n\t\treturn;\n\n\tif (reflog->db)\n\t\tGIT_REFCOUNT_DEC(reflog->db, git_refdb__free);\n\n\tfor (i=0; i < reflog->entries.length; i++) {\n\t\tentry = git_vector_get(&reflog->entries, i);\n\n\t\tgit_reflog_entry__free(entry);\n\t}\n\n\tgit_vector_free(&reflog->entries);\n\tgit__free(reflog->ref_name);\n\tgit__free(reflog);\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "reflog"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "&reflog->entries"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reflog_entry__free",
          "args": [
            "entry"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "git_reflog_entry__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
          "lines": "21-27",
          "snippet": "void git_reflog_entry__free(git_reflog_entry *entry)\n{\n\tgit_signature_free(entry->committer);\n\n\tgit__free(entry->msg);\n\tgit__free(entry);\n}",
          "includes": [
            "#include <git2/sys/refdb_backend.h>",
            "#include \"refdb.h\"",
            "#include \"signature.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"reflog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nvoid git_reflog_entry__free(git_reflog_entry *entry)\n{\n\tgit_signature_free(entry->committer);\n\n\tgit__free(entry->msg);\n\tgit__free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&reflog->entries",
            "i"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_DEC",
          "args": [
            "reflog->db",
            "git_refdb__free"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nvoid git_reflog_free(git_reflog *reflog)\n{\n\tsize_t i;\n\tgit_reflog_entry *entry;\n\n\tif (reflog == NULL)\n\t\treturn;\n\n\tif (reflog->db)\n\t\tGIT_REFCOUNT_DEC(reflog->db, git_refdb__free);\n\n\tfor (i=0; i < reflog->entries.length; i++) {\n\t\tentry = git_vector_get(&reflog->entries, i);\n\n\t\tgit_reflog_entry__free(entry);\n\t}\n\n\tgit_vector_free(&reflog->entries);\n\tgit__free(reflog->ref_name);\n\tgit__free(reflog);\n}"
  },
  {
    "function_name": "git_reflog_entry__free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "21-27",
    "snippet": "void git_reflog_entry__free(git_reflog_entry *entry)\n{\n\tgit_signature_free(entry->committer);\n\n\tgit__free(entry->msg);\n\tgit__free(entry);\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "entry"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_signature_free",
          "args": [
            "entry->committer"
          ],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "14-24",
          "snippet": "void git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nvoid git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\nvoid git_reflog_entry__free(git_reflog_entry *entry)\n{\n\tgit_signature_free(entry->committer);\n\n\tgit__free(entry->msg);\n\tgit__free(entry);\n}"
  },
  {
    "function_name": "git_reflog_entry__alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reflog.c",
    "lines": "16-19",
    "snippet": "git_reflog_entry *git_reflog_entry__alloc(void)\n{\n\treturn git__calloc(1, sizeof(git_reflog_entry));\n}",
    "includes": [
      "#include <git2/sys/refdb_backend.h>",
      "#include \"refdb.h\"",
      "#include \"signature.h\"",
      "#include \"filebuf.h\"",
      "#include \"repository.h\"",
      "#include \"reflog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_reflog_entry)"
          ],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/sys/refdb_backend.h>\n#include \"refdb.h\"\n#include \"signature.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"reflog.h\"\n\ngit_reflog_entry *git_reflog_entry__alloc(void)\n{\n\treturn git__calloc(1, sizeof(git_reflog_entry));\n}"
  }
]