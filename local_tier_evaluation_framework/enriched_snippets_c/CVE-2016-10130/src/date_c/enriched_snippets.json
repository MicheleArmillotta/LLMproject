[
  {
    "function_name": "git__date_rfc2822_fmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "878-903",
    "snippet": "int git__date_rfc2822_fmt(char *out, size_t len, const git_time *date)\n{\n\tint written;\n\tstruct tm gmt;\n\ttime_t t;\n\n\tassert(out && date);\n\n\tt = (time_t) (date->time + date->offset * 60);\n\n\tif (p_gmtime_r (&t, &gmt) == NULL)\n\t\treturn -1;\n\n\twritten = p_snprintf(out, len, \"%.3s, %u %.3s %.4u %02u:%02u:%02u %+03d%02d\",\n\t\tweekday_names[gmt.tm_wday],\n\t\tgmt.tm_mday,\n\t\tmonth_names[gmt.tm_mon],\n\t\tgmt.tm_year + 1900,\n\t\tgmt.tm_hour, gmt.tm_min, gmt.tm_sec,\n\t\tdate->offset / 60, date->offset % 60);\n\n\tif (written < 0 || (written > (int) len - 1))\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};",
      "static const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "p_snprintf",
          "args": [
            "out",
            "len",
            "\"%.3s, %u %.3s %.4u %02u:%02u:%02u %+03d%02d\"",
            "weekday_names[gmt.tm_wday]",
            "gmt.tm_mday",
            "month_names[gmt.tm_mon]",
            "gmt.tm_year + 1900",
            "gmt.tm_hour",
            "gmt.tm_min",
            "gmt.tm_sec",
            "date->offset / 60",
            "date->offset % 60"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "p_snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "548-558",
          "snippet": "int p_snprintf(char *buffer, size_t count, const char *format, ...)\n{\n\tva_list va;\n\tint r;\n\n\tva_start(va, format);\n\tr = p_vsnprintf(buffer, count, format, va);\n\tva_end(va);\n\n\treturn r;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_snprintf(char *buffer, size_t count, const char *format, ...)\n{\n\tva_list va;\n\tint r;\n\n\tva_start(va, format);\n\tr = p_vsnprintf(buffer, count, format, va);\n\tva_end(va);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_gmtime_r",
          "args": [
            "&t",
            "&gmt"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "p_gmtime_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "674-685",
          "snippet": "struct tm *\np_gmtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = gmtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nstruct tm *\np_gmtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = gmtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "date->time + date->offset * 60"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && date"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};\nstatic const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};\n\nint git__date_rfc2822_fmt(char *out, size_t len, const git_time *date)\n{\n\tint written;\n\tstruct tm gmt;\n\ttime_t t;\n\n\tassert(out && date);\n\n\tt = (time_t) (date->time + date->offset * 60);\n\n\tif (p_gmtime_r (&t, &gmt) == NULL)\n\t\treturn -1;\n\n\twritten = p_snprintf(out, len, \"%.3s, %u %.3s %.4u %02u:%02u:%02u %+03d%02d\",\n\t\tweekday_names[gmt.tm_wday],\n\t\tgmt.tm_mday,\n\t\tmonth_names[gmt.tm_mon],\n\t\tgmt.tm_year + 1900,\n\t\tgmt.tm_hour, gmt.tm_min, gmt.tm_sec,\n\t\tdate->offset / 60, date->offset % 60);\n\n\tif (written < 0 || (written > (int) len - 1))\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git__date_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "860-876",
    "snippet": "int git__date_parse(git_time_t *out, const char *date)\n{\n\ttime_t time_sec;\n\tgit_time_t timestamp;\n\tint offset, error_ret=0;\n\n\tif (!parse_date_basic(date, &timestamp, &offset)) {\n\t\t*out = timestamp;\n\t\treturn 0;\n\t}\n\n\tif (time(&time_sec) == -1)\n\t\treturn -1;\n\n\t*out = approxidate_str(date, time_sec, &error_ret);\n   return error_ret;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "approxidate_str",
          "args": [
            "date",
            "time_sec",
            "&error_ret"
          ],
          "line": 874
        },
        "resolved": true,
        "details": {
          "function_name": "approxidate_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "825-858",
          "snippet": "static git_time_t approxidate_str(const char *date,\n\ttime_t time_sec,\n\tint *error_ret)\n{\n\tint number = 0;\n\tint touched = 0;\n\tstruct tm tm = {0}, now;\n\n\tp_localtime_r(&time_sec, &tm);\n\tnow = tm;\n\n\ttm.tm_year = -1;\n\ttm.tm_mon = -1;\n\ttm.tm_mday = -1;\n\n\tfor (;;) {\n\t\tunsigned char c = *date;\n\t\tif (!c)\n\t\t\tbreak;\n\t\tdate++;\n\t\tif (isdigit(c)) {\n\t\t\tpending_number(&tm, &number);\n\t\t\tdate = approxidate_digit(date-1, &tm, &number);\n\t\t\ttouched = 1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (isalpha(c))\n\t\t\tdate = approxidate_alpha(date-1, &tm, &now, &number, &touched);\n\t}\n\tpending_number(&tm, &number);\n\tif (!touched)\n\t\t*error_ret = 1;\n\treturn update_tm(&tm, &now, 0);\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t approxidate_str(const char *date,\n\ttime_t time_sec,\n\tint *error_ret)\n{\n\tint number = 0;\n\tint touched = 0;\n\tstruct tm tm = {0}, now;\n\n\tp_localtime_r(&time_sec, &tm);\n\tnow = tm;\n\n\ttm.tm_year = -1;\n\ttm.tm_mon = -1;\n\ttm.tm_mday = -1;\n\n\tfor (;;) {\n\t\tunsigned char c = *date;\n\t\tif (!c)\n\t\t\tbreak;\n\t\tdate++;\n\t\tif (isdigit(c)) {\n\t\t\tpending_number(&tm, &number);\n\t\t\tdate = approxidate_digit(date-1, &tm, &number);\n\t\t\ttouched = 1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (isalpha(c))\n\t\t\tdate = approxidate_alpha(date-1, &tm, &now, &number, &touched);\n\t}\n\tpending_number(&tm, &number);\n\tif (!touched)\n\t\t*error_ret = 1;\n\treturn update_tm(&tm, &now, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&time_sec"
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "tm_to_time_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "33-52",
          "snippet": "static git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parse_date_basic",
          "args": [
            "date",
            "&timestamp",
            "&offset"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "parse_date_basic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "482-542",
          "snippet": "static int parse_date_basic(const char *date, git_time_t *timestamp, int *offset)\n{\n\tstruct tm tm;\n\tint tm_gmt;\n\tgit_time_t dummy_timestamp;\n\tint dummy_offset;\n\n\tif (!timestamp)\n\t\ttimestamp = &dummy_timestamp;\n\tif (!offset)\n\t\toffset = &dummy_offset;\n\n\tmemset(&tm, 0, sizeof(tm));\n\ttm.tm_year = -1;\n\ttm.tm_mon = -1;\n\ttm.tm_mday = -1;\n\ttm.tm_isdst = -1;\n\ttm.tm_hour = -1;\n\ttm.tm_min = -1;\n\ttm.tm_sec = -1;\n\t*offset = -1;\n\ttm_gmt = 0;\n\n\tif (*date == '@' &&\n\t    !match_object_header_date(date + 1, timestamp, offset))\n\t\treturn 0; /* success */\n\tfor (;;) {\n\t\tsize_t match = 0;\n\t\tunsigned char c = *date;\n\n\t\t/* Stop at end of string or newline */\n\t\tif (!c || c == '\\n')\n\t\t\tbreak;\n\n\t\tif (isalpha(c))\n\t\t\tmatch = match_alpha(date, &tm, offset);\n\t\telse if (isdigit(c))\n\t\t\tmatch = match_digit(date, &tm, offset, &tm_gmt);\n\t\telse if ((c == '-' || c == '+') && isdigit(date[1]))\n\t\t\tmatch = match_tz(date, offset);\n\n\t\tif (!match) {\n\t\t\t/* BAD */\n\t\t\tmatch = 1;\n\t\t}\n\n\t\tdate += match;\n\t}\n\n\t/* mktime uses local timezone */\n\t*timestamp = tm_to_time_t(&tm);\n\tif (*offset == -1)\n\t\t*offset = (int)((time_t)*timestamp - mktime(&tm)) / 60;\n\n\tif (*timestamp == (git_time_t)-1)\n\t\treturn -1;\n\n\tif (!tm_gmt)\n\t\t*timestamp -= *offset * 60;\n\treturn 0; /* success */\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int parse_date_basic(const char *date, git_time_t *timestamp, int *offset)\n{\n\tstruct tm tm;\n\tint tm_gmt;\n\tgit_time_t dummy_timestamp;\n\tint dummy_offset;\n\n\tif (!timestamp)\n\t\ttimestamp = &dummy_timestamp;\n\tif (!offset)\n\t\toffset = &dummy_offset;\n\n\tmemset(&tm, 0, sizeof(tm));\n\ttm.tm_year = -1;\n\ttm.tm_mon = -1;\n\ttm.tm_mday = -1;\n\ttm.tm_isdst = -1;\n\ttm.tm_hour = -1;\n\ttm.tm_min = -1;\n\ttm.tm_sec = -1;\n\t*offset = -1;\n\ttm_gmt = 0;\n\n\tif (*date == '@' &&\n\t    !match_object_header_date(date + 1, timestamp, offset))\n\t\treturn 0; /* success */\n\tfor (;;) {\n\t\tsize_t match = 0;\n\t\tunsigned char c = *date;\n\n\t\t/* Stop at end of string or newline */\n\t\tif (!c || c == '\\n')\n\t\t\tbreak;\n\n\t\tif (isalpha(c))\n\t\t\tmatch = match_alpha(date, &tm, offset);\n\t\telse if (isdigit(c))\n\t\t\tmatch = match_digit(date, &tm, offset, &tm_gmt);\n\t\telse if ((c == '-' || c == '+') && isdigit(date[1]))\n\t\t\tmatch = match_tz(date, offset);\n\n\t\tif (!match) {\n\t\t\t/* BAD */\n\t\t\tmatch = 1;\n\t\t}\n\n\t\tdate += match;\n\t}\n\n\t/* mktime uses local timezone */\n\t*timestamp = tm_to_time_t(&tm);\n\tif (*offset == -1)\n\t\t*offset = (int)((time_t)*timestamp - mktime(&tm)) / 60;\n\n\tif (*timestamp == (git_time_t)-1)\n\t\treturn -1;\n\n\tif (!tm_gmt)\n\t\t*timestamp -= *offset * 60;\n\treturn 0; /* success */\n}"
        }
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nint git__date_parse(git_time_t *out, const char *date)\n{\n\ttime_t time_sec;\n\tgit_time_t timestamp;\n\tint offset, error_ret=0;\n\n\tif (!parse_date_basic(date, &timestamp, &offset)) {\n\t\t*out = timestamp;\n\t\treturn 0;\n\t}\n\n\tif (time(&time_sec) == -1)\n\t\treturn -1;\n\n\t*out = approxidate_str(date, time_sec, &error_ret);\n   return error_ret;\n}"
  },
  {
    "function_name": "approxidate_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "825-858",
    "snippet": "static git_time_t approxidate_str(const char *date,\n\ttime_t time_sec,\n\tint *error_ret)\n{\n\tint number = 0;\n\tint touched = 0;\n\tstruct tm tm = {0}, now;\n\n\tp_localtime_r(&time_sec, &tm);\n\tnow = tm;\n\n\ttm.tm_year = -1;\n\ttm.tm_mon = -1;\n\ttm.tm_mday = -1;\n\n\tfor (;;) {\n\t\tunsigned char c = *date;\n\t\tif (!c)\n\t\t\tbreak;\n\t\tdate++;\n\t\tif (isdigit(c)) {\n\t\t\tpending_number(&tm, &number);\n\t\t\tdate = approxidate_digit(date-1, &tm, &number);\n\t\t\ttouched = 1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (isalpha(c))\n\t\t\tdate = approxidate_alpha(date-1, &tm, &now, &number, &touched);\n\t}\n\tpending_number(&tm, &number);\n\tif (!touched)\n\t\t*error_ret = 1;\n\treturn update_tm(&tm, &now, 0);\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "update_tm",
          "args": [
            "&tm",
            "&now",
            "0"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "update_tm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "549-566",
          "snippet": "static git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pending_number",
          "args": [
            "&tm",
            "&number"
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "pending_number",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "803-823",
          "snippet": "static void pending_number(struct tm *tm, int *num)\n{\n\tint number = *num;\n\n\tif (number) {\n\t\t*num = 0;\n\t\tif (tm->tm_mday < 0 && number < 32)\n\t\t\ttm->tm_mday = number;\n\t\telse if (tm->tm_mon < 0 && number < 13)\n\t\t\ttm->tm_mon = number-1;\n\t\telse if (tm->tm_year < 0) {\n\t\t\tif (number > 1969 && number < 2100)\n\t\t\t\ttm->tm_year = number - 1900;\n\t\t\telse if (number > 69 && number < 100)\n\t\t\t\ttm->tm_year = number;\n\t\t\telse if (number < 38)\n\t\t\t\ttm->tm_year = 100 + number;\n\t\t\t/* We mess up for number = 00 ? */\n\t\t}\n\t}\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void pending_number(struct tm *tm, int *num)\n{\n\tint number = *num;\n\n\tif (number) {\n\t\t*num = 0;\n\t\tif (tm->tm_mday < 0 && number < 32)\n\t\t\ttm->tm_mday = number;\n\t\telse if (tm->tm_mon < 0 && number < 13)\n\t\t\ttm->tm_mon = number-1;\n\t\telse if (tm->tm_year < 0) {\n\t\t\tif (number > 1969 && number < 2100)\n\t\t\t\ttm->tm_year = number - 1900;\n\t\t\telse if (number > 69 && number < 100)\n\t\t\t\ttm->tm_year = number;\n\t\t\telse if (number < 38)\n\t\t\t\ttm->tm_year = 100 + number;\n\t\t\t/* We mess up for number = 00 ? */\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "approxidate_alpha",
          "args": [
            "date-1",
            "&tm",
            "&now",
            "&number",
            "&touched"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "approxidate_alpha",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "677-773",
          "snippet": "static const char *approxidate_alpha(const char *date, struct tm *tm, struct tm *now, int *num, int *touched)\n{\n\tconst struct typelen *tl;\n\tconst struct special *s;\n\tconst char *end = date;\n\tint i;\n\n\twhile (isalpha(*++end))\n\t\t/* scan to non-alpha */;\n\n\tfor (i = 0; i < 12; i++) {\n\t\tsize_t match = match_string(date, month_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_mon = i;\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tfor (s = special; s->name; s++) {\n\t\tsize_t len = strlen(s->name);\n\t\tif (match_string(date, s->name) == len) {\n\t\t\ts->fn(tm, now, num);\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tif (!*num) {\n\t\tfor (i = 1; i < 11; i++) {\n\t\t\tsize_t len = strlen(number_name[i]);\n\t\t\tif (match_string(date, number_name[i]) == len) {\n\t\t\t\t*num = i;\n\t\t\t\t*touched = 1;\n\t\t\t\treturn end;\n\t\t\t}\n\t\t}\n\t\tif (match_string(date, \"last\") == 4) {\n\t\t\t*num = 1;\n\t\t\t*touched = 1;\n\t\t}\n\t\treturn end;\n\t}\n\n\ttl = typelen;\n\twhile (tl->type) {\n\t\tsize_t len = strlen(tl->type);\n\t\tif (match_string(date, tl->type) >= len-1) {\n\t\t\tupdate_tm(tm, now, tl->length * *num);\n\t\t\t*num = 0;\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t\ttl++;\n\t}\n\n\tfor (i = 0; i < 7; i++) {\n\t\tsize_t match = match_string(date, weekday_names[i]);\n\t\tif (match >= 3) {\n\t\t\tint diff, n = *num -1;\n\t\t\t*num = 0;\n\n\t\t\tdiff = tm->tm_wday - i;\n\t\t\tif (diff <= 0)\n\t\t\t\tn++;\n\t\t\tdiff += 7*n;\n\n\t\t\tupdate_tm(tm, now, diff * 24 * 60 * 60);\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tif (match_string(date, \"months\") >= 5) {\n\t\tint n;\n\t\tupdate_tm(tm, now, 0); /* fill in date fields if needed */\n\t\tn = tm->tm_mon - *num;\n\t\t*num = 0;\n\t\twhile (n < 0) {\n\t\t\tn += 12;\n\t\t\ttm->tm_year--;\n\t\t}\n\t\ttm->tm_mon = n;\n\t\t*touched = 1;\n\t\treturn end;\n\t}\n\n\tif (match_string(date, \"years\") >= 4) {\n\t\tupdate_tm(tm, now, 0); /* fill in date fields if needed */\n\t\ttm->tm_year -= *num;\n\t\t*num = 0;\n\t\t*touched = 1;\n\t\treturn end;\n\t}\n\n\treturn end;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};",
            "static const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};",
            "static const struct special {\n\tconst char *name;\n\tvoid (*fn)(struct tm *, struct tm *, int *);\n} special[] = {\n\t{ \"yesterday\", date_yesterday },\n\t{ \"noon\", date_noon },\n\t{ \"midnight\", date_midnight },\n\t{ \"tea\", date_tea },\n\t{ \"PM\", date_pm },\n\t{ \"AM\", date_am },\n\t{ \"never\", date_never },\n\t{ \"now\", date_now },\n\t{ NULL }\n};",
            "static const char *number_name[] = {\n\t\"zero\", \"one\", \"two\", \"three\", \"four\",\n\t\"five\", \"six\", \"seven\", \"eight\", \"nine\", \"ten\",\n};",
            "static const struct typelen {\n\tconst char *type;\n\tint length;\n} typelen[] = {\n\t{ \"seconds\", 1 },\n\t{ \"minutes\", 60 },\n\t{ \"hours\", 60*60 },\n\t{ \"days\", 24*60*60 },\n\t{ \"weeks\", 7*24*60*60 },\n\t{ NULL }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};\nstatic const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};\nstatic const struct special {\n\tconst char *name;\n\tvoid (*fn)(struct tm *, struct tm *, int *);\n} special[] = {\n\t{ \"yesterday\", date_yesterday },\n\t{ \"noon\", date_noon },\n\t{ \"midnight\", date_midnight },\n\t{ \"tea\", date_tea },\n\t{ \"PM\", date_pm },\n\t{ \"AM\", date_am },\n\t{ \"never\", date_never },\n\t{ \"now\", date_now },\n\t{ NULL }\n};\nstatic const char *number_name[] = {\n\t\"zero\", \"one\", \"two\", \"three\", \"four\",\n\t\"five\", \"six\", \"seven\", \"eight\", \"nine\", \"ten\",\n};\nstatic const struct typelen {\n\tconst char *type;\n\tint length;\n} typelen[] = {\n\t{ \"seconds\", 1 },\n\t{ \"minutes\", 60 },\n\t{ \"hours\", 60*60 },\n\t{ \"days\", 24*60*60 },\n\t{ \"weeks\", 7*24*60*60 },\n\t{ NULL }\n};\n\nstatic const char *approxidate_alpha(const char *date, struct tm *tm, struct tm *now, int *num, int *touched)\n{\n\tconst struct typelen *tl;\n\tconst struct special *s;\n\tconst char *end = date;\n\tint i;\n\n\twhile (isalpha(*++end))\n\t\t/* scan to non-alpha */;\n\n\tfor (i = 0; i < 12; i++) {\n\t\tsize_t match = match_string(date, month_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_mon = i;\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tfor (s = special; s->name; s++) {\n\t\tsize_t len = strlen(s->name);\n\t\tif (match_string(date, s->name) == len) {\n\t\t\ts->fn(tm, now, num);\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tif (!*num) {\n\t\tfor (i = 1; i < 11; i++) {\n\t\t\tsize_t len = strlen(number_name[i]);\n\t\t\tif (match_string(date, number_name[i]) == len) {\n\t\t\t\t*num = i;\n\t\t\t\t*touched = 1;\n\t\t\t\treturn end;\n\t\t\t}\n\t\t}\n\t\tif (match_string(date, \"last\") == 4) {\n\t\t\t*num = 1;\n\t\t\t*touched = 1;\n\t\t}\n\t\treturn end;\n\t}\n\n\ttl = typelen;\n\twhile (tl->type) {\n\t\tsize_t len = strlen(tl->type);\n\t\tif (match_string(date, tl->type) >= len-1) {\n\t\t\tupdate_tm(tm, now, tl->length * *num);\n\t\t\t*num = 0;\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t\ttl++;\n\t}\n\n\tfor (i = 0; i < 7; i++) {\n\t\tsize_t match = match_string(date, weekday_names[i]);\n\t\tif (match >= 3) {\n\t\t\tint diff, n = *num -1;\n\t\t\t*num = 0;\n\n\t\t\tdiff = tm->tm_wday - i;\n\t\t\tif (diff <= 0)\n\t\t\t\tn++;\n\t\t\tdiff += 7*n;\n\n\t\t\tupdate_tm(tm, now, diff * 24 * 60 * 60);\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tif (match_string(date, \"months\") >= 5) {\n\t\tint n;\n\t\tupdate_tm(tm, now, 0); /* fill in date fields if needed */\n\t\tn = tm->tm_mon - *num;\n\t\t*num = 0;\n\t\twhile (n < 0) {\n\t\t\tn += 12;\n\t\t\ttm->tm_year--;\n\t\t}\n\t\ttm->tm_mon = n;\n\t\t*touched = 1;\n\t\treturn end;\n\t}\n\n\tif (match_string(date, \"years\") >= 4) {\n\t\tupdate_tm(tm, now, 0); /* fill in date fields if needed */\n\t\ttm->tm_year -= *num;\n\t\t*num = 0;\n\t\t*touched = 1;\n\t\treturn end;\n\t}\n\n\treturn end;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "c"
          ],
          "line": 851
        },
        "resolved": true,
        "details": {
          "function_name": "git__isalpha",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "444-447",
          "snippet": "GIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}"
        }
      },
      {
        "call_info": {
          "callee": "approxidate_digit",
          "args": [
            "date-1",
            "&tm",
            "&number"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "approxidate_digit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "775-796",
          "snippet": "static const char *approxidate_digit(const char *date, struct tm *tm, int *num)\n{\n\tchar *end;\n\tunsigned long number = strtoul(date, &end, 10);\n\n\tswitch (*end) {\n\tcase ':':\n\tcase '.':\n\tcase '/':\n\tcase '-':\n\t\tif (isdigit(end[1])) {\n\t\t\tsize_t match = match_multi_number(number, *end, date, end, tm);\n\t\t\tif (match)\n\t\t\t\treturn date + match;\n\t\t}\n\t}\n\n\t/* Accept zero-padding only for small numbers (\"Dec 02\", never \"Dec 0002\") */\n\tif (date[0] != '0' || end - date <= 2)\n\t\t*num = number;\n\treturn end;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic const char *approxidate_digit(const char *date, struct tm *tm, int *num)\n{\n\tchar *end;\n\tunsigned long number = strtoul(date, &end, 10);\n\n\tswitch (*end) {\n\tcase ':':\n\tcase '.':\n\tcase '/':\n\tcase '-':\n\t\tif (isdigit(end[1])) {\n\t\t\tsize_t match = match_multi_number(number, *end, date, end, tm);\n\t\t\tif (match)\n\t\t\t\treturn date + match;\n\t\t}\n\t}\n\n\t/* Accept zero-padding only for small numbers (\"Dec 02\", never \"Dec 0002\") */\n\tif (date[0] != '0' || end - date <= 2)\n\t\t*num = number;\n\treturn end;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "c"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "git__isdigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "449-452",
          "snippet": "GIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_localtime_r",
          "args": [
            "&time_sec",
            "&tm"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "p_localtime_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "662-673",
          "snippet": "struct tm *\np_localtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = localtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nstruct tm *\np_localtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = localtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t approxidate_str(const char *date,\n\ttime_t time_sec,\n\tint *error_ret)\n{\n\tint number = 0;\n\tint touched = 0;\n\tstruct tm tm = {0}, now;\n\n\tp_localtime_r(&time_sec, &tm);\n\tnow = tm;\n\n\ttm.tm_year = -1;\n\ttm.tm_mon = -1;\n\ttm.tm_mday = -1;\n\n\tfor (;;) {\n\t\tunsigned char c = *date;\n\t\tif (!c)\n\t\t\tbreak;\n\t\tdate++;\n\t\tif (isdigit(c)) {\n\t\t\tpending_number(&tm, &number);\n\t\t\tdate = approxidate_digit(date-1, &tm, &number);\n\t\t\ttouched = 1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (isalpha(c))\n\t\t\tdate = approxidate_alpha(date-1, &tm, &now, &number, &touched);\n\t}\n\tpending_number(&tm, &number);\n\tif (!touched)\n\t\t*error_ret = 1;\n\treturn update_tm(&tm, &now, 0);\n}"
  },
  {
    "function_name": "pending_number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "803-823",
    "snippet": "static void pending_number(struct tm *tm, int *num)\n{\n\tint number = *num;\n\n\tif (number) {\n\t\t*num = 0;\n\t\tif (tm->tm_mday < 0 && number < 32)\n\t\t\ttm->tm_mday = number;\n\t\telse if (tm->tm_mon < 0 && number < 13)\n\t\t\ttm->tm_mon = number-1;\n\t\telse if (tm->tm_year < 0) {\n\t\t\tif (number > 1969 && number < 2100)\n\t\t\t\ttm->tm_year = number - 1900;\n\t\t\telse if (number > 69 && number < 100)\n\t\t\t\ttm->tm_year = number;\n\t\t\telse if (number < 38)\n\t\t\t\ttm->tm_year = 100 + number;\n\t\t\t/* We mess up for number = 00 ? */\n\t\t}\n\t}\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void pending_number(struct tm *tm, int *num)\n{\n\tint number = *num;\n\n\tif (number) {\n\t\t*num = 0;\n\t\tif (tm->tm_mday < 0 && number < 32)\n\t\t\ttm->tm_mday = number;\n\t\telse if (tm->tm_mon < 0 && number < 13)\n\t\t\ttm->tm_mon = number-1;\n\t\telse if (tm->tm_year < 0) {\n\t\t\tif (number > 1969 && number < 2100)\n\t\t\t\ttm->tm_year = number - 1900;\n\t\t\telse if (number > 69 && number < 100)\n\t\t\t\ttm->tm_year = number;\n\t\t\telse if (number < 38)\n\t\t\t\ttm->tm_year = 100 + number;\n\t\t\t/* We mess up for number = 00 ? */\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "approxidate_digit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "775-796",
    "snippet": "static const char *approxidate_digit(const char *date, struct tm *tm, int *num)\n{\n\tchar *end;\n\tunsigned long number = strtoul(date, &end, 10);\n\n\tswitch (*end) {\n\tcase ':':\n\tcase '.':\n\tcase '/':\n\tcase '-':\n\t\tif (isdigit(end[1])) {\n\t\t\tsize_t match = match_multi_number(number, *end, date, end, tm);\n\t\t\tif (match)\n\t\t\t\treturn date + match;\n\t\t}\n\t}\n\n\t/* Accept zero-padding only for small numbers (\"Dec 02\", never \"Dec 0002\") */\n\tif (date[0] != '0' || end - date <= 2)\n\t\t*num = number;\n\treturn end;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "match_multi_number",
          "args": [
            "number",
            "*end",
            "date",
            "end",
            "tm"
          ],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "match_multi_number",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "244-302",
          "snippet": "static size_t match_multi_number(unsigned long num, char c, const char *date, char *end, struct tm *tm)\n{\n\ttime_t now;\n\tstruct tm now_tm;\n\tstruct tm *refuse_future;\n\tlong num2, num3;\n\n\tnum2 = strtol(end+1, &end, 10);\n\tnum3 = -1;\n\tif (*end == c && isdigit(end[1]))\n\t\tnum3 = strtol(end+1, &end, 10);\n\n\t/* Time? Date? */\n\tswitch (c) {\n\tcase ':':\n\t\tif (num3 < 0)\n\t\t\tnum3 = 0;\n\t\tif (num < 25 && num2 >= 0 && num2 < 60 && num3 >= 0 && num3 <= 60) {\n\t\t\ttm->tm_hour = num;\n\t\t\ttm->tm_min = num2;\n\t\t\ttm->tm_sec = num3;\n\t\t\tbreak;\n\t\t}\n\t\treturn 0;\n\n\tcase '-':\n\tcase '/':\n\tcase '.':\n\t\tnow = time(NULL);\n\t\trefuse_future = NULL;\n\t\tif (p_gmtime_r(&now, &now_tm))\n\t\t\trefuse_future = &now_tm;\n\n\t\tif (num > 70) {\n\t\t\t/* yyyy-mm-dd? */\n\t\t\tif (is_date(num, num2, num3, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t\t/* yyyy-dd-mm? */\n\t\t\tif (is_date(num, num3, num2, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t}\n\t\t/* Our eastern European friends say dd.mm.yy[yy]\n\t\t * is the norm there, so giving precedence to\n\t\t * mm/dd/yy[yy] form only when separator is not '.'\n\t\t */\n\t\tif (c != '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* European dd.mm.yy[yy] or funny US dd/mm/yy[yy] */\n\t\tif (is_date(num3, num2, num, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* Funny European mm.dd.yy */\n\t\tif (c == '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn end - date;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic size_t match_multi_number(unsigned long num, char c, const char *date, char *end, struct tm *tm)\n{\n\ttime_t now;\n\tstruct tm now_tm;\n\tstruct tm *refuse_future;\n\tlong num2, num3;\n\n\tnum2 = strtol(end+1, &end, 10);\n\tnum3 = -1;\n\tif (*end == c && isdigit(end[1]))\n\t\tnum3 = strtol(end+1, &end, 10);\n\n\t/* Time? Date? */\n\tswitch (c) {\n\tcase ':':\n\t\tif (num3 < 0)\n\t\t\tnum3 = 0;\n\t\tif (num < 25 && num2 >= 0 && num2 < 60 && num3 >= 0 && num3 <= 60) {\n\t\t\ttm->tm_hour = num;\n\t\t\ttm->tm_min = num2;\n\t\t\ttm->tm_sec = num3;\n\t\t\tbreak;\n\t\t}\n\t\treturn 0;\n\n\tcase '-':\n\tcase '/':\n\tcase '.':\n\t\tnow = time(NULL);\n\t\trefuse_future = NULL;\n\t\tif (p_gmtime_r(&now, &now_tm))\n\t\t\trefuse_future = &now_tm;\n\n\t\tif (num > 70) {\n\t\t\t/* yyyy-mm-dd? */\n\t\t\tif (is_date(num, num2, num3, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t\t/* yyyy-dd-mm? */\n\t\t\tif (is_date(num, num3, num2, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t}\n\t\t/* Our eastern European friends say dd.mm.yy[yy]\n\t\t * is the norm there, so giving precedence to\n\t\t * mm/dd/yy[yy] form only when separator is not '.'\n\t\t */\n\t\tif (c != '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* European dd.mm.yy[yy] or funny US dd/mm/yy[yy] */\n\t\tif (is_date(num3, num2, num, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* Funny European mm.dd.yy */\n\t\tif (c == '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn end - date;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "end[1]"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "git__isdigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "449-452",
          "snippet": "GIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "date",
            "&end",
            "10"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic const char *approxidate_digit(const char *date, struct tm *tm, int *num)\n{\n\tchar *end;\n\tunsigned long number = strtoul(date, &end, 10);\n\n\tswitch (*end) {\n\tcase ':':\n\tcase '.':\n\tcase '/':\n\tcase '-':\n\t\tif (isdigit(end[1])) {\n\t\t\tsize_t match = match_multi_number(number, *end, date, end, tm);\n\t\t\tif (match)\n\t\t\t\treturn date + match;\n\t\t}\n\t}\n\n\t/* Accept zero-padding only for small numbers (\"Dec 02\", never \"Dec 0002\") */\n\tif (date[0] != '0' || end - date <= 2)\n\t\t*num = number;\n\treturn end;\n}"
  },
  {
    "function_name": "approxidate_alpha",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "677-773",
    "snippet": "static const char *approxidate_alpha(const char *date, struct tm *tm, struct tm *now, int *num, int *touched)\n{\n\tconst struct typelen *tl;\n\tconst struct special *s;\n\tconst char *end = date;\n\tint i;\n\n\twhile (isalpha(*++end))\n\t\t/* scan to non-alpha */;\n\n\tfor (i = 0; i < 12; i++) {\n\t\tsize_t match = match_string(date, month_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_mon = i;\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tfor (s = special; s->name; s++) {\n\t\tsize_t len = strlen(s->name);\n\t\tif (match_string(date, s->name) == len) {\n\t\t\ts->fn(tm, now, num);\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tif (!*num) {\n\t\tfor (i = 1; i < 11; i++) {\n\t\t\tsize_t len = strlen(number_name[i]);\n\t\t\tif (match_string(date, number_name[i]) == len) {\n\t\t\t\t*num = i;\n\t\t\t\t*touched = 1;\n\t\t\t\treturn end;\n\t\t\t}\n\t\t}\n\t\tif (match_string(date, \"last\") == 4) {\n\t\t\t*num = 1;\n\t\t\t*touched = 1;\n\t\t}\n\t\treturn end;\n\t}\n\n\ttl = typelen;\n\twhile (tl->type) {\n\t\tsize_t len = strlen(tl->type);\n\t\tif (match_string(date, tl->type) >= len-1) {\n\t\t\tupdate_tm(tm, now, tl->length * *num);\n\t\t\t*num = 0;\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t\ttl++;\n\t}\n\n\tfor (i = 0; i < 7; i++) {\n\t\tsize_t match = match_string(date, weekday_names[i]);\n\t\tif (match >= 3) {\n\t\t\tint diff, n = *num -1;\n\t\t\t*num = 0;\n\n\t\t\tdiff = tm->tm_wday - i;\n\t\t\tif (diff <= 0)\n\t\t\t\tn++;\n\t\t\tdiff += 7*n;\n\n\t\t\tupdate_tm(tm, now, diff * 24 * 60 * 60);\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tif (match_string(date, \"months\") >= 5) {\n\t\tint n;\n\t\tupdate_tm(tm, now, 0); /* fill in date fields if needed */\n\t\tn = tm->tm_mon - *num;\n\t\t*num = 0;\n\t\twhile (n < 0) {\n\t\t\tn += 12;\n\t\t\ttm->tm_year--;\n\t\t}\n\t\ttm->tm_mon = n;\n\t\t*touched = 1;\n\t\treturn end;\n\t}\n\n\tif (match_string(date, \"years\") >= 4) {\n\t\tupdate_tm(tm, now, 0); /* fill in date fields if needed */\n\t\ttm->tm_year -= *num;\n\t\t*num = 0;\n\t\t*touched = 1;\n\t\treturn end;\n\t}\n\n\treturn end;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};",
      "static const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};",
      "static const struct special {\n\tconst char *name;\n\tvoid (*fn)(struct tm *, struct tm *, int *);\n} special[] = {\n\t{ \"yesterday\", date_yesterday },\n\t{ \"noon\", date_noon },\n\t{ \"midnight\", date_midnight },\n\t{ \"tea\", date_tea },\n\t{ \"PM\", date_pm },\n\t{ \"AM\", date_am },\n\t{ \"never\", date_never },\n\t{ \"now\", date_now },\n\t{ NULL }\n};",
      "static const char *number_name[] = {\n\t\"zero\", \"one\", \"two\", \"three\", \"four\",\n\t\"five\", \"six\", \"seven\", \"eight\", \"nine\", \"ten\",\n};",
      "static const struct typelen {\n\tconst char *type;\n\tint length;\n} typelen[] = {\n\t{ \"seconds\", 1 },\n\t{ \"minutes\", 60 },\n\t{ \"hours\", 60*60 },\n\t{ \"days\", 24*60*60 },\n\t{ \"weeks\", 7*24*60*60 },\n\t{ NULL }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "update_tm",
          "args": [
            "tm",
            "now",
            "0"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "update_tm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "549-566",
          "snippet": "static git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_string",
          "args": [
            "date",
            "\"years\""
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "match_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "124-138",
          "snippet": "static size_t match_string(const char *date, const char *str)\n{\n\tsize_t i = 0;\n\n\tfor (i = 0; *date; date++, str++, i++) {\n\t\tif (*date == *str)\n\t\t\tcontinue;\n\t\tif (toupper(*date) == toupper(*str))\n\t\t\tcontinue;\n\t\tif (!isalnum(*date))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn i;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic size_t match_string(const char *date, const char *str)\n{\n\tsize_t i = 0;\n\n\tfor (i = 0; *date; date++, str++, i++) {\n\t\tif (*date == *str)\n\t\t\tcontinue;\n\t\tif (toupper(*date) == toupper(*str))\n\t\t\tcontinue;\n\t\tif (!isalnum(*date))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tl->type"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "number_name[i]"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s->fn",
          "args": [
            "tm",
            "now",
            "num"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s->name"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "*++end"
          ],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "git__isalpha",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "444-447",
          "snippet": "GIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};\nstatic const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};\nstatic const struct special {\n\tconst char *name;\n\tvoid (*fn)(struct tm *, struct tm *, int *);\n} special[] = {\n\t{ \"yesterday\", date_yesterday },\n\t{ \"noon\", date_noon },\n\t{ \"midnight\", date_midnight },\n\t{ \"tea\", date_tea },\n\t{ \"PM\", date_pm },\n\t{ \"AM\", date_am },\n\t{ \"never\", date_never },\n\t{ \"now\", date_now },\n\t{ NULL }\n};\nstatic const char *number_name[] = {\n\t\"zero\", \"one\", \"two\", \"three\", \"four\",\n\t\"five\", \"six\", \"seven\", \"eight\", \"nine\", \"ten\",\n};\nstatic const struct typelen {\n\tconst char *type;\n\tint length;\n} typelen[] = {\n\t{ \"seconds\", 1 },\n\t{ \"minutes\", 60 },\n\t{ \"hours\", 60*60 },\n\t{ \"days\", 24*60*60 },\n\t{ \"weeks\", 7*24*60*60 },\n\t{ NULL }\n};\n\nstatic const char *approxidate_alpha(const char *date, struct tm *tm, struct tm *now, int *num, int *touched)\n{\n\tconst struct typelen *tl;\n\tconst struct special *s;\n\tconst char *end = date;\n\tint i;\n\n\twhile (isalpha(*++end))\n\t\t/* scan to non-alpha */;\n\n\tfor (i = 0; i < 12; i++) {\n\t\tsize_t match = match_string(date, month_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_mon = i;\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tfor (s = special; s->name; s++) {\n\t\tsize_t len = strlen(s->name);\n\t\tif (match_string(date, s->name) == len) {\n\t\t\ts->fn(tm, now, num);\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tif (!*num) {\n\t\tfor (i = 1; i < 11; i++) {\n\t\t\tsize_t len = strlen(number_name[i]);\n\t\t\tif (match_string(date, number_name[i]) == len) {\n\t\t\t\t*num = i;\n\t\t\t\t*touched = 1;\n\t\t\t\treturn end;\n\t\t\t}\n\t\t}\n\t\tif (match_string(date, \"last\") == 4) {\n\t\t\t*num = 1;\n\t\t\t*touched = 1;\n\t\t}\n\t\treturn end;\n\t}\n\n\ttl = typelen;\n\twhile (tl->type) {\n\t\tsize_t len = strlen(tl->type);\n\t\tif (match_string(date, tl->type) >= len-1) {\n\t\t\tupdate_tm(tm, now, tl->length * *num);\n\t\t\t*num = 0;\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t\ttl++;\n\t}\n\n\tfor (i = 0; i < 7; i++) {\n\t\tsize_t match = match_string(date, weekday_names[i]);\n\t\tif (match >= 3) {\n\t\t\tint diff, n = *num -1;\n\t\t\t*num = 0;\n\n\t\t\tdiff = tm->tm_wday - i;\n\t\t\tif (diff <= 0)\n\t\t\t\tn++;\n\t\t\tdiff += 7*n;\n\n\t\t\tupdate_tm(tm, now, diff * 24 * 60 * 60);\n\t\t\t*touched = 1;\n\t\t\treturn end;\n\t\t}\n\t}\n\n\tif (match_string(date, \"months\") >= 5) {\n\t\tint n;\n\t\tupdate_tm(tm, now, 0); /* fill in date fields if needed */\n\t\tn = tm->tm_mon - *num;\n\t\t*num = 0;\n\t\twhile (n < 0) {\n\t\t\tn += 12;\n\t\t\ttm->tm_year--;\n\t\t}\n\t\ttm->tm_mon = n;\n\t\t*touched = 1;\n\t\treturn end;\n\t}\n\n\tif (match_string(date, \"years\") >= 4) {\n\t\tupdate_tm(tm, now, 0); /* fill in date fields if needed */\n\t\ttm->tm_year -= *num;\n\t\t*num = 0;\n\t\t*touched = 1;\n\t\treturn end;\n\t}\n\n\treturn end;\n}"
  },
  {
    "function_name": "date_never",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "637-643",
    "snippet": "static void date_never(struct tm *tm, struct tm *now, int *num)\n{\n\ttime_t n = 0;\n   GIT_UNUSED(now);\n   GIT_UNUSED(num);\n\tp_localtime_r(&n, tm);\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p_localtime_r",
          "args": [
            "&n",
            "tm"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "p_localtime_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "662-673",
          "snippet": "struct tm *\np_localtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = localtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nstruct tm *\np_localtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = localtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "num"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "now"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_never(struct tm *tm, struct tm *now, int *num)\n{\n\ttime_t n = 0;\n   GIT_UNUSED(now);\n   GIT_UNUSED(num);\n\tp_localtime_r(&n, tm);\n}"
  },
  {
    "function_name": "date_am",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "622-635",
    "snippet": "static void date_am(struct tm *tm, struct tm *now, int *num)\n{\n\tint hour, n = *num;\n\t*num = 0;\n   GIT_UNUSED(now);\n\n\thour = tm->tm_hour;\n\tif (n) {\n\t\thour = n;\n\t\ttm->tm_min = 0;\n\t\ttm->tm_sec = 0;\n\t}\n\ttm->tm_hour = (hour % 12);\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "now"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_am(struct tm *tm, struct tm *now, int *num)\n{\n\tint hour, n = *num;\n\t*num = 0;\n   GIT_UNUSED(now);\n\n\thour = tm->tm_hour;\n\tif (n) {\n\t\thour = n;\n\t\ttm->tm_min = 0;\n\t\ttm->tm_sec = 0;\n\t}\n\ttm->tm_hour = (hour % 12);\n}"
  },
  {
    "function_name": "date_pm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "607-620",
    "snippet": "static void date_pm(struct tm *tm, struct tm *now, int *num)\n{\n\tint hour, n = *num;\n\t*num = 0;\n   GIT_UNUSED(now);\n\n\thour = tm->tm_hour;\n\tif (n) {\n\t\thour = n;\n\t\ttm->tm_min = 0;\n\t\ttm->tm_sec = 0;\n\t}\n\ttm->tm_hour = (hour % 12) + 12;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "now"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_pm(struct tm *tm, struct tm *now, int *num)\n{\n\tint hour, n = *num;\n\t*num = 0;\n   GIT_UNUSED(now);\n\n\thour = tm->tm_hour;\n\tif (n) {\n\t\thour = n;\n\t\ttm->tm_min = 0;\n\t\ttm->tm_sec = 0;\n\t}\n\ttm->tm_hour = (hour % 12) + 12;\n}"
  },
  {
    "function_name": "date_tea",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "601-605",
    "snippet": "static void date_tea(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tdate_time(tm, now, 17);\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "date_time",
          "args": [
            "tm",
            "now",
            "17"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "date_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "580-587",
          "snippet": "static void date_time(struct tm *tm, struct tm *now, int hour)\n{\n\tif (tm->tm_hour < hour)\n\t\tdate_yesterday(tm, now, NULL);\n\ttm->tm_hour = hour;\n\ttm->tm_min = 0;\n\ttm->tm_sec = 0;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_time(struct tm *tm, struct tm *now, int hour)\n{\n\tif (tm->tm_hour < hour)\n\t\tdate_yesterday(tm, now, NULL);\n\ttm->tm_hour = hour;\n\ttm->tm_min = 0;\n\ttm->tm_sec = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "num"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_tea(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tdate_time(tm, now, 17);\n}"
  },
  {
    "function_name": "date_noon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "595-599",
    "snippet": "static void date_noon(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tdate_time(tm, now, 12);\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "date_time",
          "args": [
            "tm",
            "now",
            "12"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "date_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "580-587",
          "snippet": "static void date_time(struct tm *tm, struct tm *now, int hour)\n{\n\tif (tm->tm_hour < hour)\n\t\tdate_yesterday(tm, now, NULL);\n\ttm->tm_hour = hour;\n\ttm->tm_min = 0;\n\ttm->tm_sec = 0;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_time(struct tm *tm, struct tm *now, int hour)\n{\n\tif (tm->tm_hour < hour)\n\t\tdate_yesterday(tm, now, NULL);\n\ttm->tm_hour = hour;\n\ttm->tm_min = 0;\n\ttm->tm_sec = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "num"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_noon(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tdate_time(tm, now, 12);\n}"
  },
  {
    "function_name": "date_midnight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "589-593",
    "snippet": "static void date_midnight(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tdate_time(tm, now, 0);\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "date_time",
          "args": [
            "tm",
            "now",
            "0"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "date_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "580-587",
          "snippet": "static void date_time(struct tm *tm, struct tm *now, int hour)\n{\n\tif (tm->tm_hour < hour)\n\t\tdate_yesterday(tm, now, NULL);\n\ttm->tm_hour = hour;\n\ttm->tm_min = 0;\n\ttm->tm_sec = 0;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_time(struct tm *tm, struct tm *now, int hour)\n{\n\tif (tm->tm_hour < hour)\n\t\tdate_yesterday(tm, now, NULL);\n\ttm->tm_hour = hour;\n\ttm->tm_min = 0;\n\ttm->tm_sec = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "num"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_midnight(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tdate_time(tm, now, 0);\n}"
  },
  {
    "function_name": "date_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "580-587",
    "snippet": "static void date_time(struct tm *tm, struct tm *now, int hour)\n{\n\tif (tm->tm_hour < hour)\n\t\tdate_yesterday(tm, now, NULL);\n\ttm->tm_hour = hour;\n\ttm->tm_min = 0;\n\ttm->tm_sec = 0;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "date_yesterday",
          "args": [
            "tm",
            "now",
            "NULL"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "date_yesterday",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "574-578",
          "snippet": "static void date_yesterday(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tupdate_tm(tm, now, 24*60*60);\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_yesterday(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tupdate_tm(tm, now, 24*60*60);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_time(struct tm *tm, struct tm *now, int hour)\n{\n\tif (tm->tm_hour < hour)\n\t\tdate_yesterday(tm, now, NULL);\n\ttm->tm_hour = hour;\n\ttm->tm_min = 0;\n\ttm->tm_sec = 0;\n}"
  },
  {
    "function_name": "date_yesterday",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "574-578",
    "snippet": "static void date_yesterday(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tupdate_tm(tm, now, 24*60*60);\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "update_tm",
          "args": [
            "tm",
            "now",
            "24*60*60"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "update_tm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "549-566",
          "snippet": "static git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "num"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_yesterday(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tupdate_tm(tm, now, 24*60*60);\n}"
  },
  {
    "function_name": "date_now",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "568-572",
    "snippet": "static void date_now(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tupdate_tm(tm, now, 0);\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "update_tm",
          "args": [
            "tm",
            "now",
            "0"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "update_tm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "549-566",
          "snippet": "static git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "num"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic void date_now(struct tm *tm, struct tm *now, int *num)\n{\n   GIT_UNUSED(num);\n\tupdate_tm(tm, now, 0);\n}"
  },
  {
    "function_name": "update_tm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "549-566",
    "snippet": "static git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p_localtime_r",
          "args": [
            "&n",
            "tm"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "p_localtime_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "662-673",
          "snippet": "struct tm *\np_localtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = localtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nstruct tm *\np_localtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = localtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mktime",
          "args": [
            "tm"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t update_tm(struct tm *tm, struct tm *now, unsigned long sec)\n{\n\ttime_t n;\n\n\tif (tm->tm_mday < 0)\n\t\ttm->tm_mday = now->tm_mday;\n\tif (tm->tm_mon < 0)\n\t\ttm->tm_mon = now->tm_mon;\n\tif (tm->tm_year < 0) {\n\t\ttm->tm_year = now->tm_year;\n\t\tif (tm->tm_mon > now->tm_mon)\n\t\t\ttm->tm_year--;\n\t}\n\n\tn = mktime(tm) - sec;\n\tp_localtime_r(&n, tm);\n\treturn n;\n}"
  },
  {
    "function_name": "parse_date_basic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "482-542",
    "snippet": "static int parse_date_basic(const char *date, git_time_t *timestamp, int *offset)\n{\n\tstruct tm tm;\n\tint tm_gmt;\n\tgit_time_t dummy_timestamp;\n\tint dummy_offset;\n\n\tif (!timestamp)\n\t\ttimestamp = &dummy_timestamp;\n\tif (!offset)\n\t\toffset = &dummy_offset;\n\n\tmemset(&tm, 0, sizeof(tm));\n\ttm.tm_year = -1;\n\ttm.tm_mon = -1;\n\ttm.tm_mday = -1;\n\ttm.tm_isdst = -1;\n\ttm.tm_hour = -1;\n\ttm.tm_min = -1;\n\ttm.tm_sec = -1;\n\t*offset = -1;\n\ttm_gmt = 0;\n\n\tif (*date == '@' &&\n\t    !match_object_header_date(date + 1, timestamp, offset))\n\t\treturn 0; /* success */\n\tfor (;;) {\n\t\tsize_t match = 0;\n\t\tunsigned char c = *date;\n\n\t\t/* Stop at end of string or newline */\n\t\tif (!c || c == '\\n')\n\t\t\tbreak;\n\n\t\tif (isalpha(c))\n\t\t\tmatch = match_alpha(date, &tm, offset);\n\t\telse if (isdigit(c))\n\t\t\tmatch = match_digit(date, &tm, offset, &tm_gmt);\n\t\telse if ((c == '-' || c == '+') && isdigit(date[1]))\n\t\t\tmatch = match_tz(date, offset);\n\n\t\tif (!match) {\n\t\t\t/* BAD */\n\t\t\tmatch = 1;\n\t\t}\n\n\t\tdate += match;\n\t}\n\n\t/* mktime uses local timezone */\n\t*timestamp = tm_to_time_t(&tm);\n\tif (*offset == -1)\n\t\t*offset = (int)((time_t)*timestamp - mktime(&tm)) / 60;\n\n\tif (*timestamp == (git_time_t)-1)\n\t\treturn -1;\n\n\tif (!tm_gmt)\n\t\t*timestamp -= *offset * 60;\n\treturn 0; /* success */\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mktime",
          "args": [
            "&tm"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tm_to_time_t",
          "args": [
            "&tm"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "tm_to_time_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "33-52",
          "snippet": "static git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_tz",
          "args": [
            "date",
            "offset"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "match_tz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "416-451",
          "snippet": "static size_t match_tz(const char *date, int *offp)\n{\n\tchar *end;\n\tint hour = strtoul(date + 1, &end, 10);\n\tsize_t n = end - (date + 1);\n\tint min = 0;\n\n\tif (n == 4) {\n\t\t/* hhmm */\n\t\tmin = hour % 100;\n\t\thour = hour / 100;\n\t} else if (n != 2) {\n\t\tmin = 99; /* random stuff */\n\t} else if (*end == ':') {\n\t\t/* hh:mm? */\n\t\tmin = strtoul(end + 1, &end, 10);\n\t\tif (end - (date + 1) != 5)\n\t\t\tmin = 99; /* random stuff */\n\t} /* otherwise we parsed \"hh\" */\n\n\t/*\n\t * Don't accept any random stuff. Even though some places have\n\t * offset larger than 12 hours (e.g. Pacific/Kiritimati is at\n\t * UTC+14), there is something wrong if hour part is much\n\t * larger than that. We might also want to check that the\n\t * minutes are divisible by 15 or something too. (Offset of\n\t * Kathmandu, Nepal is UTC+5:45)\n\t */\n\tif (min < 60 && hour < 24) {\n\t\tint offset = hour * 60 + min;\n\t\tif (*date == '-')\n\t\t\toffset = -offset;\n\t\t*offp = offset;\n\t}\n\treturn end - date;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic size_t match_tz(const char *date, int *offp)\n{\n\tchar *end;\n\tint hour = strtoul(date + 1, &end, 10);\n\tsize_t n = end - (date + 1);\n\tint min = 0;\n\n\tif (n == 4) {\n\t\t/* hhmm */\n\t\tmin = hour % 100;\n\t\thour = hour / 100;\n\t} else if (n != 2) {\n\t\tmin = 99; /* random stuff */\n\t} else if (*end == ':') {\n\t\t/* hh:mm? */\n\t\tmin = strtoul(end + 1, &end, 10);\n\t\tif (end - (date + 1) != 5)\n\t\t\tmin = 99; /* random stuff */\n\t} /* otherwise we parsed \"hh\" */\n\n\t/*\n\t * Don't accept any random stuff. Even though some places have\n\t * offset larger than 12 hours (e.g. Pacific/Kiritimati is at\n\t * UTC+14), there is something wrong if hour part is much\n\t * larger than that. We might also want to check that the\n\t * minutes are divisible by 15 or something too. (Offset of\n\t * Kathmandu, Nepal is UTC+5:45)\n\t */\n\tif (min < 60 && hour < 24) {\n\t\tint offset = hour * 60 + min;\n\t\tif (*date == '-')\n\t\t\toffset = -offset;\n\t\t*offp = offset;\n\t}\n\treturn end - date;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "date[1]"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "git__isdigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "449-452",
          "snippet": "GIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_digit",
          "args": [
            "date",
            "&tm",
            "offset",
            "&tm_gmt"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "match_digit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "322-414",
          "snippet": "static size_t match_digit(const char *date, struct tm *tm, int *offset, int *tm_gmt)\n{\n\tsize_t n;\n\tchar *end;\n\tunsigned long num;\n\n\tnum = strtoul(date, &end, 10);\n\n\t/*\n\t * Seconds since 1970? We trigger on that for any numbers with\n\t * more than 8 digits. This is because we don't want to rule out\n\t * numbers like 20070606 as a YYYYMMDD date.\n\t */\n\tif (num >= 100000000 && nodate(tm)) {\n\t\ttime_t time = num;\n\t\tif (p_gmtime_r(&time, tm)) {\n\t\t\t*tm_gmt = 1;\n\t\t\treturn end - date;\n\t\t}\n\t}\n\n\t/*\n\t * Check for special formats: num[-.:/]num[same]num\n\t */\n\tswitch (*end) {\n\tcase ':':\n\tcase '.':\n\tcase '/':\n\tcase '-':\n\t\tif (isdigit(end[1])) {\n\t\t\tsize_t match = match_multi_number(num, *end, date, end, tm);\n\t\t\tif (match)\n\t\t\t\treturn match;\n\t\t}\n\t}\n\n\t/*\n\t * None of the special formats? Try to guess what\n\t * the number meant. We use the number of digits\n\t * to make a more educated guess..\n\t */\n\tn = 0;\n\tdo {\n\t\tn++;\n\t} while (isdigit(date[n]));\n\n\t/* Four-digit year or a timezone? */\n\tif (n == 4) {\n\t\tif (num <= 1400 && *offset == -1) {\n\t\t\tunsigned int minutes = num % 100;\n\t\t\tunsigned int hours = num / 100;\n\t\t\t*offset = hours*60 + minutes;\n\t\t} else if (num > 1900 && num < 2100)\n\t\t\ttm->tm_year = num - 1900;\n\t\treturn n;\n\t}\n\n\t/*\n\t * Ignore lots of numerals. We took care of 4-digit years above.\n\t * Days or months must be one or two digits.\n\t */\n\tif (n > 2)\n\t\treturn n;\n\n\t/*\n\t * NOTE! We will give precedence to day-of-month over month or\n\t * year numbers in the 1-12 range. So 05 is always \"mday 5\",\n\t * unless we already have a mday..\n\t *\n\t * IOW, 01 Apr 05 parses as \"April 1st, 2005\".\n\t */\n\tif (num > 0 && num < 32 && tm->tm_mday < 0) {\n\t\ttm->tm_mday = num;\n\t\treturn n;\n\t}\n\n\t/* Two-digit year? */\n\tif (n == 2 && tm->tm_year < 0) {\n\t\tif (num < 10 && tm->tm_mday >= 0) {\n\t\t\ttm->tm_year = num + 100;\n\t\t\treturn n;\n\t\t}\n\t\tif (num >= 70) {\n\t\t\ttm->tm_year = num;\n\t\t\treturn n;\n\t\t}\n\t}\n\n\tif (num > 0 && num < 13 && tm->tm_mon < 0)\n\t\ttm->tm_mon = num-1;\n\n\treturn n;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct special {\n\tconst char *name;\n\tvoid (*fn)(struct tm *, struct tm *, int *);\n} special[] = {\n\t{ \"yesterday\", date_yesterday },\n\t{ \"noon\", date_noon },\n\t{ \"midnight\", date_midnight },\n\t{ \"tea\", date_tea },\n\t{ \"PM\", date_pm },\n\t{ \"AM\", date_am },\n\t{ \"never\", date_never },\n\t{ \"now\", date_now },\n\t{ NULL }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic const struct special {\n\tconst char *name;\n\tvoid (*fn)(struct tm *, struct tm *, int *);\n} special[] = {\n\t{ \"yesterday\", date_yesterday },\n\t{ \"noon\", date_noon },\n\t{ \"midnight\", date_midnight },\n\t{ \"tea\", date_tea },\n\t{ \"PM\", date_pm },\n\t{ \"AM\", date_am },\n\t{ \"never\", date_never },\n\t{ \"now\", date_now },\n\t{ NULL }\n};\n\nstatic size_t match_digit(const char *date, struct tm *tm, int *offset, int *tm_gmt)\n{\n\tsize_t n;\n\tchar *end;\n\tunsigned long num;\n\n\tnum = strtoul(date, &end, 10);\n\n\t/*\n\t * Seconds since 1970? We trigger on that for any numbers with\n\t * more than 8 digits. This is because we don't want to rule out\n\t * numbers like 20070606 as a YYYYMMDD date.\n\t */\n\tif (num >= 100000000 && nodate(tm)) {\n\t\ttime_t time = num;\n\t\tif (p_gmtime_r(&time, tm)) {\n\t\t\t*tm_gmt = 1;\n\t\t\treturn end - date;\n\t\t}\n\t}\n\n\t/*\n\t * Check for special formats: num[-.:/]num[same]num\n\t */\n\tswitch (*end) {\n\tcase ':':\n\tcase '.':\n\tcase '/':\n\tcase '-':\n\t\tif (isdigit(end[1])) {\n\t\t\tsize_t match = match_multi_number(num, *end, date, end, tm);\n\t\t\tif (match)\n\t\t\t\treturn match;\n\t\t}\n\t}\n\n\t/*\n\t * None of the special formats? Try to guess what\n\t * the number meant. We use the number of digits\n\t * to make a more educated guess..\n\t */\n\tn = 0;\n\tdo {\n\t\tn++;\n\t} while (isdigit(date[n]));\n\n\t/* Four-digit year or a timezone? */\n\tif (n == 4) {\n\t\tif (num <= 1400 && *offset == -1) {\n\t\t\tunsigned int minutes = num % 100;\n\t\t\tunsigned int hours = num / 100;\n\t\t\t*offset = hours*60 + minutes;\n\t\t} else if (num > 1900 && num < 2100)\n\t\t\ttm->tm_year = num - 1900;\n\t\treturn n;\n\t}\n\n\t/*\n\t * Ignore lots of numerals. We took care of 4-digit years above.\n\t * Days or months must be one or two digits.\n\t */\n\tif (n > 2)\n\t\treturn n;\n\n\t/*\n\t * NOTE! We will give precedence to day-of-month over month or\n\t * year numbers in the 1-12 range. So 05 is always \"mday 5\",\n\t * unless we already have a mday..\n\t *\n\t * IOW, 01 Apr 05 parses as \"April 1st, 2005\".\n\t */\n\tif (num > 0 && num < 32 && tm->tm_mday < 0) {\n\t\ttm->tm_mday = num;\n\t\treturn n;\n\t}\n\n\t/* Two-digit year? */\n\tif (n == 2 && tm->tm_year < 0) {\n\t\tif (num < 10 && tm->tm_mday >= 0) {\n\t\t\ttm->tm_year = num + 100;\n\t\t\treturn n;\n\t\t}\n\t\tif (num >= 70) {\n\t\t\ttm->tm_year = num;\n\t\t\treturn n;\n\t\t}\n\t}\n\n\tif (num > 0 && num < 13 && tm->tm_mon < 0)\n\t\ttm->tm_mon = num-1;\n\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_alpha",
          "args": [
            "date",
            "&tm",
            "offset"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "match_alpha",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "152-200",
          "snippet": "static size_t match_alpha(const char *date, struct tm *tm, int *offset)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < 12; i++) {\n\t\tsize_t match = match_string(date, month_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_mon = i;\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tfor (i = 0; i < 7; i++) {\n\t\tsize_t match = match_string(date, weekday_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_wday = i;\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(timezone_names); i++) {\n\t\tsize_t match = match_string(date, timezone_names[i].name);\n\t\tif (match >= 3 || match == strlen(timezone_names[i].name)) {\n\t\t\tint off = timezone_names[i].offset;\n\n\t\t\t/* This is bogus, but we like summer */\n\t\t\toff += timezone_names[i].dst;\n\n\t\t\t/* Only use the tz name offset if we don't have anything better */\n\t\t\tif (*offset == -1)\n\t\t\t\t*offset = 60*off;\n\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tif (match_string(date, \"PM\") == 2) {\n\t\ttm->tm_hour = (tm->tm_hour % 12) + 12;\n\t\treturn 2;\n\t}\n\n\tif (match_string(date, \"AM\") == 2) {\n\t\ttm->tm_hour = (tm->tm_hour % 12) + 0;\n\t\treturn 2;\n\t}\n\n\t/* BAD */\n\treturn skip_alpha(date);\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};",
            "static const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};",
            "static const struct {\n\tconst char *name;\n\tint offset;\n\tint dst;\n} timezone_names[] = {\n\t{ \"IDLW\", -12, 0, },\t/* International Date Line West */\n\t{ \"NT\",   -11, 0, },\t/* Nome */\n\t{ \"CAT\",  -10, 0, },\t/* Central Alaska */\n\t{ \"HST\",  -10, 0, },\t/* Hawaii Standard */\n\t{ \"HDT\",  -10, 1, },\t/* Hawaii Daylight */\n\t{ \"YST\",   -9, 0, },\t/* Yukon Standard */\n\t{ \"YDT\",   -9, 1, },\t/* Yukon Daylight */\n\t{ \"PST\",   -8, 0, },\t/* Pacific Standard */\n\t{ \"PDT\",   -8, 1, },\t/* Pacific Daylight */\n\t{ \"MST\",   -7, 0, },\t/* Mountain Standard */\n\t{ \"MDT\",   -7, 1, },\t/* Mountain Daylight */\n\t{ \"CST\",   -6, 0, },\t/* Central Standard */\n\t{ \"CDT\",   -6, 1, },\t/* Central Daylight */\n\t{ \"EST\",   -5, 0, },\t/* Eastern Standard */\n\t{ \"EDT\",   -5, 1, },\t/* Eastern Daylight */\n\t{ \"AST\",   -3, 0, },\t/* Atlantic Standard */\n\t{ \"ADT\",   -3, 1, },\t/* Atlantic Daylight */\n\t{ \"WAT\",   -1, 0, },\t/* West Africa */\n\n\t{ \"GMT\",    0, 0, },\t/* Greenwich Mean */\n\t{ \"UTC\",    0, 0, },\t/* Universal (Coordinated) */\n\t{ \"Z\",      0, 0, },    /* Zulu, alias for UTC */\n\n\t{ \"WET\",    0, 0, },\t/* Western European */\n\t{ \"BST\",    0, 1, },\t/* British Summer */\n\t{ \"CET\",   +1, 0, },\t/* Central European */\n\t{ \"MET\",   +1, 0, },\t/* Middle European */\n\t{ \"MEWT\",  +1, 0, },\t/* Middle European Winter */\n\t{ \"MEST\",  +1, 1, },\t/* Middle European Summer */\n\t{ \"CEST\",  +1, 1, },\t/* Central European Summer */\n\t{ \"MESZ\",  +1, 1, },\t/* Middle European Summer */\n\t{ \"FWT\",   +1, 0, },\t/* French Winter */\n\t{ \"FST\",   +1, 1, },\t/* French Summer */\n\t{ \"EET\",   +2, 0, },\t/* Eastern Europe */\n\t{ \"EEST\",  +2, 1, },\t/* Eastern European Daylight */\n\t{ \"WAST\",  +7, 0, },\t/* West Australian Standard */\n\t{ \"WADT\",  +7, 1, },\t/* West Australian Daylight */\n\t{ \"CCT\",   +8, 0, },\t/* China Coast */\n\t{ \"JST\",   +9, 0, },\t/* Japan Standard */\n\t{ \"EAST\", +10, 0, },\t/* Eastern Australian Standard */\n\t{ \"EADT\", +10, 1, },\t/* Eastern Australian Daylight */\n\t{ \"GST\",  +10, 0, },\t/* Guam Standard */\n\t{ \"NZT\",  +12, 0, },\t/* New Zealand */\n\t{ \"NZST\", +12, 0, },\t/* New Zealand Standard */\n\t{ \"NZDT\", +12, 1, },\t/* New Zealand Daylight */\n\t{ \"IDLE\", +12, 0, },\t/* International Date Line East */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};\nstatic const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};\nstatic const struct {\n\tconst char *name;\n\tint offset;\n\tint dst;\n} timezone_names[] = {\n\t{ \"IDLW\", -12, 0, },\t/* International Date Line West */\n\t{ \"NT\",   -11, 0, },\t/* Nome */\n\t{ \"CAT\",  -10, 0, },\t/* Central Alaska */\n\t{ \"HST\",  -10, 0, },\t/* Hawaii Standard */\n\t{ \"HDT\",  -10, 1, },\t/* Hawaii Daylight */\n\t{ \"YST\",   -9, 0, },\t/* Yukon Standard */\n\t{ \"YDT\",   -9, 1, },\t/* Yukon Daylight */\n\t{ \"PST\",   -8, 0, },\t/* Pacific Standard */\n\t{ \"PDT\",   -8, 1, },\t/* Pacific Daylight */\n\t{ \"MST\",   -7, 0, },\t/* Mountain Standard */\n\t{ \"MDT\",   -7, 1, },\t/* Mountain Daylight */\n\t{ \"CST\",   -6, 0, },\t/* Central Standard */\n\t{ \"CDT\",   -6, 1, },\t/* Central Daylight */\n\t{ \"EST\",   -5, 0, },\t/* Eastern Standard */\n\t{ \"EDT\",   -5, 1, },\t/* Eastern Daylight */\n\t{ \"AST\",   -3, 0, },\t/* Atlantic Standard */\n\t{ \"ADT\",   -3, 1, },\t/* Atlantic Daylight */\n\t{ \"WAT\",   -1, 0, },\t/* West Africa */\n\n\t{ \"GMT\",    0, 0, },\t/* Greenwich Mean */\n\t{ \"UTC\",    0, 0, },\t/* Universal (Coordinated) */\n\t{ \"Z\",      0, 0, },    /* Zulu, alias for UTC */\n\n\t{ \"WET\",    0, 0, },\t/* Western European */\n\t{ \"BST\",    0, 1, },\t/* British Summer */\n\t{ \"CET\",   +1, 0, },\t/* Central European */\n\t{ \"MET\",   +1, 0, },\t/* Middle European */\n\t{ \"MEWT\",  +1, 0, },\t/* Middle European Winter */\n\t{ \"MEST\",  +1, 1, },\t/* Middle European Summer */\n\t{ \"CEST\",  +1, 1, },\t/* Central European Summer */\n\t{ \"MESZ\",  +1, 1, },\t/* Middle European Summer */\n\t{ \"FWT\",   +1, 0, },\t/* French Winter */\n\t{ \"FST\",   +1, 1, },\t/* French Summer */\n\t{ \"EET\",   +2, 0, },\t/* Eastern Europe */\n\t{ \"EEST\",  +2, 1, },\t/* Eastern European Daylight */\n\t{ \"WAST\",  +7, 0, },\t/* West Australian Standard */\n\t{ \"WADT\",  +7, 1, },\t/* West Australian Daylight */\n\t{ \"CCT\",   +8, 0, },\t/* China Coast */\n\t{ \"JST\",   +9, 0, },\t/* Japan Standard */\n\t{ \"EAST\", +10, 0, },\t/* Eastern Australian Standard */\n\t{ \"EADT\", +10, 1, },\t/* Eastern Australian Daylight */\n\t{ \"GST\",  +10, 0, },\t/* Guam Standard */\n\t{ \"NZT\",  +12, 0, },\t/* New Zealand */\n\t{ \"NZST\", +12, 0, },\t/* New Zealand Standard */\n\t{ \"NZDT\", +12, 1, },\t/* New Zealand Daylight */\n\t{ \"IDLE\", +12, 0, },\t/* International Date Line East */\n};\n\nstatic size_t match_alpha(const char *date, struct tm *tm, int *offset)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < 12; i++) {\n\t\tsize_t match = match_string(date, month_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_mon = i;\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tfor (i = 0; i < 7; i++) {\n\t\tsize_t match = match_string(date, weekday_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_wday = i;\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(timezone_names); i++) {\n\t\tsize_t match = match_string(date, timezone_names[i].name);\n\t\tif (match >= 3 || match == strlen(timezone_names[i].name)) {\n\t\t\tint off = timezone_names[i].offset;\n\n\t\t\t/* This is bogus, but we like summer */\n\t\t\toff += timezone_names[i].dst;\n\n\t\t\t/* Only use the tz name offset if we don't have anything better */\n\t\t\tif (*offset == -1)\n\t\t\t\t*offset = 60*off;\n\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tif (match_string(date, \"PM\") == 2) {\n\t\ttm->tm_hour = (tm->tm_hour % 12) + 12;\n\t\treturn 2;\n\t}\n\n\tif (match_string(date, \"AM\") == 2) {\n\t\ttm->tm_hour = (tm->tm_hour % 12) + 0;\n\t\treturn 2;\n\t}\n\n\t/* BAD */\n\treturn skip_alpha(date);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "c"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "git__isalpha",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "444-447",
          "snippet": "GIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_object_header_date",
          "args": [
            "date + 1",
            "timestamp",
            "offset"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "match_object_header_date",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "457-478",
          "snippet": "static int match_object_header_date(const char *date, git_time_t *timestamp, int *offset)\n{\n\tchar *end;\n\tunsigned long stamp;\n\tint ofs;\n\n\tif (*date < '0' || '9' <= *date)\n\t\treturn -1;\n\tstamp = strtoul(date, &end, 10);\n\tif (*end != ' ' || stamp == ULONG_MAX || (end[1] != '+' && end[1] != '-'))\n\t\treturn -1;\n\tdate = end + 2;\n\tofs = strtol(date, &end, 10);\n\tif ((*end != '\\0' && (*end != '\\n')) || end != date + 4)\n\t\treturn -1;\n\tofs = (ofs / 100) * 60 + (ofs % 100);\n\tif (date[-1] == '-')\n\t\tofs = -ofs;\n\t*timestamp = stamp;\n\t*offset = ofs;\n\treturn 0;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int match_object_header_date(const char *date, git_time_t *timestamp, int *offset)\n{\n\tchar *end;\n\tunsigned long stamp;\n\tint ofs;\n\n\tif (*date < '0' || '9' <= *date)\n\t\treturn -1;\n\tstamp = strtoul(date, &end, 10);\n\tif (*end != ' ' || stamp == ULONG_MAX || (end[1] != '+' && end[1] != '-'))\n\t\treturn -1;\n\tdate = end + 2;\n\tofs = strtol(date, &end, 10);\n\tif ((*end != '\\0' && (*end != '\\n')) || end != date + 4)\n\t\treturn -1;\n\tofs = (ofs / 100) * 60 + (ofs % 100);\n\tif (date[-1] == '-')\n\t\tofs = -ofs;\n\t*timestamp = stamp;\n\t*offset = ofs;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&tm",
            "0",
            "sizeof(tm)"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int parse_date_basic(const char *date, git_time_t *timestamp, int *offset)\n{\n\tstruct tm tm;\n\tint tm_gmt;\n\tgit_time_t dummy_timestamp;\n\tint dummy_offset;\n\n\tif (!timestamp)\n\t\ttimestamp = &dummy_timestamp;\n\tif (!offset)\n\t\toffset = &dummy_offset;\n\n\tmemset(&tm, 0, sizeof(tm));\n\ttm.tm_year = -1;\n\ttm.tm_mon = -1;\n\ttm.tm_mday = -1;\n\ttm.tm_isdst = -1;\n\ttm.tm_hour = -1;\n\ttm.tm_min = -1;\n\ttm.tm_sec = -1;\n\t*offset = -1;\n\ttm_gmt = 0;\n\n\tif (*date == '@' &&\n\t    !match_object_header_date(date + 1, timestamp, offset))\n\t\treturn 0; /* success */\n\tfor (;;) {\n\t\tsize_t match = 0;\n\t\tunsigned char c = *date;\n\n\t\t/* Stop at end of string or newline */\n\t\tif (!c || c == '\\n')\n\t\t\tbreak;\n\n\t\tif (isalpha(c))\n\t\t\tmatch = match_alpha(date, &tm, offset);\n\t\telse if (isdigit(c))\n\t\t\tmatch = match_digit(date, &tm, offset, &tm_gmt);\n\t\telse if ((c == '-' || c == '+') && isdigit(date[1]))\n\t\t\tmatch = match_tz(date, offset);\n\n\t\tif (!match) {\n\t\t\t/* BAD */\n\t\t\tmatch = 1;\n\t\t}\n\n\t\tdate += match;\n\t}\n\n\t/* mktime uses local timezone */\n\t*timestamp = tm_to_time_t(&tm);\n\tif (*offset == -1)\n\t\t*offset = (int)((time_t)*timestamp - mktime(&tm)) / 60;\n\n\tif (*timestamp == (git_time_t)-1)\n\t\treturn -1;\n\n\tif (!tm_gmt)\n\t\t*timestamp -= *offset * 60;\n\treturn 0; /* success */\n}"
  },
  {
    "function_name": "match_object_header_date",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "457-478",
    "snippet": "static int match_object_header_date(const char *date, git_time_t *timestamp, int *offset)\n{\n\tchar *end;\n\tunsigned long stamp;\n\tint ofs;\n\n\tif (*date < '0' || '9' <= *date)\n\t\treturn -1;\n\tstamp = strtoul(date, &end, 10);\n\tif (*end != ' ' || stamp == ULONG_MAX || (end[1] != '+' && end[1] != '-'))\n\t\treturn -1;\n\tdate = end + 2;\n\tofs = strtol(date, &end, 10);\n\tif ((*end != '\\0' && (*end != '\\n')) || end != date + 4)\n\t\treturn -1;\n\tofs = (ofs / 100) * 60 + (ofs % 100);\n\tif (date[-1] == '-')\n\t\tofs = -ofs;\n\t*timestamp = stamp;\n\t*offset = ofs;\n\treturn 0;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "date",
            "&end",
            "10"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "date",
            "&end",
            "10"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int match_object_header_date(const char *date, git_time_t *timestamp, int *offset)\n{\n\tchar *end;\n\tunsigned long stamp;\n\tint ofs;\n\n\tif (*date < '0' || '9' <= *date)\n\t\treturn -1;\n\tstamp = strtoul(date, &end, 10);\n\tif (*end != ' ' || stamp == ULONG_MAX || (end[1] != '+' && end[1] != '-'))\n\t\treturn -1;\n\tdate = end + 2;\n\tofs = strtol(date, &end, 10);\n\tif ((*end != '\\0' && (*end != '\\n')) || end != date + 4)\n\t\treturn -1;\n\tofs = (ofs / 100) * 60 + (ofs % 100);\n\tif (date[-1] == '-')\n\t\tofs = -ofs;\n\t*timestamp = stamp;\n\t*offset = ofs;\n\treturn 0;\n}"
  },
  {
    "function_name": "match_tz",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "416-451",
    "snippet": "static size_t match_tz(const char *date, int *offp)\n{\n\tchar *end;\n\tint hour = strtoul(date + 1, &end, 10);\n\tsize_t n = end - (date + 1);\n\tint min = 0;\n\n\tif (n == 4) {\n\t\t/* hhmm */\n\t\tmin = hour % 100;\n\t\thour = hour / 100;\n\t} else if (n != 2) {\n\t\tmin = 99; /* random stuff */\n\t} else if (*end == ':') {\n\t\t/* hh:mm? */\n\t\tmin = strtoul(end + 1, &end, 10);\n\t\tif (end - (date + 1) != 5)\n\t\t\tmin = 99; /* random stuff */\n\t} /* otherwise we parsed \"hh\" */\n\n\t/*\n\t * Don't accept any random stuff. Even though some places have\n\t * offset larger than 12 hours (e.g. Pacific/Kiritimati is at\n\t * UTC+14), there is something wrong if hour part is much\n\t * larger than that. We might also want to check that the\n\t * minutes are divisible by 15 or something too. (Offset of\n\t * Kathmandu, Nepal is UTC+5:45)\n\t */\n\tif (min < 60 && hour < 24) {\n\t\tint offset = hour * 60 + min;\n\t\tif (*date == '-')\n\t\t\toffset = -offset;\n\t\t*offp = offset;\n\t}\n\treturn end - date;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "end + 1",
            "&end",
            "10"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "date + 1",
            "&end",
            "10"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic size_t match_tz(const char *date, int *offp)\n{\n\tchar *end;\n\tint hour = strtoul(date + 1, &end, 10);\n\tsize_t n = end - (date + 1);\n\tint min = 0;\n\n\tif (n == 4) {\n\t\t/* hhmm */\n\t\tmin = hour % 100;\n\t\thour = hour / 100;\n\t} else if (n != 2) {\n\t\tmin = 99; /* random stuff */\n\t} else if (*end == ':') {\n\t\t/* hh:mm? */\n\t\tmin = strtoul(end + 1, &end, 10);\n\t\tif (end - (date + 1) != 5)\n\t\t\tmin = 99; /* random stuff */\n\t} /* otherwise we parsed \"hh\" */\n\n\t/*\n\t * Don't accept any random stuff. Even though some places have\n\t * offset larger than 12 hours (e.g. Pacific/Kiritimati is at\n\t * UTC+14), there is something wrong if hour part is much\n\t * larger than that. We might also want to check that the\n\t * minutes are divisible by 15 or something too. (Offset of\n\t * Kathmandu, Nepal is UTC+5:45)\n\t */\n\tif (min < 60 && hour < 24) {\n\t\tint offset = hour * 60 + min;\n\t\tif (*date == '-')\n\t\t\toffset = -offset;\n\t\t*offp = offset;\n\t}\n\treturn end - date;\n}"
  },
  {
    "function_name": "match_digit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "322-414",
    "snippet": "static size_t match_digit(const char *date, struct tm *tm, int *offset, int *tm_gmt)\n{\n\tsize_t n;\n\tchar *end;\n\tunsigned long num;\n\n\tnum = strtoul(date, &end, 10);\n\n\t/*\n\t * Seconds since 1970? We trigger on that for any numbers with\n\t * more than 8 digits. This is because we don't want to rule out\n\t * numbers like 20070606 as a YYYYMMDD date.\n\t */\n\tif (num >= 100000000 && nodate(tm)) {\n\t\ttime_t time = num;\n\t\tif (p_gmtime_r(&time, tm)) {\n\t\t\t*tm_gmt = 1;\n\t\t\treturn end - date;\n\t\t}\n\t}\n\n\t/*\n\t * Check for special formats: num[-.:/]num[same]num\n\t */\n\tswitch (*end) {\n\tcase ':':\n\tcase '.':\n\tcase '/':\n\tcase '-':\n\t\tif (isdigit(end[1])) {\n\t\t\tsize_t match = match_multi_number(num, *end, date, end, tm);\n\t\t\tif (match)\n\t\t\t\treturn match;\n\t\t}\n\t}\n\n\t/*\n\t * None of the special formats? Try to guess what\n\t * the number meant. We use the number of digits\n\t * to make a more educated guess..\n\t */\n\tn = 0;\n\tdo {\n\t\tn++;\n\t} while (isdigit(date[n]));\n\n\t/* Four-digit year or a timezone? */\n\tif (n == 4) {\n\t\tif (num <= 1400 && *offset == -1) {\n\t\t\tunsigned int minutes = num % 100;\n\t\t\tunsigned int hours = num / 100;\n\t\t\t*offset = hours*60 + minutes;\n\t\t} else if (num > 1900 && num < 2100)\n\t\t\ttm->tm_year = num - 1900;\n\t\treturn n;\n\t}\n\n\t/*\n\t * Ignore lots of numerals. We took care of 4-digit years above.\n\t * Days or months must be one or two digits.\n\t */\n\tif (n > 2)\n\t\treturn n;\n\n\t/*\n\t * NOTE! We will give precedence to day-of-month over month or\n\t * year numbers in the 1-12 range. So 05 is always \"mday 5\",\n\t * unless we already have a mday..\n\t *\n\t * IOW, 01 Apr 05 parses as \"April 1st, 2005\".\n\t */\n\tif (num > 0 && num < 32 && tm->tm_mday < 0) {\n\t\ttm->tm_mday = num;\n\t\treturn n;\n\t}\n\n\t/* Two-digit year? */\n\tif (n == 2 && tm->tm_year < 0) {\n\t\tif (num < 10 && tm->tm_mday >= 0) {\n\t\t\ttm->tm_year = num + 100;\n\t\t\treturn n;\n\t\t}\n\t\tif (num >= 70) {\n\t\t\ttm->tm_year = num;\n\t\t\treturn n;\n\t\t}\n\t}\n\n\tif (num > 0 && num < 13 && tm->tm_mon < 0)\n\t\ttm->tm_mon = num-1;\n\n\treturn n;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct special {\n\tconst char *name;\n\tvoid (*fn)(struct tm *, struct tm *, int *);\n} special[] = {\n\t{ \"yesterday\", date_yesterday },\n\t{ \"noon\", date_noon },\n\t{ \"midnight\", date_midnight },\n\t{ \"tea\", date_tea },\n\t{ \"PM\", date_pm },\n\t{ \"AM\", date_am },\n\t{ \"never\", date_never },\n\t{ \"now\", date_now },\n\t{ NULL }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "date[n]"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "git__isdigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "449-452",
          "snippet": "GIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_multi_number",
          "args": [
            "num",
            "*end",
            "date",
            "end",
            "tm"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "match_multi_number",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "244-302",
          "snippet": "static size_t match_multi_number(unsigned long num, char c, const char *date, char *end, struct tm *tm)\n{\n\ttime_t now;\n\tstruct tm now_tm;\n\tstruct tm *refuse_future;\n\tlong num2, num3;\n\n\tnum2 = strtol(end+1, &end, 10);\n\tnum3 = -1;\n\tif (*end == c && isdigit(end[1]))\n\t\tnum3 = strtol(end+1, &end, 10);\n\n\t/* Time? Date? */\n\tswitch (c) {\n\tcase ':':\n\t\tif (num3 < 0)\n\t\t\tnum3 = 0;\n\t\tif (num < 25 && num2 >= 0 && num2 < 60 && num3 >= 0 && num3 <= 60) {\n\t\t\ttm->tm_hour = num;\n\t\t\ttm->tm_min = num2;\n\t\t\ttm->tm_sec = num3;\n\t\t\tbreak;\n\t\t}\n\t\treturn 0;\n\n\tcase '-':\n\tcase '/':\n\tcase '.':\n\t\tnow = time(NULL);\n\t\trefuse_future = NULL;\n\t\tif (p_gmtime_r(&now, &now_tm))\n\t\t\trefuse_future = &now_tm;\n\n\t\tif (num > 70) {\n\t\t\t/* yyyy-mm-dd? */\n\t\t\tif (is_date(num, num2, num3, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t\t/* yyyy-dd-mm? */\n\t\t\tif (is_date(num, num3, num2, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t}\n\t\t/* Our eastern European friends say dd.mm.yy[yy]\n\t\t * is the norm there, so giving precedence to\n\t\t * mm/dd/yy[yy] form only when separator is not '.'\n\t\t */\n\t\tif (c != '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* European dd.mm.yy[yy] or funny US dd/mm/yy[yy] */\n\t\tif (is_date(num3, num2, num, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* Funny European mm.dd.yy */\n\t\tif (c == '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn end - date;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic size_t match_multi_number(unsigned long num, char c, const char *date, char *end, struct tm *tm)\n{\n\ttime_t now;\n\tstruct tm now_tm;\n\tstruct tm *refuse_future;\n\tlong num2, num3;\n\n\tnum2 = strtol(end+1, &end, 10);\n\tnum3 = -1;\n\tif (*end == c && isdigit(end[1]))\n\t\tnum3 = strtol(end+1, &end, 10);\n\n\t/* Time? Date? */\n\tswitch (c) {\n\tcase ':':\n\t\tif (num3 < 0)\n\t\t\tnum3 = 0;\n\t\tif (num < 25 && num2 >= 0 && num2 < 60 && num3 >= 0 && num3 <= 60) {\n\t\t\ttm->tm_hour = num;\n\t\t\ttm->tm_min = num2;\n\t\t\ttm->tm_sec = num3;\n\t\t\tbreak;\n\t\t}\n\t\treturn 0;\n\n\tcase '-':\n\tcase '/':\n\tcase '.':\n\t\tnow = time(NULL);\n\t\trefuse_future = NULL;\n\t\tif (p_gmtime_r(&now, &now_tm))\n\t\t\trefuse_future = &now_tm;\n\n\t\tif (num > 70) {\n\t\t\t/* yyyy-mm-dd? */\n\t\t\tif (is_date(num, num2, num3, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t\t/* yyyy-dd-mm? */\n\t\t\tif (is_date(num, num3, num2, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t}\n\t\t/* Our eastern European friends say dd.mm.yy[yy]\n\t\t * is the norm there, so giving precedence to\n\t\t * mm/dd/yy[yy] form only when separator is not '.'\n\t\t */\n\t\tif (c != '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* European dd.mm.yy[yy] or funny US dd/mm/yy[yy] */\n\t\tif (is_date(num3, num2, num, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* Funny European mm.dd.yy */\n\t\tif (c == '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn end - date;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_gmtime_r",
          "args": [
            "&time",
            "tm"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "p_gmtime_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "674-685",
          "snippet": "struct tm *\np_gmtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = gmtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nstruct tm *\np_gmtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = gmtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nodate",
          "args": [
            "tm"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "nodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "309-317",
          "snippet": "static int nodate(struct tm *tm)\n{\n\treturn (tm->tm_year &\n\t\ttm->tm_mon &\n\t\ttm->tm_mday &\n\t\ttm->tm_hour &\n\t\ttm->tm_min &\n\t\ttm->tm_sec) < 0;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int nodate(struct tm *tm)\n{\n\treturn (tm->tm_year &\n\t\ttm->tm_mon &\n\t\ttm->tm_mday &\n\t\ttm->tm_hour &\n\t\ttm->tm_min &\n\t\ttm->tm_sec) < 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "date",
            "&end",
            "10"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic const struct special {\n\tconst char *name;\n\tvoid (*fn)(struct tm *, struct tm *, int *);\n} special[] = {\n\t{ \"yesterday\", date_yesterday },\n\t{ \"noon\", date_noon },\n\t{ \"midnight\", date_midnight },\n\t{ \"tea\", date_tea },\n\t{ \"PM\", date_pm },\n\t{ \"AM\", date_am },\n\t{ \"never\", date_never },\n\t{ \"now\", date_now },\n\t{ NULL }\n};\n\nstatic size_t match_digit(const char *date, struct tm *tm, int *offset, int *tm_gmt)\n{\n\tsize_t n;\n\tchar *end;\n\tunsigned long num;\n\n\tnum = strtoul(date, &end, 10);\n\n\t/*\n\t * Seconds since 1970? We trigger on that for any numbers with\n\t * more than 8 digits. This is because we don't want to rule out\n\t * numbers like 20070606 as a YYYYMMDD date.\n\t */\n\tif (num >= 100000000 && nodate(tm)) {\n\t\ttime_t time = num;\n\t\tif (p_gmtime_r(&time, tm)) {\n\t\t\t*tm_gmt = 1;\n\t\t\treturn end - date;\n\t\t}\n\t}\n\n\t/*\n\t * Check for special formats: num[-.:/]num[same]num\n\t */\n\tswitch (*end) {\n\tcase ':':\n\tcase '.':\n\tcase '/':\n\tcase '-':\n\t\tif (isdigit(end[1])) {\n\t\t\tsize_t match = match_multi_number(num, *end, date, end, tm);\n\t\t\tif (match)\n\t\t\t\treturn match;\n\t\t}\n\t}\n\n\t/*\n\t * None of the special formats? Try to guess what\n\t * the number meant. We use the number of digits\n\t * to make a more educated guess..\n\t */\n\tn = 0;\n\tdo {\n\t\tn++;\n\t} while (isdigit(date[n]));\n\n\t/* Four-digit year or a timezone? */\n\tif (n == 4) {\n\t\tif (num <= 1400 && *offset == -1) {\n\t\t\tunsigned int minutes = num % 100;\n\t\t\tunsigned int hours = num / 100;\n\t\t\t*offset = hours*60 + minutes;\n\t\t} else if (num > 1900 && num < 2100)\n\t\t\ttm->tm_year = num - 1900;\n\t\treturn n;\n\t}\n\n\t/*\n\t * Ignore lots of numerals. We took care of 4-digit years above.\n\t * Days or months must be one or two digits.\n\t */\n\tif (n > 2)\n\t\treturn n;\n\n\t/*\n\t * NOTE! We will give precedence to day-of-month over month or\n\t * year numbers in the 1-12 range. So 05 is always \"mday 5\",\n\t * unless we already have a mday..\n\t *\n\t * IOW, 01 Apr 05 parses as \"April 1st, 2005\".\n\t */\n\tif (num > 0 && num < 32 && tm->tm_mday < 0) {\n\t\ttm->tm_mday = num;\n\t\treturn n;\n\t}\n\n\t/* Two-digit year? */\n\tif (n == 2 && tm->tm_year < 0) {\n\t\tif (num < 10 && tm->tm_mday >= 0) {\n\t\t\ttm->tm_year = num + 100;\n\t\t\treturn n;\n\t\t}\n\t\tif (num >= 70) {\n\t\t\ttm->tm_year = num;\n\t\t\treturn n;\n\t\t}\n\t}\n\n\tif (num > 0 && num < 13 && tm->tm_mon < 0)\n\t\ttm->tm_mon = num-1;\n\n\treturn n;\n}"
  },
  {
    "function_name": "nodate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "309-317",
    "snippet": "static int nodate(struct tm *tm)\n{\n\treturn (tm->tm_year &\n\t\ttm->tm_mon &\n\t\ttm->tm_mday &\n\t\ttm->tm_hour &\n\t\ttm->tm_min &\n\t\ttm->tm_sec) < 0;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int nodate(struct tm *tm)\n{\n\treturn (tm->tm_year &\n\t\ttm->tm_mon &\n\t\ttm->tm_mday &\n\t\ttm->tm_hour &\n\t\ttm->tm_min &\n\t\ttm->tm_sec) < 0;\n}"
  },
  {
    "function_name": "match_multi_number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "244-302",
    "snippet": "static size_t match_multi_number(unsigned long num, char c, const char *date, char *end, struct tm *tm)\n{\n\ttime_t now;\n\tstruct tm now_tm;\n\tstruct tm *refuse_future;\n\tlong num2, num3;\n\n\tnum2 = strtol(end+1, &end, 10);\n\tnum3 = -1;\n\tif (*end == c && isdigit(end[1]))\n\t\tnum3 = strtol(end+1, &end, 10);\n\n\t/* Time? Date? */\n\tswitch (c) {\n\tcase ':':\n\t\tif (num3 < 0)\n\t\t\tnum3 = 0;\n\t\tif (num < 25 && num2 >= 0 && num2 < 60 && num3 >= 0 && num3 <= 60) {\n\t\t\ttm->tm_hour = num;\n\t\t\ttm->tm_min = num2;\n\t\t\ttm->tm_sec = num3;\n\t\t\tbreak;\n\t\t}\n\t\treturn 0;\n\n\tcase '-':\n\tcase '/':\n\tcase '.':\n\t\tnow = time(NULL);\n\t\trefuse_future = NULL;\n\t\tif (p_gmtime_r(&now, &now_tm))\n\t\t\trefuse_future = &now_tm;\n\n\t\tif (num > 70) {\n\t\t\t/* yyyy-mm-dd? */\n\t\t\tif (is_date(num, num2, num3, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t\t/* yyyy-dd-mm? */\n\t\t\tif (is_date(num, num3, num2, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t}\n\t\t/* Our eastern European friends say dd.mm.yy[yy]\n\t\t * is the norm there, so giving precedence to\n\t\t * mm/dd/yy[yy] form only when separator is not '.'\n\t\t */\n\t\tif (c != '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* European dd.mm.yy[yy] or funny US dd/mm/yy[yy] */\n\t\tif (is_date(num3, num2, num, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* Funny European mm.dd.yy */\n\t\tif (c == '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn end - date;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_date",
          "args": [
            "num3",
            "num",
            "num2",
            "refuse_future",
            "now",
            "tm"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "is_date",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "202-242",
          "snippet": "static int is_date(int year, int month, int day, struct tm *now_tm, time_t now, struct tm *tm)\n{\n\tif (month > 0 && month < 13 && day > 0 && day < 32) {\n\t\tstruct tm check = *tm;\n\t\tstruct tm *r = (now_tm ? &check : tm);\n\t\ttime_t specified;\n\n\t\tr->tm_mon = month - 1;\n\t\tr->tm_mday = day;\n\t\tif (year == -1) {\n\t\t\tif (!now_tm)\n\t\t\t\treturn 1;\n\t\t\tr->tm_year = now_tm->tm_year;\n\t\t}\n\t\telse if (year >= 1970 && year < 2100)\n\t\t\tr->tm_year = year - 1900;\n\t\telse if (year > 70 && year < 100)\n\t\t\tr->tm_year = year;\n\t\telse if (year < 38)\n\t\t\tr->tm_year = year + 100;\n\t\telse\n\t\t\treturn 0;\n\t\tif (!now_tm)\n\t\t\treturn 1;\n\n\t\tspecified = tm_to_time_t(r);\n\n\t\t/* Be it commit time or author time, it does not make\n\t\t * sense to specify timestamp way into the future.  Make\n\t\t * sure it is not later than ten days from now...\n\t\t */\n\t\tif (now + 10*24*3600 < specified)\n\t\t\treturn 0;\n\t\ttm->tm_mon = r->tm_mon;\n\t\ttm->tm_mday = r->tm_mday;\n\t\tif (year != -1)\n\t\t\ttm->tm_year = r->tm_year;\n\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int is_date(int year, int month, int day, struct tm *now_tm, time_t now, struct tm *tm)\n{\n\tif (month > 0 && month < 13 && day > 0 && day < 32) {\n\t\tstruct tm check = *tm;\n\t\tstruct tm *r = (now_tm ? &check : tm);\n\t\ttime_t specified;\n\n\t\tr->tm_mon = month - 1;\n\t\tr->tm_mday = day;\n\t\tif (year == -1) {\n\t\t\tif (!now_tm)\n\t\t\t\treturn 1;\n\t\t\tr->tm_year = now_tm->tm_year;\n\t\t}\n\t\telse if (year >= 1970 && year < 2100)\n\t\t\tr->tm_year = year - 1900;\n\t\telse if (year > 70 && year < 100)\n\t\t\tr->tm_year = year;\n\t\telse if (year < 38)\n\t\t\tr->tm_year = year + 100;\n\t\telse\n\t\t\treturn 0;\n\t\tif (!now_tm)\n\t\t\treturn 1;\n\n\t\tspecified = tm_to_time_t(r);\n\n\t\t/* Be it commit time or author time, it does not make\n\t\t * sense to specify timestamp way into the future.  Make\n\t\t * sure it is not later than ten days from now...\n\t\t */\n\t\tif (now + 10*24*3600 < specified)\n\t\t\treturn 0;\n\t\ttm->tm_mon = r->tm_mon;\n\t\ttm->tm_mday = r->tm_mday;\n\t\tif (year != -1)\n\t\t\ttm->tm_year = r->tm_year;\n\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_gmtime_r",
          "args": [
            "&now",
            "&now_tm"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "p_gmtime_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "674-685",
          "snippet": "struct tm *\np_gmtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = gmtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nstruct tm *\np_gmtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = gmtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "tm_to_time_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "33-52",
          "snippet": "static git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "end+1",
            "&end",
            "10"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "end[1]"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "git__isdigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "449-452",
          "snippet": "GIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "end+1",
            "&end",
            "10"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic size_t match_multi_number(unsigned long num, char c, const char *date, char *end, struct tm *tm)\n{\n\ttime_t now;\n\tstruct tm now_tm;\n\tstruct tm *refuse_future;\n\tlong num2, num3;\n\n\tnum2 = strtol(end+1, &end, 10);\n\tnum3 = -1;\n\tif (*end == c && isdigit(end[1]))\n\t\tnum3 = strtol(end+1, &end, 10);\n\n\t/* Time? Date? */\n\tswitch (c) {\n\tcase ':':\n\t\tif (num3 < 0)\n\t\t\tnum3 = 0;\n\t\tif (num < 25 && num2 >= 0 && num2 < 60 && num3 >= 0 && num3 <= 60) {\n\t\t\ttm->tm_hour = num;\n\t\t\ttm->tm_min = num2;\n\t\t\ttm->tm_sec = num3;\n\t\t\tbreak;\n\t\t}\n\t\treturn 0;\n\n\tcase '-':\n\tcase '/':\n\tcase '.':\n\t\tnow = time(NULL);\n\t\trefuse_future = NULL;\n\t\tif (p_gmtime_r(&now, &now_tm))\n\t\t\trefuse_future = &now_tm;\n\n\t\tif (num > 70) {\n\t\t\t/* yyyy-mm-dd? */\n\t\t\tif (is_date(num, num2, num3, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t\t/* yyyy-dd-mm? */\n\t\t\tif (is_date(num, num3, num2, refuse_future, now, tm))\n\t\t\t\tbreak;\n\t\t}\n\t\t/* Our eastern European friends say dd.mm.yy[yy]\n\t\t * is the norm there, so giving precedence to\n\t\t * mm/dd/yy[yy] form only when separator is not '.'\n\t\t */\n\t\tif (c != '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* European dd.mm.yy[yy] or funny US dd/mm/yy[yy] */\n\t\tif (is_date(num3, num2, num, refuse_future, now, tm))\n\t\t\tbreak;\n\t\t/* Funny European mm.dd.yy */\n\t\tif (c == '.' &&\n\t\t    is_date(num3, num, num2, refuse_future, now, tm))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn end - date;\n}"
  },
  {
    "function_name": "is_date",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "202-242",
    "snippet": "static int is_date(int year, int month, int day, struct tm *now_tm, time_t now, struct tm *tm)\n{\n\tif (month > 0 && month < 13 && day > 0 && day < 32) {\n\t\tstruct tm check = *tm;\n\t\tstruct tm *r = (now_tm ? &check : tm);\n\t\ttime_t specified;\n\n\t\tr->tm_mon = month - 1;\n\t\tr->tm_mday = day;\n\t\tif (year == -1) {\n\t\t\tif (!now_tm)\n\t\t\t\treturn 1;\n\t\t\tr->tm_year = now_tm->tm_year;\n\t\t}\n\t\telse if (year >= 1970 && year < 2100)\n\t\t\tr->tm_year = year - 1900;\n\t\telse if (year > 70 && year < 100)\n\t\t\tr->tm_year = year;\n\t\telse if (year < 38)\n\t\t\tr->tm_year = year + 100;\n\t\telse\n\t\t\treturn 0;\n\t\tif (!now_tm)\n\t\t\treturn 1;\n\n\t\tspecified = tm_to_time_t(r);\n\n\t\t/* Be it commit time or author time, it does not make\n\t\t * sense to specify timestamp way into the future.  Make\n\t\t * sure it is not later than ten days from now...\n\t\t */\n\t\tif (now + 10*24*3600 < specified)\n\t\t\treturn 0;\n\t\ttm->tm_mon = r->tm_mon;\n\t\ttm->tm_mday = r->tm_mday;\n\t\tif (year != -1)\n\t\t\ttm->tm_year = r->tm_year;\n\t\treturn 1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tm_to_time_t",
          "args": [
            "r"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "tm_to_time_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "33-52",
          "snippet": "static git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int is_date(int year, int month, int day, struct tm *now_tm, time_t now, struct tm *tm)\n{\n\tif (month > 0 && month < 13 && day > 0 && day < 32) {\n\t\tstruct tm check = *tm;\n\t\tstruct tm *r = (now_tm ? &check : tm);\n\t\ttime_t specified;\n\n\t\tr->tm_mon = month - 1;\n\t\tr->tm_mday = day;\n\t\tif (year == -1) {\n\t\t\tif (!now_tm)\n\t\t\t\treturn 1;\n\t\t\tr->tm_year = now_tm->tm_year;\n\t\t}\n\t\telse if (year >= 1970 && year < 2100)\n\t\t\tr->tm_year = year - 1900;\n\t\telse if (year > 70 && year < 100)\n\t\t\tr->tm_year = year;\n\t\telse if (year < 38)\n\t\t\tr->tm_year = year + 100;\n\t\telse\n\t\t\treturn 0;\n\t\tif (!now_tm)\n\t\t\treturn 1;\n\n\t\tspecified = tm_to_time_t(r);\n\n\t\t/* Be it commit time or author time, it does not make\n\t\t * sense to specify timestamp way into the future.  Make\n\t\t * sure it is not later than ten days from now...\n\t\t */\n\t\tif (now + 10*24*3600 < specified)\n\t\t\treturn 0;\n\t\ttm->tm_mon = r->tm_mon;\n\t\ttm->tm_mday = r->tm_mday;\n\t\tif (year != -1)\n\t\t\ttm->tm_year = r->tm_year;\n\t\treturn 1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "match_alpha",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "152-200",
    "snippet": "static size_t match_alpha(const char *date, struct tm *tm, int *offset)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < 12; i++) {\n\t\tsize_t match = match_string(date, month_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_mon = i;\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tfor (i = 0; i < 7; i++) {\n\t\tsize_t match = match_string(date, weekday_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_wday = i;\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(timezone_names); i++) {\n\t\tsize_t match = match_string(date, timezone_names[i].name);\n\t\tif (match >= 3 || match == strlen(timezone_names[i].name)) {\n\t\t\tint off = timezone_names[i].offset;\n\n\t\t\t/* This is bogus, but we like summer */\n\t\t\toff += timezone_names[i].dst;\n\n\t\t\t/* Only use the tz name offset if we don't have anything better */\n\t\t\tif (*offset == -1)\n\t\t\t\t*offset = 60*off;\n\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tif (match_string(date, \"PM\") == 2) {\n\t\ttm->tm_hour = (tm->tm_hour % 12) + 12;\n\t\treturn 2;\n\t}\n\n\tif (match_string(date, \"AM\") == 2) {\n\t\ttm->tm_hour = (tm->tm_hour % 12) + 0;\n\t\treturn 2;\n\t}\n\n\t/* BAD */\n\treturn skip_alpha(date);\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};",
      "static const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};",
      "static const struct {\n\tconst char *name;\n\tint offset;\n\tint dst;\n} timezone_names[] = {\n\t{ \"IDLW\", -12, 0, },\t/* International Date Line West */\n\t{ \"NT\",   -11, 0, },\t/* Nome */\n\t{ \"CAT\",  -10, 0, },\t/* Central Alaska */\n\t{ \"HST\",  -10, 0, },\t/* Hawaii Standard */\n\t{ \"HDT\",  -10, 1, },\t/* Hawaii Daylight */\n\t{ \"YST\",   -9, 0, },\t/* Yukon Standard */\n\t{ \"YDT\",   -9, 1, },\t/* Yukon Daylight */\n\t{ \"PST\",   -8, 0, },\t/* Pacific Standard */\n\t{ \"PDT\",   -8, 1, },\t/* Pacific Daylight */\n\t{ \"MST\",   -7, 0, },\t/* Mountain Standard */\n\t{ \"MDT\",   -7, 1, },\t/* Mountain Daylight */\n\t{ \"CST\",   -6, 0, },\t/* Central Standard */\n\t{ \"CDT\",   -6, 1, },\t/* Central Daylight */\n\t{ \"EST\",   -5, 0, },\t/* Eastern Standard */\n\t{ \"EDT\",   -5, 1, },\t/* Eastern Daylight */\n\t{ \"AST\",   -3, 0, },\t/* Atlantic Standard */\n\t{ \"ADT\",   -3, 1, },\t/* Atlantic Daylight */\n\t{ \"WAT\",   -1, 0, },\t/* West Africa */\n\n\t{ \"GMT\",    0, 0, },\t/* Greenwich Mean */\n\t{ \"UTC\",    0, 0, },\t/* Universal (Coordinated) */\n\t{ \"Z\",      0, 0, },    /* Zulu, alias for UTC */\n\n\t{ \"WET\",    0, 0, },\t/* Western European */\n\t{ \"BST\",    0, 1, },\t/* British Summer */\n\t{ \"CET\",   +1, 0, },\t/* Central European */\n\t{ \"MET\",   +1, 0, },\t/* Middle European */\n\t{ \"MEWT\",  +1, 0, },\t/* Middle European Winter */\n\t{ \"MEST\",  +1, 1, },\t/* Middle European Summer */\n\t{ \"CEST\",  +1, 1, },\t/* Central European Summer */\n\t{ \"MESZ\",  +1, 1, },\t/* Middle European Summer */\n\t{ \"FWT\",   +1, 0, },\t/* French Winter */\n\t{ \"FST\",   +1, 1, },\t/* French Summer */\n\t{ \"EET\",   +2, 0, },\t/* Eastern Europe */\n\t{ \"EEST\",  +2, 1, },\t/* Eastern European Daylight */\n\t{ \"WAST\",  +7, 0, },\t/* West Australian Standard */\n\t{ \"WADT\",  +7, 1, },\t/* West Australian Daylight */\n\t{ \"CCT\",   +8, 0, },\t/* China Coast */\n\t{ \"JST\",   +9, 0, },\t/* Japan Standard */\n\t{ \"EAST\", +10, 0, },\t/* Eastern Australian Standard */\n\t{ \"EADT\", +10, 1, },\t/* Eastern Australian Daylight */\n\t{ \"GST\",  +10, 0, },\t/* Guam Standard */\n\t{ \"NZT\",  +12, 0, },\t/* New Zealand */\n\t{ \"NZST\", +12, 0, },\t/* New Zealand Standard */\n\t{ \"NZDT\", +12, 1, },\t/* New Zealand Daylight */\n\t{ \"IDLE\", +12, 0, },\t/* International Date Line East */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "skip_alpha",
          "args": [
            "date"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "skip_alpha",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "140-147",
          "snippet": "static int skip_alpha(const char *date)\n{\n\tint i = 0;\n\tdo {\n\t\ti++;\n\t} while (isalpha(date[i]));\n\treturn i;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int skip_alpha(const char *date)\n{\n\tint i = 0;\n\tdo {\n\t\ti++;\n\t} while (isalpha(date[i]));\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_string",
          "args": [
            "date",
            "\"AM\""
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "match_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "124-138",
          "snippet": "static size_t match_string(const char *date, const char *str)\n{\n\tsize_t i = 0;\n\n\tfor (i = 0; *date; date++, str++, i++) {\n\t\tif (*date == *str)\n\t\t\tcontinue;\n\t\tif (toupper(*date) == toupper(*str))\n\t\t\tcontinue;\n\t\tif (!isalnum(*date))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn i;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic size_t match_string(const char *date, const char *str)\n{\n\tsize_t i = 0;\n\n\tfor (i = 0; *date; date++, str++, i++) {\n\t\tif (*date == *str)\n\t\t\tcontinue;\n\t\tif (toupper(*date) == toupper(*str))\n\t\t\tcontinue;\n\t\tif (!isalnum(*date))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "timezone_names[i].name"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "timezone_names"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic const char *month_names[] = {\n\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n};\nstatic const char *weekday_names[] = {\n\t\"Sundays\", \"Mondays\", \"Tuesdays\", \"Wednesdays\", \"Thursdays\", \"Fridays\", \"Saturdays\"\n};\nstatic const struct {\n\tconst char *name;\n\tint offset;\n\tint dst;\n} timezone_names[] = {\n\t{ \"IDLW\", -12, 0, },\t/* International Date Line West */\n\t{ \"NT\",   -11, 0, },\t/* Nome */\n\t{ \"CAT\",  -10, 0, },\t/* Central Alaska */\n\t{ \"HST\",  -10, 0, },\t/* Hawaii Standard */\n\t{ \"HDT\",  -10, 1, },\t/* Hawaii Daylight */\n\t{ \"YST\",   -9, 0, },\t/* Yukon Standard */\n\t{ \"YDT\",   -9, 1, },\t/* Yukon Daylight */\n\t{ \"PST\",   -8, 0, },\t/* Pacific Standard */\n\t{ \"PDT\",   -8, 1, },\t/* Pacific Daylight */\n\t{ \"MST\",   -7, 0, },\t/* Mountain Standard */\n\t{ \"MDT\",   -7, 1, },\t/* Mountain Daylight */\n\t{ \"CST\",   -6, 0, },\t/* Central Standard */\n\t{ \"CDT\",   -6, 1, },\t/* Central Daylight */\n\t{ \"EST\",   -5, 0, },\t/* Eastern Standard */\n\t{ \"EDT\",   -5, 1, },\t/* Eastern Daylight */\n\t{ \"AST\",   -3, 0, },\t/* Atlantic Standard */\n\t{ \"ADT\",   -3, 1, },\t/* Atlantic Daylight */\n\t{ \"WAT\",   -1, 0, },\t/* West Africa */\n\n\t{ \"GMT\",    0, 0, },\t/* Greenwich Mean */\n\t{ \"UTC\",    0, 0, },\t/* Universal (Coordinated) */\n\t{ \"Z\",      0, 0, },    /* Zulu, alias for UTC */\n\n\t{ \"WET\",    0, 0, },\t/* Western European */\n\t{ \"BST\",    0, 1, },\t/* British Summer */\n\t{ \"CET\",   +1, 0, },\t/* Central European */\n\t{ \"MET\",   +1, 0, },\t/* Middle European */\n\t{ \"MEWT\",  +1, 0, },\t/* Middle European Winter */\n\t{ \"MEST\",  +1, 1, },\t/* Middle European Summer */\n\t{ \"CEST\",  +1, 1, },\t/* Central European Summer */\n\t{ \"MESZ\",  +1, 1, },\t/* Middle European Summer */\n\t{ \"FWT\",   +1, 0, },\t/* French Winter */\n\t{ \"FST\",   +1, 1, },\t/* French Summer */\n\t{ \"EET\",   +2, 0, },\t/* Eastern Europe */\n\t{ \"EEST\",  +2, 1, },\t/* Eastern European Daylight */\n\t{ \"WAST\",  +7, 0, },\t/* West Australian Standard */\n\t{ \"WADT\",  +7, 1, },\t/* West Australian Daylight */\n\t{ \"CCT\",   +8, 0, },\t/* China Coast */\n\t{ \"JST\",   +9, 0, },\t/* Japan Standard */\n\t{ \"EAST\", +10, 0, },\t/* Eastern Australian Standard */\n\t{ \"EADT\", +10, 1, },\t/* Eastern Australian Daylight */\n\t{ \"GST\",  +10, 0, },\t/* Guam Standard */\n\t{ \"NZT\",  +12, 0, },\t/* New Zealand */\n\t{ \"NZST\", +12, 0, },\t/* New Zealand Standard */\n\t{ \"NZDT\", +12, 1, },\t/* New Zealand Daylight */\n\t{ \"IDLE\", +12, 0, },\t/* International Date Line East */\n};\n\nstatic size_t match_alpha(const char *date, struct tm *tm, int *offset)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < 12; i++) {\n\t\tsize_t match = match_string(date, month_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_mon = i;\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tfor (i = 0; i < 7; i++) {\n\t\tsize_t match = match_string(date, weekday_names[i]);\n\t\tif (match >= 3) {\n\t\t\ttm->tm_wday = i;\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(timezone_names); i++) {\n\t\tsize_t match = match_string(date, timezone_names[i].name);\n\t\tif (match >= 3 || match == strlen(timezone_names[i].name)) {\n\t\t\tint off = timezone_names[i].offset;\n\n\t\t\t/* This is bogus, but we like summer */\n\t\t\toff += timezone_names[i].dst;\n\n\t\t\t/* Only use the tz name offset if we don't have anything better */\n\t\t\tif (*offset == -1)\n\t\t\t\t*offset = 60*off;\n\n\t\t\treturn match;\n\t\t}\n\t}\n\n\tif (match_string(date, \"PM\") == 2) {\n\t\ttm->tm_hour = (tm->tm_hour % 12) + 12;\n\t\treturn 2;\n\t}\n\n\tif (match_string(date, \"AM\") == 2) {\n\t\ttm->tm_hour = (tm->tm_hour % 12) + 0;\n\t\treturn 2;\n\t}\n\n\t/* BAD */\n\treturn skip_alpha(date);\n}"
  },
  {
    "function_name": "skip_alpha",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "140-147",
    "snippet": "static int skip_alpha(const char *date)\n{\n\tint i = 0;\n\tdo {\n\t\ti++;\n\t} while (isalpha(date[i]));\n\treturn i;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "date[i]"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "git__isalpha",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "444-447",
          "snippet": "GIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isalpha(int c)\n{\n\treturn ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic int skip_alpha(const char *date)\n{\n\tint i = 0;\n\tdo {\n\t\ti++;\n\t} while (isalpha(date[i]));\n\treturn i;\n}"
  },
  {
    "function_name": "match_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "124-138",
    "snippet": "static size_t match_string(const char *date, const char *str)\n{\n\tsize_t i = 0;\n\n\tfor (i = 0; *date; date++, str++, i++) {\n\t\tif (*date == *str)\n\t\t\tcontinue;\n\t\tif (toupper(*date) == toupper(*str))\n\t\t\tcontinue;\n\t\tif (!isalnum(*date))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn i;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isalnum",
          "args": [
            "*date"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "*str"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "*date"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic size_t match_string(const char *date, const char *str)\n{\n\tsize_t i = 0;\n\n\tfor (i = 0; *date; date++, str++, i++) {\n\t\tif (*date == *str)\n\t\t\tcontinue;\n\t\tif (toupper(*date) == toupper(*str))\n\t\t\tcontinue;\n\t\tif (!isalnum(*date))\n\t\t\tbreak;\n\t\treturn 0;\n\t}\n\treturn i;\n}"
  },
  {
    "function_name": "tm_to_time_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
    "lines": "33-52",
    "snippet": "static git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}",
    "includes": [
      "#include <time.h>",
      "#include <ctype.h>",
      "#include \"posix.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include <sys/time.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}"
  }
]