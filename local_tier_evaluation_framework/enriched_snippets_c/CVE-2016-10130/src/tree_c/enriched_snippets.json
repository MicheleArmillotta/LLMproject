[
  {
    "function_name": "git_tree_walk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "1020-1040",
    "snippet": "int git_tree_walk(\n\tconst git_tree *tree,\n\tgit_treewalk_mode mode,\n\tgit_treewalk_cb callback,\n\tvoid *payload)\n{\n\tint error = 0;\n\tgit_buf root_path = GIT_BUF_INIT;\n\n\tif (mode != GIT_TREEWALK_POST && mode != GIT_TREEWALK_PRE) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid walking mode for tree walk\");\n\t\treturn -1;\n\t}\n\n\terror = tree_walk(\n\t\ttree, callback, &root_path, payload, (mode == GIT_TREEWALK_PRE));\n\n\tgit_buf_free(&root_path);\n\n\treturn error;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&root_path"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tree_walk",
          "args": [
            "tree",
            "callback",
            "&root_path",
            "payload",
            "(mode == GIT_TREEWALK_PRE)"
          ],
          "line": 1034
        },
        "resolved": true,
        "details": {
          "function_name": "tree_walk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "959-1018",
          "snippet": "static int tree_walk(\n\tconst git_tree *tree,\n\tgit_treewalk_cb callback,\n\tgit_buf *path,\n\tvoid *payload,\n\tbool preorder)\n{\n\tint error = 0;\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\tgit_array_foreach(tree->entries, i, entry) {\n\t\tif (preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (error > 0) { /* positive value skips this entry */\n\t\t\t\terror = 0;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tif (git_tree_entry__is_tree(entry)) {\n\t\t\tgit_tree *subtree;\n\t\t\tsize_t path_len = git_buf_len(path);\n\n\t\t\terror = git_tree_lookup(&subtree, tree->object.repo, entry->oid);\n\t\t\tif (error < 0)\n\t\t\t\tbreak;\n\n\t\t\t/* append the next entry to the path */\n\t\t\tgit_buf_puts(path, entry->filename);\n\t\t\tgit_buf_putc(path, '/');\n\n\t\t\tif (git_buf_oom(path))\n\t\t\t\terror = -1;\n\t\t\telse\n\t\t\t\terror = tree_walk(subtree, callback, path, payload, preorder);\n\n\t\t\tgit_tree_free(subtree);\n\t\t\tif (error != 0)\n\t\t\t\tbreak;\n\n\t\t\tgit_buf_truncate(path, path_len);\n\t\t}\n\n\t\tif (!preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int tree_walk(\n\tconst git_tree *tree,\n\tgit_treewalk_cb callback,\n\tgit_buf *path,\n\tvoid *payload,\n\tbool preorder)\n{\n\tint error = 0;\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\tgit_array_foreach(tree->entries, i, entry) {\n\t\tif (preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (error > 0) { /* positive value skips this entry */\n\t\t\t\terror = 0;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tif (git_tree_entry__is_tree(entry)) {\n\t\t\tgit_tree *subtree;\n\t\t\tsize_t path_len = git_buf_len(path);\n\n\t\t\terror = git_tree_lookup(&subtree, tree->object.repo, entry->oid);\n\t\t\tif (error < 0)\n\t\t\t\tbreak;\n\n\t\t\t/* append the next entry to the path */\n\t\t\tgit_buf_puts(path, entry->filename);\n\t\t\tgit_buf_putc(path, '/');\n\n\t\t\tif (git_buf_oom(path))\n\t\t\t\terror = -1;\n\t\t\telse\n\t\t\t\terror = tree_walk(subtree, callback, path, payload, preorder);\n\n\t\t\tgit_tree_free(subtree);\n\t\t\tif (error != 0)\n\t\t\t\tbreak;\n\n\t\t\tgit_buf_truncate(path, path_len);\n\t\t}\n\n\t\tif (!preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Invalid walking mode for tree walk\""
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tree_walk(\n\tconst git_tree *tree,\n\tgit_treewalk_mode mode,\n\tgit_treewalk_cb callback,\n\tvoid *payload)\n{\n\tint error = 0;\n\tgit_buf root_path = GIT_BUF_INIT;\n\n\tif (mode != GIT_TREEWALK_POST && mode != GIT_TREEWALK_PRE) {\n\t\tgiterr_set(GITERR_INVALID, \"Invalid walking mode for tree walk\");\n\t\treturn -1;\n\t}\n\n\terror = tree_walk(\n\t\ttree, callback, &root_path, payload, (mode == GIT_TREEWALK_PRE));\n\n\tgit_buf_free(&root_path);\n\n\treturn error;\n}"
  },
  {
    "function_name": "tree_walk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "959-1018",
    "snippet": "static int tree_walk(\n\tconst git_tree *tree,\n\tgit_treewalk_cb callback,\n\tgit_buf *path,\n\tvoid *payload,\n\tbool preorder)\n{\n\tint error = 0;\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\tgit_array_foreach(tree->entries, i, entry) {\n\t\tif (preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (error > 0) { /* positive value skips this entry */\n\t\t\t\terror = 0;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tif (git_tree_entry__is_tree(entry)) {\n\t\t\tgit_tree *subtree;\n\t\t\tsize_t path_len = git_buf_len(path);\n\n\t\t\terror = git_tree_lookup(&subtree, tree->object.repo, entry->oid);\n\t\t\tif (error < 0)\n\t\t\t\tbreak;\n\n\t\t\t/* append the next entry to the path */\n\t\t\tgit_buf_puts(path, entry->filename);\n\t\t\tgit_buf_putc(path, '/');\n\n\t\t\tif (git_buf_oom(path))\n\t\t\t\terror = -1;\n\t\t\telse\n\t\t\t\terror = tree_walk(subtree, callback, path, payload, preorder);\n\n\t\t\tgit_tree_free(subtree);\n\t\t\tif (error != 0)\n\t\t\t\tbreak;\n\n\t\t\tgit_buf_truncate(path, path_len);\n\t\t}\n\n\t\tif (!preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set_after_callback_function",
          "args": [
            "error",
            "\"git_tree_walk\""
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "callback",
          "args": [
            "path->ptr",
            "entry",
            "payload"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_set_callbacks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1715-1724",
          "snippet": "int git_packbuilder_set_callbacks(git_packbuilder *pb, git_packbuilder_progress progress_cb, void *progress_cb_payload)\n{\n\tif (!pb)\n\t\treturn -1;\n\n\tpb->progress_cb = progress_cb;\n\tpb->progress_cb_payload = progress_cb_payload;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nint git_packbuilder_set_callbacks(git_packbuilder *pb, git_packbuilder_progress progress_cb, void *progress_cb_payload)\n{\n\tif (!pb)\n\t\treturn -1;\n\n\tpb->progress_cb = progress_cb;\n\tpb->progress_cb_payload = progress_cb_payload;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_truncate",
          "args": [
            "path",
            "path_len"
          ],
          "line": 1004
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "446-454",
          "snippet": "void git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "subtree"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tree_walk",
          "args": [
            "subtree",
            "callback",
            "path",
            "payload",
            "preorder"
          ],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "tree_walk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "959-1018",
          "snippet": "static int tree_walk(\n\tconst git_tree *tree,\n\tgit_treewalk_cb callback,\n\tgit_buf *path,\n\tvoid *payload,\n\tbool preorder)\n{\n\tint error = 0;\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\tgit_array_foreach(tree->entries, i, entry) {\n\t\tif (preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (error > 0) { /* positive value skips this entry */\n\t\t\t\terror = 0;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tif (git_tree_entry__is_tree(entry)) {\n\t\t\tgit_tree *subtree;\n\t\t\tsize_t path_len = git_buf_len(path);\n\n\t\t\terror = git_tree_lookup(&subtree, tree->object.repo, entry->oid);\n\t\t\tif (error < 0)\n\t\t\t\tbreak;\n\n\t\t\t/* append the next entry to the path */\n\t\t\tgit_buf_puts(path, entry->filename);\n\t\t\tgit_buf_putc(path, '/');\n\n\t\t\tif (git_buf_oom(path))\n\t\t\t\terror = -1;\n\t\t\telse\n\t\t\t\terror = tree_walk(subtree, callback, path, payload, preorder);\n\n\t\t\tgit_tree_free(subtree);\n\t\t\tif (error != 0)\n\t\t\t\tbreak;\n\n\t\t\tgit_buf_truncate(path, path_len);\n\t\t}\n\n\t\tif (!preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\treturn error;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "path"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "path",
            "'/'"
          ],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "path",
            "entry->filename"
          ],
          "line": 992
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_lookup",
          "args": [
            "&subtree",
            "tree->object.repo",
            "entry->oid"
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "49-52",
          "snippet": "int git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "path"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry__is_tree",
          "args": [
            "entry"
          ],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry__is_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.h",
          "lines": "35-38",
          "snippet": "GIT_INLINE(bool) git_tree_entry__is_tree(const struct git_tree_entry *e)\n{\n\treturn (S_ISDIR(e->attr) && !S_ISGITLINK(e->attr));\n}",
          "includes": [
            "#include \"pool.h\"",
            "#include \"strmap.h\"",
            "#include \"vector.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"git2/tree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pool.h\"\n#include \"strmap.h\"\n#include \"vector.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"git2/tree.h\"\n\nGIT_INLINE(bool) git_tree_entry__is_tree(const struct git_tree_entry *e)\n{\n\treturn (S_ISDIR(e->attr) && !S_ISGITLINK(e->attr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_foreach",
          "args": [
            "tree->entries",
            "i",
            "entry"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int tree_walk(\n\tconst git_tree *tree,\n\tgit_treewalk_cb callback,\n\tgit_buf *path,\n\tvoid *payload,\n\tbool preorder)\n{\n\tint error = 0;\n\tsize_t i;\n\tconst git_tree_entry *entry;\n\n\tgit_array_foreach(tree->entries, i, entry) {\n\t\tif (preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (error > 0) { /* positive value skips this entry */\n\t\t\t\terror = 0;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tif (git_tree_entry__is_tree(entry)) {\n\t\t\tgit_tree *subtree;\n\t\t\tsize_t path_len = git_buf_len(path);\n\n\t\t\terror = git_tree_lookup(&subtree, tree->object.repo, entry->oid);\n\t\t\tif (error < 0)\n\t\t\t\tbreak;\n\n\t\t\t/* append the next entry to the path */\n\t\t\tgit_buf_puts(path, entry->filename);\n\t\t\tgit_buf_putc(path, '/');\n\n\t\t\tif (git_buf_oom(path))\n\t\t\t\terror = -1;\n\t\t\telse\n\t\t\t\terror = tree_walk(subtree, callback, path, payload, preorder);\n\n\t\t\tgit_tree_free(subtree);\n\t\t\tif (error != 0)\n\t\t\t\tbreak;\n\n\t\t\tgit_buf_truncate(path, path_len);\n\t\t}\n\n\t\tif (!preorder) {\n\t\t\terror = callback(path->ptr, entry, payload);\n\t\t\tif (error < 0) { /* negative value stops iteration */\n\t\t\t\tgiterr_set_after_callback_function(error, \"git_tree_walk\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_tree_entry_bypath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "897-957",
    "snippet": "int git_tree_entry_bypath(\n\tgit_tree_entry **entry_out,\n\tconst git_tree *root,\n\tconst char *path)\n{\n\tint error = 0;\n\tgit_tree *subtree;\n\tconst git_tree_entry *entry;\n\tsize_t filename_len;\n\n\t/* Find how long is the current path component (i.e.\n\t * the filename between two slashes */\n\tfilename_len = subpath_len(path);\n\n\tif (filename_len == 0) {\n\t\tgiterr_set(GITERR_TREE, \"Invalid tree path given\");\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tentry = entry_fromname(root, path, filename_len);\n\n\tif (entry == NULL) {\n\t\tgiterr_set(GITERR_TREE,\n\t\t\t   \"the path '%.*s' does not exist in the given tree\", filename_len, path);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tswitch (path[filename_len]) {\n\tcase '/':\n\t\t/* If there are more components in the path...\n\t\t * then this entry *must* be a tree */\n\t\tif (!git_tree_entry__is_tree(entry)) {\n\t\t\tgiterr_set(GITERR_TREE,\n\t\t\t\t   \"the path '%.*s' exists but is not a tree\", filename_len, path);\n\t\t\treturn GIT_ENOTFOUND;\n\t\t}\n\n\t\t/* If there's only a slash left in the path, we \n\t\t * return the current entry; otherwise, we keep\n\t\t * walking down the path */\n\t\tif (path[filename_len + 1] != '\\0')\n\t\t\tbreak;\n\n\tcase '\\0':\n\t\t/* If there are no more components in the path, return\n\t\t * this entry */\n\t\treturn git_tree_entry_dup(entry_out, entry);\n\t}\n\n\tif (git_tree_lookup(&subtree, root->object.repo, entry->oid) < 0)\n\t\treturn -1;\n\n\terror = git_tree_entry_bypath(\n\t\tentry_out,\n\t\tsubtree,\n\t\tpath + filename_len + 1\n\t);\n\n\tgit_tree_free(subtree);\n\treturn error;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "subtree"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_bypath",
          "args": [
            "entry_out",
            "subtree",
            "path + filename_len + 1"
          ],
          "line": 949
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_bypath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "897-957",
          "snippet": "int git_tree_entry_bypath(\n\tgit_tree_entry **entry_out,\n\tconst git_tree *root,\n\tconst char *path)\n{\n\tint error = 0;\n\tgit_tree *subtree;\n\tconst git_tree_entry *entry;\n\tsize_t filename_len;\n\n\t/* Find how long is the current path component (i.e.\n\t * the filename between two slashes */\n\tfilename_len = subpath_len(path);\n\n\tif (filename_len == 0) {\n\t\tgiterr_set(GITERR_TREE, \"Invalid tree path given\");\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tentry = entry_fromname(root, path, filename_len);\n\n\tif (entry == NULL) {\n\t\tgiterr_set(GITERR_TREE,\n\t\t\t   \"the path '%.*s' does not exist in the given tree\", filename_len, path);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tswitch (path[filename_len]) {\n\tcase '/':\n\t\t/* If there are more components in the path...\n\t\t * then this entry *must* be a tree */\n\t\tif (!git_tree_entry__is_tree(entry)) {\n\t\t\tgiterr_set(GITERR_TREE,\n\t\t\t\t   \"the path '%.*s' exists but is not a tree\", filename_len, path);\n\t\t\treturn GIT_ENOTFOUND;\n\t\t}\n\n\t\t/* If there's only a slash left in the path, we \n\t\t * return the current entry; otherwise, we keep\n\t\t * walking down the path */\n\t\tif (path[filename_len + 1] != '\\0')\n\t\t\tbreak;\n\n\tcase '\\0':\n\t\t/* If there are no more components in the path, return\n\t\t * this entry */\n\t\treturn git_tree_entry_dup(entry_out, entry);\n\t}\n\n\tif (git_tree_lookup(&subtree, root->object.repo, entry->oid) < 0)\n\t\treturn -1;\n\n\terror = git_tree_entry_bypath(\n\t\tentry_out,\n\t\tsubtree,\n\t\tpath + filename_len + 1\n\t);\n\n\tgit_tree_free(subtree);\n\treturn error;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_lookup",
          "args": [
            "&subtree",
            "root->object.repo",
            "entry->oid"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "49-52",
          "snippet": "int git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_dup",
          "args": [
            "entry_out",
            "entry"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "237-251",
          "snippet": "int git_tree_entry_dup(git_tree_entry **dest, const git_tree_entry *source)\n{\n\tgit_tree_entry *cpy;\n\n\tassert(source);\n\n\tcpy = alloc_entry(source->filename, source->filename_len, source->oid);\n\tif (cpy == NULL)\n\t\treturn -1;\n\n\tcpy->attr = source->attr;\n\n\t*dest = cpy;\n\treturn 0;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tree_entry_dup(git_tree_entry **dest, const git_tree_entry *source)\n{\n\tgit_tree_entry *cpy;\n\n\tassert(source);\n\n\tcpy = alloc_entry(source->filename, source->filename_len, source->oid);\n\tif (cpy == NULL)\n\t\treturn -1;\n\n\tcpy->attr = source->attr;\n\n\t*dest = cpy;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_TREE",
            "\"the path '%.*s' exists but is not a tree\"",
            "filename_len",
            "path"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry__is_tree",
          "args": [
            "entry"
          ],
          "line": 928
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry__is_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.h",
          "lines": "35-38",
          "snippet": "GIT_INLINE(bool) git_tree_entry__is_tree(const struct git_tree_entry *e)\n{\n\treturn (S_ISDIR(e->attr) && !S_ISGITLINK(e->attr));\n}",
          "includes": [
            "#include \"pool.h\"",
            "#include \"strmap.h\"",
            "#include \"vector.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"git2/tree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pool.h\"\n#include \"strmap.h\"\n#include \"vector.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"git2/tree.h\"\n\nGIT_INLINE(bool) git_tree_entry__is_tree(const struct git_tree_entry *e)\n{\n\treturn (S_ISDIR(e->attr) && !S_ISGITLINK(e->attr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "entry_fromname",
          "args": [
            "root",
            "path",
            "filename_len"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "entry_fromname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "305-314",
          "snippet": "static const git_tree_entry *entry_fromname(\n\tconst git_tree *tree, const char *name, size_t name_len)\n{\n\tsize_t idx;\n\n\tif (tree_key_search(&idx, tree, name, name_len) < 0)\n\t\treturn NULL;\n\n\treturn git_array_get(tree->entries, idx);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic const git_tree_entry *entry_fromname(\n\tconst git_tree *tree, const char *name, size_t name_len)\n{\n\tsize_t idx;\n\n\tif (tree_key_search(&idx, tree, name, name_len) < 0)\n\t\treturn NULL;\n\n\treturn git_array_get(tree->entries, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_TREE",
            "\"Invalid tree path given\""
          ],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "subpath_len",
          "args": [
            "path"
          ],
          "line": 909
        },
        "resolved": true,
        "details": {
          "function_name": "subpath_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "888-895",
          "snippet": "static size_t subpath_len(const char *path)\n{\n\tconst char *slash_pos = strchr(path, '/');\n\tif (slash_pos == NULL)\n\t\treturn strlen(path);\n\n\treturn slash_pos - path;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic size_t subpath_len(const char *path)\n{\n\tconst char *slash_pos = strchr(path, '/');\n\tif (slash_pos == NULL)\n\t\treturn strlen(path);\n\n\treturn slash_pos - path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tree_entry_bypath(\n\tgit_tree_entry **entry_out,\n\tconst git_tree *root,\n\tconst char *path)\n{\n\tint error = 0;\n\tgit_tree *subtree;\n\tconst git_tree_entry *entry;\n\tsize_t filename_len;\n\n\t/* Find how long is the current path component (i.e.\n\t * the filename between two slashes */\n\tfilename_len = subpath_len(path);\n\n\tif (filename_len == 0) {\n\t\tgiterr_set(GITERR_TREE, \"Invalid tree path given\");\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tentry = entry_fromname(root, path, filename_len);\n\n\tif (entry == NULL) {\n\t\tgiterr_set(GITERR_TREE,\n\t\t\t   \"the path '%.*s' does not exist in the given tree\", filename_len, path);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tswitch (path[filename_len]) {\n\tcase '/':\n\t\t/* If there are more components in the path...\n\t\t * then this entry *must* be a tree */\n\t\tif (!git_tree_entry__is_tree(entry)) {\n\t\t\tgiterr_set(GITERR_TREE,\n\t\t\t\t   \"the path '%.*s' exists but is not a tree\", filename_len, path);\n\t\t\treturn GIT_ENOTFOUND;\n\t\t}\n\n\t\t/* If there's only a slash left in the path, we \n\t\t * return the current entry; otherwise, we keep\n\t\t * walking down the path */\n\t\tif (path[filename_len + 1] != '\\0')\n\t\t\tbreak;\n\n\tcase '\\0':\n\t\t/* If there are no more components in the path, return\n\t\t * this entry */\n\t\treturn git_tree_entry_dup(entry_out, entry);\n\t}\n\n\tif (git_tree_lookup(&subtree, root->object.repo, entry->oid) < 0)\n\t\treturn -1;\n\n\terror = git_tree_entry_bypath(\n\t\tentry_out,\n\t\tsubtree,\n\t\tpath + filename_len + 1\n\t);\n\n\tgit_tree_free(subtree);\n\treturn error;\n}"
  },
  {
    "function_name": "subpath_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "888-895",
    "snippet": "static size_t subpath_len(const char *path)\n{\n\tconst char *slash_pos = strchr(path, '/');\n\tif (slash_pos == NULL)\n\t\treturn strlen(path);\n\n\treturn slash_pos - path;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "path"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "path",
            "'/'"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic size_t subpath_len(const char *path)\n{\n\tconst char *slash_pos = strchr(path, '/');\n\tif (slash_pos == NULL)\n\t\treturn strlen(path);\n\n\treturn slash_pos - path;\n}"
  },
  {
    "function_name": "git_treebuilder_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "878-886",
    "snippet": "void git_treebuilder_free(git_treebuilder *bld)\n{\n\tif (bld == NULL)\n\t\treturn;\n\n\tgit_treebuilder_clear(bld);\n\tgit_strmap_free(bld->map);\n\tgit__free(bld);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "bld"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_free",
          "args": [
            "bld->map"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_treebuilder_clear",
          "args": [
            "bld"
          ],
          "line": 883
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "868-876",
          "snippet": "void git_treebuilder_clear(git_treebuilder *bld)\n{\n\tgit_tree_entry *e;\n\n\tassert(bld);\n\n\tgit_strmap_foreach_value(bld->map, e, git_tree_entry_free(e));\n\tgit_strmap_clear(bld->map);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_treebuilder_clear(git_treebuilder *bld)\n{\n\tgit_tree_entry *e;\n\n\tassert(bld);\n\n\tgit_strmap_foreach_value(bld->map, e, git_tree_entry_free(e));\n\tgit_strmap_clear(bld->map);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_treebuilder_free(git_treebuilder *bld)\n{\n\tif (bld == NULL)\n\t\treturn;\n\n\tgit_treebuilder_clear(bld);\n\tgit_strmap_free(bld->map);\n\tgit__free(bld);\n}"
  },
  {
    "function_name": "git_treebuilder_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "868-876",
    "snippet": "void git_treebuilder_clear(git_treebuilder *bld)\n{\n\tgit_tree_entry *e;\n\n\tassert(bld);\n\n\tgit_strmap_foreach_value(bld->map, e, git_tree_entry_free(e));\n\tgit_strmap_clear(bld->map);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_strmap_clear",
          "args": [
            "bld->map"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_foreach_value",
          "args": [
            "bld->map",
            "e",
            "git_tree_entry_free(e)"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_tree_entry_free",
          "args": [
            "e"
          ],
          "line": 874
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "229-235",
          "snippet": "void git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "bld"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_treebuilder_clear(git_treebuilder *bld)\n{\n\tgit_tree_entry *e;\n\n\tassert(bld);\n\n\tgit_strmap_foreach_value(bld->map, e, git_tree_entry_free(e));\n\tgit_strmap_clear(bld->map);\n}"
  },
  {
    "function_name": "git_treebuilder_filter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "850-866",
    "snippet": "void git_treebuilder_filter(\n\tgit_treebuilder *bld,\n\tgit_treebuilder_filter_cb filter,\n\tvoid *payload)\n{\n\tconst char *filename;\n\tgit_tree_entry *entry;\n\n\tassert(bld && filter);\n\n\tgit_strmap_foreach(bld->map, filename, entry, {\n\t\t\tif (filter(entry, payload)) {\n\t\t\t\tgit_strmap_delete(bld->map, filename);\n\t\t\t\tgit_tree_entry_free(entry);\n\t\t\t}\n\t});\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_strmap_foreach",
          "args": [
            "bld->map",
            "filename",
            "entry",
            "{\n\t\t\tif (filter(entry, payload)) {\n\t\t\t\tgit_strmap_delete(bld->map, filename);\n\t\t\t\tgit_tree_entry_free(entry);\n\t\t\t}\n\t}"
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_tree_entry_free",
          "args": [
            "entry"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "229-235",
          "snippet": "void git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_delete",
          "args": [
            "bld->map",
            "filename"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter",
          "args": [
            "entry",
            "payload"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_list_contains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "606-623",
          "snippet": "int git_filter_list_contains(\n\tgit_filter_list *fl,\n\tconst char *name)\n{\n\tsize_t i;\n\n\tassert(name);\n\n\tif (!fl)\n\t\treturn 0;\n\n\tfor (i = 0; i < fl->filters.size; i++) {\n\t\tif (strcmp(fl->filters.ptr[i].filter_name, name) == 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_contains(\n\tgit_filter_list *fl,\n\tconst char *name)\n{\n\tsize_t i;\n\n\tassert(name);\n\n\tif (!fl)\n\t\treturn 0;\n\n\tfor (i = 0; i < fl->filters.size; i++) {\n\t\tif (strcmp(fl->filters.ptr[i].filter_name, name) == 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "bld && filter"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_treebuilder_filter(\n\tgit_treebuilder *bld,\n\tgit_treebuilder_filter_cb filter,\n\tvoid *payload)\n{\n\tconst char *filename;\n\tgit_tree_entry *entry;\n\n\tassert(bld && filter);\n\n\tgit_strmap_foreach(bld->map, filename, entry, {\n\t\t\tif (filter(entry, payload)) {\n\t\t\t\tgit_strmap_delete(bld->map, filename);\n\t\t\t\tgit_tree_entry_free(entry);\n\t\t\t}\n\t});\n}"
  },
  {
    "function_name": "git_treebuilder_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "803-848",
    "snippet": "int git_treebuilder_write(git_oid *oid, git_treebuilder *bld)\n{\n\tint error = 0;\n\tsize_t i, entrycount;\n\tgit_buf tree = GIT_BUF_INIT;\n\tgit_odb *odb;\n\tgit_tree_entry *entry;\n\tgit_vector entries;\n\n\tassert(bld);\n\n\tentrycount = git_strmap_num_entries(bld->map);\n\tif (git_vector_init(&entries, entrycount, entry_sort_cmp) < 0)\n\t\treturn -1;\n\n\tgit_strmap_foreach_value(bld->map, entry, {\n\t\tif (git_vector_insert(&entries, entry) < 0)\n\t\t\treturn -1;\n\t});\n\n\tgit_vector_sort(&entries);\n\n\t/* Grow the buffer beforehand to an estimated size */\n\terror = git_buf_grow(&tree, entrycount * 72);\n\n\tfor (i = 0; i < entries.length && !error; ++i) {\n\t\tgit_tree_entry *entry = git_vector_get(&entries, i);\n\n\t\tgit_buf_printf(&tree, \"%o \", entry->attr);\n\t\tgit_buf_put(&tree, entry->filename, entry->filename_len + 1);\n\t\tgit_buf_put(&tree, (char *)entry->oid->id, GIT_OID_RAWSZ);\n\n\t\tif (git_buf_oom(&tree))\n\t\t\terror = -1;\n\t}\n\n\n\tif (!error &&\n\t\t!(error = git_repository_odb__weakptr(&odb, bld->repo)))\n\t\terror = git_odb_write(oid, odb, tree.ptr, tree.size, GIT_OBJ_TREE);\n\n\tgit_buf_free(&tree);\n\tgit_vector_free(&entries);\n\n\treturn error;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "&entries"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&tree"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_write",
          "args": [
            "oid",
            "odb",
            "tree.ptr",
            "tree.size",
            "GIT_OBJ_TREE"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "984-1024",
          "snippet": "int git_odb_write(\n\tgit_oid *oid, git_odb *db, const void *data, size_t len, git_otype type)\n{\n\tsize_t i;\n\tint error = GIT_ERROR;\n\tgit_odb_stream *stream;\n\n\tassert(oid && db);\n\n\tgit_odb_hash(oid, data, len, type);\n\tif (git_odb_exists(db, oid))\n\t\treturn 0;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->write != NULL)\n\t\t\terror = b->write(b, oid, data, len, type);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/* if no backends were able to write the object directly, we try a\n\t * streaming write to the backends; just write the whole object into the\n\t * stream in one push\n\t */\n\tif ((error = git_odb_open_wstream(&stream, db, len, type)) != 0)\n\t\treturn error;\n\n\tstream->write(stream, data, len);\n\terror = stream->finalize_write(stream, oid);\n\tgit_odb_stream_free(stream);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_write(\n\tgit_oid *oid, git_odb *db, const void *data, size_t len, git_otype type)\n{\n\tsize_t i;\n\tint error = GIT_ERROR;\n\tgit_odb_stream *stream;\n\n\tassert(oid && db);\n\n\tgit_odb_hash(oid, data, len, type);\n\tif (git_odb_exists(db, oid))\n\t\treturn 0;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->write != NULL)\n\t\t\terror = b->write(b, oid, data, len, type);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/* if no backends were able to write the object directly, we try a\n\t * streaming write to the backends; just write the whole object into the\n\t * stream in one push\n\t */\n\tif ((error = git_odb_open_wstream(&stream, db, len, type)) != 0)\n\t\treturn error;\n\n\tstream->write(stream, data, len);\n\terror = stream->finalize_write(stream, oid);\n\tgit_odb_stream_free(stream);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_odb__weakptr",
          "args": [
            "&odb",
            "bld->repo"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_odb__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "733-762",
          "snippet": "int git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "&tree"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "&tree",
            "(char *)entry->oid->id",
            "GIT_OID_RAWSZ"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "&tree",
            "\"%o \"",
            "entry->attr"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&entries",
            "i"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_grow",
          "args": [
            "&tree",
            "entrycount * 72"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_grow_by",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "106-116",
          "snippet": "int git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nint git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_sort",
          "args": [
            "&entries"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_sort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "175-185",
          "snippet": "void git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_foreach_value",
          "args": [
            "bld->map",
            "entry",
            "{\n\t\tif (git_vector_insert(&entries, entry) < 0)\n\t\t\treturn -1;\n\t}"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&entries",
            "entry"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "&entries",
            "entrycount",
            "entry_sort_cmp"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_num_entries",
          "args": [
            "bld->map"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "bld"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_write(git_oid *oid, git_treebuilder *bld)\n{\n\tint error = 0;\n\tsize_t i, entrycount;\n\tgit_buf tree = GIT_BUF_INIT;\n\tgit_odb *odb;\n\tgit_tree_entry *entry;\n\tgit_vector entries;\n\n\tassert(bld);\n\n\tentrycount = git_strmap_num_entries(bld->map);\n\tif (git_vector_init(&entries, entrycount, entry_sort_cmp) < 0)\n\t\treturn -1;\n\n\tgit_strmap_foreach_value(bld->map, entry, {\n\t\tif (git_vector_insert(&entries, entry) < 0)\n\t\t\treturn -1;\n\t});\n\n\tgit_vector_sort(&entries);\n\n\t/* Grow the buffer beforehand to an estimated size */\n\terror = git_buf_grow(&tree, entrycount * 72);\n\n\tfor (i = 0; i < entries.length && !error; ++i) {\n\t\tgit_tree_entry *entry = git_vector_get(&entries, i);\n\n\t\tgit_buf_printf(&tree, \"%o \", entry->attr);\n\t\tgit_buf_put(&tree, entry->filename, entry->filename_len + 1);\n\t\tgit_buf_put(&tree, (char *)entry->oid->id, GIT_OID_RAWSZ);\n\n\t\tif (git_buf_oom(&tree))\n\t\t\terror = -1;\n\t}\n\n\n\tif (!error &&\n\t\t!(error = git_repository_odb__weakptr(&odb, bld->repo)))\n\t\terror = git_odb_write(oid, odb, tree.ptr, tree.size, GIT_OBJ_TREE);\n\n\tgit_buf_free(&tree);\n\tgit_vector_free(&entries);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_treebuilder_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "790-801",
    "snippet": "int git_treebuilder_remove(git_treebuilder *bld, const char *filename)\n{\n\tgit_tree_entry *entry = treebuilder_get(bld, filename);\n\n\tif (entry == NULL)\n\t\treturn tree_error(\"Failed to remove entry. File isn't in the tree\", filename);\n\n\tgit_strmap_delete(bld->map, filename);\n\tgit_tree_entry_free(entry);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_entry_free",
          "args": [
            "entry"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "229-235",
          "snippet": "void git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_delete",
          "args": [
            "bld->map",
            "filename"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tree_error",
          "args": [
            "\"Failed to remove entry. File isn't in the tree\"",
            "filename"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "tree_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "395-402",
          "snippet": "static int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "treebuilder_get",
          "args": [
            "bld",
            "filename"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "785-788",
          "snippet": "const git_tree_entry *git_treebuilder_get(git_treebuilder *bld, const char *filename)\n{\n\treturn treebuilder_get(bld, filename);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_tree_entry *git_treebuilder_get(git_treebuilder *bld, const char *filename)\n{\n\treturn treebuilder_get(bld, filename);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_remove(git_treebuilder *bld, const char *filename)\n{\n\tgit_tree_entry *entry = treebuilder_get(bld, filename);\n\n\tif (entry == NULL)\n\t\treturn tree_error(\"Failed to remove entry. File isn't in the tree\", filename);\n\n\tgit_strmap_delete(bld->map, filename);\n\tgit_tree_entry_free(entry);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_treebuilder_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "785-788",
    "snippet": "const git_tree_entry *git_treebuilder_get(git_treebuilder *bld, const char *filename)\n{\n\treturn treebuilder_get(bld, filename);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "treebuilder_get",
          "args": [
            "bld",
            "filename"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "785-788",
          "snippet": "const git_tree_entry *git_treebuilder_get(git_treebuilder *bld, const char *filename)\n{\n\treturn treebuilder_get(bld, filename);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_tree_entry *git_treebuilder_get(git_treebuilder *bld, const char *filename)\n{\n\treturn treebuilder_get(bld, filename);\n}"
  },
  {
    "function_name": "treebuilder_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "771-783",
    "snippet": "static git_tree_entry *treebuilder_get(git_treebuilder *bld, const char *filename)\n{\n\tgit_tree_entry *entry = NULL;\n\tgit_strmap_iter pos;\n\n\tassert(bld && filename);\n\n\tpos = git_strmap_lookup_index(bld->map, filename);\n\tif (git_strmap_valid_index(bld->map, pos))\n\t\tentry = git_strmap_value_at(bld->map, pos);\n\n\treturn entry;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_strmap_value_at",
          "args": [
            "bld->map",
            "pos"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_valid_index",
          "args": [
            "bld->map",
            "pos"
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_lookup_index",
          "args": [
            "bld->map",
            "filename"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "bld && filename"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic git_tree_entry *treebuilder_get(git_treebuilder *bld, const char *filename)\n{\n\tgit_tree_entry *entry = NULL;\n\tgit_strmap_iter pos;\n\n\tassert(bld && filename);\n\n\tpos = git_strmap_lookup_index(bld->map, filename);\n\tif (git_strmap_valid_index(bld->map, pos))\n\t\tentry = git_strmap_value_at(bld->map, pos);\n\n\treturn entry;\n}"
  },
  {
    "function_name": "git_treebuilder_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "723-769",
    "snippet": "int git_treebuilder_insert(\n\tconst git_tree_entry **entry_out,\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error;\n\tgit_strmap_iter pos;\n\n\tassert(bld && id && filename);\n\n\tif (!valid_filemode(filemode))\n\t\treturn tree_error(\"Failed to insert entry. Invalid filemode for file\", filename);\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tif (filemode != GIT_FILEMODE_COMMIT &&\n\t    !git_object__is_valid(bld->repo, id, otype_from_mode(filemode)))\n\t\treturn tree_error(\"Failed to insert entry; invalid object specified\", filename);\n\n\tpos = git_strmap_lookup_index(bld->map, filename);\n\tif (git_strmap_valid_index(bld->map, pos)) {\n\t\tentry = git_strmap_value_at(bld->map, pos);\n\t\tgit_oid_cpy((git_oid *) entry->oid, id);\n\t} else {\n\t\tentry = alloc_entry(filename, strlen(filename), id);\n\t\tGITERR_CHECK_ALLOC(entry);\n\n\t\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\n\t\tif (error < 0) {\n\t\t\tgit_tree_entry_free(entry);\n\t\t\tgiterr_set(GITERR_TREE, \"failed to insert %s\", filename);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tentry->attr = filemode;\n\n\tif (entry_out)\n\t\t*entry_out = entry;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_TREE",
            "\"failed to insert %s\"",
            "filename"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_free",
          "args": [
            "entry"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "229-235",
          "snippet": "void git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_insert",
          "args": [
            "bld->map",
            "entry->filename",
            "entry",
            "error"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "entry"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_entry",
          "args": [
            "filename",
            "strlen(filename)",
            "id"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "91-123",
          "snippet": "static git_tree_entry *alloc_entry(const char *filename, size_t filename_len, const git_oid *id)\n{\n\tgit_tree_entry *entry = NULL;\n\tsize_t tree_len;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&tree_len, sizeof(git_tree_entry), filename_len) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, 1) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, GIT_OID_RAWSZ))\n\t\treturn NULL;\n\n\tentry = git__calloc(1, tree_len);\n\tif (!entry)\n\t\treturn NULL;\n\n\t{\n\t\tchar *filename_ptr;\n\t\tvoid *id_ptr;\n\n\t\tfilename_ptr = ((char *) entry) + sizeof(git_tree_entry);\n\t\tmemcpy(filename_ptr, filename, filename_len);\n\t\tentry->filename = filename_ptr;\n\n\t\tid_ptr = filename_ptr + filename_len + 1;\n\t\tgit_oid_cpy(id_ptr, id);\n\t\tentry->oid = id_ptr;\n\t}\n\n\tentry->filename_len = (uint16_t)filename_len;\n\n\treturn entry;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic git_tree_entry *alloc_entry(const char *filename, size_t filename_len, const git_oid *id)\n{\n\tgit_tree_entry *entry = NULL;\n\tsize_t tree_len;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&tree_len, sizeof(git_tree_entry), filename_len) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, 1) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, GIT_OID_RAWSZ))\n\t\treturn NULL;\n\n\tentry = git__calloc(1, tree_len);\n\tif (!entry)\n\t\treturn NULL;\n\n\t{\n\t\tchar *filename_ptr;\n\t\tvoid *id_ptr;\n\n\t\tfilename_ptr = ((char *) entry) + sizeof(git_tree_entry);\n\t\tmemcpy(filename_ptr, filename, filename_len);\n\t\tentry->filename = filename_ptr;\n\n\t\tid_ptr = filename_ptr + filename_len + 1;\n\t\tgit_oid_cpy(id_ptr, id);\n\t\tentry->oid = id_ptr;\n\t}\n\n\tentry->filename_len = (uint16_t)filename_len;\n\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "filename"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "(git_oid *) entry->oid",
            "id"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_value_at",
          "args": [
            "bld->map",
            "pos"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_valid_index",
          "args": [
            "bld->map",
            "pos"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_lookup_index",
          "args": [
            "bld->map",
            "filename"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tree_error",
          "args": [
            "\"Failed to insert entry; invalid object specified\"",
            "filename"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "tree_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "395-402",
          "snippet": "static int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object__is_valid",
          "args": [
            "bld->repo",
            "id",
            "otype_from_mode(filemode)"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "git_object__is_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "467-489",
          "snippet": "bool git_object__is_valid(\n\tgit_repository *repo, const git_oid *id, git_otype expected_type)\n{\n\tgit_odb *odb;\n\tgit_otype actual_type;\n\tsize_t len;\n\tint error;\n\n\tif (!git_object__strict_input_validation)\n\t\treturn true;\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0 ||\n\t\t(error = git_odb_read_header(&len, &actual_type, odb, id)) < 0)\n\t\treturn false;\n\n\tif (expected_type != GIT_OBJ_ANY && expected_type != actual_type) {\n\t\tgiterr_set(GITERR_INVALID,\n\t\t\t\"the requested type does not match the type in the ODB\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "bool git_object__strict_input_validation = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nbool git_object__strict_input_validation = true;\n\nbool git_object__is_valid(\n\tgit_repository *repo, const git_oid *id, git_otype expected_type)\n{\n\tgit_odb *odb;\n\tgit_otype actual_type;\n\tsize_t len;\n\tint error;\n\n\tif (!git_object__strict_input_validation)\n\t\treturn true;\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0 ||\n\t\t(error = git_odb_read_header(&len, &actual_type, odb, id)) < 0)\n\t\treturn false;\n\n\tif (expected_type != GIT_OBJ_ANY && expected_type != actual_type) {\n\t\tgiterr_set(GITERR_INVALID,\n\t\t\t\"the requested type does not match the type in the ODB\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "otype_from_mode",
          "args": [
            "filemode"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "otype_from_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "711-721",
          "snippet": "static git_otype otype_from_mode(git_filemode_t filemode)\n{\n\tswitch (filemode) {\n\tcase GIT_FILEMODE_TREE:\n\t\treturn GIT_OBJ_TREE;\n\tcase GIT_FILEMODE_COMMIT:\n\t\treturn GIT_OBJ_COMMIT;\n\tdefault:\n\t\treturn GIT_OBJ_BLOB;\n\t}\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic git_otype otype_from_mode(git_filemode_t filemode)\n{\n\tswitch (filemode) {\n\tcase GIT_FILEMODE_TREE:\n\t\treturn GIT_OBJ_TREE;\n\tcase GIT_FILEMODE_COMMIT:\n\t\treturn GIT_OBJ_COMMIT;\n\tdefault:\n\t\treturn GIT_OBJ_BLOB;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "valid_entry_name",
          "args": [
            "bld->repo",
            "filename"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "valid_entry_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "56-61",
          "snippet": "static int valid_entry_name(git_repository *repo, const char *filename)\n{\n\treturn *filename != '\\0' &&\n\t\tgit_path_isvalid(repo, filename,\n\t\tGIT_PATH_REJECT_TRAVERSAL | GIT_PATH_REJECT_DOT_GIT | GIT_PATH_REJECT_SLASH);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int valid_entry_name(git_repository *repo, const char *filename)\n{\n\treturn *filename != '\\0' &&\n\t\tgit_path_isvalid(repo, filename,\n\t\tGIT_PATH_REJECT_TRAVERSAL | GIT_PATH_REJECT_DOT_GIT | GIT_PATH_REJECT_SLASH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "valid_filemode",
          "args": [
            "filemode"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "valid_filemode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "23-32",
          "snippet": "GIT__USE_STRMAP\n\nstatic bool valid_filemode(const int filemode)\n{\n\treturn (filemode == GIT_FILEMODE_TREE\n\t\t|| filemode == GIT_FILEMODE_BLOB\n\t\t|| filemode == GIT_FILEMODE_BLOB_EXECUTABLE\n\t\t|| filemode == GIT_FILEMODE_LINK\n\t\t|| filemode == GIT_FILEMODE_COMMIT);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nGIT__USE_STRMAP\n\nstatic bool valid_filemode(const int filemode)\n{\n\treturn (filemode == GIT_FILEMODE_TREE\n\t\t|| filemode == GIT_FILEMODE_BLOB\n\t\t|| filemode == GIT_FILEMODE_BLOB_EXECUTABLE\n\t\t|| filemode == GIT_FILEMODE_LINK\n\t\t|| filemode == GIT_FILEMODE_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "bld && id && filename"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_insert(\n\tconst git_tree_entry **entry_out,\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error;\n\tgit_strmap_iter pos;\n\n\tassert(bld && id && filename);\n\n\tif (!valid_filemode(filemode))\n\t\treturn tree_error(\"Failed to insert entry. Invalid filemode for file\", filename);\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tif (filemode != GIT_FILEMODE_COMMIT &&\n\t    !git_object__is_valid(bld->repo, id, otype_from_mode(filemode)))\n\t\treturn tree_error(\"Failed to insert entry; invalid object specified\", filename);\n\n\tpos = git_strmap_lookup_index(bld->map, filename);\n\tif (git_strmap_valid_index(bld->map, pos)) {\n\t\tentry = git_strmap_value_at(bld->map, pos);\n\t\tgit_oid_cpy((git_oid *) entry->oid, id);\n\t} else {\n\t\tentry = alloc_entry(filename, strlen(filename), id);\n\t\tGITERR_CHECK_ALLOC(entry);\n\n\t\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\n\t\tif (error < 0) {\n\t\t\tgit_tree_entry_free(entry);\n\t\t\tgiterr_set(GITERR_TREE, \"failed to insert %s\", filename);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tentry->attr = filemode;\n\n\tif (entry_out)\n\t\t*entry_out = entry;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "otype_from_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "711-721",
    "snippet": "static git_otype otype_from_mode(git_filemode_t filemode)\n{\n\tswitch (filemode) {\n\tcase GIT_FILEMODE_TREE:\n\t\treturn GIT_OBJ_TREE;\n\tcase GIT_FILEMODE_COMMIT:\n\t\treturn GIT_OBJ_COMMIT;\n\tdefault:\n\t\treturn GIT_OBJ_BLOB;\n\t}\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic git_otype otype_from_mode(git_filemode_t filemode)\n{\n\tswitch (filemode) {\n\tcase GIT_FILEMODE_TREE:\n\t\treturn GIT_OBJ_TREE;\n\tcase GIT_FILEMODE_COMMIT:\n\t\treturn GIT_OBJ_COMMIT;\n\tdefault:\n\t\treturn GIT_OBJ_BLOB;\n\t}\n}"
  },
  {
    "function_name": "git_treebuilder_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "671-709",
    "snippet": "int git_treebuilder_new(\n\tgit_treebuilder **builder_p,\n\tgit_repository *repo,\n\tconst git_tree *source)\n{\n\tgit_treebuilder *bld;\n\tsize_t i;\n\n\tassert(builder_p && repo);\n\n\tbld = git__calloc(1, sizeof(git_treebuilder));\n\tGITERR_CHECK_ALLOC(bld);\n\n\tbld->repo = repo;\n\n\tif (git_strmap_alloc(&bld->map) < 0) {\n\t\tgit__free(bld);\n\t\treturn -1;\n\t}\n\n\tif (source != NULL) {\n\t\tgit_tree_entry *entry_src;\n\n\t\tgit_array_foreach(source->entries, i, entry_src) {\n\t\t\tif (append_entry(\n\t\t\t\tbld, entry_src->filename,\n\t\t\t\tentry_src->oid,\n\t\t\t\tentry_src->attr) < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\t*builder_p = bld;\n\treturn 0;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_treebuilder_free",
          "args": [
            "bld"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "878-886",
          "snippet": "void git_treebuilder_free(git_treebuilder *bld)\n{\n\tif (bld == NULL)\n\t\treturn;\n\n\tgit_treebuilder_clear(bld);\n\tgit_strmap_free(bld->map);\n\tgit__free(bld);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_treebuilder_free(git_treebuilder *bld)\n{\n\tif (bld == NULL)\n\t\treturn;\n\n\tgit_treebuilder_clear(bld);\n\tgit_strmap_free(bld->map);\n\tgit__free(bld);\n}"
        }
      },
      {
        "call_info": {
          "callee": "append_entry",
          "args": [
            "bld",
            "entry_src->filename",
            "entry_src->oid",
            "entry_src->attr"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "append_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "491-516",
          "snippet": "static int append_entry(\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error = 0;\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tentry = alloc_entry(filename, strlen(filename), id);\n\tGITERR_CHECK_ALLOC(entry);\n\n\tentry->attr = (uint16_t)filemode;\n\n\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\tif (error < 0) {\n\t\tgit_tree_entry_free(entry);\n\t\tgiterr_set(GITERR_TREE, \"failed to append entry %s to the tree builder\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int append_entry(\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error = 0;\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tentry = alloc_entry(filename, strlen(filename), id);\n\tGITERR_CHECK_ALLOC(entry);\n\n\tentry->attr = (uint16_t)filemode;\n\n\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\tif (error < 0) {\n\t\tgit_tree_entry_free(entry);\n\t\tgiterr_set(GITERR_TREE, \"failed to append entry %s to the tree builder\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_foreach",
          "args": [
            "source->entries",
            "i",
            "entry_src"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "bld"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_alloc",
          "args": [
            "&bld->map"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "bld"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_treebuilder)"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "builder_p && repo"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_new(\n\tgit_treebuilder **builder_p,\n\tgit_repository *repo,\n\tconst git_tree *source)\n{\n\tgit_treebuilder *bld;\n\tsize_t i;\n\n\tassert(builder_p && repo);\n\n\tbld = git__calloc(1, sizeof(git_treebuilder));\n\tGITERR_CHECK_ALLOC(bld);\n\n\tbld->repo = repo;\n\n\tif (git_strmap_alloc(&bld->map) < 0) {\n\t\tgit__free(bld);\n\t\treturn -1;\n\t}\n\n\tif (source != NULL) {\n\t\tgit_tree_entry *entry_src;\n\n\t\tgit_array_foreach(source->entries, i, entry_src) {\n\t\t\tif (append_entry(\n\t\t\t\tbld, entry_src->filename,\n\t\t\t\tentry_src->oid,\n\t\t\t\tentry_src->attr) < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\t*builder_p = bld;\n\treturn 0;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}"
  },
  {
    "function_name": "git_tree__write_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "619-669",
    "snippet": "int git_tree__write_index(\n\tgit_oid *oid, git_index *index, git_repository *repo)\n{\n\tint ret;\n\tgit_tree *tree;\n\tbool old_ignore_case = false;\n\n\tassert(oid && index && repo);\n\n\tif (git_index_has_conflicts(index)) {\n\t\tgiterr_set(GITERR_INDEX,\n\t\t\t\"Cannot create a tree from a not fully merged index.\");\n\t\treturn GIT_EUNMERGED;\n\t}\n\n\tif (index->tree != NULL && index->tree->entry_count >= 0) {\n\t\tgit_oid_cpy(oid, &index->tree->oid);\n\t\treturn 0;\n\t}\n\n\t/* The tree cache didn't help us; we'll have to write\n\t * out a tree. If the index is ignore_case, we must\n\t * make it case-sensitive for the duration of the tree-write\n\t * operation. */\n\n\tif (index->ignore_case) {\n\t\told_ignore_case = true;\n\t\tgit_index__set_ignore_case(index, false);\n\t}\n\n\tret = write_tree(oid, repo, index, \"\", 0);\n\n\tif (old_ignore_case)\n\t\tgit_index__set_ignore_case(index, true);\n\n\tindex->tree = NULL;\n\n\tif (ret < 0)\n\t\treturn ret;\n\n\tgit_pool_clear(&index->tree_pool);\n\n\tif ((ret = git_tree_lookup(&tree, repo, oid)) < 0)\n\t\treturn ret;\n\n\t/* Read the tree cache into the index */\n\tret = git_tree_cache_read_tree(&index->tree, tree, &index->tree_pool);\n\tgit_tree_free(tree);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "tree"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_cache_read_tree",
          "args": [
            "&index->tree",
            "tree",
            "&index->tree_pool"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_cache_read_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree-cache.c",
          "lines": "217-230",
          "snippet": "int git_tree_cache_read_tree(git_tree_cache **out, const git_tree *tree, git_pool *pool)\n{\n\tint error;\n\tgit_tree_cache *cache;\n\n\tif ((error = git_tree_cache_new(&cache, \"\", pool)) < 0)\n\t\treturn error;\n\n\tif ((error = read_tree_recursive(cache, tree, pool)) < 0)\n\t\treturn error;\n\n\t*out = cache;\n\treturn 0;\n}",
          "includes": [
            "#include \"tree.h\"",
            "#include \"pool.h\"",
            "#include \"tree-cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tree.h\"\n#include \"pool.h\"\n#include \"tree-cache.h\"\n\nint git_tree_cache_read_tree(git_tree_cache **out, const git_tree *tree, git_pool *pool)\n{\n\tint error;\n\tgit_tree_cache *cache;\n\n\tif ((error = git_tree_cache_new(&cache, \"\", pool)) < 0)\n\t\treturn error;\n\n\tif ((error = read_tree_recursive(cache, tree, pool)) < 0)\n\t\treturn error;\n\n\t*out = cache;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_lookup",
          "args": [
            "&tree",
            "repo",
            "oid"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "49-52",
          "snippet": "int git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pool_clear",
          "args": [
            "&index->tree_pool"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "131-134",
          "snippet": "void git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index__set_ignore_case",
          "args": [
            "index",
            "true"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "git_index__set_ignore_case",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "380-402",
          "snippet": "void git_index__set_ignore_case(git_index *index, bool ignore_case)\n{\n\tindex->ignore_case = ignore_case;\n\n\tif (ignore_case) {\n\t\tindex->entries_cmp_path    = git__strcasecmp_cb;\n\t\tindex->entries_search      = git_index_entry_isrch;\n\t\tindex->entries_search_path = index_entry_isrch_path;\n\t\tindex->reuc_search         = reuc_isrch;\n\t} else {\n\t\tindex->entries_cmp_path    = git__strcmp_cb;\n\t\tindex->entries_search      = git_index_entry_srch;\n\t\tindex->entries_search_path = index_entry_srch_path;\n\t\tindex->reuc_search         = reuc_srch;\n\t}\n\n\tgit_vector_set_cmp(&index->entries,\n\t\tignore_case ? git_index_entry_icmp : git_index_entry_cmp);\n\tgit_vector_sort(&index->entries);\n\n\tgit_vector_set_cmp(&index->reuc, ignore_case ? reuc_icmp : reuc_cmp);\n\tgit_vector_sort(&index->reuc);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);",
            "static void index_entry_reuc_free(git_index_reuc_entry *reuc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\nstatic void index_entry_reuc_free(git_index_reuc_entry *reuc);\n\nvoid git_index__set_ignore_case(git_index *index, bool ignore_case)\n{\n\tindex->ignore_case = ignore_case;\n\n\tif (ignore_case) {\n\t\tindex->entries_cmp_path    = git__strcasecmp_cb;\n\t\tindex->entries_search      = git_index_entry_isrch;\n\t\tindex->entries_search_path = index_entry_isrch_path;\n\t\tindex->reuc_search         = reuc_isrch;\n\t} else {\n\t\tindex->entries_cmp_path    = git__strcmp_cb;\n\t\tindex->entries_search      = git_index_entry_srch;\n\t\tindex->entries_search_path = index_entry_srch_path;\n\t\tindex->reuc_search         = reuc_srch;\n\t}\n\n\tgit_vector_set_cmp(&index->entries,\n\t\tignore_case ? git_index_entry_icmp : git_index_entry_cmp);\n\tgit_vector_sort(&index->entries);\n\n\tgit_vector_set_cmp(&index->reuc, ignore_case ? reuc_icmp : reuc_cmp);\n\tgit_vector_sort(&index->reuc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "write_tree",
          "args": [
            "oid",
            "repo",
            "index",
            "\"\"",
            "0"
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "write_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "518-617",
          "snippet": "static int write_tree(\n\tgit_oid *oid,\n\tgit_repository *repo,\n\tgit_index *index,\n\tconst char *dirname,\n\tsize_t start)\n{\n\tgit_treebuilder *bld = NULL;\n\tsize_t i, entries = git_index_entrycount(index);\n\tint error;\n\tsize_t dirname_len = strlen(dirname);\n\tconst git_tree_cache *cache;\n\n\tcache = git_tree_cache_get(index->tree, dirname);\n\tif (cache != NULL && cache->entry_count >= 0){\n\t\tgit_oid_cpy(oid, &cache->oid);\n\t\treturn (int)find_next_dir(dirname, index, start);\n\t}\n\n\tif ((error = git_treebuilder_new(&bld, repo, NULL)) < 0 || bld == NULL)\n\t\treturn -1;\n\n\t/*\n\t * This loop is unfortunate, but necessary. The index doesn't have\n\t * any directores, so we need to handle that manually, and we\n\t * need to keep track of the current position.\n\t */\n\tfor (i = start; i < entries; ++i) {\n\t\tconst git_index_entry *entry = git_index_get_byindex(index, i);\n\t\tconst char *filename, *next_slash;\n\n\t/*\n\t * If we've left our (sub)tree, exit the loop and return. The\n\t * first check is an early out (and security for the\n\t * third). The second check is a simple prefix comparison. The\n\t * third check catches situations where there is a directory\n\t * win32/sys and a file win32mmap.c. Without it, the following\n\t * code believes there is a file win32/mmap.c\n\t */\n\t\tif (strlen(entry->path) < dirname_len ||\n\t\t    memcmp(entry->path, dirname, dirname_len) ||\n\t\t    (dirname_len > 0 && entry->path[dirname_len] != '/')) {\n\t\t\tbreak;\n\t\t}\n\n\t\tfilename = entry->path + dirname_len;\n\t\tif (*filename == '/')\n\t\t\tfilename++;\n\t\tnext_slash = strchr(filename, '/');\n\t\tif (next_slash) {\n\t\t\tgit_oid sub_oid;\n\t\t\tint written;\n\t\t\tchar *subdir, *last_comp;\n\n\t\t\tsubdir = git__strndup(entry->path, next_slash - entry->path);\n\t\t\tGITERR_CHECK_ALLOC(subdir);\n\n\t\t\t/* Write out the subtree */\n\t\t\twritten = write_tree(&sub_oid, repo, index, subdir, i);\n\t\t\tif (written < 0) {\n\t\t\t\tgit__free(subdir);\n\t\t\t\tgoto on_error;\n\t\t\t} else {\n\t\t\t\ti = written - 1; /* -1 because of the loop increment */\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * We need to figure out what we want toinsert\n\t\t\t * into this tree. If we're traversing\n\t\t\t * deps/zlib/, then we only want to write\n\t\t\t * 'zlib' into the tree.\n\t\t\t */\n\t\t\tlast_comp = strrchr(subdir, '/');\n\t\t\tif (last_comp) {\n\t\t\t\tlast_comp++; /* Get rid of the '/' */\n\t\t\t} else {\n\t\t\t\tlast_comp = subdir;\n\t\t\t}\n\n\t\t\terror = append_entry(bld, last_comp, &sub_oid, S_IFDIR);\n\t\t\tgit__free(subdir);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t} else {\n\t\t\terror = append_entry(bld, filename, &entry->id, entry->mode);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\tif (git_treebuilder_write(oid, bld) < 0)\n\t\tgoto on_error;\n\n\tgit_treebuilder_free(bld);\n\treturn (int)i;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int write_tree(\n\tgit_oid *oid,\n\tgit_repository *repo,\n\tgit_index *index,\n\tconst char *dirname,\n\tsize_t start)\n{\n\tgit_treebuilder *bld = NULL;\n\tsize_t i, entries = git_index_entrycount(index);\n\tint error;\n\tsize_t dirname_len = strlen(dirname);\n\tconst git_tree_cache *cache;\n\n\tcache = git_tree_cache_get(index->tree, dirname);\n\tif (cache != NULL && cache->entry_count >= 0){\n\t\tgit_oid_cpy(oid, &cache->oid);\n\t\treturn (int)find_next_dir(dirname, index, start);\n\t}\n\n\tif ((error = git_treebuilder_new(&bld, repo, NULL)) < 0 || bld == NULL)\n\t\treturn -1;\n\n\t/*\n\t * This loop is unfortunate, but necessary. The index doesn't have\n\t * any directores, so we need to handle that manually, and we\n\t * need to keep track of the current position.\n\t */\n\tfor (i = start; i < entries; ++i) {\n\t\tconst git_index_entry *entry = git_index_get_byindex(index, i);\n\t\tconst char *filename, *next_slash;\n\n\t/*\n\t * If we've left our (sub)tree, exit the loop and return. The\n\t * first check is an early out (and security for the\n\t * third). The second check is a simple prefix comparison. The\n\t * third check catches situations where there is a directory\n\t * win32/sys and a file win32mmap.c. Without it, the following\n\t * code believes there is a file win32/mmap.c\n\t */\n\t\tif (strlen(entry->path) < dirname_len ||\n\t\t    memcmp(entry->path, dirname, dirname_len) ||\n\t\t    (dirname_len > 0 && entry->path[dirname_len] != '/')) {\n\t\t\tbreak;\n\t\t}\n\n\t\tfilename = entry->path + dirname_len;\n\t\tif (*filename == '/')\n\t\t\tfilename++;\n\t\tnext_slash = strchr(filename, '/');\n\t\tif (next_slash) {\n\t\t\tgit_oid sub_oid;\n\t\t\tint written;\n\t\t\tchar *subdir, *last_comp;\n\n\t\t\tsubdir = git__strndup(entry->path, next_slash - entry->path);\n\t\t\tGITERR_CHECK_ALLOC(subdir);\n\n\t\t\t/* Write out the subtree */\n\t\t\twritten = write_tree(&sub_oid, repo, index, subdir, i);\n\t\t\tif (written < 0) {\n\t\t\t\tgit__free(subdir);\n\t\t\t\tgoto on_error;\n\t\t\t} else {\n\t\t\t\ti = written - 1; /* -1 because of the loop increment */\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * We need to figure out what we want toinsert\n\t\t\t * into this tree. If we're traversing\n\t\t\t * deps/zlib/, then we only want to write\n\t\t\t * 'zlib' into the tree.\n\t\t\t */\n\t\t\tlast_comp = strrchr(subdir, '/');\n\t\t\tif (last_comp) {\n\t\t\t\tlast_comp++; /* Get rid of the '/' */\n\t\t\t} else {\n\t\t\t\tlast_comp = subdir;\n\t\t\t}\n\n\t\t\terror = append_entry(bld, last_comp, &sub_oid, S_IFDIR);\n\t\t\tgit__free(subdir);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t} else {\n\t\t\terror = append_entry(bld, filename, &entry->id, entry->mode);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\tif (git_treebuilder_write(oid, bld) < 0)\n\t\tgoto on_error;\n\n\tgit_treebuilder_free(bld);\n\treturn (int)i;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "oid",
            "&index->tree->oid"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INDEX",
            "\"Cannot create a tree from a not fully merged index.\""
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_has_conflicts",
          "args": [
            "index"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_has_conflicts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "1887-1900",
          "snippet": "int git_index_has_conflicts(const git_index *index)\n{\n\tsize_t i;\n\tgit_index_entry *entry;\n\n\tassert(index);\n\n\tgit_vector_foreach(&index->entries, i, entry) {\n\t\tif (GIT_IDXENTRY_STAGE(entry) > 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);",
            "static void index_entry_free(git_index_entry *entry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\nstatic void index_entry_free(git_index_entry *entry);\n\nint git_index_has_conflicts(const git_index *index)\n{\n\tsize_t i;\n\tgit_index_entry *entry;\n\n\tassert(index);\n\n\tgit_vector_foreach(&index->entries, i, entry) {\n\t\tif (GIT_IDXENTRY_STAGE(entry) > 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "oid && index && repo"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tree__write_index(\n\tgit_oid *oid, git_index *index, git_repository *repo)\n{\n\tint ret;\n\tgit_tree *tree;\n\tbool old_ignore_case = false;\n\n\tassert(oid && index && repo);\n\n\tif (git_index_has_conflicts(index)) {\n\t\tgiterr_set(GITERR_INDEX,\n\t\t\t\"Cannot create a tree from a not fully merged index.\");\n\t\treturn GIT_EUNMERGED;\n\t}\n\n\tif (index->tree != NULL && index->tree->entry_count >= 0) {\n\t\tgit_oid_cpy(oid, &index->tree->oid);\n\t\treturn 0;\n\t}\n\n\t/* The tree cache didn't help us; we'll have to write\n\t * out a tree. If the index is ignore_case, we must\n\t * make it case-sensitive for the duration of the tree-write\n\t * operation. */\n\n\tif (index->ignore_case) {\n\t\told_ignore_case = true;\n\t\tgit_index__set_ignore_case(index, false);\n\t}\n\n\tret = write_tree(oid, repo, index, \"\", 0);\n\n\tif (old_ignore_case)\n\t\tgit_index__set_ignore_case(index, true);\n\n\tindex->tree = NULL;\n\n\tif (ret < 0)\n\t\treturn ret;\n\n\tgit_pool_clear(&index->tree_pool);\n\n\tif ((ret = git_tree_lookup(&tree, repo, oid)) < 0)\n\t\treturn ret;\n\n\t/* Read the tree cache into the index */\n\tret = git_tree_cache_read_tree(&index->tree, tree, &index->tree_pool);\n\tgit_tree_free(tree);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "write_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "518-617",
    "snippet": "static int write_tree(\n\tgit_oid *oid,\n\tgit_repository *repo,\n\tgit_index *index,\n\tconst char *dirname,\n\tsize_t start)\n{\n\tgit_treebuilder *bld = NULL;\n\tsize_t i, entries = git_index_entrycount(index);\n\tint error;\n\tsize_t dirname_len = strlen(dirname);\n\tconst git_tree_cache *cache;\n\n\tcache = git_tree_cache_get(index->tree, dirname);\n\tif (cache != NULL && cache->entry_count >= 0){\n\t\tgit_oid_cpy(oid, &cache->oid);\n\t\treturn (int)find_next_dir(dirname, index, start);\n\t}\n\n\tif ((error = git_treebuilder_new(&bld, repo, NULL)) < 0 || bld == NULL)\n\t\treturn -1;\n\n\t/*\n\t * This loop is unfortunate, but necessary. The index doesn't have\n\t * any directores, so we need to handle that manually, and we\n\t * need to keep track of the current position.\n\t */\n\tfor (i = start; i < entries; ++i) {\n\t\tconst git_index_entry *entry = git_index_get_byindex(index, i);\n\t\tconst char *filename, *next_slash;\n\n\t/*\n\t * If we've left our (sub)tree, exit the loop and return. The\n\t * first check is an early out (and security for the\n\t * third). The second check is a simple prefix comparison. The\n\t * third check catches situations where there is a directory\n\t * win32/sys and a file win32mmap.c. Without it, the following\n\t * code believes there is a file win32/mmap.c\n\t */\n\t\tif (strlen(entry->path) < dirname_len ||\n\t\t    memcmp(entry->path, dirname, dirname_len) ||\n\t\t    (dirname_len > 0 && entry->path[dirname_len] != '/')) {\n\t\t\tbreak;\n\t\t}\n\n\t\tfilename = entry->path + dirname_len;\n\t\tif (*filename == '/')\n\t\t\tfilename++;\n\t\tnext_slash = strchr(filename, '/');\n\t\tif (next_slash) {\n\t\t\tgit_oid sub_oid;\n\t\t\tint written;\n\t\t\tchar *subdir, *last_comp;\n\n\t\t\tsubdir = git__strndup(entry->path, next_slash - entry->path);\n\t\t\tGITERR_CHECK_ALLOC(subdir);\n\n\t\t\t/* Write out the subtree */\n\t\t\twritten = write_tree(&sub_oid, repo, index, subdir, i);\n\t\t\tif (written < 0) {\n\t\t\t\tgit__free(subdir);\n\t\t\t\tgoto on_error;\n\t\t\t} else {\n\t\t\t\ti = written - 1; /* -1 because of the loop increment */\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * We need to figure out what we want toinsert\n\t\t\t * into this tree. If we're traversing\n\t\t\t * deps/zlib/, then we only want to write\n\t\t\t * 'zlib' into the tree.\n\t\t\t */\n\t\t\tlast_comp = strrchr(subdir, '/');\n\t\t\tif (last_comp) {\n\t\t\t\tlast_comp++; /* Get rid of the '/' */\n\t\t\t} else {\n\t\t\t\tlast_comp = subdir;\n\t\t\t}\n\n\t\t\terror = append_entry(bld, last_comp, &sub_oid, S_IFDIR);\n\t\t\tgit__free(subdir);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t} else {\n\t\t\terror = append_entry(bld, filename, &entry->id, entry->mode);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\tif (git_treebuilder_write(oid, bld) < 0)\n\t\tgoto on_error;\n\n\tgit_treebuilder_free(bld);\n\treturn (int)i;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_treebuilder_free",
          "args": [
            "bld"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "878-886",
          "snippet": "void git_treebuilder_free(git_treebuilder *bld)\n{\n\tif (bld == NULL)\n\t\treturn;\n\n\tgit_treebuilder_clear(bld);\n\tgit_strmap_free(bld->map);\n\tgit__free(bld);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_treebuilder_free(git_treebuilder *bld)\n{\n\tif (bld == NULL)\n\t\treturn;\n\n\tgit_treebuilder_clear(bld);\n\tgit_strmap_free(bld->map);\n\tgit__free(bld);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_treebuilder_write",
          "args": [
            "oid",
            "bld"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "803-848",
          "snippet": "int git_treebuilder_write(git_oid *oid, git_treebuilder *bld)\n{\n\tint error = 0;\n\tsize_t i, entrycount;\n\tgit_buf tree = GIT_BUF_INIT;\n\tgit_odb *odb;\n\tgit_tree_entry *entry;\n\tgit_vector entries;\n\n\tassert(bld);\n\n\tentrycount = git_strmap_num_entries(bld->map);\n\tif (git_vector_init(&entries, entrycount, entry_sort_cmp) < 0)\n\t\treturn -1;\n\n\tgit_strmap_foreach_value(bld->map, entry, {\n\t\tif (git_vector_insert(&entries, entry) < 0)\n\t\t\treturn -1;\n\t});\n\n\tgit_vector_sort(&entries);\n\n\t/* Grow the buffer beforehand to an estimated size */\n\terror = git_buf_grow(&tree, entrycount * 72);\n\n\tfor (i = 0; i < entries.length && !error; ++i) {\n\t\tgit_tree_entry *entry = git_vector_get(&entries, i);\n\n\t\tgit_buf_printf(&tree, \"%o \", entry->attr);\n\t\tgit_buf_put(&tree, entry->filename, entry->filename_len + 1);\n\t\tgit_buf_put(&tree, (char *)entry->oid->id, GIT_OID_RAWSZ);\n\n\t\tif (git_buf_oom(&tree))\n\t\t\terror = -1;\n\t}\n\n\n\tif (!error &&\n\t\t!(error = git_repository_odb__weakptr(&odb, bld->repo)))\n\t\terror = git_odb_write(oid, odb, tree.ptr, tree.size, GIT_OBJ_TREE);\n\n\tgit_buf_free(&tree);\n\tgit_vector_free(&entries);\n\n\treturn error;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_write(git_oid *oid, git_treebuilder *bld)\n{\n\tint error = 0;\n\tsize_t i, entrycount;\n\tgit_buf tree = GIT_BUF_INIT;\n\tgit_odb *odb;\n\tgit_tree_entry *entry;\n\tgit_vector entries;\n\n\tassert(bld);\n\n\tentrycount = git_strmap_num_entries(bld->map);\n\tif (git_vector_init(&entries, entrycount, entry_sort_cmp) < 0)\n\t\treturn -1;\n\n\tgit_strmap_foreach_value(bld->map, entry, {\n\t\tif (git_vector_insert(&entries, entry) < 0)\n\t\t\treturn -1;\n\t});\n\n\tgit_vector_sort(&entries);\n\n\t/* Grow the buffer beforehand to an estimated size */\n\terror = git_buf_grow(&tree, entrycount * 72);\n\n\tfor (i = 0; i < entries.length && !error; ++i) {\n\t\tgit_tree_entry *entry = git_vector_get(&entries, i);\n\n\t\tgit_buf_printf(&tree, \"%o \", entry->attr);\n\t\tgit_buf_put(&tree, entry->filename, entry->filename_len + 1);\n\t\tgit_buf_put(&tree, (char *)entry->oid->id, GIT_OID_RAWSZ);\n\n\t\tif (git_buf_oom(&tree))\n\t\t\terror = -1;\n\t}\n\n\n\tif (!error &&\n\t\t!(error = git_repository_odb__weakptr(&odb, bld->repo)))\n\t\terror = git_odb_write(oid, odb, tree.ptr, tree.size, GIT_OBJ_TREE);\n\n\tgit_buf_free(&tree);\n\tgit_vector_free(&entries);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "append_entry",
          "args": [
            "bld",
            "filename",
            "&entry->id",
            "entry->mode"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "append_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "491-516",
          "snippet": "static int append_entry(\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error = 0;\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tentry = alloc_entry(filename, strlen(filename), id);\n\tGITERR_CHECK_ALLOC(entry);\n\n\tentry->attr = (uint16_t)filemode;\n\n\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\tif (error < 0) {\n\t\tgit_tree_entry_free(entry);\n\t\tgiterr_set(GITERR_TREE, \"failed to append entry %s to the tree builder\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int append_entry(\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error = 0;\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tentry = alloc_entry(filename, strlen(filename), id);\n\tGITERR_CHECK_ALLOC(entry);\n\n\tentry->attr = (uint16_t)filemode;\n\n\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\tif (error < 0) {\n\t\tgit_tree_entry_free(entry);\n\t\tgiterr_set(GITERR_TREE, \"failed to append entry %s to the tree builder\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "subdir"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "subdir",
            "'/'"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write_tree",
          "args": [
            "&sub_oid",
            "repo",
            "index",
            "subdir",
            "i"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "write_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "518-617",
          "snippet": "static int write_tree(\n\tgit_oid *oid,\n\tgit_repository *repo,\n\tgit_index *index,\n\tconst char *dirname,\n\tsize_t start)\n{\n\tgit_treebuilder *bld = NULL;\n\tsize_t i, entries = git_index_entrycount(index);\n\tint error;\n\tsize_t dirname_len = strlen(dirname);\n\tconst git_tree_cache *cache;\n\n\tcache = git_tree_cache_get(index->tree, dirname);\n\tif (cache != NULL && cache->entry_count >= 0){\n\t\tgit_oid_cpy(oid, &cache->oid);\n\t\treturn (int)find_next_dir(dirname, index, start);\n\t}\n\n\tif ((error = git_treebuilder_new(&bld, repo, NULL)) < 0 || bld == NULL)\n\t\treturn -1;\n\n\t/*\n\t * This loop is unfortunate, but necessary. The index doesn't have\n\t * any directores, so we need to handle that manually, and we\n\t * need to keep track of the current position.\n\t */\n\tfor (i = start; i < entries; ++i) {\n\t\tconst git_index_entry *entry = git_index_get_byindex(index, i);\n\t\tconst char *filename, *next_slash;\n\n\t/*\n\t * If we've left our (sub)tree, exit the loop and return. The\n\t * first check is an early out (and security for the\n\t * third). The second check is a simple prefix comparison. The\n\t * third check catches situations where there is a directory\n\t * win32/sys and a file win32mmap.c. Without it, the following\n\t * code believes there is a file win32/mmap.c\n\t */\n\t\tif (strlen(entry->path) < dirname_len ||\n\t\t    memcmp(entry->path, dirname, dirname_len) ||\n\t\t    (dirname_len > 0 && entry->path[dirname_len] != '/')) {\n\t\t\tbreak;\n\t\t}\n\n\t\tfilename = entry->path + dirname_len;\n\t\tif (*filename == '/')\n\t\t\tfilename++;\n\t\tnext_slash = strchr(filename, '/');\n\t\tif (next_slash) {\n\t\t\tgit_oid sub_oid;\n\t\t\tint written;\n\t\t\tchar *subdir, *last_comp;\n\n\t\t\tsubdir = git__strndup(entry->path, next_slash - entry->path);\n\t\t\tGITERR_CHECK_ALLOC(subdir);\n\n\t\t\t/* Write out the subtree */\n\t\t\twritten = write_tree(&sub_oid, repo, index, subdir, i);\n\t\t\tif (written < 0) {\n\t\t\t\tgit__free(subdir);\n\t\t\t\tgoto on_error;\n\t\t\t} else {\n\t\t\t\ti = written - 1; /* -1 because of the loop increment */\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * We need to figure out what we want toinsert\n\t\t\t * into this tree. If we're traversing\n\t\t\t * deps/zlib/, then we only want to write\n\t\t\t * 'zlib' into the tree.\n\t\t\t */\n\t\t\tlast_comp = strrchr(subdir, '/');\n\t\t\tif (last_comp) {\n\t\t\t\tlast_comp++; /* Get rid of the '/' */\n\t\t\t} else {\n\t\t\t\tlast_comp = subdir;\n\t\t\t}\n\n\t\t\terror = append_entry(bld, last_comp, &sub_oid, S_IFDIR);\n\t\t\tgit__free(subdir);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t} else {\n\t\t\terror = append_entry(bld, filename, &entry->id, entry->mode);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\tif (git_treebuilder_write(oid, bld) < 0)\n\t\tgoto on_error;\n\n\tgit_treebuilder_free(bld);\n\treturn (int)i;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "subdir"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strndup",
          "args": [
            "entry->path",
            "next_slash - entry->path"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "git__strndup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "181-198",
          "snippet": "GIT_INLINE(char *) git__strndup(const char *str, size_t n)\n{\n\tsize_t length = 0, alloclength;\n\tchar *ptr;\n\n\tlength = p_strnlen(str, n);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclength, length, 1) ||\n\t\t!(ptr = git__malloc(alloclength)))\n\t\treturn NULL;\n\n\tif (length)\n\t\tmemcpy(ptr, str, length);\n\n\tptr[length] = '\\0';\n\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strndup(const char *str, size_t n)\n{\n\tsize_t length = 0, alloclength;\n\tchar *ptr;\n\n\tlength = p_strnlen(str, n);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclength, length, 1) ||\n\t\t!(ptr = git__malloc(alloclength)))\n\t\treturn NULL;\n\n\tif (length)\n\t\tmemcpy(ptr, str, length);\n\n\tptr[length] = '\\0';\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "filename",
            "'/'"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "entry->path",
            "dirname",
            "dirname_len"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "entry->path"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_index_get_byindex",
          "args": [
            "index",
            "i"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_get_byindex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "799-805",
          "snippet": "const git_index_entry *git_index_get_byindex(\n\tgit_index *index, size_t n)\n{\n\tassert(index);\n\tgit_vector_sort(&index->entries);\n\treturn git_vector_get(&index->entries, n);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nconst git_index_entry *git_index_get_byindex(\n\tgit_index *index, size_t n)\n{\n\tassert(index);\n\tgit_vector_sort(&index->entries);\n\treturn git_vector_get(&index->entries, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_treebuilder_new",
          "args": [
            "&bld",
            "repo",
            "NULL"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "git_treebuilder_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "671-709",
          "snippet": "int git_treebuilder_new(\n\tgit_treebuilder **builder_p,\n\tgit_repository *repo,\n\tconst git_tree *source)\n{\n\tgit_treebuilder *bld;\n\tsize_t i;\n\n\tassert(builder_p && repo);\n\n\tbld = git__calloc(1, sizeof(git_treebuilder));\n\tGITERR_CHECK_ALLOC(bld);\n\n\tbld->repo = repo;\n\n\tif (git_strmap_alloc(&bld->map) < 0) {\n\t\tgit__free(bld);\n\t\treturn -1;\n\t}\n\n\tif (source != NULL) {\n\t\tgit_tree_entry *entry_src;\n\n\t\tgit_array_foreach(source->entries, i, entry_src) {\n\t\t\tif (append_entry(\n\t\t\t\tbld, entry_src->filename,\n\t\t\t\tentry_src->oid,\n\t\t\t\tentry_src->attr) < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\t*builder_p = bld;\n\treturn 0;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_treebuilder_new(\n\tgit_treebuilder **builder_p,\n\tgit_repository *repo,\n\tconst git_tree *source)\n{\n\tgit_treebuilder *bld;\n\tsize_t i;\n\n\tassert(builder_p && repo);\n\n\tbld = git__calloc(1, sizeof(git_treebuilder));\n\tGITERR_CHECK_ALLOC(bld);\n\n\tbld->repo = repo;\n\n\tif (git_strmap_alloc(&bld->map) < 0) {\n\t\tgit__free(bld);\n\t\treturn -1;\n\t}\n\n\tif (source != NULL) {\n\t\tgit_tree_entry *entry_src;\n\n\t\tgit_array_foreach(source->entries, i, entry_src) {\n\t\t\tif (append_entry(\n\t\t\t\tbld, entry_src->filename,\n\t\t\t\tentry_src->oid,\n\t\t\t\tentry_src->attr) < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\t*builder_p = bld;\n\treturn 0;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_next_dir",
          "args": [
            "dirname",
            "index",
            "start"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "find_next_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "474-489",
          "snippet": "static size_t find_next_dir(const char *dirname, git_index *index, size_t start)\n{\n\tsize_t dirlen, i, entries = git_index_entrycount(index);\n\n\tdirlen = strlen(dirname);\n\tfor (i = start; i < entries; ++i) {\n\t\tconst git_index_entry *entry = git_index_get_byindex(index, i);\n\t\tif (strlen(entry->path) < dirlen ||\n\t\t    memcmp(entry->path, dirname, dirlen) ||\n\t\t\t(dirlen > 0 && entry->path[dirlen] != '/')) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn i;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic size_t find_next_dir(const char *dirname, git_index *index, size_t start)\n{\n\tsize_t dirlen, i, entries = git_index_entrycount(index);\n\n\tdirlen = strlen(dirname);\n\tfor (i = start; i < entries; ++i) {\n\t\tconst git_index_entry *entry = git_index_get_byindex(index, i);\n\t\tif (strlen(entry->path) < dirlen ||\n\t\t    memcmp(entry->path, dirname, dirlen) ||\n\t\t\t(dirlen > 0 && entry->path[dirlen] != '/')) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "oid",
            "&cache->oid"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_cache_get",
          "args": [
            "index->tree",
            "dirname"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_cache_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree-cache.c",
          "lines": "51-71",
          "snippet": "const git_tree_cache *git_tree_cache_get(const git_tree_cache *tree, const char *path)\n{\n\tconst char *ptr = path, *end;\n\n\tif (tree == NULL) {\n\t\treturn NULL;\n\t}\n\n\twhile (1) {\n\t\tend = strchr(ptr, '/');\n\n\t\ttree = find_child(tree, ptr, end);\n\t\tif (tree == NULL) /* Can't find it */\n\t\t\treturn NULL;\n\n\t\tif (end == NULL || *end + 1 == '\\0')\n\t\t\treturn tree;\n\n\t\tptr = end + 1;\n\t}\n}",
          "includes": [
            "#include \"tree.h\"",
            "#include \"pool.h\"",
            "#include \"tree-cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tree.h\"\n#include \"pool.h\"\n#include \"tree-cache.h\"\n\nconst git_tree_cache *git_tree_cache_get(const git_tree_cache *tree, const char *path)\n{\n\tconst char *ptr = path, *end;\n\n\tif (tree == NULL) {\n\t\treturn NULL;\n\t}\n\n\twhile (1) {\n\t\tend = strchr(ptr, '/');\n\n\t\ttree = find_child(tree, ptr, end);\n\t\tif (tree == NULL) /* Can't find it */\n\t\t\treturn NULL;\n\n\t\tif (end == NULL || *end + 1 == '\\0')\n\t\t\treturn tree;\n\n\t\tptr = end + 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "dirname"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_index_entrycount",
          "args": [
            "index"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_entrycount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "793-797",
          "snippet": "size_t git_index_entrycount(const git_index *index)\n{\n\tassert(index);\n\treturn index->entries.length;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nsize_t git_index_entrycount(const git_index *index)\n{\n\tassert(index);\n\treturn index->entries.length;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int write_tree(\n\tgit_oid *oid,\n\tgit_repository *repo,\n\tgit_index *index,\n\tconst char *dirname,\n\tsize_t start)\n{\n\tgit_treebuilder *bld = NULL;\n\tsize_t i, entries = git_index_entrycount(index);\n\tint error;\n\tsize_t dirname_len = strlen(dirname);\n\tconst git_tree_cache *cache;\n\n\tcache = git_tree_cache_get(index->tree, dirname);\n\tif (cache != NULL && cache->entry_count >= 0){\n\t\tgit_oid_cpy(oid, &cache->oid);\n\t\treturn (int)find_next_dir(dirname, index, start);\n\t}\n\n\tif ((error = git_treebuilder_new(&bld, repo, NULL)) < 0 || bld == NULL)\n\t\treturn -1;\n\n\t/*\n\t * This loop is unfortunate, but necessary. The index doesn't have\n\t * any directores, so we need to handle that manually, and we\n\t * need to keep track of the current position.\n\t */\n\tfor (i = start; i < entries; ++i) {\n\t\tconst git_index_entry *entry = git_index_get_byindex(index, i);\n\t\tconst char *filename, *next_slash;\n\n\t/*\n\t * If we've left our (sub)tree, exit the loop and return. The\n\t * first check is an early out (and security for the\n\t * third). The second check is a simple prefix comparison. The\n\t * third check catches situations where there is a directory\n\t * win32/sys and a file win32mmap.c. Without it, the following\n\t * code believes there is a file win32/mmap.c\n\t */\n\t\tif (strlen(entry->path) < dirname_len ||\n\t\t    memcmp(entry->path, dirname, dirname_len) ||\n\t\t    (dirname_len > 0 && entry->path[dirname_len] != '/')) {\n\t\t\tbreak;\n\t\t}\n\n\t\tfilename = entry->path + dirname_len;\n\t\tif (*filename == '/')\n\t\t\tfilename++;\n\t\tnext_slash = strchr(filename, '/');\n\t\tif (next_slash) {\n\t\t\tgit_oid sub_oid;\n\t\t\tint written;\n\t\t\tchar *subdir, *last_comp;\n\n\t\t\tsubdir = git__strndup(entry->path, next_slash - entry->path);\n\t\t\tGITERR_CHECK_ALLOC(subdir);\n\n\t\t\t/* Write out the subtree */\n\t\t\twritten = write_tree(&sub_oid, repo, index, subdir, i);\n\t\t\tif (written < 0) {\n\t\t\t\tgit__free(subdir);\n\t\t\t\tgoto on_error;\n\t\t\t} else {\n\t\t\t\ti = written - 1; /* -1 because of the loop increment */\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * We need to figure out what we want toinsert\n\t\t\t * into this tree. If we're traversing\n\t\t\t * deps/zlib/, then we only want to write\n\t\t\t * 'zlib' into the tree.\n\t\t\t */\n\t\t\tlast_comp = strrchr(subdir, '/');\n\t\t\tif (last_comp) {\n\t\t\t\tlast_comp++; /* Get rid of the '/' */\n\t\t\t} else {\n\t\t\t\tlast_comp = subdir;\n\t\t\t}\n\n\t\t\terror = append_entry(bld, last_comp, &sub_oid, S_IFDIR);\n\t\t\tgit__free(subdir);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t} else {\n\t\t\terror = append_entry(bld, filename, &entry->id, entry->mode);\n\t\t\tif (error < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\tif (git_treebuilder_write(oid, bld) < 0)\n\t\tgoto on_error;\n\n\tgit_treebuilder_free(bld);\n\treturn (int)i;\n\non_error:\n\tgit_treebuilder_free(bld);\n\treturn -1;\n}"
  },
  {
    "function_name": "append_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "491-516",
    "snippet": "static int append_entry(\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error = 0;\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tentry = alloc_entry(filename, strlen(filename), id);\n\tGITERR_CHECK_ALLOC(entry);\n\n\tentry->attr = (uint16_t)filemode;\n\n\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\tif (error < 0) {\n\t\tgit_tree_entry_free(entry);\n\t\tgiterr_set(GITERR_TREE, \"failed to append entry %s to the tree builder\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_TREE",
            "\"failed to append entry %s to the tree builder\"",
            "filename"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry_free",
          "args": [
            "entry"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "229-235",
          "snippet": "void git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_insert",
          "args": [
            "bld->map",
            "entry->filename",
            "entry",
            "error"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "entry"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_entry",
          "args": [
            "filename",
            "strlen(filename)",
            "id"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "91-123",
          "snippet": "static git_tree_entry *alloc_entry(const char *filename, size_t filename_len, const git_oid *id)\n{\n\tgit_tree_entry *entry = NULL;\n\tsize_t tree_len;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&tree_len, sizeof(git_tree_entry), filename_len) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, 1) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, GIT_OID_RAWSZ))\n\t\treturn NULL;\n\n\tentry = git__calloc(1, tree_len);\n\tif (!entry)\n\t\treturn NULL;\n\n\t{\n\t\tchar *filename_ptr;\n\t\tvoid *id_ptr;\n\n\t\tfilename_ptr = ((char *) entry) + sizeof(git_tree_entry);\n\t\tmemcpy(filename_ptr, filename, filename_len);\n\t\tentry->filename = filename_ptr;\n\n\t\tid_ptr = filename_ptr + filename_len + 1;\n\t\tgit_oid_cpy(id_ptr, id);\n\t\tentry->oid = id_ptr;\n\t}\n\n\tentry->filename_len = (uint16_t)filename_len;\n\n\treturn entry;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic git_tree_entry *alloc_entry(const char *filename, size_t filename_len, const git_oid *id)\n{\n\tgit_tree_entry *entry = NULL;\n\tsize_t tree_len;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&tree_len, sizeof(git_tree_entry), filename_len) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, 1) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, GIT_OID_RAWSZ))\n\t\treturn NULL;\n\n\tentry = git__calloc(1, tree_len);\n\tif (!entry)\n\t\treturn NULL;\n\n\t{\n\t\tchar *filename_ptr;\n\t\tvoid *id_ptr;\n\n\t\tfilename_ptr = ((char *) entry) + sizeof(git_tree_entry);\n\t\tmemcpy(filename_ptr, filename, filename_len);\n\t\tentry->filename = filename_ptr;\n\n\t\tid_ptr = filename_ptr + filename_len + 1;\n\t\tgit_oid_cpy(id_ptr, id);\n\t\tentry->oid = id_ptr;\n\t}\n\n\tentry->filename_len = (uint16_t)filename_len;\n\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "filename"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tree_error",
          "args": [
            "\"Failed to insert entry. Invalid name for a tree entry\"",
            "filename"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "tree_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "395-402",
          "snippet": "static int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "valid_entry_name",
          "args": [
            "bld->repo",
            "filename"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "valid_entry_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "56-61",
          "snippet": "static int valid_entry_name(git_repository *repo, const char *filename)\n{\n\treturn *filename != '\\0' &&\n\t\tgit_path_isvalid(repo, filename,\n\t\tGIT_PATH_REJECT_TRAVERSAL | GIT_PATH_REJECT_DOT_GIT | GIT_PATH_REJECT_SLASH);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int valid_entry_name(git_repository *repo, const char *filename)\n{\n\treturn *filename != '\\0' &&\n\t\tgit_path_isvalid(repo, filename,\n\t\tGIT_PATH_REJECT_TRAVERSAL | GIT_PATH_REJECT_DOT_GIT | GIT_PATH_REJECT_SLASH);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int append_entry(\n\tgit_treebuilder *bld,\n\tconst char *filename,\n\tconst git_oid *id,\n\tgit_filemode_t filemode)\n{\n\tgit_tree_entry *entry;\n\tint error = 0;\n\n\tif (!valid_entry_name(bld->repo, filename))\n\t\treturn tree_error(\"Failed to insert entry. Invalid name for a tree entry\", filename);\n\n\tentry = alloc_entry(filename, strlen(filename), id);\n\tGITERR_CHECK_ALLOC(entry);\n\n\tentry->attr = (uint16_t)filemode;\n\n\tgit_strmap_insert(bld->map, entry->filename, entry, error);\n\tif (error < 0) {\n\t\tgit_tree_entry_free(entry);\n\t\tgiterr_set(GITERR_TREE, \"failed to append entry %s to the tree builder\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "find_next_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "474-489",
    "snippet": "static size_t find_next_dir(const char *dirname, git_index *index, size_t start)\n{\n\tsize_t dirlen, i, entries = git_index_entrycount(index);\n\n\tdirlen = strlen(dirname);\n\tfor (i = start; i < entries; ++i) {\n\t\tconst git_index_entry *entry = git_index_get_byindex(index, i);\n\t\tif (strlen(entry->path) < dirlen ||\n\t\t    memcmp(entry->path, dirname, dirlen) ||\n\t\t\t(dirlen > 0 && entry->path[dirlen] != '/')) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn i;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "entry->path",
            "dirname",
            "dirlen"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "entry->path"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_index_get_byindex",
          "args": [
            "index",
            "i"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_get_byindex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "799-805",
          "snippet": "const git_index_entry *git_index_get_byindex(\n\tgit_index *index, size_t n)\n{\n\tassert(index);\n\tgit_vector_sort(&index->entries);\n\treturn git_vector_get(&index->entries, n);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nconst git_index_entry *git_index_get_byindex(\n\tgit_index *index, size_t n)\n{\n\tassert(index);\n\tgit_vector_sort(&index->entries);\n\treturn git_vector_get(&index->entries, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "dirname"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_index_entrycount",
          "args": [
            "index"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_entrycount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "793-797",
          "snippet": "size_t git_index_entrycount(const git_index *index)\n{\n\tassert(index);\n\treturn index->entries.length;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nsize_t git_index_entrycount(const git_index *index)\n{\n\tassert(index);\n\treturn index->entries.length;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic size_t find_next_dir(const char *dirname, git_index *index, size_t start)\n{\n\tsize_t dirlen, i, entries = git_index_entrycount(index);\n\n\tdirlen = strlen(dirname);\n\tfor (i = start; i < entries; ++i) {\n\t\tconst git_index_entry *entry = git_index_get_byindex(index, i);\n\t\tif (strlen(entry->path) < dirlen ||\n\t\t    memcmp(entry->path, dirname, dirlen) ||\n\t\t\t(dirlen > 0 && entry->path[dirlen] != '/')) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn i;\n}"
  },
  {
    "function_name": "git_tree__parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "423-472",
    "snippet": "int git_tree__parse(void *_tree, git_odb_object *odb_obj)\n{\n\tgit_tree *tree = _tree;\n\tconst char *buffer;\n\tconst char *buffer_end;\n\n\tif (git_odb_object_dup(&tree->odb_obj, odb_obj) < 0)\n\t\treturn -1;\n\n\tbuffer = git_odb_object_data(tree->odb_obj);\n\tbuffer_end = buffer + git_odb_object_size(tree->odb_obj);\n\n\tgit_array_init_to_size(tree->entries, DEFAULT_TREE_SIZE);\n\tGITERR_CHECK_ARRAY(tree->entries);\n\n\twhile (buffer < buffer_end) {\n\t\tgit_tree_entry *entry;\n\t\tsize_t filename_len;\n\t\tconst char *nul;\n\t\tunsigned int attr;\n\n\t\tif (parse_mode(&attr, buffer, &buffer) < 0 || !buffer)\n\t\t\treturn tree_error(\"Failed to parse tree. Can't parse filemode\", NULL);\n\n\t\tif ((nul = memchr(buffer, 0, buffer_end - buffer)) == NULL)\n\t\t\treturn tree_error(\"Failed to parse tree. Object is corrupted\", NULL);\n\n\t\tif ((filename_len = nul - buffer) == 0)\n\t\t\treturn tree_error(\"Failed to parse tree. Can't parse filename\", NULL);\n\n\t\tif ((buffer_end - (nul + 1)) < GIT_OID_RAWSZ)\n\t\t\treturn tree_error(\"Failed to parse tree. Can't parse OID\", NULL);\n\n\t\t/* Allocate the entry */\n\t\t{\n\t\t\tentry = git_array_alloc(tree->entries);\n\t\t\tGITERR_CHECK_ALLOC(entry);\n\n\t\t\tentry->attr = attr;\n\t\t\tentry->filename_len = filename_len;\n\t\t\tentry->filename = buffer;\n\t\t\tentry->oid = (git_oid *) ((char *) buffer + filename_len + 1);\n\t\t}\n\n\t\tbuffer += filename_len + 1;\n\t\tbuffer += GIT_OID_RAWSZ;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define DEFAULT_TREE_SIZE 16"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "entry"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "tree->entries"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tree_error",
          "args": [
            "\"Failed to parse tree. Can't parse OID\"",
            "NULL"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "tree_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "395-402",
          "snippet": "static int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "buffer",
            "0",
            "buffer_end - buffer"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_mode",
          "args": [
            "&attr",
            "buffer",
            "&buffer"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "parse_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "404-421",
          "snippet": "static int parse_mode(unsigned int *modep, const char *buffer, const char **buffer_out)\n{\n\tunsigned char c;\n\tunsigned int mode = 0;\n\n\tif (*buffer == ' ')\n\t\treturn -1;\n\n\twhile ((c = *buffer++) != ' ') {\n\t\tif (c < '0' || c > '7')\n\t\t\treturn -1;\n\t\tmode = (mode << 3) + (c - '0');\n\t}\n\t*modep = mode;\n\t*buffer_out = buffer;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int parse_mode(unsigned int *modep, const char *buffer, const char **buffer_out)\n{\n\tunsigned char c;\n\tunsigned int mode = 0;\n\n\tif (*buffer == ' ')\n\t\treturn -1;\n\n\twhile ((c = *buffer++) != ' ') {\n\t\tif (c < '0' || c > '7')\n\t\t\treturn -1;\n\t\tmode = (mode << 3) + (c - '0');\n\t}\n\t*modep = mode;\n\t*buffer_out = buffer;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ARRAY",
          "args": [
            "tree->entries"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_init_to_size",
          "args": [
            "tree->entries",
            "DEFAULT_TREE_SIZE"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_odb_object_size",
          "args": [
            "tree->odb_obj"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "120-123",
          "snippet": "size_t git_odb_object_size(git_odb_object *object)\n{\n\treturn object->cached.size;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nsize_t git_odb_object_size(git_odb_object *object)\n{\n\treturn object->cached.size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_object_data",
          "args": [
            "tree->odb_obj"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "115-118",
          "snippet": "const void *git_odb_object_data(git_odb_object *object)\n{\n\treturn object->buffer;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nconst void *git_odb_object_data(git_odb_object *object)\n{\n\treturn object->buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_object_dup",
          "args": [
            "&tree->odb_obj",
            "odb_obj"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "130-135",
          "snippet": "int git_odb_object_dup(git_odb_object **dest, git_odb_object *source)\n{\n\tgit_cached_obj_incref(source);\n\t*dest = source;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_object_dup(git_odb_object **dest, git_odb_object *source)\n{\n\tgit_cached_obj_incref(source);\n\t*dest = source;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\n#define DEFAULT_TREE_SIZE 16\n\nint git_tree__parse(void *_tree, git_odb_object *odb_obj)\n{\n\tgit_tree *tree = _tree;\n\tconst char *buffer;\n\tconst char *buffer_end;\n\n\tif (git_odb_object_dup(&tree->odb_obj, odb_obj) < 0)\n\t\treturn -1;\n\n\tbuffer = git_odb_object_data(tree->odb_obj);\n\tbuffer_end = buffer + git_odb_object_size(tree->odb_obj);\n\n\tgit_array_init_to_size(tree->entries, DEFAULT_TREE_SIZE);\n\tGITERR_CHECK_ARRAY(tree->entries);\n\n\twhile (buffer < buffer_end) {\n\t\tgit_tree_entry *entry;\n\t\tsize_t filename_len;\n\t\tconst char *nul;\n\t\tunsigned int attr;\n\n\t\tif (parse_mode(&attr, buffer, &buffer) < 0 || !buffer)\n\t\t\treturn tree_error(\"Failed to parse tree. Can't parse filemode\", NULL);\n\n\t\tif ((nul = memchr(buffer, 0, buffer_end - buffer)) == NULL)\n\t\t\treturn tree_error(\"Failed to parse tree. Object is corrupted\", NULL);\n\n\t\tif ((filename_len = nul - buffer) == 0)\n\t\t\treturn tree_error(\"Failed to parse tree. Can't parse filename\", NULL);\n\n\t\tif ((buffer_end - (nul + 1)) < GIT_OID_RAWSZ)\n\t\t\treturn tree_error(\"Failed to parse tree. Can't parse OID\", NULL);\n\n\t\t/* Allocate the entry */\n\t\t{\n\t\t\tentry = git_array_alloc(tree->entries);\n\t\t\tGITERR_CHECK_ALLOC(entry);\n\n\t\t\tentry->attr = attr;\n\t\t\tentry->filename_len = filename_len;\n\t\t\tentry->filename = buffer;\n\t\t\tentry->oid = (git_oid *) ((char *) buffer + filename_len + 1);\n\t\t}\n\n\t\tbuffer += filename_len + 1;\n\t\tbuffer += GIT_OID_RAWSZ;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "parse_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "404-421",
    "snippet": "static int parse_mode(unsigned int *modep, const char *buffer, const char **buffer_out)\n{\n\tunsigned char c;\n\tunsigned int mode = 0;\n\n\tif (*buffer == ' ')\n\t\treturn -1;\n\n\twhile ((c = *buffer++) != ' ') {\n\t\tif (c < '0' || c > '7')\n\t\t\treturn -1;\n\t\tmode = (mode << 3) + (c - '0');\n\t}\n\t*modep = mode;\n\t*buffer_out = buffer;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int parse_mode(unsigned int *modep, const char *buffer, const char **buffer_out)\n{\n\tunsigned char c;\n\tunsigned int mode = 0;\n\n\tif (*buffer == ' ')\n\t\treturn -1;\n\n\twhile ((c = *buffer++) != ' ') {\n\t\tif (c < '0' || c > '7')\n\t\t\treturn -1;\n\t\tmode = (mode << 3) + (c - '0');\n\t}\n\t*modep = mode;\n\t*buffer_out = buffer;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "tree_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "395-402",
    "snippet": "static int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_TREE",
            "\"%s\"",
            "str"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int tree_error(const char *str, const char *path)\n{\n\tif (path)\n\t\tgiterr_set(GITERR_TREE, \"%s - %s\", str, path);\n\telse\n\t\tgiterr_set(GITERR_TREE, \"%s\", str);\n\treturn -1;\n}"
  },
  {
    "function_name": "git_treebuilder_entrycount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "388-393",
    "snippet": "unsigned int git_treebuilder_entrycount(git_treebuilder *bld)\n{\n\tassert(bld);\n\n\treturn git_strmap_num_entries(bld->map);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_strmap_num_entries",
          "args": [
            "bld->map"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "bld"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nunsigned int git_treebuilder_entrycount(git_treebuilder *bld)\n{\n\tassert(bld);\n\n\treturn git_strmap_num_entries(bld->map);\n}"
  },
  {
    "function_name": "git_tree_entrycount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "382-386",
    "snippet": "size_t git_tree_entrycount(const git_tree *tree)\n{\n\tassert(tree);\n\treturn tree->entries.size;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "tree"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nsize_t git_tree_entrycount(const git_tree *tree)\n{\n\tassert(tree);\n\treturn tree->entries.size;\n}"
  },
  {
    "function_name": "git_tree__prefix_position",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "347-380",
    "snippet": "int git_tree__prefix_position(const git_tree *tree, const char *path)\n{\n\tstruct tree_key_search ksearch;\n\tsize_t at_pos, path_len;\n\n\tif (!path)\n\t\treturn 0;\n\n\tpath_len = strlen(path);\n\tTREE_ENTRY_CHECK_NAMELEN(path_len);\n\n\tksearch.filename = path;\n\tksearch.filename_len = (uint16_t)path_len;\n\n\t/* Find tree entry with appropriate prefix */\n\tgit_array_search(\n\t\t&at_pos, tree->entries, &homing_search_cmp, &ksearch);\n\n\tfor (; at_pos < tree->entries.size; ++at_pos) {\n\t\tconst git_tree_entry *entry = git_array_get(tree->entries, at_pos);\n\t\tif (homing_search_cmp(&ksearch, entry) < 0)\n\t\t\tbreak;\n\t}\n\n\tfor (; at_pos > 0; --at_pos) {\n\t\tconst git_tree_entry *entry =\n\t\t\tgit_array_get(tree->entries, at_pos - 1);\n\n\t\tif (homing_search_cmp(&ksearch, entry) > 0)\n\t\t\tbreak;\n\t}\n\n\treturn (int)at_pos;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "homing_search_cmp",
          "args": [
            "&ksearch",
            "entry"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "homing_search_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "130-143",
          "snippet": "static int homing_search_cmp(const void *key, const void *array_member)\n{\n\tconst struct tree_key_search *ksearch = key;\n\tconst git_tree_entry *entry = array_member;\n\n\tconst uint16_t len1 = ksearch->filename_len;\n\tconst uint16_t len2 = entry->filename_len;\n\n\treturn memcmp(\n\t\tksearch->filename,\n\t\tentry->filename,\n\t\tlen1 < len2 ? len1 : len2\n\t);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int homing_search_cmp(const void *key, const void *array_member)\n{\n\tconst struct tree_key_search *ksearch = key;\n\tconst git_tree_entry *entry = array_member;\n\n\tconst uint16_t len1 = ksearch->filename_len;\n\tconst uint16_t len2 = entry->filename_len;\n\n\treturn memcmp(\n\t\tksearch->filename,\n\t\tentry->filename,\n\t\tlen1 < len2 ? len1 : len2\n\t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "tree->entries",
            "at_pos - 1"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "tree->entries",
            "at_pos"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_search",
          "args": [
            "&at_pos",
            "tree->entries",
            "&homing_search_cmp",
            "&ksearch"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TREE_ENTRY_CHECK_NAMELEN",
          "args": [
            "path_len"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "path"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tree__prefix_position(const git_tree *tree, const char *path)\n{\n\tstruct tree_key_search ksearch;\n\tsize_t at_pos, path_len;\n\n\tif (!path)\n\t\treturn 0;\n\n\tpath_len = strlen(path);\n\tTREE_ENTRY_CHECK_NAMELEN(path_len);\n\n\tksearch.filename = path;\n\tksearch.filename_len = (uint16_t)path_len;\n\n\t/* Find tree entry with appropriate prefix */\n\tgit_array_search(\n\t\t&at_pos, tree->entries, &homing_search_cmp, &ksearch);\n\n\tfor (; at_pos < tree->entries.size; ++at_pos) {\n\t\tconst git_tree_entry *entry = git_array_get(tree->entries, at_pos);\n\t\tif (homing_search_cmp(&ksearch, entry) < 0)\n\t\t\tbreak;\n\t}\n\n\tfor (; at_pos > 0; --at_pos) {\n\t\tconst git_tree_entry *entry =\n\t\t\tgit_array_get(tree->entries, at_pos - 1);\n\n\t\tif (homing_search_cmp(&ksearch, entry) > 0)\n\t\t\tbreak;\n\t}\n\n\treturn (int)at_pos;\n}"
  },
  {
    "function_name": "git_tree_entry_byid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "331-345",
    "snippet": "const git_tree_entry *git_tree_entry_byid(\n\tconst git_tree *tree, const git_oid *id)\n{\n\tsize_t i;\n\tconst git_tree_entry *e;\n\n\tassert(tree);\n\n\tgit_array_foreach(tree->entries, i, e) {\n\t\tif (memcmp(&e->oid->id, &id->id, sizeof(id->id)) == 0)\n\t\t\treturn e;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&e->oid->id",
            "&id->id",
            "sizeof(id->id)"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_foreach",
          "args": [
            "tree->entries",
            "i",
            "e"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "tree"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_tree_entry *git_tree_entry_byid(\n\tconst git_tree *tree, const git_oid *id)\n{\n\tsize_t i;\n\tconst git_tree_entry *e;\n\n\tassert(tree);\n\n\tgit_array_foreach(tree->entries, i, e) {\n\t\tif (memcmp(&e->oid->id, &id->id, sizeof(id->id)) == 0)\n\t\t\treturn e;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "git_tree_entry_byindex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "324-329",
    "snippet": "const git_tree_entry *git_tree_entry_byindex(\n\tconst git_tree *tree, size_t idx)\n{\n\tassert(tree);\n\treturn git_array_get(tree->entries, idx);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "tree->entries",
            "idx"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "tree"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_tree_entry *git_tree_entry_byindex(\n\tconst git_tree *tree, size_t idx)\n{\n\tassert(tree);\n\treturn git_array_get(tree->entries, idx);\n}"
  },
  {
    "function_name": "git_tree_entry_byname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "316-322",
    "snippet": "const git_tree_entry *git_tree_entry_byname(\n\tconst git_tree *tree, const char *filename)\n{\n\tassert(tree && filename);\n\n\treturn entry_fromname(tree, filename, strlen(filename));\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "entry_fromname",
          "args": [
            "tree",
            "filename",
            "strlen(filename)"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "entry_fromname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "305-314",
          "snippet": "static const git_tree_entry *entry_fromname(\n\tconst git_tree *tree, const char *name, size_t name_len)\n{\n\tsize_t idx;\n\n\tif (tree_key_search(&idx, tree, name, name_len) < 0)\n\t\treturn NULL;\n\n\treturn git_array_get(tree->entries, idx);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic const git_tree_entry *entry_fromname(\n\tconst git_tree *tree, const char *name, size_t name_len)\n{\n\tsize_t idx;\n\n\tif (tree_key_search(&idx, tree, name, name_len) < 0)\n\t\treturn NULL;\n\n\treturn git_array_get(tree->entries, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "filename"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "tree && filename"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_tree_entry *git_tree_entry_byname(\n\tconst git_tree *tree, const char *filename)\n{\n\tassert(tree && filename);\n\n\treturn entry_fromname(tree, filename, strlen(filename));\n}"
  },
  {
    "function_name": "entry_fromname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "305-314",
    "snippet": "static const git_tree_entry *entry_fromname(\n\tconst git_tree *tree, const char *name, size_t name_len)\n{\n\tsize_t idx;\n\n\tif (tree_key_search(&idx, tree, name, name_len) < 0)\n\t\treturn NULL;\n\n\treturn git_array_get(tree->entries, idx);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "tree->entries",
            "idx"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tree_key_search",
          "args": [
            "&idx",
            "tree",
            "name",
            "name_len"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "tree_key_search",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "165-227",
          "snippet": "static int tree_key_search(\n\tsize_t *at_pos,\n\tconst git_tree *tree,\n\tconst char *filename,\n\tsize_t filename_len)\n{\n\tstruct tree_key_search ksearch;\n\tconst git_tree_entry *entry;\n\tsize_t homing, i;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tksearch.filename = filename;\n\tksearch.filename_len = (uint16_t)filename_len;\n\n\t/* Initial homing search; find an entry on the tree with\n\t * the same prefix as the filename we're looking for */\n\n\tif (git_array_search(&homing,\n\t\ttree->entries, &homing_search_cmp, &ksearch) < 0)\n\t\treturn GIT_ENOTFOUND; /* just a signal error; not passed back to user */\n\n\t/* We found a common prefix. Look forward as long as\n\t * there are entries that share the common prefix */\n\tfor (i = homing; i < tree->entries.size; ++i) {\n\t\tentry = git_array_get(tree->entries, i);\n\n\t\tif (homing_search_cmp(&ksearch, entry) < 0)\n\t\t\tbreak;\n\n\t\tif (entry->filename_len == filename_len &&\n\t\t\tmemcmp(filename, entry->filename, filename_len) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/* If we haven't found our filename yet, look backwards\n\t * too as long as we have entries with the same prefix */\n\tif (homing > 0) {\n\t\ti = homing - 1;\n\n\t\tdo {\n\t\t\tentry = git_array_get(tree->entries, i);\n\n\t\t\tif (homing_search_cmp(&ksearch, entry) > 0)\n\t\t\t\tbreak;\n\n\t\t\tif (entry->filename_len == filename_len &&\n\t\t\t\tmemcmp(filename, entry->filename, filename_len) == 0) {\n\t\t\t\tif (at_pos)\n\t\t\t\t\t*at_pos = i;\n\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t} while (i-- > 0);\n\t}\n\n\t/* The filename doesn't exist at all */\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int tree_key_search(\n\tsize_t *at_pos,\n\tconst git_tree *tree,\n\tconst char *filename,\n\tsize_t filename_len)\n{\n\tstruct tree_key_search ksearch;\n\tconst git_tree_entry *entry;\n\tsize_t homing, i;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tksearch.filename = filename;\n\tksearch.filename_len = (uint16_t)filename_len;\n\n\t/* Initial homing search; find an entry on the tree with\n\t * the same prefix as the filename we're looking for */\n\n\tif (git_array_search(&homing,\n\t\ttree->entries, &homing_search_cmp, &ksearch) < 0)\n\t\treturn GIT_ENOTFOUND; /* just a signal error; not passed back to user */\n\n\t/* We found a common prefix. Look forward as long as\n\t * there are entries that share the common prefix */\n\tfor (i = homing; i < tree->entries.size; ++i) {\n\t\tentry = git_array_get(tree->entries, i);\n\n\t\tif (homing_search_cmp(&ksearch, entry) < 0)\n\t\t\tbreak;\n\n\t\tif (entry->filename_len == filename_len &&\n\t\t\tmemcmp(filename, entry->filename, filename_len) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/* If we haven't found our filename yet, look backwards\n\t * too as long as we have entries with the same prefix */\n\tif (homing > 0) {\n\t\ti = homing - 1;\n\n\t\tdo {\n\t\t\tentry = git_array_get(tree->entries, i);\n\n\t\t\tif (homing_search_cmp(&ksearch, entry) > 0)\n\t\t\t\tbreak;\n\n\t\t\tif (entry->filename_len == filename_len &&\n\t\t\t\tmemcmp(filename, entry->filename, filename_len) == 0) {\n\t\t\t\tif (at_pos)\n\t\t\t\t\t*at_pos = i;\n\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t} while (i-- > 0);\n\t}\n\n\t/* The filename doesn't exist at all */\n\treturn GIT_ENOTFOUND;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic const git_tree_entry *entry_fromname(\n\tconst git_tree *tree, const char *name, size_t name_len)\n{\n\tsize_t idx;\n\n\tif (tree_key_search(&idx, tree, name, name_len) < 0)\n\t\treturn NULL;\n\n\treturn git_array_get(tree->entries, idx);\n}"
  },
  {
    "function_name": "git_tree_entry_to_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "296-303",
    "snippet": "int git_tree_entry_to_object(\n\tgit_object **object_out,\n\tgit_repository *repo,\n\tconst git_tree_entry *entry)\n{\n\tassert(entry && object_out);\n\treturn git_object_lookup(object_out, repo, entry->oid, GIT_OBJ_ANY);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_object_lookup",
          "args": [
            "object_out",
            "repo",
            "entry->oid",
            "GIT_OBJ_ANY"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_lookup_bypath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "390-423",
          "snippet": "int git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "entry && object_out"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tree_entry_to_object(\n\tgit_object **object_out,\n\tgit_repository *repo,\n\tconst git_tree_entry *entry)\n{\n\tassert(entry && object_out);\n\treturn git_object_lookup(object_out, repo, entry->oid, GIT_OBJ_ANY);\n}"
  },
  {
    "function_name": "git_tree_entry_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "284-294",
    "snippet": "git_otype git_tree_entry_type(const git_tree_entry *entry)\n{\n\tassert(entry);\n\n\tif (S_ISGITLINK(entry->attr))\n\t\treturn GIT_OBJ_COMMIT;\n\telse if (S_ISDIR(entry->attr))\n\t\treturn GIT_OBJ_TREE;\n\telse\n\t\treturn GIT_OBJ_BLOB;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "entry->attr"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISGITLINK",
          "args": [
            "entry->attr"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "entry"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\ngit_otype git_tree_entry_type(const git_tree_entry *entry)\n{\n\tassert(entry);\n\n\tif (S_ISGITLINK(entry->attr))\n\t\treturn GIT_OBJ_COMMIT;\n\telse if (S_ISDIR(entry->attr))\n\t\treturn GIT_OBJ_TREE;\n\telse\n\t\treturn GIT_OBJ_BLOB;\n}"
  },
  {
    "function_name": "git_tree_entry_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "278-282",
    "snippet": "const git_oid *git_tree_entry_id(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->oid;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "entry"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_oid *git_tree_entry_id(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->oid;\n}"
  },
  {
    "function_name": "git_tree_entry_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "272-276",
    "snippet": "const char *git_tree_entry_name(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->filename;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "entry"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst char *git_tree_entry_name(const git_tree_entry *entry)\n{\n\tassert(entry);\n\treturn entry->filename;\n}"
  },
  {
    "function_name": "git_tree_entry_filemode_raw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "267-270",
    "snippet": "git_filemode_t git_tree_entry_filemode_raw(const git_tree_entry *entry)\n{\n\treturn entry->attr;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\ngit_filemode_t git_tree_entry_filemode_raw(const git_tree_entry *entry)\n{\n\treturn entry->attr;\n}"
  },
  {
    "function_name": "git_tree_entry_filemode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "262-265",
    "snippet": "git_filemode_t git_tree_entry_filemode(const git_tree_entry *entry)\n{\n\treturn normalize_filemode(entry->attr);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "normalize_filemode",
          "args": [
            "entry->attr"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "normalize_filemode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "34-54",
          "snippet": "GIT_INLINE(git_filemode_t) normalize_filemode(git_filemode_t filemode)\n{\n\t/* Tree bits set, but it's not a commit */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_TREE)\n\t\treturn GIT_FILEMODE_TREE;\n\n\t/* If any of the x bits are set */\n\tif (GIT_PERMS_IS_EXEC(filemode))\n\t\treturn GIT_FILEMODE_BLOB_EXECUTABLE;\n\n\t/* 16XXXX means commit */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_COMMIT)\n\t\treturn GIT_FILEMODE_COMMIT;\n\n\t/* 12XXXX means symlink */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_LINK)\n\t\treturn GIT_FILEMODE_LINK;\n\n\t/* Otherwise, return a blob */\n\treturn GIT_FILEMODE_BLOB;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_filemode_t) normalize_filemode(git_filemode_t filemode)\n{\n\t/* Tree bits set, but it's not a commit */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_TREE)\n\t\treturn GIT_FILEMODE_TREE;\n\n\t/* If any of the x bits are set */\n\tif (GIT_PERMS_IS_EXEC(filemode))\n\t\treturn GIT_FILEMODE_BLOB_EXECUTABLE;\n\n\t/* 16XXXX means commit */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_COMMIT)\n\t\treturn GIT_FILEMODE_COMMIT;\n\n\t/* 12XXXX means symlink */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_LINK)\n\t\treturn GIT_FILEMODE_LINK;\n\n\t/* Otherwise, return a blob */\n\treturn GIT_FILEMODE_BLOB;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\ngit_filemode_t git_tree_entry_filemode(const git_tree_entry *entry)\n{\n\treturn normalize_filemode(entry->attr);\n}"
  },
  {
    "function_name": "git_tree__free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "253-260",
    "snippet": "void git_tree__free(void *_tree)\n{\n\tgit_tree *tree = _tree;\n\n\tgit_odb_object_free(tree->odb_obj);\n\tgit_array_clear(tree->entries);\n\tgit__free(tree);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "tree"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "tree->entries"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_odb_object_free",
          "args": [
            "tree->odb_obj"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "137-143",
          "snippet": "void git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_tree__free(void *_tree)\n{\n\tgit_tree *tree = _tree;\n\n\tgit_odb_object_free(tree->odb_obj);\n\tgit_array_clear(tree->entries);\n\tgit__free(tree);\n}"
  },
  {
    "function_name": "git_tree_entry_dup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "237-251",
    "snippet": "int git_tree_entry_dup(git_tree_entry **dest, const git_tree_entry *source)\n{\n\tgit_tree_entry *cpy;\n\n\tassert(source);\n\n\tcpy = alloc_entry(source->filename, source->filename_len, source->oid);\n\tif (cpy == NULL)\n\t\treturn -1;\n\n\tcpy->attr = source->attr;\n\n\t*dest = cpy;\n\treturn 0;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_entry",
          "args": [
            "source->filename",
            "source->filename_len",
            "source->oid"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "91-123",
          "snippet": "static git_tree_entry *alloc_entry(const char *filename, size_t filename_len, const git_oid *id)\n{\n\tgit_tree_entry *entry = NULL;\n\tsize_t tree_len;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&tree_len, sizeof(git_tree_entry), filename_len) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, 1) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, GIT_OID_RAWSZ))\n\t\treturn NULL;\n\n\tentry = git__calloc(1, tree_len);\n\tif (!entry)\n\t\treturn NULL;\n\n\t{\n\t\tchar *filename_ptr;\n\t\tvoid *id_ptr;\n\n\t\tfilename_ptr = ((char *) entry) + sizeof(git_tree_entry);\n\t\tmemcpy(filename_ptr, filename, filename_len);\n\t\tentry->filename = filename_ptr;\n\n\t\tid_ptr = filename_ptr + filename_len + 1;\n\t\tgit_oid_cpy(id_ptr, id);\n\t\tentry->oid = id_ptr;\n\t}\n\n\tentry->filename_len = (uint16_t)filename_len;\n\n\treturn entry;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic git_tree_entry *alloc_entry(const char *filename, size_t filename_len, const git_oid *id)\n{\n\tgit_tree_entry *entry = NULL;\n\tsize_t tree_len;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&tree_len, sizeof(git_tree_entry), filename_len) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, 1) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, GIT_OID_RAWSZ))\n\t\treturn NULL;\n\n\tentry = git__calloc(1, tree_len);\n\tif (!entry)\n\t\treturn NULL;\n\n\t{\n\t\tchar *filename_ptr;\n\t\tvoid *id_ptr;\n\n\t\tfilename_ptr = ((char *) entry) + sizeof(git_tree_entry);\n\t\tmemcpy(filename_ptr, filename, filename_len);\n\t\tentry->filename = filename_ptr;\n\n\t\tid_ptr = filename_ptr + filename_len + 1;\n\t\tgit_oid_cpy(id_ptr, id);\n\t\tentry->oid = id_ptr;\n\t}\n\n\tentry->filename_len = (uint16_t)filename_len;\n\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "source"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tree_entry_dup(git_tree_entry **dest, const git_tree_entry *source)\n{\n\tgit_tree_entry *cpy;\n\n\tassert(source);\n\n\tcpy = alloc_entry(source->filename, source->filename_len, source->oid);\n\tif (cpy == NULL)\n\t\treturn -1;\n\n\tcpy->attr = source->attr;\n\n\t*dest = cpy;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_tree_entry_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "229-235",
    "snippet": "void git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "entry"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_tree_entry_free(git_tree_entry *entry)\n{\n\tif (entry == NULL)\n\t\treturn;\n\n\tgit__free(entry);\n}"
  },
  {
    "function_name": "tree_key_search",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "165-227",
    "snippet": "static int tree_key_search(\n\tsize_t *at_pos,\n\tconst git_tree *tree,\n\tconst char *filename,\n\tsize_t filename_len)\n{\n\tstruct tree_key_search ksearch;\n\tconst git_tree_entry *entry;\n\tsize_t homing, i;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tksearch.filename = filename;\n\tksearch.filename_len = (uint16_t)filename_len;\n\n\t/* Initial homing search; find an entry on the tree with\n\t * the same prefix as the filename we're looking for */\n\n\tif (git_array_search(&homing,\n\t\ttree->entries, &homing_search_cmp, &ksearch) < 0)\n\t\treturn GIT_ENOTFOUND; /* just a signal error; not passed back to user */\n\n\t/* We found a common prefix. Look forward as long as\n\t * there are entries that share the common prefix */\n\tfor (i = homing; i < tree->entries.size; ++i) {\n\t\tentry = git_array_get(tree->entries, i);\n\n\t\tif (homing_search_cmp(&ksearch, entry) < 0)\n\t\t\tbreak;\n\n\t\tif (entry->filename_len == filename_len &&\n\t\t\tmemcmp(filename, entry->filename, filename_len) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/* If we haven't found our filename yet, look backwards\n\t * too as long as we have entries with the same prefix */\n\tif (homing > 0) {\n\t\ti = homing - 1;\n\n\t\tdo {\n\t\t\tentry = git_array_get(tree->entries, i);\n\n\t\t\tif (homing_search_cmp(&ksearch, entry) > 0)\n\t\t\t\tbreak;\n\n\t\t\tif (entry->filename_len == filename_len &&\n\t\t\t\tmemcmp(filename, entry->filename, filename_len) == 0) {\n\t\t\t\tif (at_pos)\n\t\t\t\t\t*at_pos = i;\n\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t} while (i-- > 0);\n\t}\n\n\t/* The filename doesn't exist at all */\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "filename",
            "entry->filename",
            "filename_len"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "homing_search_cmp",
          "args": [
            "&ksearch",
            "entry"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "homing_search_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "130-143",
          "snippet": "static int homing_search_cmp(const void *key, const void *array_member)\n{\n\tconst struct tree_key_search *ksearch = key;\n\tconst git_tree_entry *entry = array_member;\n\n\tconst uint16_t len1 = ksearch->filename_len;\n\tconst uint16_t len2 = entry->filename_len;\n\n\treturn memcmp(\n\t\tksearch->filename,\n\t\tentry->filename,\n\t\tlen1 < len2 ? len1 : len2\n\t);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int homing_search_cmp(const void *key, const void *array_member)\n{\n\tconst struct tree_key_search *ksearch = key;\n\tconst git_tree_entry *entry = array_member;\n\n\tconst uint16_t len1 = ksearch->filename_len;\n\tconst uint16_t len2 = entry->filename_len;\n\n\treturn memcmp(\n\t\tksearch->filename,\n\t\tentry->filename,\n\t\tlen1 < len2 ? len1 : len2\n\t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "tree->entries",
            "i"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "filename",
            "entry->filename",
            "filename_len"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "tree->entries",
            "i"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_search",
          "args": [
            "&homing",
            "tree->entries",
            "&homing_search_cmp",
            "&ksearch"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TREE_ENTRY_CHECK_NAMELEN",
          "args": [
            "filename_len"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int tree_key_search(\n\tsize_t *at_pos,\n\tconst git_tree *tree,\n\tconst char *filename,\n\tsize_t filename_len)\n{\n\tstruct tree_key_search ksearch;\n\tconst git_tree_entry *entry;\n\tsize_t homing, i;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tksearch.filename = filename;\n\tksearch.filename_len = (uint16_t)filename_len;\n\n\t/* Initial homing search; find an entry on the tree with\n\t * the same prefix as the filename we're looking for */\n\n\tif (git_array_search(&homing,\n\t\ttree->entries, &homing_search_cmp, &ksearch) < 0)\n\t\treturn GIT_ENOTFOUND; /* just a signal error; not passed back to user */\n\n\t/* We found a common prefix. Look forward as long as\n\t * there are entries that share the common prefix */\n\tfor (i = homing; i < tree->entries.size; ++i) {\n\t\tentry = git_array_get(tree->entries, i);\n\n\t\tif (homing_search_cmp(&ksearch, entry) < 0)\n\t\t\tbreak;\n\n\t\tif (entry->filename_len == filename_len &&\n\t\t\tmemcmp(filename, entry->filename, filename_len) == 0) {\n\t\t\tif (at_pos)\n\t\t\t\t*at_pos = i;\n\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/* If we haven't found our filename yet, look backwards\n\t * too as long as we have entries with the same prefix */\n\tif (homing > 0) {\n\t\ti = homing - 1;\n\n\t\tdo {\n\t\t\tentry = git_array_get(tree->entries, i);\n\n\t\t\tif (homing_search_cmp(&ksearch, entry) > 0)\n\t\t\t\tbreak;\n\n\t\t\tif (entry->filename_len == filename_len &&\n\t\t\t\tmemcmp(filename, entry->filename, filename_len) == 0) {\n\t\t\t\tif (at_pos)\n\t\t\t\t\t*at_pos = i;\n\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t} while (i-- > 0);\n\t}\n\n\t/* The filename doesn't exist at all */\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "homing_search_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "130-143",
    "snippet": "static int homing_search_cmp(const void *key, const void *array_member)\n{\n\tconst struct tree_key_search *ksearch = key;\n\tconst git_tree_entry *entry = array_member;\n\n\tconst uint16_t len1 = ksearch->filename_len;\n\tconst uint16_t len2 = entry->filename_len;\n\n\treturn memcmp(\n\t\tksearch->filename,\n\t\tentry->filename,\n\t\tlen1 < len2 ? len1 : len2\n\t);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "ksearch->filename",
            "entry->filename",
            "len1 < len2 ? len1 : len2"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int homing_search_cmp(const void *key, const void *array_member)\n{\n\tconst struct tree_key_search *ksearch = key;\n\tconst git_tree_entry *entry = array_member;\n\n\tconst uint16_t len1 = ksearch->filename_len;\n\tconst uint16_t len2 = entry->filename_len;\n\n\treturn memcmp(\n\t\tksearch->filename,\n\t\tentry->filename,\n\t\tlen1 < len2 ? len1 : len2\n\t);\n}"
  },
  {
    "function_name": "alloc_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "91-123",
    "snippet": "static git_tree_entry *alloc_entry(const char *filename, size_t filename_len, const git_oid *id)\n{\n\tgit_tree_entry *entry = NULL;\n\tsize_t tree_len;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&tree_len, sizeof(git_tree_entry), filename_len) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, 1) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, GIT_OID_RAWSZ))\n\t\treturn NULL;\n\n\tentry = git__calloc(1, tree_len);\n\tif (!entry)\n\t\treturn NULL;\n\n\t{\n\t\tchar *filename_ptr;\n\t\tvoid *id_ptr;\n\n\t\tfilename_ptr = ((char *) entry) + sizeof(git_tree_entry);\n\t\tmemcpy(filename_ptr, filename, filename_len);\n\t\tentry->filename = filename_ptr;\n\n\t\tid_ptr = filename_ptr + filename_len + 1;\n\t\tgit_oid_cpy(id_ptr, id);\n\t\tentry->oid = id_ptr;\n\t}\n\n\tentry->filename_len = (uint16_t)filename_len;\n\n\treturn entry;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "id_ptr",
            "id"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "filename_ptr",
            "filename",
            "filename_len"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "tree_len"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_ADD_SIZET_OVERFLOW",
          "args": [
            "&tree_len",
            "tree_len",
            "GIT_OID_RAWSZ"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_ADD_SIZET_OVERFLOW",
          "args": [
            "&tree_len",
            "tree_len",
            "1"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_ADD_SIZET_OVERFLOW",
          "args": [
            "&tree_len",
            "sizeof(git_tree_entry)",
            "filename_len"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TREE_ENTRY_CHECK_NAMELEN",
          "args": [
            "filename_len"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic git_tree_entry *alloc_entry(const char *filename, size_t filename_len, const git_oid *id)\n{\n\tgit_tree_entry *entry = NULL;\n\tsize_t tree_len;\n\n\tTREE_ENTRY_CHECK_NAMELEN(filename_len);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&tree_len, sizeof(git_tree_entry), filename_len) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, 1) ||\n\t    GIT_ADD_SIZET_OVERFLOW(&tree_len, tree_len, GIT_OID_RAWSZ))\n\t\treturn NULL;\n\n\tentry = git__calloc(1, tree_len);\n\tif (!entry)\n\t\treturn NULL;\n\n\t{\n\t\tchar *filename_ptr;\n\t\tvoid *id_ptr;\n\n\t\tfilename_ptr = ((char *) entry) + sizeof(git_tree_entry);\n\t\tmemcpy(filename_ptr, filename, filename_len);\n\t\tentry->filename = filename_ptr;\n\n\t\tid_ptr = filename_ptr + filename_len + 1;\n\t\tgit_oid_cpy(id_ptr, id);\n\t\tentry->oid = id_ptr;\n\t}\n\n\tentry->filename_len = (uint16_t)filename_len;\n\n\treturn entry;\n}"
  },
  {
    "function_name": "git_tree_entry_icmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "79-85",
    "snippet": "int git_tree_entry_icmp(const git_tree_entry *e1, const git_tree_entry *e2)\n{\n\treturn git_path_cmp(\n\t\te1->filename, e1->filename_len, git_tree_entry__is_tree(e1),\n\t\te2->filename, e2->filename_len, git_tree_entry__is_tree(e2),\n\t\tgit__strncasecmp);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_path_cmp",
          "args": [
            "e1->filename",
            "e1->filename_len",
            "git_tree_entry__is_tree(e1)",
            "e2->filename",
            "e2->filename_len",
            "git_tree_entry__is_tree(e2)",
            "git__strncasecmp"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "788-811",
          "snippet": "int git_path_cmp(\n\tconst char *name1, size_t len1, int isdir1,\n\tconst char *name2, size_t len2, int isdir2,\n\tint (*compare)(const char *, const char *, size_t))\n{\n\tunsigned char c1, c2;\n\tsize_t len = len1 < len2 ? len1 : len2;\n\tint cmp;\n\n\tcmp = compare(name1, name2, len);\n\tif (cmp)\n\t\treturn cmp;\n\n\tc1 = name1[len];\n\tc2 = name2[len];\n\n\tif (c1 == '\\0' && isdir1)\n\t\tc1 = '/';\n\n\tif (c2 == '\\0' && isdir2)\n\t\tc2 = '/';\n\n\treturn (c1 < c2) ? -1 : (c1 > c2) ? 1 : 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_cmp(\n\tconst char *name1, size_t len1, int isdir1,\n\tconst char *name2, size_t len2, int isdir2,\n\tint (*compare)(const char *, const char *, size_t))\n{\n\tunsigned char c1, c2;\n\tsize_t len = len1 < len2 ? len1 : len2;\n\tint cmp;\n\n\tcmp = compare(name1, name2, len);\n\tif (cmp)\n\t\treturn cmp;\n\n\tc1 = name1[len];\n\tc2 = name2[len];\n\n\tif (c1 == '\\0' && isdir1)\n\t\tc1 = '/';\n\n\tif (c2 == '\\0' && isdir2)\n\t\tc2 = '/';\n\n\treturn (c1 < c2) ? -1 : (c1 > c2) ? 1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry__is_tree",
          "args": [
            "e2"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry__is_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.h",
          "lines": "35-38",
          "snippet": "GIT_INLINE(bool) git_tree_entry__is_tree(const struct git_tree_entry *e)\n{\n\treturn (S_ISDIR(e->attr) && !S_ISGITLINK(e->attr));\n}",
          "includes": [
            "#include \"pool.h\"",
            "#include \"strmap.h\"",
            "#include \"vector.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"git2/tree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pool.h\"\n#include \"strmap.h\"\n#include \"vector.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"git2/tree.h\"\n\nGIT_INLINE(bool) git_tree_entry__is_tree(const struct git_tree_entry *e)\n{\n\treturn (S_ISDIR(e->attr) && !S_ISGITLINK(e->attr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tree_entry_icmp(const git_tree_entry *e1, const git_tree_entry *e2)\n{\n\treturn git_path_cmp(\n\t\te1->filename, e1->filename_len, git_tree_entry__is_tree(e1),\n\t\te2->filename, e2->filename_len, git_tree_entry__is_tree(e2),\n\t\tgit__strncasecmp);\n}"
  },
  {
    "function_name": "git_tree_entry_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "74-77",
    "snippet": "int git_tree_entry_cmp(const git_tree_entry *e1, const git_tree_entry *e2)\n{\n\treturn entry_sort_cmp(e1, e2);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "entry_sort_cmp",
          "args": [
            "e1",
            "e2"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "entry_sort_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
          "lines": "63-72",
          "snippet": "static int entry_sort_cmp(const void *a, const void *b)\n{\n\tconst git_tree_entry *e1 = (const git_tree_entry *)a;\n\tconst git_tree_entry *e2 = (const git_tree_entry *)b;\n\n\treturn git_path_cmp(\n\t\te1->filename, e1->filename_len, git_tree_entry__is_tree(e1),\n\t\te2->filename, e2->filename_len, git_tree_entry__is_tree(e2),\n\t\tgit__strncmp);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"tree-cache.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int entry_sort_cmp(const void *a, const void *b)\n{\n\tconst git_tree_entry *e1 = (const git_tree_entry *)a;\n\tconst git_tree_entry *e2 = (const git_tree_entry *)b;\n\n\treturn git_path_cmp(\n\t\te1->filename, e1->filename_len, git_tree_entry__is_tree(e1),\n\t\te2->filename, e2->filename_len, git_tree_entry__is_tree(e2),\n\t\tgit__strncmp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tree_entry_cmp(const git_tree_entry *e1, const git_tree_entry *e2)\n{\n\treturn entry_sort_cmp(e1, e2);\n}"
  },
  {
    "function_name": "entry_sort_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "63-72",
    "snippet": "static int entry_sort_cmp(const void *a, const void *b)\n{\n\tconst git_tree_entry *e1 = (const git_tree_entry *)a;\n\tconst git_tree_entry *e2 = (const git_tree_entry *)b;\n\n\treturn git_path_cmp(\n\t\te1->filename, e1->filename_len, git_tree_entry__is_tree(e1),\n\t\te2->filename, e2->filename_len, git_tree_entry__is_tree(e2),\n\t\tgit__strncmp);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_path_cmp",
          "args": [
            "e1->filename",
            "e1->filename_len",
            "git_tree_entry__is_tree(e1)",
            "e2->filename",
            "e2->filename_len",
            "git_tree_entry__is_tree(e2)",
            "git__strncmp"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "788-811",
          "snippet": "int git_path_cmp(\n\tconst char *name1, size_t len1, int isdir1,\n\tconst char *name2, size_t len2, int isdir2,\n\tint (*compare)(const char *, const char *, size_t))\n{\n\tunsigned char c1, c2;\n\tsize_t len = len1 < len2 ? len1 : len2;\n\tint cmp;\n\n\tcmp = compare(name1, name2, len);\n\tif (cmp)\n\t\treturn cmp;\n\n\tc1 = name1[len];\n\tc2 = name2[len];\n\n\tif (c1 == '\\0' && isdir1)\n\t\tc1 = '/';\n\n\tif (c2 == '\\0' && isdir2)\n\t\tc2 = '/';\n\n\treturn (c1 < c2) ? -1 : (c1 > c2) ? 1 : 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_cmp(\n\tconst char *name1, size_t len1, int isdir1,\n\tconst char *name2, size_t len2, int isdir2,\n\tint (*compare)(const char *, const char *, size_t))\n{\n\tunsigned char c1, c2;\n\tsize_t len = len1 < len2 ? len1 : len2;\n\tint cmp;\n\n\tcmp = compare(name1, name2, len);\n\tif (cmp)\n\t\treturn cmp;\n\n\tc1 = name1[len];\n\tc2 = name2[len];\n\n\tif (c1 == '\\0' && isdir1)\n\t\tc1 = '/';\n\n\tif (c2 == '\\0' && isdir2)\n\t\tc2 = '/';\n\n\treturn (c1 < c2) ? -1 : (c1 > c2) ? 1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_entry__is_tree",
          "args": [
            "e2"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_entry__is_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.h",
          "lines": "35-38",
          "snippet": "GIT_INLINE(bool) git_tree_entry__is_tree(const struct git_tree_entry *e)\n{\n\treturn (S_ISDIR(e->attr) && !S_ISGITLINK(e->attr));\n}",
          "includes": [
            "#include \"pool.h\"",
            "#include \"strmap.h\"",
            "#include \"vector.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"git2/tree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pool.h\"\n#include \"strmap.h\"\n#include \"vector.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"git2/tree.h\"\n\nGIT_INLINE(bool) git_tree_entry__is_tree(const struct git_tree_entry *e)\n{\n\treturn (S_ISDIR(e->attr) && !S_ISGITLINK(e->attr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int entry_sort_cmp(const void *a, const void *b)\n{\n\tconst git_tree_entry *e1 = (const git_tree_entry *)a;\n\tconst git_tree_entry *e2 = (const git_tree_entry *)b;\n\n\treturn git_path_cmp(\n\t\te1->filename, e1->filename_len, git_tree_entry__is_tree(e1),\n\t\te2->filename, e2->filename_len, git_tree_entry__is_tree(e2),\n\t\tgit__strncmp);\n}"
  },
  {
    "function_name": "valid_entry_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "56-61",
    "snippet": "static int valid_entry_name(git_repository *repo, const char *filename)\n{\n\treturn *filename != '\\0' &&\n\t\tgit_path_isvalid(repo, filename,\n\t\tGIT_PATH_REJECT_TRAVERSAL | GIT_PATH_REJECT_DOT_GIT | GIT_PATH_REJECT_SLASH);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_path_isvalid",
          "args": [
            "repo",
            "filename",
            "GIT_PATH_REJECT_TRAVERSAL | GIT_PATH_REJECT_DOT_GIT | GIT_PATH_REJECT_SLASH"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_isvalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "1677-1701",
          "snippet": "bool git_path_isvalid(\n\tgit_repository *repo,\n\tconst char *path,\n\tunsigned int flags)\n{\n\tconst char *start, *c;\n\n\t/* Upgrade the \".git\" checks based on platform */\n\tif ((flags & GIT_PATH_REJECT_DOT_GIT))\n\t\tflags = dotgit_flags(repo, flags);\n\n\tfor (start = c = path; *c; c++) {\n\t\tif (!verify_char(*c, flags))\n\t\t\treturn false;\n\n\t\tif (*c == '/') {\n\t\t\tif (!verify_component(repo, start, (c - start), flags))\n\t\t\t\treturn false;\n\n\t\t\tstart = c+1;\n\t\t}\n\t}\n\n\treturn verify_component(repo, start, (c - start), flags);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_isvalid(\n\tgit_repository *repo,\n\tconst char *path,\n\tunsigned int flags)\n{\n\tconst char *start, *c;\n\n\t/* Upgrade the \".git\" checks based on platform */\n\tif ((flags & GIT_PATH_REJECT_DOT_GIT))\n\t\tflags = dotgit_flags(repo, flags);\n\n\tfor (start = c = path; *c; c++) {\n\t\tif (!verify_char(*c, flags))\n\t\t\treturn false;\n\n\t\tif (*c == '/') {\n\t\t\tif (!verify_component(repo, start, (c - start), flags))\n\t\t\t\treturn false;\n\n\t\t\tstart = c+1;\n\t\t}\n\t}\n\n\treturn verify_component(repo, start, (c - start), flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int valid_entry_name(git_repository *repo, const char *filename)\n{\n\treturn *filename != '\\0' &&\n\t\tgit_path_isvalid(repo, filename,\n\t\tGIT_PATH_REJECT_TRAVERSAL | GIT_PATH_REJECT_DOT_GIT | GIT_PATH_REJECT_SLASH);\n}"
  },
  {
    "function_name": "normalize_filemode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "34-54",
    "snippet": "GIT_INLINE(git_filemode_t) normalize_filemode(git_filemode_t filemode)\n{\n\t/* Tree bits set, but it's not a commit */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_TREE)\n\t\treturn GIT_FILEMODE_TREE;\n\n\t/* If any of the x bits are set */\n\tif (GIT_PERMS_IS_EXEC(filemode))\n\t\treturn GIT_FILEMODE_BLOB_EXECUTABLE;\n\n\t/* 16XXXX means commit */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_COMMIT)\n\t\treturn GIT_FILEMODE_COMMIT;\n\n\t/* 12XXXX means symlink */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_LINK)\n\t\treturn GIT_FILEMODE_LINK;\n\n\t/* Otherwise, return a blob */\n\treturn GIT_FILEMODE_BLOB;\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_MODE_TYPE",
          "args": [
            "filemode"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_MODE_TYPE",
          "args": [
            "filemode"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_PERMS_IS_EXEC",
          "args": [
            "filemode"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_MODE_TYPE",
          "args": [
            "filemode"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_filemode_t) normalize_filemode(git_filemode_t filemode)\n{\n\t/* Tree bits set, but it's not a commit */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_TREE)\n\t\treturn GIT_FILEMODE_TREE;\n\n\t/* If any of the x bits are set */\n\tif (GIT_PERMS_IS_EXEC(filemode))\n\t\treturn GIT_FILEMODE_BLOB_EXECUTABLE;\n\n\t/* 16XXXX means commit */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_COMMIT)\n\t\treturn GIT_FILEMODE_COMMIT;\n\n\t/* 12XXXX means symlink */\n\tif (GIT_MODE_TYPE(filemode) == GIT_FILEMODE_LINK)\n\t\treturn GIT_FILEMODE_LINK;\n\n\t/* Otherwise, return a blob */\n\treturn GIT_FILEMODE_BLOB;\n}"
  },
  {
    "function_name": "valid_filemode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tree.c",
    "lines": "23-32",
    "snippet": "GIT__USE_STRMAP\n\nstatic bool valid_filemode(const int filemode)\n{\n\treturn (filemode == GIT_FILEMODE_TREE\n\t\t|| filemode == GIT_FILEMODE_BLOB\n\t\t|| filemode == GIT_FILEMODE_BLOB_EXECUTABLE\n\t\t|| filemode == GIT_FILEMODE_LINK\n\t\t|| filemode == GIT_FILEMODE_COMMIT);\n}",
    "includes": [
      "#include \"index.h\"",
      "#include \"tree-cache.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"tree.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"index.h\"\n#include \"tree-cache.h\"\n#include \"fileops.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nGIT__USE_STRMAP\n\nstatic bool valid_filemode(const int filemode)\n{\n\treturn (filemode == GIT_FILEMODE_TREE\n\t\t|| filemode == GIT_FILEMODE_BLOB\n\t\t|| filemode == GIT_FILEMODE_BLOB_EXECUTABLE\n\t\t|| filemode == GIT_FILEMODE_LINK\n\t\t|| filemode == GIT_FILEMODE_COMMIT);\n}"
  }
]