[
  {
    "function_name": "git_config_init_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1478-1483",
    "snippet": "int git_config_init_backend(git_config_backend *backend, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\tbackend, version, git_config_backend, GIT_CONFIG_BACKEND_INIT);\n\treturn 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_INIT_STRUCTURE_FROM_TEMPLATE",
          "args": [
            "backend",
            "version",
            "git_config_backend",
            "GIT_CONFIG_BACKEND_INIT"
          ],
          "line": 1480
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_init_backend(git_config_backend *backend, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\tbackend, version, git_config_backend, GIT_CONFIG_BACKEND_INIT);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_config_rename_section",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1434-1476",
    "snippet": "int git_config_rename_section(\n\tgit_repository *repo,\n\tconst char *old_section_name,\n\tconst char *new_section_name)\n{\n\tgit_config *config;\n\tgit_buf pattern = GIT_BUF_INIT, replace = GIT_BUF_INIT;\n\tint error = 0;\n\tstruct rename_data data;\n\n\tgit_buf_text_puts_escape_regex(&pattern, old_section_name);\n\n\tif ((error = git_buf_puts(&pattern, \"\\\\..+\")) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_repository_config__weakptr(&config, repo)) < 0)\n\t\tgoto cleanup;\n\n\tdata.config  = config;\n\tdata.name    = &replace;\n\tdata.old_len = strlen(old_section_name) + 1;\n\n\tif ((error = git_buf_join(&replace, '.', new_section_name, \"\")) < 0)\n\t\tgoto cleanup;\n\n\tif (new_section_name != NULL &&\n\t\t(error = git_config_file_normalize_section(\n\t\t\treplace.ptr, strchr(replace.ptr, '.'))) < 0)\n\t{\n\t\tgiterr_set(\n\t\t\tGITERR_CONFIG, \"Invalid config section '%s'\", new_section_name);\n\t\tgoto cleanup;\n\t}\n\n\terror = git_config_foreach_match(\n\t\tconfig, git_buf_cstr(&pattern), rename_config_entries_cb, &data);\n\ncleanup:\n\tgit_buf_free(&pattern);\n\tgit_buf_free(&replace);\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&replace"
          ],
          "line": 1473
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_foreach_match",
          "args": [
            "config",
            "git_buf_cstr(&pattern)",
            "rename_config_entries_cb",
            "&data"
          ],
          "line": 1468
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_foreach_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "547-573",
          "snippet": "int git_config_foreach_match(\n\tconst git_config *cfg,\n\tconst char *regexp,\n\tgit_config_foreach_cb cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((error = git_config_iterator_glob_new(&iter, cfg, regexp)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_config_next(&entry, iter))) {\n\t\tif ((error = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tgit_config_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_foreach_match(\n\tconst git_config *cfg,\n\tconst char *regexp,\n\tgit_config_foreach_cb cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((error = git_config_iterator_glob_new(&iter, cfg, regexp)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_config_next(&entry, iter))) {\n\t\tif ((error = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tgit_config_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&pattern"
          ],
          "line": 1469
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"Invalid config section '%s'\"",
            "new_section_name"
          ],
          "line": 1463
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_file_normalize_section",
          "args": [
            "replace.ptr",
            "strchr(replace.ptr, '.')"
          ],
          "line": 1460
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_file_normalize_section",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_file.c",
          "lines": "150-171",
          "snippet": "int git_config_file_normalize_section(char *start, char *end)\n{\n\tchar *scan;\n\n\tif (start == end)\n\t\treturn GIT_EINVALIDSPEC;\n\n\t/* Validate and downcase range */\n\tfor (scan = start; *scan; ++scan) {\n\t\tif (end && scan >= end)\n\t\t\tbreak;\n\t\tif (isalnum(*scan))\n\t\t\t*scan = (char)git__tolower(*scan);\n\t\telse if (*scan != '-' || scan == start)\n\t\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (scan == start)\n\t\treturn GIT_EINVALIDSPEC;\n\n\treturn 0;\n}",
          "includes": [
            "#include <regex.h>",
            "#include <sys/types.h>",
            "#include <ctype.h>",
            "#include \"array.h\"",
            "#include \"strmap.h\"",
            "#include \"git2/types.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"sysdir.h\"",
            "#include \"filebuf.h\"",
            "#include \"config.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <regex.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include \"array.h\"\n#include \"strmap.h\"\n#include \"git2/types.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"sysdir.h\"\n#include \"filebuf.h\"\n#include \"config.h\"\n#include \"common.h\"\n\nint git_config_file_normalize_section(char *start, char *end)\n{\n\tchar *scan;\n\n\tif (start == end)\n\t\treturn GIT_EINVALIDSPEC;\n\n\t/* Validate and downcase range */\n\tfor (scan = start; *scan; ++scan) {\n\t\tif (end && scan >= end)\n\t\t\tbreak;\n\t\tif (isalnum(*scan))\n\t\t\t*scan = (char)git__tolower(*scan);\n\t\telse if (*scan != '-' || scan == start)\n\t\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (scan == start)\n\t\treturn GIT_EINVALIDSPEC;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "replace.ptr",
            "'.'"
          ],
          "line": 1461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_join",
          "args": [
            "&replace",
            "'.'",
            "new_section_name",
            "\"\""
          ],
          "line": 1456
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "607-655",
          "snippet": "int git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "old_section_name"
          ],
          "line": 1454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_config__weakptr",
          "args": [
            "&config",
            "repo"
          ],
          "line": 1449
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "661-705",
          "snippet": "int git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "&pattern",
            "\"\\\\..+\""
          ],
          "line": 1446
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_text_puts_escape_regex",
          "args": [
            "&pattern",
            "old_section_name"
          ],
          "line": 1444
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_text_puts_escape_regex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buf_text.h",
          "lines": "46-49",
          "snippet": "GIT_INLINE(int) git_buf_text_puts_escape_regex(git_buf *buf, const char *string)\n{\n\treturn git_buf_text_puts_escaped(buf, string, \"^.[]$()|*+?{}\\\\\", \"\\\\\");\n}",
          "includes": [
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n\nGIT_INLINE(int) git_buf_text_puts_escape_regex(git_buf *buf, const char *string)\n{\n\treturn git_buf_text_puts_escaped(buf, string, \"^.[]$()|*+?{}\\\\\", \"\\\\\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_rename_section(\n\tgit_repository *repo,\n\tconst char *old_section_name,\n\tconst char *new_section_name)\n{\n\tgit_config *config;\n\tgit_buf pattern = GIT_BUF_INIT, replace = GIT_BUF_INIT;\n\tint error = 0;\n\tstruct rename_data data;\n\n\tgit_buf_text_puts_escape_regex(&pattern, old_section_name);\n\n\tif ((error = git_buf_puts(&pattern, \"\\\\..+\")) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_repository_config__weakptr(&config, repo)) < 0)\n\t\tgoto cleanup;\n\n\tdata.config  = config;\n\tdata.name    = &replace;\n\tdata.old_len = strlen(old_section_name) + 1;\n\n\tif ((error = git_buf_join(&replace, '.', new_section_name, \"\")) < 0)\n\t\tgoto cleanup;\n\n\tif (new_section_name != NULL &&\n\t\t(error = git_config_file_normalize_section(\n\t\t\treplace.ptr, strchr(replace.ptr, '.'))) < 0)\n\t{\n\t\tgiterr_set(\n\t\t\tGITERR_CONFIG, \"Invalid config section '%s'\", new_section_name);\n\t\tgoto cleanup;\n\t}\n\n\terror = git_config_foreach_match(\n\t\tconfig, git_buf_cstr(&pattern), rename_config_entries_cb, &data);\n\ncleanup:\n\tgit_buf_free(&pattern);\n\tgit_buf_free(&replace);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rename_config_entries_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1411-1432",
    "snippet": "static int rename_config_entries_cb(\n\tconst git_config_entry *entry,\n\tvoid *payload)\n{\n\tint error = 0;\n\tstruct rename_data *data = (struct rename_data *)payload;\n\tsize_t base_len = git_buf_len(data->name);\n\n\tif (base_len > 0 &&\n\t\t!(error = git_buf_puts(data->name, entry->name + data->old_len)))\n\t{\n\t\terror = git_config_set_string(\n\t\t\tdata->config, git_buf_cstr(data->name), entry->value);\n\n\t\tgit_buf_truncate(data->name, base_len);\n\t}\n\n\tif (!error)\n\t\terror = git_config_delete_entry(data->config, entry->name);\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_delete_entry",
          "args": [
            "data->config",
            "entry->name"
          ],
          "line": 1429
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_delete_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "586-597",
          "snippet": "int git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_truncate",
          "args": [
            "data->name",
            "base_len"
          ],
          "line": 1425
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "446-454",
          "snippet": "void git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_set_string",
          "args": [
            "data->config",
            "git_buf_cstr(data->name)",
            "entry->value"
          ],
          "line": 1422
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_set_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "616-638",
          "snippet": "int git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "data->name"
          ],
          "line": 1423
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "data->name",
            "entry->name + data->old_len"
          ],
          "line": 1420
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "data->name"
          ],
          "line": 1417
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int rename_config_entries_cb(\n\tconst git_config_entry *entry,\n\tvoid *payload)\n{\n\tint error = 0;\n\tstruct rename_data *data = (struct rename_data *)payload;\n\tsize_t base_len = git_buf_len(data->name);\n\n\tif (base_len > 0 &&\n\t\t!(error = git_buf_puts(data->name, entry->name + data->old_len)))\n\t{\n\t\terror = git_config_set_string(\n\t\t\tdata->config, git_buf_cstr(data->name), entry->value);\n\n\t\tgit_buf_truncate(data->name, base_len);\n\t}\n\n\tif (!error)\n\t\terror = git_config_delete_entry(data->config, entry->name);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_config__normalize_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1371-1403",
    "snippet": "int git_config__normalize_name(const char *in, char **out)\n{\n\tchar *name, *fdot, *ldot;\n\n\tassert(in && out);\n\n\tname = git__strdup(in);\n\tGITERR_CHECK_ALLOC(name);\n\n\tfdot = strchr(name, '.');\n\tldot = strrchr(name, '.');\n\n\tif (fdot == NULL || fdot == name || ldot == NULL || !ldot[1])\n\t\tgoto invalid;\n\n\t/* Validate and downcase up to first dot and after last dot */\n\tif (git_config_file_normalize_section(name, fdot) < 0 ||\n\t\tgit_config_file_normalize_section(ldot + 1, NULL) < 0)\n\t\tgoto invalid;\n\n\t/* If there is a middle range, make sure it doesn't have newlines */\n\twhile (fdot < ldot)\n\t\tif (*fdot++ == '\\n')\n\t\t\tgoto invalid;\n\n\t*out = name;\n\treturn 0;\n\ninvalid:\n\tgit__free(name);\n\tgiterr_set(GITERR_CONFIG, \"Invalid config item name '%s'\", in);\n\treturn GIT_EINVALIDSPEC;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"Invalid config item name '%s'\"",
            "in"
          ],
          "line": 1401
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "name"
          ],
          "line": 1400
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_file_normalize_section",
          "args": [
            "ldot + 1",
            "NULL"
          ],
          "line": 1388
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_file_normalize_section",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_file.c",
          "lines": "150-171",
          "snippet": "int git_config_file_normalize_section(char *start, char *end)\n{\n\tchar *scan;\n\n\tif (start == end)\n\t\treturn GIT_EINVALIDSPEC;\n\n\t/* Validate and downcase range */\n\tfor (scan = start; *scan; ++scan) {\n\t\tif (end && scan >= end)\n\t\t\tbreak;\n\t\tif (isalnum(*scan))\n\t\t\t*scan = (char)git__tolower(*scan);\n\t\telse if (*scan != '-' || scan == start)\n\t\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (scan == start)\n\t\treturn GIT_EINVALIDSPEC;\n\n\treturn 0;\n}",
          "includes": [
            "#include <regex.h>",
            "#include <sys/types.h>",
            "#include <ctype.h>",
            "#include \"array.h\"",
            "#include \"strmap.h\"",
            "#include \"git2/types.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"sysdir.h\"",
            "#include \"filebuf.h\"",
            "#include \"config.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <regex.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include \"array.h\"\n#include \"strmap.h\"\n#include \"git2/types.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"sysdir.h\"\n#include \"filebuf.h\"\n#include \"config.h\"\n#include \"common.h\"\n\nint git_config_file_normalize_section(char *start, char *end)\n{\n\tchar *scan;\n\n\tif (start == end)\n\t\treturn GIT_EINVALIDSPEC;\n\n\t/* Validate and downcase range */\n\tfor (scan = start; *scan; ++scan) {\n\t\tif (end && scan >= end)\n\t\t\tbreak;\n\t\tif (isalnum(*scan))\n\t\t\t*scan = (char)git__tolower(*scan);\n\t\telse if (*scan != '-' || scan == start)\n\t\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (scan == start)\n\t\treturn GIT_EINVALIDSPEC;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "name",
            "'.'"
          ],
          "line": 1381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "name",
            "'.'"
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "name"
          ],
          "line": 1378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "in"
          ],
          "line": 1377
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "in && out"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__normalize_name(const char *in, char **out)\n{\n\tchar *name, *fdot, *ldot;\n\n\tassert(in && out);\n\n\tname = git__strdup(in);\n\tGITERR_CHECK_ALLOC(name);\n\n\tfdot = strchr(name, '.');\n\tldot = strrchr(name, '.');\n\n\tif (fdot == NULL || fdot == name || ldot == NULL || !ldot[1])\n\t\tgoto invalid;\n\n\t/* Validate and downcase up to first dot and after last dot */\n\tif (git_config_file_normalize_section(name, fdot) < 0 ||\n\t\tgit_config_file_normalize_section(ldot + 1, NULL) < 0)\n\t\tgoto invalid;\n\n\t/* If there is a middle range, make sure it doesn't have newlines */\n\twhile (fdot < ldot)\n\t\tif (*fdot++ == '\\n')\n\t\t\tgoto invalid;\n\n\t*out = name;\n\treturn 0;\n\ninvalid:\n\tgit__free(name);\n\tgiterr_set(GITERR_CONFIG, \"Invalid config item name '%s'\", in);\n\treturn GIT_EINVALIDSPEC;\n}"
  },
  {
    "function_name": "git_config_parse_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1340-1368",
    "snippet": "int git_config_parse_path(git_buf *out, const char *value)\n{\n\tint error = 0;\n\tconst git_buf *home;\n\n\tassert(out && value);\n\n\tgit_buf_sanitize(out);\n\n\tif (value[0] == '~') {\n\t\tif (value[1] != '\\0' && value[1] != '/') {\n\t\t\tgiterr_set(GITERR_CONFIG, \"retrieving a homedir by name is not supported\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((error = git_sysdir_get(&home, GIT_SYSDIR_GLOBAL)) < 0)\n\t\t\treturn error;\n\n\t\tgit_buf_sets(out, home->ptr);\n\t\tgit_buf_puts(out, value + 1);\n\n\t\tif (git_buf_oom(out))\n\t\t\treturn -1;\n\n\t\treturn 0;\n\t}\n\n\treturn git_buf_sets(out, value);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_sets",
          "args": [
            "out",
            "value"
          ],
          "line": 1367
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "181-184",
          "snippet": "int git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 1361
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "out",
            "value + 1"
          ],
          "line": 1359
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_sysdir_get",
          "args": [
            "&home",
            "GIT_SYSDIR_GLOBAL"
          ],
          "line": 1355
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "130-140",
          "snippet": "int git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"retrieving a homedir by name is not supported\""
          ],
          "line": 1351
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "out"
          ],
          "line": 1347
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && value"
          ],
          "line": 1345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_path(git_buf *out, const char *value)\n{\n\tint error = 0;\n\tconst git_buf *home;\n\n\tassert(out && value);\n\n\tgit_buf_sanitize(out);\n\n\tif (value[0] == '~') {\n\t\tif (value[1] != '\\0' && value[1] != '/') {\n\t\t\tgiterr_set(GITERR_CONFIG, \"retrieving a homedir by name is not supported\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((error = git_sysdir_get(&home, GIT_SYSDIR_GLOBAL)) < 0)\n\t\t\treturn error;\n\n\t\tgit_buf_sets(out, home->ptr);\n\t\tgit_buf_puts(out, value + 1);\n\n\t\tif (git_buf_oom(out))\n\t\t\treturn -1;\n\n\t\treturn 0;\n\t}\n\n\treturn git_buf_sets(out, value);\n}"
  },
  {
    "function_name": "git_config_parse_int32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1320-1338",
    "snippet": "int git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"Failed to parse '%s' as a 32-bit integer\"",
            "value ? value : \"(null)\""
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_int64",
          "args": [
            "&tmp",
            "value"
          ],
          "line": 1325
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_int64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1277-1318",
          "snippet": "int git_config_parse_int64(int64_t *out, const char *value)\n{\n\tconst char *num_end;\n\tint64_t num;\n\n\tif (!value || git__strtol64(&num, value, &num_end, 0) < 0)\n\t\tgoto fail_parse;\n\n\tswitch (*num_end) {\n\tcase 'g':\n\tcase 'G':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'm':\n\tcase 'M':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'k':\n\tcase 'K':\n\t\tnum *= 1024;\n\n\t\t/* check that that there are no more characters after the\n\t\t * given modifier suffix */\n\t\tif (num_end[1] != '\\0')\n\t\t\treturn -1;\n\n\t\t/* fallthrough */\n\n\tcase '\\0':\n\t\t*out = num;\n\t\treturn 0;\n\n\tdefault:\n\t\tgoto fail_parse;\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as an integer\", value ? value : \"(null)\");\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_int64(int64_t *out, const char *value)\n{\n\tconst char *num_end;\n\tint64_t num;\n\n\tif (!value || git__strtol64(&num, value, &num_end, 0) < 0)\n\t\tgoto fail_parse;\n\n\tswitch (*num_end) {\n\tcase 'g':\n\tcase 'G':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'm':\n\tcase 'M':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'k':\n\tcase 'K':\n\t\tnum *= 1024;\n\n\t\t/* check that that there are no more characters after the\n\t\t * given modifier suffix */\n\t\tif (num_end[1] != '\\0')\n\t\t\treturn -1;\n\n\t\t/* fallthrough */\n\n\tcase '\\0':\n\t\t*out = num;\n\t\treturn 0;\n\n\tdefault:\n\t\tgoto fail_parse;\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as an integer\", value ? value : \"(null)\");\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}"
  },
  {
    "function_name": "git_config_parse_int64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1277-1318",
    "snippet": "int git_config_parse_int64(int64_t *out, const char *value)\n{\n\tconst char *num_end;\n\tint64_t num;\n\n\tif (!value || git__strtol64(&num, value, &num_end, 0) < 0)\n\t\tgoto fail_parse;\n\n\tswitch (*num_end) {\n\tcase 'g':\n\tcase 'G':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'm':\n\tcase 'M':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'k':\n\tcase 'K':\n\t\tnum *= 1024;\n\n\t\t/* check that that there are no more characters after the\n\t\t * given modifier suffix */\n\t\tif (num_end[1] != '\\0')\n\t\t\treturn -1;\n\n\t\t/* fallthrough */\n\n\tcase '\\0':\n\t\t*out = num;\n\t\treturn 0;\n\n\tdefault:\n\t\tgoto fail_parse;\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as an integer\", value ? value : \"(null)\");\n\treturn -1;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"Failed to parse '%s' as an integer\"",
            "value ? value : \"(null)\""
          ],
          "line": 1316
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strtol64",
          "args": [
            "&num",
            "value",
            "&num_end",
            "0"
          ],
          "line": 1282
        },
        "resolved": true,
        "details": {
          "function_name": "git__strtol64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "67-147",
          "snippet": "int git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_int64(int64_t *out, const char *value)\n{\n\tconst char *num_end;\n\tint64_t num;\n\n\tif (!value || git__strtol64(&num, value, &num_end, 0) < 0)\n\t\tgoto fail_parse;\n\n\tswitch (*num_end) {\n\tcase 'g':\n\tcase 'G':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'm':\n\tcase 'M':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'k':\n\tcase 'K':\n\t\tnum *= 1024;\n\n\t\t/* check that that there are no more characters after the\n\t\t * given modifier suffix */\n\t\tif (num_end[1] != '\\0')\n\t\t\treturn -1;\n\n\t\t/* fallthrough */\n\n\tcase '\\0':\n\t\t*out = num;\n\t\treturn 0;\n\n\tdefault:\n\t\tgoto fail_parse;\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as an integer\", value ? value : \"(null)\");\n\treturn -1;\n}"
  },
  {
    "function_name": "git_config_parse_bool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1263-1275",
    "snippet": "int git_config_parse_bool(int *out, const char *value)\n{\n\tif (git__parse_bool(out, value) == 0)\n\t\treturn 0;\n\n\tif (git_config_parse_int32(out, value) == 0) {\n\t\t*out = !!(*out);\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a boolean value\", value);\n\treturn -1;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"Failed to parse '%s' as a boolean value\"",
            "value"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_int32",
          "args": [
            "out",
            "value"
          ],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_int32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1320-1338",
          "snippet": "int git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__parse_bool",
          "args": [
            "out",
            "value"
          ],
          "line": 1265
        },
        "resolved": true,
        "details": {
          "function_name": "git__parse_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "572-591",
          "snippet": "int git__parse_bool(int *out, const char *value)\n{\n\t/* A missing value means true */\n\tif (value == NULL ||\n\t\t!strcasecmp(value, \"true\") ||\n\t\t!strcasecmp(value, \"yes\") ||\n\t\t!strcasecmp(value, \"on\")) {\n\t\t*out = 1;\n\t\treturn 0;\n\t}\n\tif (!strcasecmp(value, \"false\") ||\n\t\t!strcasecmp(value, \"no\") ||\n\t\t!strcasecmp(value, \"off\") ||\n\t\tvalue[0] == '\\0') {\n\t\t*out = 0;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__parse_bool(int *out, const char *value)\n{\n\t/* A missing value means true */\n\tif (value == NULL ||\n\t\t!strcasecmp(value, \"true\") ||\n\t\t!strcasecmp(value, \"yes\") ||\n\t\t!strcasecmp(value, \"on\")) {\n\t\t*out = 1;\n\t\treturn 0;\n\t}\n\tif (!strcasecmp(value, \"false\") ||\n\t\t!strcasecmp(value, \"no\") ||\n\t\t!strcasecmp(value, \"off\") ||\n\t\tvalue[0] == '\\0') {\n\t\t*out = 0;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_bool(int *out, const char *value)\n{\n\tif (git__parse_bool(out, value) == 0)\n\t\treturn 0;\n\n\tif (git_config_parse_int32(out, value) == 0) {\n\t\t*out = !!(*out);\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a boolean value\", value);\n\treturn -1;\n}"
  },
  {
    "function_name": "git_config_lookup_map_enum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1243-1261",
    "snippet": "int git_config_lookup_map_enum(git_cvar_t *type_out, const char **str_out,\n\t\t\t       const git_cvar_map *maps, size_t map_n, int enum_val)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < map_n; i++) {\n\t\tconst git_cvar_map *m = &maps[i];\n\n\t\tif (m->map_value != enum_val)\n\t\t\tcontinue;\n\n\t\t*type_out = m->cvar_type;\n\t\t*str_out = m->str_match;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"invalid enum value\");\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"invalid enum value\""
          ],
          "line": 1259
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_lookup_map_enum(git_cvar_t *type_out, const char **str_out,\n\t\t\t       const git_cvar_map *maps, size_t map_n, int enum_val)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < map_n; i++) {\n\t\tconst git_cvar_map *m = &maps[i];\n\n\t\tif (m->map_value != enum_val)\n\t\t\tcontinue;\n\n\t\t*type_out = m->cvar_type;\n\t\t*str_out = m->str_match;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"invalid enum value\");\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git_config_lookup_map_value",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1197-1241",
    "snippet": "int git_config_lookup_map_value(\n\tint *out,\n\tconst git_cvar_map *maps,\n\tsize_t map_n,\n\tconst char *value)\n{\n\tsize_t i;\n\n\tif (!value)\n\t\tgoto fail_parse;\n\n\tfor (i = 0; i < map_n; ++i) {\n\t\tconst git_cvar_map *m = maps + i;\n\n\t\tswitch (m->cvar_type) {\n\t\tcase GIT_CVAR_FALSE:\n\t\tcase GIT_CVAR_TRUE: {\n\t\t\tint bool_val;\n\n\t\t\tif (git__parse_bool(&bool_val, value) == 0 &&\n\t\t\t\tbool_val == (int)m->cvar_type) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tcase GIT_CVAR_INT32:\n\t\t\tif (git_config_parse_int32(out, value) == 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\n\t\tcase GIT_CVAR_STRING:\n\t\t\tif (strcasecmp(value, m->str_match) == 0) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to map '%s'\", value);\n\treturn -1;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"Failed to map '%s'\"",
            "value"
          ],
          "line": 1239
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "value",
            "m->str_match"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcasecmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "567-570",
          "snippet": "int git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_int32",
          "args": [
            "out",
            "value"
          ],
          "line": 1225
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_int32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1320-1338",
          "snippet": "int git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__parse_bool",
          "args": [
            "&bool_val",
            "value"
          ],
          "line": 1216
        },
        "resolved": true,
        "details": {
          "function_name": "git__parse_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "572-591",
          "snippet": "int git__parse_bool(int *out, const char *value)\n{\n\t/* A missing value means true */\n\tif (value == NULL ||\n\t\t!strcasecmp(value, \"true\") ||\n\t\t!strcasecmp(value, \"yes\") ||\n\t\t!strcasecmp(value, \"on\")) {\n\t\t*out = 1;\n\t\treturn 0;\n\t}\n\tif (!strcasecmp(value, \"false\") ||\n\t\t!strcasecmp(value, \"no\") ||\n\t\t!strcasecmp(value, \"off\") ||\n\t\tvalue[0] == '\\0') {\n\t\t*out = 0;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__parse_bool(int *out, const char *value)\n{\n\t/* A missing value means true */\n\tif (value == NULL ||\n\t\t!strcasecmp(value, \"true\") ||\n\t\t!strcasecmp(value, \"yes\") ||\n\t\t!strcasecmp(value, \"on\")) {\n\t\t*out = 1;\n\t\treturn 0;\n\t}\n\tif (!strcasecmp(value, \"false\") ||\n\t\t!strcasecmp(value, \"no\") ||\n\t\t!strcasecmp(value, \"off\") ||\n\t\tvalue[0] == '\\0') {\n\t\t*out = 0;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_lookup_map_value(\n\tint *out,\n\tconst git_cvar_map *maps,\n\tsize_t map_n,\n\tconst char *value)\n{\n\tsize_t i;\n\n\tif (!value)\n\t\tgoto fail_parse;\n\n\tfor (i = 0; i < map_n; ++i) {\n\t\tconst git_cvar_map *m = maps + i;\n\n\t\tswitch (m->cvar_type) {\n\t\tcase GIT_CVAR_FALSE:\n\t\tcase GIT_CVAR_TRUE: {\n\t\t\tint bool_val;\n\n\t\t\tif (git__parse_bool(&bool_val, value) == 0 &&\n\t\t\t\tbool_val == (int)m->cvar_type) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tcase GIT_CVAR_INT32:\n\t\t\tif (git_config_parse_int32(out, value) == 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\n\t\tcase GIT_CVAR_STRING:\n\t\t\tif (strcasecmp(value, m->str_match) == 0) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to map '%s'\", value);\n\treturn -1;\n}"
  },
  {
    "function_name": "git_config_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1177-1191",
    "snippet": "int git_config_unlock(git_config *cfg, int commit)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file) {\n\t\tgiterr_set(GITERR_CONFIG, \"cannot lock; the config has no backends/files\");\n\t\treturn -1;\n\t}\n\n\tfile = internal->file;\n\n\treturn file->unlock(file, commit);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->unlock",
          "args": [
            "file",
            "commit"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"cannot lock; the config has no backends/files\""
          ],
          "line": 1184
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "0"
          ],
          "line": 1182
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_unlock(git_config *cfg, int commit)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file) {\n\t\tgiterr_set(GITERR_CONFIG, \"cannot lock; the config has no backends/files\");\n\t\treturn -1;\n\t}\n\n\tfile = internal->file;\n\n\treturn file->unlock(file, commit);\n}"
  },
  {
    "function_name": "git_config_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1158-1175",
    "snippet": "int git_config_lock(git_transaction **out, git_config *cfg)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file) {\n\t\tgiterr_set(GITERR_CONFIG, \"cannot lock; the config has no backends/files\");\n\t\treturn -1;\n\t}\n\tfile = internal->file;\n\n\tif ((error = file->lock(file)) < 0)\n\t\treturn error;\n\n\treturn git_transaction_config_new(out, cfg);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_transaction_config_new",
          "args": [
            "out",
            "cfg"
          ],
          "line": 1174
        },
        "resolved": true,
        "details": {
          "function_name": "git_transaction_config_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transaction.c",
          "lines": "58-70",
          "snippet": "int git_transaction_config_new(git_transaction **out, git_config *cfg)\n{\n\tgit_transaction *tx;\n\tassert(out && cfg);\n\n\ttx = git__calloc(1, sizeof(git_transaction));\n\tGITERR_CHECK_ALLOC(tx);\n\n\ttx->type = TRANSACTION_CONFIG;\n\ttx->cfg = cfg;\n\t*out = tx;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/refdb_backend.h\"",
            "#include \"git2/sys/refs.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/transaction.h\"",
            "#include \"config.h\"",
            "#include \"signature.h\"",
            "#include \"reflog.h\"",
            "#include \"pool.h\"",
            "#include \"refdb.h\"",
            "#include \"strmap.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/refdb_backend.h\"\n#include \"git2/sys/refs.h\"\n#include \"git2/signature.h\"\n#include \"git2/transaction.h\"\n#include \"config.h\"\n#include \"signature.h\"\n#include \"reflog.h\"\n#include \"pool.h\"\n#include \"refdb.h\"\n#include \"strmap.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_transaction_config_new(git_transaction **out, git_config *cfg)\n{\n\tgit_transaction *tx;\n\tassert(out && cfg);\n\n\ttx = git__calloc(1, sizeof(git_transaction));\n\tGITERR_CHECK_ALLOC(tx);\n\n\ttx->type = TRANSACTION_CONFIG;\n\ttx->cfg = cfg;\n\t*out = tx;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->lock",
          "args": [
            "file"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"cannot lock; the config has no backends/files\""
          ],
          "line": 1166
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "0"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_lock(git_transaction **out, git_config *cfg)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file) {\n\t\tgiterr_set(GITERR_CONFIG, \"cannot lock; the config has no backends/files\");\n\t\treturn -1;\n\t}\n\tfile = internal->file;\n\n\tif ((error = file->lock(file)) < 0)\n\t\treturn error;\n\n\treturn git_transaction_config_new(out, cfg);\n}"
  },
  {
    "function_name": "git_config_open_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1120-1156",
    "snippet": "int git_config_open_default(git_config **out)\n{\n\tint error;\n\tgit_config *cfg = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tif ((error = git_config_new(&cfg)) < 0)\n\t\treturn error;\n\n\tif (!git_config_find_global(&buf) || !git_config__global_location(&buf)) {\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_GLOBAL, 0);\n\t}\n\n\tif (!error && !git_config_find_xdg(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_XDG, 0);\n\n\tif (!error && !git_config_find_system(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_SYSTEM, 0);\n\n\tif (!error && !git_config_find_programdata(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_PROGRAMDATA, 0);\n\n\tgit_buf_free(&buf);\n\n\tif (error) {\n\t\tgit_config_free(cfg);\n\t\tcfg = NULL;\n\t}\n\n\t*out = cfg;\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "cfg"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 1146
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_add_file_ondisk",
          "args": [
            "cfg",
            "buf.ptr",
            "GIT_CONFIG_LEVEL_PROGRAMDATA",
            "0"
          ],
          "line": 1143
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_add_file_ondisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "98-129",
          "snippet": "int git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_find_programdata",
          "args": [
            "&buf"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_find_programdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1089-1093",
          "snippet": "int git_config_find_programdata(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_programdata_file(path, GIT_CONFIG_FILENAME_PROGRAMDATA);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_programdata(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_programdata_file(path, GIT_CONFIG_FILENAME_PROGRAMDATA);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_find_system",
          "args": [
            "&buf"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_find_system",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1083-1087",
          "snippet": "int git_config_find_system(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_system_file(path, GIT_CONFIG_FILENAME_SYSTEM);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_system(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_system_file(path, GIT_CONFIG_FILENAME_SYSTEM);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_find_xdg",
          "args": [
            "&buf"
          ],
          "line": 1134
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_find_xdg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1077-1081",
          "snippet": "int git_config_find_xdg(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_xdg_file(path, GIT_CONFIG_FILENAME_XDG);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_xdg(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_xdg_file(path, GIT_CONFIG_FILENAME_XDG);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config__global_location",
          "args": [
            "&buf"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__global_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1095-1118",
          "snippet": "int git_config__global_location(git_buf *buf)\n{\n\tconst git_buf *paths;\n\tconst char *sep, *start;\n\n\tif (git_sysdir_get(&paths, GIT_SYSDIR_GLOBAL) < 0)\n\t\treturn -1;\n\n\t/* no paths, so give up */\n\tif (!paths || !git_buf_len(paths))\n\t\treturn -1;\n\n\t/* find unescaped separator or end of string */\n\tfor (sep = start = git_buf_cstr(paths); *sep; ++sep) {\n\t\tif (*sep == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t(sep <= start || sep[-1] != '\\\\'))\n\t\t\tbreak;\n\t}\n\n\tif (git_buf_set(buf, start, (size_t)(sep - start)) < 0)\n\t\treturn -1;\n\n\treturn git_buf_joinpath(buf, buf->ptr, GIT_CONFIG_FILENAME_GLOBAL);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__global_location(git_buf *buf)\n{\n\tconst git_buf *paths;\n\tconst char *sep, *start;\n\n\tif (git_sysdir_get(&paths, GIT_SYSDIR_GLOBAL) < 0)\n\t\treturn -1;\n\n\t/* no paths, so give up */\n\tif (!paths || !git_buf_len(paths))\n\t\treturn -1;\n\n\t/* find unescaped separator or end of string */\n\tfor (sep = start = git_buf_cstr(paths); *sep; ++sep) {\n\t\tif (*sep == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t(sep <= start || sep[-1] != '\\\\'))\n\t\t\tbreak;\n\t}\n\n\tif (git_buf_set(buf, start, (size_t)(sep - start)) < 0)\n\t\treturn -1;\n\n\treturn git_buf_joinpath(buf, buf->ptr, GIT_CONFIG_FILENAME_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_find_global",
          "args": [
            "&buf"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_find_global",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1071-1075",
          "snippet": "int git_config_find_global(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_global_file(path, GIT_CONFIG_FILENAME_GLOBAL);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_global(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_global_file(path, GIT_CONFIG_FILENAME_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_new",
          "args": [
            "&cfg"
          ],
          "line": 1126
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "79-96",
          "snippet": "int git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_open_default(git_config **out)\n{\n\tint error;\n\tgit_config *cfg = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tif ((error = git_config_new(&cfg)) < 0)\n\t\treturn error;\n\n\tif (!git_config_find_global(&buf) || !git_config__global_location(&buf)) {\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_GLOBAL, 0);\n\t}\n\n\tif (!error && !git_config_find_xdg(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_XDG, 0);\n\n\tif (!error && !git_config_find_system(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_SYSTEM, 0);\n\n\tif (!error && !git_config_find_programdata(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_PROGRAMDATA, 0);\n\n\tgit_buf_free(&buf);\n\n\tif (error) {\n\t\tgit_config_free(cfg);\n\t\tcfg = NULL;\n\t}\n\n\t*out = cfg;\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_config__global_location",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1095-1118",
    "snippet": "int git_config__global_location(git_buf *buf)\n{\n\tconst git_buf *paths;\n\tconst char *sep, *start;\n\n\tif (git_sysdir_get(&paths, GIT_SYSDIR_GLOBAL) < 0)\n\t\treturn -1;\n\n\t/* no paths, so give up */\n\tif (!paths || !git_buf_len(paths))\n\t\treturn -1;\n\n\t/* find unescaped separator or end of string */\n\tfor (sep = start = git_buf_cstr(paths); *sep; ++sep) {\n\t\tif (*sep == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t(sep <= start || sep[-1] != '\\\\'))\n\t\t\tbreak;\n\t}\n\n\tif (git_buf_set(buf, start, (size_t)(sep - start)) < 0)\n\t\treturn -1;\n\n\treturn git_buf_joinpath(buf, buf->ptr, GIT_CONFIG_FILENAME_GLOBAL);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "buf",
            "buf->ptr",
            "GIT_CONFIG_FILENAME_GLOBAL"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_set",
          "args": [
            "buf",
            "start",
            "(size_t)(sep - start)"
          ],
          "line": 1114
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "150-169",
          "snippet": "int git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "paths"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "paths"
          ],
          "line": 1104
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_sysdir_get",
          "args": [
            "&paths",
            "GIT_SYSDIR_GLOBAL"
          ],
          "line": 1100
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "130-140",
          "snippet": "int git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__global_location(git_buf *buf)\n{\n\tconst git_buf *paths;\n\tconst char *sep, *start;\n\n\tif (git_sysdir_get(&paths, GIT_SYSDIR_GLOBAL) < 0)\n\t\treturn -1;\n\n\t/* no paths, so give up */\n\tif (!paths || !git_buf_len(paths))\n\t\treturn -1;\n\n\t/* find unescaped separator or end of string */\n\tfor (sep = start = git_buf_cstr(paths); *sep; ++sep) {\n\t\tif (*sep == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t(sep <= start || sep[-1] != '\\\\'))\n\t\t\tbreak;\n\t}\n\n\tif (git_buf_set(buf, start, (size_t)(sep - start)) < 0)\n\t\treturn -1;\n\n\treturn git_buf_joinpath(buf, buf->ptr, GIT_CONFIG_FILENAME_GLOBAL);\n}"
  },
  {
    "function_name": "git_config_find_programdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1089-1093",
    "snippet": "int git_config_find_programdata(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_programdata_file(path, GIT_CONFIG_FILENAME_PROGRAMDATA);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_sysdir_find_programdata_file",
          "args": [
            "path",
            "GIT_CONFIG_FILENAME_PROGRAMDATA"
          ],
          "line": 1092
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_programdata_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "266-270",
          "snippet": "int git_sysdir_find_programdata_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_PROGRAMDATA, \"ProgramData\");\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_programdata_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_PROGRAMDATA, \"ProgramData\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "path"
          ],
          "line": 1091
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_programdata(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_programdata_file(path, GIT_CONFIG_FILENAME_PROGRAMDATA);\n}"
  },
  {
    "function_name": "git_config_find_system",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1083-1087",
    "snippet": "int git_config_find_system(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_system_file(path, GIT_CONFIG_FILENAME_SYSTEM);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_sysdir_find_system_file",
          "args": [
            "path",
            "GIT_CONFIG_FILENAME_SYSTEM"
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_system_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "248-252",
          "snippet": "int git_sysdir_find_system_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_SYSTEM, \"system\");\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_system_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_SYSTEM, \"system\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "path"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_system(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_system_file(path, GIT_CONFIG_FILENAME_SYSTEM);\n}"
  },
  {
    "function_name": "git_config_find_xdg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1077-1081",
    "snippet": "int git_config_find_xdg(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_xdg_file(path, GIT_CONFIG_FILENAME_XDG);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_sysdir_find_xdg_file",
          "args": [
            "path",
            "GIT_CONFIG_FILENAME_XDG"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_xdg_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "260-264",
          "snippet": "int git_sysdir_find_xdg_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_XDG, \"global/xdg\");\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_xdg_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_XDG, \"global/xdg\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "path"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_xdg(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_xdg_file(path, GIT_CONFIG_FILENAME_XDG);\n}"
  },
  {
    "function_name": "git_config_find_global",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1071-1075",
    "snippet": "int git_config_find_global(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_global_file(path, GIT_CONFIG_FILENAME_GLOBAL);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_sysdir_find_global_file",
          "args": [
            "path",
            "GIT_CONFIG_FILENAME_GLOBAL"
          ],
          "line": 1074
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_global_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "254-258",
          "snippet": "int git_sysdir_find_global_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_GLOBAL, \"global\");\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_global_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_GLOBAL, \"global\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "path"
          ],
          "line": 1073
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_global(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_global_file(path, GIT_CONFIG_FILENAME_GLOBAL);\n}"
  },
  {
    "function_name": "git_config_iterator_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1063-1069",
    "snippet": "void git_config_iterator_free(git_config_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->free(iter);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->free",
          "args": [
            "iter"
          ],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_iterator_free(git_config_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->free(iter);\n}"
  },
  {
    "function_name": "git_config_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1058-1061",
    "snippet": "int git_config_next(git_config_entry **entry, git_config_iterator *iter)\n{\n\treturn iter->next(entry, iter);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->next",
          "args": [
            "entry",
            "iter"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_next(git_config_entry **entry, git_config_iterator *iter)\n{\n\treturn iter->next(entry, iter);\n}"
  },
  {
    "function_name": "git_config_delete_multivar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1045-1056",
    "snippet": "int git_config_delete_multivar(git_config *cfg, const char *name, const char *regexp)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del_multivar(file, name, regexp);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->del_multivar",
          "args": [
            "file",
            "name",
            "regexp"
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_error_nofiles",
          "args": [
            "name"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "config_error_nofiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "579-584",
          "snippet": "static int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "0"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_delete_multivar(git_config *cfg, const char *name, const char *regexp)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del_multivar(file, name, regexp);\n}"
  },
  {
    "function_name": "git_config_set_multivar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "1032-1043",
    "snippet": "int git_config_set_multivar(git_config *cfg, const char *name, const char *regexp, const char *value)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->set_multivar(file, name, regexp, value);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->set_multivar",
          "args": [
            "file",
            "name",
            "regexp",
            "value"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_error_nofiles",
          "args": [
            "name"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "config_error_nofiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "579-584",
          "snippet": "static int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "0"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_multivar(git_config *cfg, const char *name, const char *regexp, const char *value)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->set_multivar(file, name, regexp, value);\n}"
  },
  {
    "function_name": "git_config_multivar_iterator_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "990-1030",
    "snippet": "int git_config_multivar_iterator_new(git_config_iterator **out, const git_config *cfg, const char *name, const char *regexp)\n{\n\tmultivar_iter *iter = NULL;\n\tgit_config_iterator *inner = NULL;\n\tint error;\n\n\tif ((error = git_config_iterator_new(&inner, cfg)) < 0)\n\t\treturn error;\n\n\titer = git__calloc(1, sizeof(multivar_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\tif ((error = git_config__normalize_name(name, &iter->name)) < 0)\n\t\tgoto on_error;\n\n\tif (regexp != NULL) {\n\t\terror = regcomp(&iter->regex, regexp, REG_EXTENDED);\n\t\tif (error != 0) {\n\t\t\tgiterr_set_regex(&iter->regex, error);\n\t\t\terror = -1;\n\t\t\tregfree(&iter->regex);\n\t\t\tgoto on_error;\n\t\t}\n\n\t\titer->have_regex = 1;\n\t}\n\n\titer->iter = inner;\n\titer->parent.free = multivar_iter_free;\n\titer->parent.next = multivar_iter_next;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n\non_error:\n\n\tinner->free(inner);\n\tgit__free(iter);\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "iter"
          ],
          "line": 1028
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "inner->free",
          "args": [
            "inner"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "regfree",
          "args": [
            "&iter->regex"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set_regex",
          "args": [
            "&iter->regex",
            "error"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_regex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "106-119",
          "snippet": "int giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "regcomp",
          "args": [
            "&iter->regex",
            "regexp",
            "REG_EXTENDED"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_config__normalize_name",
          "args": [
            "name",
            "&iter->name"
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__normalize_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1371-1403",
          "snippet": "int git_config__normalize_name(const char *in, char **out)\n{\n\tchar *name, *fdot, *ldot;\n\n\tassert(in && out);\n\n\tname = git__strdup(in);\n\tGITERR_CHECK_ALLOC(name);\n\n\tfdot = strchr(name, '.');\n\tldot = strrchr(name, '.');\n\n\tif (fdot == NULL || fdot == name || ldot == NULL || !ldot[1])\n\t\tgoto invalid;\n\n\t/* Validate and downcase up to first dot and after last dot */\n\tif (git_config_file_normalize_section(name, fdot) < 0 ||\n\t\tgit_config_file_normalize_section(ldot + 1, NULL) < 0)\n\t\tgoto invalid;\n\n\t/* If there is a middle range, make sure it doesn't have newlines */\n\twhile (fdot < ldot)\n\t\tif (*fdot++ == '\\n')\n\t\t\tgoto invalid;\n\n\t*out = name;\n\treturn 0;\n\ninvalid:\n\tgit__free(name);\n\tgiterr_set(GITERR_CONFIG, \"Invalid config item name '%s'\", in);\n\treturn GIT_EINVALIDSPEC;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__normalize_name(const char *in, char **out)\n{\n\tchar *name, *fdot, *ldot;\n\n\tassert(in && out);\n\n\tname = git__strdup(in);\n\tGITERR_CHECK_ALLOC(name);\n\n\tfdot = strchr(name, '.');\n\tldot = strrchr(name, '.');\n\n\tif (fdot == NULL || fdot == name || ldot == NULL || !ldot[1])\n\t\tgoto invalid;\n\n\t/* Validate and downcase up to first dot and after last dot */\n\tif (git_config_file_normalize_section(name, fdot) < 0 ||\n\t\tgit_config_file_normalize_section(ldot + 1, NULL) < 0)\n\t\tgoto invalid;\n\n\t/* If there is a middle range, make sure it doesn't have newlines */\n\twhile (fdot < ldot)\n\t\tif (*fdot++ == '\\n')\n\t\t\tgoto invalid;\n\n\t*out = name;\n\treturn 0;\n\ninvalid:\n\tgit__free(name);\n\tgiterr_set(GITERR_CONFIG, \"Invalid config item name '%s'\", in);\n\treturn GIT_EINVALIDSPEC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "iter"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(multivar_iter)"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_iterator_new",
          "args": [
            "&inner",
            "cfg"
          ],
          "line": 996
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_iterator_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "452-468",
          "snippet": "int git_config_iterator_new(git_config_iterator **out, const git_config *cfg)\n{\n\tall_iter *iter;\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\titer->parent.free = all_iter_free;\n\titer->parent.next = all_iter_next;\n\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_iterator_new(git_config_iterator **out, const git_config *cfg)\n{\n\tall_iter *iter;\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\titer->parent.free = all_iter_free;\n\titer->parent.next = all_iter_next;\n\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_multivar_iterator_new(git_config_iterator **out, const git_config *cfg, const char *name, const char *regexp)\n{\n\tmultivar_iter *iter = NULL;\n\tgit_config_iterator *inner = NULL;\n\tint error;\n\n\tif ((error = git_config_iterator_new(&inner, cfg)) < 0)\n\t\treturn error;\n\n\titer = git__calloc(1, sizeof(multivar_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\tif ((error = git_config__normalize_name(name, &iter->name)) < 0)\n\t\tgoto on_error;\n\n\tif (regexp != NULL) {\n\t\terror = regcomp(&iter->regex, regexp, REG_EXTENDED);\n\t\tif (error != 0) {\n\t\t\tgiterr_set_regex(&iter->regex, error);\n\t\t\terror = -1;\n\t\t\tregfree(&iter->regex);\n\t\t\tgoto on_error;\n\t\t}\n\n\t\titer->have_regex = 1;\n\t}\n\n\titer->iter = inner;\n\titer->parent.free = multivar_iter_free;\n\titer->parent.next = multivar_iter_next;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n\non_error:\n\n\tinner->free(inner);\n\tgit__free(iter);\n\treturn error;\n}"
  },
  {
    "function_name": "multivar_iter_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "978-988",
    "snippet": "void multivar_iter_free(git_config_iterator *_iter)\n{\n\tmultivar_iter *iter = (multivar_iter *) _iter;\n\n\titer->iter->free(iter->iter);\n\n\tgit__free(iter->name);\n\tif (iter->have_regex)\n\t\tregfree(&iter->regex);\n\tgit__free(iter);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "iter"
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "regfree",
          "args": [
            "&iter->regex"
          ],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->iter->free",
          "args": [
            "iter->iter"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid multivar_iter_free(git_config_iterator *_iter)\n{\n\tmultivar_iter *iter = (multivar_iter *) _iter;\n\n\titer->iter->free(iter->iter);\n\n\tgit__free(iter->name);\n\tif (iter->have_regex)\n\t\tregfree(&iter->regex);\n\tgit__free(iter);\n}"
  },
  {
    "function_name": "multivar_iter_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "959-976",
    "snippet": "static int multivar_iter_next(git_config_entry **entry, git_config_iterator *_iter)\n{\n\tmultivar_iter *iter = (multivar_iter *) _iter;\n\tint error = 0;\n\n\twhile ((error = iter->iter->next(entry, iter->iter)) == 0) {\n\t\tif (git__strcmp(iter->name, (*entry)->name))\n\t\t\tcontinue;\n\n\t\tif (!iter->have_regex)\n\t\t\treturn 0;\n\n\t\tif (regexec(&iter->regex, (*entry)->value, 0, NULL, 0) == 0)\n\t\t\treturn 0;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "regexec",
          "args": [
            "&iter->regex",
            "(*entry)->value",
            "0",
            "NULL",
            "0"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strcmp",
          "args": [
            "iter->name",
            "(*entry)->name"
          ],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->iter->next",
          "args": [
            "entry",
            "iter->iter"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int multivar_iter_next(git_config_entry **entry, git_config_iterator *_iter)\n{\n\tmultivar_iter *iter = (multivar_iter *) _iter;\n\tint error = 0;\n\n\twhile ((error = iter->iter->next(entry, iter->iter)) == 0) {\n\t\tif (git__strcmp(iter->name, (*entry)->name))\n\t\t\tcontinue;\n\n\t\tif (!iter->have_regex)\n\t\t\treturn 0;\n\n\t\tif (regexec(&iter->regex, (*entry)->value, 0, NULL, 0) == 0)\n\t\t\treturn 0;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_config_get_multivar_foreach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "920-949",
    "snippet": "int git_config_get_multivar_foreach(\n\tconst git_config *cfg, const char *name, const char *regexp,\n\tgit_config_foreach_cb cb, void *payload)\n{\n\tint err, found;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((err = git_config_multivar_iterator_new(&iter, cfg, name, regexp)) < 0)\n\t\treturn err;\n\n\tfound = 0;\n\twhile ((err = iter->next(&entry, iter)) == 0) {\n\t\tfound = 1;\n\n\t\tif ((err = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(err);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\titer->free(iter);\n\tif (err == GIT_ITEROVER)\n\t\terr = 0;\n\n\tif (found == 0 && err == 0)\n\t\terr = config_error_notfound(name);\n\n\treturn err;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_error_notfound",
          "args": [
            "name"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "config_error_notfound",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "675-679",
          "snippet": "static int config_error_notfound(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG, \"Config value '%s' was not found\", name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int config_error_notfound(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG, \"Config value '%s' was not found\", name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->free",
          "args": [
            "iter"
          ],
          "line": 941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set_after_callback",
          "args": [
            "err"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cb",
          "args": [
            "entry",
            "payload"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "rename_config_entries_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1411-1432",
          "snippet": "static int rename_config_entries_cb(\n\tconst git_config_entry *entry,\n\tvoid *payload)\n{\n\tint error = 0;\n\tstruct rename_data *data = (struct rename_data *)payload;\n\tsize_t base_len = git_buf_len(data->name);\n\n\tif (base_len > 0 &&\n\t\t!(error = git_buf_puts(data->name, entry->name + data->old_len)))\n\t{\n\t\terror = git_config_set_string(\n\t\t\tdata->config, git_buf_cstr(data->name), entry->value);\n\n\t\tgit_buf_truncate(data->name, base_len);\n\t}\n\n\tif (!error)\n\t\terror = git_config_delete_entry(data->config, entry->name);\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int rename_config_entries_cb(\n\tconst git_config_entry *entry,\n\tvoid *payload)\n{\n\tint error = 0;\n\tstruct rename_data *data = (struct rename_data *)payload;\n\tsize_t base_len = git_buf_len(data->name);\n\n\tif (base_len > 0 &&\n\t\t!(error = git_buf_puts(data->name, entry->name + data->old_len)))\n\t{\n\t\terror = git_config_set_string(\n\t\t\tdata->config, git_buf_cstr(data->name), entry->value);\n\n\t\tgit_buf_truncate(data->name, base_len);\n\t}\n\n\tif (!error)\n\t\terror = git_config_delete_entry(data->config, entry->name);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->next",
          "args": [
            "&entry",
            "iter"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_config_multivar_iterator_new",
          "args": [
            "&iter",
            "cfg",
            "name",
            "regexp"
          ],
          "line": 928
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_multivar_iterator_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "990-1030",
          "snippet": "int git_config_multivar_iterator_new(git_config_iterator **out, const git_config *cfg, const char *name, const char *regexp)\n{\n\tmultivar_iter *iter = NULL;\n\tgit_config_iterator *inner = NULL;\n\tint error;\n\n\tif ((error = git_config_iterator_new(&inner, cfg)) < 0)\n\t\treturn error;\n\n\titer = git__calloc(1, sizeof(multivar_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\tif ((error = git_config__normalize_name(name, &iter->name)) < 0)\n\t\tgoto on_error;\n\n\tif (regexp != NULL) {\n\t\terror = regcomp(&iter->regex, regexp, REG_EXTENDED);\n\t\tif (error != 0) {\n\t\t\tgiterr_set_regex(&iter->regex, error);\n\t\t\terror = -1;\n\t\t\tregfree(&iter->regex);\n\t\t\tgoto on_error;\n\t\t}\n\n\t\titer->have_regex = 1;\n\t}\n\n\titer->iter = inner;\n\titer->parent.free = multivar_iter_free;\n\titer->parent.next = multivar_iter_next;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n\non_error:\n\n\tinner->free(inner);\n\tgit__free(iter);\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_multivar_iterator_new(git_config_iterator **out, const git_config *cfg, const char *name, const char *regexp)\n{\n\tmultivar_iter *iter = NULL;\n\tgit_config_iterator *inner = NULL;\n\tint error;\n\n\tif ((error = git_config_iterator_new(&inner, cfg)) < 0)\n\t\treturn error;\n\n\titer = git__calloc(1, sizeof(multivar_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\tif ((error = git_config__normalize_name(name, &iter->name)) < 0)\n\t\tgoto on_error;\n\n\tif (regexp != NULL) {\n\t\terror = regcomp(&iter->regex, regexp, REG_EXTENDED);\n\t\tif (error != 0) {\n\t\t\tgiterr_set_regex(&iter->regex, error);\n\t\t\terror = -1;\n\t\t\tregfree(&iter->regex);\n\t\t\tgoto on_error;\n\t\t}\n\n\t\titer->have_regex = 1;\n\t}\n\n\titer->iter = inner;\n\titer->parent.free = multivar_iter_free;\n\titer->parent.next = multivar_iter_next;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n\non_error:\n\n\tinner->free(inner);\n\tgit__free(iter);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_multivar_foreach(\n\tconst git_config *cfg, const char *name, const char *regexp,\n\tgit_config_foreach_cb cb, void *payload)\n{\n\tint err, found;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((err = git_config_multivar_iterator_new(&iter, cfg, name, regexp)) < 0)\n\t\treturn err;\n\n\tfound = 0;\n\twhile ((err = iter->next(&entry, iter)) == 0) {\n\t\tfound = 1;\n\n\t\tif ((err = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(err);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\titer->free(iter);\n\tif (err == GIT_ITEROVER)\n\t\terr = 0;\n\n\tif (found == 0 && err == 0)\n\t\terr = config_error_notfound(name);\n\n\treturn err;\n}"
  },
  {
    "function_name": "git_config__get_int_force",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "905-918",
    "snippet": "int git_config__get_int_force(\n\tconst git_config *cfg, const char *key, int fallback_value)\n{\n\tint32_t val = (int32_t)fallback_value;\n\tgit_config_entry *entry;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\n\tif (entry && git_config_parse_int32(&val, entry->value) < 0)\n\t\tgiterr_clear();\n\n\tgit_config_entry_free(entry);\n\treturn (int)val;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 914
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_int32",
          "args": [
            "&val",
            "entry->value"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_int32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1320-1338",
          "snippet": "int git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "key",
            "false",
            "GET_NO_ERRORS"
          ],
          "line": 911
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__get_int_force(\n\tconst git_config *cfg, const char *key, int fallback_value)\n{\n\tint32_t val = (int32_t)fallback_value;\n\tgit_config_entry *entry;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\n\tif (entry && git_config_parse_int32(&val, entry->value) < 0)\n\t\tgiterr_clear();\n\n\tgit_config_entry_free(entry);\n\treturn (int)val;\n}"
  },
  {
    "function_name": "git_config__get_bool_force",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "890-903",
    "snippet": "int git_config__get_bool_force(\n\tconst git_config *cfg, const char *key, int fallback_value)\n{\n\tint val = fallback_value;\n\tgit_config_entry *entry;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\n\tif (entry && git_config_parse_bool(&val, entry->value) < 0)\n\t\tgiterr_clear();\n\n\tgit_config_entry_free(entry);\n\treturn val;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 899
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_bool",
          "args": [
            "&val",
            "entry->value"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1263-1275",
          "snippet": "int git_config_parse_bool(int *out, const char *value)\n{\n\tif (git__parse_bool(out, value) == 0)\n\t\treturn 0;\n\n\tif (git_config_parse_int32(out, value) == 0) {\n\t\t*out = !!(*out);\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a boolean value\", value);\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_bool(int *out, const char *value)\n{\n\tif (git__parse_bool(out, value) == 0)\n\t\treturn 0;\n\n\tif (git_config_parse_int32(out, value) == 0) {\n\t\t*out = !!(*out);\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a boolean value\", value);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "key",
            "false",
            "GET_NO_ERRORS"
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__get_bool_force(\n\tconst git_config *cfg, const char *key, int fallback_value)\n{\n\tint val = fallback_value;\n\tgit_config_entry *entry;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\n\tif (entry && git_config_parse_bool(&val, entry->value) < 0)\n\t\tgiterr_clear();\n\n\tgit_config_entry_free(entry);\n\treturn val;\n}"
  },
  {
    "function_name": "git_config__get_string_force",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "877-888",
    "snippet": "char *git_config__get_string_force(\n\tconst git_config *cfg, const char *key, const char *fallback_value)\n{\n\tgit_config_entry *entry;\n\tchar *ret;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\tret = (entry && entry->value) ? git__strdup(entry->value) : fallback_value ? git__strdup(fallback_value) : NULL;\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "fallback_value"
          ],
          "line": 884
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "key",
            "false",
            "GET_NO_ERRORS"
          ],
          "line": 883
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nchar *git_config__get_string_force(\n\tconst git_config *cfg, const char *key, const char *fallback_value)\n{\n\tgit_config_entry *entry;\n\tchar *ret;\n\n\tget_entry(&entry, cfg, key, false, GET_NO_ERRORS);\n\tret = (entry && entry->value) ? git__strdup(entry->value) : fallback_value ? git__strdup(fallback_value) : NULL;\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git_config_get_string_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "857-875",
    "snippet": "int git_config_get_string_buf(\n\tgit_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\tconst char *str;\n\n\tgit_buf_sanitize(out);\n\n\tret  = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS);\n\tstr = !ret ? (entry->value ? entry->value : \"\") : NULL;\n\n\tif (str)\n\t\tret = git_buf_puts(out, str);\n\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "out",
            "str"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "name",
            "true",
            "GET_ALL_ERRORS"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "out"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_string_buf(\n\tgit_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\tconst char *str;\n\n\tgit_buf_sanitize(out);\n\n\tret  = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS);\n\tstr = !ret ? (entry->value ? entry->value : \"\") : NULL;\n\n\tif (str)\n\t\tret = git_buf_puts(out, str);\n\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git_config_get_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "838-855",
    "snippet": "int git_config_get_string(\n\tconst char **out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif (!is_readonly(cfg)) {\n\t\tgiterr_set(GITERR_CONFIG, \"get_string called on a live config object\");\n\t\treturn -1;\n\t}\n\n\tret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS);\n\t*out = !ret ? (entry->value ? entry->value : \"\") : NULL;\n\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "name",
            "true",
            "GET_ALL_ERRORS"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"get_string called on a live config object\""
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_readonly",
          "args": [
            "cfg"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "is_readonly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "808-822",
          "snippet": "static int is_readonly(const git_config *cfg)\n{\n\tsize_t i;\n\tfile_internal *internal;\n\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tif (!internal->file->readonly)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int is_readonly(const git_config *cfg)\n{\n\tsize_t i;\n\tfile_internal *internal;\n\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tif (!internal->file->readonly)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_string(\n\tconst char **out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif (!is_readonly(cfg)) {\n\t\tgiterr_set(GITERR_CONFIG, \"get_string called on a live config object\");\n\t\treturn -1;\n\t}\n\n\tret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS);\n\t*out = !ret ? (entry->value ? entry->value : \"\") : NULL;\n\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git_config_get_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "824-836",
    "snippet": "int git_config_get_path(git_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint error;\n\n\tif ((error = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn error;\n\n\t error = git_config_parse_path(out, entry->value);\n\t git_config_entry_free(entry);\n\n\t return error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_path",
          "args": [
            "out",
            "entry->value"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1340-1368",
          "snippet": "int git_config_parse_path(git_buf *out, const char *value)\n{\n\tint error = 0;\n\tconst git_buf *home;\n\n\tassert(out && value);\n\n\tgit_buf_sanitize(out);\n\n\tif (value[0] == '~') {\n\t\tif (value[1] != '\\0' && value[1] != '/') {\n\t\t\tgiterr_set(GITERR_CONFIG, \"retrieving a homedir by name is not supported\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((error = git_sysdir_get(&home, GIT_SYSDIR_GLOBAL)) < 0)\n\t\t\treturn error;\n\n\t\tgit_buf_sets(out, home->ptr);\n\t\tgit_buf_puts(out, value + 1);\n\n\t\tif (git_buf_oom(out))\n\t\t\treturn -1;\n\n\t\treturn 0;\n\t}\n\n\treturn git_buf_sets(out, value);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_path(git_buf *out, const char *value)\n{\n\tint error = 0;\n\tconst git_buf *home;\n\n\tassert(out && value);\n\n\tgit_buf_sanitize(out);\n\n\tif (value[0] == '~') {\n\t\tif (value[1] != '\\0' && value[1] != '/') {\n\t\t\tgiterr_set(GITERR_CONFIG, \"retrieving a homedir by name is not supported\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((error = git_sysdir_get(&home, GIT_SYSDIR_GLOBAL)) < 0)\n\t\t\treturn error;\n\n\t\tgit_buf_sets(out, home->ptr);\n\t\tgit_buf_puts(out, value + 1);\n\n\t\tif (git_buf_oom(out))\n\t\t\treturn -1;\n\n\t\treturn 0;\n\t}\n\n\treturn git_buf_sets(out, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "name",
            "true",
            "GET_ALL_ERRORS"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_path(git_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint error;\n\n\tif ((error = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn error;\n\n\t error = git_config_parse_path(out, entry->value);\n\t git_config_entry_free(entry);\n\n\t return error;\n}"
  },
  {
    "function_name": "is_readonly",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "808-822",
    "snippet": "static int is_readonly(const git_config *cfg)\n{\n\tsize_t i;\n\tfile_internal *internal;\n\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tif (!internal->file->readonly)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&cfg->files",
            "i",
            "internal"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int is_readonly(const git_config *cfg)\n{\n\tsize_t i;\n\tfile_internal *internal;\n\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tif (!internal->file->readonly)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "git_config_get_bool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "794-806",
    "snippet": "int git_config_get_bool(int *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_bool(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_bool",
          "args": [
            "out",
            "entry->value"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1263-1275",
          "snippet": "int git_config_parse_bool(int *out, const char *value)\n{\n\tif (git__parse_bool(out, value) == 0)\n\t\treturn 0;\n\n\tif (git_config_parse_int32(out, value) == 0) {\n\t\t*out = !!(*out);\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a boolean value\", value);\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_bool(int *out, const char *value)\n{\n\tif (git__parse_bool(out, value) == 0)\n\t\treturn 0;\n\n\tif (git_config_parse_int32(out, value) == 0) {\n\t\t*out = !!(*out);\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a boolean value\", value);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "name",
            "true",
            "GET_ALL_ERRORS"
          ],
          "line": 799
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_bool(int *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_bool(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git_config_get_int32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "780-792",
    "snippet": "int git_config_get_int32(int32_t *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_int32(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_int32",
          "args": [
            "out",
            "entry->value"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_int32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1320-1338",
          "snippet": "int git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_int32(int32_t *out, const char *value)\n{\n\tint64_t tmp;\n\tint32_t truncate;\n\n\tif (git_config_parse_int64(&tmp, value) < 0)\n\t\tgoto fail_parse;\n\n\ttruncate = tmp & 0xFFFFFFFF;\n\tif (truncate != tmp)\n\t\tgoto fail_parse;\n\n\t*out = truncate;\n\treturn 0;\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as a 32-bit integer\", value ? value : \"(null)\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "name",
            "true",
            "GET_ALL_ERRORS"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_int32(int32_t *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_int32(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git_config_get_int64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "766-778",
    "snippet": "int git_config_get_int64(int64_t *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_int64(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_parse_int64",
          "args": [
            "out",
            "entry->value"
          ],
          "line": 774
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_parse_int64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1277-1318",
          "snippet": "int git_config_parse_int64(int64_t *out, const char *value)\n{\n\tconst char *num_end;\n\tint64_t num;\n\n\tif (!value || git__strtol64(&num, value, &num_end, 0) < 0)\n\t\tgoto fail_parse;\n\n\tswitch (*num_end) {\n\tcase 'g':\n\tcase 'G':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'm':\n\tcase 'M':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'k':\n\tcase 'K':\n\t\tnum *= 1024;\n\n\t\t/* check that that there are no more characters after the\n\t\t * given modifier suffix */\n\t\tif (num_end[1] != '\\0')\n\t\t\treturn -1;\n\n\t\t/* fallthrough */\n\n\tcase '\\0':\n\t\t*out = num;\n\t\treturn 0;\n\n\tdefault:\n\t\tgoto fail_parse;\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as an integer\", value ? value : \"(null)\");\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_parse_int64(int64_t *out, const char *value)\n{\n\tconst char *num_end;\n\tint64_t num;\n\n\tif (!value || git__strtol64(&num, value, &num_end, 0) < 0)\n\t\tgoto fail_parse;\n\n\tswitch (*num_end) {\n\tcase 'g':\n\tcase 'G':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'm':\n\tcase 'M':\n\t\tnum *= 1024;\n\t\t/* fallthrough */\n\n\tcase 'k':\n\tcase 'K':\n\t\tnum *= 1024;\n\n\t\t/* check that that there are no more characters after the\n\t\t * given modifier suffix */\n\t\tif (num_end[1] != '\\0')\n\t\t\treturn -1;\n\n\t\t/* fallthrough */\n\n\tcase '\\0':\n\t\t*out = num;\n\t\treturn 0;\n\n\tdefault:\n\t\tgoto fail_parse;\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to parse '%s' as an integer\", value ? value : \"(null)\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "name",
            "true",
            "GET_ALL_ERRORS"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_int64(int64_t *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_int64(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git_config_get_mapped",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "747-764",
    "snippet": "int git_config_get_mapped(\n\tint *out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tconst git_cvar_map *maps,\n\tsize_t map_n)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_lookup_map_value(out, maps, map_n, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_lookup_map_value",
          "args": [
            "out",
            "maps",
            "map_n",
            "entry->value"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_lookup_map_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1197-1241",
          "snippet": "int git_config_lookup_map_value(\n\tint *out,\n\tconst git_cvar_map *maps,\n\tsize_t map_n,\n\tconst char *value)\n{\n\tsize_t i;\n\n\tif (!value)\n\t\tgoto fail_parse;\n\n\tfor (i = 0; i < map_n; ++i) {\n\t\tconst git_cvar_map *m = maps + i;\n\n\t\tswitch (m->cvar_type) {\n\t\tcase GIT_CVAR_FALSE:\n\t\tcase GIT_CVAR_TRUE: {\n\t\t\tint bool_val;\n\n\t\t\tif (git__parse_bool(&bool_val, value) == 0 &&\n\t\t\t\tbool_val == (int)m->cvar_type) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tcase GIT_CVAR_INT32:\n\t\t\tif (git_config_parse_int32(out, value) == 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\n\t\tcase GIT_CVAR_STRING:\n\t\t\tif (strcasecmp(value, m->str_match) == 0) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to map '%s'\", value);\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_lookup_map_value(\n\tint *out,\n\tconst git_cvar_map *maps,\n\tsize_t map_n,\n\tconst char *value)\n{\n\tsize_t i;\n\n\tif (!value)\n\t\tgoto fail_parse;\n\n\tfor (i = 0; i < map_n; ++i) {\n\t\tconst git_cvar_map *m = maps + i;\n\n\t\tswitch (m->cvar_type) {\n\t\tcase GIT_CVAR_FALSE:\n\t\tcase GIT_CVAR_TRUE: {\n\t\t\tint bool_val;\n\n\t\t\tif (git__parse_bool(&bool_val, value) == 0 &&\n\t\t\t\tbool_val == (int)m->cvar_type) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tcase GIT_CVAR_INT32:\n\t\t\tif (git_config_parse_int32(out, value) == 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\n\t\tcase GIT_CVAR_STRING:\n\t\t\tif (strcasecmp(value, m->str_match) == 0) {\n\t\t\t\t*out = m->map_value;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\nfail_parse:\n\tgiterr_set(GITERR_CONFIG, \"Failed to map '%s'\", value);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "&entry",
            "cfg",
            "name",
            "true",
            "GET_ALL_ERRORS"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_mapped(\n\tint *out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tconst git_cvar_map *maps,\n\tsize_t map_n)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_lookup_map_value(out, maps, map_n, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git_config__lookup_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "737-745",
    "snippet": "int git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "out",
            "cfg",
            "key",
            "false",
            "no_errors ? GET_NO_ERRORS : GET_NO_MISSING"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}"
  },
  {
    "function_name": "git_config_get_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "731-735",
    "snippet": "int git_config_get_entry(\n\tgit_config_entry **out, const git_config *cfg, const char *name)\n{\n\treturn get_entry(out, cfg, name, true, GET_ALL_ERRORS);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_entry",
          "args": [
            "out",
            "cfg",
            "name",
            "true",
            "GET_ALL_ERRORS"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "687-729",
          "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_entry(\n\tgit_config_entry **out, const git_config *cfg, const char *name)\n{\n\treturn get_entry(out, cfg, name, true, GET_ALL_ERRORS);\n}"
  },
  {
    "function_name": "get_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "687-729",
    "snippet": "static int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_error_notfound",
          "args": [
            "name"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "config_error_notfound",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "675-679",
          "snippet": "static int config_error_notfound(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG, \"Config value '%s' was not found\", name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int config_error_notfound(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG, \"Config value '%s' was not found\", name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "normalized"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "internal->file->get",
          "args": [
            "internal->file",
            "key",
            "out"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&cfg->files",
            "i",
            "internal"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_config__normalize_name",
          "args": [
            "name",
            "&normalized"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__normalize_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1371-1403",
          "snippet": "int git_config__normalize_name(const char *in, char **out)\n{\n\tchar *name, *fdot, *ldot;\n\n\tassert(in && out);\n\n\tname = git__strdup(in);\n\tGITERR_CHECK_ALLOC(name);\n\n\tfdot = strchr(name, '.');\n\tldot = strrchr(name, '.');\n\n\tif (fdot == NULL || fdot == name || ldot == NULL || !ldot[1])\n\t\tgoto invalid;\n\n\t/* Validate and downcase up to first dot and after last dot */\n\tif (git_config_file_normalize_section(name, fdot) < 0 ||\n\t\tgit_config_file_normalize_section(ldot + 1, NULL) < 0)\n\t\tgoto invalid;\n\n\t/* If there is a middle range, make sure it doesn't have newlines */\n\twhile (fdot < ldot)\n\t\tif (*fdot++ == '\\n')\n\t\t\tgoto invalid;\n\n\t*out = name;\n\treturn 0;\n\ninvalid:\n\tgit__free(name);\n\tgiterr_set(GITERR_CONFIG, \"Invalid config item name '%s'\", in);\n\treturn GIT_EINVALIDSPEC;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__normalize_name(const char *in, char **out)\n{\n\tchar *name, *fdot, *ldot;\n\n\tassert(in && out);\n\n\tname = git__strdup(in);\n\tGITERR_CHECK_ALLOC(name);\n\n\tfdot = strchr(name, '.');\n\tldot = strrchr(name, '.');\n\n\tif (fdot == NULL || fdot == name || ldot == NULL || !ldot[1])\n\t\tgoto invalid;\n\n\t/* Validate and downcase up to first dot and after last dot */\n\tif (git_config_file_normalize_section(name, fdot) < 0 ||\n\t\tgit_config_file_normalize_section(ldot + 1, NULL) < 0)\n\t\tgoto invalid;\n\n\t/* If there is a middle range, make sure it doesn't have newlines */\n\twhile (fdot < ldot)\n\t\tif (*fdot++ == '\\n')\n\t\t\tgoto invalid;\n\n\t*out = name;\n\treturn 0;\n\ninvalid:\n\tgit__free(name);\n\tgiterr_set(GITERR_CONFIG, \"Invalid config item name '%s'\", in);\n\treturn GIT_EINVALIDSPEC;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int get_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *name,\n\tbool normalize_name,\n\tint want_errors)\n{\n\tint res = GIT_ENOTFOUND;\n\tconst char *key = name;\n\tchar *normalized = NULL;\n\tsize_t i;\n\tfile_internal *internal;\n\n\t*out = NULL;\n\n\tif (normalize_name) {\n\t\tif ((res = git_config__normalize_name(name, &normalized)) < 0)\n\t\t\tgoto cleanup;\n\t\tkey = normalized;\n\t}\n\n\tres = GIT_ENOTFOUND;\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\tres = internal->file->get(internal->file, key, out);\n\t\tif (res != GIT_ENOTFOUND)\n\t\t\tbreak;\n\t}\n\n\tgit__free(normalized);\n\ncleanup:\n\tif (res == GIT_ENOTFOUND)\n\t\tres = (want_errors > GET_ALL_ERRORS) ? 0 : config_error_notfound(name);\n\telse if (res && (want_errors == GET_NO_ERRORS)) {\n\t\tgiterr_clear();\n\t\tres = 0;\n\t}\n\n\treturn res;\n}"
  },
  {
    "function_name": "config_error_notfound",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "675-679",
    "snippet": "static int config_error_notfound(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG, \"Config value '%s' was not found\", name);\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"Config value '%s' was not found\"",
            "name"
          ],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int config_error_notfound(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG, \"Config value '%s' was not found\", name);\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git_config__update_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "640-669",
    "snippet": "int git_config__update_entry(\n\tgit_config *config,\n\tconst char *key,\n\tconst char *value,\n\tbool overwrite_existing,\n\tbool only_if_existing)\n{\n\tint error = 0;\n\tgit_config_entry *ce = NULL;\n\n\tif ((error = git_config__lookup_entry(&ce, config, key, false)) < 0)\n\t\treturn error;\n\n\tif (!ce && only_if_existing) /* entry doesn't exist */\n\t\treturn 0;\n\tif (ce && !overwrite_existing) /* entry would be overwritten */\n\t\treturn 0;\n\tif (value && ce && ce->value && !strcmp(ce->value, value)) /* no change */\n\t\treturn 0;\n\tif (!value && (!ce || !ce->value)) /* asked to delete absent entry */\n\t\treturn 0;\n\n\tif (!value)\n\t\terror = git_config_delete_entry(config, key);\n\telse\n\t\terror = git_config_set_string(config, key, value);\n\n\tgit_config_entry_free(ce);\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "ce"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_set_string",
          "args": [
            "config",
            "key",
            "value"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_set_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "616-638",
          "snippet": "int git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_delete_entry",
          "args": [
            "config",
            "key"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_delete_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "586-597",
          "snippet": "int git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "ce->value",
            "value"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config__lookup_entry",
          "args": [
            "&ce",
            "config",
            "key",
            "false"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__lookup_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "737-745",
          "snippet": "int git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__update_entry(\n\tgit_config *config,\n\tconst char *key,\n\tconst char *value,\n\tbool overwrite_existing,\n\tbool only_if_existing)\n{\n\tint error = 0;\n\tgit_config_entry *ce = NULL;\n\n\tif ((error = git_config__lookup_entry(&ce, config, key, false)) < 0)\n\t\treturn error;\n\n\tif (!ce && only_if_existing) /* entry doesn't exist */\n\t\treturn 0;\n\tif (ce && !overwrite_existing) /* entry would be overwritten */\n\t\treturn 0;\n\tif (value && ce && ce->value && !strcmp(ce->value, value)) /* no change */\n\t\treturn 0;\n\tif (!value && (!ce || !ce->value)) /* asked to delete absent entry */\n\t\treturn 0;\n\n\tif (!value)\n\t\terror = git_config_delete_entry(config, key);\n\telse\n\t\terror = git_config_set_string(config, key, value);\n\n\tgit_config_entry_free(ce);\n\treturn error;\n}"
  },
  {
    "function_name": "git_config_set_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "616-638",
    "snippet": "int git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_repository__cvar_cache_clear",
          "args": [
            "GIT_REFCOUNT_OWNER(cfg)"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__cvar_cache_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
          "lines": "122-128",
          "snippet": "void git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"vector.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"repository.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWNER",
          "args": [
            "cfg"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWNER",
          "args": [
            "cfg"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->set",
          "args": [
            "file",
            "name",
            "value"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_error_nofiles",
          "args": [
            "name"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "config_error_nofiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "579-584",
          "snippet": "static int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "0"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"The value to set cannot be NULL\""
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_config_set_bool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "611-614",
    "snippet": "int git_config_set_bool(git_config *cfg, const char *name, int value)\n{\n\treturn git_config_set_string(cfg, name, value ? \"true\" : \"false\");\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_set_string",
          "args": [
            "cfg",
            "name",
            "value ? \"true\" : \"false\""
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_set_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "616-638",
          "snippet": "int git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_bool(git_config *cfg, const char *name, int value)\n{\n\treturn git_config_set_string(cfg, name, value ? \"true\" : \"false\");\n}"
  },
  {
    "function_name": "git_config_set_int32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "606-609",
    "snippet": "int git_config_set_int32(git_config *cfg, const char *name, int32_t value)\n{\n\treturn git_config_set_int64(cfg, name, (int64_t)value);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_set_int64",
          "args": [
            "cfg",
            "name",
            "(int64_t)value"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_set_int64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "599-604",
          "snippet": "int git_config_set_int64(git_config *cfg, const char *name, int64_t value)\n{\n\tchar str_value[32]; /* All numbers should fit in here */\n\tp_snprintf(str_value, sizeof(str_value), \"%\" PRId64, value);\n\treturn git_config_set_string(cfg, name, str_value);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_int64(git_config *cfg, const char *name, int64_t value)\n{\n\tchar str_value[32]; /* All numbers should fit in here */\n\tp_snprintf(str_value, sizeof(str_value), \"%\" PRId64, value);\n\treturn git_config_set_string(cfg, name, str_value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_int32(git_config *cfg, const char *name, int32_t value)\n{\n\treturn git_config_set_int64(cfg, name, (int64_t)value);\n}"
  },
  {
    "function_name": "git_config_set_int64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "599-604",
    "snippet": "int git_config_set_int64(git_config *cfg, const char *name, int64_t value)\n{\n\tchar str_value[32]; /* All numbers should fit in here */\n\tp_snprintf(str_value, sizeof(str_value), \"%\" PRId64, value);\n\treturn git_config_set_string(cfg, name, str_value);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_set_string",
          "args": [
            "cfg",
            "name",
            "str_value"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_set_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "616-638",
          "snippet": "int git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_snprintf",
          "args": [
            "str_value",
            "sizeof(str_value)",
            "\"%\" PRId64",
            "value"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "p_snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "548-558",
          "snippet": "int p_snprintf(char *buffer, size_t count, const char *format, ...)\n{\n\tva_list va;\n\tint r;\n\n\tva_start(va, format);\n\tr = p_vsnprintf(buffer, count, format, va);\n\tva_end(va);\n\n\treturn r;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_snprintf(char *buffer, size_t count, const char *format, ...)\n{\n\tva_list va;\n\tint r;\n\n\tva_start(va, format);\n\tr = p_vsnprintf(buffer, count, format, va);\n\tva_end(va);\n\n\treturn r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_int64(git_config *cfg, const char *name, int64_t value)\n{\n\tchar str_value[32]; /* All numbers should fit in here */\n\tp_snprintf(str_value, sizeof(str_value), \"%\" PRId64, value);\n\treturn git_config_set_string(cfg, name, str_value);\n}"
  },
  {
    "function_name": "git_config_delete_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "586-597",
    "snippet": "int git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->del",
          "args": [
            "file",
            "name"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_error_nofiles",
          "args": [
            "name"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "config_error_nofiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "579-584",
          "snippet": "static int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "0"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}"
  },
  {
    "function_name": "config_error_nofiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "579-584",
    "snippet": "static int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"Cannot set value for '%s' when no config files exist\"",
            "name"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int config_error_nofiles(const char *name)\n{\n\tgiterr_set(GITERR_CONFIG,\n\t\t\"Cannot set value for '%s' when no config files exist\", name);\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git_config_foreach_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "547-573",
    "snippet": "int git_config_foreach_match(\n\tconst git_config *cfg,\n\tconst char *regexp,\n\tgit_config_foreach_cb cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((error = git_config_iterator_glob_new(&iter, cfg, regexp)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_config_next(&entry, iter))) {\n\t\tif ((error = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tgit_config_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_iterator_free",
          "args": [
            "iter"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_iterator_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1063-1069",
          "snippet": "void git_config_iterator_free(git_config_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->free(iter);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_iterator_free(git_config_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\titer->free(iter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set_after_callback",
          "args": [
            "error"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cb",
          "args": [
            "entry",
            "payload"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "rename_config_entries_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1411-1432",
          "snippet": "static int rename_config_entries_cb(\n\tconst git_config_entry *entry,\n\tvoid *payload)\n{\n\tint error = 0;\n\tstruct rename_data *data = (struct rename_data *)payload;\n\tsize_t base_len = git_buf_len(data->name);\n\n\tif (base_len > 0 &&\n\t\t!(error = git_buf_puts(data->name, entry->name + data->old_len)))\n\t{\n\t\terror = git_config_set_string(\n\t\t\tdata->config, git_buf_cstr(data->name), entry->value);\n\n\t\tgit_buf_truncate(data->name, base_len);\n\t}\n\n\tif (!error)\n\t\terror = git_config_delete_entry(data->config, entry->name);\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int rename_config_entries_cb(\n\tconst git_config_entry *entry,\n\tvoid *payload)\n{\n\tint error = 0;\n\tstruct rename_data *data = (struct rename_data *)payload;\n\tsize_t base_len = git_buf_len(data->name);\n\n\tif (base_len > 0 &&\n\t\t!(error = git_buf_puts(data->name, entry->name + data->old_len)))\n\t{\n\t\terror = git_config_set_string(\n\t\t\tdata->config, git_buf_cstr(data->name), entry->value);\n\n\t\tgit_buf_truncate(data->name, base_len);\n\t}\n\n\tif (!error)\n\t\terror = git_config_delete_entry(data->config, entry->name);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_next",
          "args": [
            "&entry",
            "iter"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1058-1061",
          "snippet": "int git_config_next(git_config_entry **entry, git_config_iterator *iter)\n{\n\treturn iter->next(entry, iter);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_next(git_config_entry **entry, git_config_iterator *iter)\n{\n\treturn iter->next(entry, iter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_iterator_glob_new",
          "args": [
            "&iter",
            "cfg",
            "regexp"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_iterator_glob_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "470-495",
          "snippet": "int git_config_iterator_glob_new(git_config_iterator **out, const git_config *cfg, const char *regexp)\n{\n\tall_iter *iter;\n\tint result;\n\n\tif (regexp == NULL)\n\t\treturn git_config_iterator_new(out, cfg);\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\tif ((result = regcomp(&iter->regex, regexp, REG_EXTENDED)) != 0) {\n\t\tgiterr_set_regex(&iter->regex, result);\n\t\tgit__free(iter);\n\t\treturn -1;\n\t}\n\n\titer->parent.next = all_iter_glob_next;\n\titer->parent.free = all_iter_glob_free;\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_iterator_glob_new(git_config_iterator **out, const git_config *cfg, const char *regexp)\n{\n\tall_iter *iter;\n\tint result;\n\n\tif (regexp == NULL)\n\t\treturn git_config_iterator_new(out, cfg);\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\tif ((result = regcomp(&iter->regex, regexp, REG_EXTENDED)) != 0) {\n\t\tgiterr_set_regex(&iter->regex, result);\n\t\tgit__free(iter);\n\t\treturn -1;\n\t}\n\n\titer->parent.next = all_iter_glob_next;\n\titer->parent.free = all_iter_glob_free;\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_foreach_match(\n\tconst git_config *cfg,\n\tconst char *regexp,\n\tgit_config_foreach_cb cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((error = git_config_iterator_glob_new(&iter, cfg, regexp)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_config_next(&entry, iter))) {\n\t\tif ((error = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tgit_config_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_config_backend_foreach_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "503-545",
    "snippet": "int git_config_backend_foreach_match(\n\tgit_config_backend *backend,\n\tconst char *regexp,\n\tgit_config_foreach_cb cb,\n\tvoid *payload)\n{\n\tgit_config_entry *entry;\n\tgit_config_iterator* iter;\n\tregex_t regex;\n\tint error = 0;\n\n\tif (regexp != NULL) {\n\t\tif ((error = regcomp(&regex, regexp, REG_EXTENDED)) != 0) {\n\t\t\tgiterr_set_regex(&regex, error);\n\t\t\tregfree(&regex);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif ((error = backend->iterator(&iter, backend)) < 0) {\n\t\titer = NULL;\n\t\treturn -1;\n\t}\n\n\twhile (!(iter->next(&entry, iter) < 0)) {\n\t\t/* skip non-matching keys if regexp was provided */\n\t\tif (regexp && regexec(&regex, entry->name, 0, NULL, 0) != 0)\n\t\t\tcontinue;\n\n\t\t/* abort iterator on non-zero return value */\n\t\tif ((error = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (regexp != NULL)\n\t\tregfree(&regex);\n\n\titer->free(iter);\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->free",
          "args": [
            "iter"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "regfree",
          "args": [
            "&regex"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set_after_callback",
          "args": [
            "error"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cb",
          "args": [
            "entry",
            "payload"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "rename_config_entries_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1411-1432",
          "snippet": "static int rename_config_entries_cb(\n\tconst git_config_entry *entry,\n\tvoid *payload)\n{\n\tint error = 0;\n\tstruct rename_data *data = (struct rename_data *)payload;\n\tsize_t base_len = git_buf_len(data->name);\n\n\tif (base_len > 0 &&\n\t\t!(error = git_buf_puts(data->name, entry->name + data->old_len)))\n\t{\n\t\terror = git_config_set_string(\n\t\t\tdata->config, git_buf_cstr(data->name), entry->value);\n\n\t\tgit_buf_truncate(data->name, base_len);\n\t}\n\n\tif (!error)\n\t\terror = git_config_delete_entry(data->config, entry->name);\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int rename_config_entries_cb(\n\tconst git_config_entry *entry,\n\tvoid *payload)\n{\n\tint error = 0;\n\tstruct rename_data *data = (struct rename_data *)payload;\n\tsize_t base_len = git_buf_len(data->name);\n\n\tif (base_len > 0 &&\n\t\t!(error = git_buf_puts(data->name, entry->name + data->old_len)))\n\t{\n\t\terror = git_config_set_string(\n\t\t\tdata->config, git_buf_cstr(data->name), entry->value);\n\n\t\tgit_buf_truncate(data->name, base_len);\n\t}\n\n\tif (!error)\n\t\terror = git_config_delete_entry(data->config, entry->name);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "regexec",
          "args": [
            "&regex",
            "entry->name",
            "0",
            "NULL",
            "0"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->next",
          "args": [
            "&entry",
            "iter"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->iterator",
          "args": [
            "&iter",
            "backend"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "regfree",
          "args": [
            "&regex"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set_regex",
          "args": [
            "&regex",
            "error"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_regex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "106-119",
          "snippet": "int giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "regcomp",
          "args": [
            "&regex",
            "regexp",
            "REG_EXTENDED"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_backend_foreach_match(\n\tgit_config_backend *backend,\n\tconst char *regexp,\n\tgit_config_foreach_cb cb,\n\tvoid *payload)\n{\n\tgit_config_entry *entry;\n\tgit_config_iterator* iter;\n\tregex_t regex;\n\tint error = 0;\n\n\tif (regexp != NULL) {\n\t\tif ((error = regcomp(&regex, regexp, REG_EXTENDED)) != 0) {\n\t\t\tgiterr_set_regex(&regex, error);\n\t\t\tregfree(&regex);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif ((error = backend->iterator(&iter, backend)) < 0) {\n\t\titer = NULL;\n\t\treturn -1;\n\t}\n\n\twhile (!(iter->next(&entry, iter) < 0)) {\n\t\t/* skip non-matching keys if regexp was provided */\n\t\tif (regexp && regexec(&regex, entry->name, 0, NULL, 0) != 0)\n\t\t\tcontinue;\n\n\t\t/* abort iterator on non-zero return value */\n\t\tif ((error = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (regexp != NULL)\n\t\tregfree(&regex);\n\n\titer->free(iter);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_config_foreach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "497-501",
    "snippet": "int git_config_foreach(\n\tconst git_config *cfg, git_config_foreach_cb cb, void *payload)\n{\n\treturn git_config_foreach_match(cfg, NULL, cb, payload);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_foreach_match",
          "args": [
            "cfg",
            "NULL",
            "cb",
            "payload"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_foreach_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "547-573",
          "snippet": "int git_config_foreach_match(\n\tconst git_config *cfg,\n\tconst char *regexp,\n\tgit_config_foreach_cb cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((error = git_config_iterator_glob_new(&iter, cfg, regexp)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_config_next(&entry, iter))) {\n\t\tif ((error = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tgit_config_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_foreach_match(\n\tconst git_config *cfg,\n\tconst char *regexp,\n\tgit_config_foreach_cb cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_config_iterator *iter;\n\tgit_config_entry *entry;\n\n\tif ((error = git_config_iterator_glob_new(&iter, cfg, regexp)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_config_next(&entry, iter))) {\n\t\tif ((error = cb(entry, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tgit_config_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_foreach(\n\tconst git_config *cfg, git_config_foreach_cb cb, void *payload)\n{\n\treturn git_config_foreach_match(cfg, NULL, cb, payload);\n}"
  },
  {
    "function_name": "git_config_iterator_glob_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "470-495",
    "snippet": "int git_config_iterator_glob_new(git_config_iterator **out, const git_config *cfg, const char *regexp)\n{\n\tall_iter *iter;\n\tint result;\n\n\tif (regexp == NULL)\n\t\treturn git_config_iterator_new(out, cfg);\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\tif ((result = regcomp(&iter->regex, regexp, REG_EXTENDED)) != 0) {\n\t\tgiterr_set_regex(&iter->regex, result);\n\t\tgit__free(iter);\n\t\treturn -1;\n\t}\n\n\titer->parent.next = all_iter_glob_next;\n\titer->parent.free = all_iter_glob_free;\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "iter"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set_regex",
          "args": [
            "&iter->regex",
            "result"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_regex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "106-119",
          "snippet": "int giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "regcomp",
          "args": [
            "&iter->regex",
            "regexp",
            "REG_EXTENDED"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "iter"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(all_iter)"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_iterator_new",
          "args": [
            "out",
            "cfg"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_iterator_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "452-468",
          "snippet": "int git_config_iterator_new(git_config_iterator **out, const git_config *cfg)\n{\n\tall_iter *iter;\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\titer->parent.free = all_iter_free;\n\titer->parent.next = all_iter_next;\n\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_iterator_new(git_config_iterator **out, const git_config *cfg)\n{\n\tall_iter *iter;\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\titer->parent.free = all_iter_free;\n\titer->parent.next = all_iter_next;\n\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_iterator_glob_new(git_config_iterator **out, const git_config *cfg, const char *regexp)\n{\n\tall_iter *iter;\n\tint result;\n\n\tif (regexp == NULL)\n\t\treturn git_config_iterator_new(out, cfg);\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\tif ((result = regcomp(&iter->regex, regexp, REG_EXTENDED)) != 0) {\n\t\tgiterr_set_regex(&iter->regex, result);\n\t\tgit__free(iter);\n\t\treturn -1;\n\t}\n\n\titer->parent.next = all_iter_glob_next;\n\titer->parent.free = all_iter_glob_free;\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_config_iterator_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "452-468",
    "snippet": "int git_config_iterator_new(git_config_iterator **out, const git_config *cfg)\n{\n\tall_iter *iter;\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\titer->parent.free = all_iter_free;\n\titer->parent.next = all_iter_next;\n\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "iter"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(all_iter)"
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_iterator_new(git_config_iterator **out, const git_config *cfg)\n{\n\tall_iter *iter;\n\n\titer = git__calloc(1, sizeof(all_iter));\n\tGITERR_CHECK_ALLOC(iter);\n\n\titer->parent.free = all_iter_free;\n\titer->parent.next = all_iter_next;\n\n\titer->i = cfg->files.length;\n\titer->cfg = cfg;\n\n\t*out = (git_config_iterator *) iter;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "all_iter_glob_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "444-450",
    "snippet": "static void all_iter_glob_free(git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\n\tregfree(&iter->regex);\n\tall_iter_free(_iter);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "all_iter_free",
          "args": [
            "_iter"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "all_iter_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "434-442",
          "snippet": "static void all_iter_free(git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\n\tif (iter->current)\n\t\titer->current->free(iter->current);\n\n\tgit__free(iter);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic void all_iter_free(git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\n\tif (iter->current)\n\t\titer->current->free(iter->current);\n\n\tgit__free(iter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "regfree",
          "args": [
            "&iter->regex"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic void all_iter_glob_free(git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\n\tregfree(&iter->regex);\n\tall_iter_free(_iter);\n}"
  },
  {
    "function_name": "all_iter_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "434-442",
    "snippet": "static void all_iter_free(git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\n\tif (iter->current)\n\t\titer->current->free(iter->current);\n\n\tgit__free(iter);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "iter"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->current->free",
          "args": [
            "iter->current"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic void all_iter_free(git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\n\tif (iter->current)\n\t\titer->current->free(iter->current);\n\n\tgit__free(iter);\n}"
  },
  {
    "function_name": "all_iter_glob_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "413-432",
    "snippet": "static int all_iter_glob_next(git_config_entry **entry, git_config_iterator *_iter)\n{\n\tint error;\n\tall_iter *iter = (all_iter *) _iter;\n\n\t/*\n\t * We use the \"normal\" function to grab the next one across\n\t * backends and then apply the regex\n\t */\n\twhile ((error = all_iter_next(entry, _iter)) == 0) {\n\t\t/* skip non-matching keys if regexp was provided */\n\t\tif (regexec(&iter->regex, (*entry)->name, 0, NULL, 0) != 0)\n\t\t\tcontinue;\n\n\t\t/* and simply return if we like the entry's name */\n\t\treturn 0;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "regexec",
          "args": [
            "&iter->regex",
            "(*entry)->name",
            "0",
            "NULL",
            "0"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "all_iter_next",
          "args": [
            "entry",
            "_iter"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "all_iter_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "366-411",
          "snippet": "static int all_iter_next(git_config_entry **entry, git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\tfile_internal *internal;\n\tgit_config_backend *backend;\n\tsize_t i;\n\tint error = 0;\n\n\tif (iter->current != NULL &&\n\t    (error = iter->current->next(entry, iter->current)) == 0) {\n\t\treturn 0;\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\treturn error;\n\n\tdo {\n\t\tif (find_next_backend(&i, iter->cfg, iter->i) < 0)\n\t\t\treturn GIT_ITEROVER;\n\n\t\tinternal = git_vector_get(&iter->cfg->files, i - 1);\n\t\tbackend = internal->file;\n\t\titer->i = i - 1;\n\n\t\tif (iter->current)\n\t\t\titer->current->free(iter->current);\n\n\t\titer->current = NULL;\n\t\terror = backend->iterator(&iter->current, backend);\n\t\tif (error == GIT_ENOTFOUND)\n\t\t\tcontinue;\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\terror = iter->current->next(entry, iter->current);\n\t\t/* If this backend is empty, then keep going */\n\t\tif (error == GIT_ITEROVER)\n\t\t\tcontinue;\n\n\t\treturn error;\n\n\t} while(1);\n\n\treturn GIT_ITEROVER;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int all_iter_next(git_config_entry **entry, git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\tfile_internal *internal;\n\tgit_config_backend *backend;\n\tsize_t i;\n\tint error = 0;\n\n\tif (iter->current != NULL &&\n\t    (error = iter->current->next(entry, iter->current)) == 0) {\n\t\treturn 0;\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\treturn error;\n\n\tdo {\n\t\tif (find_next_backend(&i, iter->cfg, iter->i) < 0)\n\t\t\treturn GIT_ITEROVER;\n\n\t\tinternal = git_vector_get(&iter->cfg->files, i - 1);\n\t\tbackend = internal->file;\n\t\titer->i = i - 1;\n\n\t\tif (iter->current)\n\t\t\titer->current->free(iter->current);\n\n\t\titer->current = NULL;\n\t\terror = backend->iterator(&iter->current, backend);\n\t\tif (error == GIT_ENOTFOUND)\n\t\t\tcontinue;\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\terror = iter->current->next(entry, iter->current);\n\t\t/* If this backend is empty, then keep going */\n\t\tif (error == GIT_ITEROVER)\n\t\t\tcontinue;\n\n\t\treturn error;\n\n\t} while(1);\n\n\treturn GIT_ITEROVER;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int all_iter_glob_next(git_config_entry **entry, git_config_iterator *_iter)\n{\n\tint error;\n\tall_iter *iter = (all_iter *) _iter;\n\n\t/*\n\t * We use the \"normal\" function to grab the next one across\n\t * backends and then apply the regex\n\t */\n\twhile ((error = all_iter_next(entry, _iter)) == 0) {\n\t\t/* skip non-matching keys if regexp was provided */\n\t\tif (regexec(&iter->regex, (*entry)->name, 0, NULL, 0) != 0)\n\t\t\tcontinue;\n\n\t\t/* and simply return if we like the entry's name */\n\t\treturn 0;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "all_iter_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "366-411",
    "snippet": "static int all_iter_next(git_config_entry **entry, git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\tfile_internal *internal;\n\tgit_config_backend *backend;\n\tsize_t i;\n\tint error = 0;\n\n\tif (iter->current != NULL &&\n\t    (error = iter->current->next(entry, iter->current)) == 0) {\n\t\treturn 0;\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\treturn error;\n\n\tdo {\n\t\tif (find_next_backend(&i, iter->cfg, iter->i) < 0)\n\t\t\treturn GIT_ITEROVER;\n\n\t\tinternal = git_vector_get(&iter->cfg->files, i - 1);\n\t\tbackend = internal->file;\n\t\titer->i = i - 1;\n\n\t\tif (iter->current)\n\t\t\titer->current->free(iter->current);\n\n\t\titer->current = NULL;\n\t\terror = backend->iterator(&iter->current, backend);\n\t\tif (error == GIT_ENOTFOUND)\n\t\t\tcontinue;\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\terror = iter->current->next(entry, iter->current);\n\t\t/* If this backend is empty, then keep going */\n\t\tif (error == GIT_ITEROVER)\n\t\t\tcontinue;\n\n\t\treturn error;\n\n\t} while(1);\n\n\treturn GIT_ITEROVER;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->current->next",
          "args": [
            "entry",
            "iter->current"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->iterator",
          "args": [
            "&iter->current",
            "backend"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->current->free",
          "args": [
            "iter->current"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&iter->cfg->files",
            "i - 1"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_next_backend",
          "args": [
            "&i",
            "iter->cfg",
            "iter->i"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "find_next_backend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "350-364",
          "snippet": "static int find_next_backend(size_t *out, const git_config *cfg, size_t i)\n{\n\tfile_internal *internal;\n\n\tfor (; i > 0; --i) {\n\t\tinternal = git_vector_get(&cfg->files, i - 1);\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\t*out = i;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int find_next_backend(size_t *out, const git_config *cfg, size_t i)\n{\n\tfile_internal *internal;\n\n\tfor (; i > 0; --i) {\n\t\tinternal = git_vector_get(&cfg->files, i - 1);\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\t*out = i;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->current->next",
          "args": [
            "entry",
            "iter->current"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int all_iter_next(git_config_entry **entry, git_config_iterator *_iter)\n{\n\tall_iter *iter = (all_iter *) _iter;\n\tfile_internal *internal;\n\tgit_config_backend *backend;\n\tsize_t i;\n\tint error = 0;\n\n\tif (iter->current != NULL &&\n\t    (error = iter->current->next(entry, iter->current)) == 0) {\n\t\treturn 0;\n\t}\n\n\tif (error < 0 && error != GIT_ITEROVER)\n\t\treturn error;\n\n\tdo {\n\t\tif (find_next_backend(&i, iter->cfg, iter->i) < 0)\n\t\t\treturn GIT_ITEROVER;\n\n\t\tinternal = git_vector_get(&iter->cfg->files, i - 1);\n\t\tbackend = internal->file;\n\t\titer->i = i - 1;\n\n\t\tif (iter->current)\n\t\t\titer->current->free(iter->current);\n\n\t\titer->current = NULL;\n\t\terror = backend->iterator(&iter->current, backend);\n\t\tif (error == GIT_ENOTFOUND)\n\t\t\tcontinue;\n\n\t\tif (error < 0)\n\t\t\treturn error;\n\n\t\terror = iter->current->next(entry, iter->current);\n\t\t/* If this backend is empty, then keep going */\n\t\tif (error == GIT_ITEROVER)\n\t\t\tcontinue;\n\n\t\treturn error;\n\n\t} while(1);\n\n\treturn GIT_ITEROVER;\n}"
  },
  {
    "function_name": "find_next_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "350-364",
    "snippet": "static int find_next_backend(size_t *out, const git_config *cfg, size_t i)\n{\n\tfile_internal *internal;\n\n\tfor (; i > 0; --i) {\n\t\tinternal = git_vector_get(&cfg->files, i - 1);\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\t*out = i;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "i - 1"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int find_next_backend(size_t *out, const git_config *cfg, size_t i)\n{\n\tfile_internal *internal;\n\n\tfor (; i > 0; --i) {\n\t\tinternal = git_vector_get(&cfg->files, i - 1);\n\t\tif (!internal || !internal->file)\n\t\t\tcontinue;\n\n\t\t*out = i;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}"
  },
  {
    "function_name": "git_config_add_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "306-336",
    "snippet": "int git_config_add_backend(\n\tgit_config *cfg,\n\tgit_config_backend *file,\n\tgit_config_level_t level,\n\tint force)\n{\n\tfile_internal *internal;\n\tint result;\n\n\tassert(cfg && file);\n\n\tGITERR_CHECK_VERSION(file, GIT_CONFIG_BACKEND_VERSION, \"git_config_backend\");\n\n\tif ((result = file->open(file, level)) < 0)\n\t\treturn result;\n\n\tinternal = git__malloc(sizeof(file_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tmemset(internal, 0x0, sizeof(file_internal));\n\n\tinternal->file = file;\n\tinternal->level = level;\n\n\tif ((result = git_config__add_internal(cfg, internal, level, force)) < 0) {\n\t\tgit__free(internal);\n\t\treturn result;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "internal"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config__add_internal",
          "args": [
            "cfg",
            "internal",
            "level",
            "force"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__add_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "249-271",
          "snippet": "static int git_config__add_internal(\n\tgit_config *cfg,\n\tfile_internal *internal,\n\tgit_config_level_t level,\n\tint force)\n{\n\tint result;\n\n\t/* delete existing config file for level if it exists */\n\tif (force)\n\t\ttry_remove_existing_file_internal(cfg, level);\n\n\tif ((result = git_vector_insert_sorted(&cfg->files,\n\t\t\tinternal, &duplicate_level)) < 0)\n\t\treturn result;\n\n\tgit_vector_sort(&cfg->files);\n\tinternal->file->cfg = cfg;\n\n\tGIT_REFCOUNT_INC(internal);\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_config__add_internal(\n\tgit_config *cfg,\n\tfile_internal *internal,\n\tgit_config_level_t level,\n\tint force)\n{\n\tint result;\n\n\t/* delete existing config file for level if it exists */\n\tif (force)\n\t\ttry_remove_existing_file_internal(cfg, level);\n\n\tif ((result = git_vector_insert_sorted(&cfg->files,\n\t\t\tinternal, &duplicate_level)) < 0)\n\t\treturn result;\n\n\tgit_vector_sort(&cfg->files);\n\tinternal->file->cfg = cfg;\n\n\tGIT_REFCOUNT_INC(internal);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "internal",
            "0x0",
            "sizeof(file_internal)"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "internal"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(file_internal)"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->open",
          "args": [
            "file",
            "level"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_VERSION",
          "args": [
            "file",
            "GIT_CONFIG_BACKEND_VERSION",
            "\"git_config_backend\""
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cfg && file"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_add_backend(\n\tgit_config *cfg,\n\tgit_config_backend *file,\n\tgit_config_level_t level,\n\tint force)\n{\n\tfile_internal *internal;\n\tint result;\n\n\tassert(cfg && file);\n\n\tGITERR_CHECK_VERSION(file, GIT_CONFIG_BACKEND_VERSION, \"git_config_backend\");\n\n\tif ((result = file->open(file, level)) < 0)\n\t\treturn result;\n\n\tinternal = git__malloc(sizeof(file_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tmemset(internal, 0x0, sizeof(file_internal));\n\n\tinternal->file = file;\n\tinternal->level = level;\n\n\tif ((result = git_config__add_internal(cfg, internal, level, force)) < 0) {\n\t\tgit__free(internal);\n\t\treturn result;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_config_open_level",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "281-304",
    "snippet": "int git_config_open_level(\n\tgit_config **cfg_out,\n\tconst git_config *cfg_parent,\n\tgit_config_level_t level)\n{\n\tgit_config *cfg;\n\tfile_internal *internal;\n\tint res;\n\n\tif ((res = find_internal_file_by_level(&internal, cfg_parent, level)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config_new(&cfg)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config__add_internal(cfg, internal, level, true)) < 0) {\n\t\tgit_config_free(cfg);\n\t\treturn res;\n\t}\n\n\t*cfg_out = cfg;\n\n\treturn 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "cfg"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config__add_internal",
          "args": [
            "cfg",
            "internal",
            "level",
            "true"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__add_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "249-271",
          "snippet": "static int git_config__add_internal(\n\tgit_config *cfg,\n\tfile_internal *internal,\n\tgit_config_level_t level,\n\tint force)\n{\n\tint result;\n\n\t/* delete existing config file for level if it exists */\n\tif (force)\n\t\ttry_remove_existing_file_internal(cfg, level);\n\n\tif ((result = git_vector_insert_sorted(&cfg->files,\n\t\t\tinternal, &duplicate_level)) < 0)\n\t\treturn result;\n\n\tgit_vector_sort(&cfg->files);\n\tinternal->file->cfg = cfg;\n\n\tGIT_REFCOUNT_INC(internal);\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_config__add_internal(\n\tgit_config *cfg,\n\tfile_internal *internal,\n\tgit_config_level_t level,\n\tint force)\n{\n\tint result;\n\n\t/* delete existing config file for level if it exists */\n\tif (force)\n\t\ttry_remove_existing_file_internal(cfg, level);\n\n\tif ((result = git_vector_insert_sorted(&cfg->files,\n\t\t\tinternal, &duplicate_level)) < 0)\n\t\treturn result;\n\n\tgit_vector_sort(&cfg->files);\n\tinternal->file->cfg = cfg;\n\n\tGIT_REFCOUNT_INC(internal);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_new",
          "args": [
            "&cfg"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "79-96",
          "snippet": "int git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_internal_file_by_level",
          "args": [
            "&internal",
            "cfg_parent",
            "level"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "find_internal_file_by_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "181-213",
          "snippet": "static int find_internal_file_by_level(\n\tfile_internal **internal_out,\n\tconst git_config *cfg,\n\tgit_config_level_t level)\n{\n\tint pos = -1;\n\tfile_internal *internal;\n\tsize_t i;\n\n\t/* when passing GIT_CONFIG_HIGHEST_LEVEL, the idea is to get the config file\n\t * which has the highest level. As config files are stored in a vector\n\t * sorted by decreasing order of level, getting the file at position 0\n\t * will do the job.\n\t */\n\tif (level == GIT_CONFIG_HIGHEST_LEVEL) {\n\t\tpos = 0;\n\t} else {\n\t\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\t\tif (internal->level == level)\n\t\t\t\tpos = (int)i;\n\t\t}\n\t}\n\n\tif (pos == -1) {\n\t\tgiterr_set(GITERR_CONFIG,\n\t\t\t\"No config file exists for the given level '%i'\", (int)level);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\t*internal_out = git_vector_get(&cfg->files, pos);\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int find_internal_file_by_level(\n\tfile_internal **internal_out,\n\tconst git_config *cfg,\n\tgit_config_level_t level)\n{\n\tint pos = -1;\n\tfile_internal *internal;\n\tsize_t i;\n\n\t/* when passing GIT_CONFIG_HIGHEST_LEVEL, the idea is to get the config file\n\t * which has the highest level. As config files are stored in a vector\n\t * sorted by decreasing order of level, getting the file at position 0\n\t * will do the job.\n\t */\n\tif (level == GIT_CONFIG_HIGHEST_LEVEL) {\n\t\tpos = 0;\n\t} else {\n\t\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\t\tif (internal->level == level)\n\t\t\t\tpos = (int)i;\n\t\t}\n\t}\n\n\tif (pos == -1) {\n\t\tgiterr_set(GITERR_CONFIG,\n\t\t\t\"No config file exists for the given level '%i'\", (int)level);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\t*internal_out = git_vector_get(&cfg->files, pos);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_open_level(\n\tgit_config **cfg_out,\n\tconst git_config *cfg_parent,\n\tgit_config_level_t level)\n{\n\tgit_config *cfg;\n\tfile_internal *internal;\n\tint res;\n\n\tif ((res = find_internal_file_by_level(&internal, cfg_parent, level)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config_new(&cfg)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config__add_internal(cfg, internal, level, true)) < 0) {\n\t\tgit_config_free(cfg);\n\t\treturn res;\n\t}\n\n\t*cfg_out = cfg;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_config_open_global",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "273-279",
    "snippet": "int git_config_open_global(git_config **cfg_out, git_config *cfg)\n{\n\tif (!git_config_open_level(cfg_out, cfg, GIT_CONFIG_LEVEL_XDG))\n\t\treturn 0;\n\n\treturn git_config_open_level(cfg_out, cfg, GIT_CONFIG_LEVEL_GLOBAL);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_open_level",
          "args": [
            "cfg_out",
            "cfg",
            "GIT_CONFIG_LEVEL_GLOBAL"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_open_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "281-304",
          "snippet": "int git_config_open_level(\n\tgit_config **cfg_out,\n\tconst git_config *cfg_parent,\n\tgit_config_level_t level)\n{\n\tgit_config *cfg;\n\tfile_internal *internal;\n\tint res;\n\n\tif ((res = find_internal_file_by_level(&internal, cfg_parent, level)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config_new(&cfg)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config__add_internal(cfg, internal, level, true)) < 0) {\n\t\tgit_config_free(cfg);\n\t\treturn res;\n\t}\n\n\t*cfg_out = cfg;\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_open_level(\n\tgit_config **cfg_out,\n\tconst git_config *cfg_parent,\n\tgit_config_level_t level)\n{\n\tgit_config *cfg;\n\tfile_internal *internal;\n\tint res;\n\n\tif ((res = find_internal_file_by_level(&internal, cfg_parent, level)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config_new(&cfg)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config__add_internal(cfg, internal, level, true)) < 0) {\n\t\tgit_config_free(cfg);\n\t\treturn res;\n\t}\n\n\t*cfg_out = cfg;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_open_global(git_config **cfg_out, git_config *cfg)\n{\n\tif (!git_config_open_level(cfg_out, cfg, GIT_CONFIG_LEVEL_XDG))\n\t\treturn 0;\n\n\treturn git_config_open_level(cfg_out, cfg, GIT_CONFIG_LEVEL_GLOBAL);\n}"
  },
  {
    "function_name": "git_config__add_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "249-271",
    "snippet": "static int git_config__add_internal(\n\tgit_config *cfg,\n\tfile_internal *internal,\n\tgit_config_level_t level,\n\tint force)\n{\n\tint result;\n\n\t/* delete existing config file for level if it exists */\n\tif (force)\n\t\ttry_remove_existing_file_internal(cfg, level);\n\n\tif ((result = git_vector_insert_sorted(&cfg->files,\n\t\t\tinternal, &duplicate_level)) < 0)\n\t\treturn result;\n\n\tgit_vector_sort(&cfg->files);\n\tinternal->file->cfg = cfg;\n\n\tGIT_REFCOUNT_INC(internal);\n\n\treturn 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "internal"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_sort",
          "args": [
            "&cfg->files"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_sort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "175-185",
          "snippet": "void git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert_sorted",
          "args": [
            "&cfg->files",
            "internal",
            "&duplicate_level"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert_sorted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "141-173",
          "snippet": "int git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "try_remove_existing_file_internal",
          "args": [
            "cfg",
            "level"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "try_remove_existing_file_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "225-247",
          "snippet": "static void try_remove_existing_file_internal(\n\tgit_config *cfg,\n\tgit_config_level_t level)\n{\n\tint pos = -1;\n\tfile_internal *internal;\n\tsize_t i;\n\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (internal->level == level)\n\t\t\tpos = (int)i;\n\t}\n\n\tif (pos == -1)\n\t\treturn;\n\n\tinternal = git_vector_get(&cfg->files, pos);\n\n\tif (git_vector_remove(&cfg->files, pos) < 0)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(internal, file_internal_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic void try_remove_existing_file_internal(\n\tgit_config *cfg,\n\tgit_config_level_t level)\n{\n\tint pos = -1;\n\tfile_internal *internal;\n\tsize_t i;\n\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (internal->level == level)\n\t\t\tpos = (int)i;\n\t}\n\n\tif (pos == -1)\n\t\treturn;\n\n\tinternal = git_vector_get(&cfg->files, pos);\n\n\tif (git_vector_remove(&cfg->files, pos) < 0)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(internal, file_internal_free);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_config__add_internal(\n\tgit_config *cfg,\n\tfile_internal *internal,\n\tgit_config_level_t level,\n\tint force)\n{\n\tint result;\n\n\t/* delete existing config file for level if it exists */\n\tif (force)\n\t\ttry_remove_existing_file_internal(cfg, level);\n\n\tif ((result = git_vector_insert_sorted(&cfg->files,\n\t\t\tinternal, &duplicate_level)) < 0)\n\t\treturn result;\n\n\tgit_vector_sort(&cfg->files);\n\tinternal->file->cfg = cfg;\n\n\tGIT_REFCOUNT_INC(internal);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "try_remove_existing_file_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "225-247",
    "snippet": "static void try_remove_existing_file_internal(\n\tgit_config *cfg,\n\tgit_config_level_t level)\n{\n\tint pos = -1;\n\tfile_internal *internal;\n\tsize_t i;\n\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (internal->level == level)\n\t\t\tpos = (int)i;\n\t}\n\n\tif (pos == -1)\n\t\treturn;\n\n\tinternal = git_vector_get(&cfg->files, pos);\n\n\tif (git_vector_remove(&cfg->files, pos) < 0)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(internal, file_internal_free);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_DEC",
          "args": [
            "internal",
            "file_internal_free"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_remove",
          "args": [
            "&cfg->files",
            "pos"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "233-250",
          "snippet": "int git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_remove(git_vector *v, size_t idx)\n{\n\tsize_t shift_count;\n\n\tassert(v);\n\n\tif (idx >= v->length)\n\t\treturn GIT_ENOTFOUND;\n\n\tshift_count = v->length - idx - 1;\n\n\tif (shift_count)\n\t\tmemmove(&v->contents[idx], &v->contents[idx + 1],\n\t\t\tshift_count * sizeof(void *));\n\n\tv->length--;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "pos"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&cfg->files",
            "i",
            "internal"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic void try_remove_existing_file_internal(\n\tgit_config *cfg,\n\tgit_config_level_t level)\n{\n\tint pos = -1;\n\tfile_internal *internal;\n\tsize_t i;\n\n\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\tif (internal->level == level)\n\t\t\tpos = (int)i;\n\t}\n\n\tif (pos == -1)\n\t\treturn;\n\n\tinternal = git_vector_get(&cfg->files, pos);\n\n\tif (git_vector_remove(&cfg->files, pos) < 0)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(internal, file_internal_free);\n}"
  },
  {
    "function_name": "duplicate_level",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "215-223",
    "snippet": "static int duplicate_level(void **old_raw, void *new_raw)\n{\n\tfile_internal **old = (file_internal **)old_raw;\n\n\tGIT_UNUSED(new_raw);\n\n\tgiterr_set(GITERR_CONFIG, \"A file with the same level (%i) has already been added to the config\", (int)(*old)->level);\n\treturn GIT_EEXISTS;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"A file with the same level (%i) has already been added to the config\"",
            "(int)(*old)->level"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "new_raw"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int duplicate_level(void **old_raw, void *new_raw)\n{\n\tfile_internal **old = (file_internal **)old_raw;\n\n\tGIT_UNUSED(new_raw);\n\n\tgiterr_set(GITERR_CONFIG, \"A file with the same level (%i) has already been added to the config\", (int)(*old)->level);\n\treturn GIT_EEXISTS;\n}"
  },
  {
    "function_name": "find_internal_file_by_level",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "181-213",
    "snippet": "static int find_internal_file_by_level(\n\tfile_internal **internal_out,\n\tconst git_config *cfg,\n\tgit_config_level_t level)\n{\n\tint pos = -1;\n\tfile_internal *internal;\n\tsize_t i;\n\n\t/* when passing GIT_CONFIG_HIGHEST_LEVEL, the idea is to get the config file\n\t * which has the highest level. As config files are stored in a vector\n\t * sorted by decreasing order of level, getting the file at position 0\n\t * will do the job.\n\t */\n\tif (level == GIT_CONFIG_HIGHEST_LEVEL) {\n\t\tpos = 0;\n\t} else {\n\t\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\t\tif (internal->level == level)\n\t\t\t\tpos = (int)i;\n\t\t}\n\t}\n\n\tif (pos == -1) {\n\t\tgiterr_set(GITERR_CONFIG,\n\t\t\t\"No config file exists for the given level '%i'\", (int)level);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\t*internal_out = git_vector_get(&cfg->files, pos);\n\n\treturn 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "pos"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"No config file exists for the given level '%i'\"",
            "(int)level"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&cfg->files",
            "i",
            "internal"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int find_internal_file_by_level(\n\tfile_internal **internal_out,\n\tconst git_config *cfg,\n\tgit_config_level_t level)\n{\n\tint pos = -1;\n\tfile_internal *internal;\n\tsize_t i;\n\n\t/* when passing GIT_CONFIG_HIGHEST_LEVEL, the idea is to get the config file\n\t * which has the highest level. As config files are stored in a vector\n\t * sorted by decreasing order of level, getting the file at position 0\n\t * will do the job.\n\t */\n\tif (level == GIT_CONFIG_HIGHEST_LEVEL) {\n\t\tpos = 0;\n\t} else {\n\t\tgit_vector_foreach(&cfg->files, i, internal) {\n\t\t\tif (internal->level == level)\n\t\t\t\tpos = (int)i;\n\t\t}\n\t}\n\n\tif (pos == -1) {\n\t\tgiterr_set(GITERR_CONFIG,\n\t\t\t\"No config file exists for the given level '%i'\", (int)level);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\t*internal_out = git_vector_get(&cfg->files, pos);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_config_snapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "149-179",
    "snippet": "int git_config_snapshot(git_config **out, git_config *in)\n{\n\tint error = 0;\n\tsize_t i;\n\tfile_internal *internal;\n\tgit_config *config;\n\n\t*out = NULL;\n\n\tif (git_config_new(&config) < 0)\n\t\treturn -1;\n\n\tgit_vector_foreach(&in->files, i, internal) {\n\t\tgit_config_backend *b;\n\n\t\tif ((error = internal->file->snapshot(&b, internal->file)) < 0)\n\t\t\tbreak;\n\n\t\tif ((error = git_config_add_backend(config, b, internal->level, 0)) < 0) {\n\t\t\tb->free(b);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error < 0)\n\t\tgit_config_free(config);\n\telse\n\t\t*out = config;\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "config"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->free",
          "args": [
            "b"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_config_add_backend",
          "args": [
            "config",
            "b",
            "internal->level",
            "0"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_add_backend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "306-336",
          "snippet": "int git_config_add_backend(\n\tgit_config *cfg,\n\tgit_config_backend *file,\n\tgit_config_level_t level,\n\tint force)\n{\n\tfile_internal *internal;\n\tint result;\n\n\tassert(cfg && file);\n\n\tGITERR_CHECK_VERSION(file, GIT_CONFIG_BACKEND_VERSION, \"git_config_backend\");\n\n\tif ((result = file->open(file, level)) < 0)\n\t\treturn result;\n\n\tinternal = git__malloc(sizeof(file_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tmemset(internal, 0x0, sizeof(file_internal));\n\n\tinternal->file = file;\n\tinternal->level = level;\n\n\tif ((result = git_config__add_internal(cfg, internal, level, force)) < 0) {\n\t\tgit__free(internal);\n\t\treturn result;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_add_backend(\n\tgit_config *cfg,\n\tgit_config_backend *file,\n\tgit_config_level_t level,\n\tint force)\n{\n\tfile_internal *internal;\n\tint result;\n\n\tassert(cfg && file);\n\n\tGITERR_CHECK_VERSION(file, GIT_CONFIG_BACKEND_VERSION, \"git_config_backend\");\n\n\tif ((result = file->open(file, level)) < 0)\n\t\treturn result;\n\n\tinternal = git__malloc(sizeof(file_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tmemset(internal, 0x0, sizeof(file_internal));\n\n\tinternal->file = file;\n\tinternal->level = level;\n\n\tif ((result = git_config__add_internal(cfg, internal, level, force)) < 0) {\n\t\tgit__free(internal);\n\t\treturn result;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "internal->file->snapshot",
          "args": [
            "&b",
            "internal->file"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&in->files",
            "i",
            "internal"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_config_new",
          "args": [
            "&config"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "79-96",
          "snippet": "int git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_snapshot(git_config **out, git_config *in)\n{\n\tint error = 0;\n\tsize_t i;\n\tfile_internal *internal;\n\tgit_config *config;\n\n\t*out = NULL;\n\n\tif (git_config_new(&config) < 0)\n\t\treturn -1;\n\n\tgit_vector_foreach(&in->files, i, internal) {\n\t\tgit_config_backend *b;\n\n\t\tif ((error = internal->file->snapshot(&b, internal->file)) < 0)\n\t\t\tbreak;\n\n\t\tif ((error = git_config_add_backend(config, b, internal->level, 0)) < 0) {\n\t\t\tb->free(b);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error < 0)\n\t\tgit_config_free(config);\n\telse\n\t\t*out = config;\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_config_open_ondisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "131-147",
    "snippet": "int git_config_open_ondisk(git_config **out, const char *path)\n{\n\tint error;\n\tgit_config *config;\n\n\t*out = NULL;\n\n\tif (git_config_new(&config) < 0)\n\t\treturn -1;\n\n\tif ((error = git_config_add_file_ondisk(config, path, GIT_CONFIG_LEVEL_LOCAL, 0)) < 0)\n\t\tgit_config_free(config);\n\telse\n\t\t*out = config;\n\n\treturn error;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "config"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_add_file_ondisk",
          "args": [
            "config",
            "path",
            "GIT_CONFIG_LEVEL_LOCAL",
            "0"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_add_file_ondisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "98-129",
          "snippet": "int git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_new",
          "args": [
            "&config"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "79-96",
          "snippet": "int git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_open_ondisk(git_config **out, const char *path)\n{\n\tint error;\n\tgit_config *config;\n\n\t*out = NULL;\n\n\tif (git_config_new(&config) < 0)\n\t\treturn -1;\n\n\tif ((error = git_config_add_file_ondisk(config, path, GIT_CONFIG_LEVEL_LOCAL, 0)) < 0)\n\t\tgit_config_free(config);\n\telse\n\t\t*out = config;\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_config_add_file_ondisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "98-129",
    "snippet": "int git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->free",
          "args": [
            "file"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_config_add_backend",
          "args": [
            "cfg",
            "file",
            "level",
            "force"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_add_backend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "306-336",
          "snippet": "int git_config_add_backend(\n\tgit_config *cfg,\n\tgit_config_backend *file,\n\tgit_config_level_t level,\n\tint force)\n{\n\tfile_internal *internal;\n\tint result;\n\n\tassert(cfg && file);\n\n\tGITERR_CHECK_VERSION(file, GIT_CONFIG_BACKEND_VERSION, \"git_config_backend\");\n\n\tif ((result = file->open(file, level)) < 0)\n\t\treturn result;\n\n\tinternal = git__malloc(sizeof(file_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tmemset(internal, 0x0, sizeof(file_internal));\n\n\tinternal->file = file;\n\tinternal->level = level;\n\n\tif ((result = git_config__add_internal(cfg, internal, level, force)) < 0) {\n\t\tgit__free(internal);\n\t\treturn result;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_add_backend(\n\tgit_config *cfg,\n\tgit_config_backend *file,\n\tgit_config_level_t level,\n\tint force)\n{\n\tfile_internal *internal;\n\tint result;\n\n\tassert(cfg && file);\n\n\tGITERR_CHECK_VERSION(file, GIT_CONFIG_BACKEND_VERSION, \"git_config_backend\");\n\n\tif ((result = file->open(file, level)) < 0)\n\t\treturn result;\n\n\tinternal = git__malloc(sizeof(file_internal));\n\tGITERR_CHECK_ALLOC(internal);\n\n\tmemset(internal, 0x0, sizeof(file_internal));\n\n\tinternal->file = file;\n\tinternal->level = level;\n\n\tif ((result = git_config__add_internal(cfg, internal, level, force)) < 0) {\n\t\tgit__free(internal);\n\t\treturn result;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_file__ondisk",
          "args": [
            "&file",
            "path"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_file__ondisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_file.c",
          "lines": "711-739",
          "snippet": "int git_config_file__ondisk(git_config_backend **out, const char *path)\n{\n\tdiskfile_backend *backend;\n\n\tbackend = git__calloc(1, sizeof(diskfile_backend));\n\tGITERR_CHECK_ALLOC(backend);\n\n\tbackend->header.parent.version = GIT_CONFIG_BACKEND_VERSION;\n\tgit_mutex_init(&backend->header.values_mutex);\n\n\tbackend->file_path = git__strdup(path);\n\tGITERR_CHECK_ALLOC(backend->file_path);\n\n\tbackend->header.parent.open = config_open;\n\tbackend->header.parent.get = config_get;\n\tbackend->header.parent.set = config_set;\n\tbackend->header.parent.set_multivar = config_set_multivar;\n\tbackend->header.parent.del = config_delete;\n\tbackend->header.parent.del_multivar = config_delete_multivar;\n\tbackend->header.parent.iterator = config_iterator_new;\n\tbackend->header.parent.snapshot = config_snapshot;\n\tbackend->header.parent.lock = config_lock;\n\tbackend->header.parent.unlock = config_unlock;\n\tbackend->header.parent.free = backend_free;\n\n\t*out = (git_config_backend *)backend;\n\n\treturn 0;\n}",
          "includes": [
            "#include <regex.h>",
            "#include <sys/types.h>",
            "#include <ctype.h>",
            "#include \"array.h\"",
            "#include \"strmap.h\"",
            "#include \"git2/types.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"sysdir.h\"",
            "#include \"filebuf.h\"",
            "#include \"config.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <regex.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include \"array.h\"\n#include \"strmap.h\"\n#include \"git2/types.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"sysdir.h\"\n#include \"filebuf.h\"\n#include \"config.h\"\n#include \"common.h\"\n\nint git_config_file__ondisk(git_config_backend **out, const char *path)\n{\n\tdiskfile_backend *backend;\n\n\tbackend = git__calloc(1, sizeof(diskfile_backend));\n\tGITERR_CHECK_ALLOC(backend);\n\n\tbackend->header.parent.version = GIT_CONFIG_BACKEND_VERSION;\n\tgit_mutex_init(&backend->header.values_mutex);\n\n\tbackend->file_path = git__strdup(path);\n\tGITERR_CHECK_ALLOC(backend->file_path);\n\n\tbackend->header.parent.open = config_open;\n\tbackend->header.parent.get = config_get;\n\tbackend->header.parent.set = config_set;\n\tbackend->header.parent.set_multivar = config_set_multivar;\n\tbackend->header.parent.del = config_delete;\n\tbackend->header.parent.del_multivar = config_delete_multivar;\n\tbackend->header.parent.iterator = config_iterator_new;\n\tbackend->header.parent.snapshot = config_snapshot;\n\tbackend->header.parent.lock = config_lock;\n\tbackend->header.parent.unlock = config_unlock;\n\tbackend->header.parent.free = backend_free;\n\n\t*out = (git_config_backend *)backend;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_CONFIG",
            "\"Error stat'ing config file '%s'\"",
            "path"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_stat",
          "args": [
            "path",
            "&st"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "p_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "417-432",
          "snippet": "int p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cfg && path"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_config_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "79-96",
    "snippet": "int git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "cfg"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "cfg"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "&cfg->files",
            "3",
            "config_backend_cmp"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "cfg",
            "0x0",
            "sizeof(git_config)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "cfg"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(git_config)"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}"
  },
  {
    "function_name": "config_backend_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "71-77",
    "snippet": "static int config_backend_cmp(const void *a, const void *b)\n{\n\tconst file_internal *bk_a = (const file_internal *)(a);\n\tconst file_internal *bk_b = (const file_internal *)(b);\n\n\treturn bk_b->level - bk_a->level;\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int config_backend_cmp(const void *a, const void *b)\n{\n\tconst file_internal *bk_a = (const file_internal *)(a);\n\tconst file_internal *bk_b = (const file_internal *)(b);\n\n\treturn bk_b->level - bk_a->level;\n}"
  },
  {
    "function_name": "git_config_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "63-69",
    "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_DEC",
          "args": [
            "cfg",
            "config_free"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
  },
  {
    "function_name": "config_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "47-61",
    "snippet": "static void config_free(git_config *cfg)\n{\n\tsize_t i;\n\tfile_internal *internal;\n\n\tfor (i = 0; i < cfg->files.length; ++i) {\n\t\tinternal = git_vector_get(&cfg->files, i);\n\t\tGIT_REFCOUNT_DEC(internal, file_internal_free);\n\t}\n\n\tgit_vector_free(&cfg->files);\n\n\tgit__memzero(cfg, sizeof(*cfg));\n\tgit__free(cfg);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "cfg"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__memzero",
          "args": [
            "cfg",
            "sizeof(*cfg)"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "git__memzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "521-531",
          "snippet": "GIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "&cfg->files"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_DEC",
          "args": [
            "internal",
            "file_internal_free"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&cfg->files",
            "i"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic void config_free(git_config *cfg)\n{\n\tsize_t i;\n\tfile_internal *internal;\n\n\tfor (i = 0; i < cfg->files.length; ++i) {\n\t\tinternal = git_vector_get(&cfg->files, i);\n\t\tGIT_REFCOUNT_DEC(internal, file_internal_free);\n\t}\n\n\tgit_vector_free(&cfg->files);\n\n\tgit__memzero(cfg, sizeof(*cfg));\n\tgit__free(cfg);\n}"
  },
  {
    "function_name": "file_internal_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "38-45",
    "snippet": "static void file_internal_free(file_internal *internal)\n{\n\tgit_config_backend *file;\n\n\tfile = internal->file;\n\tfile->free(file);\n\tgit__free(internal);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "internal"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->free",
          "args": [
            "file"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic void file_internal_free(file_internal *internal)\n{\n\tgit_config_backend *file;\n\n\tfile = internal->file;\n\tfile->free(file);\n\tgit__free(internal);\n}"
  },
  {
    "function_name": "git_config_entry_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
    "lines": "23-29",
    "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
    "includes": [
      "#include <ctype.h>",
      "# include <windows.h>",
      "#include \"transaction.h\"",
      "#include \"config_file.h\"",
      "#include \"buf_text.h\"",
      "#include \"vector.h\"",
      "#include \"git2/sys/config.h\"",
      "#include \"git2/config.h\"",
      "#include \"config.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "entry->free",
          "args": [
            "entry"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
  }
]