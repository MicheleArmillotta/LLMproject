[
  {
    "function_name": "git_bitvec_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
    "lines": "69-73",
    "snippet": "GIT_INLINE(void) git_bitvec_free(git_bitvec *bv)\n{\n\tif (bv->length)\n\t\tgit__free(bv->u.words);\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "bv->u.words"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void) git_bitvec_free(git_bitvec *bv)\n{\n\tif (bv->length)\n\t\tgit__free(bv->u.words);\n}"
  },
  {
    "function_name": "git_bitvec_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
    "lines": "61-67",
    "snippet": "GIT_INLINE(void) git_bitvec_clear(git_bitvec *bv)\n{\n\tif (!bv->length)\n\t\tbv->u.bits = 0;\n\telse\n\t\tmemset(bv->u.words, 0x0, bv->length * sizeof(uint64_t));\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "bv->u.words",
            "0x0",
            "bv->length * sizeof(uint64_t)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void) git_bitvec_clear(git_bitvec *bv)\n{\n\tif (!bv->length)\n\t\tbv->u.bits = 0;\n\telse\n\t\tmemset(bv->u.words, 0x0, bv->length * sizeof(uint64_t));\n}"
  },
  {
    "function_name": "git_bitvec_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
    "lines": "55-59",
    "snippet": "GIT_INLINE(bool) git_bitvec_get(git_bitvec *bv, size_t bit)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\treturn (*word & GIT_BITVEC_MASK(bit)) != 0;\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_BITVEC_MASK",
          "args": [
            "bit"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_BITVEC_WORD",
          "args": [
            "bv",
            "bit"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(bool) git_bitvec_get(git_bitvec *bv, size_t bit)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\treturn (*word & GIT_BITVEC_MASK(bit)) != 0;\n}"
  },
  {
    "function_name": "git_bitvec_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
    "lines": "44-53",
    "snippet": "GIT_INLINE(void) git_bitvec_set(git_bitvec *bv, size_t bit, bool on)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\tuint64_t mask = GIT_BITVEC_MASK(bit);\n\n\tif (on)\n\t\t*word |= mask;\n\telse\n\t\t*word &= ~mask;\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_BITVEC_MASK",
          "args": [
            "bit"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_BITVEC_WORD",
          "args": [
            "bv",
            "bit"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void) git_bitvec_set(git_bitvec *bv, size_t bit, bool on)\n{\n\tuint64_t *word = GIT_BITVEC_WORD(bv, bit);\n\tuint64_t mask = GIT_BITVEC_MASK(bit);\n\n\tif (on)\n\t\t*word |= mask;\n\telse\n\t\t*word &= ~mask;\n}"
  },
  {
    "function_name": "git_bitvec_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/bitvec.h",
    "lines": "27-39",
    "snippet": "GIT_INLINE(int) git_bitvec_init(git_bitvec *bv, size_t capacity)\n{\n\tmemset(bv, 0x0, sizeof(*bv));\n\n\tif (capacity >= 64) {\n\t\tbv->length = (capacity / 64) + 1;\n\t\tbv->u.words = git__calloc(bv->length, sizeof(uint64_t));\n\t\tif (!bv->u.words)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "bv->length",
            "sizeof(uint64_t)"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "bv",
            "0x0",
            "sizeof(*bv)"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(int) git_bitvec_init(git_bitvec *bv, size_t capacity)\n{\n\tmemset(bv, 0x0, sizeof(*bv));\n\n\tif (capacity >= 64) {\n\t\tbv->length = (capacity / 64) + 1;\n\t\tbv->u.words = git__calloc(bv->length, sizeof(uint64_t));\n\t\tif (!bv->u.words)\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  }
]