[
  {
    "function_name": "git_smart_subtransport_git",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "349-368",
    "snippet": "int git_smart_subtransport_git(git_smart_subtransport **out, git_transport *owner, void *param)\n{\n\tgit_subtransport *t;\n\n\tGIT_UNUSED(param);\n\n\tif (!out)\n\t\treturn -1;\n\n\tt = git__calloc(1, sizeof(git_subtransport));\n\tGITERR_CHECK_ALLOC(t);\n\n\tt->owner = owner;\n\tt->parent.action = _git_action;\n\tt->parent.close = _git_close;\n\tt->parent.free = _git_free;\n\n\t*out = (git_smart_subtransport *) t;\n\treturn 0;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "t"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_subtransport)"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "param"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nint git_smart_subtransport_git(git_smart_subtransport **out, git_transport *owner, void *param)\n{\n\tgit_subtransport *t;\n\n\tGIT_UNUSED(param);\n\n\tif (!out)\n\t\treturn -1;\n\n\tt = git__calloc(1, sizeof(git_subtransport));\n\tGITERR_CHECK_ALLOC(t);\n\n\tt->owner = owner;\n\tt->parent.action = _git_action;\n\tt->parent.close = _git_close;\n\tt->parent.free = _git_free;\n\n\t*out = (git_smart_subtransport *) t;\n\treturn 0;\n}"
  },
  {
    "function_name": "_git_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "340-347",
    "snippet": "static void _git_free(git_smart_subtransport *subtransport)\n{\n\tgit_subtransport *t = (git_subtransport *) subtransport;\n\n\tassert(!t->current_stream);\n\n\tgit__free(t);\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "t"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!t->current_stream"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic void _git_free(git_smart_subtransport *subtransport)\n{\n\tgit_subtransport *t = (git_subtransport *) subtransport;\n\n\tassert(!t->current_stream);\n\n\tgit__free(t);\n}"
  },
  {
    "function_name": "_git_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "329-338",
    "snippet": "static int _git_close(git_smart_subtransport *subtransport)\n{\n\tgit_subtransport *t = (git_subtransport *) subtransport;\n\n\tassert(!t->current_stream);\n\n\tGIT_UNUSED(t);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "t"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!t->current_stream"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int _git_close(git_smart_subtransport *subtransport)\n{\n\tgit_subtransport *t = (git_subtransport *) subtransport;\n\n\tassert(!t->current_stream);\n\n\tGIT_UNUSED(t);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "_git_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "303-327",
    "snippet": "static int _git_action(\n\tgit_smart_subtransport_stream **stream,\n\tgit_smart_subtransport *subtransport,\n\tconst char *url,\n\tgit_smart_service_t action)\n{\n\tgit_subtransport *t = (git_subtransport *) subtransport;\n\n\tswitch (action) {\n\t\tcase GIT_SERVICE_UPLOADPACK_LS:\n\t\t\treturn _git_uploadpack_ls(t, url, stream);\n\n\t\tcase GIT_SERVICE_UPLOADPACK:\n\t\t\treturn _git_uploadpack(t, url, stream);\n\n\t\tcase GIT_SERVICE_RECEIVEPACK_LS:\n\t\t\treturn _git_receivepack_ls(t, url, stream);\n\n\t\tcase GIT_SERVICE_RECEIVEPACK:\n\t\t\treturn _git_receivepack(t, url, stream);\n\t}\n\n\t*stream = NULL;\n\treturn -1;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_git_receivepack",
          "args": [
            "t",
            "url",
            "stream"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "_git_receivepack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "287-301",
          "snippet": "static int _git_receivepack(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tGIT_UNUSED(url);\n\n\tif (t->current_stream) {\n\t\t*stream = &t->current_stream->parent;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_NET, \"Must call RECEIVEPACK_LS before RECEIVEPACK\");\n\treturn -1;\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int _git_receivepack(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tGIT_UNUSED(url);\n\n\tif (t->current_stream) {\n\t\t*stream = &t->current_stream->parent;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_NET, \"Must call RECEIVEPACK_LS before RECEIVEPACK\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_git_receivepack_ls",
          "args": [
            "t",
            "url",
            "stream"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "_git_receivepack_ls",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "247-285",
          "snippet": "static int _git_receivepack_ls(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tchar *host=NULL, *port=NULL, *path=NULL, *user=NULL, *pass=NULL;\n\tconst char *stream_url = url;\n\tgit_proto_stream *s;\n\tint error;\n\n\t*stream = NULL;\n\tif (!git__prefixcmp(url, prefix_git))\n\t\tstream_url += strlen(prefix_git);\n\n\tif ((error = gitno_extract_url_parts(&host, &port, &path, &user, &pass, url, GIT_DEFAULT_PORT)) < 0)\n\t\treturn error;\n\n\terror = git_proto_stream_alloc(t, stream_url, cmd_receivepack, host, port, stream);\n\n\tgit__free(host);\n\tgit__free(port);\n\tgit__free(path);\n\tgit__free(user);\n\tgit__free(pass);\n\n\tif (error < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\ts = (git_proto_stream *) *stream;\n\n\tif ((error = git_stream_connect(s->io)) < 0)\n\t\treturn error;\n\n\tt->current_stream = s;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char prefix_git[] = \"git://\";",
            "static const char cmd_receivepack[] = \"git-receive-pack\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic const char prefix_git[] = \"git://\";\nstatic const char cmd_receivepack[] = \"git-receive-pack\";\n\nstatic int _git_receivepack_ls(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tchar *host=NULL, *port=NULL, *path=NULL, *user=NULL, *pass=NULL;\n\tconst char *stream_url = url;\n\tgit_proto_stream *s;\n\tint error;\n\n\t*stream = NULL;\n\tif (!git__prefixcmp(url, prefix_git))\n\t\tstream_url += strlen(prefix_git);\n\n\tif ((error = gitno_extract_url_parts(&host, &port, &path, &user, &pass, url, GIT_DEFAULT_PORT)) < 0)\n\t\treturn error;\n\n\terror = git_proto_stream_alloc(t, stream_url, cmd_receivepack, host, port, stream);\n\n\tgit__free(host);\n\tgit__free(port);\n\tgit__free(path);\n\tgit__free(user);\n\tgit__free(pass);\n\n\tif (error < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\ts = (git_proto_stream *) *stream;\n\n\tif ((error = git_stream_connect(s->io)) < 0)\n\t\treturn error;\n\n\tt->current_stream = s;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_git_uploadpack",
          "args": [
            "t",
            "url",
            "stream"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "_git_uploadpack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "231-245",
          "snippet": "static int _git_uploadpack(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tGIT_UNUSED(url);\n\n\tif (t->current_stream) {\n\t\t*stream = &t->current_stream->parent;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_NET, \"Must call UPLOADPACK_LS before UPLOADPACK\");\n\treturn -1;\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int _git_uploadpack(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tGIT_UNUSED(url);\n\n\tif (t->current_stream) {\n\t\t*stream = &t->current_stream->parent;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_NET, \"Must call UPLOADPACK_LS before UPLOADPACK\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_git_uploadpack_ls",
          "args": [
            "t",
            "url",
            "stream"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "_git_uploadpack_ls",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "188-229",
          "snippet": "static int _git_uploadpack_ls(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tchar *host=NULL, *port=NULL, *path=NULL, *user=NULL, *pass=NULL;\n\tconst char *stream_url = url;\n\tgit_proto_stream *s;\n\tint error;\n\n\t*stream = NULL;\n\n\tif (!git__prefixcmp(url, prefix_git))\n\t\tstream_url += strlen(prefix_git);\n\n\tif ((error = gitno_extract_url_parts(&host, &port, &path, &user, &pass, url, GIT_DEFAULT_PORT)) < 0)\n\t\treturn error;\n\n\terror = git_proto_stream_alloc(t, stream_url, cmd_uploadpack, host, port, stream);\n\n\tgit__free(host);\n\tgit__free(port);\n\tgit__free(path);\n\tgit__free(user);\n\tgit__free(pass);\n\n\n\tif (error < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\ts = (git_proto_stream *) *stream;\n\tif ((error = git_stream_connect(s->io)) < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\tt->current_stream = s;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char prefix_git[] = \"git://\";",
            "static const char cmd_uploadpack[] = \"git-upload-pack\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic const char prefix_git[] = \"git://\";\nstatic const char cmd_uploadpack[] = \"git-upload-pack\";\n\nstatic int _git_uploadpack_ls(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tchar *host=NULL, *port=NULL, *path=NULL, *user=NULL, *pass=NULL;\n\tconst char *stream_url = url;\n\tgit_proto_stream *s;\n\tint error;\n\n\t*stream = NULL;\n\n\tif (!git__prefixcmp(url, prefix_git))\n\t\tstream_url += strlen(prefix_git);\n\n\tif ((error = gitno_extract_url_parts(&host, &port, &path, &user, &pass, url, GIT_DEFAULT_PORT)) < 0)\n\t\treturn error;\n\n\terror = git_proto_stream_alloc(t, stream_url, cmd_uploadpack, host, port, stream);\n\n\tgit__free(host);\n\tgit__free(port);\n\tgit__free(path);\n\tgit__free(user);\n\tgit__free(pass);\n\n\n\tif (error < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\ts = (git_proto_stream *) *stream;\n\tif ((error = git_stream_connect(s->io)) < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\tt->current_stream = s;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int _git_action(\n\tgit_smart_subtransport_stream **stream,\n\tgit_smart_subtransport *subtransport,\n\tconst char *url,\n\tgit_smart_service_t action)\n{\n\tgit_subtransport *t = (git_subtransport *) subtransport;\n\n\tswitch (action) {\n\t\tcase GIT_SERVICE_UPLOADPACK_LS:\n\t\t\treturn _git_uploadpack_ls(t, url, stream);\n\n\t\tcase GIT_SERVICE_UPLOADPACK:\n\t\t\treturn _git_uploadpack(t, url, stream);\n\n\t\tcase GIT_SERVICE_RECEIVEPACK_LS:\n\t\t\treturn _git_receivepack_ls(t, url, stream);\n\n\t\tcase GIT_SERVICE_RECEIVEPACK:\n\t\t\treturn _git_receivepack(t, url, stream);\n\t}\n\n\t*stream = NULL;\n\treturn -1;\n}"
  },
  {
    "function_name": "_git_receivepack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "287-301",
    "snippet": "static int _git_receivepack(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tGIT_UNUSED(url);\n\n\tif (t->current_stream) {\n\t\t*stream = &t->current_stream->parent;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_NET, \"Must call RECEIVEPACK_LS before RECEIVEPACK\");\n\treturn -1;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"Must call RECEIVEPACK_LS before RECEIVEPACK\""
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "url"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int _git_receivepack(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tGIT_UNUSED(url);\n\n\tif (t->current_stream) {\n\t\t*stream = &t->current_stream->parent;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_NET, \"Must call RECEIVEPACK_LS before RECEIVEPACK\");\n\treturn -1;\n}"
  },
  {
    "function_name": "_git_receivepack_ls",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "247-285",
    "snippet": "static int _git_receivepack_ls(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tchar *host=NULL, *port=NULL, *path=NULL, *user=NULL, *pass=NULL;\n\tconst char *stream_url = url;\n\tgit_proto_stream *s;\n\tint error;\n\n\t*stream = NULL;\n\tif (!git__prefixcmp(url, prefix_git))\n\t\tstream_url += strlen(prefix_git);\n\n\tif ((error = gitno_extract_url_parts(&host, &port, &path, &user, &pass, url, GIT_DEFAULT_PORT)) < 0)\n\t\treturn error;\n\n\terror = git_proto_stream_alloc(t, stream_url, cmd_receivepack, host, port, stream);\n\n\tgit__free(host);\n\tgit__free(port);\n\tgit__free(path);\n\tgit__free(user);\n\tgit__free(pass);\n\n\tif (error < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\ts = (git_proto_stream *) *stream;\n\n\tif ((error = git_stream_connect(s->io)) < 0)\n\t\treturn error;\n\n\tt->current_stream = s;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char prefix_git[] = \"git://\";",
      "static const char cmd_receivepack[] = \"git-receive-pack\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_connect",
          "args": [
            "s->io"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_connect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "13-16",
          "snippet": "GIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_proto_stream_free",
          "args": [
            "*stream"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "git_proto_stream_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "131-148",
          "snippet": "static void git_proto_stream_free(git_smart_subtransport_stream *stream)\n{\n\tgit_proto_stream *s;\n\tgit_subtransport *t;\n\n\tif (!stream)\n\t\treturn;\n\n\ts = (git_proto_stream *)stream;\n\tt = OWNING_SUBTRANSPORT(s);\n\n\tt->current_stream = NULL;\n\n\tgit_stream_close(s->io);\n\tgit_stream_free(s->io);\n\tgit__free(s->url);\n\tgit__free(s);\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic void git_proto_stream_free(git_smart_subtransport_stream *stream)\n{\n\tgit_proto_stream *s;\n\tgit_subtransport *t;\n\n\tif (!stream)\n\t\treturn;\n\n\ts = (git_proto_stream *)stream;\n\tt = OWNING_SUBTRANSPORT(s);\n\n\tt->current_stream = NULL;\n\n\tgit_stream_close(s->io);\n\tgit_stream_free(s->io);\n\tgit__free(s->url);\n\tgit__free(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "pass"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_proto_stream_alloc",
          "args": [
            "t",
            "stream_url",
            "cmd_receivepack",
            "host",
            "port",
            "stream"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "git_proto_stream_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "150-186",
          "snippet": "static int git_proto_stream_alloc(\n\tgit_subtransport *t,\n\tconst char *url,\n\tconst char *cmd,\n\tconst char *host,\n\tconst char *port,\n\tgit_smart_subtransport_stream **stream)\n{\n\tgit_proto_stream *s;\n\n\tif (!stream)\n\t\treturn -1;\n\n\ts = git__calloc(1, sizeof(git_proto_stream));\n\tGITERR_CHECK_ALLOC(s);\n\n\ts->parent.subtransport = &t->parent;\n\ts->parent.read = git_proto_stream_read;\n\ts->parent.write = git_proto_stream_write;\n\ts->parent.free = git_proto_stream_free;\n\n\ts->cmd = cmd;\n\ts->url = git__strdup(url);\n\n\tif (!s->url) {\n\t\tgit__free(s);\n\t\treturn -1;\n\t}\n\n\tif ((git_socket_stream_new(&s->io, host, port)) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_VERSION(s->io, GIT_STREAM_VERSION, \"git_stream\");\n\n\t*stream = &s->parent;\n\treturn 0;\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int git_proto_stream_alloc(\n\tgit_subtransport *t,\n\tconst char *url,\n\tconst char *cmd,\n\tconst char *host,\n\tconst char *port,\n\tgit_smart_subtransport_stream **stream)\n{\n\tgit_proto_stream *s;\n\n\tif (!stream)\n\t\treturn -1;\n\n\ts = git__calloc(1, sizeof(git_proto_stream));\n\tGITERR_CHECK_ALLOC(s);\n\n\ts->parent.subtransport = &t->parent;\n\ts->parent.read = git_proto_stream_read;\n\ts->parent.write = git_proto_stream_write;\n\ts->parent.free = git_proto_stream_free;\n\n\ts->cmd = cmd;\n\ts->url = git__strdup(url);\n\n\tif (!s->url) {\n\t\tgit__free(s);\n\t\treturn -1;\n\t}\n\n\tif ((git_socket_stream_new(&s->io, host, port)) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_VERSION(s->io, GIT_STREAM_VERSION, \"git_stream\");\n\n\t*stream = &s->parent;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gitno_extract_url_parts",
          "args": [
            "&host",
            "&port",
            "&path",
            "&user",
            "&pass",
            "url",
            "GIT_DEFAULT_PORT"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "gitno_extract_url_parts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "227-286",
          "snippet": "int gitno_extract_url_parts(\n\t\tchar **host,\n\t\tchar **port,\n\t\tchar **path,\n\t\tchar **username,\n\t\tchar **password,\n\t\tconst char *url,\n\t\tconst char *default_port)\n{\n\tstruct http_parser_url u = {0};\n\tconst char *_host, *_port, *_path, *_userinfo;\n\n\tif (http_parser_parse_url(url, strlen(url), false, &u)) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL '%s'\", url);\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\t_host = url+u.field_data[UF_HOST].off;\n\t_port = url+u.field_data[UF_PORT].off;\n\t_path = url+u.field_data[UF_PATH].off;\n\t_userinfo = url+u.field_data[UF_USERINFO].off;\n\n\tif (u.field_set & (1 << UF_HOST)) {\n\t\t*host = git__substrdup(_host, u.field_data[UF_HOST].len);\n\t\tGITERR_CHECK_ALLOC(*host);\n\t}\n\n\tif (u.field_set & (1 << UF_PORT))\n\t\t*port = git__substrdup(_port, u.field_data[UF_PORT].len);\n\telse\n\t\t*port = git__strdup(default_port);\n\tGITERR_CHECK_ALLOC(*port);\n\n\tif (u.field_set & (1 << UF_PATH)) {\n\t\t*path = git__substrdup(_path, u.field_data[UF_PATH].len);\n\t\tGITERR_CHECK_ALLOC(*path);\n\t} else {\n\t\tgit__free(*port);\n\t\t*port = NULL;\n\t\tgit__free(*host);\n\t\t*host = NULL;\n\t\tgiterr_set(GITERR_NET, \"invalid url, missing path\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (u.field_set & (1 << UF_USERINFO)) {\n\t\tconst char *colon = memchr(_userinfo, ':', u.field_data[UF_USERINFO].len);\n\t\tif (colon) {\n\t\t\t*username = unescape(git__substrdup(_userinfo, colon - _userinfo));\n\t\t\t*password = unescape(git__substrdup(colon+1, u.field_data[UF_USERINFO].len - (colon+1-_userinfo)));\n\t\t\tGITERR_CHECK_ALLOC(*password);\n\t\t} else {\n\t\t\t*username = git__substrdup(_userinfo, u.field_data[UF_USERINFO].len);\n\t\t}\n\t\tGITERR_CHECK_ALLOC(*username);\n\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"global.h\"",
            "#include \"http_parser.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"netops.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nint gitno_extract_url_parts(\n\t\tchar **host,\n\t\tchar **port,\n\t\tchar **path,\n\t\tchar **username,\n\t\tchar **password,\n\t\tconst char *url,\n\t\tconst char *default_port)\n{\n\tstruct http_parser_url u = {0};\n\tconst char *_host, *_port, *_path, *_userinfo;\n\n\tif (http_parser_parse_url(url, strlen(url), false, &u)) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL '%s'\", url);\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\t_host = url+u.field_data[UF_HOST].off;\n\t_port = url+u.field_data[UF_PORT].off;\n\t_path = url+u.field_data[UF_PATH].off;\n\t_userinfo = url+u.field_data[UF_USERINFO].off;\n\n\tif (u.field_set & (1 << UF_HOST)) {\n\t\t*host = git__substrdup(_host, u.field_data[UF_HOST].len);\n\t\tGITERR_CHECK_ALLOC(*host);\n\t}\n\n\tif (u.field_set & (1 << UF_PORT))\n\t\t*port = git__substrdup(_port, u.field_data[UF_PORT].len);\n\telse\n\t\t*port = git__strdup(default_port);\n\tGITERR_CHECK_ALLOC(*port);\n\n\tif (u.field_set & (1 << UF_PATH)) {\n\t\t*path = git__substrdup(_path, u.field_data[UF_PATH].len);\n\t\tGITERR_CHECK_ALLOC(*path);\n\t} else {\n\t\tgit__free(*port);\n\t\t*port = NULL;\n\t\tgit__free(*host);\n\t\t*host = NULL;\n\t\tgiterr_set(GITERR_NET, \"invalid url, missing path\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (u.field_set & (1 << UF_USERINFO)) {\n\t\tconst char *colon = memchr(_userinfo, ':', u.field_data[UF_USERINFO].len);\n\t\tif (colon) {\n\t\t\t*username = unescape(git__substrdup(_userinfo, colon - _userinfo));\n\t\t\t*password = unescape(git__substrdup(colon+1, u.field_data[UF_USERINFO].len - (colon+1-_userinfo)));\n\t\t\tGITERR_CHECK_ALLOC(*password);\n\t\t} else {\n\t\t\t*username = git__substrdup(_userinfo, u.field_data[UF_USERINFO].len);\n\t\t}\n\t\tGITERR_CHECK_ALLOC(*username);\n\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prefix_git"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__prefixcmp",
          "args": [
            "url",
            "prefix_git"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "git__prefixcmp_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "252-255",
          "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic const char prefix_git[] = \"git://\";\nstatic const char cmd_receivepack[] = \"git-receive-pack\";\n\nstatic int _git_receivepack_ls(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tchar *host=NULL, *port=NULL, *path=NULL, *user=NULL, *pass=NULL;\n\tconst char *stream_url = url;\n\tgit_proto_stream *s;\n\tint error;\n\n\t*stream = NULL;\n\tif (!git__prefixcmp(url, prefix_git))\n\t\tstream_url += strlen(prefix_git);\n\n\tif ((error = gitno_extract_url_parts(&host, &port, &path, &user, &pass, url, GIT_DEFAULT_PORT)) < 0)\n\t\treturn error;\n\n\terror = git_proto_stream_alloc(t, stream_url, cmd_receivepack, host, port, stream);\n\n\tgit__free(host);\n\tgit__free(port);\n\tgit__free(path);\n\tgit__free(user);\n\tgit__free(pass);\n\n\tif (error < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\ts = (git_proto_stream *) *stream;\n\n\tif ((error = git_stream_connect(s->io)) < 0)\n\t\treturn error;\n\n\tt->current_stream = s;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "_git_uploadpack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "231-245",
    "snippet": "static int _git_uploadpack(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tGIT_UNUSED(url);\n\n\tif (t->current_stream) {\n\t\t*stream = &t->current_stream->parent;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_NET, \"Must call UPLOADPACK_LS before UPLOADPACK\");\n\treturn -1;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"Must call UPLOADPACK_LS before UPLOADPACK\""
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "url"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int _git_uploadpack(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tGIT_UNUSED(url);\n\n\tif (t->current_stream) {\n\t\t*stream = &t->current_stream->parent;\n\t\treturn 0;\n\t}\n\n\tgiterr_set(GITERR_NET, \"Must call UPLOADPACK_LS before UPLOADPACK\");\n\treturn -1;\n}"
  },
  {
    "function_name": "_git_uploadpack_ls",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "188-229",
    "snippet": "static int _git_uploadpack_ls(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tchar *host=NULL, *port=NULL, *path=NULL, *user=NULL, *pass=NULL;\n\tconst char *stream_url = url;\n\tgit_proto_stream *s;\n\tint error;\n\n\t*stream = NULL;\n\n\tif (!git__prefixcmp(url, prefix_git))\n\t\tstream_url += strlen(prefix_git);\n\n\tif ((error = gitno_extract_url_parts(&host, &port, &path, &user, &pass, url, GIT_DEFAULT_PORT)) < 0)\n\t\treturn error;\n\n\terror = git_proto_stream_alloc(t, stream_url, cmd_uploadpack, host, port, stream);\n\n\tgit__free(host);\n\tgit__free(port);\n\tgit__free(path);\n\tgit__free(user);\n\tgit__free(pass);\n\n\n\tif (error < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\ts = (git_proto_stream *) *stream;\n\tif ((error = git_stream_connect(s->io)) < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\tt->current_stream = s;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char prefix_git[] = \"git://\";",
      "static const char cmd_uploadpack[] = \"git-upload-pack\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_proto_stream_free",
          "args": [
            "*stream"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "git_proto_stream_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "131-148",
          "snippet": "static void git_proto_stream_free(git_smart_subtransport_stream *stream)\n{\n\tgit_proto_stream *s;\n\tgit_subtransport *t;\n\n\tif (!stream)\n\t\treturn;\n\n\ts = (git_proto_stream *)stream;\n\tt = OWNING_SUBTRANSPORT(s);\n\n\tt->current_stream = NULL;\n\n\tgit_stream_close(s->io);\n\tgit_stream_free(s->io);\n\tgit__free(s->url);\n\tgit__free(s);\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic void git_proto_stream_free(git_smart_subtransport_stream *stream)\n{\n\tgit_proto_stream *s;\n\tgit_subtransport *t;\n\n\tif (!stream)\n\t\treturn;\n\n\ts = (git_proto_stream *)stream;\n\tt = OWNING_SUBTRANSPORT(s);\n\n\tt->current_stream = NULL;\n\n\tgit_stream_close(s->io);\n\tgit_stream_free(s->io);\n\tgit__free(s->url);\n\tgit__free(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_stream_connect",
          "args": [
            "s->io"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_connect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "13-16",
          "snippet": "GIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "pass"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_proto_stream_alloc",
          "args": [
            "t",
            "stream_url",
            "cmd_uploadpack",
            "host",
            "port",
            "stream"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "git_proto_stream_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "150-186",
          "snippet": "static int git_proto_stream_alloc(\n\tgit_subtransport *t,\n\tconst char *url,\n\tconst char *cmd,\n\tconst char *host,\n\tconst char *port,\n\tgit_smart_subtransport_stream **stream)\n{\n\tgit_proto_stream *s;\n\n\tif (!stream)\n\t\treturn -1;\n\n\ts = git__calloc(1, sizeof(git_proto_stream));\n\tGITERR_CHECK_ALLOC(s);\n\n\ts->parent.subtransport = &t->parent;\n\ts->parent.read = git_proto_stream_read;\n\ts->parent.write = git_proto_stream_write;\n\ts->parent.free = git_proto_stream_free;\n\n\ts->cmd = cmd;\n\ts->url = git__strdup(url);\n\n\tif (!s->url) {\n\t\tgit__free(s);\n\t\treturn -1;\n\t}\n\n\tif ((git_socket_stream_new(&s->io, host, port)) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_VERSION(s->io, GIT_STREAM_VERSION, \"git_stream\");\n\n\t*stream = &s->parent;\n\treturn 0;\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int git_proto_stream_alloc(\n\tgit_subtransport *t,\n\tconst char *url,\n\tconst char *cmd,\n\tconst char *host,\n\tconst char *port,\n\tgit_smart_subtransport_stream **stream)\n{\n\tgit_proto_stream *s;\n\n\tif (!stream)\n\t\treturn -1;\n\n\ts = git__calloc(1, sizeof(git_proto_stream));\n\tGITERR_CHECK_ALLOC(s);\n\n\ts->parent.subtransport = &t->parent;\n\ts->parent.read = git_proto_stream_read;\n\ts->parent.write = git_proto_stream_write;\n\ts->parent.free = git_proto_stream_free;\n\n\ts->cmd = cmd;\n\ts->url = git__strdup(url);\n\n\tif (!s->url) {\n\t\tgit__free(s);\n\t\treturn -1;\n\t}\n\n\tif ((git_socket_stream_new(&s->io, host, port)) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_VERSION(s->io, GIT_STREAM_VERSION, \"git_stream\");\n\n\t*stream = &s->parent;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gitno_extract_url_parts",
          "args": [
            "&host",
            "&port",
            "&path",
            "&user",
            "&pass",
            "url",
            "GIT_DEFAULT_PORT"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "gitno_extract_url_parts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "227-286",
          "snippet": "int gitno_extract_url_parts(\n\t\tchar **host,\n\t\tchar **port,\n\t\tchar **path,\n\t\tchar **username,\n\t\tchar **password,\n\t\tconst char *url,\n\t\tconst char *default_port)\n{\n\tstruct http_parser_url u = {0};\n\tconst char *_host, *_port, *_path, *_userinfo;\n\n\tif (http_parser_parse_url(url, strlen(url), false, &u)) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL '%s'\", url);\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\t_host = url+u.field_data[UF_HOST].off;\n\t_port = url+u.field_data[UF_PORT].off;\n\t_path = url+u.field_data[UF_PATH].off;\n\t_userinfo = url+u.field_data[UF_USERINFO].off;\n\n\tif (u.field_set & (1 << UF_HOST)) {\n\t\t*host = git__substrdup(_host, u.field_data[UF_HOST].len);\n\t\tGITERR_CHECK_ALLOC(*host);\n\t}\n\n\tif (u.field_set & (1 << UF_PORT))\n\t\t*port = git__substrdup(_port, u.field_data[UF_PORT].len);\n\telse\n\t\t*port = git__strdup(default_port);\n\tGITERR_CHECK_ALLOC(*port);\n\n\tif (u.field_set & (1 << UF_PATH)) {\n\t\t*path = git__substrdup(_path, u.field_data[UF_PATH].len);\n\t\tGITERR_CHECK_ALLOC(*path);\n\t} else {\n\t\tgit__free(*port);\n\t\t*port = NULL;\n\t\tgit__free(*host);\n\t\t*host = NULL;\n\t\tgiterr_set(GITERR_NET, \"invalid url, missing path\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (u.field_set & (1 << UF_USERINFO)) {\n\t\tconst char *colon = memchr(_userinfo, ':', u.field_data[UF_USERINFO].len);\n\t\tif (colon) {\n\t\t\t*username = unescape(git__substrdup(_userinfo, colon - _userinfo));\n\t\t\t*password = unescape(git__substrdup(colon+1, u.field_data[UF_USERINFO].len - (colon+1-_userinfo)));\n\t\t\tGITERR_CHECK_ALLOC(*password);\n\t\t} else {\n\t\t\t*username = git__substrdup(_userinfo, u.field_data[UF_USERINFO].len);\n\t\t}\n\t\tGITERR_CHECK_ALLOC(*username);\n\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"global.h\"",
            "#include \"http_parser.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"netops.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nint gitno_extract_url_parts(\n\t\tchar **host,\n\t\tchar **port,\n\t\tchar **path,\n\t\tchar **username,\n\t\tchar **password,\n\t\tconst char *url,\n\t\tconst char *default_port)\n{\n\tstruct http_parser_url u = {0};\n\tconst char *_host, *_port, *_path, *_userinfo;\n\n\tif (http_parser_parse_url(url, strlen(url), false, &u)) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL '%s'\", url);\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\t_host = url+u.field_data[UF_HOST].off;\n\t_port = url+u.field_data[UF_PORT].off;\n\t_path = url+u.field_data[UF_PATH].off;\n\t_userinfo = url+u.field_data[UF_USERINFO].off;\n\n\tif (u.field_set & (1 << UF_HOST)) {\n\t\t*host = git__substrdup(_host, u.field_data[UF_HOST].len);\n\t\tGITERR_CHECK_ALLOC(*host);\n\t}\n\n\tif (u.field_set & (1 << UF_PORT))\n\t\t*port = git__substrdup(_port, u.field_data[UF_PORT].len);\n\telse\n\t\t*port = git__strdup(default_port);\n\tGITERR_CHECK_ALLOC(*port);\n\n\tif (u.field_set & (1 << UF_PATH)) {\n\t\t*path = git__substrdup(_path, u.field_data[UF_PATH].len);\n\t\tGITERR_CHECK_ALLOC(*path);\n\t} else {\n\t\tgit__free(*port);\n\t\t*port = NULL;\n\t\tgit__free(*host);\n\t\t*host = NULL;\n\t\tgiterr_set(GITERR_NET, \"invalid url, missing path\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif (u.field_set & (1 << UF_USERINFO)) {\n\t\tconst char *colon = memchr(_userinfo, ':', u.field_data[UF_USERINFO].len);\n\t\tif (colon) {\n\t\t\t*username = unescape(git__substrdup(_userinfo, colon - _userinfo));\n\t\t\t*password = unescape(git__substrdup(colon+1, u.field_data[UF_USERINFO].len - (colon+1-_userinfo)));\n\t\t\tGITERR_CHECK_ALLOC(*password);\n\t\t} else {\n\t\t\t*username = git__substrdup(_userinfo, u.field_data[UF_USERINFO].len);\n\t\t}\n\t\tGITERR_CHECK_ALLOC(*username);\n\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prefix_git"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__prefixcmp",
          "args": [
            "url",
            "prefix_git"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "git__prefixcmp_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "252-255",
          "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic const char prefix_git[] = \"git://\";\nstatic const char cmd_uploadpack[] = \"git-upload-pack\";\n\nstatic int _git_uploadpack_ls(\n\tgit_subtransport *t,\n\tconst char *url,\n\tgit_smart_subtransport_stream **stream)\n{\n\tchar *host=NULL, *port=NULL, *path=NULL, *user=NULL, *pass=NULL;\n\tconst char *stream_url = url;\n\tgit_proto_stream *s;\n\tint error;\n\n\t*stream = NULL;\n\n\tif (!git__prefixcmp(url, prefix_git))\n\t\tstream_url += strlen(prefix_git);\n\n\tif ((error = gitno_extract_url_parts(&host, &port, &path, &user, &pass, url, GIT_DEFAULT_PORT)) < 0)\n\t\treturn error;\n\n\terror = git_proto_stream_alloc(t, stream_url, cmd_uploadpack, host, port, stream);\n\n\tgit__free(host);\n\tgit__free(port);\n\tgit__free(path);\n\tgit__free(user);\n\tgit__free(pass);\n\n\n\tif (error < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\ts = (git_proto_stream *) *stream;\n\tif ((error = git_stream_connect(s->io)) < 0) {\n\t\tgit_proto_stream_free(*stream);\n\t\treturn error;\n\t}\n\n\tt->current_stream = s;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_proto_stream_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "150-186",
    "snippet": "static int git_proto_stream_alloc(\n\tgit_subtransport *t,\n\tconst char *url,\n\tconst char *cmd,\n\tconst char *host,\n\tconst char *port,\n\tgit_smart_subtransport_stream **stream)\n{\n\tgit_proto_stream *s;\n\n\tif (!stream)\n\t\treturn -1;\n\n\ts = git__calloc(1, sizeof(git_proto_stream));\n\tGITERR_CHECK_ALLOC(s);\n\n\ts->parent.subtransport = &t->parent;\n\ts->parent.read = git_proto_stream_read;\n\ts->parent.write = git_proto_stream_write;\n\ts->parent.free = git_proto_stream_free;\n\n\ts->cmd = cmd;\n\ts->url = git__strdup(url);\n\n\tif (!s->url) {\n\t\tgit__free(s);\n\t\treturn -1;\n\t}\n\n\tif ((git_socket_stream_new(&s->io, host, port)) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_VERSION(s->io, GIT_STREAM_VERSION, \"git_stream\");\n\n\t*stream = &s->parent;\n\treturn 0;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_VERSION",
          "args": [
            "s->io",
            "GIT_STREAM_VERSION",
            "\"git_stream\""
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_socket_stream_new",
          "args": [
            "&s->io",
            "host",
            "port"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "git_socket_stream_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "185-212",
          "snippet": "int git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "s"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "url"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "s"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_proto_stream)"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int git_proto_stream_alloc(\n\tgit_subtransport *t,\n\tconst char *url,\n\tconst char *cmd,\n\tconst char *host,\n\tconst char *port,\n\tgit_smart_subtransport_stream **stream)\n{\n\tgit_proto_stream *s;\n\n\tif (!stream)\n\t\treturn -1;\n\n\ts = git__calloc(1, sizeof(git_proto_stream));\n\tGITERR_CHECK_ALLOC(s);\n\n\ts->parent.subtransport = &t->parent;\n\ts->parent.read = git_proto_stream_read;\n\ts->parent.write = git_proto_stream_write;\n\ts->parent.free = git_proto_stream_free;\n\n\ts->cmd = cmd;\n\ts->url = git__strdup(url);\n\n\tif (!s->url) {\n\t\tgit__free(s);\n\t\treturn -1;\n\t}\n\n\tif ((git_socket_stream_new(&s->io, host, port)) < 0)\n\t\treturn -1;\n\n\tGITERR_CHECK_VERSION(s->io, GIT_STREAM_VERSION, \"git_stream\");\n\n\t*stream = &s->parent;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_proto_stream_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "131-148",
    "snippet": "static void git_proto_stream_free(git_smart_subtransport_stream *stream)\n{\n\tgit_proto_stream *s;\n\tgit_subtransport *t;\n\n\tif (!stream)\n\t\treturn;\n\n\ts = (git_proto_stream *)stream;\n\tt = OWNING_SUBTRANSPORT(s);\n\n\tt->current_stream = NULL;\n\n\tgit_stream_close(s->io);\n\tgit_stream_free(s->io);\n\tgit__free(s->url);\n\tgit__free(s);\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "s"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_stream_free",
          "args": [
            "s->io"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "63-69",
          "snippet": "GIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_stream_close",
          "args": [
            "s->io"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "58-61",
          "snippet": "GIT_INLINE(int) git_stream_close(git_stream *st)\n{\n\treturn st->close(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_close(git_stream *st)\n{\n\treturn st->close(st);\n}"
        }
      },
      {
        "call_info": {
          "callee": "OWNING_SUBTRANSPORT",
          "args": [
            "s"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic void git_proto_stream_free(git_smart_subtransport_stream *stream)\n{\n\tgit_proto_stream *s;\n\tgit_subtransport *t;\n\n\tif (!stream)\n\t\treturn;\n\n\ts = (git_proto_stream *)stream;\n\tt = OWNING_SUBTRANSPORT(s);\n\n\tt->current_stream = NULL;\n\n\tgit_stream_close(s->io);\n\tgit_stream_free(s->io);\n\tgit__free(s->url);\n\tgit__free(s);\n}"
  },
  {
    "function_name": "git_proto_stream_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "117-129",
    "snippet": "static int git_proto_stream_write(\n\tgit_smart_subtransport_stream *stream,\n\tconst char *buffer,\n\tsize_t len)\n{\n\tint error;\n\tgit_proto_stream *s = (git_proto_stream *)stream;\n\n\tif (!s->sent_command && (error = send_command(s)) < 0)\n\t\treturn error;\n\n\treturn git_stream_write(s->io, buffer, len, 0);\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_write",
          "args": [
            "s->io",
            "buffer",
            "len",
            "0"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "53-56",
          "snippet": "GIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "send_command",
          "args": [
            "s"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "send_command",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "74-90",
          "snippet": "static int send_command(git_proto_stream *s)\n{\n\tint error;\n\tgit_buf request = GIT_BUF_INIT;\n\n\terror = gen_proto(&request, s->cmd, s->url);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_stream_write(s->io, request.ptr, request.size, 0);\n\tif (error >= 0)\n\t\ts->sent_command = 1;\n\ncleanup:\n\tgit_buf_free(&request);\n\treturn error;\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int send_command(git_proto_stream *s)\n{\n\tint error;\n\tgit_buf request = GIT_BUF_INIT;\n\n\terror = gen_proto(&request, s->cmd, s->url);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_stream_write(s->io, request.ptr, request.size, 0);\n\tif (error >= 0)\n\t\ts->sent_command = 1;\n\ncleanup:\n\tgit_buf_free(&request);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int git_proto_stream_write(\n\tgit_smart_subtransport_stream *stream,\n\tconst char *buffer,\n\tsize_t len)\n{\n\tint error;\n\tgit_proto_stream *s = (git_proto_stream *)stream;\n\n\tif (!s->sent_command && (error = send_command(s)) < 0)\n\t\treturn error;\n\n\treturn git_stream_write(s->io, buffer, len, 0);\n}"
  },
  {
    "function_name": "git_proto_stream_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "92-115",
    "snippet": "static int git_proto_stream_read(\n\tgit_smart_subtransport_stream *stream,\n\tchar *buffer,\n\tsize_t buf_size,\n\tsize_t *bytes_read)\n{\n\tint error;\n\tgit_proto_stream *s = (git_proto_stream *)stream;\n\tgitno_buffer buf;\n\n\t*bytes_read = 0;\n\n\tif (!s->sent_command && (error = send_command(s)) < 0)\n\t\treturn error;\n\n\tgitno_buffer_setup_fromstream(s->io, &buf, buffer, buf_size);\n\n\tif ((error = gitno_recv(&buf)) < 0)\n\t\treturn error;\n\n\t*bytes_read = buf.offset;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gitno_recv",
          "args": [
            "&buf"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "gitno_recv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "18-21",
          "snippet": "int gitno_recv(gitno_buffer *buf)\n{\n\treturn buf->recv(buf);\n}",
          "includes": [
            "#include \"global.h\"",
            "#include \"http_parser.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"netops.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nint gitno_recv(gitno_buffer *buf)\n{\n\treturn buf->recv(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gitno_buffer_setup_fromstream",
          "args": [
            "s->io",
            "&buf",
            "buffer",
            "buf_size"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "gitno_buffer_setup_fromstream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/netops.c",
          "lines": "50-58",
          "snippet": "void gitno_buffer_setup_fromstream(git_stream *st, gitno_buffer *buf, char *data, size_t len)\n{\n\tmemset(data, 0x0, len);\n\tbuf->data = data;\n\tbuf->len = len;\n\tbuf->offset = 0;\n\tbuf->recv = recv_stream;\n\tbuf->cb_data = st;\n}",
          "includes": [
            "#include \"global.h\"",
            "#include \"http_parser.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"netops.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"global.h\"\n#include \"http_parser.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"netops.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n#include <ctype.h>\n\nvoid gitno_buffer_setup_fromstream(git_stream *st, gitno_buffer *buf, char *data, size_t len)\n{\n\tmemset(data, 0x0, len);\n\tbuf->data = data;\n\tbuf->len = len;\n\tbuf->offset = 0;\n\tbuf->recv = recv_stream;\n\tbuf->cb_data = st;\n}"
        }
      },
      {
        "call_info": {
          "callee": "send_command",
          "args": [
            "s"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "send_command",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "74-90",
          "snippet": "static int send_command(git_proto_stream *s)\n{\n\tint error;\n\tgit_buf request = GIT_BUF_INIT;\n\n\terror = gen_proto(&request, s->cmd, s->url);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_stream_write(s->io, request.ptr, request.size, 0);\n\tif (error >= 0)\n\t\ts->sent_command = 1;\n\ncleanup:\n\tgit_buf_free(&request);\n\treturn error;\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int send_command(git_proto_stream *s)\n{\n\tint error;\n\tgit_buf request = GIT_BUF_INIT;\n\n\terror = gen_proto(&request, s->cmd, s->url);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_stream_write(s->io, request.ptr, request.size, 0);\n\tif (error >= 0)\n\t\ts->sent_command = 1;\n\ncleanup:\n\tgit_buf_free(&request);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int git_proto_stream_read(\n\tgit_smart_subtransport_stream *stream,\n\tchar *buffer,\n\tsize_t buf_size,\n\tsize_t *bytes_read)\n{\n\tint error;\n\tgit_proto_stream *s = (git_proto_stream *)stream;\n\tgitno_buffer buf;\n\n\t*bytes_read = 0;\n\n\tif (!s->sent_command && (error = send_command(s)) < 0)\n\t\treturn error;\n\n\tgitno_buffer_setup_fromstream(s->io, &buf, buffer, buf_size);\n\n\tif ((error = gitno_recv(&buf)) < 0)\n\t\treturn error;\n\n\t*bytes_read = buf.offset;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "send_command",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "74-90",
    "snippet": "static int send_command(git_proto_stream *s)\n{\n\tint error;\n\tgit_buf request = GIT_BUF_INIT;\n\n\terror = gen_proto(&request, s->cmd, s->url);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_stream_write(s->io, request.ptr, request.size, 0);\n\tif (error >= 0)\n\t\ts->sent_command = 1;\n\ncleanup:\n\tgit_buf_free(&request);\n\treturn error;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&request"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_stream_write",
          "args": [
            "s->io",
            "request.ptr",
            "request.size",
            "0"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "53-56",
          "snippet": "GIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gen_proto",
          "args": [
            "&request",
            "s->cmd",
            "s->url"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "gen_proto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
          "lines": "40-72",
          "snippet": "static int gen_proto(git_buf *request, const char *cmd, const char *url)\n{\n\tchar *delim, *repo;\n\tchar host[] = \"host=\";\n\tsize_t len;\n\n\tdelim = strchr(url, '/');\n\tif (delim == NULL) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL\");\n\t\treturn -1;\n\t}\n\n\trepo = delim;\n\tif (repo[1] == '~')\n\t\t++repo;\n\n\tdelim = strchr(url, ':');\n\tif (delim == NULL)\n\t\tdelim = strchr(url, '/');\n\n\tlen = 4 + strlen(cmd) + 1 + strlen(repo) + 1 + strlen(host) + (delim - url) + 1;\n\n\tgit_buf_grow(request, len);\n\tgit_buf_printf(request, \"%04x%s %s%c%s\",\n\t\t(unsigned int)(len & 0x0FFFF), cmd, repo, 0, host);\n\tgit_buf_put(request, url, delim - url);\n\tgit_buf_putc(request, '\\0');\n\n\tif (git_buf_oom(request))\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"git2/sys/transport.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int gen_proto(git_buf *request, const char *cmd, const char *url)\n{\n\tchar *delim, *repo;\n\tchar host[] = \"host=\";\n\tsize_t len;\n\n\tdelim = strchr(url, '/');\n\tif (delim == NULL) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL\");\n\t\treturn -1;\n\t}\n\n\trepo = delim;\n\tif (repo[1] == '~')\n\t\t++repo;\n\n\tdelim = strchr(url, ':');\n\tif (delim == NULL)\n\t\tdelim = strchr(url, '/');\n\n\tlen = 4 + strlen(cmd) + 1 + strlen(repo) + 1 + strlen(host) + (delim - url) + 1;\n\n\tgit_buf_grow(request, len);\n\tgit_buf_printf(request, \"%04x%s %s%c%s\",\n\t\t(unsigned int)(len & 0x0FFFF), cmd, repo, 0, host);\n\tgit_buf_put(request, url, delim - url);\n\tgit_buf_putc(request, '\\0');\n\n\tif (git_buf_oom(request))\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int send_command(git_proto_stream *s)\n{\n\tint error;\n\tgit_buf request = GIT_BUF_INIT;\n\n\terror = gen_proto(&request, s->cmd, s->url);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_stream_write(s->io, request.ptr, request.size, 0);\n\tif (error >= 0)\n\t\ts->sent_command = 1;\n\ncleanup:\n\tgit_buf_free(&request);\n\treturn error;\n}"
  },
  {
    "function_name": "gen_proto",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/git.c",
    "lines": "40-72",
    "snippet": "static int gen_proto(git_buf *request, const char *cmd, const char *url)\n{\n\tchar *delim, *repo;\n\tchar host[] = \"host=\";\n\tsize_t len;\n\n\tdelim = strchr(url, '/');\n\tif (delim == NULL) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL\");\n\t\treturn -1;\n\t}\n\n\trepo = delim;\n\tif (repo[1] == '~')\n\t\t++repo;\n\n\tdelim = strchr(url, ':');\n\tif (delim == NULL)\n\t\tdelim = strchr(url, '/');\n\n\tlen = 4 + strlen(cmd) + 1 + strlen(repo) + 1 + strlen(host) + (delim - url) + 1;\n\n\tgit_buf_grow(request, len);\n\tgit_buf_printf(request, \"%04x%s %s%c%s\",\n\t\t(unsigned int)(len & 0x0FFFF), cmd, repo, 0, host);\n\tgit_buf_put(request, url, delim - url);\n\tgit_buf_putc(request, '\\0');\n\n\tif (git_buf_oom(request))\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"socket_stream.h\"",
      "#include \"stream.h\"",
      "#include \"git2/sys/transport.h\"",
      "#include \"netops.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "request"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "request",
            "'\\0'"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "request",
            "url",
            "delim - url"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "request",
            "\"%04x%s %s%c%s\"",
            "(unsigned int)(len & 0x0FFFF)",
            "cmd",
            "repo",
            "0",
            "host"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_grow",
          "args": [
            "request",
            "len"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_grow_by",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "106-116",
          "snippet": "int git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nint git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "host"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "repo"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "cmd"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "url",
            "'/'"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "url",
            "':'"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"Malformed URL\""
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "url",
            "'/'"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"git2/sys/transport.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int gen_proto(git_buf *request, const char *cmd, const char *url)\n{\n\tchar *delim, *repo;\n\tchar host[] = \"host=\";\n\tsize_t len;\n\n\tdelim = strchr(url, '/');\n\tif (delim == NULL) {\n\t\tgiterr_set(GITERR_NET, \"Malformed URL\");\n\t\treturn -1;\n\t}\n\n\trepo = delim;\n\tif (repo[1] == '~')\n\t\t++repo;\n\n\tdelim = strchr(url, ':');\n\tif (delim == NULL)\n\t\tdelim = strchr(url, '/');\n\n\tlen = 4 + strlen(cmd) + 1 + strlen(repo) + 1 + strlen(host) + (delim - url) + 1;\n\n\tgit_buf_grow(request, len);\n\tgit_buf_printf(request, \"%04x%s %s%c%s\",\n\t\t(unsigned int)(len & 0x0FFFF), cmd, repo, 0, host);\n\tgit_buf_put(request, url, delim - url);\n\tgit_buf_putc(request, '\\0');\n\n\tif (git_buf_oom(request))\n\t\treturn -1;\n\n\treturn 0;\n}"
  }
]