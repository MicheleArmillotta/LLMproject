[
  {
    "function_name": "git_patch_to_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "663-668",
    "snippet": "int git_patch_to_buf(git_buf *out, git_patch *patch)\n{\n\tassert(out && patch);\n\tgit_buf_sanitize(out);\n\treturn git_patch_print(patch, git_diff_print_callback__to_buf, out);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_patch_print",
          "args": [
            "patch",
            "git_diff_print_callback__to_buf",
            "out"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_print",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "594-620",
          "snippet": "int git_patch_print(\n\tgit_patch *patch,\n\tgit_diff_line_cb print_cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_buf temp = GIT_BUF_INIT;\n\tdiff_print_info pi;\n\n\tassert(patch && print_cb);\n\n\tif (!(error = diff_print_info_init_frompatch(\n\t\t\t&pi, &temp, patch,\n\t\t\tGIT_DIFF_FORMAT_PATCH, print_cb, payload)))\n\t{\n\t\terror = git_patch__invoke_callbacks(\n\t\t\tpatch, diff_print_patch_file, diff_print_patch_binary,\n\t\t\tdiff_print_patch_hunk, diff_print_patch_line, &pi);\n\n\t\tif (error) /* make sure error message is set */\n\t\t\tgiterr_set_after_callback_function(error, \"git_patch_print\");\n\t}\n\n\tgit_buf_free(&temp);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_patch_print(\n\tgit_patch *patch,\n\tgit_diff_line_cb print_cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_buf temp = GIT_BUF_INIT;\n\tdiff_print_info pi;\n\n\tassert(patch && print_cb);\n\n\tif (!(error = diff_print_info_init_frompatch(\n\t\t\t&pi, &temp, patch,\n\t\t\tGIT_DIFF_FORMAT_PATCH, print_cb, payload)))\n\t{\n\t\terror = git_patch__invoke_callbacks(\n\t\t\tpatch, diff_print_patch_file, diff_print_patch_binary,\n\t\t\tdiff_print_patch_hunk, diff_print_patch_line, &pi);\n\n\t\tif (error) /* make sure error message is set */\n\t\t\tgiterr_set_after_callback_function(error, \"git_patch_print\");\n\t}\n\n\tgit_buf_free(&temp);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "out"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && patch"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_patch_to_buf(git_buf *out, git_patch *patch)\n{\n\tassert(out && patch);\n\tgit_buf_sanitize(out);\n\treturn git_patch_print(patch, git_diff_print_callback__to_buf, out);\n}"
  },
  {
    "function_name": "git_diff_print_callback__to_file_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "644-660",
    "snippet": "int git_diff_print_callback__to_file_handle(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tconst git_diff_line *line,\n\tvoid *payload)\n{\n\tFILE *fp = payload ? payload : stdout;\n\n\tGIT_UNUSED(delta); GIT_UNUSED(hunk);\n\n\tif (line->origin == GIT_DIFF_LINE_CONTEXT ||\n\t\tline->origin == GIT_DIFF_LINE_ADDITION ||\n\t\tline->origin == GIT_DIFF_LINE_DELETION)\n\t\tfputc(line->origin, fp);\n\tfwrite(line->content, 1, line->content_len, fp);\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fwrite",
          "args": [
            "line->content",
            "1",
            "line->content_len",
            "fp"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputc",
          "args": [
            "line->origin",
            "fp"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "hunk"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "delta"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_diff_print_callback__to_file_handle(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tconst git_diff_line *line,\n\tvoid *payload)\n{\n\tFILE *fp = payload ? payload : stdout;\n\n\tGIT_UNUSED(delta); GIT_UNUSED(hunk);\n\n\tif (line->origin == GIT_DIFF_LINE_CONTEXT ||\n\t\tline->origin == GIT_DIFF_LINE_ADDITION ||\n\t\tline->origin == GIT_DIFF_LINE_DELETION)\n\t\tfputc(line->origin, fp);\n\tfwrite(line->content, 1, line->content_len, fp);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_diff_print_callback__to_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "622-642",
    "snippet": "int git_diff_print_callback__to_buf(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tconst git_diff_line *line,\n\tvoid *payload)\n{\n\tgit_buf *output = payload;\n\tGIT_UNUSED(delta); GIT_UNUSED(hunk);\n\n\tif (!output) {\n\t\tgiterr_set(GITERR_INVALID, \"Buffer pointer must be provided\");\n\t\treturn -1;\n\t}\n\n\tif (line->origin == GIT_DIFF_LINE_ADDITION ||\n\t\tline->origin == GIT_DIFF_LINE_DELETION ||\n\t\tline->origin == GIT_DIFF_LINE_CONTEXT)\n\t\tgit_buf_putc(output, line->origin);\n\n\treturn git_buf_put(output, line->content, line->content_len);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "output",
            "line->content",
            "line->content_len"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "output",
            "line->origin"
          ],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Buffer pointer must be provided\""
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "hunk"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "delta"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_diff_print_callback__to_buf(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tconst git_diff_line *line,\n\tvoid *payload)\n{\n\tgit_buf *output = payload;\n\tGIT_UNUSED(delta); GIT_UNUSED(hunk);\n\n\tif (!output) {\n\t\tgiterr_set(GITERR_INVALID, \"Buffer pointer must be provided\");\n\t\treturn -1;\n\t}\n\n\tif (line->origin == GIT_DIFF_LINE_ADDITION ||\n\t\tline->origin == GIT_DIFF_LINE_DELETION ||\n\t\tline->origin == GIT_DIFF_LINE_CONTEXT)\n\t\tgit_buf_putc(output, line->origin);\n\n\treturn git_buf_put(output, line->content, line->content_len);\n}"
  },
  {
    "function_name": "git_patch_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "594-620",
    "snippet": "int git_patch_print(\n\tgit_patch *patch,\n\tgit_diff_line_cb print_cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_buf temp = GIT_BUF_INIT;\n\tdiff_print_info pi;\n\n\tassert(patch && print_cb);\n\n\tif (!(error = diff_print_info_init_frompatch(\n\t\t\t&pi, &temp, patch,\n\t\t\tGIT_DIFF_FORMAT_PATCH, print_cb, payload)))\n\t{\n\t\terror = git_patch__invoke_callbacks(\n\t\t\tpatch, diff_print_patch_file, diff_print_patch_binary,\n\t\t\tdiff_print_patch_hunk, diff_print_patch_line, &pi);\n\n\t\tif (error) /* make sure error message is set */\n\t\t\tgiterr_set_after_callback_function(error, \"git_patch_print\");\n\t}\n\n\tgit_buf_free(&temp);\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&temp"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set_after_callback_function",
          "args": [
            "error",
            "\"git_patch_print\""
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_patch__invoke_callbacks",
          "args": [
            "patch",
            "diff_print_patch_file",
            "diff_print_patch_binary",
            "diff_print_patch_hunk",
            "diff_print_patch_line",
            "&pi"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch__invoke_callbacks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "966-1008",
          "snippet": "int git_patch__invoke_callbacks(\n\tgit_patch *patch,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb line_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tuint32_t i, j;\n\n\tif (file_cb)\n\t\terror = file_cb(patch->delta, 0, payload);\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (binary_cb)\n\t\t\terror = binary_cb(patch->delta, &patch->binary, payload);\n\n\t\treturn error;\n\t}\n\n\tif (!hunk_cb && !line_cb)\n\t\treturn error;\n\n\tfor (i = 0; !error && i < git_array_size(patch->hunks); ++i) {\n\t\tdiff_patch_hunk *h = git_array_get(patch->hunks, i);\n\n\t\tif (hunk_cb)\n\t\t\terror = hunk_cb(patch->delta, &h->hunk, payload);\n\n\t\tif (!line_cb)\n\t\t\tcontinue;\n\n\t\tfor (j = 0; !error && j < h->line_count; ++j) {\n\t\t\tgit_diff_line *l =\n\t\t\t\tgit_array_get(patch->lines, h->line_start + j);\n\n\t\t\terror = line_cb(patch->delta, &h->hunk, l, payload);\n\t\t}\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);",
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch__invoke_callbacks(\n\tgit_patch *patch,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb line_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tuint32_t i, j;\n\n\tif (file_cb)\n\t\terror = file_cb(patch->delta, 0, payload);\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (binary_cb)\n\t\t\terror = binary_cb(patch->delta, &patch->binary, payload);\n\n\t\treturn error;\n\t}\n\n\tif (!hunk_cb && !line_cb)\n\t\treturn error;\n\n\tfor (i = 0; !error && i < git_array_size(patch->hunks); ++i) {\n\t\tdiff_patch_hunk *h = git_array_get(patch->hunks, i);\n\n\t\tif (hunk_cb)\n\t\t\terror = hunk_cb(patch->delta, &h->hunk, payload);\n\n\t\tif (!line_cb)\n\t\t\tcontinue;\n\n\t\tfor (j = 0; !error && j < h->line_count; ++j) {\n\t\t\tgit_diff_line *l =\n\t\t\t\tgit_array_get(patch->lines, h->line_start + j);\n\n\t\t\terror = line_cb(patch->delta, &h->hunk, l, payload);\n\t\t}\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_print_info_init_frompatch",
          "args": [
            "&pi",
            "&temp",
            "patch",
            "GIT_DIFF_FORMAT_PATCH",
            "print_cb",
            "payload"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "diff_print_info_init_frompatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "87-113",
          "snippet": "static int diff_print_info_init_frompatch(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_patch *patch,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tgit_repository *repo;\n\n\tassert(patch);\n\n\trepo = patch->diff ? patch->diff->repo : NULL;\n\n\tmemset(pi, 0, sizeof(diff_print_info));\n\n\tpi->diff = patch->diff;\n\n\tpi->flags = patch->diff_opts.flags;\n\tpi->oid_strlen = patch->diff_opts.id_abbrev;\n\n\tpi->content_loaded = 1;\n\tpi->ofile = &patch->ofile;\n\tpi->nfile = &patch->nfile;\n\n\treturn diff_print_info_init__common(pi, out, repo, format, cb, payload);\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_info_init_frompatch(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_patch *patch,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tgit_repository *repo;\n\n\tassert(patch);\n\n\trepo = patch->diff ? patch->diff->repo : NULL;\n\n\tmemset(pi, 0, sizeof(diff_print_info));\n\n\tpi->diff = patch->diff;\n\n\tpi->flags = patch->diff_opts.flags;\n\tpi->oid_strlen = patch->diff_opts.id_abbrev;\n\n\tpi->content_loaded = 1;\n\tpi->ofile = &patch->ofile;\n\tpi->nfile = &patch->nfile;\n\n\treturn diff_print_info_init__common(pi, out, repo, format, cb, payload);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "patch && print_cb"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_patch_print(\n\tgit_patch *patch,\n\tgit_diff_line_cb print_cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_buf temp = GIT_BUF_INIT;\n\tdiff_print_info pi;\n\n\tassert(patch && print_cb);\n\n\tif (!(error = diff_print_info_init_frompatch(\n\t\t\t&pi, &temp, patch,\n\t\t\tGIT_DIFF_FORMAT_PATCH, print_cb, payload)))\n\t{\n\t\terror = git_patch__invoke_callbacks(\n\t\t\tpatch, diff_print_patch_file, diff_print_patch_binary,\n\t\t\tdiff_print_patch_hunk, diff_print_patch_line, &pi);\n\n\t\tif (error) /* make sure error message is set */\n\t\t\tgiterr_set_after_callback_function(error, \"git_patch_print\");\n\t}\n\n\tgit_buf_free(&temp);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_diff_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "538-591",
    "snippet": "int git_diff_print(\n\tgit_diff *diff,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb print_cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_buf buf = GIT_BUF_INIT;\n\tdiff_print_info pi;\n\tgit_diff_file_cb print_file = NULL;\n\tgit_diff_binary_cb print_binary = NULL;\n\tgit_diff_hunk_cb print_hunk = NULL;\n\tgit_diff_line_cb print_line = NULL;\n\n\tswitch (format) {\n\tcase GIT_DIFF_FORMAT_PATCH:\n\t\tprint_file = diff_print_patch_file;\n\t\tprint_binary = diff_print_patch_binary;\n\t\tprint_hunk = diff_print_patch_hunk;\n\t\tprint_line = diff_print_patch_line;\n\t\tbreak;\n\tcase GIT_DIFF_FORMAT_PATCH_HEADER:\n\t\tprint_file = diff_print_patch_file;\n\t\tbreak;\n\tcase GIT_DIFF_FORMAT_RAW:\n\t\tprint_file = diff_print_one_raw;\n\t\tbreak;\n\tcase GIT_DIFF_FORMAT_NAME_ONLY:\n\t\tprint_file = diff_print_one_name_only;\n\t\tbreak;\n\tcase GIT_DIFF_FORMAT_NAME_STATUS:\n\t\tprint_file = diff_print_one_name_status;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Unknown diff output format (%d)\", format);\n\t\treturn -1;\n\t}\n\n\tif (!(error = diff_print_info_init_fromdiff(\n\t\t\t&pi, &buf, diff, format, print_cb, payload))) {\n\t\terror = git_diff_foreach(\n\t\t\tdiff, print_file, print_binary, print_hunk, print_line, &pi);\n\n\t\tif (error) /* make sure error message is set */\n\t\t\tgiterr_set_after_callback_function(error, \"git_diff_print\");\n\t}\n\n\tgit__free(pi.nfile);\n\tgit__free(pi.ofile);\n\n\tgit_buf_free(&buf);\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "pi.ofile"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set_after_callback_function",
          "args": [
            "error",
            "\"git_diff_print\""
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_foreach",
          "args": [
            "diff",
            "print_file",
            "print_binary",
            "print_hunk",
            "print_line",
            "&pi"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_foreach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "404-450",
          "snippet": "int git_diff_foreach(\n\tgit_diff *diff,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tgit_xdiff_output xo;\n\tsize_t idx;\n\tgit_patch patch;\n\n\tif ((error = diff_required(diff, \"git_diff_foreach\")) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tmemset(&patch, 0, sizeof(patch));\n\tdiff_output_init(\n\t\t&xo.output, &diff->opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, &diff->opts);\n\n\tgit_vector_foreach(&diff->deltas, idx, patch.delta) {\n\n\t\t/* check flags against patch status */\n\t\tif (git_diff_delta__should_skip(&diff->opts, patch.delta))\n\t\t\tcontinue;\n\n\t\tif (binary_cb || hunk_cb || data_cb) {\n\t\t\tif ((error = diff_patch_init_from_diff(&patch, diff, idx)) != 0 ||\n\t\t\t\t(error = diff_patch_load(&patch, &xo.output)) != 0)\n\t\t\t\treturn error;\n\t\t}\n\n\t\tif ((error = diff_patch_invoke_file_callback(&patch, &xo.output)) == 0) {\n\t\t\tif (binary_cb || hunk_cb || data_cb)\n\t\t\t\t\terror = diff_patch_generate(&patch, &xo.output);\n\t\t}\n\n\t\tgit_patch_free(&patch);\n\n\t\tif (error)\n\t\t\tbreak;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);",
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_diff_foreach(\n\tgit_diff *diff,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tgit_xdiff_output xo;\n\tsize_t idx;\n\tgit_patch patch;\n\n\tif ((error = diff_required(diff, \"git_diff_foreach\")) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tmemset(&patch, 0, sizeof(patch));\n\tdiff_output_init(\n\t\t&xo.output, &diff->opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, &diff->opts);\n\n\tgit_vector_foreach(&diff->deltas, idx, patch.delta) {\n\n\t\t/* check flags against patch status */\n\t\tif (git_diff_delta__should_skip(&diff->opts, patch.delta))\n\t\t\tcontinue;\n\n\t\tif (binary_cb || hunk_cb || data_cb) {\n\t\t\tif ((error = diff_patch_init_from_diff(&patch, diff, idx)) != 0 ||\n\t\t\t\t(error = diff_patch_load(&patch, &xo.output)) != 0)\n\t\t\t\treturn error;\n\t\t}\n\n\t\tif ((error = diff_patch_invoke_file_callback(&patch, &xo.output)) == 0) {\n\t\t\tif (binary_cb || hunk_cb || data_cb)\n\t\t\t\t\terror = diff_patch_generate(&patch, &xo.output);\n\t\t}\n\n\t\tgit_patch_free(&patch);\n\n\t\tif (error)\n\t\t\tbreak;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_print_info_init_fromdiff",
          "args": [
            "&pi",
            "&buf",
            "diff",
            "format",
            "print_cb",
            "payload"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "diff_print_info_init_fromdiff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "65-85",
          "snippet": "static int diff_print_info_init_fromdiff(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_diff *diff,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tgit_repository *repo = diff ? diff->repo : NULL;\n\n\tmemset(pi, 0, sizeof(diff_print_info));\n\n\tpi->diff = diff;\n\n\tif (diff) {\n\t\tpi->flags = diff->opts.flags;\n\t\tpi->oid_strlen = diff->opts.id_abbrev;\n\t}\n\n\treturn diff_print_info_init__common(pi, out, repo, format, cb, payload);\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_info_init_fromdiff(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_diff *diff,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tgit_repository *repo = diff ? diff->repo : NULL;\n\n\tmemset(pi, 0, sizeof(diff_print_info));\n\n\tpi->diff = diff;\n\n\tif (diff) {\n\t\tpi->flags = diff->opts.flags;\n\t\tpi->oid_strlen = diff->opts.id_abbrev;\n\t}\n\n\treturn diff_print_info_init__common(pi, out, repo, format, cb, payload);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Unknown diff output format (%d)\"",
            "format"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_diff_print(\n\tgit_diff *diff,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb print_cb,\n\tvoid *payload)\n{\n\tint error;\n\tgit_buf buf = GIT_BUF_INIT;\n\tdiff_print_info pi;\n\tgit_diff_file_cb print_file = NULL;\n\tgit_diff_binary_cb print_binary = NULL;\n\tgit_diff_hunk_cb print_hunk = NULL;\n\tgit_diff_line_cb print_line = NULL;\n\n\tswitch (format) {\n\tcase GIT_DIFF_FORMAT_PATCH:\n\t\tprint_file = diff_print_patch_file;\n\t\tprint_binary = diff_print_patch_binary;\n\t\tprint_hunk = diff_print_patch_hunk;\n\t\tprint_line = diff_print_patch_line;\n\t\tbreak;\n\tcase GIT_DIFF_FORMAT_PATCH_HEADER:\n\t\tprint_file = diff_print_patch_file;\n\t\tbreak;\n\tcase GIT_DIFF_FORMAT_RAW:\n\t\tprint_file = diff_print_one_raw;\n\t\tbreak;\n\tcase GIT_DIFF_FORMAT_NAME_ONLY:\n\t\tprint_file = diff_print_one_name_only;\n\t\tbreak;\n\tcase GIT_DIFF_FORMAT_NAME_STATUS:\n\t\tprint_file = diff_print_one_name_status;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Unknown diff output format (%d)\", format);\n\t\treturn -1;\n\t}\n\n\tif (!(error = diff_print_info_init_fromdiff(\n\t\t\t&pi, &buf, diff, format, print_cb, payload))) {\n\t\terror = git_diff_foreach(\n\t\t\tdiff, print_file, print_binary, print_hunk, print_line, &pi);\n\n\t\tif (error) /* make sure error message is set */\n\t\t\tgiterr_set_after_callback_function(error, \"git_diff_print\");\n\t}\n\n\tgit__free(pi.nfile);\n\tgit__free(pi.ofile);\n\n\tgit_buf_free(&buf);\n\n\treturn error;\n}"
  },
  {
    "function_name": "diff_print_patch_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "523-535",
    "snippet": "static int diff_print_patch_line(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tconst git_diff_line *line,\n\tvoid *data)\n{\n\tdiff_print_info *pi = data;\n\n\tif (S_ISDIR(delta->new_file.mode))\n\t\treturn 0;\n\n\treturn pi->print_cb(delta, hunk, line, pi->payload);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi->print_cb",
          "args": [
            "delta",
            "hunk",
            "line",
            "pi->payload"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "delta->new_file.mode"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_patch_line(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk,\n\tconst git_diff_line *line,\n\tvoid *data)\n{\n\tdiff_print_info *pi = data;\n\n\tif (S_ISDIR(delta->new_file.mode))\n\t\treturn 0;\n\n\treturn pi->print_cb(delta, hunk, line, pi->payload);\n}"
  },
  {
    "function_name": "diff_print_patch_hunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "506-521",
    "snippet": "static int diff_print_patch_hunk(\n\tconst git_diff_delta *d,\n\tconst git_diff_hunk *h,\n\tvoid *data)\n{\n\tdiff_print_info *pi = data;\n\n\tif (S_ISDIR(d->new_file.mode))\n\t\treturn 0;\n\n\tpi->line.origin      = GIT_DIFF_LINE_HUNK_HDR;\n\tpi->line.content     = h->header;\n\tpi->line.content_len = h->header_len;\n\n\treturn pi->print_cb(d, h, &pi->line, pi->payload);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi->print_cb",
          "args": [
            "d",
            "h",
            "&pi->line",
            "pi->payload"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "d->new_file.mode"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_patch_hunk(\n\tconst git_diff_delta *d,\n\tconst git_diff_hunk *h,\n\tvoid *data)\n{\n\tdiff_print_info *pi = data;\n\n\tif (S_ISDIR(d->new_file.mode))\n\t\treturn 0;\n\n\tpi->line.origin      = GIT_DIFF_LINE_HUNK_HDR;\n\tpi->line.content     = h->header;\n\tpi->line.content_len = h->header_len;\n\n\treturn pi->print_cb(d, h, &pi->line, pi->payload);\n}"
  },
  {
    "function_name": "diff_print_patch_binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "481-504",
    "snippet": "static int diff_print_patch_binary(\n\tconst git_diff_delta *delta,\n\tconst git_diff_binary *binary,\n\tvoid *data)\n{\n\tdiff_print_info *pi = data;\n\tconst char *old_pfx =\n\t\tpi->diff ? pi->diff->opts.old_prefix : DIFF_OLD_PREFIX_DEFAULT;\n\tconst char *new_pfx =\n\t\tpi->diff ? pi->diff->opts.new_prefix : DIFF_NEW_PREFIX_DEFAULT;\n\tint error;\n\n\tgit_buf_clear(pi->buf);\n\n\tif ((error = diff_print_patch_file_binary(\n\t\tpi, (git_diff_delta *)delta, old_pfx, new_pfx, binary)) < 0)\n\t\treturn error;\n\n\tpi->line.origin = GIT_DIFF_LINE_BINARY;\n\tpi->line.content = git_buf_cstr(pi->buf);\n\tpi->line.content_len = git_buf_len(pi->buf);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi->print_cb",
          "args": [
            "delta",
            "NULL",
            "&pi->line",
            "pi->payload"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "pi->buf"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "pi->buf"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_print_patch_file_binary",
          "args": [
            "pi",
            "(git_diff_delta *)delta",
            "old_pfx",
            "new_pfx",
            "binary"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "diff_print_patch_file_binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "403-442",
          "snippet": "static int diff_print_patch_file_binary(\n\tdiff_print_info *pi, git_diff_delta *delta,\n\tconst char *old_pfx, const char *new_pfx,\n\tconst git_diff_binary *binary)\n{\n\tsize_t pre_binary_size;\n\tint error;\n\n\tif ((pi->flags & GIT_DIFF_SHOW_BINARY) == 0)\n\t\tgoto noshow;\n\n\tif (!pi->content_loaded &&\n\t\t(error = diff_print_load_content(pi, delta)) < 0)\n\t\treturn error;\n\n\tpre_binary_size = pi->buf->size;\n\tgit_buf_printf(pi->buf, \"GIT binary patch\\n\");\n\tpi->line.num_lines++;\n\n\tif ((error = format_binary(pi, binary->new_file.type, binary->new_file.data,\n\t\tbinary->new_file.datalen, binary->new_file.inflatedlen)) < 0 ||\n\t\t(error = format_binary(pi, binary->old_file.type, binary->old_file.data,\n\t\t\tbinary->old_file.datalen, binary->old_file.inflatedlen)) < 0) {\n\n\t\tif (error == GIT_EBUFS) {\n\t\t\tgiterr_clear();\n\t\t\tgit_buf_truncate(pi->buf, pre_binary_size);\n\t\t\tgoto noshow;\n\t\t}\n\t}\n\n\tpi->line.num_lines++;\n\treturn error;\n\nnoshow:\n\tpi->line.num_lines = 1;\n\treturn diff_delta_format_with_paths(\n\t\tpi->buf, delta, old_pfx, new_pfx,\n\t\t\"Binary files %s%s and %s%s differ\\n\");\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_patch_file_binary(\n\tdiff_print_info *pi, git_diff_delta *delta,\n\tconst char *old_pfx, const char *new_pfx,\n\tconst git_diff_binary *binary)\n{\n\tsize_t pre_binary_size;\n\tint error;\n\n\tif ((pi->flags & GIT_DIFF_SHOW_BINARY) == 0)\n\t\tgoto noshow;\n\n\tif (!pi->content_loaded &&\n\t\t(error = diff_print_load_content(pi, delta)) < 0)\n\t\treturn error;\n\n\tpre_binary_size = pi->buf->size;\n\tgit_buf_printf(pi->buf, \"GIT binary patch\\n\");\n\tpi->line.num_lines++;\n\n\tif ((error = format_binary(pi, binary->new_file.type, binary->new_file.data,\n\t\tbinary->new_file.datalen, binary->new_file.inflatedlen)) < 0 ||\n\t\t(error = format_binary(pi, binary->old_file.type, binary->old_file.data,\n\t\t\tbinary->old_file.datalen, binary->old_file.inflatedlen)) < 0) {\n\n\t\tif (error == GIT_EBUFS) {\n\t\t\tgiterr_clear();\n\t\t\tgit_buf_truncate(pi->buf, pre_binary_size);\n\t\t\tgoto noshow;\n\t\t}\n\t}\n\n\tpi->line.num_lines++;\n\treturn error;\n\nnoshow:\n\tpi->line.num_lines = 1;\n\treturn diff_delta_format_with_paths(\n\t\tpi->buf, delta, old_pfx, new_pfx,\n\t\t\"Binary files %s%s and %s%s differ\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "pi->buf"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_patch_binary(\n\tconst git_diff_delta *delta,\n\tconst git_diff_binary *binary,\n\tvoid *data)\n{\n\tdiff_print_info *pi = data;\n\tconst char *old_pfx =\n\t\tpi->diff ? pi->diff->opts.old_prefix : DIFF_OLD_PREFIX_DEFAULT;\n\tconst char *new_pfx =\n\t\tpi->diff ? pi->diff->opts.new_prefix : DIFF_NEW_PREFIX_DEFAULT;\n\tint error;\n\n\tgit_buf_clear(pi->buf);\n\n\tif ((error = diff_print_patch_file_binary(\n\t\tpi, (git_diff_delta *)delta, old_pfx, new_pfx, binary)) < 0)\n\t\treturn error;\n\n\tpi->line.origin = GIT_DIFF_LINE_BINARY;\n\tpi->line.content = git_buf_cstr(pi->buf);\n\tpi->line.content_len = git_buf_len(pi->buf);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}"
  },
  {
    "function_name": "diff_print_patch_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "444-479",
    "snippet": "static int diff_print_patch_file(\n\tconst git_diff_delta *delta, float progress, void *data)\n{\n\tint error;\n\tdiff_print_info *pi = data;\n\tconst char *oldpfx =\n\t\tpi->diff ? pi->diff->opts.old_prefix : DIFF_OLD_PREFIX_DEFAULT;\n\tconst char *newpfx =\n\t\tpi->diff ? pi->diff->opts.new_prefix : DIFF_NEW_PREFIX_DEFAULT;\n\n\tbool binary = (delta->flags & GIT_DIFF_FLAG_BINARY) ||\n\t\t(pi->flags & GIT_DIFF_FORCE_BINARY);\n\tbool show_binary = !!(pi->flags & GIT_DIFF_SHOW_BINARY);\n\tint oid_strlen = binary && show_binary ?\n\t\tGIT_OID_HEXSZ + 1 : pi->oid_strlen;\n\n\tGIT_UNUSED(progress);\n\n\tif (S_ISDIR(delta->new_file.mode) ||\n\t\tdelta->status == GIT_DELTA_UNMODIFIED ||\n\t\tdelta->status == GIT_DELTA_IGNORED ||\n\t\tdelta->status == GIT_DELTA_UNREADABLE ||\n\t\t(delta->status == GIT_DELTA_UNTRACKED &&\n\t\t (pi->flags & GIT_DIFF_SHOW_UNTRACKED_CONTENT) == 0))\n\t\treturn 0;\n\n\tif ((error = git_diff_delta__format_file_header(\n\t\t\tpi->buf, delta, oldpfx, newpfx, oid_strlen)) < 0)\n\t\treturn error;\n\n\tpi->line.origin      = GIT_DIFF_LINE_FILE_HDR;\n\tpi->line.content     = git_buf_cstr(pi->buf);\n\tpi->line.content_len = git_buf_len(pi->buf);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi->print_cb",
          "args": [
            "delta",
            "NULL",
            "&pi->line",
            "pi->payload"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "pi->buf"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "pi->buf"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_delta__format_file_header",
          "args": [
            "pi->buf",
            "delta",
            "oldpfx",
            "newpfx",
            "oid_strlen"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_delta__format_file_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "304-330",
          "snippet": "int git_diff_delta__format_file_header(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tint oid_strlen)\n{\n\tif (!oldpfx)\n\t\toldpfx = DIFF_OLD_PREFIX_DEFAULT;\n\tif (!newpfx)\n\t\tnewpfx = DIFF_NEW_PREFIX_DEFAULT;\n\tif (!oid_strlen)\n\t\toid_strlen = GIT_ABBREV_DEFAULT + 1;\n\n\tgit_buf_clear(out);\n\n\tgit_buf_printf(out, \"diff --git %s%s %s%s\\n\",\n\t\toldpfx, delta->old_file.path, newpfx, delta->new_file.path);\n\n\tGITERR_CHECK_ERROR(diff_print_oid_range(out, delta, oid_strlen));\n\n\tif ((delta->flags & GIT_DIFF_FLAG_BINARY) == 0)\n\t\tdiff_delta_format_with_paths(\n\t\t\tout, delta, oldpfx, newpfx, \"--- %s%s\\n+++ %s%s\\n\");\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_diff_delta__format_file_header(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tint oid_strlen)\n{\n\tif (!oldpfx)\n\t\toldpfx = DIFF_OLD_PREFIX_DEFAULT;\n\tif (!newpfx)\n\t\tnewpfx = DIFF_NEW_PREFIX_DEFAULT;\n\tif (!oid_strlen)\n\t\toid_strlen = GIT_ABBREV_DEFAULT + 1;\n\n\tgit_buf_clear(out);\n\n\tgit_buf_printf(out, \"diff --git %s%s %s%s\\n\",\n\t\toldpfx, delta->old_file.path, newpfx, delta->new_file.path);\n\n\tGITERR_CHECK_ERROR(diff_print_oid_range(out, delta, oid_strlen));\n\n\tif ((delta->flags & GIT_DIFF_FLAG_BINARY) == 0)\n\t\tdiff_delta_format_with_paths(\n\t\t\tout, delta, oldpfx, newpfx, \"--- %s%s\\n+++ %s%s\\n\");\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "delta->new_file.mode"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "progress"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_patch_file(\n\tconst git_diff_delta *delta, float progress, void *data)\n{\n\tint error;\n\tdiff_print_info *pi = data;\n\tconst char *oldpfx =\n\t\tpi->diff ? pi->diff->opts.old_prefix : DIFF_OLD_PREFIX_DEFAULT;\n\tconst char *newpfx =\n\t\tpi->diff ? pi->diff->opts.new_prefix : DIFF_NEW_PREFIX_DEFAULT;\n\n\tbool binary = (delta->flags & GIT_DIFF_FLAG_BINARY) ||\n\t\t(pi->flags & GIT_DIFF_FORCE_BINARY);\n\tbool show_binary = !!(pi->flags & GIT_DIFF_SHOW_BINARY);\n\tint oid_strlen = binary && show_binary ?\n\t\tGIT_OID_HEXSZ + 1 : pi->oid_strlen;\n\n\tGIT_UNUSED(progress);\n\n\tif (S_ISDIR(delta->new_file.mode) ||\n\t\tdelta->status == GIT_DELTA_UNMODIFIED ||\n\t\tdelta->status == GIT_DELTA_IGNORED ||\n\t\tdelta->status == GIT_DELTA_UNREADABLE ||\n\t\t(delta->status == GIT_DELTA_UNTRACKED &&\n\t\t (pi->flags & GIT_DIFF_SHOW_UNTRACKED_CONTENT) == 0))\n\t\treturn 0;\n\n\tif ((error = git_diff_delta__format_file_header(\n\t\t\tpi->buf, delta, oldpfx, newpfx, oid_strlen)) < 0)\n\t\treturn error;\n\n\tpi->line.origin      = GIT_DIFF_LINE_FILE_HDR;\n\tpi->line.content     = git_buf_cstr(pi->buf);\n\tpi->line.content_len = git_buf_len(pi->buf);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}"
  },
  {
    "function_name": "diff_print_patch_file_binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "403-442",
    "snippet": "static int diff_print_patch_file_binary(\n\tdiff_print_info *pi, git_diff_delta *delta,\n\tconst char *old_pfx, const char *new_pfx,\n\tconst git_diff_binary *binary)\n{\n\tsize_t pre_binary_size;\n\tint error;\n\n\tif ((pi->flags & GIT_DIFF_SHOW_BINARY) == 0)\n\t\tgoto noshow;\n\n\tif (!pi->content_loaded &&\n\t\t(error = diff_print_load_content(pi, delta)) < 0)\n\t\treturn error;\n\n\tpre_binary_size = pi->buf->size;\n\tgit_buf_printf(pi->buf, \"GIT binary patch\\n\");\n\tpi->line.num_lines++;\n\n\tif ((error = format_binary(pi, binary->new_file.type, binary->new_file.data,\n\t\tbinary->new_file.datalen, binary->new_file.inflatedlen)) < 0 ||\n\t\t(error = format_binary(pi, binary->old_file.type, binary->old_file.data,\n\t\t\tbinary->old_file.datalen, binary->old_file.inflatedlen)) < 0) {\n\n\t\tif (error == GIT_EBUFS) {\n\t\t\tgiterr_clear();\n\t\t\tgit_buf_truncate(pi->buf, pre_binary_size);\n\t\t\tgoto noshow;\n\t\t}\n\t}\n\n\tpi->line.num_lines++;\n\treturn error;\n\nnoshow:\n\tpi->line.num_lines = 1;\n\treturn diff_delta_format_with_paths(\n\t\tpi->buf, delta, old_pfx, new_pfx,\n\t\t\"Binary files %s%s and %s%s differ\\n\");\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_delta_format_with_paths",
          "args": [
            "pi->buf",
            "delta",
            "old_pfx",
            "new_pfx",
            "\"Binary files %s%s and %s%s differ\\n\""
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "diff_delta_format_with_paths",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "282-302",
          "snippet": "static int diff_delta_format_with_paths(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tconst char *template)\n{\n\tconst char *oldpath = delta->old_file.path;\n\tconst char *newpath = delta->new_file.path;\n\n\tif (git_oid_iszero(&delta->old_file.id)) {\n\t\toldpfx = \"\";\n\t\toldpath = \"/dev/null\";\n\t}\n\tif (git_oid_iszero(&delta->new_file.id)) {\n\t\tnewpfx = \"\";\n\t\tnewpath = \"/dev/null\";\n\t}\n\n\treturn git_buf_printf(out, template, oldpfx, oldpath, newpfx, newpath);\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_delta_format_with_paths(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tconst char *template)\n{\n\tconst char *oldpath = delta->old_file.path;\n\tconst char *newpath = delta->new_file.path;\n\n\tif (git_oid_iszero(&delta->old_file.id)) {\n\t\toldpfx = \"\";\n\t\toldpath = \"/dev/null\";\n\t}\n\tif (git_oid_iszero(&delta->new_file.id)) {\n\t\tnewpfx = \"\";\n\t\tnewpath = \"/dev/null\";\n\t}\n\n\treturn git_buf_printf(out, template, oldpfx, oldpath, newpfx, newpath);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_truncate",
          "args": [
            "pi->buf",
            "pre_binary_size"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "446-454",
          "snippet": "void git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "format_binary",
          "args": [
            "pi",
            "binary->old_file.type",
            "binary->old_file.data",
            "binary->old_file.datalen",
            "binary->old_file.inflatedlen"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "format_binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "332-368",
          "snippet": "static int format_binary(\n\tdiff_print_info *pi,\n\tgit_diff_binary_t type,\n\tconst char *data,\n\tsize_t datalen,\n\tsize_t inflatedlen)\n{\n\tconst char *typename = type == GIT_DIFF_BINARY_DELTA ?\n\t\t\"delta\" : \"literal\";\n\tconst char *scan, *end;\n\n\tgit_buf_printf(pi->buf, \"%s %\" PRIuZ \"\\n\", typename, inflatedlen);\n\tpi->line.num_lines++;\n\n\tfor (scan = data, end = data + datalen; scan < end; ) {\n\t\tsize_t chunk_len = end - scan;\n\t\tif (chunk_len > 52)\n\t\t\tchunk_len = 52;\n\n\t\tif (chunk_len <= 26)\n\t\t\tgit_buf_putc(pi->buf, (char)chunk_len + 'A' - 1);\n\t\telse\n\t\t\tgit_buf_putc(pi->buf, (char)chunk_len - 26 + 'a' - 1);\n\n\t\tgit_buf_encode_base85(pi->buf, scan, chunk_len);\n\t\tgit_buf_putc(pi->buf, '\\n');\n\n\t\tif (git_buf_oom(pi->buf))\n\t\t\treturn -1;\n\n\t\tscan += chunk_len;\n\t\tpi->line.num_lines++;\n\t}\n\tgit_buf_putc(pi->buf, '\\n');\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int format_binary(\n\tdiff_print_info *pi,\n\tgit_diff_binary_t type,\n\tconst char *data,\n\tsize_t datalen,\n\tsize_t inflatedlen)\n{\n\tconst char *typename = type == GIT_DIFF_BINARY_DELTA ?\n\t\t\"delta\" : \"literal\";\n\tconst char *scan, *end;\n\n\tgit_buf_printf(pi->buf, \"%s %\" PRIuZ \"\\n\", typename, inflatedlen);\n\tpi->line.num_lines++;\n\n\tfor (scan = data, end = data + datalen; scan < end; ) {\n\t\tsize_t chunk_len = end - scan;\n\t\tif (chunk_len > 52)\n\t\t\tchunk_len = 52;\n\n\t\tif (chunk_len <= 26)\n\t\t\tgit_buf_putc(pi->buf, (char)chunk_len + 'A' - 1);\n\t\telse\n\t\t\tgit_buf_putc(pi->buf, (char)chunk_len - 26 + 'a' - 1);\n\n\t\tgit_buf_encode_base85(pi->buf, scan, chunk_len);\n\t\tgit_buf_putc(pi->buf, '\\n');\n\n\t\tif (git_buf_oom(pi->buf))\n\t\t\treturn -1;\n\n\t\tscan += chunk_len;\n\t\tpi->line.num_lines++;\n\t}\n\tgit_buf_putc(pi->buf, '\\n');\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "pi->buf",
            "\"GIT binary patch\\n\""
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_print_load_content",
          "args": [
            "pi",
            "delta"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "diff_print_load_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "370-401",
          "snippet": "static int diff_print_load_content(\n\tdiff_print_info *pi,\n\tgit_diff_delta *delta)\n{\n\tgit_diff_file_content *ofile, *nfile;\n\tint error;\n\n\tassert(pi->diff);\n\n\tofile = git__calloc(1, sizeof(git_diff_file_content));\n\tnfile = git__calloc(1, sizeof(git_diff_file_content));\n\n\tGITERR_CHECK_ALLOC(ofile);\n\tGITERR_CHECK_ALLOC(nfile);\n\n\tif ((error = git_diff_file_content__init_from_diff(\n\t\t\tofile, pi->diff, delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\tnfile, pi->diff, delta, true)) < 0) {\n\n\t\tgit__free(ofile);\n\t\tgit__free(nfile);\n\t\treturn error;\n\t}\n\n\tpi->content_loaded = 1;\n\tpi->content_allocated = 1;\n\tpi->ofile = ofile;\n\tpi->nfile = nfile;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_load_content(\n\tdiff_print_info *pi,\n\tgit_diff_delta *delta)\n{\n\tgit_diff_file_content *ofile, *nfile;\n\tint error;\n\n\tassert(pi->diff);\n\n\tofile = git__calloc(1, sizeof(git_diff_file_content));\n\tnfile = git__calloc(1, sizeof(git_diff_file_content));\n\n\tGITERR_CHECK_ALLOC(ofile);\n\tGITERR_CHECK_ALLOC(nfile);\n\n\tif ((error = git_diff_file_content__init_from_diff(\n\t\t\tofile, pi->diff, delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\tnfile, pi->diff, delta, true)) < 0) {\n\n\t\tgit__free(ofile);\n\t\tgit__free(nfile);\n\t\treturn error;\n\t}\n\n\tpi->content_loaded = 1;\n\tpi->content_allocated = 1;\n\tpi->ofile = ofile;\n\tpi->nfile = nfile;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_patch_file_binary(\n\tdiff_print_info *pi, git_diff_delta *delta,\n\tconst char *old_pfx, const char *new_pfx,\n\tconst git_diff_binary *binary)\n{\n\tsize_t pre_binary_size;\n\tint error;\n\n\tif ((pi->flags & GIT_DIFF_SHOW_BINARY) == 0)\n\t\tgoto noshow;\n\n\tif (!pi->content_loaded &&\n\t\t(error = diff_print_load_content(pi, delta)) < 0)\n\t\treturn error;\n\n\tpre_binary_size = pi->buf->size;\n\tgit_buf_printf(pi->buf, \"GIT binary patch\\n\");\n\tpi->line.num_lines++;\n\n\tif ((error = format_binary(pi, binary->new_file.type, binary->new_file.data,\n\t\tbinary->new_file.datalen, binary->new_file.inflatedlen)) < 0 ||\n\t\t(error = format_binary(pi, binary->old_file.type, binary->old_file.data,\n\t\t\tbinary->old_file.datalen, binary->old_file.inflatedlen)) < 0) {\n\n\t\tif (error == GIT_EBUFS) {\n\t\t\tgiterr_clear();\n\t\t\tgit_buf_truncate(pi->buf, pre_binary_size);\n\t\t\tgoto noshow;\n\t\t}\n\t}\n\n\tpi->line.num_lines++;\n\treturn error;\n\nnoshow:\n\tpi->line.num_lines = 1;\n\treturn diff_delta_format_with_paths(\n\t\tpi->buf, delta, old_pfx, new_pfx,\n\t\t\"Binary files %s%s and %s%s differ\\n\");\n}"
  },
  {
    "function_name": "diff_print_load_content",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "370-401",
    "snippet": "static int diff_print_load_content(\n\tdiff_print_info *pi,\n\tgit_diff_delta *delta)\n{\n\tgit_diff_file_content *ofile, *nfile;\n\tint error;\n\n\tassert(pi->diff);\n\n\tofile = git__calloc(1, sizeof(git_diff_file_content));\n\tnfile = git__calloc(1, sizeof(git_diff_file_content));\n\n\tGITERR_CHECK_ALLOC(ofile);\n\tGITERR_CHECK_ALLOC(nfile);\n\n\tif ((error = git_diff_file_content__init_from_diff(\n\t\t\tofile, pi->diff, delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\tnfile, pi->diff, delta, true)) < 0) {\n\n\t\tgit__free(ofile);\n\t\tgit__free(nfile);\n\t\treturn error;\n\t}\n\n\tpi->content_loaded = 1;\n\tpi->content_allocated = 1;\n\tpi->ofile = ofile;\n\tpi->nfile = nfile;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "nfile"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_file_content__init_from_diff",
          "args": [
            "nfile",
            "pi->diff",
            "delta",
            "true"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_file_content__init_from_diff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_file.c",
          "lines": "89-128",
          "snippet": "int git_diff_file_content__init_from_diff(\n\tgit_diff_file_content *fc,\n\tgit_diff *diff,\n\tgit_diff_delta *delta,\n\tbool use_old)\n{\n\tbool has_data = true;\n\n\tmemset(fc, 0, sizeof(*fc));\n\tfc->repo = diff->repo;\n\tfc->file = use_old ? &delta->old_file : &delta->new_file;\n\tfc->src  = use_old ? diff->old_src : diff->new_src;\n\n\tif (git_diff_driver_lookup(&fc->driver, fc->repo, fc->file->path) < 0)\n\t\treturn -1;\n\n\tswitch (delta->status) {\n\tcase GIT_DELTA_ADDED:\n\t\thas_data = !use_old; break;\n\tcase GIT_DELTA_DELETED:\n\t\thas_data = use_old; break;\n\tcase GIT_DELTA_UNTRACKED:\n\t\thas_data = !use_old &&\n\t\t\t(diff->opts.flags & GIT_DIFF_SHOW_UNTRACKED_CONTENT) != 0;\n\t\tbreak;\n\tcase GIT_DELTA_UNREADABLE:\n\tcase GIT_DELTA_MODIFIED:\n\tcase GIT_DELTA_COPIED:\n\tcase GIT_DELTA_RENAMED:\n\t\tbreak;\n\tdefault:\n\t\thas_data = false;\n\t\tbreak;\n\t}\n\n\tif (!has_data)\n\t\tfc->flags |= GIT_DIFF_FLAG__NO_DATA;\n\n\treturn diff_file_content_init_common(fc, &diff->opts);\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"fileops.h\"",
            "#include \"odb.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/submodule.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"fileops.h\"\n#include \"odb.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/submodule.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nint git_diff_file_content__init_from_diff(\n\tgit_diff_file_content *fc,\n\tgit_diff *diff,\n\tgit_diff_delta *delta,\n\tbool use_old)\n{\n\tbool has_data = true;\n\n\tmemset(fc, 0, sizeof(*fc));\n\tfc->repo = diff->repo;\n\tfc->file = use_old ? &delta->old_file : &delta->new_file;\n\tfc->src  = use_old ? diff->old_src : diff->new_src;\n\n\tif (git_diff_driver_lookup(&fc->driver, fc->repo, fc->file->path) < 0)\n\t\treturn -1;\n\n\tswitch (delta->status) {\n\tcase GIT_DELTA_ADDED:\n\t\thas_data = !use_old; break;\n\tcase GIT_DELTA_DELETED:\n\t\thas_data = use_old; break;\n\tcase GIT_DELTA_UNTRACKED:\n\t\thas_data = !use_old &&\n\t\t\t(diff->opts.flags & GIT_DIFF_SHOW_UNTRACKED_CONTENT) != 0;\n\t\tbreak;\n\tcase GIT_DELTA_UNREADABLE:\n\tcase GIT_DELTA_MODIFIED:\n\tcase GIT_DELTA_COPIED:\n\tcase GIT_DELTA_RENAMED:\n\t\tbreak;\n\tdefault:\n\t\thas_data = false;\n\t\tbreak;\n\t}\n\n\tif (!has_data)\n\t\tfc->flags |= GIT_DIFF_FLAG__NO_DATA;\n\n\treturn diff_file_content_init_common(fc, &diff->opts);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "nfile"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "ofile"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_diff_file_content)"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "pi->diff"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_load_content(\n\tdiff_print_info *pi,\n\tgit_diff_delta *delta)\n{\n\tgit_diff_file_content *ofile, *nfile;\n\tint error;\n\n\tassert(pi->diff);\n\n\tofile = git__calloc(1, sizeof(git_diff_file_content));\n\tnfile = git__calloc(1, sizeof(git_diff_file_content));\n\n\tGITERR_CHECK_ALLOC(ofile);\n\tGITERR_CHECK_ALLOC(nfile);\n\n\tif ((error = git_diff_file_content__init_from_diff(\n\t\t\tofile, pi->diff, delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\tnfile, pi->diff, delta, true)) < 0) {\n\n\t\tgit__free(ofile);\n\t\tgit__free(nfile);\n\t\treturn error;\n\t}\n\n\tpi->content_loaded = 1;\n\tpi->content_allocated = 1;\n\tpi->ofile = ofile;\n\tpi->nfile = nfile;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "format_binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "332-368",
    "snippet": "static int format_binary(\n\tdiff_print_info *pi,\n\tgit_diff_binary_t type,\n\tconst char *data,\n\tsize_t datalen,\n\tsize_t inflatedlen)\n{\n\tconst char *typename = type == GIT_DIFF_BINARY_DELTA ?\n\t\t\"delta\" : \"literal\";\n\tconst char *scan, *end;\n\n\tgit_buf_printf(pi->buf, \"%s %\" PRIuZ \"\\n\", typename, inflatedlen);\n\tpi->line.num_lines++;\n\n\tfor (scan = data, end = data + datalen; scan < end; ) {\n\t\tsize_t chunk_len = end - scan;\n\t\tif (chunk_len > 52)\n\t\t\tchunk_len = 52;\n\n\t\tif (chunk_len <= 26)\n\t\t\tgit_buf_putc(pi->buf, (char)chunk_len + 'A' - 1);\n\t\telse\n\t\t\tgit_buf_putc(pi->buf, (char)chunk_len - 26 + 'a' - 1);\n\n\t\tgit_buf_encode_base85(pi->buf, scan, chunk_len);\n\t\tgit_buf_putc(pi->buf, '\\n');\n\n\t\tif (git_buf_oom(pi->buf))\n\t\t\treturn -1;\n\n\t\tscan += chunk_len;\n\t\tpi->line.num_lines++;\n\t}\n\tgit_buf_putc(pi->buf, '\\n');\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "pi->buf",
            "'\\n'"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "pi->buf"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_encode_base85",
          "args": [
            "pi->buf",
            "scan",
            "chunk_len"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_encode_base85",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "327-364",
          "snippet": "int git_buf_encode_base85(git_buf *buf, const char *data, size_t len)\n{\n\tsize_t blocks = (len / 4) + !!(len % 4), alloclen;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloclen, blocks, 5);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, buf->size);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tENSURE_SIZE(buf, alloclen);\n\n\twhile (len) {\n\t\tuint32_t acc = 0;\n\t\tchar b85[5];\n\t\tint i;\n\n\t\tfor (i = 24; i >= 0; i -= 8) {\n\t\t\tuint8_t ch = *data++;\n\t\t\tacc |= ch << i;\n\n\t\t\tif (--len == 0)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tfor (i = 4; i >= 0; i--) {\n\t\t\tint val = acc % 85;\n\t\t\tacc /= 85;\n\n\t\t\tb85[i] = b85str[val];\n\t\t}\n\n\t\tfor (i = 0; i < 5; i++)\n\t\t\tbuf->ptr[buf->size++] = b85[i];\n\t}\n\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char b85str[] =\n\t\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!#$%&()*+-;<=>?@^_`{|}~\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nstatic const char b85str[] =\n\t\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!#$%&()*+-;<=>?@^_`{|}~\";\n\nint git_buf_encode_base85(git_buf *buf, const char *data, size_t len)\n{\n\tsize_t blocks = (len / 4) + !!(len % 4), alloclen;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloclen, blocks, 5);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, buf->size);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, 1);\n\n\tENSURE_SIZE(buf, alloclen);\n\n\twhile (len) {\n\t\tuint32_t acc = 0;\n\t\tchar b85[5];\n\t\tint i;\n\n\t\tfor (i = 24; i >= 0; i -= 8) {\n\t\t\tuint8_t ch = *data++;\n\t\t\tacc |= ch << i;\n\n\t\t\tif (--len == 0)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tfor (i = 4; i >= 0; i--) {\n\t\t\tint val = acc % 85;\n\t\t\tacc /= 85;\n\n\t\t\tb85[i] = b85str[val];\n\t\t}\n\n\t\tfor (i = 0; i < 5; i++)\n\t\t\tbuf->ptr[buf->size++] = b85[i];\n\t}\n\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "pi->buf",
            "\"%s %\" PRIuZ \"\\n\"",
            "typename",
            "inflatedlen"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int format_binary(\n\tdiff_print_info *pi,\n\tgit_diff_binary_t type,\n\tconst char *data,\n\tsize_t datalen,\n\tsize_t inflatedlen)\n{\n\tconst char *typename = type == GIT_DIFF_BINARY_DELTA ?\n\t\t\"delta\" : \"literal\";\n\tconst char *scan, *end;\n\n\tgit_buf_printf(pi->buf, \"%s %\" PRIuZ \"\\n\", typename, inflatedlen);\n\tpi->line.num_lines++;\n\n\tfor (scan = data, end = data + datalen; scan < end; ) {\n\t\tsize_t chunk_len = end - scan;\n\t\tif (chunk_len > 52)\n\t\t\tchunk_len = 52;\n\n\t\tif (chunk_len <= 26)\n\t\t\tgit_buf_putc(pi->buf, (char)chunk_len + 'A' - 1);\n\t\telse\n\t\t\tgit_buf_putc(pi->buf, (char)chunk_len - 26 + 'a' - 1);\n\n\t\tgit_buf_encode_base85(pi->buf, scan, chunk_len);\n\t\tgit_buf_putc(pi->buf, '\\n');\n\n\t\tif (git_buf_oom(pi->buf))\n\t\t\treturn -1;\n\n\t\tscan += chunk_len;\n\t\tpi->line.num_lines++;\n\t}\n\tgit_buf_putc(pi->buf, '\\n');\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_diff_delta__format_file_header",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "304-330",
    "snippet": "int git_diff_delta__format_file_header(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tint oid_strlen)\n{\n\tif (!oldpfx)\n\t\toldpfx = DIFF_OLD_PREFIX_DEFAULT;\n\tif (!newpfx)\n\t\tnewpfx = DIFF_NEW_PREFIX_DEFAULT;\n\tif (!oid_strlen)\n\t\toid_strlen = GIT_ABBREV_DEFAULT + 1;\n\n\tgit_buf_clear(out);\n\n\tgit_buf_printf(out, \"diff --git %s%s %s%s\\n\",\n\t\toldpfx, delta->old_file.path, newpfx, delta->new_file.path);\n\n\tGITERR_CHECK_ERROR(diff_print_oid_range(out, delta, oid_strlen));\n\n\tif ((delta->flags & GIT_DIFF_FLAG_BINARY) == 0)\n\t\tdiff_delta_format_with_paths(\n\t\t\tout, delta, oldpfx, newpfx, \"--- %s%s\\n+++ %s%s\\n\");\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_delta_format_with_paths",
          "args": [
            "out",
            "delta",
            "oldpfx",
            "newpfx",
            "\"--- %s%s\\n+++ %s%s\\n\""
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "diff_delta_format_with_paths",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "282-302",
          "snippet": "static int diff_delta_format_with_paths(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tconst char *template)\n{\n\tconst char *oldpath = delta->old_file.path;\n\tconst char *newpath = delta->new_file.path;\n\n\tif (git_oid_iszero(&delta->old_file.id)) {\n\t\toldpfx = \"\";\n\t\toldpath = \"/dev/null\";\n\t}\n\tif (git_oid_iszero(&delta->new_file.id)) {\n\t\tnewpfx = \"\";\n\t\tnewpath = \"/dev/null\";\n\t}\n\n\treturn git_buf_printf(out, template, oldpfx, oldpath, newpfx, newpath);\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_delta_format_with_paths(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tconst char *template)\n{\n\tconst char *oldpath = delta->old_file.path;\n\tconst char *newpath = delta->new_file.path;\n\n\tif (git_oid_iszero(&delta->old_file.id)) {\n\t\toldpfx = \"\";\n\t\toldpath = \"/dev/null\";\n\t}\n\tif (git_oid_iszero(&delta->new_file.id)) {\n\t\tnewpfx = \"\";\n\t\tnewpath = \"/dev/null\";\n\t}\n\n\treturn git_buf_printf(out, template, oldpfx, oldpath, newpfx, newpath);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ERROR",
          "args": [
            "diff_print_oid_range(out, delta, oid_strlen)"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diff_print_oid_range",
          "args": [
            "out",
            "delta",
            "oid_strlen"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "diff_print_oid_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "255-280",
          "snippet": "static int diff_print_oid_range(\n\tgit_buf *out, const git_diff_delta *delta, int oid_strlen)\n{\n\tchar start_oid[GIT_OID_HEXSZ+1], end_oid[GIT_OID_HEXSZ+1];\n\n\tgit_oid_tostr(start_oid, oid_strlen, &delta->old_file.id);\n\tgit_oid_tostr(end_oid, oid_strlen, &delta->new_file.id);\n\n\t/* TODO: Match git diff more closely */\n\tif (delta->old_file.mode == delta->new_file.mode) {\n\t\tgit_buf_printf(out, \"index %s..%s %o\\n\",\n\t\t\tstart_oid, end_oid, delta->old_file.mode);\n\t} else {\n\t\tif (delta->old_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \"new file mode %o\\n\", delta->new_file.mode);\n\t\t} else if (delta->new_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \"deleted file mode %o\\n\", delta->old_file.mode);\n\t\t} else {\n\t\t\tgit_buf_printf(out, \"old mode %o\\n\", delta->old_file.mode);\n\t\t\tgit_buf_printf(out, \"new mode %o\\n\", delta->new_file.mode);\n\t\t}\n\t\tgit_buf_printf(out, \"index %s..%s\\n\", start_oid, end_oid);\n\t}\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_oid_range(\n\tgit_buf *out, const git_diff_delta *delta, int oid_strlen)\n{\n\tchar start_oid[GIT_OID_HEXSZ+1], end_oid[GIT_OID_HEXSZ+1];\n\n\tgit_oid_tostr(start_oid, oid_strlen, &delta->old_file.id);\n\tgit_oid_tostr(end_oid, oid_strlen, &delta->new_file.id);\n\n\t/* TODO: Match git diff more closely */\n\tif (delta->old_file.mode == delta->new_file.mode) {\n\t\tgit_buf_printf(out, \"index %s..%s %o\\n\",\n\t\t\tstart_oid, end_oid, delta->old_file.mode);\n\t} else {\n\t\tif (delta->old_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \"new file mode %o\\n\", delta->new_file.mode);\n\t\t} else if (delta->new_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \"deleted file mode %o\\n\", delta->old_file.mode);\n\t\t} else {\n\t\t\tgit_buf_printf(out, \"old mode %o\\n\", delta->old_file.mode);\n\t\t\tgit_buf_printf(out, \"new mode %o\\n\", delta->new_file.mode);\n\t\t}\n\t\tgit_buf_printf(out, \"index %s..%s\\n\", start_oid, end_oid);\n\t}\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "out",
            "\"diff --git %s%s %s%s\\n\"",
            "oldpfx",
            "delta->old_file.path",
            "newpfx",
            "delta->new_file.path"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_diff_delta__format_file_header(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tint oid_strlen)\n{\n\tif (!oldpfx)\n\t\toldpfx = DIFF_OLD_PREFIX_DEFAULT;\n\tif (!newpfx)\n\t\tnewpfx = DIFF_NEW_PREFIX_DEFAULT;\n\tif (!oid_strlen)\n\t\toid_strlen = GIT_ABBREV_DEFAULT + 1;\n\n\tgit_buf_clear(out);\n\n\tgit_buf_printf(out, \"diff --git %s%s %s%s\\n\",\n\t\toldpfx, delta->old_file.path, newpfx, delta->new_file.path);\n\n\tGITERR_CHECK_ERROR(diff_print_oid_range(out, delta, oid_strlen));\n\n\tif ((delta->flags & GIT_DIFF_FLAG_BINARY) == 0)\n\t\tdiff_delta_format_with_paths(\n\t\t\tout, delta, oldpfx, newpfx, \"--- %s%s\\n+++ %s%s\\n\");\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}"
  },
  {
    "function_name": "diff_delta_format_with_paths",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "282-302",
    "snippet": "static int diff_delta_format_with_paths(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tconst char *template)\n{\n\tconst char *oldpath = delta->old_file.path;\n\tconst char *newpath = delta->new_file.path;\n\n\tif (git_oid_iszero(&delta->old_file.id)) {\n\t\toldpfx = \"\";\n\t\toldpath = \"/dev/null\";\n\t}\n\tif (git_oid_iszero(&delta->new_file.id)) {\n\t\tnewpfx = \"\";\n\t\tnewpath = \"/dev/null\";\n\t}\n\n\treturn git_buf_printf(out, template, oldpfx, oldpath, newpfx, newpath);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "out",
            "template",
            "oldpfx",
            "oldpath",
            "newpfx",
            "newpath"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_iszero",
          "args": [
            "&delta->new_file.id"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_iszero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "239-247",
          "snippet": "int git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_delta_format_with_paths(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tconst char *template)\n{\n\tconst char *oldpath = delta->old_file.path;\n\tconst char *newpath = delta->new_file.path;\n\n\tif (git_oid_iszero(&delta->old_file.id)) {\n\t\toldpfx = \"\";\n\t\toldpath = \"/dev/null\";\n\t}\n\tif (git_oid_iszero(&delta->new_file.id)) {\n\t\tnewpfx = \"\";\n\t\tnewpath = \"/dev/null\";\n\t}\n\n\treturn git_buf_printf(out, template, oldpfx, oldpath, newpfx, newpath);\n}"
  },
  {
    "function_name": "diff_print_oid_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "255-280",
    "snippet": "static int diff_print_oid_range(\n\tgit_buf *out, const git_diff_delta *delta, int oid_strlen)\n{\n\tchar start_oid[GIT_OID_HEXSZ+1], end_oid[GIT_OID_HEXSZ+1];\n\n\tgit_oid_tostr(start_oid, oid_strlen, &delta->old_file.id);\n\tgit_oid_tostr(end_oid, oid_strlen, &delta->new_file.id);\n\n\t/* TODO: Match git diff more closely */\n\tif (delta->old_file.mode == delta->new_file.mode) {\n\t\tgit_buf_printf(out, \"index %s..%s %o\\n\",\n\t\t\tstart_oid, end_oid, delta->old_file.mode);\n\t} else {\n\t\tif (delta->old_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \"new file mode %o\\n\", delta->new_file.mode);\n\t\t} else if (delta->new_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \"deleted file mode %o\\n\", delta->old_file.mode);\n\t\t} else {\n\t\t\tgit_buf_printf(out, \"old mode %o\\n\", delta->old_file.mode);\n\t\t\tgit_buf_printf(out, \"new mode %o\\n\", delta->new_file.mode);\n\t\t}\n\t\tgit_buf_printf(out, \"index %s..%s\\n\", start_oid, end_oid);\n\t}\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "out",
            "\"index %s..%s\\n\"",
            "start_oid",
            "end_oid"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_tostr",
          "args": [
            "end_oid",
            "oid_strlen",
            "&delta->new_file.id"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_tostr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "119-131",
          "snippet": "char *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_oid_range(\n\tgit_buf *out, const git_diff_delta *delta, int oid_strlen)\n{\n\tchar start_oid[GIT_OID_HEXSZ+1], end_oid[GIT_OID_HEXSZ+1];\n\n\tgit_oid_tostr(start_oid, oid_strlen, &delta->old_file.id);\n\tgit_oid_tostr(end_oid, oid_strlen, &delta->new_file.id);\n\n\t/* TODO: Match git diff more closely */\n\tif (delta->old_file.mode == delta->new_file.mode) {\n\t\tgit_buf_printf(out, \"index %s..%s %o\\n\",\n\t\t\tstart_oid, end_oid, delta->old_file.mode);\n\t} else {\n\t\tif (delta->old_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \"new file mode %o\\n\", delta->new_file.mode);\n\t\t} else if (delta->new_file.mode == 0) {\n\t\t\tgit_buf_printf(out, \"deleted file mode %o\\n\", delta->old_file.mode);\n\t\t} else {\n\t\t\tgit_buf_printf(out, \"old mode %o\\n\", delta->old_file.mode);\n\t\t\tgit_buf_printf(out, \"new mode %o\\n\", delta->new_file.mode);\n\t\t}\n\t\tgit_buf_printf(out, \"index %s..%s\\n\", start_oid, end_oid);\n\t}\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}"
  },
  {
    "function_name": "diff_print_one_raw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "211-253",
    "snippet": "static int diff_print_one_raw(\n\tconst git_diff_delta *delta, float progress, void *data)\n{\n\tdiff_print_info *pi = data;\n\tgit_buf *out = pi->buf;\n\tchar code = git_diff_status_char(delta->status);\n\tchar start_oid[GIT_OID_HEXSZ+1], end_oid[GIT_OID_HEXSZ+1];\n\n\tGIT_UNUSED(progress);\n\n\tif ((pi->flags & GIT_DIFF_SHOW_UNMODIFIED) == 0 && code == ' ')\n\t\treturn 0;\n\n\tgit_buf_clear(out);\n\n\tgit_oid_tostr(start_oid, pi->oid_strlen, &delta->old_file.id);\n\tgit_oid_tostr(end_oid, pi->oid_strlen, &delta->new_file.id);\n\n\tgit_buf_printf(\n\t\tout, (pi->oid_strlen <= GIT_OID_HEXSZ) ?\n\t\t\t\":%06o %06o %s... %s... %c\" : \":%06o %06o %s %s %c\",\n\t\tdelta->old_file.mode, delta->new_file.mode, start_oid, end_oid, code);\n\n\tif (delta->similarity > 0)\n\t\tgit_buf_printf(out, \"%03u\", delta->similarity);\n\n\tif (delta->old_file.path != delta->new_file.path)\n\t\tgit_buf_printf(\n\t\t\tout, \"\\t%s %s\\n\", delta->old_file.path, delta->new_file.path);\n\telse\n\t\tgit_buf_printf(\n\t\t\tout, \"\\t%s\\n\", delta->old_file.path ?\n\t\t\tdelta->old_file.path : delta->new_file.path);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\tpi->line.origin      = GIT_DIFF_LINE_FILE_HDR;\n\tpi->line.content     = git_buf_cstr(out);\n\tpi->line.content_len = git_buf_len(out);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi->print_cb",
          "args": [
            "delta",
            "NULL",
            "&pi->line",
            "pi->payload"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "out"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "out"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "out",
            "\"\\t%s\\n\"",
            "delta->old_file.path ?\n\t\t\tdelta->old_file.path : delta->new_file.path"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_tostr",
          "args": [
            "end_oid",
            "pi->oid_strlen",
            "&delta->new_file.id"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_tostr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "119-131",
          "snippet": "char *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "progress"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_diff_status_char",
          "args": [
            "delta->status"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_status_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "126-143",
          "snippet": "char git_diff_status_char(git_delta_t status)\n{\n\tchar code;\n\n\tswitch (status) {\n\tcase GIT_DELTA_ADDED:      code = 'A'; break;\n\tcase GIT_DELTA_DELETED:    code = 'D'; break;\n\tcase GIT_DELTA_MODIFIED:   code = 'M'; break;\n\tcase GIT_DELTA_RENAMED:    code = 'R'; break;\n\tcase GIT_DELTA_COPIED:     code = 'C'; break;\n\tcase GIT_DELTA_IGNORED:    code = 'I'; break;\n\tcase GIT_DELTA_UNTRACKED:  code = '?'; break;\n\tcase GIT_DELTA_UNREADABLE: code = 'X'; break;\n\tdefault:                   code = ' '; break;\n\t}\n\n\treturn code;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nchar git_diff_status_char(git_delta_t status)\n{\n\tchar code;\n\n\tswitch (status) {\n\tcase GIT_DELTA_ADDED:      code = 'A'; break;\n\tcase GIT_DELTA_DELETED:    code = 'D'; break;\n\tcase GIT_DELTA_MODIFIED:   code = 'M'; break;\n\tcase GIT_DELTA_RENAMED:    code = 'R'; break;\n\tcase GIT_DELTA_COPIED:     code = 'C'; break;\n\tcase GIT_DELTA_IGNORED:    code = 'I'; break;\n\tcase GIT_DELTA_UNTRACKED:  code = '?'; break;\n\tcase GIT_DELTA_UNREADABLE: code = 'X'; break;\n\tdefault:                   code = ' '; break;\n\t}\n\n\treturn code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_one_raw(\n\tconst git_diff_delta *delta, float progress, void *data)\n{\n\tdiff_print_info *pi = data;\n\tgit_buf *out = pi->buf;\n\tchar code = git_diff_status_char(delta->status);\n\tchar start_oid[GIT_OID_HEXSZ+1], end_oid[GIT_OID_HEXSZ+1];\n\n\tGIT_UNUSED(progress);\n\n\tif ((pi->flags & GIT_DIFF_SHOW_UNMODIFIED) == 0 && code == ' ')\n\t\treturn 0;\n\n\tgit_buf_clear(out);\n\n\tgit_oid_tostr(start_oid, pi->oid_strlen, &delta->old_file.id);\n\tgit_oid_tostr(end_oid, pi->oid_strlen, &delta->new_file.id);\n\n\tgit_buf_printf(\n\t\tout, (pi->oid_strlen <= GIT_OID_HEXSZ) ?\n\t\t\t\":%06o %06o %s... %s... %c\" : \":%06o %06o %s %s %c\",\n\t\tdelta->old_file.mode, delta->new_file.mode, start_oid, end_oid, code);\n\n\tif (delta->similarity > 0)\n\t\tgit_buf_printf(out, \"%03u\", delta->similarity);\n\n\tif (delta->old_file.path != delta->new_file.path)\n\t\tgit_buf_printf(\n\t\t\tout, \"\\t%s %s\\n\", delta->old_file.path, delta->new_file.path);\n\telse\n\t\tgit_buf_printf(\n\t\t\tout, \"\\t%s\\n\", delta->old_file.path ?\n\t\t\tdelta->old_file.path : delta->new_file.path);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\tpi->line.origin      = GIT_DIFF_LINE_FILE_HDR;\n\tpi->line.content     = git_buf_cstr(out);\n\tpi->line.content_len = git_buf_len(out);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}"
  },
  {
    "function_name": "diff_print_one_name_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "170-209",
    "snippet": "static int diff_print_one_name_status(\n\tconst git_diff_delta *delta, float progress, void *data)\n{\n\tdiff_print_info *pi = data;\n\tgit_buf *out = pi->buf;\n\tchar old_suffix, new_suffix, code = git_diff_status_char(delta->status);\n\tint (*strcomp)(const char *, const char *) =\n\t\tpi->diff ? pi->diff->strcomp : git__strcmp;\n\n\tGIT_UNUSED(progress);\n\n\tif ((pi->flags & GIT_DIFF_SHOW_UNMODIFIED) == 0 && code == ' ')\n\t\treturn 0;\n\n\told_suffix = diff_pick_suffix(delta->old_file.mode);\n\tnew_suffix = diff_pick_suffix(delta->new_file.mode);\n\n\tgit_buf_clear(out);\n\n\tif (delta->old_file.path != delta->new_file.path &&\n\t\tstrcomp(delta->old_file.path,delta->new_file.path) != 0)\n\t\tgit_buf_printf(out, \"%c\\t%s%c %s%c\\n\", code,\n\t\t\tdelta->old_file.path, old_suffix, delta->new_file.path, new_suffix);\n\telse if (delta->old_file.mode != delta->new_file.mode &&\n\t\tdelta->old_file.mode != 0 && delta->new_file.mode != 0)\n\t\tgit_buf_printf(out, \"%c\\t%s%c %s%c\\n\", code,\n\t\t\tdelta->old_file.path, old_suffix, delta->new_file.path, new_suffix);\n\telse if (old_suffix != ' ')\n\t\tgit_buf_printf(out, \"%c\\t%s%c\\n\", code, delta->old_file.path, old_suffix);\n\telse\n\t\tgit_buf_printf(out, \"%c\\t%s\\n\", code, delta->old_file.path);\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\tpi->line.origin      = GIT_DIFF_LINE_FILE_HDR;\n\tpi->line.content     = git_buf_cstr(out);\n\tpi->line.content_len = git_buf_len(out);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi->print_cb",
          "args": [
            "delta",
            "NULL",
            "&pi->line",
            "pi->payload"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "out"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "out"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "out",
            "\"%c\\t%s\\n\"",
            "code",
            "delta->old_file.path"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcomp",
          "args": [
            "delta->old_file.path",
            "delta->new_file.path"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_pick_suffix",
          "args": [
            "delta->new_file.mode"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "diff_pick_suffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "115-124",
          "snippet": "static char diff_pick_suffix(int mode)\n{\n\tif (S_ISDIR(mode))\n\t\treturn '/';\n\telse if (GIT_PERMS_IS_EXEC(mode)) /* -V536 */\n\t\t/* in git, modes are very regular, so we must have 0100755 mode */\n\t\treturn '*';\n\telse\n\t\treturn ' ';\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic char diff_pick_suffix(int mode)\n{\n\tif (S_ISDIR(mode))\n\t\treturn '/';\n\telse if (GIT_PERMS_IS_EXEC(mode)) /* -V536 */\n\t\t/* in git, modes are very regular, so we must have 0100755 mode */\n\t\treturn '*';\n\telse\n\t\treturn ' ';\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "progress"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_diff_status_char",
          "args": [
            "delta->status"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_status_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "126-143",
          "snippet": "char git_diff_status_char(git_delta_t status)\n{\n\tchar code;\n\n\tswitch (status) {\n\tcase GIT_DELTA_ADDED:      code = 'A'; break;\n\tcase GIT_DELTA_DELETED:    code = 'D'; break;\n\tcase GIT_DELTA_MODIFIED:   code = 'M'; break;\n\tcase GIT_DELTA_RENAMED:    code = 'R'; break;\n\tcase GIT_DELTA_COPIED:     code = 'C'; break;\n\tcase GIT_DELTA_IGNORED:    code = 'I'; break;\n\tcase GIT_DELTA_UNTRACKED:  code = '?'; break;\n\tcase GIT_DELTA_UNREADABLE: code = 'X'; break;\n\tdefault:                   code = ' '; break;\n\t}\n\n\treturn code;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nchar git_diff_status_char(git_delta_t status)\n{\n\tchar code;\n\n\tswitch (status) {\n\tcase GIT_DELTA_ADDED:      code = 'A'; break;\n\tcase GIT_DELTA_DELETED:    code = 'D'; break;\n\tcase GIT_DELTA_MODIFIED:   code = 'M'; break;\n\tcase GIT_DELTA_RENAMED:    code = 'R'; break;\n\tcase GIT_DELTA_COPIED:     code = 'C'; break;\n\tcase GIT_DELTA_IGNORED:    code = 'I'; break;\n\tcase GIT_DELTA_UNTRACKED:  code = '?'; break;\n\tcase GIT_DELTA_UNREADABLE: code = 'X'; break;\n\tdefault:                   code = ' '; break;\n\t}\n\n\treturn code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_one_name_status(\n\tconst git_diff_delta *delta, float progress, void *data)\n{\n\tdiff_print_info *pi = data;\n\tgit_buf *out = pi->buf;\n\tchar old_suffix, new_suffix, code = git_diff_status_char(delta->status);\n\tint (*strcomp)(const char *, const char *) =\n\t\tpi->diff ? pi->diff->strcomp : git__strcmp;\n\n\tGIT_UNUSED(progress);\n\n\tif ((pi->flags & GIT_DIFF_SHOW_UNMODIFIED) == 0 && code == ' ')\n\t\treturn 0;\n\n\told_suffix = diff_pick_suffix(delta->old_file.mode);\n\tnew_suffix = diff_pick_suffix(delta->new_file.mode);\n\n\tgit_buf_clear(out);\n\n\tif (delta->old_file.path != delta->new_file.path &&\n\t\tstrcomp(delta->old_file.path,delta->new_file.path) != 0)\n\t\tgit_buf_printf(out, \"%c\\t%s%c %s%c\\n\", code,\n\t\t\tdelta->old_file.path, old_suffix, delta->new_file.path, new_suffix);\n\telse if (delta->old_file.mode != delta->new_file.mode &&\n\t\tdelta->old_file.mode != 0 && delta->new_file.mode != 0)\n\t\tgit_buf_printf(out, \"%c\\t%s%c %s%c\\n\", code,\n\t\t\tdelta->old_file.path, old_suffix, delta->new_file.path, new_suffix);\n\telse if (old_suffix != ' ')\n\t\tgit_buf_printf(out, \"%c\\t%s%c\\n\", code, delta->old_file.path, old_suffix);\n\telse\n\t\tgit_buf_printf(out, \"%c\\t%s\\n\", code, delta->old_file.path);\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\tpi->line.origin      = GIT_DIFF_LINE_FILE_HDR;\n\tpi->line.content     = git_buf_cstr(out);\n\tpi->line.content_len = git_buf_len(out);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}"
  },
  {
    "function_name": "diff_print_one_name_only",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "145-168",
    "snippet": "static int diff_print_one_name_only(\n\tconst git_diff_delta *delta, float progress, void *data)\n{\n\tdiff_print_info *pi = data;\n\tgit_buf *out = pi->buf;\n\n\tGIT_UNUSED(progress);\n\n\tif ((pi->flags & GIT_DIFF_SHOW_UNMODIFIED) == 0 &&\n\t\tdelta->status == GIT_DELTA_UNMODIFIED)\n\t\treturn 0;\n\n\tgit_buf_clear(out);\n\tgit_buf_puts(out, delta->new_file.path);\n\tgit_buf_putc(out, '\\n');\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\tpi->line.origin      = GIT_DIFF_LINE_FILE_HDR;\n\tpi->line.content     = git_buf_cstr(out);\n\tpi->line.content_len = git_buf_len(out);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi->print_cb",
          "args": [
            "delta",
            "NULL",
            "&pi->line",
            "pi->payload"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "out"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "out"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "out",
            "'\\n'"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "out",
            "delta->new_file.path"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "progress"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_one_name_only(\n\tconst git_diff_delta *delta, float progress, void *data)\n{\n\tdiff_print_info *pi = data;\n\tgit_buf *out = pi->buf;\n\n\tGIT_UNUSED(progress);\n\n\tif ((pi->flags & GIT_DIFF_SHOW_UNMODIFIED) == 0 &&\n\t\tdelta->status == GIT_DELTA_UNMODIFIED)\n\t\treturn 0;\n\n\tgit_buf_clear(out);\n\tgit_buf_puts(out, delta->new_file.path);\n\tgit_buf_putc(out, '\\n');\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\tpi->line.origin      = GIT_DIFF_LINE_FILE_HDR;\n\tpi->line.content     = git_buf_cstr(out);\n\tpi->line.content_len = git_buf_len(out);\n\n\treturn pi->print_cb(delta, NULL, &pi->line, pi->payload);\n}"
  },
  {
    "function_name": "git_diff_status_char",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "126-143",
    "snippet": "char git_diff_status_char(git_delta_t status)\n{\n\tchar code;\n\n\tswitch (status) {\n\tcase GIT_DELTA_ADDED:      code = 'A'; break;\n\tcase GIT_DELTA_DELETED:    code = 'D'; break;\n\tcase GIT_DELTA_MODIFIED:   code = 'M'; break;\n\tcase GIT_DELTA_RENAMED:    code = 'R'; break;\n\tcase GIT_DELTA_COPIED:     code = 'C'; break;\n\tcase GIT_DELTA_IGNORED:    code = 'I'; break;\n\tcase GIT_DELTA_UNTRACKED:  code = '?'; break;\n\tcase GIT_DELTA_UNREADABLE: code = 'X'; break;\n\tdefault:                   code = ' '; break;\n\t}\n\n\treturn code;\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nchar git_diff_status_char(git_delta_t status)\n{\n\tchar code;\n\n\tswitch (status) {\n\tcase GIT_DELTA_ADDED:      code = 'A'; break;\n\tcase GIT_DELTA_DELETED:    code = 'D'; break;\n\tcase GIT_DELTA_MODIFIED:   code = 'M'; break;\n\tcase GIT_DELTA_RENAMED:    code = 'R'; break;\n\tcase GIT_DELTA_COPIED:     code = 'C'; break;\n\tcase GIT_DELTA_IGNORED:    code = 'I'; break;\n\tcase GIT_DELTA_UNTRACKED:  code = '?'; break;\n\tcase GIT_DELTA_UNREADABLE: code = 'X'; break;\n\tdefault:                   code = ' '; break;\n\t}\n\n\treturn code;\n}"
  },
  {
    "function_name": "diff_pick_suffix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "115-124",
    "snippet": "static char diff_pick_suffix(int mode)\n{\n\tif (S_ISDIR(mode))\n\t\treturn '/';\n\telse if (GIT_PERMS_IS_EXEC(mode)) /* -V536 */\n\t\t/* in git, modes are very regular, so we must have 0100755 mode */\n\t\treturn '*';\n\telse\n\t\treturn ' ';\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_PERMS_IS_EXEC",
          "args": [
            "mode"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "mode"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic char diff_pick_suffix(int mode)\n{\n\tif (S_ISDIR(mode))\n\t\treturn '/';\n\telse if (GIT_PERMS_IS_EXEC(mode)) /* -V536 */\n\t\t/* in git, modes are very regular, so we must have 0100755 mode */\n\t\treturn '*';\n\telse\n\t\treturn ' ';\n}"
  },
  {
    "function_name": "diff_print_info_init_frompatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "87-113",
    "snippet": "static int diff_print_info_init_frompatch(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_patch *patch,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tgit_repository *repo;\n\n\tassert(patch);\n\n\trepo = patch->diff ? patch->diff->repo : NULL;\n\n\tmemset(pi, 0, sizeof(diff_print_info));\n\n\tpi->diff = patch->diff;\n\n\tpi->flags = patch->diff_opts.flags;\n\tpi->oid_strlen = patch->diff_opts.id_abbrev;\n\n\tpi->content_loaded = 1;\n\tpi->ofile = &patch->ofile;\n\tpi->nfile = &patch->nfile;\n\n\treturn diff_print_info_init__common(pi, out, repo, format, cb, payload);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_print_info_init__common",
          "args": [
            "pi",
            "out",
            "repo",
            "format",
            "cb",
            "payload"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "diff_print_info_init__common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "32-63",
          "snippet": "static int diff_print_info_init__common(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_repository *repo,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tpi->format = format;\n\tpi->print_cb = cb;\n\tpi->payload = payload;\n\tpi->buf = out;\n\n\tif (!pi->oid_strlen) {\n\t\tif (!repo)\n\t\t\tpi->oid_strlen = GIT_ABBREV_DEFAULT;\n\t\telse if (git_repository__cvar(&pi->oid_strlen, repo, GIT_CVAR_ABBREV) < 0)\n\t\t\treturn -1;\n\t}\n\n\tpi->oid_strlen += 1; /* for NUL byte */\n\n\tif (pi->oid_strlen > GIT_OID_HEXSZ + 1)\n\t\tpi->oid_strlen = GIT_OID_HEXSZ + 1;\n\n\tmemset(&pi->line, 0, sizeof(pi->line));\n\tpi->line.old_lineno = -1;\n\tpi->line.new_lineno = -1;\n\tpi->line.num_lines = 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_info_init__common(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_repository *repo,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tpi->format = format;\n\tpi->print_cb = cb;\n\tpi->payload = payload;\n\tpi->buf = out;\n\n\tif (!pi->oid_strlen) {\n\t\tif (!repo)\n\t\t\tpi->oid_strlen = GIT_ABBREV_DEFAULT;\n\t\telse if (git_repository__cvar(&pi->oid_strlen, repo, GIT_CVAR_ABBREV) < 0)\n\t\t\treturn -1;\n\t}\n\n\tpi->oid_strlen += 1; /* for NUL byte */\n\n\tif (pi->oid_strlen > GIT_OID_HEXSZ + 1)\n\t\tpi->oid_strlen = GIT_OID_HEXSZ + 1;\n\n\tmemset(&pi->line, 0, sizeof(pi->line));\n\tpi->line.old_lineno = -1;\n\tpi->line.new_lineno = -1;\n\tpi->line.num_lines = 1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pi",
            "0",
            "sizeof(diff_print_info)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "patch"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_info_init_frompatch(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_patch *patch,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tgit_repository *repo;\n\n\tassert(patch);\n\n\trepo = patch->diff ? patch->diff->repo : NULL;\n\n\tmemset(pi, 0, sizeof(diff_print_info));\n\n\tpi->diff = patch->diff;\n\n\tpi->flags = patch->diff_opts.flags;\n\tpi->oid_strlen = patch->diff_opts.id_abbrev;\n\n\tpi->content_loaded = 1;\n\tpi->ofile = &patch->ofile;\n\tpi->nfile = &patch->nfile;\n\n\treturn diff_print_info_init__common(pi, out, repo, format, cb, payload);\n}"
  },
  {
    "function_name": "diff_print_info_init_fromdiff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "65-85",
    "snippet": "static int diff_print_info_init_fromdiff(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_diff *diff,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tgit_repository *repo = diff ? diff->repo : NULL;\n\n\tmemset(pi, 0, sizeof(diff_print_info));\n\n\tpi->diff = diff;\n\n\tif (diff) {\n\t\tpi->flags = diff->opts.flags;\n\t\tpi->oid_strlen = diff->opts.id_abbrev;\n\t}\n\n\treturn diff_print_info_init__common(pi, out, repo, format, cb, payload);\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_print_info_init__common",
          "args": [
            "pi",
            "out",
            "repo",
            "format",
            "cb",
            "payload"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "diff_print_info_init__common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "32-63",
          "snippet": "static int diff_print_info_init__common(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_repository *repo,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tpi->format = format;\n\tpi->print_cb = cb;\n\tpi->payload = payload;\n\tpi->buf = out;\n\n\tif (!pi->oid_strlen) {\n\t\tif (!repo)\n\t\t\tpi->oid_strlen = GIT_ABBREV_DEFAULT;\n\t\telse if (git_repository__cvar(&pi->oid_strlen, repo, GIT_CVAR_ABBREV) < 0)\n\t\t\treturn -1;\n\t}\n\n\tpi->oid_strlen += 1; /* for NUL byte */\n\n\tif (pi->oid_strlen > GIT_OID_HEXSZ + 1)\n\t\tpi->oid_strlen = GIT_OID_HEXSZ + 1;\n\n\tmemset(&pi->line, 0, sizeof(pi->line));\n\tpi->line.old_lineno = -1;\n\tpi->line.new_lineno = -1;\n\tpi->line.num_lines = 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_info_init__common(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_repository *repo,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tpi->format = format;\n\tpi->print_cb = cb;\n\tpi->payload = payload;\n\tpi->buf = out;\n\n\tif (!pi->oid_strlen) {\n\t\tif (!repo)\n\t\t\tpi->oid_strlen = GIT_ABBREV_DEFAULT;\n\t\telse if (git_repository__cvar(&pi->oid_strlen, repo, GIT_CVAR_ABBREV) < 0)\n\t\t\treturn -1;\n\t}\n\n\tpi->oid_strlen += 1; /* for NUL byte */\n\n\tif (pi->oid_strlen > GIT_OID_HEXSZ + 1)\n\t\tpi->oid_strlen = GIT_OID_HEXSZ + 1;\n\n\tmemset(&pi->line, 0, sizeof(pi->line));\n\tpi->line.old_lineno = -1;\n\tpi->line.new_lineno = -1;\n\tpi->line.num_lines = 1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pi",
            "0",
            "sizeof(diff_print_info)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_info_init_fromdiff(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_diff *diff,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tgit_repository *repo = diff ? diff->repo : NULL;\n\n\tmemset(pi, 0, sizeof(diff_print_info));\n\n\tpi->diff = diff;\n\n\tif (diff) {\n\t\tpi->flags = diff->opts.flags;\n\t\tpi->oid_strlen = diff->opts.id_abbrev;\n\t}\n\n\treturn diff_print_info_init__common(pi, out, repo, format, cb, payload);\n}"
  },
  {
    "function_name": "diff_print_info_init__common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
    "lines": "32-63",
    "snippet": "static int diff_print_info_init__common(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_repository *repo,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tpi->format = format;\n\tpi->print_cb = cb;\n\tpi->payload = payload;\n\tpi->buf = out;\n\n\tif (!pi->oid_strlen) {\n\t\tif (!repo)\n\t\t\tpi->oid_strlen = GIT_ABBREV_DEFAULT;\n\t\telse if (git_repository__cvar(&pi->oid_strlen, repo, GIT_CVAR_ABBREV) < 0)\n\t\t\treturn -1;\n\t}\n\n\tpi->oid_strlen += 1; /* for NUL byte */\n\n\tif (pi->oid_strlen > GIT_OID_HEXSZ + 1)\n\t\tpi->oid_strlen = GIT_OID_HEXSZ + 1;\n\n\tmemset(&pi->line, 0, sizeof(pi->line));\n\tpi->line.old_lineno = -1;\n\tpi->line.new_lineno = -1;\n\tpi->line.num_lines = 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/sys/diff.h\"",
      "#include \"delta.h\"",
      "#include \"blob.h\"",
      "#include \"zstream.h\"",
      "#include \"fileops.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&pi->line",
            "0",
            "sizeof(pi->line)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository__cvar",
          "args": [
            "&pi->oid_strlen",
            "repo",
            "GIT_CVAR_ABBREV"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__cvar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
          "lines": "104-120",
          "snippet": "int git_repository__cvar(int *out, git_repository *repo, git_cvar_cached cvar)\n{\n\t*out = repo->cvar_cache[(int)cvar];\n\n\tif (*out == GIT_CVAR_NOT_CACHED) {\n\t\tint error;\n\t\tgit_config *config;\n\n\t\tif ((error = git_repository_config__weakptr(&config, repo)) < 0 ||\n\t\t\t(error = git_config__cvar(out, config, cvar)) < 0)\n\t\t\treturn error;\n\n\t\trepo->cvar_cache[(int)cvar] = *out;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"vector.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"repository.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_repository__cvar(int *out, git_repository *repo, git_cvar_cached cvar)\n{\n\t*out = repo->cvar_cache[(int)cvar];\n\n\tif (*out == GIT_CVAR_NOT_CACHED) {\n\t\tint error;\n\t\tgit_config *config;\n\n\t\tif ((error = git_repository_config__weakptr(&config, repo)) < 0 ||\n\t\t\t(error = git_config__cvar(out, config, cvar)) < 0)\n\t\t\treturn error;\n\n\t\trepo->cvar_cache[(int)cvar] = *out;\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nstatic int diff_print_info_init__common(\n\tdiff_print_info *pi,\n\tgit_buf *out,\n\tgit_repository *repo,\n\tgit_diff_format_t format,\n\tgit_diff_line_cb cb,\n\tvoid *payload)\n{\n\tpi->format = format;\n\tpi->print_cb = cb;\n\tpi->payload = payload;\n\tpi->buf = out;\n\n\tif (!pi->oid_strlen) {\n\t\tif (!repo)\n\t\t\tpi->oid_strlen = GIT_ABBREV_DEFAULT;\n\t\telse if (git_repository__cvar(&pi->oid_strlen, repo, GIT_CVAR_ABBREV) < 0)\n\t\t\treturn -1;\n\t}\n\n\tpi->oid_strlen += 1; /* for NUL byte */\n\n\tif (pi->oid_strlen > GIT_OID_HEXSZ + 1)\n\t\tpi->oid_strlen = GIT_OID_HEXSZ + 1;\n\n\tmemset(&pi->line, 0, sizeof(pi->line));\n\tpi->line.old_lineno = -1;\n\tpi->line.new_lineno = -1;\n\tpi->line.num_lines = 1;\n\n\treturn 0;\n}"
  }
]