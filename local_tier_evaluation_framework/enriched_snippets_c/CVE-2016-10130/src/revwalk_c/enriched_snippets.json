[
  {
    "function_name": "git_revwalk_add_hide_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "648-668",
    "snippet": "int git_revwalk_add_hide_cb(\n\tgit_revwalk *walk,\n\tgit_revwalk_hide_cb hide_cb,\n\tvoid *payload)\n{\n\tassert(walk);\n\n\tif (walk->walking)\n\t\tgit_revwalk_reset(walk);\n\n\tif (walk->hide_cb) {\n\t\t/* There is already a callback added */\n\t\tgiterr_set(GITERR_INVALID, \"There is already a callback added to hide commits in revision walker.\");\n\t\treturn -1;\n\t}\n\n\twalk->hide_cb = hide_cb;\n\twalk->hide_cb_payload = payload;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"There is already a callback added to hide commits in revision walker.\""
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_reset",
          "args": [
            "walk"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "624-646",
          "snippet": "void git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_add_hide_cb(\n\tgit_revwalk *walk,\n\tgit_revwalk_hide_cb hide_cb,\n\tvoid *payload)\n{\n\tassert(walk);\n\n\tif (walk->walking)\n\t\tgit_revwalk_reset(walk);\n\n\tif (walk->hide_cb) {\n\t\t/* There is already a callback added */\n\t\tgiterr_set(GITERR_INVALID, \"There is already a callback added to hide commits in revision walker.\");\n\t\treturn -1;\n\t}\n\n\twalk->hide_cb = hide_cb;\n\twalk->hide_cb_payload = payload;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_revwalk_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "624-646",
    "snippet": "void git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_list_free",
          "args": [
            "&walk->user_input"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "75-89",
          "snippet": "void git_commit_list_free(git_commit_list **list_p)\n{\n\tgit_commit_list *list = *list_p;\n\n\tif (list == NULL)\n\t\treturn;\n\n\twhile (list) {\n\t\tgit_commit_list *temp = list;\n\t\tlist = temp->next;\n\t\tgit__free(temp);\n\t}\n\n\t*list_p = NULL;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nvoid git_commit_list_free(git_commit_list **list_p)\n{\n\tgit_commit_list *list = *list_p;\n\n\tif (list == NULL)\n\t\treturn;\n\n\twhile (list) {\n\t\tgit_commit_list *temp = list;\n\t\tlist = temp->next;\n\t\tgit__free(temp);\n\t}\n\n\t*list_p = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_clear",
          "args": [
            "&walk->iterator_time"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_foreach_value",
          "args": [
            "walk->commits",
            "commit",
            "{\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t}"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}"
  },
  {
    "function_name": "git_revwalk_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "598-622",
    "snippet": "int git_revwalk_next(git_oid *oid, git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list_node *next;\n\n\tassert(walk && oid);\n\n\tif (!walk->walking) {\n\t\tif ((error = prepare_walk(walk)) < 0)\n\t\t\treturn error;\n\t}\n\n\terror = walk->get_next(&next, walk);\n\n\tif (error == GIT_ITEROVER) {\n\t\tgit_revwalk_reset(walk);\n\t\tgiterr_clear();\n\t\treturn GIT_ITEROVER;\n\t}\n\n\tif (!error)\n\t\tgit_oid_cpy(oid, &next->oid);\n\n\treturn error;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "oid",
            "&next->oid"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_reset",
          "args": [
            "walk"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "624-646",
          "snippet": "void git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "walk->get_next",
          "args": [
            "&next",
            "walk"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_walk",
          "args": [
            "walk"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_walk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "472-526",
          "snippet": "static int prepare_walk(git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list *list;\n\tgit_commit_list_node *next;\n\n\t/* If there were no pushes, we know that the walk is already over */\n\tif (!walk->did_push) {\n\t\tgiterr_clear();\n\t\treturn GIT_ITEROVER;\n\t}\n\n\tif (walk->did_hide && (error = premark_uninteresting(walk)) < 0)\n\t\treturn error;\n\n\tfor (list = walk->user_input; list; list = list->next) {\n\t\tif (process_commit(walk, list->item, list->item->uninteresting) < 0)\n\t\t\treturn -1;\n\t}\n\n\n\tif (walk->sorting & GIT_SORT_TOPOLOGICAL) {\n\t\tunsigned short i;\n\n\t\twhile ((error = walk->get_next(&next, walk)) == 0) {\n\t\t\tfor (i = 0; i < next->out_degree; ++i) {\n\t\t\t\tgit_commit_list_node *parent = next->parents[i];\n\t\t\t\tparent->in_degree++;\n\t\t\t}\n\n\t\t\tif (git_commit_list_insert(next, &walk->iterator_topo) == NULL)\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tif (error != GIT_ITEROVER)\n\t\t\treturn error;\n\n\t\twalk->get_next = &revwalk_next_toposort;\n\t}\n\n\tif (walk->sorting & GIT_SORT_REVERSE) {\n\n\t\twhile ((error = walk->get_next(&next, walk)) == 0)\n\t\t\tif (git_commit_list_insert(next, &walk->iterator_reverse) == NULL)\n\t\t\t\treturn -1;\n\n\t\tif (error != GIT_ITEROVER)\n\t\t\treturn error;\n\n\t\twalk->get_next = &revwalk_next_reverse;\n\t}\n\n\twalk->walking = 1;\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int prepare_walk(git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list *list;\n\tgit_commit_list_node *next;\n\n\t/* If there were no pushes, we know that the walk is already over */\n\tif (!walk->did_push) {\n\t\tgiterr_clear();\n\t\treturn GIT_ITEROVER;\n\t}\n\n\tif (walk->did_hide && (error = premark_uninteresting(walk)) < 0)\n\t\treturn error;\n\n\tfor (list = walk->user_input; list; list = list->next) {\n\t\tif (process_commit(walk, list->item, list->item->uninteresting) < 0)\n\t\t\treturn -1;\n\t}\n\n\n\tif (walk->sorting & GIT_SORT_TOPOLOGICAL) {\n\t\tunsigned short i;\n\n\t\twhile ((error = walk->get_next(&next, walk)) == 0) {\n\t\t\tfor (i = 0; i < next->out_degree; ++i) {\n\t\t\t\tgit_commit_list_node *parent = next->parents[i];\n\t\t\t\tparent->in_degree++;\n\t\t\t}\n\n\t\t\tif (git_commit_list_insert(next, &walk->iterator_topo) == NULL)\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tif (error != GIT_ITEROVER)\n\t\t\treturn error;\n\n\t\twalk->get_next = &revwalk_next_toposort;\n\t}\n\n\tif (walk->sorting & GIT_SORT_REVERSE) {\n\n\t\twhile ((error = walk->get_next(&next, walk)) == 0)\n\t\t\tif (git_commit_list_insert(next, &walk->iterator_reverse) == NULL)\n\t\t\t\treturn -1;\n\n\t\tif (error != GIT_ITEROVER)\n\t\t\treturn error;\n\n\t\twalk->get_next = &revwalk_next_reverse;\n\t}\n\n\twalk->walking = 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk && oid"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_next(git_oid *oid, git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list_node *next;\n\n\tassert(walk && oid);\n\n\tif (!walk->walking) {\n\t\tif ((error = prepare_walk(walk)) < 0)\n\t\t\treturn error;\n\t}\n\n\terror = walk->get_next(&next, walk);\n\n\tif (error == GIT_ITEROVER) {\n\t\tgit_revwalk_reset(walk);\n\t\tgiterr_clear();\n\t\treturn GIT_ITEROVER;\n\t}\n\n\tif (!error)\n\t\tgit_oid_cpy(oid, &next->oid);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_revwalk_simplify_first_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "593-596",
    "snippet": "void git_revwalk_simplify_first_parent(git_revwalk *walk)\n{\n\twalk->first_parent = 1;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_simplify_first_parent(git_revwalk *walk)\n{\n\twalk->first_parent = 1;\n}"
  },
  {
    "function_name": "git_revwalk_sorting",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "575-591",
    "snippet": "void git_revwalk_sorting(git_revwalk *walk, unsigned int sort_mode)\n{\n\tassert(walk);\n\n\tif (walk->walking)\n\t\tgit_revwalk_reset(walk);\n\n\twalk->sorting = sort_mode;\n\n\tif (walk->sorting & GIT_SORT_TIME) {\n\t\twalk->get_next = &revwalk_next_timesort;\n\t\twalk->enqueue = &revwalk_enqueue_timesort;\n\t} else {\n\t\twalk->get_next = &revwalk_next_unsorted;\n\t\twalk->enqueue = &revwalk_enqueue_unsorted;\n\t}\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_revwalk_reset",
          "args": [
            "walk"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "624-646",
          "snippet": "void git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_sorting(git_revwalk *walk, unsigned int sort_mode)\n{\n\tassert(walk);\n\n\tif (walk->walking)\n\t\tgit_revwalk_reset(walk);\n\n\twalk->sorting = sort_mode;\n\n\tif (walk->sorting & GIT_SORT_TIME) {\n\t\twalk->get_next = &revwalk_next_timesort;\n\t\twalk->enqueue = &revwalk_enqueue_timesort;\n\t} else {\n\t\twalk->get_next = &revwalk_next_unsorted;\n\t\twalk->enqueue = &revwalk_enqueue_unsorted;\n\t}\n}"
  },
  {
    "function_name": "git_revwalk_repository",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "569-573",
    "snippet": "git_repository *git_revwalk_repository(git_revwalk *walk)\n{\n\tassert(walk);\n\treturn walk->repo;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\ngit_repository *git_revwalk_repository(git_revwalk *walk)\n{\n\tassert(walk);\n\treturn walk->repo;\n}"
  },
  {
    "function_name": "git_revwalk_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "555-567",
    "snippet": "void git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "walk"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_free",
          "args": [
            "&walk->iterator_time"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pool_clear",
          "args": [
            "&walk->commit_pool"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "131-134",
          "snippet": "void git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oidmap_free",
          "args": [
            "walk->commits"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_odb_free",
          "args": [
            "walk->odb"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "619-625",
          "snippet": "void git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_reset",
          "args": [
            "walk"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "624-646",
          "snippet": "void git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_reset(git_revwalk *walk)\n{\n\tgit_commit_list_node *commit;\n\n\tassert(walk);\n\n\tkh_foreach_value(walk->commits, commit, {\n\t\tcommit->seen = 0;\n\t\tcommit->in_degree = 0;\n\t\tcommit->topo_delay = 0;\n\t\tcommit->uninteresting = 0;\n\t\tcommit->flags = 0;\n\t\t});\n\n\tgit_pqueue_clear(&walk->iterator_time);\n\tgit_commit_list_free(&walk->iterator_topo);\n\tgit_commit_list_free(&walk->iterator_rand);\n\tgit_commit_list_free(&walk->iterator_reverse);\n\tgit_commit_list_free(&walk->user_input);\n\twalk->first_parent = 0;\n\twalk->walking = 0;\n\twalk->did_push = walk->did_hide = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}"
  },
  {
    "function_name": "git_revwalk_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "529-553",
    "snippet": "int git_revwalk_new(git_revwalk **revwalk_out, git_repository *repo)\n{\n\tgit_revwalk *walk = git__calloc(1, sizeof(git_revwalk));\n\tGITERR_CHECK_ALLOC(walk);\n\n\twalk->commits = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(walk->commits);\n\n\tif (git_pqueue_init(&walk->iterator_time, 0, 8, git_commit_list_time_cmp) < 0)\n\t\treturn -1;\n\n\tgit_pool_init(&walk->commit_pool, COMMIT_ALLOC);\n\twalk->get_next = &revwalk_next_unsorted;\n\twalk->enqueue = &revwalk_enqueue_unsorted;\n\n\twalk->repo = repo;\n\n\tif (git_repository_odb(&walk->odb, repo) < 0) {\n\t\tgit_revwalk_free(walk);\n\t\treturn -1;\n\t}\n\n\t*revwalk_out = walk;\n\treturn 0;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_revwalk_free",
          "args": [
            "walk"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "555-567",
          "snippet": "void git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_odb",
          "args": [
            "&walk->odb",
            "repo"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_odb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "764-771",
          "snippet": "int git_repository_odb(git_odb **out, git_repository *repo)\n{\n\tif (git_repository_odb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb(git_odb **out, git_repository *repo)\n{\n\tif (git_repository_odb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pool_init",
          "args": [
            "&walk->commit_pool",
            "COMMIT_ALLOC"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "120-129",
          "snippet": "void git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_init",
          "args": [
            "&walk->iterator_time",
            "0",
            "8",
            "git_commit_list_time_cmp"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "15-33",
          "snippet": "int git_pqueue_init(\n\tgit_pqueue *pq,\n\tuint32_t flags,\n\tsize_t init_size,\n\tgit_vector_cmp cmp)\n{\n\tint error = git_vector_init(pq, init_size, cmp);\n\n\tif (!error) {\n\t\t/* mix in our flags */\n\t\tpq->flags |= flags;\n\n\t\t/* if fixed size heap, pretend vector is exactly init_size elements */\n\t\tif ((flags & GIT_PQUEUE_FIXED_SIZE) && init_size > 0)\n\t\t\tpq->_alloc_size = init_size;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nint git_pqueue_init(\n\tgit_pqueue *pq,\n\tuint32_t flags,\n\tsize_t init_size,\n\tgit_vector_cmp cmp)\n{\n\tint error = git_vector_init(pq, init_size, cmp);\n\n\tif (!error) {\n\t\t/* mix in our flags */\n\t\tpq->flags |= flags;\n\n\t\t/* if fixed size heap, pretend vector is exactly init_size elements */\n\t\tif ((flags & GIT_PQUEUE_FIXED_SIZE) && init_size > 0)\n\t\t\tpq->_alloc_size = init_size;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "walk->commits"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oidmap_alloc",
          "args": [],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "walk"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_revwalk)"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_new(git_revwalk **revwalk_out, git_repository *repo)\n{\n\tgit_revwalk *walk = git__calloc(1, sizeof(git_revwalk));\n\tGITERR_CHECK_ALLOC(walk);\n\n\twalk->commits = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(walk->commits);\n\n\tif (git_pqueue_init(&walk->iterator_time, 0, 8, git_commit_list_time_cmp) < 0)\n\t\treturn -1;\n\n\tgit_pool_init(&walk->commit_pool, COMMIT_ALLOC);\n\twalk->get_next = &revwalk_next_unsorted;\n\twalk->enqueue = &revwalk_enqueue_unsorted;\n\n\twalk->repo = repo;\n\n\tif (git_repository_odb(&walk->odb, repo) < 0) {\n\t\tgit_revwalk_free(walk);\n\t\treturn -1;\n\t}\n\n\t*revwalk_out = walk;\n\treturn 0;\n}"
  },
  {
    "function_name": "prepare_walk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "472-526",
    "snippet": "static int prepare_walk(git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list *list;\n\tgit_commit_list_node *next;\n\n\t/* If there were no pushes, we know that the walk is already over */\n\tif (!walk->did_push) {\n\t\tgiterr_clear();\n\t\treturn GIT_ITEROVER;\n\t}\n\n\tif (walk->did_hide && (error = premark_uninteresting(walk)) < 0)\n\t\treturn error;\n\n\tfor (list = walk->user_input; list; list = list->next) {\n\t\tif (process_commit(walk, list->item, list->item->uninteresting) < 0)\n\t\t\treturn -1;\n\t}\n\n\n\tif (walk->sorting & GIT_SORT_TOPOLOGICAL) {\n\t\tunsigned short i;\n\n\t\twhile ((error = walk->get_next(&next, walk)) == 0) {\n\t\t\tfor (i = 0; i < next->out_degree; ++i) {\n\t\t\t\tgit_commit_list_node *parent = next->parents[i];\n\t\t\t\tparent->in_degree++;\n\t\t\t}\n\n\t\t\tif (git_commit_list_insert(next, &walk->iterator_topo) == NULL)\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tif (error != GIT_ITEROVER)\n\t\t\treturn error;\n\n\t\twalk->get_next = &revwalk_next_toposort;\n\t}\n\n\tif (walk->sorting & GIT_SORT_REVERSE) {\n\n\t\twhile ((error = walk->get_next(&next, walk)) == 0)\n\t\t\tif (git_commit_list_insert(next, &walk->iterator_reverse) == NULL)\n\t\t\t\treturn -1;\n\n\t\tif (error != GIT_ITEROVER)\n\t\t\treturn error;\n\n\t\twalk->get_next = &revwalk_next_reverse;\n\t}\n\n\twalk->walking = 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_list_insert",
          "args": [
            "next",
            "&walk->iterator_reverse"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_insert_by_date",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "33-46",
          "snippet": "git_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "walk->get_next",
          "args": [
            "&next",
            "walk"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walk->get_next",
          "args": [
            "&next",
            "walk"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "process_commit",
          "args": [
            "walk",
            "list->item",
            "list->item->uninteresting"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "process_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "96-118",
          "snippet": "static int process_commit(git_revwalk *walk, git_commit_list_node *commit, int hide)\n{\n\tint error;\n\n\tif (!hide && walk->hide_cb)\n\t\thide = walk->hide_cb(&commit->oid, walk->hide_cb_payload);\n\n\tif (hide && mark_uninteresting(walk, commit) < 0)\n\t\treturn -1;\n\n\tif (commit->seen)\n\t\treturn 0;\n\n\tcommit->seen = 1;\n\n\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\treturn error;\n\n\tif (!hide)\n\t\treturn walk->enqueue(walk, commit);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int process_commit(git_revwalk *walk, git_commit_list_node *commit, int hide)\n{\n\tint error;\n\n\tif (!hide && walk->hide_cb)\n\t\thide = walk->hide_cb(&commit->oid, walk->hide_cb_payload);\n\n\tif (hide && mark_uninteresting(walk, commit) < 0)\n\t\treturn -1;\n\n\tif (commit->seen)\n\t\treturn 0;\n\n\tcommit->seen = 1;\n\n\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\treturn error;\n\n\tif (!hide)\n\t\treturn walk->enqueue(walk, commit);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "premark_uninteresting",
          "args": [
            "walk"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "premark_uninteresting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "428-470",
          "snippet": "static int premark_uninteresting(git_revwalk *walk)\n{\n\tint error = 0;\n\tunsigned short i;\n\tgit_pqueue q;\n\tgit_commit_list *list;\n\tgit_commit_list_node *commit, *parent;\n\n\tif ((error = git_pqueue_init(&q, 0, 8, git_commit_list_time_cmp)) < 0)\n\t\treturn error;\n\n\tfor (list = walk->user_input; list; list = list->next) {\n\t\tif ((error = git_commit_list_parse(walk, list->item)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tif ((error = git_pqueue_insert(&q, list->item)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\twhile (interesting(&q)) {\n\t\tcommit = git_pqueue_pop(&q);\n\n\t\tfor (i = 0; i < commit->out_degree; i++) {\n\t\t\tparent = commit->parents[i];\n\n\t\t\tif ((error = git_commit_list_parse(walk, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\n\t\t\tif (commit->uninteresting)\n\t\t\t\tparent->uninteresting = 1;\n\n\t\t\tif (contains(&q, parent))\n\t\t\t\tcontinue;\n\n\t\t\tif ((error = git_pqueue_insert(&q, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\t\t}\n\t}\n\ncleanup:\n\tgit_pqueue_free(&q);\n\treturn error;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int premark_uninteresting(git_revwalk *walk)\n{\n\tint error = 0;\n\tunsigned short i;\n\tgit_pqueue q;\n\tgit_commit_list *list;\n\tgit_commit_list_node *commit, *parent;\n\n\tif ((error = git_pqueue_init(&q, 0, 8, git_commit_list_time_cmp)) < 0)\n\t\treturn error;\n\n\tfor (list = walk->user_input; list; list = list->next) {\n\t\tif ((error = git_commit_list_parse(walk, list->item)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tif ((error = git_pqueue_insert(&q, list->item)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\twhile (interesting(&q)) {\n\t\tcommit = git_pqueue_pop(&q);\n\n\t\tfor (i = 0; i < commit->out_degree; i++) {\n\t\t\tparent = commit->parents[i];\n\n\t\t\tif ((error = git_commit_list_parse(walk, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\n\t\t\tif (commit->uninteresting)\n\t\t\t\tparent->uninteresting = 1;\n\n\t\t\tif (contains(&q, parent))\n\t\t\t\tcontinue;\n\n\t\t\tif ((error = git_pqueue_insert(&q, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\t\t}\n\t}\n\ncleanup:\n\tgit_pqueue_free(&q);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int prepare_walk(git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list *list;\n\tgit_commit_list_node *next;\n\n\t/* If there were no pushes, we know that the walk is already over */\n\tif (!walk->did_push) {\n\t\tgiterr_clear();\n\t\treturn GIT_ITEROVER;\n\t}\n\n\tif (walk->did_hide && (error = premark_uninteresting(walk)) < 0)\n\t\treturn error;\n\n\tfor (list = walk->user_input; list; list = list->next) {\n\t\tif (process_commit(walk, list->item, list->item->uninteresting) < 0)\n\t\t\treturn -1;\n\t}\n\n\n\tif (walk->sorting & GIT_SORT_TOPOLOGICAL) {\n\t\tunsigned short i;\n\n\t\twhile ((error = walk->get_next(&next, walk)) == 0) {\n\t\t\tfor (i = 0; i < next->out_degree; ++i) {\n\t\t\t\tgit_commit_list_node *parent = next->parents[i];\n\t\t\t\tparent->in_degree++;\n\t\t\t}\n\n\t\t\tif (git_commit_list_insert(next, &walk->iterator_topo) == NULL)\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tif (error != GIT_ITEROVER)\n\t\t\treturn error;\n\n\t\twalk->get_next = &revwalk_next_toposort;\n\t}\n\n\tif (walk->sorting & GIT_SORT_REVERSE) {\n\n\t\twhile ((error = walk->get_next(&next, walk)) == 0)\n\t\t\tif (git_commit_list_insert(next, &walk->iterator_reverse) == NULL)\n\t\t\t\treturn -1;\n\n\t\tif (error != GIT_ITEROVER)\n\t\t\treturn error;\n\n\t\twalk->get_next = &revwalk_next_reverse;\n\t}\n\n\twalk->walking = 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "premark_uninteresting",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "428-470",
    "snippet": "static int premark_uninteresting(git_revwalk *walk)\n{\n\tint error = 0;\n\tunsigned short i;\n\tgit_pqueue q;\n\tgit_commit_list *list;\n\tgit_commit_list_node *commit, *parent;\n\n\tif ((error = git_pqueue_init(&q, 0, 8, git_commit_list_time_cmp)) < 0)\n\t\treturn error;\n\n\tfor (list = walk->user_input; list; list = list->next) {\n\t\tif ((error = git_commit_list_parse(walk, list->item)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tif ((error = git_pqueue_insert(&q, list->item)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\twhile (interesting(&q)) {\n\t\tcommit = git_pqueue_pop(&q);\n\n\t\tfor (i = 0; i < commit->out_degree; i++) {\n\t\t\tparent = commit->parents[i];\n\n\t\t\tif ((error = git_commit_list_parse(walk, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\n\t\t\tif (commit->uninteresting)\n\t\t\t\tparent->uninteresting = 1;\n\n\t\t\tif (contains(&q, parent))\n\t\t\t\tcontinue;\n\n\t\t\tif ((error = git_pqueue_insert(&q, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\t\t}\n\t}\n\ncleanup:\n\tgit_pqueue_free(&q);\n\treturn error;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pqueue_free",
          "args": [
            "&q"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pqueue_insert",
          "args": [
            "&q",
            "parent"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "81-100",
          "snippet": "int git_pqueue_insert(git_pqueue *pq, void *item)\n{\n\tint error = 0;\n\n\t/* if heap is full, pop the top element if new one should replace it */\n\tif ((pq->flags & GIT_PQUEUE_FIXED_SIZE) != 0 &&\n\t\tpq->length >= pq->_alloc_size)\n\t{\n\t\t/* skip this item if below min item in heap */\n\t\tif (pq->_cmp(item, git_vector_get(pq, 0)) <= 0)\n\t\t\treturn 0;\n\t\t/* otherwise remove the min item before inserting new */\n\t\t(void)git_pqueue_pop(pq);\n\t}\n\n\tif (!(error = git_vector_insert(pq, item)))\n\t\tpqueue_up(pq, pq->length - 1);\n\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nint git_pqueue_insert(git_pqueue *pq, void *item)\n{\n\tint error = 0;\n\n\t/* if heap is full, pop the top element if new one should replace it */\n\tif ((pq->flags & GIT_PQUEUE_FIXED_SIZE) != 0 &&\n\t\tpq->length >= pq->_alloc_size)\n\t{\n\t\t/* skip this item if below min item in heap */\n\t\tif (pq->_cmp(item, git_vector_get(pq, 0)) <= 0)\n\t\t\treturn 0;\n\t\t/* otherwise remove the min item before inserting new */\n\t\t(void)git_pqueue_pop(pq);\n\t}\n\n\tif (!(error = git_vector_insert(pq, item)))\n\t\tpqueue_up(pq, pq->length - 1);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "contains",
          "args": [
            "&q",
            "parent"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "contains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "415-426",
          "snippet": "static int contains(git_pqueue *list, git_commit_list_node *node)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < git_pqueue_size(list); i++) {\n\t\tgit_commit_list_node *commit = git_pqueue_get(list, i);\n\t\tif (commit == node)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int contains(git_pqueue *list, git_commit_list_node *node)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < git_pqueue_size(list); i++) {\n\t\tgit_commit_list_node *commit = git_pqueue_get(list, i);\n\t\tif (commit == node)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_list_parse",
          "args": [
            "walk",
            "parent"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "177-199",
          "snippet": "int git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nint git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_pop",
          "args": [
            "&q"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_pop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "102-117",
          "snippet": "void *git_pqueue_pop(git_pqueue *pq)\n{\n\tvoid *rval = git_pqueue_get(pq, 0);\n\n\tif (git_pqueue_size(pq) > 1) {\n\t\t/* move last item to top of heap, shrink, and push item down */\n\t\tpq->contents[0] = git_vector_last(pq);\n\t\tgit_vector_pop(pq);\n\t\tpqueue_down(pq, 0);\n\t} else {\n\t\t/* all we need to do is shrink the heap in this case */\n\t\tgit_vector_pop(pq);\n\t}\n\n\treturn rval;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nvoid *git_pqueue_pop(git_pqueue *pq)\n{\n\tvoid *rval = git_pqueue_get(pq, 0);\n\n\tif (git_pqueue_size(pq) > 1) {\n\t\t/* move last item to top of heap, shrink, and push item down */\n\t\tpq->contents[0] = git_vector_last(pq);\n\t\tgit_vector_pop(pq);\n\t\tpqueue_down(pq, 0);\n\t} else {\n\t\t/* all we need to do is shrink the heap in this case */\n\t\tgit_vector_pop(pq);\n\t}\n\n\treturn rval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "interesting",
          "args": [
            "&q"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "premark_uninteresting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "428-470",
          "snippet": "static int premark_uninteresting(git_revwalk *walk)\n{\n\tint error = 0;\n\tunsigned short i;\n\tgit_pqueue q;\n\tgit_commit_list *list;\n\tgit_commit_list_node *commit, *parent;\n\n\tif ((error = git_pqueue_init(&q, 0, 8, git_commit_list_time_cmp)) < 0)\n\t\treturn error;\n\n\tfor (list = walk->user_input; list; list = list->next) {\n\t\tif ((error = git_commit_list_parse(walk, list->item)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tif ((error = git_pqueue_insert(&q, list->item)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\twhile (interesting(&q)) {\n\t\tcommit = git_pqueue_pop(&q);\n\n\t\tfor (i = 0; i < commit->out_degree; i++) {\n\t\t\tparent = commit->parents[i];\n\n\t\t\tif ((error = git_commit_list_parse(walk, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\n\t\t\tif (commit->uninteresting)\n\t\t\t\tparent->uninteresting = 1;\n\n\t\t\tif (contains(&q, parent))\n\t\t\t\tcontinue;\n\n\t\t\tif ((error = git_pqueue_insert(&q, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\t\t}\n\t}\n\ncleanup:\n\tgit_pqueue_free(&q);\n\treturn error;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_init",
          "args": [
            "&q",
            "0",
            "8",
            "git_commit_list_time_cmp"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "15-33",
          "snippet": "int git_pqueue_init(\n\tgit_pqueue *pq,\n\tuint32_t flags,\n\tsize_t init_size,\n\tgit_vector_cmp cmp)\n{\n\tint error = git_vector_init(pq, init_size, cmp);\n\n\tif (!error) {\n\t\t/* mix in our flags */\n\t\tpq->flags |= flags;\n\n\t\t/* if fixed size heap, pretend vector is exactly init_size elements */\n\t\tif ((flags & GIT_PQUEUE_FIXED_SIZE) && init_size > 0)\n\t\t\tpq->_alloc_size = init_size;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nint git_pqueue_init(\n\tgit_pqueue *pq,\n\tuint32_t flags,\n\tsize_t init_size,\n\tgit_vector_cmp cmp)\n{\n\tint error = git_vector_init(pq, init_size, cmp);\n\n\tif (!error) {\n\t\t/* mix in our flags */\n\t\tpq->flags |= flags;\n\n\t\t/* if fixed size heap, pretend vector is exactly init_size elements */\n\t\tif ((flags & GIT_PQUEUE_FIXED_SIZE) && init_size > 0)\n\t\t\tpq->_alloc_size = init_size;\n\t}\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int premark_uninteresting(git_revwalk *walk)\n{\n\tint error = 0;\n\tunsigned short i;\n\tgit_pqueue q;\n\tgit_commit_list *list;\n\tgit_commit_list_node *commit, *parent;\n\n\tif ((error = git_pqueue_init(&q, 0, 8, git_commit_list_time_cmp)) < 0)\n\t\treturn error;\n\n\tfor (list = walk->user_input; list; list = list->next) {\n\t\tif ((error = git_commit_list_parse(walk, list->item)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tif ((error = git_pqueue_insert(&q, list->item)) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\twhile (interesting(&q)) {\n\t\tcommit = git_pqueue_pop(&q);\n\n\t\tfor (i = 0; i < commit->out_degree; i++) {\n\t\t\tparent = commit->parents[i];\n\n\t\t\tif ((error = git_commit_list_parse(walk, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\n\t\t\tif (commit->uninteresting)\n\t\t\t\tparent->uninteresting = 1;\n\n\t\t\tif (contains(&q, parent))\n\t\t\t\tcontinue;\n\n\t\t\tif ((error = git_pqueue_insert(&q, parent)) < 0)\n\t\t\t\tgoto cleanup;\n\t\t}\n\t}\n\ncleanup:\n\tgit_pqueue_free(&q);\n\treturn error;\n}"
  },
  {
    "function_name": "contains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "415-426",
    "snippet": "static int contains(git_pqueue *list, git_commit_list_node *node)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < git_pqueue_size(list); i++) {\n\t\tgit_commit_list_node *commit = git_pqueue_get(list, i);\n\t\tif (commit == node)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pqueue_get",
          "args": [
            "list",
            "i"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pqueue_size",
          "args": [
            "list"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int contains(git_pqueue *list, git_commit_list_node *node)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < git_pqueue_size(list); i++) {\n\t\tgit_commit_list_node *commit = git_pqueue_get(list, i);\n\t\tif (commit == node)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "interesting",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "402-413",
    "snippet": "static int interesting(git_pqueue *list)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < git_pqueue_size(list); i++) {\n\t\tgit_commit_list_node *commit = git_pqueue_get(list, i);\n\t\tif (!commit->uninteresting)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pqueue_get",
          "args": [
            "list",
            "i"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pqueue_size",
          "args": [
            "list"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int interesting(git_pqueue *list)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < git_pqueue_size(list); i++) {\n\t\tgit_commit_list_node *commit = git_pqueue_get(list, i);\n\t\tif (!commit->uninteresting)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "revwalk_next_reverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "395-399",
    "snippet": "static int revwalk_next_reverse(git_commit_list_node **object_out, git_revwalk *walk)\n{\n\t*object_out = git_commit_list_pop(&walk->iterator_reverse);\n\treturn *object_out ? 0 : GIT_ITEROVER;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_list_pop",
          "args": [
            "&walk->iterator_reverse"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_pop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "91-101",
          "snippet": "git_commit_list_node *git_commit_list_pop(git_commit_list **stack)\n{\n\tgit_commit_list *top = *stack;\n\tgit_commit_list_node *item = top ? top->item : NULL;\n\n\tif (top) {\n\t\t*stack = top->next;\n\t\tgit__free(top);\n\t}\n\treturn item;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list_node *git_commit_list_pop(git_commit_list **stack)\n{\n\tgit_commit_list *top = *stack;\n\tgit_commit_list_node *item = top ? top->item : NULL;\n\n\tif (top) {\n\t\t*stack = top->next;\n\t\tgit__free(top);\n\t}\n\treturn item;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int revwalk_next_reverse(git_commit_list_node **object_out, git_revwalk *walk)\n{\n\t*object_out = git_commit_list_pop(&walk->iterator_reverse);\n\treturn *object_out ? 0 : GIT_ITEROVER;\n}"
  },
  {
    "function_name": "revwalk_next_toposort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "358-393",
    "snippet": "static int revwalk_next_toposort(git_commit_list_node **object_out, git_revwalk *walk)\n{\n\tgit_commit_list_node *next;\n\tunsigned short i, max;\n\n\tfor (;;) {\n\t\tnext = git_commit_list_pop(&walk->iterator_topo);\n\t\tif (next == NULL) {\n\t\t\tgiterr_clear();\n\t\t\treturn GIT_ITEROVER;\n\t\t}\n\n\t\tif (next->in_degree > 0) {\n\t\t\tnext->topo_delay = 1;\n\t\t\tcontinue;\n\t\t}\n\n\n\t\tmax = next->out_degree;\n\t\tif (walk->first_parent && next->out_degree)\n\t\t\tmax = 1;\n\n\t\tfor (i = 0; i < max; ++i) {\n\t\t\tgit_commit_list_node *parent = next->parents[i];\n\n\t\t\tif (--parent->in_degree == 0 && parent->topo_delay) {\n\t\t\t\tparent->topo_delay = 0;\n\t\t\t\tif (git_commit_list_insert(parent, &walk->iterator_topo) == NULL)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\t*object_out = next;\n\t\treturn 0;\n\t}\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_list_insert",
          "args": [
            "parent",
            "&walk->iterator_topo"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_insert_by_date",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "33-46",
          "snippet": "git_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_list_pop",
          "args": [
            "&walk->iterator_topo"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_pop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "91-101",
          "snippet": "git_commit_list_node *git_commit_list_pop(git_commit_list **stack)\n{\n\tgit_commit_list *top = *stack;\n\tgit_commit_list_node *item = top ? top->item : NULL;\n\n\tif (top) {\n\t\t*stack = top->next;\n\t\tgit__free(top);\n\t}\n\treturn item;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list_node *git_commit_list_pop(git_commit_list **stack)\n{\n\tgit_commit_list *top = *stack;\n\tgit_commit_list_node *item = top ? top->item : NULL;\n\n\tif (top) {\n\t\t*stack = top->next;\n\t\tgit__free(top);\n\t}\n\treturn item;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int revwalk_next_toposort(git_commit_list_node **object_out, git_revwalk *walk)\n{\n\tgit_commit_list_node *next;\n\tunsigned short i, max;\n\n\tfor (;;) {\n\t\tnext = git_commit_list_pop(&walk->iterator_topo);\n\t\tif (next == NULL) {\n\t\t\tgiterr_clear();\n\t\t\treturn GIT_ITEROVER;\n\t\t}\n\n\t\tif (next->in_degree > 0) {\n\t\t\tnext->topo_delay = 1;\n\t\t\tcontinue;\n\t\t}\n\n\n\t\tmax = next->out_degree;\n\t\tif (walk->first_parent && next->out_degree)\n\t\t\tmax = 1;\n\n\t\tfor (i = 0; i < max; ++i) {\n\t\t\tgit_commit_list_node *parent = next->parents[i];\n\n\t\t\tif (--parent->in_degree == 0 && parent->topo_delay) {\n\t\t\t\tparent->topo_delay = 0;\n\t\t\t\tif (git_commit_list_insert(parent, &walk->iterator_topo) == NULL)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\t*object_out = next;\n\t\treturn 0;\n\t}\n}"
  },
  {
    "function_name": "revwalk_next_unsorted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "340-356",
    "snippet": "static int revwalk_next_unsorted(git_commit_list_node **object_out, git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list_node *next;\n\n\twhile ((next = git_commit_list_pop(&walk->iterator_rand)) != NULL)\n\t\tif (!next->uninteresting) {\n\t\t\tif ((error = process_commit_parents(walk, next)) < 0)\n\t\t\t\treturn error;\n\n\t\t\t*object_out = next;\n\t\t\treturn 0;\n\t\t}\n\n\tgiterr_clear();\n\treturn GIT_ITEROVER;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "process_commit_parents",
          "args": [
            "walk",
            "next"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "process_commit_parents",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "120-133",
          "snippet": "static int process_commit_parents(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tunsigned short i, max;\n\tint error = 0;\n\n\tmax = commit->out_degree;\n\tif (walk->first_parent && commit->out_degree)\n\t\tmax = 1;\n\n\tfor (i = 0; i < max && !error; ++i)\n\t\terror = process_commit(walk, commit->parents[i], commit->uninteresting);\n\n\treturn error;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int process_commit_parents(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tunsigned short i, max;\n\tint error = 0;\n\n\tmax = commit->out_degree;\n\tif (walk->first_parent && commit->out_degree)\n\t\tmax = 1;\n\n\tfor (i = 0; i < max && !error; ++i)\n\t\terror = process_commit(walk, commit->parents[i], commit->uninteresting);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_list_pop",
          "args": [
            "&walk->iterator_rand"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_pop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "91-101",
          "snippet": "git_commit_list_node *git_commit_list_pop(git_commit_list **stack)\n{\n\tgit_commit_list *top = *stack;\n\tgit_commit_list_node *item = top ? top->item : NULL;\n\n\tif (top) {\n\t\t*stack = top->next;\n\t\tgit__free(top);\n\t}\n\treturn item;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list_node *git_commit_list_pop(git_commit_list **stack)\n{\n\tgit_commit_list *top = *stack;\n\tgit_commit_list_node *item = top ? top->item : NULL;\n\n\tif (top) {\n\t\t*stack = top->next;\n\t\tgit__free(top);\n\t}\n\treturn item;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int revwalk_next_unsorted(git_commit_list_node **object_out, git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list_node *next;\n\n\twhile ((next = git_commit_list_pop(&walk->iterator_rand)) != NULL)\n\t\tif (!next->uninteresting) {\n\t\t\tif ((error = process_commit_parents(walk, next)) < 0)\n\t\t\t\treturn error;\n\n\t\t\t*object_out = next;\n\t\t\treturn 0;\n\t\t}\n\n\tgiterr_clear();\n\treturn GIT_ITEROVER;\n}"
  },
  {
    "function_name": "revwalk_next_timesort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "322-338",
    "snippet": "static int revwalk_next_timesort(git_commit_list_node **object_out, git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list_node *next;\n\n\twhile ((next = git_pqueue_pop(&walk->iterator_time)) != NULL)\n\t\tif (!next->uninteresting) {\n\t\t\tif ((error = process_commit_parents(walk, next)) < 0)\n\t\t\t\treturn error;\n\n\t\t\t*object_out = next;\n\t\t\treturn 0;\n\t\t}\n\n\tgiterr_clear();\n\treturn GIT_ITEROVER;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "process_commit_parents",
          "args": [
            "walk",
            "next"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "process_commit_parents",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "120-133",
          "snippet": "static int process_commit_parents(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tunsigned short i, max;\n\tint error = 0;\n\n\tmax = commit->out_degree;\n\tif (walk->first_parent && commit->out_degree)\n\t\tmax = 1;\n\n\tfor (i = 0; i < max && !error; ++i)\n\t\terror = process_commit(walk, commit->parents[i], commit->uninteresting);\n\n\treturn error;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int process_commit_parents(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tunsigned short i, max;\n\tint error = 0;\n\n\tmax = commit->out_degree;\n\tif (walk->first_parent && commit->out_degree)\n\t\tmax = 1;\n\n\tfor (i = 0; i < max && !error; ++i)\n\t\terror = process_commit(walk, commit->parents[i], commit->uninteresting);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_pop",
          "args": [
            "&walk->iterator_time"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_pop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "102-117",
          "snippet": "void *git_pqueue_pop(git_pqueue *pq)\n{\n\tvoid *rval = git_pqueue_get(pq, 0);\n\n\tif (git_pqueue_size(pq) > 1) {\n\t\t/* move last item to top of heap, shrink, and push item down */\n\t\tpq->contents[0] = git_vector_last(pq);\n\t\tgit_vector_pop(pq);\n\t\tpqueue_down(pq, 0);\n\t} else {\n\t\t/* all we need to do is shrink the heap in this case */\n\t\tgit_vector_pop(pq);\n\t}\n\n\treturn rval;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nvoid *git_pqueue_pop(git_pqueue *pq)\n{\n\tvoid *rval = git_pqueue_get(pq, 0);\n\n\tif (git_pqueue_size(pq) > 1) {\n\t\t/* move last item to top of heap, shrink, and push item down */\n\t\tpq->contents[0] = git_vector_last(pq);\n\t\tgit_vector_pop(pq);\n\t\tpqueue_down(pq, 0);\n\t} else {\n\t\t/* all we need to do is shrink the heap in this case */\n\t\tgit_vector_pop(pq);\n\t}\n\n\treturn rval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int revwalk_next_timesort(git_commit_list_node **object_out, git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list_node *next;\n\n\twhile ((next = git_pqueue_pop(&walk->iterator_time)) != NULL)\n\t\tif (!next->uninteresting) {\n\t\t\tif ((error = process_commit_parents(walk, next)) < 0)\n\t\t\t\treturn error;\n\n\t\t\t*object_out = next;\n\t\t\treturn 0;\n\t\t}\n\n\tgiterr_clear();\n\treturn GIT_ITEROVER;\n}"
  },
  {
    "function_name": "revwalk_enqueue_unsorted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "317-320",
    "snippet": "static int revwalk_enqueue_unsorted(git_revwalk *walk, git_commit_list_node *commit)\n{\n\treturn git_commit_list_insert(commit, &walk->iterator_rand) ? 0 : -1;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_list_insert",
          "args": [
            "commit",
            "&walk->iterator_rand"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_insert_by_date",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "33-46",
          "snippet": "git_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int revwalk_enqueue_unsorted(git_revwalk *walk, git_commit_list_node *commit)\n{\n\treturn git_commit_list_insert(commit, &walk->iterator_rand) ? 0 : -1;\n}"
  },
  {
    "function_name": "revwalk_enqueue_timesort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "312-315",
    "snippet": "static int revwalk_enqueue_timesort(git_revwalk *walk, git_commit_list_node *commit)\n{\n\treturn git_pqueue_insert(&walk->iterator_time, commit);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pqueue_insert",
          "args": [
            "&walk->iterator_time",
            "commit"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "81-100",
          "snippet": "int git_pqueue_insert(git_pqueue *pq, void *item)\n{\n\tint error = 0;\n\n\t/* if heap is full, pop the top element if new one should replace it */\n\tif ((pq->flags & GIT_PQUEUE_FIXED_SIZE) != 0 &&\n\t\tpq->length >= pq->_alloc_size)\n\t{\n\t\t/* skip this item if below min item in heap */\n\t\tif (pq->_cmp(item, git_vector_get(pq, 0)) <= 0)\n\t\t\treturn 0;\n\t\t/* otherwise remove the min item before inserting new */\n\t\t(void)git_pqueue_pop(pq);\n\t}\n\n\tif (!(error = git_vector_insert(pq, item)))\n\t\tpqueue_up(pq, pq->length - 1);\n\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nint git_pqueue_insert(git_pqueue *pq, void *item)\n{\n\tint error = 0;\n\n\t/* if heap is full, pop the top element if new one should replace it */\n\tif ((pq->flags & GIT_PQUEUE_FIXED_SIZE) != 0 &&\n\t\tpq->length >= pq->_alloc_size)\n\t{\n\t\t/* skip this item if below min item in heap */\n\t\tif (pq->_cmp(item, git_vector_get(pq, 0)) <= 0)\n\t\t\treturn 0;\n\t\t/* otherwise remove the min item before inserting new */\n\t\t(void)git_pqueue_pop(pq);\n\t}\n\n\tif (!(error = git_vector_insert(pq, item)))\n\t\tpqueue_up(pq, pq->length - 1);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int revwalk_enqueue_timesort(git_revwalk *walk, git_commit_list_node *commit)\n{\n\treturn git_pqueue_insert(&walk->iterator_time, commit);\n}"
  },
  {
    "function_name": "git_revwalk_hide_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "306-310",
    "snippet": "int git_revwalk_hide_ref(git_revwalk *walk, const char *refname)\n{\n\tassert(walk && refname);\n\treturn push_ref(walk, refname, 1, false);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_ref",
          "args": [
            "walk",
            "refname",
            "1",
            "false"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "push_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "201-209",
          "snippet": "static int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk && refname"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_hide_ref(git_revwalk *walk, const char *refname)\n{\n\tassert(walk && refname);\n\treturn push_ref(walk, refname, 1, false);\n}"
  },
  {
    "function_name": "git_revwalk_push_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "281-304",
    "snippet": "int git_revwalk_push_range(git_revwalk *walk, const char *range)\n{\n\tgit_revspec revspec;\n\tint error = 0;\n\n\tif ((error = git_revparse(&revspec, walk->repo, range)))\n\t\treturn error;\n\n\tif (revspec.flags & GIT_REVPARSE_MERGE_BASE) {\n\t\t/* TODO: support \"<commit>...<commit>\" */\n\t\tgiterr_set(GITERR_INVALID, \"Symmetric differences not implemented in revwalk\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif ((error = push_commit(walk, git_object_id(revspec.from), 1, false)))\n\t\tgoto out;\n\n\terror = push_commit(walk, git_object_id(revspec.to), 0, false);\n\nout:\n\tgit_object_free(revspec.from);\n\tgit_object_free(revspec.to);\n\treturn error;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "revspec.to"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "push_commit",
          "args": [
            "walk",
            "git_object_id(revspec.to)",
            "0",
            "false"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "push_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "135-186",
          "snippet": "static int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_id",
          "args": [
            "revspec.to"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "209-213",
          "snippet": "const git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Symmetric differences not implemented in revwalk\""
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revparse",
          "args": [
            "&revspec",
            "walk->repo",
            "range"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "git_revparse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revparse.c",
          "lines": "878-913",
          "snippet": "int git_revparse(\n\tgit_revspec *revspec,\n\tgit_repository *repo,\n\tconst char *spec)\n{\n\tconst char *dotdot;\n\tint error = 0;\n\n\tassert(revspec && repo && spec);\n\n\tmemset(revspec, 0x0, sizeof(*revspec));\n\n\tif ((dotdot = strstr(spec, \"..\")) != NULL) {\n\t\tchar *lstr;\n\t\tconst char *rstr;\n\t\trevspec->flags = GIT_REVPARSE_RANGE;\n\n\t\tlstr = git__substrdup(spec, dotdot - spec);\n\t\trstr = dotdot + 2;\n\t\tif (dotdot[2] == '.') {\n\t\t\trevspec->flags |= GIT_REVPARSE_MERGE_BASE;\n\t\t\trstr++;\n\t\t}\n\n\t\terror = git_revparse_single(&revspec->from, repo, lstr);\n\t\tif (!error)\n\t\t\terror = git_revparse_single(&revspec->to, repo, rstr);\n\n\t\tgit__free((void*)lstr);\n\t} else {\n\t\trevspec->flags = GIT_REVPARSE_SINGLE;\n\t\terror = git_revparse_single(&revspec->from, repo, spec);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2.h\"",
            "#include \"refdb.h\"",
            "#include \"tree.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\"",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2.h\"\n#include \"refdb.h\"\n#include \"tree.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n#include <assert.h>\n\nint git_revparse(\n\tgit_revspec *revspec,\n\tgit_repository *repo,\n\tconst char *spec)\n{\n\tconst char *dotdot;\n\tint error = 0;\n\n\tassert(revspec && repo && spec);\n\n\tmemset(revspec, 0x0, sizeof(*revspec));\n\n\tif ((dotdot = strstr(spec, \"..\")) != NULL) {\n\t\tchar *lstr;\n\t\tconst char *rstr;\n\t\trevspec->flags = GIT_REVPARSE_RANGE;\n\n\t\tlstr = git__substrdup(spec, dotdot - spec);\n\t\trstr = dotdot + 2;\n\t\tif (dotdot[2] == '.') {\n\t\t\trevspec->flags |= GIT_REVPARSE_MERGE_BASE;\n\t\t\trstr++;\n\t\t}\n\n\t\terror = git_revparse_single(&revspec->from, repo, lstr);\n\t\tif (!error)\n\t\t\terror = git_revparse_single(&revspec->to, repo, rstr);\n\n\t\tgit__free((void*)lstr);\n\t} else {\n\t\trevspec->flags = GIT_REVPARSE_SINGLE;\n\t\terror = git_revparse_single(&revspec->from, repo, spec);\n\t}\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_push_range(git_revwalk *walk, const char *range)\n{\n\tgit_revspec revspec;\n\tint error = 0;\n\n\tif ((error = git_revparse(&revspec, walk->repo, range)))\n\t\treturn error;\n\n\tif (revspec.flags & GIT_REVPARSE_MERGE_BASE) {\n\t\t/* TODO: support \"<commit>...<commit>\" */\n\t\tgiterr_set(GITERR_INVALID, \"Symmetric differences not implemented in revwalk\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif ((error = push_commit(walk, git_object_id(revspec.from), 1, false)))\n\t\tgoto out;\n\n\terror = push_commit(walk, git_object_id(revspec.to), 0, false);\n\nout:\n\tgit_object_free(revspec.from);\n\tgit_object_free(revspec.to);\n\treturn error;\n}"
  },
  {
    "function_name": "git_revwalk_push_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "275-279",
    "snippet": "int git_revwalk_push_ref(git_revwalk *walk, const char *refname)\n{\n\tassert(walk && refname);\n\treturn push_ref(walk, refname, 0, false);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_ref",
          "args": [
            "walk",
            "refname",
            "0",
            "false"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "push_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "201-209",
          "snippet": "static int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk && refname"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_push_ref(git_revwalk *walk, const char *refname)\n{\n\tassert(walk && refname);\n\treturn push_ref(walk, refname, 0, false);\n}"
  },
  {
    "function_name": "git_revwalk_hide_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "269-273",
    "snippet": "int git_revwalk_hide_head(git_revwalk *walk)\n{\n\tassert(walk);\n\treturn push_ref(walk, GIT_HEAD_FILE, 1, false);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_ref",
          "args": [
            "walk",
            "GIT_HEAD_FILE",
            "1",
            "false"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "push_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "201-209",
          "snippet": "static int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_hide_head(git_revwalk *walk)\n{\n\tassert(walk);\n\treturn push_ref(walk, GIT_HEAD_FILE, 1, false);\n}"
  },
  {
    "function_name": "git_revwalk_push_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "263-267",
    "snippet": "int git_revwalk_push_head(git_revwalk *walk)\n{\n\tassert(walk);\n\treturn push_ref(walk, GIT_HEAD_FILE, 0, false);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_ref",
          "args": [
            "walk",
            "GIT_HEAD_FILE",
            "0",
            "false"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "push_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "201-209",
          "snippet": "static int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_push_head(git_revwalk *walk)\n{\n\tassert(walk);\n\treturn push_ref(walk, GIT_HEAD_FILE, 0, false);\n}"
  },
  {
    "function_name": "git_revwalk_hide_glob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "257-261",
    "snippet": "int git_revwalk_hide_glob(git_revwalk *walk, const char *glob)\n{\n\tassert(walk && glob);\n\treturn push_glob(walk, glob, 1);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_glob",
          "args": [
            "walk",
            "glob",
            "1"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "push_glob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "211-249",
          "snippet": "static int push_glob(git_revwalk *walk, const char *glob, int hide)\n{\n\tint error = 0;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_reference *ref;\n\tgit_reference_iterator *iter;\n\tsize_t wildcard;\n\n\tassert(walk && glob);\n\n\t/* refs/ is implied if not given in the glob */\n\tif (git__prefixcmp(glob, GIT_REFS_DIR) != 0)\n\t\tgit_buf_joinpath(&buf, GIT_REFS_DIR, glob);\n\telse\n\t\tgit_buf_puts(&buf, glob);\n\tGITERR_CHECK_ALLOC_BUF(&buf);\n\n\t/* If no '?', '*' or '[' exist, we append '/ *' to the glob */\n\twildcard = strcspn(glob, \"?*[\");\n\tif (!glob[wildcard])\n\t\tgit_buf_put(&buf, \"/*\", 2);\n\n\tif ((error = git_reference_iterator_glob_new(&iter, walk->repo, buf.ptr)) < 0)\n\t\tgoto out;\n\n\twhile ((error = git_reference_next(&ref, iter)) == 0) {\n\t\terror = push_ref(walk, git_reference_name(ref), hide, true);\n\t\tgit_reference_free(ref);\n\t\tif (error < 0)\n\t\t\tbreak;\n\t}\n\tgit_reference_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\nout:\n\tgit_buf_free(&buf);\n\treturn error;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_glob(git_revwalk *walk, const char *glob, int hide)\n{\n\tint error = 0;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_reference *ref;\n\tgit_reference_iterator *iter;\n\tsize_t wildcard;\n\n\tassert(walk && glob);\n\n\t/* refs/ is implied if not given in the glob */\n\tif (git__prefixcmp(glob, GIT_REFS_DIR) != 0)\n\t\tgit_buf_joinpath(&buf, GIT_REFS_DIR, glob);\n\telse\n\t\tgit_buf_puts(&buf, glob);\n\tGITERR_CHECK_ALLOC_BUF(&buf);\n\n\t/* If no '?', '*' or '[' exist, we append '/ *' to the glob */\n\twildcard = strcspn(glob, \"?*[\");\n\tif (!glob[wildcard])\n\t\tgit_buf_put(&buf, \"/*\", 2);\n\n\tif ((error = git_reference_iterator_glob_new(&iter, walk->repo, buf.ptr)) < 0)\n\t\tgoto out;\n\n\twhile ((error = git_reference_next(&ref, iter)) == 0) {\n\t\terror = push_ref(walk, git_reference_name(ref), hide, true);\n\t\tgit_reference_free(ref);\n\t\tif (error < 0)\n\t\t\tbreak;\n\t}\n\tgit_reference_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\nout:\n\tgit_buf_free(&buf);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk && glob"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_hide_glob(git_revwalk *walk, const char *glob)\n{\n\tassert(walk && glob);\n\treturn push_glob(walk, glob, 1);\n}"
  },
  {
    "function_name": "git_revwalk_push_glob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "251-255",
    "snippet": "int git_revwalk_push_glob(git_revwalk *walk, const char *glob)\n{\n\tassert(walk && glob);\n\treturn push_glob(walk, glob, 0);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_glob",
          "args": [
            "walk",
            "glob",
            "0"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "push_glob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "211-249",
          "snippet": "static int push_glob(git_revwalk *walk, const char *glob, int hide)\n{\n\tint error = 0;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_reference *ref;\n\tgit_reference_iterator *iter;\n\tsize_t wildcard;\n\n\tassert(walk && glob);\n\n\t/* refs/ is implied if not given in the glob */\n\tif (git__prefixcmp(glob, GIT_REFS_DIR) != 0)\n\t\tgit_buf_joinpath(&buf, GIT_REFS_DIR, glob);\n\telse\n\t\tgit_buf_puts(&buf, glob);\n\tGITERR_CHECK_ALLOC_BUF(&buf);\n\n\t/* If no '?', '*' or '[' exist, we append '/ *' to the glob */\n\twildcard = strcspn(glob, \"?*[\");\n\tif (!glob[wildcard])\n\t\tgit_buf_put(&buf, \"/*\", 2);\n\n\tif ((error = git_reference_iterator_glob_new(&iter, walk->repo, buf.ptr)) < 0)\n\t\tgoto out;\n\n\twhile ((error = git_reference_next(&ref, iter)) == 0) {\n\t\terror = push_ref(walk, git_reference_name(ref), hide, true);\n\t\tgit_reference_free(ref);\n\t\tif (error < 0)\n\t\t\tbreak;\n\t}\n\tgit_reference_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\nout:\n\tgit_buf_free(&buf);\n\treturn error;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_glob(git_revwalk *walk, const char *glob, int hide)\n{\n\tint error = 0;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_reference *ref;\n\tgit_reference_iterator *iter;\n\tsize_t wildcard;\n\n\tassert(walk && glob);\n\n\t/* refs/ is implied if not given in the glob */\n\tif (git__prefixcmp(glob, GIT_REFS_DIR) != 0)\n\t\tgit_buf_joinpath(&buf, GIT_REFS_DIR, glob);\n\telse\n\t\tgit_buf_puts(&buf, glob);\n\tGITERR_CHECK_ALLOC_BUF(&buf);\n\n\t/* If no '?', '*' or '[' exist, we append '/ *' to the glob */\n\twildcard = strcspn(glob, \"?*[\");\n\tif (!glob[wildcard])\n\t\tgit_buf_put(&buf, \"/*\", 2);\n\n\tif ((error = git_reference_iterator_glob_new(&iter, walk->repo, buf.ptr)) < 0)\n\t\tgoto out;\n\n\twhile ((error = git_reference_next(&ref, iter)) == 0) {\n\t\terror = push_ref(walk, git_reference_name(ref), hide, true);\n\t\tgit_reference_free(ref);\n\t\tif (error < 0)\n\t\t\tbreak;\n\t}\n\tgit_reference_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\nout:\n\tgit_buf_free(&buf);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk && glob"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_push_glob(git_revwalk *walk, const char *glob)\n{\n\tassert(walk && glob);\n\treturn push_glob(walk, glob, 0);\n}"
  },
  {
    "function_name": "push_glob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "211-249",
    "snippet": "static int push_glob(git_revwalk *walk, const char *glob, int hide)\n{\n\tint error = 0;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_reference *ref;\n\tgit_reference_iterator *iter;\n\tsize_t wildcard;\n\n\tassert(walk && glob);\n\n\t/* refs/ is implied if not given in the glob */\n\tif (git__prefixcmp(glob, GIT_REFS_DIR) != 0)\n\t\tgit_buf_joinpath(&buf, GIT_REFS_DIR, glob);\n\telse\n\t\tgit_buf_puts(&buf, glob);\n\tGITERR_CHECK_ALLOC_BUF(&buf);\n\n\t/* If no '?', '*' or '[' exist, we append '/ *' to the glob */\n\twildcard = strcspn(glob, \"?*[\");\n\tif (!glob[wildcard])\n\t\tgit_buf_put(&buf, \"/*\", 2);\n\n\tif ((error = git_reference_iterator_glob_new(&iter, walk->repo, buf.ptr)) < 0)\n\t\tgoto out;\n\n\twhile ((error = git_reference_next(&ref, iter)) == 0) {\n\t\terror = push_ref(walk, git_reference_name(ref), hide, true);\n\t\tgit_reference_free(ref);\n\t\tif (error < 0)\n\t\t\tbreak;\n\t}\n\tgit_reference_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\nout:\n\tgit_buf_free(&buf);\n\treturn error;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_iterator_free",
          "args": [
            "iter"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_iterator_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "742-748",
          "snippet": "void git_reference_iterator_free(git_reference_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\tgit_refdb_iterator_free(iter);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_iterator_free(git_reference_iterator *iter)\n{\n\tif (iter == NULL)\n\t\treturn;\n\n\tgit_refdb_iterator_free(iter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "ref"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "push_ref",
          "args": [
            "walk",
            "git_reference_name(ref)",
            "hide",
            "true"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "push_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "201-209",
          "snippet": "static int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_name",
          "args": [
            "ref"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "309-313",
          "snippet": "const char *git_reference_name(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->name;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst char *git_reference_name(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_next",
          "args": [
            "&ref",
            "iter"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_next_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "737-740",
          "snippet": "int git_reference_next_name(const char **out, git_reference_iterator *iter)\n{\n\treturn git_refdb_iterator_next_name(out, iter);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_next_name(const char **out, git_reference_iterator *iter)\n{\n\treturn git_refdb_iterator_next_name(out, iter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_iterator_glob_new",
          "args": [
            "&iter",
            "walk->repo",
            "buf.ptr"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_iterator_glob_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "721-730",
          "snippet": "int git_reference_iterator_glob_new(\n\tgit_reference_iterator **out, git_repository *repo, const char *glob)\n{\n\tgit_refdb *refdb;\n\n\tif (git_repository_refdb__weakptr(&refdb, repo) < 0)\n\t\treturn -1;\n\n\treturn git_refdb_iterator(out, refdb, glob);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_iterator_glob_new(\n\tgit_reference_iterator **out, git_repository *repo, const char *glob)\n{\n\tgit_refdb *refdb;\n\n\tif (git_repository_refdb__weakptr(&refdb, repo) < 0)\n\t\treturn -1;\n\n\treturn git_refdb_iterator(out, refdb, glob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "&buf",
            "\"/*\"",
            "2"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcspn",
          "args": [
            "glob",
            "\"?*[\""
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_BUF",
          "args": [
            "&buf"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "&buf",
            "glob"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&buf",
            "GIT_REFS_DIR",
            "glob"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__prefixcmp",
          "args": [
            "glob",
            "GIT_REFS_DIR"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "git__prefixcmp_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "252-255",
          "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk && glob"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_glob(git_revwalk *walk, const char *glob, int hide)\n{\n\tint error = 0;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_reference *ref;\n\tgit_reference_iterator *iter;\n\tsize_t wildcard;\n\n\tassert(walk && glob);\n\n\t/* refs/ is implied if not given in the glob */\n\tif (git__prefixcmp(glob, GIT_REFS_DIR) != 0)\n\t\tgit_buf_joinpath(&buf, GIT_REFS_DIR, glob);\n\telse\n\t\tgit_buf_puts(&buf, glob);\n\tGITERR_CHECK_ALLOC_BUF(&buf);\n\n\t/* If no '?', '*' or '[' exist, we append '/ *' to the glob */\n\twildcard = strcspn(glob, \"?*[\");\n\tif (!glob[wildcard])\n\t\tgit_buf_put(&buf, \"/*\", 2);\n\n\tif ((error = git_reference_iterator_glob_new(&iter, walk->repo, buf.ptr)) < 0)\n\t\tgoto out;\n\n\twhile ((error = git_reference_next(&ref, iter)) == 0) {\n\t\terror = push_ref(walk, git_reference_name(ref), hide, true);\n\t\tgit_reference_free(ref);\n\t\tif (error < 0)\n\t\t\tbreak;\n\t}\n\tgit_reference_iterator_free(iter);\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\nout:\n\tgit_buf_free(&buf);\n\treturn error;\n}"
  },
  {
    "function_name": "push_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "201-209",
    "snippet": "static int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_commit",
          "args": [
            "walk",
            "&oid",
            "hide",
            "from_glob"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "push_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "135-186",
          "snippet": "static int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_name_to_id",
          "args": [
            "&oid",
            "walk->repo",
            "refname"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "152-164",
          "snippet": "int git_reference_name_to_id(\n\tgit_oid *out, git_repository *repo, const char *name)\n{\n\tint error;\n\tgit_reference *ref;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, name, -1)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(out, git_reference_target(ref));\n\tgit_reference_free(ref);\n\treturn 0;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_name_to_id(\n\tgit_oid *out, git_repository *repo, const char *name)\n{\n\tint error;\n\tgit_reference *ref;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, name, -1)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(out, git_reference_target(ref));\n\tgit_reference_free(ref);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_ref(git_revwalk *walk, const char *refname, int hide, int from_glob)\n{\n\tgit_oid oid;\n\n\tif (git_reference_name_to_id(&oid, walk->repo, refname) < 0)\n\t\treturn -1;\n\n\treturn push_commit(walk, &oid, hide, from_glob);\n}"
  },
  {
    "function_name": "git_revwalk_hide",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "195-199",
    "snippet": "int git_revwalk_hide(git_revwalk *walk, const git_oid *oid)\n{\n\tassert(walk && oid);\n\treturn push_commit(walk, oid, 1, false);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_commit",
          "args": [
            "walk",
            "oid",
            "1",
            "false"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "push_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "135-186",
          "snippet": "static int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk && oid"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_hide(git_revwalk *walk, const git_oid *oid)\n{\n\tassert(walk && oid);\n\treturn push_commit(walk, oid, 1, false);\n}"
  },
  {
    "function_name": "git_revwalk_push",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "188-192",
    "snippet": "int git_revwalk_push(git_revwalk *walk, const git_oid *oid)\n{\n\tassert(walk && oid);\n\treturn push_commit(walk, oid, 0, false);\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_commit",
          "args": [
            "walk",
            "oid",
            "0",
            "false"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "push_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "135-186",
          "snippet": "static int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "walk && oid"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_push(git_revwalk *walk, const git_oid *oid)\n{\n\tassert(walk && oid);\n\treturn push_commit(walk, oid, 0, false);\n}"
  },
  {
    "function_name": "push_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "135-186",
    "snippet": "static int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set_oom",
          "args": [],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "45-48",
          "snippet": "void giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};\n\nvoid giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_list_insert",
          "args": [
            "commit",
            "&list"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_insert_by_date",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "33-46",
          "snippet": "git_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk__commit_lookup",
          "args": [
            "walk",
            "&commit_id"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk__commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "17-42",
          "snippet": "GIT__USE_OIDMAP\n\ngit_commit_list_node *git_revwalk__commit_lookup(\n\tgit_revwalk *walk, const git_oid *oid)\n{\n\tgit_commit_list_node *commit;\n\tkhiter_t pos;\n\tint ret;\n\n\t/* lookup and reserve space if not already present */\n\tpos = kh_get(oid, walk->commits, oid);\n\tif (pos != kh_end(walk->commits))\n\t\treturn kh_value(walk->commits, pos);\n\n\tcommit = git_commit_list_alloc_node(walk);\n\tif (commit == NULL)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&commit->oid, oid);\n\n\tpos = kh_put(oid, walk->commits, &commit->oid, &ret);\n\tassert(ret != 0);\n\tkh_value(walk->commits, pos) = commit;\n\n\treturn commit;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\ngit_commit_list_node *git_revwalk__commit_lookup(\n\tgit_revwalk *walk, const git_oid *oid)\n{\n\tgit_commit_list_node *commit;\n\tkhiter_t pos;\n\tint ret;\n\n\t/* lookup and reserve space if not already present */\n\tpos = kh_get(oid, walk->commits, oid);\n\tif (pos != kh_end(walk->commits))\n\t\treturn kh_value(walk->commits, pos);\n\n\tcommit = git_commit_list_alloc_node(walk);\n\tif (commit == NULL)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&commit->oid, oid);\n\n\tpos = kh_put(oid, walk->commits, &commit->oid, &ret);\n\tassert(ret != 0);\n\tkh_value(walk->commits, pos) = commit;\n\n\treturn commit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "obj"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&commit_id",
            "git_object_id(obj)"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_id",
          "args": [
            "obj"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "209-213",
          "snippet": "const git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Object is not a committish\""
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_peel",
          "args": [
            "&obj",
            "oobj",
            "GIT_OBJ_COMMIT"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "327-381",
          "snippet": "int git_object_peel(\n\tgit_object **peeled,\n\tconst git_object *object,\n\tgit_otype target_type)\n{\n\tgit_object *source, *deref = NULL;\n\tint error;\n\n\tassert(object && peeled);\n\n\tassert(target_type == GIT_OBJ_TAG ||\n\t\ttarget_type == GIT_OBJ_COMMIT ||\n\t\ttarget_type == GIT_OBJ_TREE ||\n\t\ttarget_type == GIT_OBJ_BLOB ||\n\t\ttarget_type == GIT_OBJ_ANY);\n\n\tif ((error = check_type_combination(git_object_type(object), target_type)) < 0)\n\t\treturn peel_error(error, git_object_id(object), target_type);\n\n\tif (git_object_type(object) == target_type)\n\t\treturn git_object_dup(peeled, (git_object *)object);\n\n\tsource = (git_object *)object;\n\n\twhile (!(error = dereference_object(&deref, source))) {\n\n\t\tif (source != object)\n\t\t\tgit_object_free(source);\n\n\t\tif (git_object_type(deref) == target_type) {\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (target_type == GIT_OBJ_ANY &&\n\t\t\tgit_object_type(deref) != git_object_type(object))\n\t\t{\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tsource = deref;\n\t\tderef = NULL;\n\t}\n\n\tif (source != object)\n\t\tgit_object_free(source);\n\n\tgit_object_free(deref);\n\n\tif (error)\n\t\terror = peel_error(error, git_object_id(object), target_type);\n\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_peel(\n\tgit_object **peeled,\n\tconst git_object *object,\n\tgit_otype target_type)\n{\n\tgit_object *source, *deref = NULL;\n\tint error;\n\n\tassert(object && peeled);\n\n\tassert(target_type == GIT_OBJ_TAG ||\n\t\ttarget_type == GIT_OBJ_COMMIT ||\n\t\ttarget_type == GIT_OBJ_TREE ||\n\t\ttarget_type == GIT_OBJ_BLOB ||\n\t\ttarget_type == GIT_OBJ_ANY);\n\n\tif ((error = check_type_combination(git_object_type(object), target_type)) < 0)\n\t\treturn peel_error(error, git_object_id(object), target_type);\n\n\tif (git_object_type(object) == target_type)\n\t\treturn git_object_dup(peeled, (git_object *)object);\n\n\tsource = (git_object *)object;\n\n\twhile (!(error = dereference_object(&deref, source))) {\n\n\t\tif (source != object)\n\t\t\tgit_object_free(source);\n\n\t\tif (git_object_type(deref) == target_type) {\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (target_type == GIT_OBJ_ANY &&\n\t\t\tgit_object_type(deref) != git_object_type(object))\n\t\t{\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tsource = deref;\n\t\tderef = NULL;\n\t}\n\n\tif (source != object)\n\t\tgit_object_free(source);\n\n\tgit_object_free(deref);\n\n\tif (error)\n\t\terror = peel_error(error, git_object_id(object), target_type);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_lookup",
          "args": [
            "&oobj",
            "walk->repo",
            "oid",
            "GIT_OBJ_ANY"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_lookup_bypath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "390-423",
          "snippet": "int git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int push_commit(git_revwalk *walk, const git_oid *oid, int uninteresting, int from_glob)\n{\n\tgit_oid commit_id;\n\tint error;\n\tgit_object *obj, *oobj;\n\tgit_commit_list_node *commit;\n\tgit_commit_list *list;\n\n\tif ((error = git_object_lookup(&oobj, walk->repo, oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\terror = git_object_peel(&obj, oobj, GIT_OBJ_COMMIT);\n\tgit_object_free(oobj);\n\n\tif (error == GIT_ENOTFOUND || error == GIT_EINVALIDSPEC || error == GIT_EPEEL) {\n\t\t/* If this comes from e.g. push_glob(\"tags\"), ignore this */\n\t\tif (from_glob)\n\t\t\treturn 0;\n\n\t\tgiterr_set(GITERR_INVALID, \"Object is not a committish\");\n\t\treturn -1;\n\t}\n\tif (error < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(&commit_id, git_object_id(obj));\n\tgit_object_free(obj);\n\n\tcommit = git_revwalk__commit_lookup(walk, &commit_id);\n\tif (commit == NULL)\n\t\treturn -1; /* error already reported by failed lookup */\n\n\t/* A previous hide already told us we don't want this commit  */\n\tif (commit->uninteresting)\n\t\treturn 0;\n\n\tif (uninteresting)\n\t\twalk->did_hide = 1;\n\telse\n\t\twalk->did_push = 1;\n\n\tcommit->uninteresting = uninteresting;\n\tlist = walk->user_input;\n\tif (git_commit_list_insert(commit, &list) == NULL) {\n\t\tgiterr_set_oom();\n\t\treturn -1;\n\t}\n\n\twalk->user_input = list;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "process_commit_parents",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "120-133",
    "snippet": "static int process_commit_parents(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tunsigned short i, max;\n\tint error = 0;\n\n\tmax = commit->out_degree;\n\tif (walk->first_parent && commit->out_degree)\n\t\tmax = 1;\n\n\tfor (i = 0; i < max && !error; ++i)\n\t\terror = process_commit(walk, commit->parents[i], commit->uninteresting);\n\n\treturn error;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "process_commit",
          "args": [
            "walk",
            "commit->parents[i]",
            "commit->uninteresting"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "process_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "96-118",
          "snippet": "static int process_commit(git_revwalk *walk, git_commit_list_node *commit, int hide)\n{\n\tint error;\n\n\tif (!hide && walk->hide_cb)\n\t\thide = walk->hide_cb(&commit->oid, walk->hide_cb_payload);\n\n\tif (hide && mark_uninteresting(walk, commit) < 0)\n\t\treturn -1;\n\n\tif (commit->seen)\n\t\treturn 0;\n\n\tcommit->seen = 1;\n\n\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\treturn error;\n\n\tif (!hide)\n\t\treturn walk->enqueue(walk, commit);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int process_commit(git_revwalk *walk, git_commit_list_node *commit, int hide)\n{\n\tint error;\n\n\tif (!hide && walk->hide_cb)\n\t\thide = walk->hide_cb(&commit->oid, walk->hide_cb_payload);\n\n\tif (hide && mark_uninteresting(walk, commit) < 0)\n\t\treturn -1;\n\n\tif (commit->seen)\n\t\treturn 0;\n\n\tcommit->seen = 1;\n\n\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\treturn error;\n\n\tif (!hide)\n\t\treturn walk->enqueue(walk, commit);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int process_commit_parents(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tunsigned short i, max;\n\tint error = 0;\n\n\tmax = commit->out_degree;\n\tif (walk->first_parent && commit->out_degree)\n\t\tmax = 1;\n\n\tfor (i = 0; i < max && !error; ++i)\n\t\terror = process_commit(walk, commit->parents[i], commit->uninteresting);\n\n\treturn error;\n}"
  },
  {
    "function_name": "process_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "96-118",
    "snippet": "static int process_commit(git_revwalk *walk, git_commit_list_node *commit, int hide)\n{\n\tint error;\n\n\tif (!hide && walk->hide_cb)\n\t\thide = walk->hide_cb(&commit->oid, walk->hide_cb_payload);\n\n\tif (hide && mark_uninteresting(walk, commit) < 0)\n\t\treturn -1;\n\n\tif (commit->seen)\n\t\treturn 0;\n\n\tcommit->seen = 1;\n\n\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\treturn error;\n\n\tif (!hide)\n\t\treturn walk->enqueue(walk, commit);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "walk->enqueue",
          "args": [
            "walk",
            "commit"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_commit_list_parse",
          "args": [
            "walk",
            "commit"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "177-199",
          "snippet": "int git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nint git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_uninteresting",
          "args": [
            "walk",
            "commit"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "mark_uninteresting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "64-94",
          "snippet": "static int mark_uninteresting(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tint error;\n\tunsigned short i;\n\tcommit_list_node_array pending = GIT_ARRAY_INIT;\n\tgit_commit_list_node **tmp;\n\n\tassert(commit);\n\n\tdo {\n\t\tcommit->uninteresting = 1;\n\n\t\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\t\treturn error;\n\n\t\tfor (i = 0; i < commit->out_degree; ++i)\n\t\t\tif (!commit->parents[i]->uninteresting) {\n\t\t\t\tgit_commit_list_node **node = git_array_alloc(pending);\n\t\t\t\tGITERR_CHECK_ALLOC(node);\n\t\t\t\t*node = commit->parents[i];\n\t\t\t}\n\n\t\ttmp = git_array_pop(pending);\n\t\tcommit = tmp ? *tmp : NULL;\n\n\t} while (commit != NULL && !interesting_arr(pending));\n\n\tgit_array_clear(pending);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int mark_uninteresting(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tint error;\n\tunsigned short i;\n\tcommit_list_node_array pending = GIT_ARRAY_INIT;\n\tgit_commit_list_node **tmp;\n\n\tassert(commit);\n\n\tdo {\n\t\tcommit->uninteresting = 1;\n\n\t\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\t\treturn error;\n\n\t\tfor (i = 0; i < commit->out_degree; ++i)\n\t\t\tif (!commit->parents[i]->uninteresting) {\n\t\t\t\tgit_commit_list_node **node = git_array_alloc(pending);\n\t\t\t\tGITERR_CHECK_ALLOC(node);\n\t\t\t\t*node = commit->parents[i];\n\t\t\t}\n\n\t\ttmp = git_array_pop(pending);\n\t\tcommit = tmp ? *tmp : NULL;\n\n\t} while (commit != NULL && !interesting_arr(pending));\n\n\tgit_array_clear(pending);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "walk->hide_cb",
          "args": [
            "&commit->oid",
            "walk->hide_cb_payload"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int process_commit(git_revwalk *walk, git_commit_list_node *commit, int hide)\n{\n\tint error;\n\n\tif (!hide && walk->hide_cb)\n\t\thide = walk->hide_cb(&commit->oid, walk->hide_cb_payload);\n\n\tif (hide && mark_uninteresting(walk, commit) < 0)\n\t\treturn -1;\n\n\tif (commit->seen)\n\t\treturn 0;\n\n\tcommit->seen = 1;\n\n\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\treturn error;\n\n\tif (!hide)\n\t\treturn walk->enqueue(walk, commit);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "mark_uninteresting",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "64-94",
    "snippet": "static int mark_uninteresting(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tint error;\n\tunsigned short i;\n\tcommit_list_node_array pending = GIT_ARRAY_INIT;\n\tgit_commit_list_node **tmp;\n\n\tassert(commit);\n\n\tdo {\n\t\tcommit->uninteresting = 1;\n\n\t\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\t\treturn error;\n\n\t\tfor (i = 0; i < commit->out_degree; ++i)\n\t\t\tif (!commit->parents[i]->uninteresting) {\n\t\t\t\tgit_commit_list_node **node = git_array_alloc(pending);\n\t\t\t\tGITERR_CHECK_ALLOC(node);\n\t\t\t\t*node = commit->parents[i];\n\t\t\t}\n\n\t\ttmp = git_array_pop(pending);\n\t\tcommit = tmp ? *tmp : NULL;\n\n\t} while (commit != NULL && !interesting_arr(pending));\n\n\tgit_array_clear(pending);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "pending"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "interesting_arr",
          "args": [
            "pending"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "interesting_arr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "46-62",
          "snippet": "static bool interesting_arr(commit_list_node_array arr)\n{\n\tgit_commit_list_node **n;\n\tsize_t i = 0, size;\n\n\tsize = git_array_size(arr);\n\tfor (i = 0; i < size; i++) {\n\t\tn = git_array_get(arr, i);\n\t\tif (!*n)\n\t\t\tbreak;\n\n\t\tif (!(*n)->uninteresting)\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic bool interesting_arr(commit_list_node_array arr)\n{\n\tgit_commit_list_node **n;\n\tsize_t i = 0, size;\n\n\tsize = git_array_size(arr);\n\tfor (i = 0; i < size; i++) {\n\t\tn = git_array_get(arr, i);\n\t\tif (!*n)\n\t\t\tbreak;\n\n\t\tif (!(*n)->uninteresting)\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_pop",
          "args": [
            "pending"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "node"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "pending"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_commit_list_parse",
          "args": [
            "walk",
            "commit"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "177-199",
          "snippet": "int git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nint git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "commit"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic int mark_uninteresting(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tint error;\n\tunsigned short i;\n\tcommit_list_node_array pending = GIT_ARRAY_INIT;\n\tgit_commit_list_node **tmp;\n\n\tassert(commit);\n\n\tdo {\n\t\tcommit->uninteresting = 1;\n\n\t\tif ((error = git_commit_list_parse(walk, commit)) < 0)\n\t\t\treturn error;\n\n\t\tfor (i = 0; i < commit->out_degree; ++i)\n\t\t\tif (!commit->parents[i]->uninteresting) {\n\t\t\t\tgit_commit_list_node **node = git_array_alloc(pending);\n\t\t\t\tGITERR_CHECK_ALLOC(node);\n\t\t\t\t*node = commit->parents[i];\n\t\t\t}\n\n\t\ttmp = git_array_pop(pending);\n\t\tcommit = tmp ? *tmp : NULL;\n\n\t} while (commit != NULL && !interesting_arr(pending));\n\n\tgit_array_clear(pending);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "interesting_arr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "46-62",
    "snippet": "static bool interesting_arr(commit_list_node_array arr)\n{\n\tgit_commit_list_node **n;\n\tsize_t i = 0, size;\n\n\tsize = git_array_size(arr);\n\tfor (i = 0; i < size; i++) {\n\t\tn = git_array_get(arr, i);\n\t\tif (!*n)\n\t\t\tbreak;\n\n\t\tif (!(*n)->uninteresting)\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "arr",
            "i"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "arr"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nstatic bool interesting_arr(commit_list_node_array arr)\n{\n\tgit_commit_list_node **n;\n\tsize_t i = 0, size;\n\n\tsize = git_array_size(arr);\n\tfor (i = 0; i < size; i++) {\n\t\tn = git_array_get(arr, i);\n\t\tif (!*n)\n\t\t\tbreak;\n\n\t\tif (!(*n)->uninteresting)\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "git_revwalk__commit_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
    "lines": "17-42",
    "snippet": "GIT__USE_OIDMAP\n\ngit_commit_list_node *git_revwalk__commit_lookup(\n\tgit_revwalk *walk, const git_oid *oid)\n{\n\tgit_commit_list_node *commit;\n\tkhiter_t pos;\n\tint ret;\n\n\t/* lookup and reserve space if not already present */\n\tpos = kh_get(oid, walk->commits, oid);\n\tif (pos != kh_end(walk->commits))\n\t\treturn kh_value(walk->commits, pos);\n\n\tcommit = git_commit_list_alloc_node(walk);\n\tif (commit == NULL)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&commit->oid, oid);\n\n\tpos = kh_put(oid, walk->commits, &commit->oid, &ret);\n\tassert(ret != 0);\n\tkh_value(walk->commits, pos) = commit;\n\n\treturn commit;\n}",
    "includes": [
      "#include \"merge.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"revwalk.h\"",
      "#include \"pool.h\"",
      "#include \"odb.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kh_value",
          "args": [
            "walk->commits",
            "pos"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ret != 0"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_put",
          "args": [
            "oid",
            "walk->commits",
            "&commit->oid",
            "&ret"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&commit->oid",
            "oid"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_list_alloc_node",
          "args": [
            "walk"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_alloc_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "48-51",
          "snippet": "git_commit_list_node *git_commit_list_alloc_node(git_revwalk *walk)\n{\n\treturn (git_commit_list_node *)git_pool_mallocz(&walk->commit_pool, 1);\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list_node *git_commit_list_alloc_node(git_revwalk *walk)\n{\n\treturn (git_commit_list_node *)git_pool_mallocz(&walk->commit_pool, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kh_value",
          "args": [
            "walk->commits",
            "pos"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_end",
          "args": [
            "walk->commits"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_get",
          "args": [
            "oid",
            "walk->commits",
            "oid"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\ngit_commit_list_node *git_revwalk__commit_lookup(\n\tgit_revwalk *walk, const git_oid *oid)\n{\n\tgit_commit_list_node *commit;\n\tkhiter_t pos;\n\tint ret;\n\n\t/* lookup and reserve space if not already present */\n\tpos = kh_get(oid, walk->commits, oid);\n\tif (pos != kh_end(walk->commits))\n\t\treturn kh_value(walk->commits, pos);\n\n\tcommit = git_commit_list_alloc_node(walk);\n\tif (commit == NULL)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&commit->oid, oid);\n\n\tpos = kh_put(oid, walk->commits, &commit->oid, &ret);\n\tassert(ret != 0);\n\tkh_value(walk->commits, pos) = commit;\n\n\treturn commit;\n}"
  }
]