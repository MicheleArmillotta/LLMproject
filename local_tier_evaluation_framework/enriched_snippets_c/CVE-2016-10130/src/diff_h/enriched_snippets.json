[
  {
    "function_name": "git_diff_file__resolve_zero_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.h",
    "lines": "151-171",
    "snippet": "GIT_INLINE(int) git_diff_file__resolve_zero_size(\n\tgit_diff_file *file, git_odb_object **odb_obj, git_repository *repo)\n{\n\tint error;\n\tgit_odb *odb;\n\tsize_t len;\n\tgit_otype type;\n\n\tif ((error = git_repository_odb(&odb, repo)) < 0)\n\t\treturn error;\n\n\terror = git_odb__read_header_or_object(\n\t\todb_obj, &len, &type, odb, &file->id);\n\n\tgit_odb_free(odb);\n\n\tif (!error)\n\t\tfile->size = (git_off_t)len;\n\n\treturn error;\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"repository.h\"",
      "#include \"iterator.h\"",
      "#include \"buffer.h\"",
      "#include \"vector.h\"",
      "#include <stdio.h>",
      "#include \"git2/oid.h\"",
      "#include \"git2/sys/diff.h\"",
      "#include \"git2/diff.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_free",
          "args": [
            "odb"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "619-625",
          "snippet": "void git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__read_header_or_object",
          "args": [
            "odb_obj",
            "&len",
            "&type",
            "odb",
            "&file->id"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__read_header_or_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "762-804",
          "snippet": "int git_odb__read_header_or_object(\n\tgit_odb_object **out, size_t *len_p, git_otype *type_p,\n\tgit_odb *db, const git_oid *id)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_odb_object *object;\n\n\tassert(db && id && out && len_p && type_p);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\t*len_p = object->cached.size;\n\t\t*type_p = object->cached.type;\n\t\t*out = object;\n\t\treturn 0;\n\t}\n\n\t*out = NULL;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->read_header != NULL)\n\t\t\terror = b->read_header(len_p, type_p, b, id);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/*\n\t * no backend could read only the header.\n\t * try reading the whole object and freeing the contents\n\t */\n\tif ((error = git_odb_read(&object, db, id)) < 0)\n\t\treturn error; /* error already set - pass along */\n\n\t*len_p = object->cached.size;\n\t*type_p = object->cached.type;\n\t*out = object;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__read_header_or_object(\n\tgit_odb_object **out, size_t *len_p, git_otype *type_p,\n\tgit_odb *db, const git_oid *id)\n{\n\tsize_t i;\n\tint error = GIT_ENOTFOUND;\n\tgit_odb_object *object;\n\n\tassert(db && id && out && len_p && type_p);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\t*len_p = object->cached.size;\n\t\t*type_p = object->cached.type;\n\t\t*out = object;\n\t\treturn 0;\n\t}\n\n\t*out = NULL;\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\tif (b->read_header != NULL)\n\t\t\terror = b->read_header(len_p, type_p, b, id);\n\t}\n\n\tif (!error || error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\t/*\n\t * no backend could read only the header.\n\t * try reading the whole object and freeing the contents\n\t */\n\tif ((error = git_odb_read(&object, db, id)) < 0)\n\t\treturn error; /* error already set - pass along */\n\n\t*len_p = object->cached.size;\n\t*type_p = object->cached.type;\n\t*out = object;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_odb",
          "args": [
            "&odb",
            "repo"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_odb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "764-771",
          "snippet": "int git_repository_odb(git_odb **out, git_repository *repo)\n{\n\tif (git_repository_odb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb(git_odb **out, git_repository *repo)\n{\n\tif (git_repository_odb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"repository.h\"\n#include \"iterator.h\"\n#include \"buffer.h\"\n#include \"vector.h\"\n#include <stdio.h>\n#include \"git2/oid.h\"\n#include \"git2/sys/diff.h\"\n#include \"git2/diff.h\"\n\nGIT_INLINE(int) git_diff_file__resolve_zero_size(\n\tgit_diff_file *file, git_odb_object **odb_obj, git_repository *repo)\n{\n\tint error;\n\tgit_odb *odb;\n\tsize_t len;\n\tgit_otype type;\n\n\tif ((error = git_repository_odb(&odb, repo)) < 0)\n\t\treturn error;\n\n\terror = git_odb__read_header_or_object(\n\t\todb_obj, &len, &type, odb, &file->id);\n\n\tgit_odb_free(odb);\n\n\tif (!error)\n\t\tfile->size = (git_off_t)len;\n\n\treturn error;\n}"
  }
]