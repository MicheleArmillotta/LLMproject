[
  {
    "function_name": "git_commit_list_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "177-199",
    "snippet": "int git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_object_free",
          "args": [
            "obj"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "137-143",
          "snippet": "void git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_object_free(git_odb_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "commit_quick_parse",
          "args": [
            "walk",
            "commit",
            "(const uint8_t *)git_odb_object_data(obj)",
            "git_odb_object_size(obj)"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "commit_quick_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "103-175",
          "snippet": "static int commit_quick_parse(\n\tgit_revwalk *walk,\n\tgit_commit_list_node *commit,\n\tconst uint8_t *buffer,\n\tsize_t buffer_len)\n{\n\tconst size_t parent_len = strlen(\"parent \") + GIT_OID_HEXSZ + 1;\n\tconst uint8_t *buffer_end = buffer + buffer_len;\n\tconst uint8_t *parents_start, *committer_start;\n\tint i, parents = 0;\n\tint64_t commit_time;\n\n\tbuffer += strlen(\"tree \") + GIT_OID_HEXSZ + 1;\n\n\tparents_start = buffer;\n\twhile (buffer + parent_len < buffer_end && memcmp(buffer, \"parent \", strlen(\"parent \")) == 0) {\n\t\tparents++;\n\t\tbuffer += parent_len;\n\t}\n\n\tcommit->parents = alloc_parents(walk, commit, parents);\n\tGITERR_CHECK_ALLOC(commit->parents);\n\n\tbuffer = parents_start;\n\tfor (i = 0; i < parents; ++i) {\n\t\tgit_oid oid;\n\n\t\tif (git_oid_fromstr(&oid, (const char *)buffer + strlen(\"parent \")) < 0)\n\t\t\treturn -1;\n\n\t\tcommit->parents[i] = git_revwalk__commit_lookup(walk, &oid);\n\t\tif (commit->parents[i] == NULL)\n\t\t\treturn -1;\n\n\t\tbuffer += parent_len;\n\t}\n\n\tcommit->out_degree = (unsigned short)parents;\n\n\tif ((committer_start = buffer = memchr(buffer, '\\n', buffer_end - buffer)) == NULL)\n\t\treturn commit_error(commit, \"object is corrupted\");\n\n\tbuffer++;\n\n\tif ((buffer = memchr(buffer, '\\n', buffer_end - buffer)) == NULL)\n\t\treturn commit_error(commit, \"object is corrupted\");\n\n\t/* Skip trailing spaces */\n\twhile (buffer > committer_start && git__isspace(*buffer))\n\t\tbuffer--;\n\n\t/* Seek for the beginning of the pack of digits */\n\twhile (buffer > committer_start && git__isdigit(*buffer))\n\t\tbuffer--;\n\n\t/* Skip potential timezone offset */\n\tif ((buffer > committer_start) && (*buffer == '+' || *buffer == '-')) {\n\t\tbuffer--;\n\n\t\twhile (buffer > committer_start && git__isspace(*buffer))\n\t\t\tbuffer--;\n\n\t\twhile (buffer > committer_start && git__isdigit(*buffer))\n\t\t\tbuffer--;\n\t}\n\n\tif ((buffer == committer_start) || (git__strtol64(&commit_time, (char *)(buffer + 1), NULL, 10) < 0))\n\t\treturn commit_error(commit, \"cannot parse commit time\");\n\n\tcommit->time = commit_time;\n\tcommit->parsed = 1;\n\treturn 0;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nstatic int commit_quick_parse(\n\tgit_revwalk *walk,\n\tgit_commit_list_node *commit,\n\tconst uint8_t *buffer,\n\tsize_t buffer_len)\n{\n\tconst size_t parent_len = strlen(\"parent \") + GIT_OID_HEXSZ + 1;\n\tconst uint8_t *buffer_end = buffer + buffer_len;\n\tconst uint8_t *parents_start, *committer_start;\n\tint i, parents = 0;\n\tint64_t commit_time;\n\n\tbuffer += strlen(\"tree \") + GIT_OID_HEXSZ + 1;\n\n\tparents_start = buffer;\n\twhile (buffer + parent_len < buffer_end && memcmp(buffer, \"parent \", strlen(\"parent \")) == 0) {\n\t\tparents++;\n\t\tbuffer += parent_len;\n\t}\n\n\tcommit->parents = alloc_parents(walk, commit, parents);\n\tGITERR_CHECK_ALLOC(commit->parents);\n\n\tbuffer = parents_start;\n\tfor (i = 0; i < parents; ++i) {\n\t\tgit_oid oid;\n\n\t\tif (git_oid_fromstr(&oid, (const char *)buffer + strlen(\"parent \")) < 0)\n\t\t\treturn -1;\n\n\t\tcommit->parents[i] = git_revwalk__commit_lookup(walk, &oid);\n\t\tif (commit->parents[i] == NULL)\n\t\t\treturn -1;\n\n\t\tbuffer += parent_len;\n\t}\n\n\tcommit->out_degree = (unsigned short)parents;\n\n\tif ((committer_start = buffer = memchr(buffer, '\\n', buffer_end - buffer)) == NULL)\n\t\treturn commit_error(commit, \"object is corrupted\");\n\n\tbuffer++;\n\n\tif ((buffer = memchr(buffer, '\\n', buffer_end - buffer)) == NULL)\n\t\treturn commit_error(commit, \"object is corrupted\");\n\n\t/* Skip trailing spaces */\n\twhile (buffer > committer_start && git__isspace(*buffer))\n\t\tbuffer--;\n\n\t/* Seek for the beginning of the pack of digits */\n\twhile (buffer > committer_start && git__isdigit(*buffer))\n\t\tbuffer--;\n\n\t/* Skip potential timezone offset */\n\tif ((buffer > committer_start) && (*buffer == '+' || *buffer == '-')) {\n\t\tbuffer--;\n\n\t\twhile (buffer > committer_start && git__isspace(*buffer))\n\t\t\tbuffer--;\n\n\t\twhile (buffer > committer_start && git__isdigit(*buffer))\n\t\t\tbuffer--;\n\t}\n\n\tif ((buffer == committer_start) || (git__strtol64(&commit_time, (char *)(buffer + 1), NULL, 10) < 0))\n\t\treturn commit_error(commit, \"cannot parse commit time\");\n\n\tcommit->time = commit_time;\n\tcommit->parsed = 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_object_size",
          "args": [
            "obj"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "120-123",
          "snippet": "size_t git_odb_object_size(git_odb_object *object)\n{\n\treturn object->cached.size;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nsize_t git_odb_object_size(git_odb_object *object)\n{\n\treturn object->cached.size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_object_data",
          "args": [
            "obj"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "115-118",
          "snippet": "const void *git_odb_object_data(git_odb_object *object)\n{\n\treturn object->buffer;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nconst void *git_odb_object_data(git_odb_object *object)\n{\n\treturn object->buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Object is no commit object\""
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_read",
          "args": [
            "&obj",
            "walk->odb",
            "&commit->oid"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "862-881",
          "snippet": "int git_odb_read(git_odb_object **out, git_odb *db, const git_oid *id)\n{\n\tint error;\n\n\tassert(out && db && id);\n\n\t*out = git_cache_get_raw(odb_cache(db), id);\n\tif (*out != NULL)\n\t\treturn 0;\n\n\terror = odb_read_1(out, db, id, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_read_1(out, db, id, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id\", id, GIT_OID_HEXSZ);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_read(git_odb_object **out, git_odb *db, const git_oid *id)\n{\n\tint error;\n\n\tassert(out && db && id);\n\n\t*out = git_cache_get_raw(odb_cache(db), id);\n\tif (*out != NULL)\n\t\treturn 0;\n\n\terror = odb_read_1(out, db, id, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_read_1(out, db, id, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id\", id, GIT_OID_HEXSZ);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nint git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}"
  },
  {
    "function_name": "commit_quick_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "103-175",
    "snippet": "static int commit_quick_parse(\n\tgit_revwalk *walk,\n\tgit_commit_list_node *commit,\n\tconst uint8_t *buffer,\n\tsize_t buffer_len)\n{\n\tconst size_t parent_len = strlen(\"parent \") + GIT_OID_HEXSZ + 1;\n\tconst uint8_t *buffer_end = buffer + buffer_len;\n\tconst uint8_t *parents_start, *committer_start;\n\tint i, parents = 0;\n\tint64_t commit_time;\n\n\tbuffer += strlen(\"tree \") + GIT_OID_HEXSZ + 1;\n\n\tparents_start = buffer;\n\twhile (buffer + parent_len < buffer_end && memcmp(buffer, \"parent \", strlen(\"parent \")) == 0) {\n\t\tparents++;\n\t\tbuffer += parent_len;\n\t}\n\n\tcommit->parents = alloc_parents(walk, commit, parents);\n\tGITERR_CHECK_ALLOC(commit->parents);\n\n\tbuffer = parents_start;\n\tfor (i = 0; i < parents; ++i) {\n\t\tgit_oid oid;\n\n\t\tif (git_oid_fromstr(&oid, (const char *)buffer + strlen(\"parent \")) < 0)\n\t\t\treturn -1;\n\n\t\tcommit->parents[i] = git_revwalk__commit_lookup(walk, &oid);\n\t\tif (commit->parents[i] == NULL)\n\t\t\treturn -1;\n\n\t\tbuffer += parent_len;\n\t}\n\n\tcommit->out_degree = (unsigned short)parents;\n\n\tif ((committer_start = buffer = memchr(buffer, '\\n', buffer_end - buffer)) == NULL)\n\t\treturn commit_error(commit, \"object is corrupted\");\n\n\tbuffer++;\n\n\tif ((buffer = memchr(buffer, '\\n', buffer_end - buffer)) == NULL)\n\t\treturn commit_error(commit, \"object is corrupted\");\n\n\t/* Skip trailing spaces */\n\twhile (buffer > committer_start && git__isspace(*buffer))\n\t\tbuffer--;\n\n\t/* Seek for the beginning of the pack of digits */\n\twhile (buffer > committer_start && git__isdigit(*buffer))\n\t\tbuffer--;\n\n\t/* Skip potential timezone offset */\n\tif ((buffer > committer_start) && (*buffer == '+' || *buffer == '-')) {\n\t\tbuffer--;\n\n\t\twhile (buffer > committer_start && git__isspace(*buffer))\n\t\t\tbuffer--;\n\n\t\twhile (buffer > committer_start && git__isdigit(*buffer))\n\t\t\tbuffer--;\n\t}\n\n\tif ((buffer == committer_start) || (git__strtol64(&commit_time, (char *)(buffer + 1), NULL, 10) < 0))\n\t\treturn commit_error(commit, \"cannot parse commit time\");\n\n\tcommit->time = commit_time;\n\tcommit->parsed = 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "commit_error",
          "args": [
            "commit",
            "\"cannot parse commit time\""
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "commit_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "53-62",
          "snippet": "static int commit_error(git_commit_list_node *commit, const char *msg)\n{\n\tchar commit_oid[GIT_OID_HEXSZ + 1];\n\tgit_oid_fmt(commit_oid, &commit->oid);\n\tcommit_oid[GIT_OID_HEXSZ] = '\\0';\n\n\tgiterr_set(GITERR_ODB, \"Failed to parse commit %s - %s\", commit_oid, msg);\n\n\treturn -1;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nstatic int commit_error(git_commit_list_node *commit, const char *msg)\n{\n\tchar commit_oid[GIT_OID_HEXSZ + 1];\n\tgit_oid_fmt(commit_oid, &commit->oid);\n\tcommit_oid[GIT_OID_HEXSZ] = '\\0';\n\n\tgiterr_set(GITERR_ODB, \"Failed to parse commit %s - %s\", commit_oid, msg);\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strtol64",
          "args": [
            "&commit_time",
            "(char *)(buffer + 1)",
            "NULL",
            "10"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "git__strtol64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "67-147",
          "snippet": "int git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__isdigit",
          "args": [
            "*buffer"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "git__isdigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "449-452",
          "snippet": "GIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__isspace",
          "args": [
            "*buffer"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "git__isspace_nonlf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "459-462",
          "snippet": "GIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}"
        }
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "buffer",
            "'\\n'",
            "buffer_end - buffer"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "buffer",
            "'\\n'",
            "buffer_end - buffer"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_revwalk__commit_lookup",
          "args": [
            "walk",
            "&oid"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk__commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "17-42",
          "snippet": "GIT__USE_OIDMAP\n\ngit_commit_list_node *git_revwalk__commit_lookup(\n\tgit_revwalk *walk, const git_oid *oid)\n{\n\tgit_commit_list_node *commit;\n\tkhiter_t pos;\n\tint ret;\n\n\t/* lookup and reserve space if not already present */\n\tpos = kh_get(oid, walk->commits, oid);\n\tif (pos != kh_end(walk->commits))\n\t\treturn kh_value(walk->commits, pos);\n\n\tcommit = git_commit_list_alloc_node(walk);\n\tif (commit == NULL)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&commit->oid, oid);\n\n\tpos = kh_put(oid, walk->commits, &commit->oid, &ret);\n\tassert(ret != 0);\n\tkh_value(walk->commits, pos) = commit;\n\n\treturn commit;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\ngit_commit_list_node *git_revwalk__commit_lookup(\n\tgit_revwalk *walk, const git_oid *oid)\n{\n\tgit_commit_list_node *commit;\n\tkhiter_t pos;\n\tint ret;\n\n\t/* lookup and reserve space if not already present */\n\tpos = kh_get(oid, walk->commits, oid);\n\tif (pos != kh_end(walk->commits))\n\t\treturn kh_value(walk->commits, pos);\n\n\tcommit = git_commit_list_alloc_node(walk);\n\tif (commit == NULL)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&commit->oid, oid);\n\n\tpos = kh_put(oid, walk->commits, &commit->oid, &ret);\n\tassert(ret != 0);\n\tkh_value(walk->commits, pos) = commit;\n\n\treturn commit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fromstr",
          "args": [
            "&oid",
            "(const char *)buffer + strlen(\"parent \")"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "54-57",
          "snippet": "int git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"parent \""
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "commit->parents"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_parents",
          "args": [
            "walk",
            "commit",
            "parents"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_parents",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "64-72",
          "snippet": "static git_commit_list_node **alloc_parents(\n\tgit_revwalk *walk, git_commit_list_node *commit, size_t n_parents)\n{\n\tif (n_parents <= PARENTS_PER_COMMIT)\n\t\treturn (git_commit_list_node **)((char *)commit + sizeof(git_commit_list_node));\n\n\treturn (git_commit_list_node **)git_pool_malloc(\n\t\t&walk->commit_pool, (uint32_t)(n_parents * sizeof(git_commit_list_node *)));\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nstatic git_commit_list_node **alloc_parents(\n\tgit_revwalk *walk, git_commit_list_node *commit, size_t n_parents)\n{\n\tif (n_parents <= PARENTS_PER_COMMIT)\n\t\treturn (git_commit_list_node **)((char *)commit + sizeof(git_commit_list_node));\n\n\treturn (git_commit_list_node **)git_pool_malloc(\n\t\t&walk->commit_pool, (uint32_t)(n_parents * sizeof(git_commit_list_node *)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "buffer",
            "\"parent \"",
            "strlen(\"parent \")"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"parent \""
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"tree \""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"parent \""
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nstatic int commit_quick_parse(\n\tgit_revwalk *walk,\n\tgit_commit_list_node *commit,\n\tconst uint8_t *buffer,\n\tsize_t buffer_len)\n{\n\tconst size_t parent_len = strlen(\"parent \") + GIT_OID_HEXSZ + 1;\n\tconst uint8_t *buffer_end = buffer + buffer_len;\n\tconst uint8_t *parents_start, *committer_start;\n\tint i, parents = 0;\n\tint64_t commit_time;\n\n\tbuffer += strlen(\"tree \") + GIT_OID_HEXSZ + 1;\n\n\tparents_start = buffer;\n\twhile (buffer + parent_len < buffer_end && memcmp(buffer, \"parent \", strlen(\"parent \")) == 0) {\n\t\tparents++;\n\t\tbuffer += parent_len;\n\t}\n\n\tcommit->parents = alloc_parents(walk, commit, parents);\n\tGITERR_CHECK_ALLOC(commit->parents);\n\n\tbuffer = parents_start;\n\tfor (i = 0; i < parents; ++i) {\n\t\tgit_oid oid;\n\n\t\tif (git_oid_fromstr(&oid, (const char *)buffer + strlen(\"parent \")) < 0)\n\t\t\treturn -1;\n\n\t\tcommit->parents[i] = git_revwalk__commit_lookup(walk, &oid);\n\t\tif (commit->parents[i] == NULL)\n\t\t\treturn -1;\n\n\t\tbuffer += parent_len;\n\t}\n\n\tcommit->out_degree = (unsigned short)parents;\n\n\tif ((committer_start = buffer = memchr(buffer, '\\n', buffer_end - buffer)) == NULL)\n\t\treturn commit_error(commit, \"object is corrupted\");\n\n\tbuffer++;\n\n\tif ((buffer = memchr(buffer, '\\n', buffer_end - buffer)) == NULL)\n\t\treturn commit_error(commit, \"object is corrupted\");\n\n\t/* Skip trailing spaces */\n\twhile (buffer > committer_start && git__isspace(*buffer))\n\t\tbuffer--;\n\n\t/* Seek for the beginning of the pack of digits */\n\twhile (buffer > committer_start && git__isdigit(*buffer))\n\t\tbuffer--;\n\n\t/* Skip potential timezone offset */\n\tif ((buffer > committer_start) && (*buffer == '+' || *buffer == '-')) {\n\t\tbuffer--;\n\n\t\twhile (buffer > committer_start && git__isspace(*buffer))\n\t\t\tbuffer--;\n\n\t\twhile (buffer > committer_start && git__isdigit(*buffer))\n\t\t\tbuffer--;\n\t}\n\n\tif ((buffer == committer_start) || (git__strtol64(&commit_time, (char *)(buffer + 1), NULL, 10) < 0))\n\t\treturn commit_error(commit, \"cannot parse commit time\");\n\n\tcommit->time = commit_time;\n\tcommit->parsed = 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_commit_list_pop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "91-101",
    "snippet": "git_commit_list_node *git_commit_list_pop(git_commit_list **stack)\n{\n\tgit_commit_list *top = *stack;\n\tgit_commit_list_node *item = top ? top->item : NULL;\n\n\tif (top) {\n\t\t*stack = top->next;\n\t\tgit__free(top);\n\t}\n\treturn item;\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "top"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list_node *git_commit_list_pop(git_commit_list **stack)\n{\n\tgit_commit_list *top = *stack;\n\tgit_commit_list_node *item = top ? top->item : NULL;\n\n\tif (top) {\n\t\t*stack = top->next;\n\t\tgit__free(top);\n\t}\n\treturn item;\n}"
  },
  {
    "function_name": "git_commit_list_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "75-89",
    "snippet": "void git_commit_list_free(git_commit_list **list_p)\n{\n\tgit_commit_list *list = *list_p;\n\n\tif (list == NULL)\n\t\treturn;\n\n\twhile (list) {\n\t\tgit_commit_list *temp = list;\n\t\tlist = temp->next;\n\t\tgit__free(temp);\n\t}\n\n\t*list_p = NULL;\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "temp"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nvoid git_commit_list_free(git_commit_list **list_p)\n{\n\tgit_commit_list *list = *list_p;\n\n\tif (list == NULL)\n\t\treturn;\n\n\twhile (list) {\n\t\tgit_commit_list *temp = list;\n\t\tlist = temp->next;\n\t\tgit__free(temp);\n\t}\n\n\t*list_p = NULL;\n}"
  },
  {
    "function_name": "alloc_parents",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "64-72",
    "snippet": "static git_commit_list_node **alloc_parents(\n\tgit_revwalk *walk, git_commit_list_node *commit, size_t n_parents)\n{\n\tif (n_parents <= PARENTS_PER_COMMIT)\n\t\treturn (git_commit_list_node **)((char *)commit + sizeof(git_commit_list_node));\n\n\treturn (git_commit_list_node **)git_pool_malloc(\n\t\t&walk->commit_pool, (uint32_t)(n_parents * sizeof(git_commit_list_node *)));\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pool_malloc",
          "args": [
            "&walk->commit_pool",
            "(uint32_t)(n_parents * sizeof(git_commit_list_node *))"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_mallocz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "181-188",
          "snippet": "void *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nvoid *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nstatic git_commit_list_node **alloc_parents(\n\tgit_revwalk *walk, git_commit_list_node *commit, size_t n_parents)\n{\n\tif (n_parents <= PARENTS_PER_COMMIT)\n\t\treturn (git_commit_list_node **)((char *)commit + sizeof(git_commit_list_node));\n\n\treturn (git_commit_list_node **)git_pool_malloc(\n\t\t&walk->commit_pool, (uint32_t)(n_parents * sizeof(git_commit_list_node *)));\n}"
  },
  {
    "function_name": "commit_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "53-62",
    "snippet": "static int commit_error(git_commit_list_node *commit, const char *msg)\n{\n\tchar commit_oid[GIT_OID_HEXSZ + 1];\n\tgit_oid_fmt(commit_oid, &commit->oid);\n\tcommit_oid[GIT_OID_HEXSZ] = '\\0';\n\n\tgiterr_set(GITERR_ODB, \"Failed to parse commit %s - %s\", commit_oid, msg);\n\n\treturn -1;\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_ODB",
            "\"Failed to parse commit %s - %s\"",
            "commit_oid",
            "msg"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "commit_oid",
            "&commit->oid"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nstatic int commit_error(git_commit_list_node *commit, const char *msg)\n{\n\tchar commit_oid[GIT_OID_HEXSZ + 1];\n\tgit_oid_fmt(commit_oid, &commit->oid);\n\tcommit_oid[GIT_OID_HEXSZ] = '\\0';\n\n\tgiterr_set(GITERR_ODB, \"Failed to parse commit %s - %s\", commit_oid, msg);\n\n\treturn -1;\n}"
  },
  {
    "function_name": "git_commit_list_alloc_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "48-51",
    "snippet": "git_commit_list_node *git_commit_list_alloc_node(git_revwalk *walk)\n{\n\treturn (git_commit_list_node *)git_pool_mallocz(&walk->commit_pool, 1);\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pool_mallocz",
          "args": [
            "&walk->commit_pool",
            "1"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_mallocz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "181-188",
          "snippet": "void *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nvoid *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list_node *git_commit_list_alloc_node(git_revwalk *walk)\n{\n\treturn (git_commit_list_node *)git_pool_mallocz(&walk->commit_pool, 1);\n}"
  },
  {
    "function_name": "git_commit_list_insert_by_date",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "33-46",
    "snippet": "git_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_list_insert",
          "args": [
            "item",
            "pp"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_insert_by_date",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "33-46",
          "snippet": "git_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_list_time_cmp",
          "args": [
            "p->item",
            "item"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_time_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "14-20",
          "snippet": "int git_commit_list_time_cmp(const void *a, const void *b)\n{\n\tconst git_commit_list_node *commit_a = a;\n\tconst git_commit_list_node *commit_b = b;\n\n\treturn (commit_a->time < commit_b->time);\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nint git_commit_list_time_cmp(const void *a, const void *b)\n{\n\tconst git_commit_list_node *commit_a = a;\n\tconst git_commit_list_node *commit_b = b;\n\n\treturn (commit_a->time < commit_b->time);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list *git_commit_list_insert_by_date(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list **pp = list_p;\n\tgit_commit_list *p;\n\n\twhile ((p = *pp) != NULL) {\n\t\tif (git_commit_list_time_cmp(p->item, item) > 0)\n\t\t\tbreak;\n\n\t\tpp = &p->next;\n\t}\n\n\treturn git_commit_list_insert(item, pp);\n}"
  },
  {
    "function_name": "git_commit_list_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "22-31",
    "snippet": "git_commit_list *git_commit_list_insert(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list *new_list = git__malloc(sizeof(git_commit_list));\n\tif (new_list != NULL) {\n\t\tnew_list->item = item;\n\t\tnew_list->next = *list_p;\n\t}\n\t*list_p = new_list;\n\treturn new_list;\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(git_commit_list)"
          ],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\ngit_commit_list *git_commit_list_insert(git_commit_list_node *item, git_commit_list **list_p)\n{\n\tgit_commit_list *new_list = git__malloc(sizeof(git_commit_list));\n\tif (new_list != NULL) {\n\t\tnew_list->item = item;\n\t\tnew_list->next = *list_p;\n\t}\n\t*list_p = new_list;\n\treturn new_list;\n}"
  },
  {
    "function_name": "git_commit_list_time_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
    "lines": "14-20",
    "snippet": "int git_commit_list_time_cmp(const void *a, const void *b)\n{\n\tconst git_commit_list_node *commit_a = a;\n\tconst git_commit_list_node *commit_b = b;\n\n\treturn (commit_a->time < commit_b->time);\n}",
    "includes": [
      "#include \"odb.h\"",
      "#include \"pool.h\"",
      "#include \"revwalk.h\"",
      "#include \"common.h\"",
      "#include \"commit_list.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nint git_commit_list_time_cmp(const void *a, const void *b)\n{\n\tconst git_commit_list_node *commit_a = a;\n\tconst git_commit_list_node *commit_b = b;\n\n\treturn (commit_a->time < commit_b->time);\n}"
  }
]