[
  {
    "function_name": "git_cached_obj_decref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "262-281",
    "snippet": "void git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "_obj"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object__free",
          "args": [
            "_obj"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "git_object__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "99-108",
          "snippet": "void git_object__free(void *obj)\n{\n\tgit_otype type = ((git_object *)obj)->cached.type;\n\n\tif (type < 0 || ((size_t)type) >= ARRAY_SIZE(git_objects_table) ||\n\t\t!git_objects_table[type].free)\n\t\tgit__free(obj);\n\telse\n\t\tgit_objects_table[type].free(obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nstatic git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};\n\nvoid git_object__free(void *obj)\n{\n\tgit_otype type = ((git_object *)obj)->cached.type;\n\n\tif (type < 0 || ((size_t)type) >= ARRAY_SIZE(git_objects_table) ||\n\t\t!git_objects_table[type].free)\n\t\tgit__free(obj);\n\telse\n\t\tgit_objects_table[type].free(obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_object__free",
          "args": [
            "_obj"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_object__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "102-108",
          "snippet": "void git_odb_object__free(void *object)\n{\n\tif (object != NULL) {\n\t\tgit__free(((git_odb_object *)object)->buffer);\n\t\tgit__free(object);\n\t}\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_object__free(void *object)\n{\n\tif (object != NULL) {\n\t\tgit__free(((git_odb_object *)object)->buffer);\n\t\tgit__free(object);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_atomic_dec",
          "args": [
            "&obj->refcount"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "182-185",
          "snippet": "GIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "git_cache_get_any",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "257-260",
    "snippet": "void *git_cache_get_any(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_ANY);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_get",
          "args": [
            "cache",
            "oid",
            "GIT_CACHE_STORE_ANY"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "cache_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "151-173",
          "snippet": "static void *cache_get(git_cache *cache, const git_oid *oid, unsigned int flags)\n{\n\tkhiter_t pos;\n\tgit_cached_obj *entry = NULL;\n\n\tif (!git_cache__enabled || git_rwlock_rdlock(&cache->lock) < 0)\n\t\treturn NULL;\n\n\tpos = kh_get(oid, cache->map, oid);\n\tif (pos != kh_end(cache->map)) {\n\t\tentry = kh_val(cache->map, pos);\n\n\t\tif (flags && entry->flags != flags) {\n\t\t\tentry = NULL;\n\t\t} else {\n\t\t\tgit_cached_obj_incref(entry);\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&cache->lock);\n\n\treturn entry;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "GIT__USE_OIDMAP\n\nbool git_cache__enabled = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\nbool git_cache__enabled = true;\n\nstatic void *cache_get(git_cache *cache, const git_oid *oid, unsigned int flags)\n{\n\tkhiter_t pos;\n\tgit_cached_obj *entry = NULL;\n\n\tif (!git_cache__enabled || git_rwlock_rdlock(&cache->lock) < 0)\n\t\treturn NULL;\n\n\tpos = kh_get(oid, cache->map, oid);\n\tif (pos != kh_end(cache->map)) {\n\t\tentry = kh_val(cache->map, pos);\n\n\t\tif (flags && entry->flags != flags) {\n\t\t\tentry = NULL;\n\t\t} else {\n\t\t\tgit_cached_obj_incref(entry);\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&cache->lock);\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid *git_cache_get_any(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_ANY);\n}"
  },
  {
    "function_name": "git_cache_get_parsed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "252-255",
    "snippet": "git_object *git_cache_get_parsed(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_PARSED);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_get",
          "args": [
            "cache",
            "oid",
            "GIT_CACHE_STORE_PARSED"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "cache_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "151-173",
          "snippet": "static void *cache_get(git_cache *cache, const git_oid *oid, unsigned int flags)\n{\n\tkhiter_t pos;\n\tgit_cached_obj *entry = NULL;\n\n\tif (!git_cache__enabled || git_rwlock_rdlock(&cache->lock) < 0)\n\t\treturn NULL;\n\n\tpos = kh_get(oid, cache->map, oid);\n\tif (pos != kh_end(cache->map)) {\n\t\tentry = kh_val(cache->map, pos);\n\n\t\tif (flags && entry->flags != flags) {\n\t\t\tentry = NULL;\n\t\t} else {\n\t\t\tgit_cached_obj_incref(entry);\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&cache->lock);\n\n\treturn entry;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "GIT__USE_OIDMAP\n\nbool git_cache__enabled = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\nbool git_cache__enabled = true;\n\nstatic void *cache_get(git_cache *cache, const git_oid *oid, unsigned int flags)\n{\n\tkhiter_t pos;\n\tgit_cached_obj *entry = NULL;\n\n\tif (!git_cache__enabled || git_rwlock_rdlock(&cache->lock) < 0)\n\t\treturn NULL;\n\n\tpos = kh_get(oid, cache->map, oid);\n\tif (pos != kh_end(cache->map)) {\n\t\tentry = kh_val(cache->map, pos);\n\n\t\tif (flags && entry->flags != flags) {\n\t\t\tentry = NULL;\n\t\t} else {\n\t\t\tgit_cached_obj_incref(entry);\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&cache->lock);\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_object *git_cache_get_parsed(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_PARSED);\n}"
  },
  {
    "function_name": "git_cache_get_raw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "247-250",
    "snippet": "git_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_get",
          "args": [
            "cache",
            "oid",
            "GIT_CACHE_STORE_RAW"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "cache_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "151-173",
          "snippet": "static void *cache_get(git_cache *cache, const git_oid *oid, unsigned int flags)\n{\n\tkhiter_t pos;\n\tgit_cached_obj *entry = NULL;\n\n\tif (!git_cache__enabled || git_rwlock_rdlock(&cache->lock) < 0)\n\t\treturn NULL;\n\n\tpos = kh_get(oid, cache->map, oid);\n\tif (pos != kh_end(cache->map)) {\n\t\tentry = kh_val(cache->map, pos);\n\n\t\tif (flags && entry->flags != flags) {\n\t\t\tentry = NULL;\n\t\t} else {\n\t\t\tgit_cached_obj_incref(entry);\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&cache->lock);\n\n\treturn entry;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "GIT__USE_OIDMAP\n\nbool git_cache__enabled = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\nbool git_cache__enabled = true;\n\nstatic void *cache_get(git_cache *cache, const git_oid *oid, unsigned int flags)\n{\n\tkhiter_t pos;\n\tgit_cached_obj *entry = NULL;\n\n\tif (!git_cache__enabled || git_rwlock_rdlock(&cache->lock) < 0)\n\t\treturn NULL;\n\n\tpos = kh_get(oid, cache->map, oid);\n\tif (pos != kh_end(cache->map)) {\n\t\tentry = kh_val(cache->map, pos);\n\n\t\tif (flags && entry->flags != flags) {\n\t\t\tentry = NULL;\n\t\t} else {\n\t\t\tgit_cached_obj_incref(entry);\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&cache->lock);\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_odb_object *git_cache_get_raw(git_cache *cache, const git_oid *oid)\n{\n\treturn cache_get(cache, oid, GIT_CACHE_STORE_RAW);\n}"
  },
  {
    "function_name": "git_cache_store_parsed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "241-245",
    "snippet": "void *git_cache_store_parsed(git_cache *cache, git_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_PARSED;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_store",
          "args": [
            "cache",
            "(git_cached_obj *)entry"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_store_parsed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "241-245",
          "snippet": "void *git_cache_store_parsed(git_cache *cache, git_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_PARSED;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid *git_cache_store_parsed(git_cache *cache, git_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_PARSED;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}"
  },
  {
    "function_name": "git_cache_store_raw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "235-239",
    "snippet": "void *git_cache_store_raw(git_cache *cache, git_odb_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_RAW;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_store",
          "args": [
            "cache",
            "(git_cached_obj *)entry"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_store_parsed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "241-245",
          "snippet": "void *git_cache_store_parsed(git_cache *cache, git_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_PARSED;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid *git_cache_store_parsed(git_cache *cache, git_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_PARSED;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid *git_cache_store_raw(git_cache *cache, git_odb_object *entry)\n{\n\tentry->cached.flags = GIT_CACHE_STORE_RAW;\n\treturn cache_store(cache, (git_cached_obj *)entry);\n}"
  },
  {
    "function_name": "cache_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "175-233",
    "snippet": "static void *cache_store(git_cache *cache, git_cached_obj *entry)\n{\n\tkhiter_t pos;\n\n\tgit_cached_obj_incref(entry);\n\n\tif (!git_cache__enabled && cache->used_memory > 0) {\n\t\tgit_cache_clear(cache);\n\t\treturn entry;\n\t}\n\n\tif (!cache_should_store(entry->type, entry->size))\n\t\treturn entry;\n\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn entry;\n\n\t/* soften the load on the cache */\n\tif (git_cache__current_storage.val > git_cache__max_storage)\n\t\tcache_evict_entries(cache);\n\n\tpos = kh_get(oid, cache->map, &entry->oid);\n\n\t/* not found */\n\tif (pos == kh_end(cache->map)) {\n\t\tint rval;\n\n\t\tpos = kh_put(oid, cache->map, &entry->oid, &rval);\n\t\tif (rval >= 0) {\n\t\t\tkh_key(cache->map, pos) = &entry->oid;\n\t\t\tkh_val(cache->map, pos) = entry;\n\t\t\tgit_cached_obj_incref(entry);\n\t\t\tcache->used_memory += entry->size;\n\t\t\tgit_atomic_ssize_add(&git_cache__current_storage, (ssize_t)entry->size);\n\t\t}\n\t}\n\t/* found */\n\telse {\n\t\tgit_cached_obj *stored_entry = kh_val(cache->map, pos);\n\n\t\tif (stored_entry->flags == entry->flags) {\n\t\t\tgit_cached_obj_decref(entry);\n\t\t\tgit_cached_obj_incref(stored_entry);\n\t\t\tentry = stored_entry;\n\t\t} else if (stored_entry->flags == GIT_CACHE_STORE_RAW &&\n\t\t\tentry->flags == GIT_CACHE_STORE_PARSED) {\n\t\t\tgit_cached_obj_decref(stored_entry);\n\t\t\tgit_cached_obj_incref(entry);\n\n\t\t\tkh_key(cache->map, pos) = &entry->oid;\n\t\t\tkh_val(cache->map, pos) = entry;\n\t\t} else {\n\t\t\t/* NO OP */\n\t\t}\n\t}\n\n\tgit_rwlock_wrunlock(&cache->lock);\n\treturn entry;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "GIT__USE_OIDMAP\n\nbool git_cache__enabled = true;",
      "ssize_t git_cache__max_storage = (256 * 1024 * 1024);",
      "git_atomic_ssize git_cache__current_storage = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_rwlock_wrunlock",
          "args": [
            "&cache->lock"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "223-231",
          "snippet": "int git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_release_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_release_exclusive;\n\nint git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kh_val",
          "args": [
            "cache->map",
            "pos"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_key",
          "args": [
            "cache->map",
            "pos"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_cached_obj_incref",
          "args": [
            "entry"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "git_cached_obj_incref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.h",
          "lines": "59-63",
          "snippet": "GIT_INLINE(void) git_cached_obj_incref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\tgit_atomic_inc(&obj->refcount);\n}",
          "includes": [
            "#include \"oidmap.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"oidmap.h\"\n#include \"thread-utils.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(void) git_cached_obj_incref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\tgit_atomic_inc(&obj->refcount);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cached_obj_decref",
          "args": [
            "stored_entry"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "git_cached_obj_decref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "262-281",
          "snippet": "void git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kh_val",
          "args": [
            "cache->map",
            "pos"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_atomic_ssize_add",
          "args": [
            "&git_cache__current_storage",
            "(ssize_t)entry->size"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_val",
          "args": [
            "cache->map",
            "pos"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_key",
          "args": [
            "cache->map",
            "pos"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_put",
          "args": [
            "oid",
            "cache->map",
            "&entry->oid",
            "&rval"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_end",
          "args": [
            "cache->map"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_get",
          "args": [
            "oid",
            "cache->map",
            "&entry->oid"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_evict_entries",
          "args": [
            "cache"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "cache_evict_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "115-143",
          "snippet": "static void cache_evict_entries(git_cache *cache)\n{\n\tuint32_t seed = rand();\n\tsize_t evict_count = 8;\n\tssize_t evicted_memory = 0;\n\n\t/* do not infinite loop if there's not enough entries to evict  */\n\tif (evict_count > kh_size(cache->map)) {\n\t\tclear_cache(cache);\n\t\treturn;\n\t}\n\n\twhile (evict_count > 0) {\n\t\tkhiter_t pos = seed++ % kh_end(cache->map);\n\n\t\tif (kh_exist(cache->map, pos)) {\n\t\t\tgit_cached_obj *evict = kh_val(cache->map, pos);\n\n\t\t\tevict_count--;\n\t\t\tevicted_memory += evict->size;\n\t\t\tgit_cached_obj_decref(evict);\n\n\t\t\tkh_del(oid, cache->map, pos);\n\t\t}\n\t}\n\n\tcache->used_memory -= evicted_memory;\n\tgit_atomic_ssize_add(&git_cache__current_storage, -evicted_memory);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "git_atomic_ssize git_cache__current_storage = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_atomic_ssize git_cache__current_storage = {0};\n\nstatic void cache_evict_entries(git_cache *cache)\n{\n\tuint32_t seed = rand();\n\tsize_t evict_count = 8;\n\tssize_t evicted_memory = 0;\n\n\t/* do not infinite loop if there's not enough entries to evict  */\n\tif (evict_count > kh_size(cache->map)) {\n\t\tclear_cache(cache);\n\t\treturn;\n\t}\n\n\twhile (evict_count > 0) {\n\t\tkhiter_t pos = seed++ % kh_end(cache->map);\n\n\t\tif (kh_exist(cache->map, pos)) {\n\t\t\tgit_cached_obj *evict = kh_val(cache->map, pos);\n\n\t\t\tevict_count--;\n\t\t\tevicted_memory += evict->size;\n\t\t\tgit_cached_obj_decref(evict);\n\n\t\t\tkh_del(oid, cache->map, pos);\n\t\t}\n\t}\n\n\tcache->used_memory -= evicted_memory;\n\tgit_atomic_ssize_add(&git_cache__current_storage, -evicted_memory);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_wrlock",
          "args": [
            "&cache->lock"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "213-221",
          "snippet": "int git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_acquire_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_acquire_exclusive;\n\nint git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_should_store",
          "args": [
            "entry->type",
            "entry->size"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "cache_should_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "145-149",
          "snippet": "static bool cache_should_store(git_otype object_type, size_t object_size)\n{\n\tsize_t max_size = git_cache__max_object_size[object_type];\n\treturn git_cache__enabled && object_size < max_size;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "GIT__USE_OIDMAP\n\nbool git_cache__enabled = true;",
            "static size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\nbool git_cache__enabled = true;\nstatic size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};\n\nstatic bool cache_should_store(git_otype object_type, size_t object_size)\n{\n\tsize_t max_size = git_cache__max_object_size[object_type];\n\treturn git_cache__enabled && object_size < max_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cache_clear",
          "args": [
            "cache"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "96-104",
          "snippet": "void git_cache_clear(git_cache *cache)\n{\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn;\n\n\tclear_cache(cache);\n\n\tgit_rwlock_wrunlock(&cache->lock);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cache_clear(git_cache *cache)\n{\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn;\n\n\tclear_cache(cache);\n\n\tgit_rwlock_wrunlock(&cache->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\nbool git_cache__enabled = true;\nssize_t git_cache__max_storage = (256 * 1024 * 1024);\ngit_atomic_ssize git_cache__current_storage = {0};\n\nstatic void *cache_store(git_cache *cache, git_cached_obj *entry)\n{\n\tkhiter_t pos;\n\n\tgit_cached_obj_incref(entry);\n\n\tif (!git_cache__enabled && cache->used_memory > 0) {\n\t\tgit_cache_clear(cache);\n\t\treturn entry;\n\t}\n\n\tif (!cache_should_store(entry->type, entry->size))\n\t\treturn entry;\n\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn entry;\n\n\t/* soften the load on the cache */\n\tif (git_cache__current_storage.val > git_cache__max_storage)\n\t\tcache_evict_entries(cache);\n\n\tpos = kh_get(oid, cache->map, &entry->oid);\n\n\t/* not found */\n\tif (pos == kh_end(cache->map)) {\n\t\tint rval;\n\n\t\tpos = kh_put(oid, cache->map, &entry->oid, &rval);\n\t\tif (rval >= 0) {\n\t\t\tkh_key(cache->map, pos) = &entry->oid;\n\t\t\tkh_val(cache->map, pos) = entry;\n\t\t\tgit_cached_obj_incref(entry);\n\t\t\tcache->used_memory += entry->size;\n\t\t\tgit_atomic_ssize_add(&git_cache__current_storage, (ssize_t)entry->size);\n\t\t}\n\t}\n\t/* found */\n\telse {\n\t\tgit_cached_obj *stored_entry = kh_val(cache->map, pos);\n\n\t\tif (stored_entry->flags == entry->flags) {\n\t\t\tgit_cached_obj_decref(entry);\n\t\t\tgit_cached_obj_incref(stored_entry);\n\t\t\tentry = stored_entry;\n\t\t} else if (stored_entry->flags == GIT_CACHE_STORE_RAW &&\n\t\t\tentry->flags == GIT_CACHE_STORE_PARSED) {\n\t\t\tgit_cached_obj_decref(stored_entry);\n\t\t\tgit_cached_obj_incref(entry);\n\n\t\t\tkh_key(cache->map, pos) = &entry->oid;\n\t\t\tkh_val(cache->map, pos) = entry;\n\t\t} else {\n\t\t\t/* NO OP */\n\t\t}\n\t}\n\n\tgit_rwlock_wrunlock(&cache->lock);\n\treturn entry;\n}"
  },
  {
    "function_name": "cache_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "151-173",
    "snippet": "static void *cache_get(git_cache *cache, const git_oid *oid, unsigned int flags)\n{\n\tkhiter_t pos;\n\tgit_cached_obj *entry = NULL;\n\n\tif (!git_cache__enabled || git_rwlock_rdlock(&cache->lock) < 0)\n\t\treturn NULL;\n\n\tpos = kh_get(oid, cache->map, oid);\n\tif (pos != kh_end(cache->map)) {\n\t\tentry = kh_val(cache->map, pos);\n\n\t\tif (flags && entry->flags != flags) {\n\t\t\tentry = NULL;\n\t\t} else {\n\t\t\tgit_cached_obj_incref(entry);\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&cache->lock);\n\n\treturn entry;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "GIT__USE_OIDMAP\n\nbool git_cache__enabled = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_rwlock_rdunlock",
          "args": [
            "&cache->lock"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_rdunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "203-211",
          "snippet": "int git_rwlock_rdunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_shared)\n\t\twin32_srwlock_release_shared(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_release_shared;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_release_shared;\n\nint git_rwlock_rdunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_shared)\n\t\twin32_srwlock_release_shared(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cached_obj_incref",
          "args": [
            "entry"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "git_cached_obj_incref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.h",
          "lines": "59-63",
          "snippet": "GIT_INLINE(void) git_cached_obj_incref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\tgit_atomic_inc(&obj->refcount);\n}",
          "includes": [
            "#include \"oidmap.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"oidmap.h\"\n#include \"thread-utils.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(void) git_cached_obj_incref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\tgit_atomic_inc(&obj->refcount);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kh_val",
          "args": [
            "cache->map",
            "pos"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_end",
          "args": [
            "cache->map"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_get",
          "args": [
            "oid",
            "cache->map",
            "oid"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_rwlock_rdlock",
          "args": [
            "&cache->lock"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_rdlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "193-201",
          "snippet": "int git_rwlock_rdlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_shared)\n\t\twin32_srwlock_acquire_shared(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_acquire_shared;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_acquire_shared;\n\nint git_rwlock_rdlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_shared)\n\t\twin32_srwlock_acquire_shared(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\nbool git_cache__enabled = true;\n\nstatic void *cache_get(git_cache *cache, const git_oid *oid, unsigned int flags)\n{\n\tkhiter_t pos;\n\tgit_cached_obj *entry = NULL;\n\n\tif (!git_cache__enabled || git_rwlock_rdlock(&cache->lock) < 0)\n\t\treturn NULL;\n\n\tpos = kh_get(oid, cache->map, oid);\n\tif (pos != kh_end(cache->map)) {\n\t\tentry = kh_val(cache->map, pos);\n\n\t\tif (flags && entry->flags != flags) {\n\t\t\tentry = NULL;\n\t\t} else {\n\t\t\tgit_cached_obj_incref(entry);\n\t\t}\n\t}\n\n\tgit_rwlock_rdunlock(&cache->lock);\n\n\treturn entry;\n}"
  },
  {
    "function_name": "cache_should_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "145-149",
    "snippet": "static bool cache_should_store(git_otype object_type, size_t object_size)\n{\n\tsize_t max_size = git_cache__max_object_size[object_type];\n\treturn git_cache__enabled && object_size < max_size;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "GIT__USE_OIDMAP\n\nbool git_cache__enabled = true;",
      "static size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\nbool git_cache__enabled = true;\nstatic size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};\n\nstatic bool cache_should_store(git_otype object_type, size_t object_size)\n{\n\tsize_t max_size = git_cache__max_object_size[object_type];\n\treturn git_cache__enabled && object_size < max_size;\n}"
  },
  {
    "function_name": "cache_evict_entries",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "115-143",
    "snippet": "static void cache_evict_entries(git_cache *cache)\n{\n\tuint32_t seed = rand();\n\tsize_t evict_count = 8;\n\tssize_t evicted_memory = 0;\n\n\t/* do not infinite loop if there's not enough entries to evict  */\n\tif (evict_count > kh_size(cache->map)) {\n\t\tclear_cache(cache);\n\t\treturn;\n\t}\n\n\twhile (evict_count > 0) {\n\t\tkhiter_t pos = seed++ % kh_end(cache->map);\n\n\t\tif (kh_exist(cache->map, pos)) {\n\t\t\tgit_cached_obj *evict = kh_val(cache->map, pos);\n\n\t\t\tevict_count--;\n\t\t\tevicted_memory += evict->size;\n\t\t\tgit_cached_obj_decref(evict);\n\n\t\t\tkh_del(oid, cache->map, pos);\n\t\t}\n\t}\n\n\tcache->used_memory -= evicted_memory;\n\tgit_atomic_ssize_add(&git_cache__current_storage, -evicted_memory);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "git_atomic_ssize git_cache__current_storage = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_atomic_ssize_add",
          "args": [
            "&git_cache__current_storage",
            "-evicted_memory"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_del",
          "args": [
            "oid",
            "cache->map",
            "pos"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_cached_obj_decref",
          "args": [
            "evict"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "git_cached_obj_decref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "262-281",
          "snippet": "void git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kh_val",
          "args": [
            "cache->map",
            "pos"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_exist",
          "args": [
            "cache->map",
            "pos"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_end",
          "args": [
            "cache->map"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_cache",
          "args": [
            "cache"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "clear_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "80-94",
          "snippet": "static void clear_cache(git_cache *cache)\n{\n\tgit_cached_obj *evict = NULL;\n\n\tif (kh_size(cache->map) == 0)\n\t\treturn;\n\n\tkh_foreach_value(cache->map, evict, {\n\t\tgit_cached_obj_decref(evict);\n\t});\n\n\tkh_clear(oid, cache->map);\n\tgit_atomic_ssize_add(&git_cache__current_storage, -cache->used_memory);\n\tcache->used_memory = 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "git_atomic_ssize git_cache__current_storage = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_atomic_ssize git_cache__current_storage = {0};\n\nstatic void clear_cache(git_cache *cache)\n{\n\tgit_cached_obj *evict = NULL;\n\n\tif (kh_size(cache->map) == 0)\n\t\treturn;\n\n\tkh_foreach_value(cache->map, evict, {\n\t\tgit_cached_obj_decref(evict);\n\t});\n\n\tkh_clear(oid, cache->map);\n\tgit_atomic_ssize_add(&git_cache__current_storage, -cache->used_memory);\n\tcache->used_memory = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kh_size",
          "args": [
            "cache->map"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_atomic_ssize git_cache__current_storage = {0};\n\nstatic void cache_evict_entries(git_cache *cache)\n{\n\tuint32_t seed = rand();\n\tsize_t evict_count = 8;\n\tssize_t evicted_memory = 0;\n\n\t/* do not infinite loop if there's not enough entries to evict  */\n\tif (evict_count > kh_size(cache->map)) {\n\t\tclear_cache(cache);\n\t\treturn;\n\t}\n\n\twhile (evict_count > 0) {\n\t\tkhiter_t pos = seed++ % kh_end(cache->map);\n\n\t\tif (kh_exist(cache->map, pos)) {\n\t\t\tgit_cached_obj *evict = kh_val(cache->map, pos);\n\n\t\t\tevict_count--;\n\t\t\tevicted_memory += evict->size;\n\t\t\tgit_cached_obj_decref(evict);\n\n\t\t\tkh_del(oid, cache->map, pos);\n\t\t}\n\t}\n\n\tcache->used_memory -= evicted_memory;\n\tgit_atomic_ssize_add(&git_cache__current_storage, -evicted_memory);\n}"
  },
  {
    "function_name": "git_cache_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "106-112",
    "snippet": "void git_cache_free(git_cache *cache)\n{\n\tgit_cache_clear(cache);\n\tgit_oidmap_free(cache->map);\n\tgit_rwlock_free(&cache->lock);\n\tgit__memzero(cache, sizeof(*cache));\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__memzero",
          "args": [
            "cache",
            "sizeof(*cache)"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "git__memzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "521-531",
          "snippet": "GIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_free",
          "args": [
            "&cache->lock"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "233-239",
          "snippet": "int git_rwlock_free(git_rwlock *lock)\n{\n\tif (!win32_srwlock_initialize)\n\t\tDeleteCriticalSection(&lock->native.csec);\n\tgit__memzero(lock, sizeof(*lock));\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_initialize;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_initialize;\n\nint git_rwlock_free(git_rwlock *lock)\n{\n\tif (!win32_srwlock_initialize)\n\t\tDeleteCriticalSection(&lock->native.csec);\n\tgit__memzero(lock, sizeof(*lock));\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oidmap_free",
          "args": [
            "cache->map"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_cache_clear",
          "args": [
            "cache"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "96-104",
          "snippet": "void git_cache_clear(git_cache *cache)\n{\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn;\n\n\tclear_cache(cache);\n\n\tgit_rwlock_wrunlock(&cache->lock);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cache_clear(git_cache *cache)\n{\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn;\n\n\tclear_cache(cache);\n\n\tgit_rwlock_wrunlock(&cache->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cache_free(git_cache *cache)\n{\n\tgit_cache_clear(cache);\n\tgit_oidmap_free(cache->map);\n\tgit_rwlock_free(&cache->lock);\n\tgit__memzero(cache, sizeof(*cache));\n}"
  },
  {
    "function_name": "git_cache_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "96-104",
    "snippet": "void git_cache_clear(git_cache *cache)\n{\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn;\n\n\tclear_cache(cache);\n\n\tgit_rwlock_wrunlock(&cache->lock);\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_rwlock_wrunlock",
          "args": [
            "&cache->lock"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "223-231",
          "snippet": "int git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_release_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_release_exclusive;\n\nint git_rwlock_wrunlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_release_exclusive)\n\t\twin32_srwlock_release_exclusive(&lock->native.srwl);\n\telse\n\t\tLeaveCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_cache",
          "args": [
            "cache"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "clear_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "80-94",
          "snippet": "static void clear_cache(git_cache *cache)\n{\n\tgit_cached_obj *evict = NULL;\n\n\tif (kh_size(cache->map) == 0)\n\t\treturn;\n\n\tkh_foreach_value(cache->map, evict, {\n\t\tgit_cached_obj_decref(evict);\n\t});\n\n\tkh_clear(oid, cache->map);\n\tgit_atomic_ssize_add(&git_cache__current_storage, -cache->used_memory);\n\tcache->used_memory = 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "git_atomic_ssize git_cache__current_storage = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_atomic_ssize git_cache__current_storage = {0};\n\nstatic void clear_cache(git_cache *cache)\n{\n\tgit_cached_obj *evict = NULL;\n\n\tif (kh_size(cache->map) == 0)\n\t\treturn;\n\n\tkh_foreach_value(cache->map, evict, {\n\t\tgit_cached_obj_decref(evict);\n\t});\n\n\tkh_clear(oid, cache->map);\n\tgit_atomic_ssize_add(&git_cache__current_storage, -cache->used_memory);\n\tcache->used_memory = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_wrlock",
          "args": [
            "&cache->lock"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_wrlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "213-221",
          "snippet": "int git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_acquire_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_acquire_exclusive;\n\nint git_rwlock_wrlock(git_rwlock *lock)\n{\n\tif (win32_srwlock_acquire_exclusive)\n\t\twin32_srwlock_acquire_exclusive(&lock->native.srwl);\n\telse\n\t\tEnterCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cache_clear(git_cache *cache)\n{\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn;\n\n\tclear_cache(cache);\n\n\tgit_rwlock_wrunlock(&cache->lock);\n}"
  },
  {
    "function_name": "clear_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "80-94",
    "snippet": "static void clear_cache(git_cache *cache)\n{\n\tgit_cached_obj *evict = NULL;\n\n\tif (kh_size(cache->map) == 0)\n\t\treturn;\n\n\tkh_foreach_value(cache->map, evict, {\n\t\tgit_cached_obj_decref(evict);\n\t});\n\n\tkh_clear(oid, cache->map);\n\tgit_atomic_ssize_add(&git_cache__current_storage, -cache->used_memory);\n\tcache->used_memory = 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "git_atomic_ssize git_cache__current_storage = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_atomic_ssize_add",
          "args": [
            "&git_cache__current_storage",
            "-cache->used_memory"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_clear",
          "args": [
            "oid",
            "cache->map"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_foreach_value",
          "args": [
            "cache->map",
            "evict",
            "{\n\t\tgit_cached_obj_decref(evict);\n\t}"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_cached_obj_decref",
          "args": [
            "evict"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "git_cached_obj_decref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "262-281",
          "snippet": "void git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cached_obj_decref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\n\tif (git_atomic_dec(&obj->refcount) == 0) {\n\t\tswitch (obj->flags) {\n\t\tcase GIT_CACHE_STORE_RAW:\n\t\t\tgit_odb_object__free(_obj);\n\t\t\tbreak;\n\n\t\tcase GIT_CACHE_STORE_PARSED:\n\t\t\tgit_object__free(_obj);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tgit__free(_obj);\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kh_size",
          "args": [
            "cache->map"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_atomic_ssize git_cache__current_storage = {0};\n\nstatic void clear_cache(git_cache *cache)\n{\n\tgit_cached_obj *evict = NULL;\n\n\tif (kh_size(cache->map) == 0)\n\t\treturn;\n\n\tkh_foreach_value(cache->map, evict, {\n\t\tgit_cached_obj_decref(evict);\n\t});\n\n\tkh_clear(oid, cache->map);\n\tgit_atomic_ssize_add(&git_cache__current_storage, -cache->used_memory);\n\tcache->used_memory = 0;\n}"
  },
  {
    "function_name": "git_cache_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "67-77",
    "snippet": "int git_cache_init(git_cache *cache)\n{\n\tmemset(cache, 0, sizeof(*cache));\n\tcache->map = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(cache->map);\n\tif (git_rwlock_init(&cache->lock)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize cache rwlock\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Failed to initialize cache rwlock\""
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rwlock_init",
          "args": [
            "&cache->lock"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "git_rwlock_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "183-191",
          "snippet": "int git_rwlock_init(git_rwlock *GIT_RESTRICT lock)\n{\n\tif (win32_srwlock_initialize)\n\t\twin32_srwlock_initialize(&lock->native.srwl);\n\telse\n\t\tInitializeCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_initialize;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_initialize;\n\nint git_rwlock_init(git_rwlock *GIT_RESTRICT lock)\n{\n\tif (win32_srwlock_initialize)\n\t\twin32_srwlock_initialize(&lock->native.srwl);\n\telse\n\t\tInitializeCriticalSection(&lock->native.csec);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "cache->map"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oidmap_alloc",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "cache",
            "0",
            "sizeof(*cache)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_cache_init(git_cache *cache)\n{\n\tmemset(cache, 0, sizeof(*cache));\n\tcache->map = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(cache->map);\n\tif (git_rwlock_init(&cache->lock)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize cache rwlock\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "git_cache_dump_stats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "46-65",
    "snippet": "void git_cache_dump_stats(git_cache *cache)\n{\n\tgit_cached_obj *object;\n\n\tif (kh_size(cache->map) == 0)\n\t\treturn;\n\n\tprintf(\"Cache %p: %d items cached, %\"PRIdZ\" bytes\\n\",\n\t\tcache, kh_size(cache->map), cache->used_memory);\n\n\tkh_foreach_value(cache->map, object, {\n\t\tchar oid_str[9];\n\t\tprintf(\" %s%c %s (%\"PRIuZ\")\\n\",\n\t\t\tgit_object_type2string(object->type),\n\t\t\tobject->flags == GIT_CACHE_STORE_PARSED ? '*' : ' ',\n\t\t\tgit_oid_tostr(oid_str, sizeof(oid_str), &object->oid),\n\t\t\tobject->size\n\t\t);\n\t});\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kh_foreach_value",
          "args": [
            "cache->map",
            "object",
            "{\n\t\tchar oid_str[9];\n\t\tprintf(\" %s%c %s (%\"PRIuZ\")\\n\",\n\t\t\tgit_object_type2string(object->type),\n\t\t\tobject->flags == GIT_CACHE_STORE_PARSED ? '*' : ' ',\n\t\t\tgit_oid_tostr(oid_str, sizeof(oid_str), &object->oid),\n\t\t\tobject->size\n\t\t);\n\t}"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\" %s%c %s (%\"PRIuZ\")\\n\"",
            "git_object_type2string(object->type)",
            "object->flags == GIT_CACHE_STORE_PARSED ? '*' : ' '",
            "git_oid_tostr(oid_str, sizeof(oid_str), &object->oid)",
            "object->size"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_tostr",
          "args": [
            "oid_str",
            "sizeof(oid_str)",
            "&object->oid"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_tostr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "119-131",
          "snippet": "char *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_type2string",
          "args": [
            "object->type"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_type2string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "227-233",
          "snippet": "const char *git_object_type2string(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn \"\";\n\n\treturn git_objects_table[type].str;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nstatic git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};\n\nconst char *git_object_type2string(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn \"\";\n\n\treturn git_objects_table[type].str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kh_size",
          "args": [
            "cache->map"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_size",
          "args": [
            "cache->map"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cache_dump_stats(git_cache *cache)\n{\n\tgit_cached_obj *object;\n\n\tif (kh_size(cache->map) == 0)\n\t\treturn;\n\n\tprintf(\"Cache %p: %d items cached, %\"PRIdZ\" bytes\\n\",\n\t\tcache, kh_size(cache->map), cache->used_memory);\n\n\tkh_foreach_value(cache->map, object, {\n\t\tchar oid_str[9];\n\t\tprintf(\" %s%c %s (%\"PRIuZ\")\\n\",\n\t\t\tgit_object_type2string(object->type),\n\t\t\tobject->flags == GIT_CACHE_STORE_PARSED ? '*' : ' ',\n\t\t\tgit_oid_tostr(oid_str, sizeof(oid_str), &object->oid),\n\t\t\tobject->size\n\t\t);\n\t});\n}"
  },
  {
    "function_name": "git_cache_set_max_object_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
    "lines": "35-44",
    "snippet": "int git_cache_set_max_object_size(git_otype type, size_t size)\n{\n\tif (type < 0 || (size_t)type >= ARRAY_SIZE(git_cache__max_object_size)) {\n\t\tgiterr_set(GITERR_INVALID, \"type out of range\");\n\t\treturn -1;\n\t}\n\n\tgit_cache__max_object_size[type] = size;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/oid.h\"",
      "#include \"object.h\"",
      "#include \"odb.h\"",
      "#include \"cache.h\"",
      "#include \"util.h\"",
      "#include \"thread-utils.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"type out of range\""
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "git_cache__max_object_size"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic size_t git_cache__max_object_size[8] = {\n\t0,     /* GIT_OBJ__EXT1 */\n\t4096,  /* GIT_OBJ_COMMIT */\n\t4096,  /* GIT_OBJ_TREE */\n\t0,     /* GIT_OBJ_BLOB */\n\t4096,  /* GIT_OBJ_TAG */\n\t0,     /* GIT_OBJ__EXT2 */\n\t0,     /* GIT_OBJ_OFS_DELTA */\n\t0      /* GIT_OBJ_REF_DELTA */\n};\n\nint git_cache_set_max_object_size(git_otype type, size_t size)\n{\n\tif (type < 0 || (size_t)type >= ARRAY_SIZE(git_cache__max_object_size)) {\n\t\tgiterr_set(GITERR_INVALID, \"type out of range\");\n\t\treturn -1;\n\t}\n\n\tgit_cache__max_object_size[type] = size;\n\treturn 0;\n}"
  }
]