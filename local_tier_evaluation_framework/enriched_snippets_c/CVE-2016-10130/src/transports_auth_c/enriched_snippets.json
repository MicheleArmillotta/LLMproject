[
  {
    "function_name": "git_http_auth_dummy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/auth.c",
    "lines": "63-70",
    "snippet": "int git_http_auth_dummy(\n\tgit_http_auth_context **out, const gitno_connection_data *connection_data)\n{\n\tGIT_UNUSED(connection_data);\n\n\t*out = NULL;\n\treturn 0;\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "connection_data"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"auth.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nint git_http_auth_dummy(\n\tgit_http_auth_context **out, const gitno_connection_data *connection_data)\n{\n\tGIT_UNUSED(connection_data);\n\n\t*out = NULL;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_http_auth_basic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/auth.c",
    "lines": "54-61",
    "snippet": "int git_http_auth_basic(\n\tgit_http_auth_context **out, const gitno_connection_data *connection_data)\n{\n\tGIT_UNUSED(connection_data);\n\n\t*out = &basic_context;\n\treturn 0;\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_http_auth_context basic_context = {\n\tGIT_AUTHTYPE_BASIC,\n\tGIT_CREDTYPE_USERPASS_PLAINTEXT,\n\tNULL,\n\tbasic_next_token,\n\tNULL\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "connection_data"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"auth.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic git_http_auth_context basic_context = {\n\tGIT_AUTHTYPE_BASIC,\n\tGIT_CREDTYPE_USERPASS_PLAINTEXT,\n\tNULL,\n\tbasic_next_token,\n\tNULL\n};\n\nint git_http_auth_basic(\n\tgit_http_auth_context **out, const gitno_connection_data *connection_data)\n{\n\tGIT_UNUSED(connection_data);\n\n\t*out = &basic_context;\n\treturn 0;\n}"
  },
  {
    "function_name": "basic_next_token",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/auth.c",
    "lines": "12-44",
    "snippet": "static int basic_next_token(\n\tgit_buf *out, git_http_auth_context *ctx, git_cred *c)\n{\n\tgit_cred_userpass_plaintext *cred;\n\tgit_buf raw = GIT_BUF_INIT;\n\tint error = -1;\n\n\tGIT_UNUSED(ctx);\n\n\tif (c->credtype != GIT_CREDTYPE_USERPASS_PLAINTEXT) {\n\t\tgiterr_set(GITERR_INVALID, \"invalid credential type for basic auth\");\n\t\tgoto on_error;\n\t}\n\n\tcred = (git_cred_userpass_plaintext *)c;\n\n\tgit_buf_printf(&raw, \"%s:%s\", cred->username, cred->password);\n\n\tif (git_buf_oom(&raw) ||\n\t\tgit_buf_puts(out, \"Authorization: Basic \") < 0 ||\n\t\tgit_buf_encode_base64(out, git_buf_cstr(&raw), raw.size) < 0 ||\n\t\tgit_buf_puts(out, \"\\r\\n\") < 0)\n\t\tgoto on_error;\n\n\terror = 0;\n\non_error:\n\tif (raw.size)\n\t\tgit__memzero(raw.ptr, raw.size);\n\n\tgit_buf_free(&raw);\n\treturn error;\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"buffer.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&raw"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__memzero",
          "args": [
            "raw.ptr",
            "raw.size"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "git__memzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "521-531",
          "snippet": "GIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "out",
            "\"\\r\\n\""
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_encode_base64",
          "args": [
            "out",
            "git_buf_cstr(&raw)",
            "raw.size"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_encode_base64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "234-274",
          "snippet": "int git_buf_encode_base64(git_buf *buf, const char *data, size_t len)\n{\n\tsize_t extra = len % 3;\n\tuint8_t *write, a, b, c;\n\tconst uint8_t *read = (const uint8_t *)data;\n\tsize_t blocks = (len / 3) + !!extra, alloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&blocks, blocks, 1);\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloclen, blocks, 4);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, buf->size);\n\n\tENSURE_SIZE(buf, alloclen);\n\twrite = (uint8_t *)&buf->ptr[buf->size];\n\n\t/* convert each run of 3 bytes into 4 output bytes */\n\tfor (len -= extra; len > 0; len -= 3) {\n\t\ta = *read++;\n\t\tb = *read++;\n\t\tc = *read++;\n\n\t\t*write++ = base64_encode[a >> 2];\n\t\t*write++ = base64_encode[(a & 0x03) << 4 | b >> 4];\n\t\t*write++ = base64_encode[(b & 0x0f) << 2 | c >> 6];\n\t\t*write++ = base64_encode[c & 0x3f];\n\t}\n\n\tif (extra > 0) {\n\t\ta = *read++;\n\t\tb = (extra > 1) ? *read++ : 0;\n\n\t\t*write++ = base64_encode[a >> 2];\n\t\t*write++ = base64_encode[(a & 0x03) << 4 | b >> 4];\n\t\t*write++ = (extra > 1) ? base64_encode[(b & 0x0f) << 2] : '=';\n\t\t*write++ = '=';\n\t}\n\n\tbuf->size = ((char *)write) - buf->ptr;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char base64_encode[] =\n\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nstatic const char base64_encode[] =\n\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\nint git_buf_encode_base64(git_buf *buf, const char *data, size_t len)\n{\n\tsize_t extra = len % 3;\n\tuint8_t *write, a, b, c;\n\tconst uint8_t *read = (const uint8_t *)data;\n\tsize_t blocks = (len / 3) + !!extra, alloclen;\n\n\tGITERR_CHECK_ALLOC_ADD(&blocks, blocks, 1);\n\tGITERR_CHECK_ALLOC_MULTIPLY(&alloclen, blocks, 4);\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, alloclen, buf->size);\n\n\tENSURE_SIZE(buf, alloclen);\n\twrite = (uint8_t *)&buf->ptr[buf->size];\n\n\t/* convert each run of 3 bytes into 4 output bytes */\n\tfor (len -= extra; len > 0; len -= 3) {\n\t\ta = *read++;\n\t\tb = *read++;\n\t\tc = *read++;\n\n\t\t*write++ = base64_encode[a >> 2];\n\t\t*write++ = base64_encode[(a & 0x03) << 4 | b >> 4];\n\t\t*write++ = base64_encode[(b & 0x0f) << 2 | c >> 6];\n\t\t*write++ = base64_encode[c & 0x3f];\n\t}\n\n\tif (extra > 0) {\n\t\ta = *read++;\n\t\tb = (extra > 1) ? *read++ : 0;\n\n\t\t*write++ = base64_encode[a >> 2];\n\t\t*write++ = base64_encode[(a & 0x03) << 4 | b >> 4];\n\t\t*write++ = (extra > 1) ? base64_encode[(b & 0x0f) << 2] : '=';\n\t\t*write++ = '=';\n\t}\n\n\tbuf->size = ((char *)write) - buf->ptr;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&raw"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "&raw"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "&raw",
            "\"%s:%s\"",
            "cred->username",
            "cred->password"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"invalid credential type for basic auth\""
          ],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "ctx"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"auth.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n\nstatic int basic_next_token(\n\tgit_buf *out, git_http_auth_context *ctx, git_cred *c)\n{\n\tgit_cred_userpass_plaintext *cred;\n\tgit_buf raw = GIT_BUF_INIT;\n\tint error = -1;\n\n\tGIT_UNUSED(ctx);\n\n\tif (c->credtype != GIT_CREDTYPE_USERPASS_PLAINTEXT) {\n\t\tgiterr_set(GITERR_INVALID, \"invalid credential type for basic auth\");\n\t\tgoto on_error;\n\t}\n\n\tcred = (git_cred_userpass_plaintext *)c;\n\n\tgit_buf_printf(&raw, \"%s:%s\", cred->username, cred->password);\n\n\tif (git_buf_oom(&raw) ||\n\t\tgit_buf_puts(out, \"Authorization: Basic \") < 0 ||\n\t\tgit_buf_encode_base64(out, git_buf_cstr(&raw), raw.size) < 0 ||\n\t\tgit_buf_puts(out, \"\\r\\n\") < 0)\n\t\tgoto on_error;\n\n\terror = 0;\n\non_error:\n\tif (raw.size)\n\t\tgit__memzero(raw.ptr, raw.size);\n\n\tgit_buf_free(&raw);\n\treturn error;\n}"
  }
]