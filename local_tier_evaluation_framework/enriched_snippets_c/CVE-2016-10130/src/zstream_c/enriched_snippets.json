[
  {
    "function_name": "git_zstream_deflatebuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
    "lines": "123-156",
    "snippet": "int git_zstream_deflatebuf(git_buf *out, const void *in, size_t in_len)\n{\n\tgit_zstream zs = GIT_ZSTREAM_INIT;\n\tint error = 0;\n\n\tif ((error = git_zstream_init(&zs)) < 0)\n\t\treturn error;\n\n\tif ((error = git_zstream_set_input(&zs, in, in_len)) < 0)\n\t\tgoto done;\n\n\twhile (!git_zstream_done(&zs)) {\n\t\tsize_t step = git_zstream_suggest_output_len(&zs), written;\n\n\t\tif ((error = git_buf_grow_by(out, step)) < 0)\n\t\t\tgoto done;\n\n\t\twritten = out->asize - out->size;\n\n\t\tif ((error = git_zstream_get_output(\n\t\t\t\tout->ptr + out->size, &written, &zs)) < 0)\n\t\t\tgoto done;\n\n\t\tout->size += written;\n\t}\n\n\t/* NULL terminate for consistency if possible */\n\tif (out->size < out->asize)\n\t\tout->ptr[out->size] = '\\0';\n\ndone:\n\tgit_zstream_free(&zs);\n\treturn error;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"zstream.h\"",
      "#include <zlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_zstream_free",
          "args": [
            "&zs"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "git_zstream_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
          "lines": "37-40",
          "snippet": "void git_zstream_free(git_zstream *zstream)\n{\n\tdeflateEnd(&zstream->z);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"zstream.h\"",
            "#include <zlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nvoid git_zstream_free(git_zstream *zstream)\n{\n\tdeflateEnd(&zstream->z);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_zstream_get_output",
          "args": [
            "out->ptr + out->size",
            "&written",
            "&zs"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "git_zstream_get_output",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
          "lines": "73-121",
          "snippet": "int git_zstream_get_output(void *out, size_t *out_len, git_zstream *zstream)\n{\n\tint zflush = Z_FINISH;\n\tsize_t out_remain = *out_len;\n\n\twhile (out_remain > 0 && zstream->zerr != Z_STREAM_END) {\n\t\tsize_t out_queued, in_queued, out_used, in_used;\n\n\t\t/* set up in data */\n\t\tzstream->z.next_in  = (Bytef *)zstream->in;\n\t\tzstream->z.avail_in = (uInt)zstream->in_len;\n\t\tif ((size_t)zstream->z.avail_in != zstream->in_len) {\n\t\t\tzstream->z.avail_in = INT_MAX;\n\t\t\tzflush = Z_NO_FLUSH;\n\t\t} else {\n\t\t\tzflush = Z_FINISH;\n\t\t}\n\t\tin_queued = (size_t)zstream->z.avail_in;\n\n\t\t/* set up out data */\n\t\tzstream->z.next_out = out;\n\t\tzstream->z.avail_out = (uInt)out_remain;\n\t\tif ((size_t)zstream->z.avail_out != out_remain)\n\t\t\tzstream->z.avail_out = INT_MAX;\n\t\tout_queued = (size_t)zstream->z.avail_out;\n\n\t\t/* compress next chunk */\n\t\tzstream->zerr = deflate(&zstream->z, zflush);\n\n\t\tif (zstream->zerr == Z_STREAM_ERROR)\n\t\t\treturn zstream_seterr(zstream);\n\n\t\tout_used = (out_queued - zstream->z.avail_out);\n\t\tout_remain -= out_used;\n\t\tout = ((char *)out) + out_used;\n\n\t\tin_used = (in_queued - zstream->z.avail_in);\n\t\tzstream->in_len -= in_used;\n\t\tzstream->in += in_used;\n\t}\n\n\t/* either we finished the input or we did not flush the data */\n\tassert(zstream->in_len > 0 || zflush == Z_FINISH);\n\n\t/* set out_size to number of bytes actually written to output */\n\t*out_len = *out_len - out_remain;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"zstream.h\"",
            "#include <zlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nint git_zstream_get_output(void *out, size_t *out_len, git_zstream *zstream)\n{\n\tint zflush = Z_FINISH;\n\tsize_t out_remain = *out_len;\n\n\twhile (out_remain > 0 && zstream->zerr != Z_STREAM_END) {\n\t\tsize_t out_queued, in_queued, out_used, in_used;\n\n\t\t/* set up in data */\n\t\tzstream->z.next_in  = (Bytef *)zstream->in;\n\t\tzstream->z.avail_in = (uInt)zstream->in_len;\n\t\tif ((size_t)zstream->z.avail_in != zstream->in_len) {\n\t\t\tzstream->z.avail_in = INT_MAX;\n\t\t\tzflush = Z_NO_FLUSH;\n\t\t} else {\n\t\t\tzflush = Z_FINISH;\n\t\t}\n\t\tin_queued = (size_t)zstream->z.avail_in;\n\n\t\t/* set up out data */\n\t\tzstream->z.next_out = out;\n\t\tzstream->z.avail_out = (uInt)out_remain;\n\t\tif ((size_t)zstream->z.avail_out != out_remain)\n\t\t\tzstream->z.avail_out = INT_MAX;\n\t\tout_queued = (size_t)zstream->z.avail_out;\n\n\t\t/* compress next chunk */\n\t\tzstream->zerr = deflate(&zstream->z, zflush);\n\n\t\tif (zstream->zerr == Z_STREAM_ERROR)\n\t\t\treturn zstream_seterr(zstream);\n\n\t\tout_used = (out_queued - zstream->z.avail_out);\n\t\tout_remain -= out_used;\n\t\tout = ((char *)out) + out_used;\n\n\t\tin_used = (in_queued - zstream->z.avail_in);\n\t\tzstream->in_len -= in_used;\n\t\tzstream->in += in_used;\n\t}\n\n\t/* either we finished the input or we did not flush the data */\n\tassert(zstream->in_len > 0 || zflush == Z_FINISH);\n\n\t/* set out_size to number of bytes actually written to output */\n\t*out_len = *out_len - out_remain;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_grow_by",
          "args": [
            "out",
            "step"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_grow_by",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "106-116",
          "snippet": "int git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nint git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_zstream_suggest_output_len",
          "args": [
            "&zs"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "git_zstream_suggest_output_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
          "lines": "63-71",
          "snippet": "size_t git_zstream_suggest_output_len(git_zstream *zstream)\n{\n\tif (zstream->in_len > ZSTREAM_BUFFER_SIZE)\n\t\treturn ZSTREAM_BUFFER_SIZE;\n\telse if (zstream->in_len > ZSTREAM_BUFFER_MIN_EXTRA)\n\t\treturn zstream->in_len;\n\telse\n\t\treturn ZSTREAM_BUFFER_MIN_EXTRA;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"zstream.h\"",
            "#include <zlib.h>"
          ],
          "macros_used": [
            "#define ZSTREAM_BUFFER_MIN_EXTRA 8",
            "#define ZSTREAM_BUFFER_SIZE (1024 * 1024)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\n#define ZSTREAM_BUFFER_MIN_EXTRA 8\n#define ZSTREAM_BUFFER_SIZE (1024 * 1024)\n\nsize_t git_zstream_suggest_output_len(git_zstream *zstream)\n{\n\tif (zstream->in_len > ZSTREAM_BUFFER_SIZE)\n\t\treturn ZSTREAM_BUFFER_SIZE;\n\telse if (zstream->in_len > ZSTREAM_BUFFER_MIN_EXTRA)\n\t\treturn zstream->in_len;\n\telse\n\t\treturn ZSTREAM_BUFFER_MIN_EXTRA;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_zstream_done",
          "args": [
            "&zs"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "git_zstream_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
          "lines": "58-61",
          "snippet": "bool git_zstream_done(git_zstream *zstream)\n{\n\treturn (!zstream->in_len && zstream->zerr == Z_STREAM_END);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"zstream.h\"",
            "#include <zlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nbool git_zstream_done(git_zstream *zstream)\n{\n\treturn (!zstream->in_len && zstream->zerr == Z_STREAM_END);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_zstream_set_input",
          "args": [
            "&zs",
            "in",
            "in_len"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "git_zstream_set_input",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
          "lines": "50-56",
          "snippet": "int git_zstream_set_input(git_zstream *zstream, const void *in, size_t in_len)\n{\n\tzstream->in = in;\n\tzstream->in_len = in_len;\n\tzstream->zerr = Z_OK;\n\treturn 0;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"zstream.h\"",
            "#include <zlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nint git_zstream_set_input(git_zstream *zstream, const void *in, size_t in_len)\n{\n\tzstream->in = in;\n\tzstream->in_len = in_len;\n\tzstream->zerr = Z_OK;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_zstream_init",
          "args": [
            "&zs"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "git_zstream_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
          "lines": "31-35",
          "snippet": "int git_zstream_init(git_zstream *zstream)\n{\n\tzstream->zerr = deflateInit(&zstream->z, Z_DEFAULT_COMPRESSION);\n\treturn zstream_seterr(zstream);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"zstream.h\"",
            "#include <zlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nint git_zstream_init(git_zstream *zstream)\n{\n\tzstream->zerr = deflateInit(&zstream->z, Z_DEFAULT_COMPRESSION);\n\treturn zstream_seterr(zstream);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nint git_zstream_deflatebuf(git_buf *out, const void *in, size_t in_len)\n{\n\tgit_zstream zs = GIT_ZSTREAM_INIT;\n\tint error = 0;\n\n\tif ((error = git_zstream_init(&zs)) < 0)\n\t\treturn error;\n\n\tif ((error = git_zstream_set_input(&zs, in, in_len)) < 0)\n\t\tgoto done;\n\n\twhile (!git_zstream_done(&zs)) {\n\t\tsize_t step = git_zstream_suggest_output_len(&zs), written;\n\n\t\tif ((error = git_buf_grow_by(out, step)) < 0)\n\t\t\tgoto done;\n\n\t\twritten = out->asize - out->size;\n\n\t\tif ((error = git_zstream_get_output(\n\t\t\t\tout->ptr + out->size, &written, &zs)) < 0)\n\t\t\tgoto done;\n\n\t\tout->size += written;\n\t}\n\n\t/* NULL terminate for consistency if possible */\n\tif (out->size < out->asize)\n\t\tout->ptr[out->size] = '\\0';\n\ndone:\n\tgit_zstream_free(&zs);\n\treturn error;\n}"
  },
  {
    "function_name": "git_zstream_get_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
    "lines": "73-121",
    "snippet": "int git_zstream_get_output(void *out, size_t *out_len, git_zstream *zstream)\n{\n\tint zflush = Z_FINISH;\n\tsize_t out_remain = *out_len;\n\n\twhile (out_remain > 0 && zstream->zerr != Z_STREAM_END) {\n\t\tsize_t out_queued, in_queued, out_used, in_used;\n\n\t\t/* set up in data */\n\t\tzstream->z.next_in  = (Bytef *)zstream->in;\n\t\tzstream->z.avail_in = (uInt)zstream->in_len;\n\t\tif ((size_t)zstream->z.avail_in != zstream->in_len) {\n\t\t\tzstream->z.avail_in = INT_MAX;\n\t\t\tzflush = Z_NO_FLUSH;\n\t\t} else {\n\t\t\tzflush = Z_FINISH;\n\t\t}\n\t\tin_queued = (size_t)zstream->z.avail_in;\n\n\t\t/* set up out data */\n\t\tzstream->z.next_out = out;\n\t\tzstream->z.avail_out = (uInt)out_remain;\n\t\tif ((size_t)zstream->z.avail_out != out_remain)\n\t\t\tzstream->z.avail_out = INT_MAX;\n\t\tout_queued = (size_t)zstream->z.avail_out;\n\n\t\t/* compress next chunk */\n\t\tzstream->zerr = deflate(&zstream->z, zflush);\n\n\t\tif (zstream->zerr == Z_STREAM_ERROR)\n\t\t\treturn zstream_seterr(zstream);\n\n\t\tout_used = (out_queued - zstream->z.avail_out);\n\t\tout_remain -= out_used;\n\t\tout = ((char *)out) + out_used;\n\n\t\tin_used = (in_queued - zstream->z.avail_in);\n\t\tzstream->in_len -= in_used;\n\t\tzstream->in += in_used;\n\t}\n\n\t/* either we finished the input or we did not flush the data */\n\tassert(zstream->in_len > 0 || zflush == Z_FINISH);\n\n\t/* set out_size to number of bytes actually written to output */\n\t*out_len = *out_len - out_remain;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"zstream.h\"",
      "#include <zlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "zstream->in_len > 0 || zflush == Z_FINISH"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zstream_seterr",
          "args": [
            "zstream"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "zstream_seterr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
          "lines": "16-29",
          "snippet": "static int zstream_seterr(git_zstream *zs)\n{\n\tif (zs->zerr == Z_OK || zs->zerr == Z_STREAM_END)\n\t\treturn 0;\n\n\tif (zs->zerr == Z_MEM_ERROR)\n\t\tgiterr_set_oom();\n\telse if (zs->z.msg)\n\t\tgiterr_set(GITERR_ZLIB, zs->z.msg);\n\telse\n\t\tgiterr_set(GITERR_ZLIB, \"Unknown compression error\");\n\n\treturn -1;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"zstream.h\"",
            "#include <zlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nstatic int zstream_seterr(git_zstream *zs)\n{\n\tif (zs->zerr == Z_OK || zs->zerr == Z_STREAM_END)\n\t\treturn 0;\n\n\tif (zs->zerr == Z_MEM_ERROR)\n\t\tgiterr_set_oom();\n\telse if (zs->z.msg)\n\t\tgiterr_set(GITERR_ZLIB, zs->z.msg);\n\telse\n\t\tgiterr_set(GITERR_ZLIB, \"Unknown compression error\");\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "deflate",
          "args": [
            "&zstream->z",
            "zflush"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nint git_zstream_get_output(void *out, size_t *out_len, git_zstream *zstream)\n{\n\tint zflush = Z_FINISH;\n\tsize_t out_remain = *out_len;\n\n\twhile (out_remain > 0 && zstream->zerr != Z_STREAM_END) {\n\t\tsize_t out_queued, in_queued, out_used, in_used;\n\n\t\t/* set up in data */\n\t\tzstream->z.next_in  = (Bytef *)zstream->in;\n\t\tzstream->z.avail_in = (uInt)zstream->in_len;\n\t\tif ((size_t)zstream->z.avail_in != zstream->in_len) {\n\t\t\tzstream->z.avail_in = INT_MAX;\n\t\t\tzflush = Z_NO_FLUSH;\n\t\t} else {\n\t\t\tzflush = Z_FINISH;\n\t\t}\n\t\tin_queued = (size_t)zstream->z.avail_in;\n\n\t\t/* set up out data */\n\t\tzstream->z.next_out = out;\n\t\tzstream->z.avail_out = (uInt)out_remain;\n\t\tif ((size_t)zstream->z.avail_out != out_remain)\n\t\t\tzstream->z.avail_out = INT_MAX;\n\t\tout_queued = (size_t)zstream->z.avail_out;\n\n\t\t/* compress next chunk */\n\t\tzstream->zerr = deflate(&zstream->z, zflush);\n\n\t\tif (zstream->zerr == Z_STREAM_ERROR)\n\t\t\treturn zstream_seterr(zstream);\n\n\t\tout_used = (out_queued - zstream->z.avail_out);\n\t\tout_remain -= out_used;\n\t\tout = ((char *)out) + out_used;\n\n\t\tin_used = (in_queued - zstream->z.avail_in);\n\t\tzstream->in_len -= in_used;\n\t\tzstream->in += in_used;\n\t}\n\n\t/* either we finished the input or we did not flush the data */\n\tassert(zstream->in_len > 0 || zflush == Z_FINISH);\n\n\t/* set out_size to number of bytes actually written to output */\n\t*out_len = *out_len - out_remain;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_zstream_suggest_output_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
    "lines": "63-71",
    "snippet": "size_t git_zstream_suggest_output_len(git_zstream *zstream)\n{\n\tif (zstream->in_len > ZSTREAM_BUFFER_SIZE)\n\t\treturn ZSTREAM_BUFFER_SIZE;\n\telse if (zstream->in_len > ZSTREAM_BUFFER_MIN_EXTRA)\n\t\treturn zstream->in_len;\n\telse\n\t\treturn ZSTREAM_BUFFER_MIN_EXTRA;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"zstream.h\"",
      "#include <zlib.h>"
    ],
    "macros_used": [
      "#define ZSTREAM_BUFFER_MIN_EXTRA 8",
      "#define ZSTREAM_BUFFER_SIZE (1024 * 1024)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\n#define ZSTREAM_BUFFER_MIN_EXTRA 8\n#define ZSTREAM_BUFFER_SIZE (1024 * 1024)\n\nsize_t git_zstream_suggest_output_len(git_zstream *zstream)\n{\n\tif (zstream->in_len > ZSTREAM_BUFFER_SIZE)\n\t\treturn ZSTREAM_BUFFER_SIZE;\n\telse if (zstream->in_len > ZSTREAM_BUFFER_MIN_EXTRA)\n\t\treturn zstream->in_len;\n\telse\n\t\treturn ZSTREAM_BUFFER_MIN_EXTRA;\n}"
  },
  {
    "function_name": "git_zstream_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
    "lines": "58-61",
    "snippet": "bool git_zstream_done(git_zstream *zstream)\n{\n\treturn (!zstream->in_len && zstream->zerr == Z_STREAM_END);\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"zstream.h\"",
      "#include <zlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nbool git_zstream_done(git_zstream *zstream)\n{\n\treturn (!zstream->in_len && zstream->zerr == Z_STREAM_END);\n}"
  },
  {
    "function_name": "git_zstream_set_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
    "lines": "50-56",
    "snippet": "int git_zstream_set_input(git_zstream *zstream, const void *in, size_t in_len)\n{\n\tzstream->in = in;\n\tzstream->in_len = in_len;\n\tzstream->zerr = Z_OK;\n\treturn 0;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"zstream.h\"",
      "#include <zlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nint git_zstream_set_input(git_zstream *zstream, const void *in, size_t in_len)\n{\n\tzstream->in = in;\n\tzstream->in_len = in_len;\n\tzstream->zerr = Z_OK;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_zstream_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
    "lines": "42-48",
    "snippet": "void git_zstream_reset(git_zstream *zstream)\n{\n\tdeflateReset(&zstream->z);\n\tzstream->in = NULL;\n\tzstream->in_len = 0;\n\tzstream->zerr = Z_STREAM_END;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"zstream.h\"",
      "#include <zlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "deflateReset",
          "args": [
            "&zstream->z"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nvoid git_zstream_reset(git_zstream *zstream)\n{\n\tdeflateReset(&zstream->z);\n\tzstream->in = NULL;\n\tzstream->in_len = 0;\n\tzstream->zerr = Z_STREAM_END;\n}"
  },
  {
    "function_name": "git_zstream_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
    "lines": "37-40",
    "snippet": "void git_zstream_free(git_zstream *zstream)\n{\n\tdeflateEnd(&zstream->z);\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"zstream.h\"",
      "#include <zlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "deflateEnd",
          "args": [
            "&zstream->z"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nvoid git_zstream_free(git_zstream *zstream)\n{\n\tdeflateEnd(&zstream->z);\n}"
  },
  {
    "function_name": "git_zstream_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
    "lines": "31-35",
    "snippet": "int git_zstream_init(git_zstream *zstream)\n{\n\tzstream->zerr = deflateInit(&zstream->z, Z_DEFAULT_COMPRESSION);\n\treturn zstream_seterr(zstream);\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"zstream.h\"",
      "#include <zlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zstream_seterr",
          "args": [
            "zstream"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "zstream_seterr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
          "lines": "16-29",
          "snippet": "static int zstream_seterr(git_zstream *zs)\n{\n\tif (zs->zerr == Z_OK || zs->zerr == Z_STREAM_END)\n\t\treturn 0;\n\n\tif (zs->zerr == Z_MEM_ERROR)\n\t\tgiterr_set_oom();\n\telse if (zs->z.msg)\n\t\tgiterr_set(GITERR_ZLIB, zs->z.msg);\n\telse\n\t\tgiterr_set(GITERR_ZLIB, \"Unknown compression error\");\n\n\treturn -1;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"zstream.h\"",
            "#include <zlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nstatic int zstream_seterr(git_zstream *zs)\n{\n\tif (zs->zerr == Z_OK || zs->zerr == Z_STREAM_END)\n\t\treturn 0;\n\n\tif (zs->zerr == Z_MEM_ERROR)\n\t\tgiterr_set_oom();\n\telse if (zs->z.msg)\n\t\tgiterr_set(GITERR_ZLIB, zs->z.msg);\n\telse\n\t\tgiterr_set(GITERR_ZLIB, \"Unknown compression error\");\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "deflateInit",
          "args": [
            "&zstream->z",
            "Z_DEFAULT_COMPRESSION"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nint git_zstream_init(git_zstream *zstream)\n{\n\tzstream->zerr = deflateInit(&zstream->z, Z_DEFAULT_COMPRESSION);\n\treturn zstream_seterr(zstream);\n}"
  },
  {
    "function_name": "zstream_seterr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
    "lines": "16-29",
    "snippet": "static int zstream_seterr(git_zstream *zs)\n{\n\tif (zs->zerr == Z_OK || zs->zerr == Z_STREAM_END)\n\t\treturn 0;\n\n\tif (zs->zerr == Z_MEM_ERROR)\n\t\tgiterr_set_oom();\n\telse if (zs->z.msg)\n\t\tgiterr_set(GITERR_ZLIB, zs->z.msg);\n\telse\n\t\tgiterr_set(GITERR_ZLIB, \"Unknown compression error\");\n\n\treturn -1;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"zstream.h\"",
      "#include <zlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_ZLIB",
            "\"Unknown compression error\""
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set_oom",
          "args": [],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "45-48",
          "snippet": "void giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};\n\nvoid giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nstatic int zstream_seterr(git_zstream *zs)\n{\n\tif (zs->zerr == Z_OK || zs->zerr == Z_STREAM_END)\n\t\treturn 0;\n\n\tif (zs->zerr == Z_MEM_ERROR)\n\t\tgiterr_set_oom();\n\telse if (zs->z.msg)\n\t\tgiterr_set(GITERR_ZLIB, zs->z.msg);\n\telse\n\t\tgiterr_set(GITERR_ZLIB, \"Unknown compression error\");\n\n\treturn -1;\n}"
  }
]