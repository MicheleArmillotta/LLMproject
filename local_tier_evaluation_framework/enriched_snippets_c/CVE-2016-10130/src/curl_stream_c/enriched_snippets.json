[
  {
    "function_name": "git_curl_stream_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "251-259",
    "snippet": "int git_curl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(host);\n\tGIT_UNUSED(port);\n\n\tgiterr_set(GITERR_NET, \"curl is not supported in this version\");\n\treturn -1;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"curl is not supported in this version\""
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "port"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "host"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "out"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nint git_curl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(host);\n\tGIT_UNUSED(port);\n\n\tgiterr_set(GITERR_NET, \"curl is not supported in this version\");\n\treturn -1;\n}"
  },
  {
    "function_name": "git_curl_stream_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "199-245",
    "snippet": "int git_curl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tcurl_stream *st;\n\tCURL *handle;\n\tint iport = 0, error;\n\n\tst = git__calloc(1, sizeof(curl_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\thandle = curl_easy_init();\n\tif (handle == NULL) {\n\t\tgiterr_set(GITERR_NET, \"failed to create curl handle\");\n\t\tgit__free(st);\n\t\treturn -1;\n\t}\n\n\tif ((error = git__strtol32(&iport, port, NULL, 10)) < 0) {\n\t\tgit__free(st);\n\t\treturn error;\n\t}\n\n\tcurl_easy_setopt(handle, CURLOPT_URL, host);\n\tcurl_easy_setopt(handle, CURLOPT_ERRORBUFFER, st->curl_error);\n\tcurl_easy_setopt(handle, CURLOPT_PORT, iport);\n\tcurl_easy_setopt(handle, CURLOPT_CONNECT_ONLY, 1);\n\tcurl_easy_setopt(handle, CURLOPT_SSL_VERIFYPEER, 1);\n\tcurl_easy_setopt(handle, CURLOPT_CERTINFO, 1);\n\tcurl_easy_setopt(handle, CURLOPT_HTTPPROXYTUNNEL, 1);\n\tcurl_easy_setopt(handle, CURLOPT_PROXYAUTH, CURLAUTH_ANY);\n\n\t/* curl_easy_setopt(handle, CURLOPT_VERBOSE, 1); */\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.encrypted = 0; /* we don't encrypt ourselves */\n\tst->parent.proxy_support = 1;\n\tst->parent.connect = curls_connect;\n\tst->parent.certificate = curls_certificate;\n\tst->parent.set_proxy = curls_set_proxy;\n\tst->parent.read = curls_read;\n\tst->parent.write = curls_write;\n\tst->parent.close = curls_close;\n\tst->parent.free = curls_free;\n\tst->handle = handle;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "curl_easy_setopt",
          "args": [
            "handle",
            "CURLOPT_PROXYAUTH",
            "CURLAUTH_ANY"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "curl_easy_setopt",
          "args": [
            "handle",
            "CURLOPT_HTTPPROXYTUNNEL",
            "1"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "curl_easy_setopt",
          "args": [
            "handle",
            "CURLOPT_CERTINFO",
            "1"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "curl_easy_setopt",
          "args": [
            "handle",
            "CURLOPT_SSL_VERIFYPEER",
            "1"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "curl_easy_setopt",
          "args": [
            "handle",
            "CURLOPT_CONNECT_ONLY",
            "1"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "curl_easy_setopt",
          "args": [
            "handle",
            "CURLOPT_PORT",
            "iport"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "curl_easy_setopt",
          "args": [
            "handle",
            "CURLOPT_ERRORBUFFER",
            "st->curl_error"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "curl_easy_setopt",
          "args": [
            "handle",
            "CURLOPT_URL",
            "host"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "st"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strtol32",
          "args": [
            "&iport",
            "port",
            "NULL",
            "10"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "git__strtol32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "149-167",
          "snippet": "int git__strtol32(int32_t *result, const char *nptr, const char **endptr, int base)\n{\n\tint error;\n\tint32_t tmp_int;\n\tint64_t tmp_long;\n\n\tif ((error = git__strtol64(&tmp_long, nptr, endptr, base)) < 0)\n\t\treturn error;\n\n\ttmp_int = tmp_long & 0xFFFFFFFF;\n\tif (tmp_int != tmp_long) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert. '%s' is too large\", nptr);\n\t\treturn -1;\n\t}\n\n\t*result = tmp_int;\n\n\treturn error;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strtol32(int32_t *result, const char *nptr, const char **endptr, int base)\n{\n\tint error;\n\tint32_t tmp_int;\n\tint64_t tmp_long;\n\n\tif ((error = git__strtol64(&tmp_long, nptr, endptr, base)) < 0)\n\t\treturn error;\n\n\ttmp_int = tmp_long & 0xFFFFFFFF;\n\tif (tmp_int != tmp_long) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert. '%s' is too large\", nptr);\n\t\treturn -1;\n\t}\n\n\t*result = tmp_int;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"failed to create curl handle\""
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "curl_easy_init",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "st"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(curl_stream)"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nint git_curl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tcurl_stream *st;\n\tCURL *handle;\n\tint iport = 0, error;\n\n\tst = git__calloc(1, sizeof(curl_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\thandle = curl_easy_init();\n\tif (handle == NULL) {\n\t\tgiterr_set(GITERR_NET, \"failed to create curl handle\");\n\t\tgit__free(st);\n\t\treturn -1;\n\t}\n\n\tif ((error = git__strtol32(&iport, port, NULL, 10)) < 0) {\n\t\tgit__free(st);\n\t\treturn error;\n\t}\n\n\tcurl_easy_setopt(handle, CURLOPT_URL, host);\n\tcurl_easy_setopt(handle, CURLOPT_ERRORBUFFER, st->curl_error);\n\tcurl_easy_setopt(handle, CURLOPT_PORT, iport);\n\tcurl_easy_setopt(handle, CURLOPT_CONNECT_ONLY, 1);\n\tcurl_easy_setopt(handle, CURLOPT_SSL_VERIFYPEER, 1);\n\tcurl_easy_setopt(handle, CURLOPT_CERTINFO, 1);\n\tcurl_easy_setopt(handle, CURLOPT_HTTPPROXYTUNNEL, 1);\n\tcurl_easy_setopt(handle, CURLOPT_PROXYAUTH, CURLAUTH_ANY);\n\n\t/* curl_easy_setopt(handle, CURLOPT_VERBOSE, 1); */\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.encrypted = 0; /* we don't encrypt ourselves */\n\tst->parent.proxy_support = 1;\n\tst->parent.connect = curls_connect;\n\tst->parent.certificate = curls_certificate;\n\tst->parent.set_proxy = curls_set_proxy;\n\tst->parent.read = curls_read;\n\tst->parent.write = curls_write;\n\tst->parent.close = curls_close;\n\tst->parent.free = curls_free;\n\tst->handle = handle;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}"
  },
  {
    "function_name": "curls_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "190-197",
    "snippet": "static void curls_free(git_stream *stream)\n{\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tcurls_close(stream);\n\tgit_strarray_free(&s->cert_info_strings);\n\tgit__free(s);\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "s"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strarray_free",
          "args": [
            "&s->cert_info_strings"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "git_strarray_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "21-34",
          "snippet": "void git_strarray_free(git_strarray *array)\n{\n\tsize_t i;\n\n\tif (array == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < array->count; ++i)\n\t\tgit__free(array->strings[i]);\n\n\tgit__free(array->strings);\n\n\tmemset(array, 0, sizeof(*array));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git_strarray_free(git_strarray *array)\n{\n\tsize_t i;\n\n\tif (array == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < array->count; ++i)\n\t\tgit__free(array->strings[i]);\n\n\tgit__free(array->strings);\n\n\tmemset(array, 0, sizeof(*array));\n}"
        }
      },
      {
        "call_info": {
          "callee": "curls_close",
          "args": [
            "stream"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "curls_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "176-188",
          "snippet": "static int curls_close(git_stream *stream)\n{\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tif (!s->handle)\n\t\treturn 0;\n\n\tcurl_easy_cleanup(s->handle);\n\ts->handle = NULL;\n\ts->socket = 0;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int curls_close(git_stream *stream)\n{\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tif (!s->handle)\n\t\treturn 0;\n\n\tcurl_easy_cleanup(s->handle);\n\ts->handle = NULL;\n\ts->socket = 0;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic void curls_free(git_stream *stream)\n{\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tcurls_close(stream);\n\tgit_strarray_free(&s->cert_info_strings);\n\tgit__free(s);\n}"
  },
  {
    "function_name": "curls_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "176-188",
    "snippet": "static int curls_close(git_stream *stream)\n{\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tif (!s->handle)\n\t\treturn 0;\n\n\tcurl_easy_cleanup(s->handle);\n\ts->handle = NULL;\n\ts->socket = 0;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "curl_easy_cleanup",
          "args": [
            "s->handle"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int curls_close(git_stream *stream)\n{\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tif (!s->handle)\n\t\treturn 0;\n\n\tcurl_easy_cleanup(s->handle);\n\ts->handle = NULL;\n\ts->socket = 0;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "curls_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "156-174",
    "snippet": "static ssize_t curls_read(git_stream *stream, void *data, size_t len)\n{\n\tint error;\n\tsize_t read;\n\tCURLcode res;\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tdo {\n\t\tif ((error = wait_for(s->socket, true)) < 0)\n\t\t\treturn error;\n\n\t\tres = curl_easy_recv(s->handle, data, len, &read);\n\t} while (res == CURLE_AGAIN);\n\n\tif (res != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\treturn read;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seterr_curl",
          "args": [
            "s"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "seterr_curl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "26-30",
          "snippet": "static int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "curl_easy_recv",
          "args": [
            "s->handle",
            "data",
            "len",
            "&read"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_for",
          "args": [
            "s->socket",
            "true"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "109-130",
          "snippet": "static int wait_for(curl_socket_t fd, bool reading)\n{\n\tint ret;\n\tfd_set infd, outfd, errfd;\n\n\tFD_ZERO(&infd);\n\tFD_ZERO(&outfd);\n\tFD_ZERO(&errfd);\n\n\tFD_SET(fd, &errfd);\n\tif (reading)\n\t\tFD_SET(fd, &infd);\n\telse\n\t\tFD_SET(fd, &outfd);\n\n\tif ((ret = select(fd + 1, &infd, &outfd, &errfd, NULL)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"error in select\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int wait_for(curl_socket_t fd, bool reading)\n{\n\tint ret;\n\tfd_set infd, outfd, errfd;\n\n\tFD_ZERO(&infd);\n\tFD_ZERO(&outfd);\n\tFD_ZERO(&errfd);\n\n\tFD_SET(fd, &errfd);\n\tif (reading)\n\t\tFD_SET(fd, &infd);\n\telse\n\t\tFD_SET(fd, &outfd);\n\n\tif ((ret = select(fd + 1, &infd, &outfd, &errfd, NULL)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"error in select\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic ssize_t curls_read(git_stream *stream, void *data, size_t len)\n{\n\tint error;\n\tsize_t read;\n\tCURLcode res;\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tdo {\n\t\tif ((error = wait_for(s->socket, true)) < 0)\n\t\t\treturn error;\n\n\t\tres = curl_easy_recv(s->handle, data, len, &read);\n\t} while (res == CURLE_AGAIN);\n\n\tif (res != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\treturn read;\n}"
  },
  {
    "function_name": "curls_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "132-154",
    "snippet": "static ssize_t curls_write(git_stream *stream, const char *data, size_t len, int flags)\n{\n\tint error;\n\tsize_t off = 0, sent;\n\tCURLcode res;\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tGIT_UNUSED(flags);\n\n\tdo {\n\t\tif ((error = wait_for(s->socket, false)) < 0)\n\t\t\treturn error;\n\n\t\tres = curl_easy_send(s->handle, data + off, len - off, &sent);\n\t\tif (res == CURLE_OK)\n\t\t\toff += sent;\n\t} while ((res == CURLE_OK || res == CURLE_AGAIN) && off < len);\n\n\tif (res != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\treturn len;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seterr_curl",
          "args": [
            "s"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "seterr_curl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "26-30",
          "snippet": "static int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "curl_easy_send",
          "args": [
            "s->handle",
            "data + off",
            "len - off",
            "&sent"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_for",
          "args": [
            "s->socket",
            "false"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "109-130",
          "snippet": "static int wait_for(curl_socket_t fd, bool reading)\n{\n\tint ret;\n\tfd_set infd, outfd, errfd;\n\n\tFD_ZERO(&infd);\n\tFD_ZERO(&outfd);\n\tFD_ZERO(&errfd);\n\n\tFD_SET(fd, &errfd);\n\tif (reading)\n\t\tFD_SET(fd, &infd);\n\telse\n\t\tFD_SET(fd, &outfd);\n\n\tif ((ret = select(fd + 1, &infd, &outfd, &errfd, NULL)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"error in select\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int wait_for(curl_socket_t fd, bool reading)\n{\n\tint ret;\n\tfd_set infd, outfd, errfd;\n\n\tFD_ZERO(&infd);\n\tFD_ZERO(&outfd);\n\tFD_ZERO(&errfd);\n\n\tFD_SET(fd, &errfd);\n\tif (reading)\n\t\tFD_SET(fd, &infd);\n\telse\n\t\tFD_SET(fd, &outfd);\n\n\tif ((ret = select(fd + 1, &infd, &outfd, &errfd, NULL)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"error in select\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "flags"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic ssize_t curls_write(git_stream *stream, const char *data, size_t len, int flags)\n{\n\tint error;\n\tsize_t off = 0, sent;\n\tCURLcode res;\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tGIT_UNUSED(flags);\n\n\tdo {\n\t\tif ((error = wait_for(s->socket, false)) < 0)\n\t\t\treturn error;\n\n\t\tres = curl_easy_send(s->handle, data + off, len - off, &sent);\n\t\tif (res == CURLE_OK)\n\t\t\toff += sent;\n\t} while ((res == CURLE_OK || res == CURLE_AGAIN) && off < len);\n\n\tif (res != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\treturn len;\n}"
  },
  {
    "function_name": "wait_for",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "109-130",
    "snippet": "static int wait_for(curl_socket_t fd, bool reading)\n{\n\tint ret;\n\tfd_set infd, outfd, errfd;\n\n\tFD_ZERO(&infd);\n\tFD_ZERO(&outfd);\n\tFD_ZERO(&errfd);\n\n\tFD_SET(fd, &errfd);\n\tif (reading)\n\t\tFD_SET(fd, &infd);\n\telse\n\t\tFD_SET(fd, &outfd);\n\n\tif ((ret = select(fd + 1, &infd, &outfd, &errfd, NULL)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"error in select\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"error in select\""
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "select",
          "args": [
            "fd + 1",
            "&infd",
            "&outfd",
            "&errfd",
            "NULL"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FD_SET",
          "args": [
            "fd",
            "&outfd"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FD_SET",
          "args": [
            "fd",
            "&infd"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FD_SET",
          "args": [
            "fd",
            "&errfd"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FD_ZERO",
          "args": [
            "&errfd"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FD_ZERO",
          "args": [
            "&outfd"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FD_ZERO",
          "args": [
            "&infd"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int wait_for(curl_socket_t fd, bool reading)\n{\n\tint ret;\n\tfd_set infd, outfd, errfd;\n\n\tFD_ZERO(&infd);\n\tFD_ZERO(&outfd);\n\tFD_ZERO(&errfd);\n\n\tFD_SET(fd, &errfd);\n\tif (reading)\n\t\tFD_SET(fd, &infd);\n\telse\n\t\tFD_SET(fd, &outfd);\n\n\tif ((ret = select(fd + 1, &infd, &outfd, &errfd, NULL)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"error in select\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "curls_set_proxy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "98-107",
    "snippet": "static int curls_set_proxy(git_stream *stream, const char *proxy_url)\n{\n\tCURLcode res;\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tif ((res = curl_easy_setopt(s->handle, CURLOPT_PROXY, proxy_url)) != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seterr_curl",
          "args": [
            "s"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "seterr_curl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "26-30",
          "snippet": "static int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "curl_easy_setopt",
          "args": [
            "s->handle",
            "CURLOPT_PROXY",
            "proxy_url"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int curls_set_proxy(git_stream *stream, const char *proxy_url)\n{\n\tCURLcode res;\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tif ((res = curl_easy_setopt(s->handle, CURLOPT_PROXY, proxy_url)) != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "curls_certificate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "56-96",
    "snippet": "static int curls_certificate(git_cert **out, git_stream *stream)\n{\n\tint error;\n\tCURLcode res;\n\tstruct curl_slist *slist;\n\tstruct curl_certinfo *certinfo;\n\tgit_vector strings = GIT_VECTOR_INIT;\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tif ((res = curl_easy_getinfo(s->handle, CURLINFO_CERTINFO, &certinfo)) != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\t/* No information is available, can happen with SecureTransport */\n\tif (certinfo->num_of_certs == 0) {\n\t\ts->cert_info.parent.cert_type = GIT_CERT_NONE;\n\t\ts->cert_info.data             = NULL;\n\t\ts->cert_info.len              = 0;\n\t\treturn 0;\n\t}\n\n\tif ((error = git_vector_init(&strings, 8, NULL)) < 0)\n\t\treturn error;\n\n\tfor (slist = certinfo->certinfo[0]; slist; slist = slist->next) {\n\t\tchar *str = git__strdup(slist->data);\n\t\tGITERR_CHECK_ALLOC(str);\n\t\tgit_vector_insert(&strings, str);\n\t}\n\n\t/* Copy the contents of the vector into a strarray so we can expose them */\n\ts->cert_info_strings.strings = (char **) strings.contents;\n\ts->cert_info_strings.count   = strings.length;\n\n\ts->cert_info.parent.cert_type = GIT_CERT_STRARRAY;\n\ts->cert_info.data             = &s->cert_info_strings;\n\ts->cert_info.len              = strings.length;\n\n\t*out = &s->cert_info.parent;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&strings",
            "str"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "str"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "slist->data"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "&strings",
            "8",
            "NULL"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "seterr_curl",
          "args": [
            "s"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "seterr_curl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "26-30",
          "snippet": "static int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "curl_easy_getinfo",
          "args": [
            "s->handle",
            "CURLINFO_CERTINFO",
            "&certinfo"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int curls_certificate(git_cert **out, git_stream *stream)\n{\n\tint error;\n\tCURLcode res;\n\tstruct curl_slist *slist;\n\tstruct curl_certinfo *certinfo;\n\tgit_vector strings = GIT_VECTOR_INIT;\n\tcurl_stream *s = (curl_stream *) stream;\n\n\tif ((res = curl_easy_getinfo(s->handle, CURLINFO_CERTINFO, &certinfo)) != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\t/* No information is available, can happen with SecureTransport */\n\tif (certinfo->num_of_certs == 0) {\n\t\ts->cert_info.parent.cert_type = GIT_CERT_NONE;\n\t\ts->cert_info.data             = NULL;\n\t\ts->cert_info.len              = 0;\n\t\treturn 0;\n\t}\n\n\tif ((error = git_vector_init(&strings, 8, NULL)) < 0)\n\t\treturn error;\n\n\tfor (slist = certinfo->certinfo[0]; slist; slist = slist->next) {\n\t\tchar *str = git__strdup(slist->data);\n\t\tGITERR_CHECK_ALLOC(str);\n\t\tgit_vector_insert(&strings, str);\n\t}\n\n\t/* Copy the contents of the vector into a strarray so we can expose them */\n\ts->cert_info_strings.strings = (char **) strings.contents;\n\ts->cert_info_strings.count   = strings.length;\n\n\ts->cert_info.parent.cert_type = GIT_CERT_STRARRAY;\n\ts->cert_info.data             = &s->cert_info_strings;\n\ts->cert_info.len              = strings.length;\n\n\t*out = &s->cert_info.parent;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "curls_connect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "32-54",
    "snippet": "static int curls_connect(git_stream *stream)\n{\n\tcurl_stream *s = (curl_stream *) stream;\n\tlong sockextr;\n\tint failed_cert = 0;\n\tCURLcode res;\n\tres = curl_easy_perform(s->handle);\n\n\tif (res != CURLE_OK && res != CURLE_PEER_FAILED_VERIFICATION)\n\t\treturn seterr_curl(s);\n\tif (res == CURLE_PEER_FAILED_VERIFICATION)\n\t\tfailed_cert = 1;\n\n\tif ((res = curl_easy_getinfo(s->handle, CURLINFO_LASTSOCKET, &sockextr)) != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\ts->socket = sockextr;\n\n\tif (s->parent.encrypted && failed_cert)\n\t\treturn GIT_ECERTIFICATE;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seterr_curl",
          "args": [
            "s"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "seterr_curl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "26-30",
          "snippet": "static int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "curl_easy_getinfo",
          "args": [
            "s->handle",
            "CURLINFO_LASTSOCKET",
            "&sockextr"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "curl_easy_perform",
          "args": [
            "s->handle"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int curls_connect(git_stream *stream)\n{\n\tcurl_stream *s = (curl_stream *) stream;\n\tlong sockextr;\n\tint failed_cert = 0;\n\tCURLcode res;\n\tres = curl_easy_perform(s->handle);\n\n\tif (res != CURLE_OK && res != CURLE_PEER_FAILED_VERIFICATION)\n\t\treturn seterr_curl(s);\n\tif (res == CURLE_PEER_FAILED_VERIFICATION)\n\t\tfailed_cert = 1;\n\n\tif ((res = curl_easy_getinfo(s->handle, CURLINFO_LASTSOCKET, &sockextr)) != CURLE_OK)\n\t\treturn seterr_curl(s);\n\n\ts->socket = sockextr;\n\n\tif (s->parent.encrypted && failed_cert)\n\t\treturn GIT_ECERTIFICATE;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "seterr_curl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
    "lines": "26-30",
    "snippet": "static int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}",
    "includes": [
      "#include \"stream.h\"",
      "#include \"vector.h\"",
      "#include \"buffer.h\"",
      "#include \"git2/transport.h\"",
      "#include \"stream.h\"",
      "#include <curl/curl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"curl error: %s\\n\"",
            "s->curl_error"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nstatic int seterr_curl(curl_stream *s)\n{\n\tgiterr_set(GITERR_NET, \"curl error: %s\\n\", s->curl_error);\n\treturn -1;\n}"
  }
]