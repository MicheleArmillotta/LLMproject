[
  {
    "function_name": "git_signature__equal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "286-295",
    "snippet": "bool git_signature__equal(const git_signature *one, const git_signature *two)\n{\n\tassert(one && two);\n\n\treturn\n\t\tgit__strcmp(one->name, two->name) == 0 &&\n\t\tgit__strcmp(one->email, two->email) == 0 &&\n\t\tone->when.time == two->when.time &&\n\t\tone->when.offset == two->when.offset;\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__strcmp",
          "args": [
            "one->email",
            "two->email"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "one && two"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nbool git_signature__equal(const git_signature *one, const git_signature *two)\n{\n\tassert(one && two);\n\n\treturn\n\t\tgit__strcmp(one->name, two->name) == 0 &&\n\t\tgit__strcmp(one->email, two->email) == 0 &&\n\t\tone->when.time == two->when.time &&\n\t\tone->when.offset == two->when.offset;\n}"
  },
  {
    "function_name": "git_signature__writebuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "265-284",
    "snippet": "void git_signature__writebuf(git_buf *buf, const char *header, const git_signature *sig)\n{\n\tint offset, hours, mins;\n\tchar sign;\n\n\tassert(buf && sig);\n\n\toffset = sig->when.offset;\n\tsign = (sig->when.offset < 0) ? '-' : '+';\n\n\tif (offset < 0)\n\t\toffset = -offset;\n\n\thours = offset / 60;\n\tmins = offset % 60;\n\n\tgit_buf_printf(buf, \"%s%s <%s> %u %c%02d%02d\\n\",\n\t\t\theader ? header : \"\", sig->name, sig->email,\n\t\t\t(unsigned)sig->when.time, sign, hours, mins);\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "buf",
            "\"%s%s <%s> %u %c%02d%02d\\n\"",
            "header ? header : \"\"",
            "sig->name",
            "sig->email",
            "(unsigned)sig->when.time",
            "sign",
            "hours",
            "mins"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "buf && sig"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nvoid git_signature__writebuf(git_buf *buf, const char *header, const git_signature *sig)\n{\n\tint offset, hours, mins;\n\tchar sign;\n\n\tassert(buf && sig);\n\n\toffset = sig->when.offset;\n\tsign = (sig->when.offset < 0) ? '-' : '+';\n\n\tif (offset < 0)\n\t\toffset = -offset;\n\n\thours = offset / 60;\n\tmins = offset % 60;\n\n\tgit_buf_printf(buf, \"%s%s <%s> %u %c%02d%02d\\n\",\n\t\t\theader ? header : \"\", sig->name, sig->email,\n\t\t\t(unsigned)sig->when.time, sign, hours, mins);\n}"
  },
  {
    "function_name": "git_signature__parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "195-263",
    "snippet": "int git_signature__parse(git_signature *sig, const char **buffer_out,\n\t\tconst char *buffer_end, const char *header, char ender)\n{\n\tconst char *buffer = *buffer_out;\n\tconst char *email_start, *email_end;\n\n\tmemset(sig, 0, sizeof(git_signature));\n\n\tif ((buffer_end = memchr(buffer, ender, buffer_end - buffer)) == NULL)\n\t\treturn signature_error(\"no newline given\");\n\n\tif (header) {\n\t\tconst size_t header_len = strlen(header);\n\n\t\tif (buffer + header_len >= buffer_end || memcmp(buffer, header, header_len) != 0)\n\t\t\treturn signature_error(\"expected prefix doesn't match actual\");\n\n\t\tbuffer += header_len;\n\t}\n\n\temail_start = git__memrchr(buffer, '<', buffer_end - buffer);\n\temail_end = git__memrchr(buffer, '>', buffer_end - buffer);\n\n\tif (!email_start || !email_end || email_end <= email_start)\n\t\treturn signature_error(\"malformed e-mail\");\n\n\temail_start += 1;\n\tsig->name = extract_trimmed(buffer, email_start - buffer - 1);\n\tsig->email = extract_trimmed(email_start, email_end - email_start);\n\n\t/* Do we even have a time at the end of the signature? */\n\tif (email_end + 2 < buffer_end) {\n\t\tconst char *time_start = email_end + 2;\n\t\tconst char *time_end;\n\n\t\tif (git__strtol64(&sig->when.time, time_start, &time_end, 10) < 0)\n\t\t\treturn signature_error(\"invalid Unix timestamp\");\n\n\t\t/* do we have a timezone? */\n\t\tif (time_end + 1 < buffer_end) {\n\t\t\tint offset, hours, mins;\n\t\t\tconst char *tz_start, *tz_end;\n\n\t\t\ttz_start = time_end + 1;\n\n\t\t\tif ((tz_start[0] != '-' && tz_start[0] != '+') ||\n\t\t\t\tgit__strtol32(&offset, tz_start + 1, &tz_end, 10) < 0) {\n\t\t\t\t//malformed timezone, just assume it's zero\n\t\t\t\toffset = 0;\n\t\t\t}\n\n\t\t\thours = offset / 100;\n\t\t\tmins = offset % 100;\n\n\t\t\t/*\n\t\t\t * only store timezone if it's not overflowing;\n\t\t\t * see http://www.worldtimezone.com/faq.html\n\t\t\t */\n\t\t\tif (hours < 14 && mins < 59) {\n\t\t\t\tsig->when.offset = (hours * 60) + mins;\n\t\t\t\tif (tz_start[0] == '-')\n\t\t\t\t\tsig->when.offset = -sig->when.offset;\n\t\t\t}\n\t\t}\n\t}\n\n\t*buffer_out = buffer_end + 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__strtol32",
          "args": [
            "&offset",
            "tz_start + 1",
            "&tz_end",
            "10"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "git__strtol32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "149-167",
          "snippet": "int git__strtol32(int32_t *result, const char *nptr, const char **endptr, int base)\n{\n\tint error;\n\tint32_t tmp_int;\n\tint64_t tmp_long;\n\n\tif ((error = git__strtol64(&tmp_long, nptr, endptr, base)) < 0)\n\t\treturn error;\n\n\ttmp_int = tmp_long & 0xFFFFFFFF;\n\tif (tmp_int != tmp_long) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert. '%s' is too large\", nptr);\n\t\treturn -1;\n\t}\n\n\t*result = tmp_int;\n\n\treturn error;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strtol32(int32_t *result, const char *nptr, const char **endptr, int base)\n{\n\tint error;\n\tint32_t tmp_int;\n\tint64_t tmp_long;\n\n\tif ((error = git__strtol64(&tmp_long, nptr, endptr, base)) < 0)\n\t\treturn error;\n\n\ttmp_int = tmp_long & 0xFFFFFFFF;\n\tif (tmp_int != tmp_long) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert. '%s' is too large\", nptr);\n\t\treturn -1;\n\t}\n\n\t*result = tmp_int;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "signature_error",
          "args": [
            "\"invalid Unix timestamp\""
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "signature_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "26-30",
          "snippet": "static int signature_error(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Failed to parse signature - %s\", msg);\n\treturn -1;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic int signature_error(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Failed to parse signature - %s\", msg);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strtol64",
          "args": [
            "&sig->when.time",
            "time_start",
            "&time_end",
            "10"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "git__strtol64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "67-147",
          "snippet": "int git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "extract_trimmed",
          "args": [
            "email_start",
            "email_end - email_start"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "extract_trimmed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "51-62",
          "snippet": "static char *extract_trimmed(const char *ptr, size_t len)\n{\n\twhile (len && is_crud((unsigned char)ptr[0])) {\n\t\tptr++; len--;\n\t}\n\n\twhile (len && is_crud((unsigned char)ptr[len - 1])) {\n\t\tlen--;\n\t}\n\n\treturn git__substrdup(ptr, len);\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic char *extract_trimmed(const char *ptr, size_t len)\n{\n\twhile (len && is_crud((unsigned char)ptr[0])) {\n\t\tptr++; len--;\n\t}\n\n\twhile (len && is_crud((unsigned char)ptr[len - 1])) {\n\t\tlen--;\n\t}\n\n\treturn git__substrdup(ptr, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__memrchr",
          "args": [
            "buffer",
            "'>'",
            "buffer_end - buffer"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "git__memrchr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "300-313",
          "snippet": "GIT_INLINE(const void *) git__memrchr(const void *s, int c, size_t n)\n{\n\tconst unsigned char *cp;\n\n\tif (n != 0) {\n\t\tcp = (unsigned char *)s + n;\n\t\tdo {\n\t\t\tif (*(--cp) == (unsigned char)c)\n\t\t\t\treturn cp;\n\t\t} while (--n != 0);\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(const void *) git__memrchr(const void *s, int c, size_t n)\n{\n\tconst unsigned char *cp;\n\n\tif (n != 0) {\n\t\tcp = (unsigned char *)s + n;\n\t\tdo {\n\t\t\tif (*(--cp) == (unsigned char)c)\n\t\t\t\treturn cp;\n\t\t} while (--n != 0);\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "buffer",
            "header",
            "header_len"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "header"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "buffer",
            "ender",
            "buffer_end - buffer"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "sig",
            "0",
            "sizeof(git_signature)"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature__parse(git_signature *sig, const char **buffer_out,\n\t\tconst char *buffer_end, const char *header, char ender)\n{\n\tconst char *buffer = *buffer_out;\n\tconst char *email_start, *email_end;\n\n\tmemset(sig, 0, sizeof(git_signature));\n\n\tif ((buffer_end = memchr(buffer, ender, buffer_end - buffer)) == NULL)\n\t\treturn signature_error(\"no newline given\");\n\n\tif (header) {\n\t\tconst size_t header_len = strlen(header);\n\n\t\tif (buffer + header_len >= buffer_end || memcmp(buffer, header, header_len) != 0)\n\t\t\treturn signature_error(\"expected prefix doesn't match actual\");\n\n\t\tbuffer += header_len;\n\t}\n\n\temail_start = git__memrchr(buffer, '<', buffer_end - buffer);\n\temail_end = git__memrchr(buffer, '>', buffer_end - buffer);\n\n\tif (!email_start || !email_end || email_end <= email_start)\n\t\treturn signature_error(\"malformed e-mail\");\n\n\temail_start += 1;\n\tsig->name = extract_trimmed(buffer, email_start - buffer - 1);\n\tsig->email = extract_trimmed(email_start, email_end - email_start);\n\n\t/* Do we even have a time at the end of the signature? */\n\tif (email_end + 2 < buffer_end) {\n\t\tconst char *time_start = email_end + 2;\n\t\tconst char *time_end;\n\n\t\tif (git__strtol64(&sig->when.time, time_start, &time_end, 10) < 0)\n\t\t\treturn signature_error(\"invalid Unix timestamp\");\n\n\t\t/* do we have a timezone? */\n\t\tif (time_end + 1 < buffer_end) {\n\t\t\tint offset, hours, mins;\n\t\t\tconst char *tz_start, *tz_end;\n\n\t\t\ttz_start = time_end + 1;\n\n\t\t\tif ((tz_start[0] != '-' && tz_start[0] != '+') ||\n\t\t\t\tgit__strtol32(&offset, tz_start + 1, &tz_end, 10) < 0) {\n\t\t\t\t//malformed timezone, just assume it's zero\n\t\t\t\toffset = 0;\n\t\t\t}\n\n\t\t\thours = offset / 100;\n\t\t\tmins = offset % 100;\n\n\t\t\t/*\n\t\t\t * only store timezone if it's not overflowing;\n\t\t\t * see http://www.worldtimezone.com/faq.html\n\t\t\t */\n\t\t\tif (hours < 14 && mins < 59) {\n\t\t\t\tsig->when.offset = (hours * 60) + mins;\n\t\t\t\tif (tz_start[0] == '-')\n\t\t\t\t\tsig->when.offset = -sig->when.offset;\n\t\t\t}\n\t\t}\n\t}\n\n\t*buffer_out = buffer_end + 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_signature_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "178-193",
    "snippet": "int git_signature_default(git_signature **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *cfg;\n\tconst char *user_name, *user_email;\n\n\tif ((error = git_repository_config_snapshot(&cfg, repo)) < 0)\n\t\treturn error;\n\n\tif (!(error = git_config_get_string(&user_name, cfg, \"user.name\")) &&\n\t\t!(error = git_config_get_string(&user_email, cfg, \"user.email\")))\n\t\terror = git_signature_now(out, user_name, user_email);\n\n\tgit_config_free(cfg);\n\treturn error;\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "cfg"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_signature_now",
          "args": [
            "out",
            "user_name",
            "user_email"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_now",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "146-176",
          "snippet": "int git_signature_now(git_signature **sig_out, const char *name, const char *email)\n{\n\ttime_t now;\n\ttime_t offset;\n\tstruct tm *utc_tm;\n\tgit_signature *sig;\n\tstruct tm _utc;\n\n\t*sig_out = NULL;\n\n\t/*\n\t * Get the current time as seconds since the epoch and\n\t * transform that into a tm struct containing the time at\n\t * UTC. Give that to mktime which considers it a local time\n\t * (tm_isdst = -1 asks it to take DST into account) and gives\n\t * us that time as seconds since the epoch. The difference\n\t * between its return value and 'now' is our offset to UTC.\n\t */\n\ttime(&now);\n\tutc_tm = p_gmtime_r(&now, &_utc);\n\tutc_tm->tm_isdst = -1;\n\toffset = (time_t)difftime(now, mktime(utc_tm));\n\toffset /= 60;\n\n\tif (git_signature_new(&sig, name, email, now, (int)offset) < 0)\n\t\treturn -1;\n\n\t*sig_out = sig;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_now(git_signature **sig_out, const char *name, const char *email)\n{\n\ttime_t now;\n\ttime_t offset;\n\tstruct tm *utc_tm;\n\tgit_signature *sig;\n\tstruct tm _utc;\n\n\t*sig_out = NULL;\n\n\t/*\n\t * Get the current time as seconds since the epoch and\n\t * transform that into a tm struct containing the time at\n\t * UTC. Give that to mktime which considers it a local time\n\t * (tm_isdst = -1 asks it to take DST into account) and gives\n\t * us that time as seconds since the epoch. The difference\n\t * between its return value and 'now' is our offset to UTC.\n\t */\n\ttime(&now);\n\tutc_tm = p_gmtime_r(&now, &_utc);\n\tutc_tm->tm_isdst = -1;\n\toffset = (time_t)difftime(now, mktime(utc_tm));\n\toffset /= 60;\n\n\tif (git_signature_new(&sig, name, email, now, (int)offset) < 0)\n\t\treturn -1;\n\n\t*sig_out = sig;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_get_string",
          "args": [
            "&user_email",
            "cfg",
            "\"user.email\""
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_get_string_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "857-875",
          "snippet": "int git_config_get_string_buf(\n\tgit_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\tconst char *str;\n\n\tgit_buf_sanitize(out);\n\n\tret  = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS);\n\tstr = !ret ? (entry->value ? entry->value : \"\") : NULL;\n\n\tif (str)\n\t\tret = git_buf_puts(out, str);\n\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_string_buf(\n\tgit_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\tconst char *str;\n\n\tgit_buf_sanitize(out);\n\n\tret  = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS);\n\tstr = !ret ? (entry->value ? entry->value : \"\") : NULL;\n\n\tif (str)\n\t\tret = git_buf_puts(out, str);\n\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config_snapshot",
          "args": [
            "&cfg",
            "repo"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config_snapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "716-725",
          "snippet": "int git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_default(git_signature **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *cfg;\n\tconst char *user_name, *user_email;\n\n\tif ((error = git_repository_config_snapshot(&cfg, repo)) < 0)\n\t\treturn error;\n\n\tif (!(error = git_config_get_string(&user_name, cfg, \"user.name\")) &&\n\t\t!(error = git_config_get_string(&user_email, cfg, \"user.email\")))\n\t\terror = git_signature_now(out, user_name, user_email);\n\n\tgit_config_free(cfg);\n\treturn error;\n}"
  },
  {
    "function_name": "git_signature_now",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "146-176",
    "snippet": "int git_signature_now(git_signature **sig_out, const char *name, const char *email)\n{\n\ttime_t now;\n\ttime_t offset;\n\tstruct tm *utc_tm;\n\tgit_signature *sig;\n\tstruct tm _utc;\n\n\t*sig_out = NULL;\n\n\t/*\n\t * Get the current time as seconds since the epoch and\n\t * transform that into a tm struct containing the time at\n\t * UTC. Give that to mktime which considers it a local time\n\t * (tm_isdst = -1 asks it to take DST into account) and gives\n\t * us that time as seconds since the epoch. The difference\n\t * between its return value and 'now' is our offset to UTC.\n\t */\n\ttime(&now);\n\tutc_tm = p_gmtime_r(&now, &_utc);\n\tutc_tm->tm_isdst = -1;\n\toffset = (time_t)difftime(now, mktime(utc_tm));\n\toffset /= 60;\n\n\tif (git_signature_new(&sig, name, email, now, (int)offset) < 0)\n\t\treturn -1;\n\n\t*sig_out = sig;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_signature_new",
          "args": [
            "&sig",
            "name",
            "email",
            "now",
            "(int)offset"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "64-96",
          "snippet": "int git_signature_new(git_signature **sig_out, const char *name, const char *email, git_time_t time, int offset)\n{\n\tgit_signature *p = NULL;\n\n\tassert(name && email);\n\n\t*sig_out = NULL;\n\n\tif (contains_angle_brackets(name) ||\n\t\tcontains_angle_brackets(email)) {\n\t\treturn signature_error(\n\t\t\t\"Neither `name` nor `email` should contain angle brackets chars.\");\n\t}\n\n\tp = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(p);\n\n\tp->name = extract_trimmed(name, strlen(name));\n\tGITERR_CHECK_ALLOC(p->name);\n\tp->email = extract_trimmed(email, strlen(email));\n\tGITERR_CHECK_ALLOC(p->email);\n\n\tif (p->name[0] == '\\0' || p->email[0] == '\\0') {\n\t\tgit_signature_free(p);\n\t\treturn signature_error(\"Signature cannot have an empty name or email\");\n\t}\n\n\tp->when.time = time;\n\tp->when.offset = offset;\n\n\t*sig_out = p;\n\treturn 0;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_new(git_signature **sig_out, const char *name, const char *email, git_time_t time, int offset)\n{\n\tgit_signature *p = NULL;\n\n\tassert(name && email);\n\n\t*sig_out = NULL;\n\n\tif (contains_angle_brackets(name) ||\n\t\tcontains_angle_brackets(email)) {\n\t\treturn signature_error(\n\t\t\t\"Neither `name` nor `email` should contain angle brackets chars.\");\n\t}\n\n\tp = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(p);\n\n\tp->name = extract_trimmed(name, strlen(name));\n\tGITERR_CHECK_ALLOC(p->name);\n\tp->email = extract_trimmed(email, strlen(email));\n\tGITERR_CHECK_ALLOC(p->email);\n\n\tif (p->name[0] == '\\0' || p->email[0] == '\\0') {\n\t\tgit_signature_free(p);\n\t\treturn signature_error(\"Signature cannot have an empty name or email\");\n\t}\n\n\tp->when.time = time;\n\tp->when.offset = offset;\n\n\t*sig_out = p;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "difftime",
          "args": [
            "now",
            "mktime(utc_tm)"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mktime",
          "args": [
            "utc_tm"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_gmtime_r",
          "args": [
            "&now",
            "&_utc"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "p_gmtime_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "674-685",
          "snippet": "struct tm *\np_gmtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = gmtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nstruct tm *\np_gmtime_r (const time_t *timer, struct tm *result)\n{\n\tstruct tm *local_result;\n\tlocal_result = gmtime (timer);\n\n\tif (local_result == NULL || result == NULL)\n\t\treturn NULL;\n\n\tmemcpy (result, local_result, sizeof (struct tm));\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&now"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "tm_to_time_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/date.c",
          "lines": "33-52",
          "snippet": "static git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}",
          "includes": [
            "#include <time.h>",
            "#include <ctype.h>",
            "#include \"posix.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include <sys/time.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <ctype.h>\n#include \"posix.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include <sys/time.h>\n#include \"common.h\"\n\nstatic git_time_t tm_to_time_t(const struct tm *tm)\n{\n\tstatic const int mdays[] = {\n\t    0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n\t};\n\tint year = tm->tm_year - 70;\n\tint month = tm->tm_mon;\n\tint day = tm->tm_mday;\n\n\tif (year < 0 || year > 129) /* algo only works for 1970-2099 */\n\t\treturn -1;\n\tif (month < 0 || month > 11) /* array bounds */\n\t\treturn -1;\n\tif (month < 2 || (year + 2) % 4)\n\t\tday--;\n\tif (tm->tm_hour < 0 || tm->tm_min < 0 || tm->tm_sec < 0)\n\t\treturn -1;\n\treturn (year * 365 + (year + 1) / 4 + mdays[month] + day) * 24*60*60UL +\n\t\ttm->tm_hour * 60*60 + tm->tm_min * 60 + tm->tm_sec;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_now(git_signature **sig_out, const char *name, const char *email)\n{\n\ttime_t now;\n\ttime_t offset;\n\tstruct tm *utc_tm;\n\tgit_signature *sig;\n\tstruct tm _utc;\n\n\t*sig_out = NULL;\n\n\t/*\n\t * Get the current time as seconds since the epoch and\n\t * transform that into a tm struct containing the time at\n\t * UTC. Give that to mktime which considers it a local time\n\t * (tm_isdst = -1 asks it to take DST into account) and gives\n\t * us that time as seconds since the epoch. The difference\n\t * between its return value and 'now' is our offset to UTC.\n\t */\n\ttime(&now);\n\tutc_tm = p_gmtime_r(&now, &_utc);\n\tutc_tm->tm_isdst = -1;\n\toffset = (time_t)difftime(now, mktime(utc_tm));\n\toffset /= 60;\n\n\tif (git_signature_new(&sig, name, email, now, (int)offset) < 0)\n\t\treturn -1;\n\n\t*sig_out = sig;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_signature__pdup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "122-144",
    "snippet": "int git_signature__pdup(git_signature **dest, const git_signature *source, git_pool *pool)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git_pool_mallocz(pool, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git_pool_strdup(pool, source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git_pool_strdup(pool, source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "signature->email"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pool_strdup",
          "args": [
            "pool",
            "source->email"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_strdup_safe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "213-216",
          "snippet": "char *git_pool_strdup_safe(git_pool *pool, const char *str)\n{\n\treturn str ? git_pool_strdup(pool, str) : NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nchar *git_pool_strdup_safe(git_pool *pool, const char *str)\n{\n\treturn str ? git_pool_strdup(pool, str) : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "signature->name"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "signature"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pool_mallocz",
          "args": [
            "pool",
            "sizeof(git_signature)"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_mallocz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "181-188",
          "snippet": "void *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nvoid *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature__pdup(git_signature **dest, const git_signature *source, git_pool *pool)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git_pool_mallocz(pool, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git_pool_strdup(pool, source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git_pool_strdup(pool, source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_signature_dup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "98-120",
    "snippet": "int git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "signature->email"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "source->email"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "signature->name"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "signature"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_signature)"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_dup(git_signature **dest, const git_signature *source)\n{\n\tgit_signature *signature;\n\n\tif (source == NULL)\n\t\treturn 0;\n\n\tsignature = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(signature);\n\n\tsignature->name = git__strdup(source->name);\n\tGITERR_CHECK_ALLOC(signature->name);\n\n\tsignature->email = git__strdup(source->email);\n\tGITERR_CHECK_ALLOC(signature->email);\n\n\tsignature->when.time = source->when.time;\n\tsignature->when.offset = source->when.offset;\n\n\t*dest = signature;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_signature_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "64-96",
    "snippet": "int git_signature_new(git_signature **sig_out, const char *name, const char *email, git_time_t time, int offset)\n{\n\tgit_signature *p = NULL;\n\n\tassert(name && email);\n\n\t*sig_out = NULL;\n\n\tif (contains_angle_brackets(name) ||\n\t\tcontains_angle_brackets(email)) {\n\t\treturn signature_error(\n\t\t\t\"Neither `name` nor `email` should contain angle brackets chars.\");\n\t}\n\n\tp = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(p);\n\n\tp->name = extract_trimmed(name, strlen(name));\n\tGITERR_CHECK_ALLOC(p->name);\n\tp->email = extract_trimmed(email, strlen(email));\n\tGITERR_CHECK_ALLOC(p->email);\n\n\tif (p->name[0] == '\\0' || p->email[0] == '\\0') {\n\t\tgit_signature_free(p);\n\t\treturn signature_error(\"Signature cannot have an empty name or email\");\n\t}\n\n\tp->when.time = time;\n\tp->when.offset = offset;\n\n\t*sig_out = p;\n\treturn 0;\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "signature_error",
          "args": [
            "\"Signature cannot have an empty name or email\""
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "signature_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "26-30",
          "snippet": "static int signature_error(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Failed to parse signature - %s\", msg);\n\treturn -1;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic int signature_error(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Failed to parse signature - %s\", msg);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_signature_free",
          "args": [
            "p"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "14-24",
          "snippet": "void git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nvoid git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "p->email"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "extract_trimmed",
          "args": [
            "email",
            "strlen(email)"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "extract_trimmed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "51-62",
          "snippet": "static char *extract_trimmed(const char *ptr, size_t len)\n{\n\twhile (len && is_crud((unsigned char)ptr[0])) {\n\t\tptr++; len--;\n\t}\n\n\twhile (len && is_crud((unsigned char)ptr[len - 1])) {\n\t\tlen--;\n\t}\n\n\treturn git__substrdup(ptr, len);\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic char *extract_trimmed(const char *ptr, size_t len)\n{\n\twhile (len && is_crud((unsigned char)ptr[0])) {\n\t\tptr++; len--;\n\t}\n\n\twhile (len && is_crud((unsigned char)ptr[len - 1])) {\n\t\tlen--;\n\t}\n\n\treturn git__substrdup(ptr, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "email"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "p->name"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "p"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_signature)"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "contains_angle_brackets",
          "args": [
            "email"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "contains_angle_brackets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "32-35",
          "snippet": "static bool contains_angle_brackets(const char *input)\n{\n\treturn strchr(input, '<') != NULL || strchr(input, '>') != NULL;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic bool contains_angle_brackets(const char *input)\n{\n\treturn strchr(input, '<') != NULL || strchr(input, '>') != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "name && email"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_new(git_signature **sig_out, const char *name, const char *email, git_time_t time, int offset)\n{\n\tgit_signature *p = NULL;\n\n\tassert(name && email);\n\n\t*sig_out = NULL;\n\n\tif (contains_angle_brackets(name) ||\n\t\tcontains_angle_brackets(email)) {\n\t\treturn signature_error(\n\t\t\t\"Neither `name` nor `email` should contain angle brackets chars.\");\n\t}\n\n\tp = git__calloc(1, sizeof(git_signature));\n\tGITERR_CHECK_ALLOC(p);\n\n\tp->name = extract_trimmed(name, strlen(name));\n\tGITERR_CHECK_ALLOC(p->name);\n\tp->email = extract_trimmed(email, strlen(email));\n\tGITERR_CHECK_ALLOC(p->email);\n\n\tif (p->name[0] == '\\0' || p->email[0] == '\\0') {\n\t\tgit_signature_free(p);\n\t\treturn signature_error(\"Signature cannot have an empty name or email\");\n\t}\n\n\tp->when.time = time;\n\tp->when.offset = offset;\n\n\t*sig_out = p;\n\treturn 0;\n}"
  },
  {
    "function_name": "extract_trimmed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "51-62",
    "snippet": "static char *extract_trimmed(const char *ptr, size_t len)\n{\n\twhile (len && is_crud((unsigned char)ptr[0])) {\n\t\tptr++; len--;\n\t}\n\n\twhile (len && is_crud((unsigned char)ptr[len - 1])) {\n\t\tlen--;\n\t}\n\n\treturn git__substrdup(ptr, len);\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__substrdup",
          "args": [
            "ptr",
            "len"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "git__substrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "201-213",
          "snippet": "GIT_INLINE(char *) git__substrdup(const char *start, size_t n)\n{\n\tchar *ptr;\n\tsize_t alloclen;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclen, n, 1) ||\n\t\t!(ptr = git__malloc(alloclen)))\n\t\treturn NULL;\n\n\tmemcpy(ptr, start, n);\n\tptr[n] = '\\0';\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__substrdup(const char *start, size_t n)\n{\n\tchar *ptr;\n\tsize_t alloclen;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclen, n, 1) ||\n\t\t!(ptr = git__malloc(alloclen)))\n\t\treturn NULL;\n\n\tmemcpy(ptr, start, n);\n\tptr[n] = '\\0';\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_crud",
          "args": [
            "(unsigned char)ptr[len - 1]"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "is_crud",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "37-49",
          "snippet": "static bool is_crud(unsigned char c)\n{\n\treturn  c <= 32  ||\n\t\tc == '.' ||\n\t\tc == ',' ||\n\t\tc == ':' ||\n\t\tc == ';' ||\n\t\tc == '<' ||\n\t\tc == '>' ||\n\t\tc == '\"' ||\n\t\tc == '\\\\' ||\n\t\tc == '\\'';\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic bool is_crud(unsigned char c)\n{\n\treturn  c <= 32  ||\n\t\tc == '.' ||\n\t\tc == ',' ||\n\t\tc == ':' ||\n\t\tc == ';' ||\n\t\tc == '<' ||\n\t\tc == '>' ||\n\t\tc == '\"' ||\n\t\tc == '\\\\' ||\n\t\tc == '\\'';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic char *extract_trimmed(const char *ptr, size_t len)\n{\n\twhile (len && is_crud((unsigned char)ptr[0])) {\n\t\tptr++; len--;\n\t}\n\n\twhile (len && is_crud((unsigned char)ptr[len - 1])) {\n\t\tlen--;\n\t}\n\n\treturn git__substrdup(ptr, len);\n}"
  },
  {
    "function_name": "is_crud",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "37-49",
    "snippet": "static bool is_crud(unsigned char c)\n{\n\treturn  c <= 32  ||\n\t\tc == '.' ||\n\t\tc == ',' ||\n\t\tc == ':' ||\n\t\tc == ';' ||\n\t\tc == '<' ||\n\t\tc == '>' ||\n\t\tc == '\"' ||\n\t\tc == '\\\\' ||\n\t\tc == '\\'';\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic bool is_crud(unsigned char c)\n{\n\treturn  c <= 32  ||\n\t\tc == '.' ||\n\t\tc == ',' ||\n\t\tc == ':' ||\n\t\tc == ';' ||\n\t\tc == '<' ||\n\t\tc == '>' ||\n\t\tc == '\"' ||\n\t\tc == '\\\\' ||\n\t\tc == '\\'';\n}"
  },
  {
    "function_name": "contains_angle_brackets",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "32-35",
    "snippet": "static bool contains_angle_brackets(const char *input)\n{\n\treturn strchr(input, '<') != NULL || strchr(input, '>') != NULL;\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "input",
            "'>'"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "input",
            "'<'"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic bool contains_angle_brackets(const char *input)\n{\n\treturn strchr(input, '<') != NULL || strchr(input, '>') != NULL;\n}"
  },
  {
    "function_name": "signature_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "26-30",
    "snippet": "static int signature_error(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Failed to parse signature - %s\", msg);\n\treturn -1;\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Failed to parse signature - %s\"",
            "msg"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nstatic int signature_error(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Failed to parse signature - %s\", msg);\n\treturn -1;\n}"
  },
  {
    "function_name": "git_signature_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
    "lines": "14-24",
    "snippet": "void git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}",
    "includes": [
      "#include \"posix.h\"",
      "#include \"git2/common.h\"",
      "#include \"repository.h\"",
      "#include \"signature.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "sig"
          ],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nvoid git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}"
  }
]