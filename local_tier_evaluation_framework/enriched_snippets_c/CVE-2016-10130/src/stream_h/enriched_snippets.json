[
  {
    "function_name": "git_stream_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
    "lines": "63-69",
    "snippet": "GIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}",
    "includes": [
      "#include \"git2/sys/stream.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "st->free",
          "args": [
            "st"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}"
  },
  {
    "function_name": "git_stream_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
    "lines": "58-61",
    "snippet": "GIT_INLINE(int) git_stream_close(git_stream *st)\n{\n\treturn st->close(st);\n}",
    "includes": [
      "#include \"git2/sys/stream.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "st->close",
          "args": [
            "st"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_close(git_stream *st)\n{\n\treturn st->close(st);\n}"
  },
  {
    "function_name": "git_stream_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
    "lines": "53-56",
    "snippet": "GIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}",
    "includes": [
      "#include \"git2/sys/stream.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "st->write",
          "args": [
            "st",
            "data",
            "len",
            "flags"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}"
  },
  {
    "function_name": "git_stream_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
    "lines": "48-51",
    "snippet": "GIT_INLINE(ssize_t) git_stream_read(git_stream *st, void *data, size_t len)\n{\n\treturn st->read(st, data, len);\n}",
    "includes": [
      "#include \"git2/sys/stream.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "st->read",
          "args": [
            "st",
            "data",
            "len"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(ssize_t) git_stream_read(git_stream *st, void *data, size_t len)\n{\n\treturn st->read(st, data, len);\n}"
  },
  {
    "function_name": "git_stream_set_proxy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
    "lines": "38-46",
    "snippet": "GIT_INLINE(int) git_stream_set_proxy(git_stream *st, const char *proxy_url)\n{\n\tif (!st->proxy_support) {\n\t\tgiterr_set(GITERR_INVALID, \"proxy not supported on this stream\");\n\t\treturn -1;\n\t}\n\n\treturn st->set_proxy(st, proxy_url);\n}",
    "includes": [
      "#include \"git2/sys/stream.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "st->set_proxy",
          "args": [
            "st",
            "proxy_url"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"proxy not supported on this stream\""
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_set_proxy(git_stream *st, const char *proxy_url)\n{\n\tif (!st->proxy_support) {\n\t\tgiterr_set(GITERR_INVALID, \"proxy not supported on this stream\");\n\t\treturn -1;\n\t}\n\n\treturn st->set_proxy(st, proxy_url);\n}"
  },
  {
    "function_name": "git_stream_supports_proxy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
    "lines": "33-36",
    "snippet": "GIT_INLINE(int) git_stream_supports_proxy(git_stream *st)\n{\n\treturn st->proxy_support;\n}",
    "includes": [
      "#include \"git2/sys/stream.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_supports_proxy(git_stream *st)\n{\n\treturn st->proxy_support;\n}"
  },
  {
    "function_name": "git_stream_certificate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
    "lines": "23-31",
    "snippet": "GIT_INLINE(int) git_stream_certificate(git_cert **out, git_stream *st)\n{\n\tif (!st->encrypted) {\n\t\tgiterr_set(GITERR_INVALID, \"an unencrypted stream does not have a certificate\");\n\t\treturn -1;\n\t}\n\n\treturn st->certificate(out, st);\n}",
    "includes": [
      "#include \"git2/sys/stream.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "st->certificate",
          "args": [
            "out",
            "st"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"an unencrypted stream does not have a certificate\""
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_certificate(git_cert **out, git_stream *st)\n{\n\tif (!st->encrypted) {\n\t\tgiterr_set(GITERR_INVALID, \"an unencrypted stream does not have a certificate\");\n\t\treturn -1;\n\t}\n\n\treturn st->certificate(out, st);\n}"
  },
  {
    "function_name": "git_stream_is_encrypted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
    "lines": "18-21",
    "snippet": "GIT_INLINE(int) git_stream_is_encrypted(git_stream *st)\n{\n\treturn st->encrypted;\n}",
    "includes": [
      "#include \"git2/sys/stream.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_is_encrypted(git_stream *st)\n{\n\treturn st->encrypted;\n}"
  },
  {
    "function_name": "git_stream_connect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
    "lines": "13-16",
    "snippet": "GIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}",
    "includes": [
      "#include \"git2/sys/stream.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "st->connect",
          "args": [
            "st"
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}"
  }
]