[
  {
    "function_name": "git_trace__null",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/trace.h",
    "lines": "49-55",
    "snippet": "GIT_INLINE(void) git_trace__null(\n\tgit_trace_level_t level,\n\tconst char *fmt, ...)\n{\n\tGIT_UNUSED(level);\n\tGIT_UNUSED(fmt);\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include <git2/trace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "fmt"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "level"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include <git2/trace.h>\n\nGIT_INLINE(void) git_trace__null(\n\tgit_trace_level_t level,\n\tconst char *fmt, ...)\n{\n\tGIT_UNUSED(level);\n\tGIT_UNUSED(fmt);\n}"
  },
  {
    "function_name": "git_trace__write_fmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/trace.h",
    "lines": "22-37",
    "snippet": "GIT_INLINE(void) git_trace__write_fmt(\n\tgit_trace_level_t level,\n\tconst char *fmt, ...)\n{\n\tgit_trace_callback callback = git_trace__data.callback;\n\tgit_buf message = GIT_BUF_INIT;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&message, fmt, ap);\n\tva_end(ap);\n\n\tcallback(level, git_buf_cstr(&message));\n\n\tgit_buf_free(&message);\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include <git2/trace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&message"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "callback",
          "args": [
            "level",
            "git_buf_cstr(&message)"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&message"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_vprintf",
          "args": [
            "&message",
            "fmt",
            "ap"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "366-404",
          "snippet": "int git_buf_vprintf(git_buf *buf, const char *format, va_list ap)\n{\n\tsize_t expected_size, new_size;\n\tint len;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&expected_size, strlen(format), 2);\n\tGITERR_CHECK_ALLOC_ADD(&expected_size, expected_size, buf->size);\n\tENSURE_SIZE(buf, expected_size);\n\n\twhile (1) {\n\t\tva_list args;\n\t\tva_copy(args, ap);\n\n\t\tlen = p_vsnprintf(\n\t\t\tbuf->ptr + buf->size,\n\t\t\tbuf->asize - buf->size,\n\t\t\tformat, args\n\t\t);\n\n\t\tva_end(args);\n\n\t\tif (len < 0) {\n\t\t\tgit__free(buf->ptr);\n\t\t\tbuf->ptr = git_buf__oom;\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((size_t)len + 1 <= buf->asize - buf->size) {\n\t\t\tbuf->size += len;\n\t\t\tbreak;\n\t\t}\n\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nint git_buf_vprintf(git_buf *buf, const char *format, va_list ap)\n{\n\tsize_t expected_size, new_size;\n\tint len;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&expected_size, strlen(format), 2);\n\tGITERR_CHECK_ALLOC_ADD(&expected_size, expected_size, buf->size);\n\tENSURE_SIZE(buf, expected_size);\n\n\twhile (1) {\n\t\tva_list args;\n\t\tva_copy(args, ap);\n\n\t\tlen = p_vsnprintf(\n\t\t\tbuf->ptr + buf->size,\n\t\t\tbuf->asize - buf->size,\n\t\t\tformat, args\n\t\t);\n\n\t\tva_end(args);\n\n\t\tif (len < 0) {\n\t\t\tgit__free(buf->ptr);\n\t\t\tbuf->ptr = git_buf__oom;\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((size_t)len + 1 <= buf->asize - buf->size) {\n\t\t\tbuf->size += len;\n\t\t\tbreak;\n\t\t}\n\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "fmt"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include <git2/trace.h>\n\nGIT_INLINE(void) git_trace__write_fmt(\n\tgit_trace_level_t level,\n\tconst char *fmt, ...)\n{\n\tgit_trace_callback callback = git_trace__data.callback;\n\tgit_buf message = GIT_BUF_INIT;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&message, fmt, ap);\n\tva_end(ap);\n\n\tcallback(level, git_buf_cstr(&message));\n\n\tgit_buf_free(&message);\n}"
  }
]