[
  {
    "function_name": "giterr_system_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "204-211",
    "snippet": "void giterr_system_set(int code)\n{\n#ifdef GIT_WIN32\n\tSetLastError(code);\n#else\n\terrno = code;\n#endif\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetLastError",
          "args": [
            "code"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_system_set(int code)\n{\n#ifdef GIT_WIN32\n\tSetLastError(code);\n#else\n\terrno = code;\n#endif\n}"
  },
  {
    "function_name": "giterr_system_last",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "195-202",
    "snippet": "int giterr_system_last(void)\n{\n#ifdef GIT_WIN32\n\treturn GetLastError();\n#else\n\treturn errno;\n#endif\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint giterr_system_last(void)\n{\n#ifdef GIT_WIN32\n\treturn GetLastError();\n#else\n\treturn errno;\n#endif\n}"
  },
  {
    "function_name": "giterr_state_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "184-193",
    "snippet": "void giterr_state_free(git_error_state *state)\n{\n\tif (!state)\n\t\treturn;\n\n\tif (!state->oom)\n\t\tgit__free(state->error_msg.message);\n\n\tmemset(state, 0, sizeof(git_error_state));\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "state",
            "0",
            "sizeof(git_error_state)"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "state->error_msg.message"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_state_free(git_error_state *state)\n{\n\tif (!state)\n\t\treturn;\n\n\tif (!state->oom)\n\t\tgit__free(state->error_msg.message);\n\n\tmemset(state, 0, sizeof(git_error_state));\n}"
  },
  {
    "function_name": "giterr_state_restore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "165-182",
    "snippet": "int giterr_state_restore(git_error_state *state)\n{\n\tint ret = 0;\n\n\tgiterr_clear();\n\n\tif (state && state->error_msg.message) {\n\t\tif (state->oom)\n\t\t\tgiterr_set_oom();\n\t\telse\n\t\t\tset_error(state->error_msg.klass, state->error_msg.message);\n\n\t\tret = state->error_code;\n\t\tmemset(state, 0, sizeof(git_error_state));\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "state",
            "0",
            "sizeof(git_error_state)"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_error",
          "args": [
            "state->error_msg.klass",
            "state->error_msg.message"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "32-43",
          "snippet": "static void set_error(int error_class, char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tgit_buf_puts(buf, string);\n\t\tgit__free(string);\n\t}\n\n\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void set_error(int error_class, char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tgit_buf_puts(buf, string);\n\t\tgit__free(string);\n\t}\n\n\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set_oom",
          "args": [],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "45-48",
          "snippet": "void giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};\n\nvoid giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint giterr_state_restore(git_error_state *state)\n{\n\tint ret = 0;\n\n\tgiterr_clear();\n\n\tif (state && state->error_msg.message) {\n\t\tif (state->oom)\n\t\t\tgiterr_set_oom();\n\t\telse\n\t\t\tset_error(state->error_msg.klass, state->error_msg.message);\n\n\t\tret = state->error_code;\n\t\tmemset(state, 0, sizeof(git_error_state));\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "giterr_state_capture",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "139-163",
    "snippet": "int giterr_state_capture(git_error_state *state, int error_code)\n{\n\tgit_error *error = GIT_GLOBAL->last_error;\n\tgit_buf *error_buf = &GIT_GLOBAL->error_buf;\n\n\tmemset(state, 0, sizeof(git_error_state));\n\n\tif (!error_code)\n\t\treturn 0;\n\n\tstate->error_code = error_code;\n\tstate->oom = (error == &g_git_oom_error);\n\n\tif (error) {\n\t\tstate->error_msg.klass = error->klass;\n\n\t\tif (state->oom)\n\t\t\tstate->error_msg.message = g_git_oom_error.message;\n\t\telse\n\t\t\tstate->error_msg.message = git_buf_detach(error_buf);\n\t}\n\n\tgiterr_clear();\n\treturn error_code;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "error_buf"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "state",
            "0",
            "sizeof(git_error_state)"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};\n\nint giterr_state_capture(git_error_state *state, int error_code)\n{\n\tgit_error *error = GIT_GLOBAL->last_error;\n\tgit_buf *error_buf = &GIT_GLOBAL->error_buf;\n\n\tmemset(state, 0, sizeof(git_error_state));\n\n\tif (!error_code)\n\t\treturn 0;\n\n\tstate->error_code = error_code;\n\tstate->oom = (error == &g_git_oom_error);\n\n\tif (error) {\n\t\tstate->error_msg.klass = error->klass;\n\n\t\tif (state->oom)\n\t\t\tstate->error_msg.message = g_git_oom_error.message;\n\t\telse\n\t\t\tstate->error_msg.message = git_buf_detach(error_buf);\n\t}\n\n\tgiterr_clear();\n\treturn error_code;\n}"
  },
  {
    "function_name": "giterr_last",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "134-137",
    "snippet": "const git_error *giterr_last(void)\n{\n\treturn GIT_GLOBAL->last_error;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nconst git_error *giterr_last(void)\n{\n\treturn GIT_GLOBAL->last_error;\n}"
  },
  {
    "function_name": "giterr_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "121-132",
    "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetLastError",
          "args": [
            "0"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_error",
          "args": [
            "0",
            "NULL"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "32-43",
          "snippet": "static void set_error(int error_class, char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tgit_buf_puts(buf, string);\n\t\tgit__free(string);\n\t}\n\n\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void set_error(int error_class, char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tgit_buf_puts(buf, string);\n\t\tgit__free(string);\n\t}\n\n\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
  },
  {
    "function_name": "giterr_set_regex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "106-119",
    "snippet": "int giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set_str",
          "args": [
            "GITERR_REGEX",
            "error_buf"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "91-104",
          "snippet": "void giterr_set_str(int error_class, const char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tassert(string);\n\n\tif (!string)\n\t\treturn;\n\n\tgit_buf_clear(buf);\n\tgit_buf_puts(buf, string);\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set_str(int error_class, const char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tassert(string);\n\n\tif (!string)\n\t\treturn;\n\n\tgit_buf_clear(buf);\n\tgit_buf_puts(buf, string);\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "regerror",
          "args": [
            "error_code",
            "regex",
            "error_buf",
            "sizeof(error_buf)"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "error_code"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint giterr_set_regex(const regex_t *regex, int error_code)\n{\n\tchar error_buf[1024];\n\n\tassert(error_code);\n\n\tregerror(error_code, regex, error_buf, sizeof(error_buf));\n\tgiterr_set_str(GITERR_REGEX, error_buf);\n\n\tif (error_code == REG_NOMATCH)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn GIT_EINVALIDSPEC;\n}"
  },
  {
    "function_name": "giterr_set_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "91-104",
    "snippet": "void giterr_set_str(int error_class, const char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tassert(string);\n\n\tif (!string)\n\t\treturn;\n\n\tgit_buf_clear(buf);\n\tgit_buf_puts(buf, string);\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_error_from_buffer",
          "args": [
            "error_class"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "set_error_from_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "21-30",
          "snippet": "static void set_error_from_buffer(int error_class)\n{\n\tgit_error *error = &GIT_GLOBAL->error_t;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\terror->message = buf->ptr;\n\terror->klass = error_class;\n\n\tGIT_GLOBAL->last_error = error;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void set_error_from_buffer(int error_class)\n{\n\tgit_error *error = &GIT_GLOBAL->error_t;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\terror->message = buf->ptr;\n\terror->klass = error_class;\n\n\tGIT_GLOBAL->last_error = error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "buf"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "buf",
            "string"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "buf"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "string"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set_str(int error_class, const char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tassert(string);\n\n\tif (!string)\n\t\treturn;\n\n\tgit_buf_clear(buf);\n\tgit_buf_puts(buf, string);\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
  },
  {
    "function_name": "giterr_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "50-89",
    "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_error_from_buffer",
          "args": [
            "error_class"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "set_error_from_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "21-30",
          "snippet": "static void set_error_from_buffer(int error_class)\n{\n\tgit_error *error = &GIT_GLOBAL->error_t;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\terror->message = buf->ptr;\n\terror->klass = error_class;\n\n\tGIT_GLOBAL->last_error = error;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void set_error_from_buffer(int error_class)\n{\n\tgit_error *error = &GIT_GLOBAL->error_t;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\terror->message = buf->ptr;\n\terror->klass = error_class;\n\n\tGIT_GLOBAL->last_error = error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "buf"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "buf",
            "strerror(error_code)"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "error_code"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "p_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "94-101",
          "snippet": "const char *p_gai_strerror(int ret)\n{\n\tswitch(ret) {\n\tcase -1: return \"Out of memory\"; break;\n\tcase -2: return \"Address lookup failed\"; break;\n\tdefault: return \"Unknown error\"; break;\n\t}\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nconst char *p_gai_strerror(int ret)\n{\n\tswitch(ret) {\n\tcase -1: return \"Out of memory\"; break;\n\tcase -2: return \"Address lookup failed\"; break;\n\tdefault: return \"Unknown error\"; break;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetLastError",
          "args": [
            "0"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "win32_error"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32_get_error_message",
          "args": [
            "win32_error_code"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32_get_error_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/error.c",
          "lines": "16-53",
          "snippet": "char *git_win32_get_error_message(DWORD error_code)\n{\n\tLPWSTR lpMsgBuf = NULL;\n\tHMODULE hModule = NULL;\n\tchar *utf8_msg = NULL;\n\tDWORD dwFlags =\n\t\tFORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_IGNORE_INSERTS;\n\n\tif (!error_code)\n\t\treturn NULL;\n\n#ifdef GIT_WINHTTP\n\t/* Errors raised by WinHTTP are not in the system resource table */\n\tif (error_code >= WINHTTP_ERROR_BASE &&\n\t\terror_code <= WINHTTP_ERROR_LAST)\n\t\thModule = GetModuleHandleW(L\"winhttp\");\n#endif\n\n\tGIT_UNUSED(hModule);\n\n\tif (hModule)\n\t\tdwFlags |= FORMAT_MESSAGE_FROM_HMODULE;\n\telse\n\t\tdwFlags |= FORMAT_MESSAGE_FROM_SYSTEM;\n\n\tif (FormatMessageW(dwFlags, hModule, error_code,\n\t\tMAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),\n\t\t(LPWSTR)&lpMsgBuf, 0, NULL)) {\n\t\t/* Convert the message to UTF-8. If this fails, we will\n\t\t * return NULL, which is a condition expected by the caller */\n\t\tif (git__utf16_to_8_alloc(&utf8_msg, lpMsgBuf) < 0)\n\t\t\tutf8_msg = NULL;\n\n\t\tLocalFree(lpMsgBuf);\n\t}\n\n\treturn utf8_msg;\n}",
          "includes": [
            "# include <winhttp.h>",
            "#include \"utf-conv.h\"",
            "#include \"error.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <winhttp.h>\n#include \"utf-conv.h\"\n#include \"error.h\"\n#include \"common.h\"\n\nchar *git_win32_get_error_message(DWORD error_code)\n{\n\tLPWSTR lpMsgBuf = NULL;\n\tHMODULE hModule = NULL;\n\tchar *utf8_msg = NULL;\n\tDWORD dwFlags =\n\t\tFORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_IGNORE_INSERTS;\n\n\tif (!error_code)\n\t\treturn NULL;\n\n#ifdef GIT_WINHTTP\n\t/* Errors raised by WinHTTP are not in the system resource table */\n\tif (error_code >= WINHTTP_ERROR_BASE &&\n\t\terror_code <= WINHTTP_ERROR_LAST)\n\t\thModule = GetModuleHandleW(L\"winhttp\");\n#endif\n\n\tGIT_UNUSED(hModule);\n\n\tif (hModule)\n\t\tdwFlags |= FORMAT_MESSAGE_FROM_HMODULE;\n\telse\n\t\tdwFlags |= FORMAT_MESSAGE_FROM_SYSTEM;\n\n\tif (FormatMessageW(dwFlags, hModule, error_code,\n\t\tMAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),\n\t\t(LPWSTR)&lpMsgBuf, 0, NULL)) {\n\t\t/* Convert the message to UTF-8. If this fails, we will\n\t\t * return NULL, which is a condition expected by the caller */\n\t\tif (git__utf16_to_8_alloc(&utf8_msg, lpMsgBuf) < 0)\n\t\t\tutf8_msg = NULL;\n\n\t\tLocalFree(lpMsgBuf);\n\t}\n\n\treturn utf8_msg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_PUTS",
          "args": [
            "buf",
            "\": \""
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arglist"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_vprintf",
          "args": [
            "buf",
            "string",
            "arglist"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "366-404",
          "snippet": "int git_buf_vprintf(git_buf *buf, const char *format, va_list ap)\n{\n\tsize_t expected_size, new_size;\n\tint len;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&expected_size, strlen(format), 2);\n\tGITERR_CHECK_ALLOC_ADD(&expected_size, expected_size, buf->size);\n\tENSURE_SIZE(buf, expected_size);\n\n\twhile (1) {\n\t\tva_list args;\n\t\tva_copy(args, ap);\n\n\t\tlen = p_vsnprintf(\n\t\t\tbuf->ptr + buf->size,\n\t\t\tbuf->asize - buf->size,\n\t\t\tformat, args\n\t\t);\n\n\t\tva_end(args);\n\n\t\tif (len < 0) {\n\t\t\tgit__free(buf->ptr);\n\t\t\tbuf->ptr = git_buf__oom;\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((size_t)len + 1 <= buf->asize - buf->size) {\n\t\t\tbuf->size += len;\n\t\t\tbreak;\n\t\t}\n\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nint git_buf_vprintf(git_buf *buf, const char *format, va_list ap)\n{\n\tsize_t expected_size, new_size;\n\tint len;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&expected_size, strlen(format), 2);\n\tGITERR_CHECK_ALLOC_ADD(&expected_size, expected_size, buf->size);\n\tENSURE_SIZE(buf, expected_size);\n\n\twhile (1) {\n\t\tva_list args;\n\t\tva_copy(args, ap);\n\n\t\tlen = p_vsnprintf(\n\t\t\tbuf->ptr + buf->size,\n\t\t\tbuf->asize - buf->size,\n\t\t\tformat, args\n\t\t);\n\n\t\tva_end(args);\n\n\t\tif (len < 0) {\n\t\t\tgit__free(buf->ptr);\n\t\t\tbuf->ptr = git_buf__oom;\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((size_t)len + 1 <= buf->asize - buf->size) {\n\t\t\tbuf->size += len;\n\t\t\tbreak;\n\t\t}\n\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arglist",
            "string"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "buf"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
  },
  {
    "function_name": "giterr_set_oom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "45-48",
    "snippet": "void giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_error g_git_oom_error = {\n\t\"Out of memory\",\n\tGITERR_NOMEMORY\n};\n\nvoid giterr_set_oom(void)\n{\n\tGIT_GLOBAL->last_error = &g_git_oom_error;\n}"
  },
  {
    "function_name": "set_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "32-43",
    "snippet": "static void set_error(int error_class, char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tgit_buf_puts(buf, string);\n\t\tgit__free(string);\n\t}\n\n\tset_error_from_buffer(error_class);\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_error_from_buffer",
          "args": [
            "error_class"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "set_error_from_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "21-30",
          "snippet": "static void set_error_from_buffer(int error_class)\n{\n\tgit_error *error = &GIT_GLOBAL->error_t;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\terror->message = buf->ptr;\n\terror->klass = error_class;\n\n\tGIT_GLOBAL->last_error = error;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void set_error_from_buffer(int error_class)\n{\n\tgit_error *error = &GIT_GLOBAL->error_t;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\terror->message = buf->ptr;\n\terror->klass = error_class;\n\n\tGIT_GLOBAL->last_error = error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "string"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "buf",
            "string"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "buf"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void set_error(int error_class, char *string)\n{\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tgit_buf_puts(buf, string);\n\t\tgit__free(string);\n\t}\n\n\tset_error_from_buffer(error_class);\n}"
  },
  {
    "function_name": "set_error_from_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
    "lines": "21-30",
    "snippet": "static void set_error_from_buffer(int error_class)\n{\n\tgit_error *error = &GIT_GLOBAL->error_t;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\terror->message = buf->ptr;\n\terror->klass = error_class;\n\n\tGIT_GLOBAL->last_error = error;\n}",
    "includes": [
      "#include \"buffer.h\"",
      "#include \"posix.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void set_error_from_buffer(int error_class)\n{\n\tgit_error *error = &GIT_GLOBAL->error_t;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\terror->message = buf->ptr;\n\terror->klass = error_class;\n\n\tGIT_GLOBAL->last_error = error;\n}"
  }
]