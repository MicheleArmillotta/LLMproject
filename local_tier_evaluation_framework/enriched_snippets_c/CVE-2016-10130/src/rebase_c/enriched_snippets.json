[
  {
    "function_name": "git_rebase_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1324-1337",
    "snippet": "void git_rebase_free(git_rebase *rebase)\n{\n\tif (rebase == NULL)\n\t\treturn;\n\n\tgit_index_free(rebase->index);\n\tgit_commit_free(rebase->last_commit);\n\tgit__free(rebase->onto_name);\n\tgit__free(rebase->orig_head_name);\n\tgit__free(rebase->state_path);\n\tgit_array_clear(rebase->operations);\n\tgit__free((char *)rebase->options.rewrite_notes_ref);\n\tgit__free(rebase);\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "rebase"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "rebase->operations"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "rebase->last_commit"
          ],
          "line": 1330
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_free",
          "args": [
            "rebase->index"
          ],
          "line": 1329
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "477-483",
          "snippet": "void git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nvoid git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nvoid git_rebase_free(git_rebase *rebase)\n{\n\tif (rebase == NULL)\n\t\treturn;\n\n\tgit_index_free(rebase->index);\n\tgit_commit_free(rebase->last_commit);\n\tgit__free(rebase->onto_name);\n\tgit__free(rebase->orig_head_name);\n\tgit__free(rebase->state_path);\n\tgit_array_clear(rebase->operations);\n\tgit__free((char *)rebase->options.rewrite_notes_ref);\n\tgit__free(rebase);\n}"
  },
  {
    "function_name": "git_rebase_operation_byindex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1317-1322",
    "snippet": "git_rebase_operation *git_rebase_operation_byindex(git_rebase *rebase, size_t idx)\n{\n\tassert(rebase);\n\n\treturn git_array_get(rebase->operations, idx);\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "rebase->operations",
            "idx"
          ],
          "line": 1321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "rebase"
          ],
          "line": 1319
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\ngit_rebase_operation *git_rebase_operation_byindex(git_rebase *rebase, size_t idx)\n{\n\tassert(rebase);\n\n\treturn git_array_get(rebase->operations, idx);\n}"
  },
  {
    "function_name": "git_rebase_operation_current",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1310-1315",
    "snippet": "size_t git_rebase_operation_current(git_rebase *rebase)\n{\n\tassert(rebase);\n\n\treturn rebase->started ? rebase->current : GIT_REBASE_NO_OPERATION;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "rebase"
          ],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nsize_t git_rebase_operation_current(git_rebase *rebase)\n{\n\tassert(rebase);\n\n\treturn rebase->started ? rebase->current : GIT_REBASE_NO_OPERATION;\n}"
  },
  {
    "function_name": "git_rebase_operation_entrycount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1303-1308",
    "snippet": "size_t git_rebase_operation_entrycount(git_rebase *rebase)\n{\n\tassert(rebase);\n\n\treturn git_array_size(rebase->operations);\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "rebase->operations"
          ],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "rebase"
          ],
          "line": 1305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nsize_t git_rebase_operation_entrycount(git_rebase *rebase)\n{\n\tassert(rebase);\n\n\treturn git_array_size(rebase->operations);\n}"
  },
  {
    "function_name": "git_rebase_finish",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1257-1301",
    "snippet": "int git_rebase_finish(\n\tgit_rebase *rebase,\n\tconst git_signature *signature)\n{\n\tgit_reference *terminal_ref = NULL, *branch_ref = NULL, *head_ref = NULL;\n\tgit_commit *terminal_commit = NULL;\n\tgit_buf branch_msg = GIT_BUF_INIT, head_msg = GIT_BUF_INIT;\n\tchar onto[GIT_OID_HEXSZ];\n\tint error;\n\n\tassert(rebase);\n\n\tif (rebase->inmemory)\n\t\treturn 0;\n\n\tgit_oid_fmt(onto, &rebase->onto_id);\n\n\tif ((error = git_buf_printf(&branch_msg, \"rebase finished: %s onto %.*s\",\n\t\t\trebase->orig_head_name, GIT_OID_HEXSZ, onto)) < 0 ||\n\t\t(error = git_buf_printf(&head_msg, \"rebase finished: returning to %s\",\n\t\t\trebase->orig_head_name)) < 0 ||\n\t\t(error = git_repository_head(&terminal_ref, rebase->repo)) < 0 ||\n\t\t(error = git_reference_peel((git_object **)&terminal_commit,\n\t\t\tterminal_ref, GIT_OBJ_COMMIT)) < 0 ||\n\t\t(error = git_reference_create_matching(&branch_ref,\n\t\t\trebase->repo, rebase->orig_head_name, git_commit_id(terminal_commit), 1,\n\t\t\t&rebase->orig_head_id, branch_msg.ptr)) < 0 ||\n\t\t(error = git_reference_symbolic_create(&head_ref,\n\t\t\trebase->repo, GIT_HEAD_FILE, rebase->orig_head_name, 1,\n\t\t\thead_msg.ptr)) < 0 ||\n\t\t(error = rebase_copy_notes(rebase, signature)) < 0)\n\t\tgoto done;\n\n\terror = rebase_cleanup(rebase);\n\ndone:\n\tgit_buf_free(&head_msg);\n\tgit_buf_free(&branch_msg);\n\tgit_commit_free(terminal_commit);\n\tgit_reference_free(head_ref);\n\tgit_reference_free(branch_ref);\n\tgit_reference_free(terminal_ref);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "terminal_ref"
          ],
          "line": 1298
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "terminal_commit"
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&branch_msg"
          ],
          "line": 1294
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_cleanup",
          "args": [
            "rebase"
          ],
          "line": 1290
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "402-410",
          "snippet": "static int rebase_cleanup(git_rebase *rebase)\n{\n\tif (!rebase || rebase->inmemory)\n\t\treturn 0;\n\n\treturn git_path_isdir(rebase->state_path) ?\n\t\tgit_futils_rmdir_r(rebase->state_path, NULL, GIT_RMDIR_REMOVE_FILES) :\n\t\t0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_cleanup(git_rebase *rebase)\n{\n\tif (!rebase || rebase->inmemory)\n\t\treturn 0;\n\n\treturn git_path_isdir(rebase->state_path) ?\n\t\tgit_futils_rmdir_r(rebase->state_path, NULL, GIT_RMDIR_REMOVE_FILES) :\n\t\t0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_copy_notes",
          "args": [
            "rebase",
            "signature"
          ],
          "line": 1287
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_copy_notes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "1191-1255",
          "snippet": "static int rebase_copy_notes(\n\tgit_rebase *rebase,\n\tconst git_signature *committer)\n{\n\tgit_buf path = GIT_BUF_INIT, rewritten = GIT_BUF_INIT, notes_ref = GIT_BUF_INIT;\n\tchar *pair_list, *fromstr, *tostr, *end;\n\tgit_oid from, to;\n\tunsigned int linenum = 1;\n\tint error = 0;\n\n\tif ((error = notes_ref_lookup(&notes_ref, rebase)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, REWRITTEN_FILE)) < 0 ||\n\t\t(error = git_futils_readbuffer(&rewritten, path.ptr)) < 0)\n\t\tgoto done;\n\n\tpair_list = rewritten.ptr;\n\n\twhile (*pair_list) {\n\t\tfromstr = pair_list;\n\n\t\tif ((end = strchr(fromstr, '\\n')) == NULL)\n\t\t\tgoto on_error;\n\n\t\tpair_list = end+1;\n\t\t*end = '\\0';\n\n\t\tif ((end = strchr(fromstr, ' ')) == NULL)\n\t\t\tgoto on_error;\n\n\t\ttostr = end+1;\n\t\t*end = '\\0';\n\n\t\tif (strlen(fromstr) != GIT_OID_HEXSZ ||\n\t\t\tstrlen(tostr) != GIT_OID_HEXSZ ||\n\t\t\tgit_oid_fromstr(&from, fromstr) < 0 ||\n\t\t\tgit_oid_fromstr(&to, tostr) < 0)\n\t\t\tgoto on_error;\n\n\t\tif ((error = rebase_copy_note(rebase, notes_ref.ptr, &from, &to, committer)) < 0)\n\t\t\tgoto done;\n\n\t\tlinenum++;\n\t}\n\n\tgoto done;\n\non_error:\n\tgiterr_set(GITERR_REBASE, \"Invalid rewritten file at line %d\", linenum);\n\terror = -1;\n\ndone:\n\tgit_buf_free(&rewritten);\n\tgit_buf_free(&path);\n\tgit_buf_free(&notes_ref);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define REWRITTEN_FILE      \"rewritten\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REWRITTEN_FILE      \"rewritten\"\n\nstatic int rebase_copy_notes(\n\tgit_rebase *rebase,\n\tconst git_signature *committer)\n{\n\tgit_buf path = GIT_BUF_INIT, rewritten = GIT_BUF_INIT, notes_ref = GIT_BUF_INIT;\n\tchar *pair_list, *fromstr, *tostr, *end;\n\tgit_oid from, to;\n\tunsigned int linenum = 1;\n\tint error = 0;\n\n\tif ((error = notes_ref_lookup(&notes_ref, rebase)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, REWRITTEN_FILE)) < 0 ||\n\t\t(error = git_futils_readbuffer(&rewritten, path.ptr)) < 0)\n\t\tgoto done;\n\n\tpair_list = rewritten.ptr;\n\n\twhile (*pair_list) {\n\t\tfromstr = pair_list;\n\n\t\tif ((end = strchr(fromstr, '\\n')) == NULL)\n\t\t\tgoto on_error;\n\n\t\tpair_list = end+1;\n\t\t*end = '\\0';\n\n\t\tif ((end = strchr(fromstr, ' ')) == NULL)\n\t\t\tgoto on_error;\n\n\t\ttostr = end+1;\n\t\t*end = '\\0';\n\n\t\tif (strlen(fromstr) != GIT_OID_HEXSZ ||\n\t\t\tstrlen(tostr) != GIT_OID_HEXSZ ||\n\t\t\tgit_oid_fromstr(&from, fromstr) < 0 ||\n\t\t\tgit_oid_fromstr(&to, tostr) < 0)\n\t\t\tgoto on_error;\n\n\t\tif ((error = rebase_copy_note(rebase, notes_ref.ptr, &from, &to, committer)) < 0)\n\t\t\tgoto done;\n\n\t\tlinenum++;\n\t}\n\n\tgoto done;\n\non_error:\n\tgiterr_set(GITERR_REBASE, \"Invalid rewritten file at line %d\", linenum);\n\terror = -1;\n\ndone:\n\tgit_buf_free(&rewritten);\n\tgit_buf_free(&path);\n\tgit_buf_free(&notes_ref);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_symbolic_create",
          "args": [
            "&head_ref",
            "rebase->repo",
            "GIT_HEAD_FILE",
            "rebase->orig_head_name",
            "1",
            "head_msg.ptr"
          ],
          "line": 1284
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_symbolic_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "499-508",
          "snippet": "int git_reference_symbolic_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst char *target,\n\tint force,\n\tconst char *log_message)\n{\n\treturn git_reference_symbolic_create_matching(ref_out, repo, name, target, force, NULL, log_message);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_symbolic_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst char *target,\n\tint force,\n\tconst char *log_message)\n{\n\treturn git_reference_symbolic_create_matching(ref_out, repo, name, target, force, NULL, log_message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_create_matching",
          "args": [
            "&branch_ref",
            "rebase->repo",
            "rebase->orig_head_name",
            "git_commit_id(terminal_commit)",
            "1",
            "&rebase->orig_head_id",
            "branch_msg.ptr"
          ],
          "line": 1281
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_create_matching",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "439-462",
          "snippet": "int git_reference_create_matching(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst git_oid *old_id,\n\tconst char *log_message)\n\n{\n\tint error;\n\tgit_signature *who = NULL;\n\t\n\tassert(id);\n\n\tif ((error = git_reference__log_signature(&who, repo)) < 0)\n\t\treturn error;\n\n\terror = reference__create(\n\t\tref_out, repo, name, id, NULL, force, who, log_message, old_id, NULL);\n\n\tgit_signature_free(who);\n\treturn error;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_create_matching(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst git_oid *old_id,\n\tconst char *log_message)\n\n{\n\tint error;\n\tgit_signature *who = NULL;\n\t\n\tassert(id);\n\n\tif ((error = git_reference__log_signature(&who, repo)) < 0)\n\t\treturn error;\n\n\terror = reference__create(\n\t\tref_out, repo, name, id, NULL, force, who, log_message, old_id, NULL);\n\n\tgit_signature_free(who);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_id",
          "args": [
            "terminal_commit"
          ],
          "line": 1282
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "35-38",
          "snippet": "const git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_peel",
          "args": [
            "(git_object **)&terminal_commit",
            "terminal_ref",
            "GIT_OBJ_COMMIT"
          ],
          "line": 1279
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "1224-1267",
          "snippet": "int git_reference_peel(\n\tgit_object **peeled,\n\tgit_reference *ref,\n\tgit_otype target_type)\n{\n\tgit_reference *resolved = NULL;\n\tgit_object *target = NULL;\n\tint error;\n\n\tassert(ref);\n\n\tif (ref->type == GIT_REF_OID) {\n\t\tresolved = ref;\n\t} else {\n\t\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\t\treturn peel_error(error, ref, \"Cannot resolve reference\");\n\t}\n\n\tif (!git_oid_iszero(&resolved->peel)) {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->peel, GIT_OBJ_ANY);\n\t} else {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->target.oid, GIT_OBJ_ANY);\n\t}\n\n\tif (error < 0) {\n\t\tpeel_error(error, ref, \"Cannot retrieve reference target\");\n\t\tgoto cleanup;\n\t}\n\n\tif (target_type == GIT_OBJ_ANY && git_object_type(target) != GIT_OBJ_TAG)\n\t\terror = git_object_dup(peeled, target);\n\telse\n\t\terror = git_object_peel(peeled, target, target_type);\n\ncleanup:\n\tgit_object_free(target);\n\n\tif (resolved != ref)\n\t\tgit_reference_free(resolved);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_peel(\n\tgit_object **peeled,\n\tgit_reference *ref,\n\tgit_otype target_type)\n{\n\tgit_reference *resolved = NULL;\n\tgit_object *target = NULL;\n\tint error;\n\n\tassert(ref);\n\n\tif (ref->type == GIT_REF_OID) {\n\t\tresolved = ref;\n\t} else {\n\t\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\t\treturn peel_error(error, ref, \"Cannot resolve reference\");\n\t}\n\n\tif (!git_oid_iszero(&resolved->peel)) {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->peel, GIT_OBJ_ANY);\n\t} else {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->target.oid, GIT_OBJ_ANY);\n\t}\n\n\tif (error < 0) {\n\t\tpeel_error(error, ref, \"Cannot retrieve reference target\");\n\t\tgoto cleanup;\n\t}\n\n\tif (target_type == GIT_OBJ_ANY && git_object_type(target) != GIT_OBJ_TAG)\n\t\terror = git_object_dup(peeled, target);\n\telse\n\t\terror = git_object_peel(peeled, target, target_type);\n\ncleanup:\n\tgit_object_free(target);\n\n\tif (resolved != ref)\n\t\tgit_reference_free(resolved);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_head",
          "args": [
            "&terminal_ref",
            "rebase->repo"
          ],
          "line": 1278
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_head_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1914-1931",
          "snippet": "int git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "&head_msg",
            "\"rebase finished: returning to %s\"",
            "rebase->orig_head_name"
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "onto",
            "&rebase->onto_id"
          ],
          "line": 1272
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "rebase"
          ],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nint git_rebase_finish(\n\tgit_rebase *rebase,\n\tconst git_signature *signature)\n{\n\tgit_reference *terminal_ref = NULL, *branch_ref = NULL, *head_ref = NULL;\n\tgit_commit *terminal_commit = NULL;\n\tgit_buf branch_msg = GIT_BUF_INIT, head_msg = GIT_BUF_INIT;\n\tchar onto[GIT_OID_HEXSZ];\n\tint error;\n\n\tassert(rebase);\n\n\tif (rebase->inmemory)\n\t\treturn 0;\n\n\tgit_oid_fmt(onto, &rebase->onto_id);\n\n\tif ((error = git_buf_printf(&branch_msg, \"rebase finished: %s onto %.*s\",\n\t\t\trebase->orig_head_name, GIT_OID_HEXSZ, onto)) < 0 ||\n\t\t(error = git_buf_printf(&head_msg, \"rebase finished: returning to %s\",\n\t\t\trebase->orig_head_name)) < 0 ||\n\t\t(error = git_repository_head(&terminal_ref, rebase->repo)) < 0 ||\n\t\t(error = git_reference_peel((git_object **)&terminal_commit,\n\t\t\tterminal_ref, GIT_OBJ_COMMIT)) < 0 ||\n\t\t(error = git_reference_create_matching(&branch_ref,\n\t\t\trebase->repo, rebase->orig_head_name, git_commit_id(terminal_commit), 1,\n\t\t\t&rebase->orig_head_id, branch_msg.ptr)) < 0 ||\n\t\t(error = git_reference_symbolic_create(&head_ref,\n\t\t\trebase->repo, GIT_HEAD_FILE, rebase->orig_head_name, 1,\n\t\t\thead_msg.ptr)) < 0 ||\n\t\t(error = rebase_copy_notes(rebase, signature)) < 0)\n\t\tgoto done;\n\n\terror = rebase_cleanup(rebase);\n\ndone:\n\tgit_buf_free(&head_msg);\n\tgit_buf_free(&branch_msg);\n\tgit_commit_free(terminal_commit);\n\tgit_reference_free(head_ref);\n\tgit_reference_free(branch_ref);\n\tgit_reference_free(terminal_ref);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_copy_notes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1191-1255",
    "snippet": "static int rebase_copy_notes(\n\tgit_rebase *rebase,\n\tconst git_signature *committer)\n{\n\tgit_buf path = GIT_BUF_INIT, rewritten = GIT_BUF_INIT, notes_ref = GIT_BUF_INIT;\n\tchar *pair_list, *fromstr, *tostr, *end;\n\tgit_oid from, to;\n\tunsigned int linenum = 1;\n\tint error = 0;\n\n\tif ((error = notes_ref_lookup(&notes_ref, rebase)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, REWRITTEN_FILE)) < 0 ||\n\t\t(error = git_futils_readbuffer(&rewritten, path.ptr)) < 0)\n\t\tgoto done;\n\n\tpair_list = rewritten.ptr;\n\n\twhile (*pair_list) {\n\t\tfromstr = pair_list;\n\n\t\tif ((end = strchr(fromstr, '\\n')) == NULL)\n\t\t\tgoto on_error;\n\n\t\tpair_list = end+1;\n\t\t*end = '\\0';\n\n\t\tif ((end = strchr(fromstr, ' ')) == NULL)\n\t\t\tgoto on_error;\n\n\t\ttostr = end+1;\n\t\t*end = '\\0';\n\n\t\tif (strlen(fromstr) != GIT_OID_HEXSZ ||\n\t\t\tstrlen(tostr) != GIT_OID_HEXSZ ||\n\t\t\tgit_oid_fromstr(&from, fromstr) < 0 ||\n\t\t\tgit_oid_fromstr(&to, tostr) < 0)\n\t\t\tgoto on_error;\n\n\t\tif ((error = rebase_copy_note(rebase, notes_ref.ptr, &from, &to, committer)) < 0)\n\t\t\tgoto done;\n\n\t\tlinenum++;\n\t}\n\n\tgoto done;\n\non_error:\n\tgiterr_set(GITERR_REBASE, \"Invalid rewritten file at line %d\", linenum);\n\terror = -1;\n\ndone:\n\tgit_buf_free(&rewritten);\n\tgit_buf_free(&path);\n\tgit_buf_free(&notes_ref);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define REWRITTEN_FILE      \"rewritten\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&notes_ref"
          ],
          "line": 1252
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REBASE",
            "\"Invalid rewritten file at line %d\"",
            "linenum"
          ],
          "line": 1246
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_copy_note",
          "args": [
            "rebase",
            "notes_ref.ptr",
            "&from",
            "&to",
            "committer"
          ],
          "line": 1237
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_copy_note",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "1148-1189",
          "snippet": "static int rebase_copy_note(\n\tgit_rebase *rebase,\n\tconst char *notes_ref,\n\tgit_oid *from,\n\tgit_oid *to,\n\tconst git_signature *committer)\n{\n\tgit_note *note = NULL;\n\tgit_oid note_id;\n\tgit_signature *who = NULL;\n\tint error;\n\n\tif ((error = git_note_read(&note, rebase->repo, notes_ref, from)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\n\t\tgoto done;\n\t}\n\n\tif (!committer) {\n\t\tif((error = git_signature_default(&who, rebase->repo)) < 0) {\n\t\t\tif (error != GIT_ENOTFOUND ||\n\t\t\t\t(error = git_signature_now(&who, \"unknown\", \"unknown\")) < 0)\n\t\t\t\tgoto done;\n\n\t\t\tgiterr_clear();\n\t\t}\n\n\t\tcommitter = who;\n\t}\n\n\terror = git_note_create(&note_id, rebase->repo, notes_ref,\n\t\tgit_note_author(note), committer, to, git_note_message(note), 0);\n\ndone:\n\tgit_note_free(note);\n\tgit_signature_free(who);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_copy_note(\n\tgit_rebase *rebase,\n\tconst char *notes_ref,\n\tgit_oid *from,\n\tgit_oid *to,\n\tconst git_signature *committer)\n{\n\tgit_note *note = NULL;\n\tgit_oid note_id;\n\tgit_signature *who = NULL;\n\tint error;\n\n\tif ((error = git_note_read(&note, rebase->repo, notes_ref, from)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\n\t\tgoto done;\n\t}\n\n\tif (!committer) {\n\t\tif((error = git_signature_default(&who, rebase->repo)) < 0) {\n\t\t\tif (error != GIT_ENOTFOUND ||\n\t\t\t\t(error = git_signature_now(&who, \"unknown\", \"unknown\")) < 0)\n\t\t\t\tgoto done;\n\n\t\t\tgiterr_clear();\n\t\t}\n\n\t\tcommitter = who;\n\t}\n\n\terror = git_note_create(&note_id, rebase->repo, notes_ref,\n\t\tgit_note_author(note), committer, to, git_note_message(note), 0);\n\ndone:\n\tgit_note_free(note);\n\tgit_signature_free(who);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fromstr",
          "args": [
            "&to",
            "tostr"
          ],
          "line": 1234
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "54-57",
          "snippet": "int git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tostr"
          ],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "fromstr"
          ],
          "line": 1231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "fromstr",
            "' '"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "fromstr",
            "'\\n'"
          ],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_futils_readbuffer",
          "args": [
            "&rewritten",
            "path.ptr"
          ],
          "line": 1211
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_readbuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "224-227",
          "snippet": "int git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "rebase->state_path",
            "REWRITTEN_FILE"
          ],
          "line": 1210
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "notes_ref_lookup",
          "args": [
            "&notes_ref",
            "rebase"
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "notes_ref_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "1117-1146",
          "snippet": "static int notes_ref_lookup(git_buf *out, git_rebase *rebase)\n{\n\tgit_config *config = NULL;\n\tint do_rewrite, error;\n\n\tif (rebase->options.rewrite_notes_ref) {\n\t\tgit_buf_attach_notowned(out,\n\t\t\trebase->options.rewrite_notes_ref,\n\t\t\tstrlen(rebase->options.rewrite_notes_ref));\n\t\treturn 0;\n\t}\n\n\tif ((error = git_repository_config(&config, rebase->repo)) < 0 ||\n\t\t(error = git_config_get_bool(&do_rewrite, config, \"notes.rewrite.rebase\")) < 0) {\n\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\n\t\tgiterr_clear();\n\t\tdo_rewrite = 1;\n\t}\n\n\terror = do_rewrite ?\n\t\tgit_config_get_string_buf(out, config, \"notes.rewriteref\") :\n\t\tGIT_ENOTFOUND;\n\ndone:\n\tgit_config_free(config);\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int notes_ref_lookup(git_buf *out, git_rebase *rebase)\n{\n\tgit_config *config = NULL;\n\tint do_rewrite, error;\n\n\tif (rebase->options.rewrite_notes_ref) {\n\t\tgit_buf_attach_notowned(out,\n\t\t\trebase->options.rewrite_notes_ref,\n\t\t\tstrlen(rebase->options.rewrite_notes_ref));\n\t\treturn 0;\n\t}\n\n\tif ((error = git_repository_config(&config, rebase->repo)) < 0 ||\n\t\t(error = git_config_get_bool(&do_rewrite, config, \"notes.rewrite.rebase\")) < 0) {\n\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\n\t\tgiterr_clear();\n\t\tdo_rewrite = 1;\n\t}\n\n\terror = do_rewrite ?\n\t\tgit_config_get_string_buf(out, config, \"notes.rewriteref\") :\n\t\tGIT_ENOTFOUND;\n\ndone:\n\tgit_config_free(config);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REWRITTEN_FILE      \"rewritten\"\n\nstatic int rebase_copy_notes(\n\tgit_rebase *rebase,\n\tconst git_signature *committer)\n{\n\tgit_buf path = GIT_BUF_INIT, rewritten = GIT_BUF_INIT, notes_ref = GIT_BUF_INIT;\n\tchar *pair_list, *fromstr, *tostr, *end;\n\tgit_oid from, to;\n\tunsigned int linenum = 1;\n\tint error = 0;\n\n\tif ((error = notes_ref_lookup(&notes_ref, rebase)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, REWRITTEN_FILE)) < 0 ||\n\t\t(error = git_futils_readbuffer(&rewritten, path.ptr)) < 0)\n\t\tgoto done;\n\n\tpair_list = rewritten.ptr;\n\n\twhile (*pair_list) {\n\t\tfromstr = pair_list;\n\n\t\tif ((end = strchr(fromstr, '\\n')) == NULL)\n\t\t\tgoto on_error;\n\n\t\tpair_list = end+1;\n\t\t*end = '\\0';\n\n\t\tif ((end = strchr(fromstr, ' ')) == NULL)\n\t\t\tgoto on_error;\n\n\t\ttostr = end+1;\n\t\t*end = '\\0';\n\n\t\tif (strlen(fromstr) != GIT_OID_HEXSZ ||\n\t\t\tstrlen(tostr) != GIT_OID_HEXSZ ||\n\t\t\tgit_oid_fromstr(&from, fromstr) < 0 ||\n\t\t\tgit_oid_fromstr(&to, tostr) < 0)\n\t\t\tgoto on_error;\n\n\t\tif ((error = rebase_copy_note(rebase, notes_ref.ptr, &from, &to, committer)) < 0)\n\t\t\tgoto done;\n\n\t\tlinenum++;\n\t}\n\n\tgoto done;\n\non_error:\n\tgiterr_set(GITERR_REBASE, \"Invalid rewritten file at line %d\", linenum);\n\terror = -1;\n\ndone:\n\tgit_buf_free(&rewritten);\n\tgit_buf_free(&path);\n\tgit_buf_free(&notes_ref);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_copy_note",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1148-1189",
    "snippet": "static int rebase_copy_note(\n\tgit_rebase *rebase,\n\tconst char *notes_ref,\n\tgit_oid *from,\n\tgit_oid *to,\n\tconst git_signature *committer)\n{\n\tgit_note *note = NULL;\n\tgit_oid note_id;\n\tgit_signature *who = NULL;\n\tint error;\n\n\tif ((error = git_note_read(&note, rebase->repo, notes_ref, from)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\n\t\tgoto done;\n\t}\n\n\tif (!committer) {\n\t\tif((error = git_signature_default(&who, rebase->repo)) < 0) {\n\t\t\tif (error != GIT_ENOTFOUND ||\n\t\t\t\t(error = git_signature_now(&who, \"unknown\", \"unknown\")) < 0)\n\t\t\t\tgoto done;\n\n\t\t\tgiterr_clear();\n\t\t}\n\n\t\tcommitter = who;\n\t}\n\n\terror = git_note_create(&note_id, rebase->repo, notes_ref,\n\t\tgit_note_author(note), committer, to, git_note_message(note), 0);\n\ndone:\n\tgit_note_free(note);\n\tgit_signature_free(who);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_signature_free",
          "args": [
            "who"
          ],
          "line": 1186
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "14-24",
          "snippet": "void git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nvoid git_signature_free(git_signature *sig)\n{\n\tif (sig == NULL)\n\t\treturn;\n\n\tgit__free(sig->name);\n\tsig->name = NULL;\n\tgit__free(sig->email);\n\tsig->email = NULL;\n\tgit__free(sig);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_note_free",
          "args": [
            "note"
          ],
          "line": 1185
        },
        "resolved": true,
        "details": {
          "function_name": "git_note_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "558-567",
          "snippet": "void git_note_free(git_note *note)\n{\n\tif (note == NULL)\n\t\treturn;\n\n\tgit_signature_free(note->committer);\n\tgit_signature_free(note->author);\n\tgit__free(note->message);\n\tgit__free(note);\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nvoid git_note_free(git_note *note)\n{\n\tif (note == NULL)\n\t\treturn;\n\n\tgit_signature_free(note->committer);\n\tgit_signature_free(note->author);\n\tgit__free(note->message);\n\tgit__free(note);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_note_create",
          "args": [
            "&note_id",
            "rebase->repo",
            "notes_ref",
            "git_note_author(note)",
            "committer",
            "to",
            "git_note_message(note)",
            "0"
          ],
          "line": 1181
        },
        "resolved": true,
        "details": {
          "function_name": "git_note_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "460-492",
          "snippet": "int git_note_create(\n\tgit_oid *out,\n\tgit_repository *repo,\n\tconst char *notes_ref_in,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst git_oid *oid,\n\tconst char *note,\n\tint allow_note_overwrite)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref = NULL;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\terror = retrieve_note_tree_and_commit(&tree, &commit, &notes_ref, repo, notes_ref_in);\n\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\terror = note_write(out, repo, author, committer, notes_ref,\n\t\t\tnote, tree, target, &commit, allow_note_overwrite);\n\ncleanup:\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_commit_free(commit);\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_create(\n\tgit_oid *out,\n\tgit_repository *repo,\n\tconst char *notes_ref_in,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst git_oid *oid,\n\tconst char *note,\n\tint allow_note_overwrite)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref = NULL;\n\tgit_commit *commit = NULL;\n\tgit_tree *tree = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\terror = retrieve_note_tree_and_commit(&tree, &commit, &notes_ref, repo, notes_ref_in);\n\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\terror = note_write(out, repo, author, committer, notes_ref,\n\t\t\tnote, tree, target, &commit, allow_note_overwrite);\n\ncleanup:\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_commit_free(commit);\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_note_message",
          "args": [
            "note"
          ],
          "line": 1182
        },
        "resolved": true,
        "details": {
          "function_name": "git_note_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "546-550",
          "snippet": "const char * git_note_message(const git_note *note)\n{\n\tassert(note);\n\treturn note->message;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nconst char * git_note_message(const git_note *note)\n{\n\tassert(note);\n\treturn note->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_note_author",
          "args": [
            "note"
          ],
          "line": 1182
        },
        "resolved": true,
        "details": {
          "function_name": "git_note_author",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "540-544",
          "snippet": "const git_signature *git_note_author(const git_note *note)\n{\n\tassert(note);\n\treturn note->author;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nconst git_signature *git_note_author(const git_note *note)\n{\n\tassert(note);\n\treturn note->author;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 1175
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_signature_now",
          "args": [
            "&who",
            "\"unknown\"",
            "\"unknown\""
          ],
          "line": 1172
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_now",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "146-176",
          "snippet": "int git_signature_now(git_signature **sig_out, const char *name, const char *email)\n{\n\ttime_t now;\n\ttime_t offset;\n\tstruct tm *utc_tm;\n\tgit_signature *sig;\n\tstruct tm _utc;\n\n\t*sig_out = NULL;\n\n\t/*\n\t * Get the current time as seconds since the epoch and\n\t * transform that into a tm struct containing the time at\n\t * UTC. Give that to mktime which considers it a local time\n\t * (tm_isdst = -1 asks it to take DST into account) and gives\n\t * us that time as seconds since the epoch. The difference\n\t * between its return value and 'now' is our offset to UTC.\n\t */\n\ttime(&now);\n\tutc_tm = p_gmtime_r(&now, &_utc);\n\tutc_tm->tm_isdst = -1;\n\toffset = (time_t)difftime(now, mktime(utc_tm));\n\toffset /= 60;\n\n\tif (git_signature_new(&sig, name, email, now, (int)offset) < 0)\n\t\treturn -1;\n\n\t*sig_out = sig;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_now(git_signature **sig_out, const char *name, const char *email)\n{\n\ttime_t now;\n\ttime_t offset;\n\tstruct tm *utc_tm;\n\tgit_signature *sig;\n\tstruct tm _utc;\n\n\t*sig_out = NULL;\n\n\t/*\n\t * Get the current time as seconds since the epoch and\n\t * transform that into a tm struct containing the time at\n\t * UTC. Give that to mktime which considers it a local time\n\t * (tm_isdst = -1 asks it to take DST into account) and gives\n\t * us that time as seconds since the epoch. The difference\n\t * between its return value and 'now' is our offset to UTC.\n\t */\n\ttime(&now);\n\tutc_tm = p_gmtime_r(&now, &_utc);\n\tutc_tm->tm_isdst = -1;\n\toffset = (time_t)difftime(now, mktime(utc_tm));\n\toffset /= 60;\n\n\tif (git_signature_new(&sig, name, email, now, (int)offset) < 0)\n\t\treturn -1;\n\n\t*sig_out = sig;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_signature_default",
          "args": [
            "&who",
            "rebase->repo"
          ],
          "line": 1170
        },
        "resolved": true,
        "details": {
          "function_name": "git_signature_default",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/signature.c",
          "lines": "178-193",
          "snippet": "int git_signature_default(git_signature **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *cfg;\n\tconst char *user_name, *user_email;\n\n\tif ((error = git_repository_config_snapshot(&cfg, repo)) < 0)\n\t\treturn error;\n\n\tif (!(error = git_config_get_string(&user_name, cfg, \"user.name\")) &&\n\t\t!(error = git_config_get_string(&user_email, cfg, \"user.email\")))\n\t\terror = git_signature_now(out, user_name, user_email);\n\n\tgit_config_free(cfg);\n\treturn error;\n}",
          "includes": [
            "#include \"posix.h\"",
            "#include \"git2/common.h\"",
            "#include \"repository.h\"",
            "#include \"signature.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix.h\"\n#include \"git2/common.h\"\n#include \"repository.h\"\n#include \"signature.h\"\n#include \"common.h\"\n\nint git_signature_default(git_signature **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *cfg;\n\tconst char *user_name, *user_email;\n\n\tif ((error = git_repository_config_snapshot(&cfg, repo)) < 0)\n\t\treturn error;\n\n\tif (!(error = git_config_get_string(&user_name, cfg, \"user.name\")) &&\n\t\t!(error = git_config_get_string(&user_email, cfg, \"user.email\")))\n\t\terror = git_signature_now(out, user_name, user_email);\n\n\tgit_config_free(cfg);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_note_read",
          "args": [
            "&note",
            "rebase->repo",
            "notes_ref",
            "from"
          ],
          "line": 1160
        },
        "resolved": true,
        "details": {
          "function_name": "git_note_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/notes.c",
          "lines": "438-458",
          "snippet": "int git_note_read(git_note **out, git_repository *repo,\n\t\t  const char *notes_ref_in, const git_oid *oid)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref = NULL;\n\tgit_tree *tree = NULL;\n\tgit_commit *commit = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\tif (!(error = retrieve_note_tree_and_commit(\n\t\t      &tree, &commit, &notes_ref, repo, notes_ref_in)))\n\t\terror = note_lookup(out, repo, commit, tree, target);\n\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_tree_free(tree);\n\tgit_commit_free(commit);\n\treturn error;\n}",
          "includes": [
            "#include \"signature.h\"",
            "#include \"iterator.h\"",
            "#include \"config.h\"",
            "#include \"refs.h\"",
            "#include \"git2.h\"",
            "#include \"notes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"signature.h\"\n#include \"iterator.h\"\n#include \"config.h\"\n#include \"refs.h\"\n#include \"git2.h\"\n#include \"notes.h\"\n\nint git_note_read(git_note **out, git_repository *repo,\n\t\t  const char *notes_ref_in, const git_oid *oid)\n{\n\tint error;\n\tchar *target = NULL, *notes_ref = NULL;\n\tgit_tree *tree = NULL;\n\tgit_commit *commit = NULL;\n\n\ttarget = git_oid_allocfmt(oid);\n\tGITERR_CHECK_ALLOC(target);\n\n\tif (!(error = retrieve_note_tree_and_commit(\n\t\t      &tree, &commit, &notes_ref, repo, notes_ref_in)))\n\t\terror = note_lookup(out, repo, commit, tree, target);\n\n\tgit__free(notes_ref);\n\tgit__free(target);\n\tgit_tree_free(tree);\n\tgit_commit_free(commit);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_copy_note(\n\tgit_rebase *rebase,\n\tconst char *notes_ref,\n\tgit_oid *from,\n\tgit_oid *to,\n\tconst git_signature *committer)\n{\n\tgit_note *note = NULL;\n\tgit_oid note_id;\n\tgit_signature *who = NULL;\n\tint error;\n\n\tif ((error = git_note_read(&note, rebase->repo, notes_ref, from)) < 0) {\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\n\t\tgoto done;\n\t}\n\n\tif (!committer) {\n\t\tif((error = git_signature_default(&who, rebase->repo)) < 0) {\n\t\t\tif (error != GIT_ENOTFOUND ||\n\t\t\t\t(error = git_signature_now(&who, \"unknown\", \"unknown\")) < 0)\n\t\t\t\tgoto done;\n\n\t\t\tgiterr_clear();\n\t\t}\n\n\t\tcommitter = who;\n\t}\n\n\terror = git_note_create(&note_id, rebase->repo, notes_ref,\n\t\tgit_note_author(note), committer, to, git_note_message(note), 0);\n\ndone:\n\tgit_note_free(note);\n\tgit_signature_free(who);\n\n\treturn error;\n}"
  },
  {
    "function_name": "notes_ref_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1117-1146",
    "snippet": "static int notes_ref_lookup(git_buf *out, git_rebase *rebase)\n{\n\tgit_config *config = NULL;\n\tint do_rewrite, error;\n\n\tif (rebase->options.rewrite_notes_ref) {\n\t\tgit_buf_attach_notowned(out,\n\t\t\trebase->options.rewrite_notes_ref,\n\t\t\tstrlen(rebase->options.rewrite_notes_ref));\n\t\treturn 0;\n\t}\n\n\tif ((error = git_repository_config(&config, rebase->repo)) < 0 ||\n\t\t(error = git_config_get_bool(&do_rewrite, config, \"notes.rewrite.rebase\")) < 0) {\n\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\n\t\tgiterr_clear();\n\t\tdo_rewrite = 1;\n\t}\n\n\terror = do_rewrite ?\n\t\tgit_config_get_string_buf(out, config, \"notes.rewriteref\") :\n\t\tGIT_ENOTFOUND;\n\ndone:\n\tgit_config_free(config);\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "config"
          ],
          "line": 1144
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_get_string_buf",
          "args": [
            "out",
            "config",
            "\"notes.rewriteref\""
          ],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_get_string_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "857-875",
          "snippet": "int git_config_get_string_buf(\n\tgit_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\tconst char *str;\n\n\tgit_buf_sanitize(out);\n\n\tret  = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS);\n\tstr = !ret ? (entry->value ? entry->value : \"\") : NULL;\n\n\tif (str)\n\t\tret = git_buf_puts(out, str);\n\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_string_buf(\n\tgit_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\tconst char *str;\n\n\tgit_buf_sanitize(out);\n\n\tret  = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS);\n\tstr = !ret ? (entry->value ? entry->value : \"\") : NULL;\n\n\tif (str)\n\t\tret = git_buf_puts(out, str);\n\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 1135
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_get_bool",
          "args": [
            "&do_rewrite",
            "config",
            "\"notes.rewrite.rebase\""
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_get_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "794-806",
          "snippet": "int git_config_get_bool(int *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_bool(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_bool(int *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_bool(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config",
          "args": [
            "&config",
            "rebase->repo"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config_snapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "716-725",
          "snippet": "int git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_attach_notowned",
          "args": [
            "out",
            "rebase->options.rewrite_notes_ref",
            "strlen(rebase->options.rewrite_notes_ref)"
          ],
          "line": 1123
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_attach_notowned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "505-517",
          "snippet": "void git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "rebase->options.rewrite_notes_ref"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int notes_ref_lookup(git_buf *out, git_rebase *rebase)\n{\n\tgit_config *config = NULL;\n\tint do_rewrite, error;\n\n\tif (rebase->options.rewrite_notes_ref) {\n\t\tgit_buf_attach_notowned(out,\n\t\t\trebase->options.rewrite_notes_ref,\n\t\t\tstrlen(rebase->options.rewrite_notes_ref));\n\t\treturn 0;\n\t}\n\n\tif ((error = git_repository_config(&config, rebase->repo)) < 0 ||\n\t\t(error = git_config_get_bool(&do_rewrite, config, \"notes.rewrite.rebase\")) < 0) {\n\n\t\tif (error != GIT_ENOTFOUND)\n\t\t\tgoto done;\n\n\t\tgiterr_clear();\n\t\tdo_rewrite = 1;\n\t}\n\n\terror = do_rewrite ?\n\t\tgit_config_get_string_buf(out, config, \"notes.rewriteref\") :\n\t\tGIT_ENOTFOUND;\n\ndone:\n\tgit_config_free(config);\n\treturn error;\n}"
  },
  {
    "function_name": "git_rebase_abort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1081-1115",
    "snippet": "int git_rebase_abort(git_rebase *rebase)\n{\n\tgit_reference *orig_head_ref = NULL;\n\tgit_commit *orig_head_commit = NULL;\n\tint error;\n\n\tassert(rebase);\n\n\tif (rebase->inmemory)\n\t\treturn 0;\n\n\terror = rebase->head_detached ?\n\t\tgit_reference_create(&orig_head_ref, rebase->repo, GIT_HEAD_FILE,\n\t\t\t &rebase->orig_head_id, 1, \"rebase: aborting\") :\n\t\tgit_reference_symbolic_create(\n\t\t\t&orig_head_ref, rebase->repo, GIT_HEAD_FILE, rebase->orig_head_name, 1,\n\t\t\t\"rebase: aborting\");\n\n\tif (error < 0)\n\t\tgoto done;\n\n\tif ((error = git_commit_lookup(\n\t\t\t&orig_head_commit, rebase->repo, &rebase->orig_head_id)) < 0 ||\n\t\t(error = git_reset(rebase->repo, (git_object *)orig_head_commit,\n\t\t\tGIT_RESET_HARD, &rebase->options.checkout_options)) < 0)\n\t\tgoto done;\n\n\terror = rebase_cleanup(rebase);\n\ndone:\n\tgit_commit_free(orig_head_commit);\n\tgit_reference_free(orig_head_ref);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "orig_head_ref"
          ],
          "line": 1112
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "orig_head_commit"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_cleanup",
          "args": [
            "rebase"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "402-410",
          "snippet": "static int rebase_cleanup(git_rebase *rebase)\n{\n\tif (!rebase || rebase->inmemory)\n\t\treturn 0;\n\n\treturn git_path_isdir(rebase->state_path) ?\n\t\tgit_futils_rmdir_r(rebase->state_path, NULL, GIT_RMDIR_REMOVE_FILES) :\n\t\t0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_cleanup(git_rebase *rebase)\n{\n\tif (!rebase || rebase->inmemory)\n\t\treturn 0;\n\n\treturn git_path_isdir(rebase->state_path) ?\n\t\tgit_futils_rmdir_r(rebase->state_path, NULL, GIT_RMDIR_REMOVE_FILES) :\n\t\t0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reset",
          "args": [
            "rebase->repo",
            "(git_object *)orig_head_commit",
            "GIT_RESET_HARD",
            "&rebase->options.checkout_options"
          ],
          "line": 1104
        },
        "resolved": true,
        "details": {
          "function_name": "git_reset_from_annotated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/reset.c",
          "lines": "192-199",
          "snippet": "int git_reset_from_annotated(\n\tgit_repository *repo,\n\tgit_annotated_commit *commit,\n\tgit_reset_t reset_type,\n\tconst git_checkout_options *checkout_opts)\n{\n\treturn reset(repo, (git_object *) commit->commit, commit->ref_name, reset_type, checkout_opts);\n}",
          "includes": [
            "#include \"git2/refs.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/checkout.h\"",
            "#include \"git2/reset.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff.h\"",
            "#include \"merge.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/refs.h\"\n#include \"git2/merge.h\"\n#include \"git2/checkout.h\"\n#include \"git2/reset.h\"\n#include \"annotated_commit.h\"\n#include \"diff.h\"\n#include \"merge.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_reset_from_annotated(\n\tgit_repository *repo,\n\tgit_annotated_commit *commit,\n\tgit_reset_t reset_type,\n\tconst git_checkout_options *checkout_opts)\n{\n\treturn reset(repo, (git_object *) commit->commit, commit->ref_name, reset_type, checkout_opts);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "&orig_head_commit",
            "rebase->repo",
            "&rebase->orig_head_id"
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_symbolic_create",
          "args": [
            "&orig_head_ref",
            "rebase->repo",
            "GIT_HEAD_FILE",
            "rebase->orig_head_name",
            "1",
            "\"rebase: aborting\""
          ],
          "line": 1095
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_symbolic_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "499-508",
          "snippet": "int git_reference_symbolic_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst char *target,\n\tint force,\n\tconst char *log_message)\n{\n\treturn git_reference_symbolic_create_matching(ref_out, repo, name, target, force, NULL, log_message);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_symbolic_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst char *target,\n\tint force,\n\tconst char *log_message)\n{\n\treturn git_reference_symbolic_create_matching(ref_out, repo, name, target, force, NULL, log_message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_create",
          "args": [
            "&orig_head_ref",
            "rebase->repo",
            "GIT_HEAD_FILE",
            "&rebase->orig_head_id",
            "1",
            "\"rebase: aborting\""
          ],
          "line": 1093
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "464-473",
          "snippet": "int git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "rebase"
          ],
          "line": 1087
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nint git_rebase_abort(git_rebase *rebase)\n{\n\tgit_reference *orig_head_ref = NULL;\n\tgit_commit *orig_head_commit = NULL;\n\tint error;\n\n\tassert(rebase);\n\n\tif (rebase->inmemory)\n\t\treturn 0;\n\n\terror = rebase->head_detached ?\n\t\tgit_reference_create(&orig_head_ref, rebase->repo, GIT_HEAD_FILE,\n\t\t\t &rebase->orig_head_id, 1, \"rebase: aborting\") :\n\t\tgit_reference_symbolic_create(\n\t\t\t&orig_head_ref, rebase->repo, GIT_HEAD_FILE, rebase->orig_head_name, 1,\n\t\t\t\"rebase: aborting\");\n\n\tif (error < 0)\n\t\tgoto done;\n\n\tif ((error = git_commit_lookup(\n\t\t\t&orig_head_commit, rebase->repo, &rebase->orig_head_id)) < 0 ||\n\t\t(error = git_reset(rebase->repo, (git_object *)orig_head_commit,\n\t\t\tGIT_RESET_HARD, &rebase->options.checkout_options)) < 0)\n\t\tgoto done;\n\n\terror = rebase_cleanup(rebase);\n\ndone:\n\tgit_commit_free(orig_head_commit);\n\tgit_reference_free(orig_head_ref);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_rebase_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1057-1079",
    "snippet": "int git_rebase_commit(\n\tgit_oid *id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tint error;\n\n\tassert(rebase && committer);\n\n\tif (rebase->inmemory)\n\t\terror = rebase_commit_inmemory(\n\t\t\tid, rebase, author, committer, message_encoding, message);\n\telse if (rebase->type == GIT_REBASE_TYPE_MERGE)\n\t\terror = rebase_commit_merge(\n\t\t\tid, rebase, author, committer, message_encoding, message);\n\telse\n\t\tabort();\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rebase_commit_merge",
          "args": [
            "id",
            "rebase",
            "author",
            "committer",
            "message_encoding",
            "message"
          ],
          "line": 1073
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_commit_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "978-1021",
          "snippet": "static int rebase_commit_merge(\n\tgit_oid *commit_id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_reference *head = NULL;\n\tgit_commit *head_commit = NULL, *commit = NULL;\n\tgit_index *index = NULL;\n\tchar old_idstr[GIT_OID_HEXSZ], new_idstr[GIT_OID_HEXSZ];\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\tassert(operation);\n\n\tif ((error = rebase_ensure_not_dirty(rebase->repo, false, true, GIT_EUNMERGED)) < 0 ||\n\t\t(error = git_repository_head(&head, rebase->repo)) < 0 ||\n\t\t(error = git_reference_peel((git_object **)&head_commit, head, GIT_OBJ_COMMIT)) < 0 ||\n\t\t(error = git_repository_index(&index, rebase->repo)) < 0 ||\n\t\t(error = rebase_commit__create(&commit, rebase, index, head_commit,\n\t\t\tauthor, committer, message_encoding, message)) < 0 ||\n\t\t(error = git_reference__update_for_commit(\n\t\t\trebase->repo, NULL, \"HEAD\", git_commit_id(commit), \"rebase\")) < 0)\n\t\tgoto done;\n\n\tgit_oid_fmt(old_idstr, &operation->id);\n\tgit_oid_fmt(new_idstr, git_commit_id(commit));\n\n\tif ((error = rebase_setupfile(rebase, REWRITTEN_FILE, O_CREAT|O_WRONLY|O_APPEND,\n\t\t\"%.*s %.*s\\n\", GIT_OID_HEXSZ, old_idstr, GIT_OID_HEXSZ, new_idstr)) < 0)\n\t\tgoto done;\n\n\tgit_oid_cpy(commit_id, git_commit_id(commit));\n\ndone:\n\tgit_index_free(index);\n\tgit_reference_free(head);\n\tgit_commit_free(head_commit);\n\tgit_commit_free(commit);\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define REWRITTEN_FILE      \"rewritten\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REWRITTEN_FILE      \"rewritten\"\n\nstatic int rebase_commit_merge(\n\tgit_oid *commit_id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_reference *head = NULL;\n\tgit_commit *head_commit = NULL, *commit = NULL;\n\tgit_index *index = NULL;\n\tchar old_idstr[GIT_OID_HEXSZ], new_idstr[GIT_OID_HEXSZ];\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\tassert(operation);\n\n\tif ((error = rebase_ensure_not_dirty(rebase->repo, false, true, GIT_EUNMERGED)) < 0 ||\n\t\t(error = git_repository_head(&head, rebase->repo)) < 0 ||\n\t\t(error = git_reference_peel((git_object **)&head_commit, head, GIT_OBJ_COMMIT)) < 0 ||\n\t\t(error = git_repository_index(&index, rebase->repo)) < 0 ||\n\t\t(error = rebase_commit__create(&commit, rebase, index, head_commit,\n\t\t\tauthor, committer, message_encoding, message)) < 0 ||\n\t\t(error = git_reference__update_for_commit(\n\t\t\trebase->repo, NULL, \"HEAD\", git_commit_id(commit), \"rebase\")) < 0)\n\t\tgoto done;\n\n\tgit_oid_fmt(old_idstr, &operation->id);\n\tgit_oid_fmt(new_idstr, git_commit_id(commit));\n\n\tif ((error = rebase_setupfile(rebase, REWRITTEN_FILE, O_CREAT|O_WRONLY|O_APPEND,\n\t\t\"%.*s %.*s\\n\", GIT_OID_HEXSZ, old_idstr, GIT_OID_HEXSZ, new_idstr)) < 0)\n\t\tgoto done;\n\n\tgit_oid_cpy(commit_id, git_commit_id(commit));\n\ndone:\n\tgit_index_free(index);\n\tgit_reference_free(head);\n\tgit_commit_free(head_commit);\n\tgit_commit_free(commit);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_commit_inmemory",
          "args": [
            "id",
            "rebase",
            "author",
            "committer",
            "message_encoding",
            "message"
          ],
          "line": 1070
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_commit_inmemory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "1023-1055",
          "snippet": "static int rebase_commit_inmemory(\n\tgit_oid *commit_id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tassert(operation);\n\tassert(rebase->index);\n\tassert(rebase->last_commit);\n\n\tif ((error = rebase_commit__create(&commit, rebase, rebase->index,\n\t\trebase->last_commit, author, committer, message_encoding, message)) < 0)\n\t\tgoto done;\n\n\tgit_commit_free(rebase->last_commit);\n\trebase->last_commit = commit;\n\n\tgit_oid_cpy(commit_id, git_commit_id(commit));\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_commit_inmemory(\n\tgit_oid *commit_id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tassert(operation);\n\tassert(rebase->index);\n\tassert(rebase->last_commit);\n\n\tif ((error = rebase_commit__create(&commit, rebase, rebase->index,\n\t\trebase->last_commit, author, committer, message_encoding, message)) < 0)\n\t\tgoto done;\n\n\tgit_commit_free(rebase->last_commit);\n\trebase->last_commit = commit;\n\n\tgit_oid_cpy(commit_id, git_commit_id(commit));\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "rebase && committer"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nint git_rebase_commit(\n\tgit_oid *id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tint error;\n\n\tassert(rebase && committer);\n\n\tif (rebase->inmemory)\n\t\terror = rebase_commit_inmemory(\n\t\t\tid, rebase, author, committer, message_encoding, message);\n\telse if (rebase->type == GIT_REBASE_TYPE_MERGE)\n\t\terror = rebase_commit_merge(\n\t\t\tid, rebase, author, committer, message_encoding, message);\n\telse\n\t\tabort();\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_commit_inmemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "1023-1055",
    "snippet": "static int rebase_commit_inmemory(\n\tgit_oid *commit_id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tassert(operation);\n\tassert(rebase->index);\n\tassert(rebase->last_commit);\n\n\tif ((error = rebase_commit__create(&commit, rebase, rebase->index,\n\t\trebase->last_commit, author, committer, message_encoding, message)) < 0)\n\t\tgoto done;\n\n\tgit_commit_free(rebase->last_commit);\n\trebase->last_commit = commit;\n\n\tgit_oid_cpy(commit_id, git_commit_id(commit));\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "commit"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "commit_id",
            "git_commit_id(commit)"
          ],
          "line": 1048
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_id",
          "args": [
            "commit"
          ],
          "line": 1048
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "35-38",
          "snippet": "const git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_commit__create",
          "args": [
            "&commit",
            "rebase",
            "rebase->index",
            "rebase->last_commit",
            "author",
            "committer",
            "message_encoding",
            "message"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_commit__create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "915-976",
          "snippet": "static int rebase_commit__create(\n\tgit_commit **out,\n\tgit_rebase *rebase,\n\tgit_index *index,\n\tgit_commit *parent_commit,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *current_commit = NULL, *commit = NULL;\n\tgit_tree *parent_tree = NULL, *tree = NULL;\n\tgit_oid tree_id, commit_id;\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif (git_index_has_conflicts(index)) {\n\t\tgiterr_set(GITERR_REBASE, \"conflicts have not been resolved\");\n\t\terror = GIT_EUNMERGED;\n\t\tgoto done;\n\t}\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_index_write_tree_to(&tree_id, index, rebase->repo)) < 0 ||\n\t\t(error = git_tree_lookup(&tree, rebase->repo, &tree_id)) < 0)\n\t\tgoto done;\n\n\tif (git_oid_equal(&tree_id, git_tree_id(parent_tree))) {\n\t\tgiterr_set(GITERR_REBASE, \"this patch has already been applied\");\n\t\terror = GIT_EAPPLIED;\n\t\tgoto done;\n\t}\n\n\tif (!author)\n\t\tauthor = git_commit_author(current_commit);\n\n\tif (!message) {\n\t\tmessage_encoding = git_commit_message_encoding(current_commit);\n\t\tmessage = git_commit_message(current_commit);\n\t}\n\n\tif ((error = git_commit_create(&commit_id, rebase->repo, NULL, author,\n\t\tcommitter, message_encoding, message, tree, 1,\n\t\t(const git_commit **)&parent_commit)) < 0 ||\n\t\t(error = git_commit_lookup(&commit, rebase->repo, &commit_id)) < 0)\n\t\tgoto done;\n\n\t*out = commit;\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\tgit_commit_free(current_commit);\n\tgit_tree_free(parent_tree);\n\tgit_tree_free(tree);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_commit__create(\n\tgit_commit **out,\n\tgit_rebase *rebase,\n\tgit_index *index,\n\tgit_commit *parent_commit,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *current_commit = NULL, *commit = NULL;\n\tgit_tree *parent_tree = NULL, *tree = NULL;\n\tgit_oid tree_id, commit_id;\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif (git_index_has_conflicts(index)) {\n\t\tgiterr_set(GITERR_REBASE, \"conflicts have not been resolved\");\n\t\terror = GIT_EUNMERGED;\n\t\tgoto done;\n\t}\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_index_write_tree_to(&tree_id, index, rebase->repo)) < 0 ||\n\t\t(error = git_tree_lookup(&tree, rebase->repo, &tree_id)) < 0)\n\t\tgoto done;\n\n\tif (git_oid_equal(&tree_id, git_tree_id(parent_tree))) {\n\t\tgiterr_set(GITERR_REBASE, \"this patch has already been applied\");\n\t\terror = GIT_EAPPLIED;\n\t\tgoto done;\n\t}\n\n\tif (!author)\n\t\tauthor = git_commit_author(current_commit);\n\n\tif (!message) {\n\t\tmessage_encoding = git_commit_message_encoding(current_commit);\n\t\tmessage = git_commit_message(current_commit);\n\t}\n\n\tif ((error = git_commit_create(&commit_id, rebase->repo, NULL, author,\n\t\tcommitter, message_encoding, message, tree, 1,\n\t\t(const git_commit **)&parent_commit)) < 0 ||\n\t\t(error = git_commit_lookup(&commit, rebase->repo, &commit_id)) < 0)\n\t\tgoto done;\n\n\t*out = commit;\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\tgit_commit_free(current_commit);\n\tgit_tree_free(parent_tree);\n\tgit_tree_free(tree);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "rebase->last_commit"
          ],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "rebase->index"
          ],
          "line": 1038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "operation"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "rebase->operations",
            "rebase->current"
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_commit_inmemory(\n\tgit_oid *commit_id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tassert(operation);\n\tassert(rebase->index);\n\tassert(rebase->last_commit);\n\n\tif ((error = rebase_commit__create(&commit, rebase, rebase->index,\n\t\trebase->last_commit, author, committer, message_encoding, message)) < 0)\n\t\tgoto done;\n\n\tgit_commit_free(rebase->last_commit);\n\trebase->last_commit = commit;\n\n\tgit_oid_cpy(commit_id, git_commit_id(commit));\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_commit_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "978-1021",
    "snippet": "static int rebase_commit_merge(\n\tgit_oid *commit_id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_reference *head = NULL;\n\tgit_commit *head_commit = NULL, *commit = NULL;\n\tgit_index *index = NULL;\n\tchar old_idstr[GIT_OID_HEXSZ], new_idstr[GIT_OID_HEXSZ];\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\tassert(operation);\n\n\tif ((error = rebase_ensure_not_dirty(rebase->repo, false, true, GIT_EUNMERGED)) < 0 ||\n\t\t(error = git_repository_head(&head, rebase->repo)) < 0 ||\n\t\t(error = git_reference_peel((git_object **)&head_commit, head, GIT_OBJ_COMMIT)) < 0 ||\n\t\t(error = git_repository_index(&index, rebase->repo)) < 0 ||\n\t\t(error = rebase_commit__create(&commit, rebase, index, head_commit,\n\t\t\tauthor, committer, message_encoding, message)) < 0 ||\n\t\t(error = git_reference__update_for_commit(\n\t\t\trebase->repo, NULL, \"HEAD\", git_commit_id(commit), \"rebase\")) < 0)\n\t\tgoto done;\n\n\tgit_oid_fmt(old_idstr, &operation->id);\n\tgit_oid_fmt(new_idstr, git_commit_id(commit));\n\n\tif ((error = rebase_setupfile(rebase, REWRITTEN_FILE, O_CREAT|O_WRONLY|O_APPEND,\n\t\t\"%.*s %.*s\\n\", GIT_OID_HEXSZ, old_idstr, GIT_OID_HEXSZ, new_idstr)) < 0)\n\t\tgoto done;\n\n\tgit_oid_cpy(commit_id, git_commit_id(commit));\n\ndone:\n\tgit_index_free(index);\n\tgit_reference_free(head);\n\tgit_commit_free(head_commit);\n\tgit_commit_free(commit);\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define REWRITTEN_FILE      \"rewritten\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "commit"
          ],
          "line": 1019
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "head"
          ],
          "line": 1017
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_free",
          "args": [
            "index"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "477-483",
          "snippet": "void git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nvoid git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "commit_id",
            "git_commit_id(commit)"
          ],
          "line": 1013
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_id",
          "args": [
            "commit"
          ],
          "line": 1013
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "35-38",
          "snippet": "const git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_setupfile",
          "args": [
            "rebase",
            "REWRITTEN_FILE",
            "O_CREAT|O_WRONLY|O_APPEND",
            "\"%.*s %.*s\\n\"",
            "GIT_OID_HEXSZ",
            "old_idstr",
            "GIT_OID_HEXSZ",
            "new_idstr"
          ],
          "line": 1009
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_setupfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "412-430",
          "snippet": "static int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define REBASE_FILE_MODE    0666"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_FILE_MODE    0666\n\nstatic int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "new_idstr",
            "git_commit_id(commit)"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference__update_for_commit",
          "args": [
            "rebase->repo",
            "NULL",
            "\"HEAD\"",
            "git_commit_id(commit)",
            "\"rebase\""
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference__update_for_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "1106-1144",
          "snippet": "int git_reference__update_for_commit(\n\tgit_repository *repo,\n\tgit_reference *ref,\n\tconst char *ref_name,\n\tconst git_oid *id,\n\tconst char *operation)\n{\n\tgit_reference *ref_new = NULL;\n\tgit_commit *commit = NULL;\n\tgit_buf reflog_msg = GIT_BUF_INIT;\n\tconst git_signature *who;\n\tint error;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_buf_printf(&reflog_msg, \"%s%s: %s\",\n\t\t\toperation ? operation : \"commit\",\n\t\t\tgit_commit_parentcount(commit) == 0 ? \" (initial)\" : \"\",\n\t\t\tgit_commit_summary(commit))) < 0)\n\t\tgoto done;\n\n\twho = git_commit_committer(commit);\n\n\tif (ref) {\n\t\tif ((error = ensure_is_an_updatable_direct_reference(ref)) < 0)\n\t\t\treturn error;\n\n\t\terror = reference__create(&ref_new, repo, ref->name, id, NULL, 1, who,\n\t\t\t\t\t  git_buf_cstr(&reflog_msg), &ref->target.oid, NULL);\n\t}\n\telse\n\t\terror = git_reference__update_terminal(\n\t\t\trepo, ref_name, id, who, git_buf_cstr(&reflog_msg));\n\ndone:\n\tgit_reference_free(ref_new);\n\tgit_buf_free(&reflog_msg);\n\tgit_commit_free(commit);\n\treturn error;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference__update_for_commit(\n\tgit_repository *repo,\n\tgit_reference *ref,\n\tconst char *ref_name,\n\tconst git_oid *id,\n\tconst char *operation)\n{\n\tgit_reference *ref_new = NULL;\n\tgit_commit *commit = NULL;\n\tgit_buf reflog_msg = GIT_BUF_INIT;\n\tconst git_signature *who;\n\tint error;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_buf_printf(&reflog_msg, \"%s%s: %s\",\n\t\t\toperation ? operation : \"commit\",\n\t\t\tgit_commit_parentcount(commit) == 0 ? \" (initial)\" : \"\",\n\t\t\tgit_commit_summary(commit))) < 0)\n\t\tgoto done;\n\n\twho = git_commit_committer(commit);\n\n\tif (ref) {\n\t\tif ((error = ensure_is_an_updatable_direct_reference(ref)) < 0)\n\t\t\treturn error;\n\n\t\terror = reference__create(&ref_new, repo, ref->name, id, NULL, 1, who,\n\t\t\t\t\t  git_buf_cstr(&reflog_msg), &ref->target.oid, NULL);\n\t}\n\telse\n\t\terror = git_reference__update_terminal(\n\t\t\trepo, ref_name, id, who, git_buf_cstr(&reflog_msg));\n\ndone:\n\tgit_reference_free(ref_new);\n\tgit_buf_free(&reflog_msg);\n\tgit_commit_free(commit);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_commit__create",
          "args": [
            "&commit",
            "rebase",
            "index",
            "head_commit",
            "author",
            "committer",
            "message_encoding",
            "message"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_commit__create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "915-976",
          "snippet": "static int rebase_commit__create(\n\tgit_commit **out,\n\tgit_rebase *rebase,\n\tgit_index *index,\n\tgit_commit *parent_commit,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *current_commit = NULL, *commit = NULL;\n\tgit_tree *parent_tree = NULL, *tree = NULL;\n\tgit_oid tree_id, commit_id;\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif (git_index_has_conflicts(index)) {\n\t\tgiterr_set(GITERR_REBASE, \"conflicts have not been resolved\");\n\t\terror = GIT_EUNMERGED;\n\t\tgoto done;\n\t}\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_index_write_tree_to(&tree_id, index, rebase->repo)) < 0 ||\n\t\t(error = git_tree_lookup(&tree, rebase->repo, &tree_id)) < 0)\n\t\tgoto done;\n\n\tif (git_oid_equal(&tree_id, git_tree_id(parent_tree))) {\n\t\tgiterr_set(GITERR_REBASE, \"this patch has already been applied\");\n\t\terror = GIT_EAPPLIED;\n\t\tgoto done;\n\t}\n\n\tif (!author)\n\t\tauthor = git_commit_author(current_commit);\n\n\tif (!message) {\n\t\tmessage_encoding = git_commit_message_encoding(current_commit);\n\t\tmessage = git_commit_message(current_commit);\n\t}\n\n\tif ((error = git_commit_create(&commit_id, rebase->repo, NULL, author,\n\t\tcommitter, message_encoding, message, tree, 1,\n\t\t(const git_commit **)&parent_commit)) < 0 ||\n\t\t(error = git_commit_lookup(&commit, rebase->repo, &commit_id)) < 0)\n\t\tgoto done;\n\n\t*out = commit;\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\tgit_commit_free(current_commit);\n\tgit_tree_free(parent_tree);\n\tgit_tree_free(tree);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_commit__create(\n\tgit_commit **out,\n\tgit_rebase *rebase,\n\tgit_index *index,\n\tgit_commit *parent_commit,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *current_commit = NULL, *commit = NULL;\n\tgit_tree *parent_tree = NULL, *tree = NULL;\n\tgit_oid tree_id, commit_id;\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif (git_index_has_conflicts(index)) {\n\t\tgiterr_set(GITERR_REBASE, \"conflicts have not been resolved\");\n\t\terror = GIT_EUNMERGED;\n\t\tgoto done;\n\t}\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_index_write_tree_to(&tree_id, index, rebase->repo)) < 0 ||\n\t\t(error = git_tree_lookup(&tree, rebase->repo, &tree_id)) < 0)\n\t\tgoto done;\n\n\tif (git_oid_equal(&tree_id, git_tree_id(parent_tree))) {\n\t\tgiterr_set(GITERR_REBASE, \"this patch has already been applied\");\n\t\terror = GIT_EAPPLIED;\n\t\tgoto done;\n\t}\n\n\tif (!author)\n\t\tauthor = git_commit_author(current_commit);\n\n\tif (!message) {\n\t\tmessage_encoding = git_commit_message_encoding(current_commit);\n\t\tmessage = git_commit_message(current_commit);\n\t}\n\n\tif ((error = git_commit_create(&commit_id, rebase->repo, NULL, author,\n\t\tcommitter, message_encoding, message, tree, 1,\n\t\t(const git_commit **)&parent_commit)) < 0 ||\n\t\t(error = git_commit_lookup(&commit, rebase->repo, &commit_id)) < 0)\n\t\tgoto done;\n\n\t*out = commit;\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\tgit_commit_free(current_commit);\n\tgit_tree_free(parent_tree);\n\tgit_tree_free(tree);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_index",
          "args": [
            "&index",
            "rebase->repo"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "852-859",
          "snippet": "int git_repository_index(git_index **out, git_repository *repo)\n{\n\tif (git_repository_index__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_index(git_index **out, git_repository *repo)\n{\n\tif (git_repository_index__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_peel",
          "args": [
            "(git_object **)&head_commit",
            "head",
            "GIT_OBJ_COMMIT"
          ],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "1224-1267",
          "snippet": "int git_reference_peel(\n\tgit_object **peeled,\n\tgit_reference *ref,\n\tgit_otype target_type)\n{\n\tgit_reference *resolved = NULL;\n\tgit_object *target = NULL;\n\tint error;\n\n\tassert(ref);\n\n\tif (ref->type == GIT_REF_OID) {\n\t\tresolved = ref;\n\t} else {\n\t\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\t\treturn peel_error(error, ref, \"Cannot resolve reference\");\n\t}\n\n\tif (!git_oid_iszero(&resolved->peel)) {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->peel, GIT_OBJ_ANY);\n\t} else {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->target.oid, GIT_OBJ_ANY);\n\t}\n\n\tif (error < 0) {\n\t\tpeel_error(error, ref, \"Cannot retrieve reference target\");\n\t\tgoto cleanup;\n\t}\n\n\tif (target_type == GIT_OBJ_ANY && git_object_type(target) != GIT_OBJ_TAG)\n\t\terror = git_object_dup(peeled, target);\n\telse\n\t\terror = git_object_peel(peeled, target, target_type);\n\ncleanup:\n\tgit_object_free(target);\n\n\tif (resolved != ref)\n\t\tgit_reference_free(resolved);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_peel(\n\tgit_object **peeled,\n\tgit_reference *ref,\n\tgit_otype target_type)\n{\n\tgit_reference *resolved = NULL;\n\tgit_object *target = NULL;\n\tint error;\n\n\tassert(ref);\n\n\tif (ref->type == GIT_REF_OID) {\n\t\tresolved = ref;\n\t} else {\n\t\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\t\treturn peel_error(error, ref, \"Cannot resolve reference\");\n\t}\n\n\tif (!git_oid_iszero(&resolved->peel)) {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->peel, GIT_OBJ_ANY);\n\t} else {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->target.oid, GIT_OBJ_ANY);\n\t}\n\n\tif (error < 0) {\n\t\tpeel_error(error, ref, \"Cannot retrieve reference target\");\n\t\tgoto cleanup;\n\t}\n\n\tif (target_type == GIT_OBJ_ANY && git_object_type(target) != GIT_OBJ_TAG)\n\t\terror = git_object_dup(peeled, target);\n\telse\n\t\terror = git_object_peel(peeled, target, target_type);\n\ncleanup:\n\tgit_object_free(target);\n\n\tif (resolved != ref)\n\t\tgit_reference_free(resolved);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_head",
          "args": [
            "&head",
            "rebase->repo"
          ],
          "line": 997
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_head_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1914-1931",
          "snippet": "int git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_ensure_not_dirty",
          "args": [
            "rebase->repo",
            "false",
            "true",
            "GIT_EUNMERGED"
          ],
          "line": 996
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_ensure_not_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "517-561",
          "snippet": "static int rebase_ensure_not_dirty(\n\tgit_repository *repo,\n\tbool check_index,\n\tbool check_workdir,\n\tint fail_with)\n{\n\tgit_tree *head = NULL;\n\tgit_index *index = NULL;\n\tgit_diff *diff = NULL;\n\tint error = 0;\n\n\tif (check_index) {\n\t\tif ((error = git_repository_head_tree(&head, repo)) < 0 ||\n\t\t\t(error = git_repository_index(&index, repo)) < 0 ||\n\t\t\t(error = git_diff_tree_to_index(&diff, repo, head, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Uncommitted changes exist in index\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\n\t\tgit_diff_free(diff);\n\t\tdiff = NULL;\n\t}\n\n\tif (check_workdir) {\n\t\tif ((error = git_diff_index_to_workdir(&diff, repo, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Unstaged changes exist in workdir\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\t}\n\ndone:\n\tgit_diff_free(diff);\n\tgit_index_free(index);\n\tgit_tree_free(head);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_ensure_not_dirty(\n\tgit_repository *repo,\n\tbool check_index,\n\tbool check_workdir,\n\tint fail_with)\n{\n\tgit_tree *head = NULL;\n\tgit_index *index = NULL;\n\tgit_diff *diff = NULL;\n\tint error = 0;\n\n\tif (check_index) {\n\t\tif ((error = git_repository_head_tree(&head, repo)) < 0 ||\n\t\t\t(error = git_repository_index(&index, repo)) < 0 ||\n\t\t\t(error = git_diff_tree_to_index(&diff, repo, head, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Uncommitted changes exist in index\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\n\t\tgit_diff_free(diff);\n\t\tdiff = NULL;\n\t}\n\n\tif (check_workdir) {\n\t\tif ((error = git_diff_index_to_workdir(&diff, repo, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Unstaged changes exist in workdir\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\t}\n\ndone:\n\tgit_diff_free(diff);\n\tgit_index_free(index);\n\tgit_tree_free(head);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "operation"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "rebase->operations",
            "rebase->current"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REWRITTEN_FILE      \"rewritten\"\n\nstatic int rebase_commit_merge(\n\tgit_oid *commit_id,\n\tgit_rebase *rebase,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_reference *head = NULL;\n\tgit_commit *head_commit = NULL, *commit = NULL;\n\tgit_index *index = NULL;\n\tchar old_idstr[GIT_OID_HEXSZ], new_idstr[GIT_OID_HEXSZ];\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\tassert(operation);\n\n\tif ((error = rebase_ensure_not_dirty(rebase->repo, false, true, GIT_EUNMERGED)) < 0 ||\n\t\t(error = git_repository_head(&head, rebase->repo)) < 0 ||\n\t\t(error = git_reference_peel((git_object **)&head_commit, head, GIT_OBJ_COMMIT)) < 0 ||\n\t\t(error = git_repository_index(&index, rebase->repo)) < 0 ||\n\t\t(error = rebase_commit__create(&commit, rebase, index, head_commit,\n\t\t\tauthor, committer, message_encoding, message)) < 0 ||\n\t\t(error = git_reference__update_for_commit(\n\t\t\trebase->repo, NULL, \"HEAD\", git_commit_id(commit), \"rebase\")) < 0)\n\t\tgoto done;\n\n\tgit_oid_fmt(old_idstr, &operation->id);\n\tgit_oid_fmt(new_idstr, git_commit_id(commit));\n\n\tif ((error = rebase_setupfile(rebase, REWRITTEN_FILE, O_CREAT|O_WRONLY|O_APPEND,\n\t\t\"%.*s %.*s\\n\", GIT_OID_HEXSZ, old_idstr, GIT_OID_HEXSZ, new_idstr)) < 0)\n\t\tgoto done;\n\n\tgit_oid_cpy(commit_id, git_commit_id(commit));\n\ndone:\n\tgit_index_free(index);\n\tgit_reference_free(head);\n\tgit_commit_free(head_commit);\n\tgit_commit_free(commit);\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_commit__create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "915-976",
    "snippet": "static int rebase_commit__create(\n\tgit_commit **out,\n\tgit_rebase *rebase,\n\tgit_index *index,\n\tgit_commit *parent_commit,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *current_commit = NULL, *commit = NULL;\n\tgit_tree *parent_tree = NULL, *tree = NULL;\n\tgit_oid tree_id, commit_id;\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif (git_index_has_conflicts(index)) {\n\t\tgiterr_set(GITERR_REBASE, \"conflicts have not been resolved\");\n\t\terror = GIT_EUNMERGED;\n\t\tgoto done;\n\t}\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_index_write_tree_to(&tree_id, index, rebase->repo)) < 0 ||\n\t\t(error = git_tree_lookup(&tree, rebase->repo, &tree_id)) < 0)\n\t\tgoto done;\n\n\tif (git_oid_equal(&tree_id, git_tree_id(parent_tree))) {\n\t\tgiterr_set(GITERR_REBASE, \"this patch has already been applied\");\n\t\terror = GIT_EAPPLIED;\n\t\tgoto done;\n\t}\n\n\tif (!author)\n\t\tauthor = git_commit_author(current_commit);\n\n\tif (!message) {\n\t\tmessage_encoding = git_commit_message_encoding(current_commit);\n\t\tmessage = git_commit_message(current_commit);\n\t}\n\n\tif ((error = git_commit_create(&commit_id, rebase->repo, NULL, author,\n\t\tcommitter, message_encoding, message, tree, 1,\n\t\t(const git_commit **)&parent_commit)) < 0 ||\n\t\t(error = git_commit_lookup(&commit, rebase->repo, &commit_id)) < 0)\n\t\tgoto done;\n\n\t*out = commit;\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\tgit_commit_free(current_commit);\n\tgit_tree_free(parent_tree);\n\tgit_tree_free(tree);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "tree"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "current_commit"
          ],
          "line": 971
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "&commit",
            "rebase->repo",
            "&commit_id"
          ],
          "line": 962
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_create",
          "args": [
            "&commit_id",
            "rebase->repo",
            "NULL",
            "author",
            "committer",
            "message_encoding",
            "message",
            "tree",
            "1",
            "(const git_commit **)&parent_commit"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "240-260",
          "snippet": "int git_commit_create(\n\tgit_oid *id,\n\tgit_repository *repo,\n\tconst char *update_ref,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message,\n\tconst git_tree *tree,\n\tsize_t parent_count,\n\tconst git_commit *parents[])\n{\n\tcommit_parent_data data = { parent_count, parents, repo };\n\n\tassert(tree && git_tree_owner(tree) == repo);\n\n\treturn git_commit__create_internal(\n\t\tid, repo, update_ref, author, committer,\n\t\tmessage_encoding, message, git_tree_id(tree),\n\t\tcommit_parent_from_array, &data, false);\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_commit_create(\n\tgit_oid *id,\n\tgit_repository *repo,\n\tconst char *update_ref,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message,\n\tconst git_tree *tree,\n\tsize_t parent_count,\n\tconst git_commit *parents[])\n{\n\tcommit_parent_data data = { parent_count, parents, repo };\n\n\tassert(tree && git_tree_owner(tree) == repo);\n\n\treturn git_commit__create_internal(\n\t\tid, repo, update_ref, author, committer,\n\t\tmessage_encoding, message, git_tree_id(tree),\n\t\tcommit_parent_from_array, &data, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_message",
          "args": [
            "current_commit"
          ],
          "line": 956
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "433-456",
          "snippet": "GIT_COMMIT_GETTER(const git_signature *, author, commit->author)\nGIT_COMMIT_GETTER(const git_signature *, committer, commit->committer)\nGIT_COMMIT_GETTER(const char *, message_raw, commit->raw_message)\nGIT_COMMIT_GETTER(const char *, message_encoding, commit->message_encoding)\nGIT_COMMIT_GETTER(const char *, raw_header, commit->raw_header)\nGIT_COMMIT_GETTER(git_time_t, time, commit->committer->when.time)\nGIT_COMMIT_GETTER(int, time_offset, commit->committer->when.offset)\nGIT_COMMIT_GETTER(unsigned int, parentcount, (unsigned int)git_array_size(commit->parent_ids))\nGIT_COMMIT_GETTER(const git_oid *, tree_id, &commit->tree_id)\n\nconst char *git_commit_message(const git_commit *commit)\n{\n\tconst char *message;\n\n\tassert(commit);\n\n\tmessage = commit->raw_message;\n\n\t/* trim leading newlines from raw message */\n\twhile (*message && *message == '\\n')\n\t\t++message;\n\n\treturn message;\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nGIT_COMMIT_GETTER(const git_signature *, author, commit->author)\nGIT_COMMIT_GETTER(const git_signature *, committer, commit->committer)\nGIT_COMMIT_GETTER(const char *, message_raw, commit->raw_message)\nGIT_COMMIT_GETTER(const char *, message_encoding, commit->message_encoding)\nGIT_COMMIT_GETTER(const char *, raw_header, commit->raw_header)\nGIT_COMMIT_GETTER(git_time_t, time, commit->committer->when.time)\nGIT_COMMIT_GETTER(int, time_offset, commit->committer->when.offset)\nGIT_COMMIT_GETTER(unsigned int, parentcount, (unsigned int)git_array_size(commit->parent_ids))\nGIT_COMMIT_GETTER(const git_oid *, tree_id, &commit->tree_id)\n\nconst char *git_commit_message(const git_commit *commit)\n{\n\tconst char *message;\n\n\tassert(commit);\n\n\tmessage = commit->raw_message;\n\n\t/* trim leading newlines from raw message */\n\twhile (*message && *message == '\\n')\n\t\t++message;\n\n\treturn message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_message_encoding",
          "args": [
            "current_commit"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_commit_author",
          "args": [
            "current_commit"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REBASE",
            "\"this patch has already been applied\""
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_equal",
          "args": [
            "&tree_id",
            "git_tree_id(parent_tree)"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "184-187",
          "snippet": "int git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_id",
          "args": [
            "parent_tree"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "64-67",
          "snippet": "const git_oid *git_tree_id(const git_tree *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_tree_id(const git_tree *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_lookup",
          "args": [
            "&tree",
            "rebase->repo",
            "&tree_id"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "49-52",
          "snippet": "int git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_tree_lookup(git_tree **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TREE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_write_tree_to",
          "args": [
            "&tree_id",
            "index",
            "rebase->repo"
          ],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_write_tree_to",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "786-791",
          "snippet": "int git_index_write_tree_to(\n\tgit_oid *oid, git_index *index, git_repository *repo)\n{\n\tassert(oid && index && repo);\n\treturn git_tree__write_index(oid, index, repo);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nint git_index_write_tree_to(\n\tgit_oid *oid, git_index *index, git_repository *repo)\n{\n\tassert(oid && index && repo);\n\treturn git_tree__write_index(oid, index, repo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_tree",
          "args": [
            "&parent_tree",
            "parent_commit"
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "530-534",
          "snippet": "int git_commit_tree(git_tree **tree_out, const git_commit *commit)\n{\n\tassert(commit);\n\treturn git_tree_lookup(tree_out, commit->object.repo, &commit->tree_id);\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_commit_tree(git_tree **tree_out, const git_commit *commit)\n{\n\tassert(commit);\n\treturn git_tree_lookup(tree_out, commit->object.repo, &commit->tree_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_has_conflicts",
          "args": [
            "index"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_has_conflicts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "1887-1900",
          "snippet": "int git_index_has_conflicts(const git_index *index)\n{\n\tsize_t i;\n\tgit_index_entry *entry;\n\n\tassert(index);\n\n\tgit_vector_foreach(&index->entries, i, entry) {\n\t\tif (GIT_IDXENTRY_STAGE(entry) > 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);",
            "static void index_entry_free(git_index_entry *entry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\nstatic void index_entry_free(git_index_entry *entry);\n\nint git_index_has_conflicts(const git_index *index)\n{\n\tsize_t i;\n\tgit_index_entry *entry;\n\n\tassert(index);\n\n\tgit_vector_foreach(&index->entries, i, entry) {\n\t\tif (GIT_IDXENTRY_STAGE(entry) > 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "rebase->operations",
            "rebase->current"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_commit__create(\n\tgit_commit **out,\n\tgit_rebase *rebase,\n\tgit_index *index,\n\tgit_commit *parent_commit,\n\tconst git_signature *author,\n\tconst git_signature *committer,\n\tconst char *message_encoding,\n\tconst char *message)\n{\n\tgit_rebase_operation *operation;\n\tgit_commit *current_commit = NULL, *commit = NULL;\n\tgit_tree *parent_tree = NULL, *tree = NULL;\n\tgit_oid tree_id, commit_id;\n\tint error;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif (git_index_has_conflicts(index)) {\n\t\tgiterr_set(GITERR_REBASE, \"conflicts have not been resolved\");\n\t\terror = GIT_EUNMERGED;\n\t\tgoto done;\n\t}\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_index_write_tree_to(&tree_id, index, rebase->repo)) < 0 ||\n\t\t(error = git_tree_lookup(&tree, rebase->repo, &tree_id)) < 0)\n\t\tgoto done;\n\n\tif (git_oid_equal(&tree_id, git_tree_id(parent_tree))) {\n\t\tgiterr_set(GITERR_REBASE, \"this patch has already been applied\");\n\t\terror = GIT_EAPPLIED;\n\t\tgoto done;\n\t}\n\n\tif (!author)\n\t\tauthor = git_commit_author(current_commit);\n\n\tif (!message) {\n\t\tmessage_encoding = git_commit_message_encoding(current_commit);\n\t\tmessage = git_commit_message(current_commit);\n\t}\n\n\tif ((error = git_commit_create(&commit_id, rebase->repo, NULL, author,\n\t\tcommitter, message_encoding, message, tree, 1,\n\t\t(const git_commit **)&parent_commit)) < 0 ||\n\t\t(error = git_commit_lookup(&commit, rebase->repo, &commit_id)) < 0)\n\t\tgoto done;\n\n\t*out = commit;\n\ndone:\n\tif (error < 0)\n\t\tgit_commit_free(commit);\n\n\tgit_commit_free(current_commit);\n\tgit_tree_free(parent_tree);\n\tgit_tree_free(tree);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_rebase_inmemory_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "903-913",
    "snippet": "int git_rebase_inmemory_index(\n\tgit_index **out,\n\tgit_rebase *rebase)\n{\n\tassert(out && rebase && rebase->index);\n\n\tGIT_REFCOUNT_INC(rebase->index);\n\t*out = rebase->index;\n\n\treturn 0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "rebase->index"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && rebase && rebase->index"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nint git_rebase_inmemory_index(\n\tgit_index **out,\n\tgit_rebase *rebase)\n{\n\tassert(out && rebase && rebase->index);\n\n\tGIT_REFCOUNT_INC(rebase->index);\n\t*out = rebase->index;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_rebase_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "882-901",
    "snippet": "int git_rebase_next(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tint error;\n\n\tassert(out && rebase);\n\n\tif ((error = rebase_movenext(rebase)) < 0)\n\t\treturn error;\n\n\tif (rebase->inmemory)\n\t\terror = rebase_next_inmemory(out, rebase);\n\telse if (rebase->type == GIT_REBASE_TYPE_MERGE)\n\t\terror = rebase_next_merge(out, rebase);\n\telse\n\t\tabort();\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rebase_next_merge",
          "args": [
            "out",
            "rebase"
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_next_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "777-837",
          "snippet": "static int rebase_next_merge(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_commit *current_commit = NULL, *parent_commit = NULL;\n\tgit_tree *current_tree = NULL, *head_tree = NULL, *parent_tree = NULL;\n\tgit_index *index = NULL;\n\tgit_indexwriter indexwriter = GIT_INDEXWRITER_INIT;\n\tgit_rebase_operation *operation;\n\tgit_checkout_options checkout_opts;\n\tchar current_idstr[GIT_OID_HEXSZ];\n\tunsigned int parent_count;\n\tint error;\n\n\t*out = NULL;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&current_tree, current_commit)) < 0 ||\n\t\t(error = git_repository_head_tree(&head_tree, rebase->repo)) < 0)\n\t\tgoto done;\n\n\tif ((parent_count = git_commit_parentcount(current_commit)) > 1) {\n\t\tgiterr_set(GITERR_REBASE, \"Cannot rebase a merge commit\");\n\t\terror = -1;\n\t\tgoto done;\n\t} else if (parent_count) {\n\t\tif ((error = git_commit_parent(&parent_commit, current_commit, 0)) < 0 ||\n\t\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tgit_oid_fmt(current_idstr, &operation->id);\n\n\tnormalize_checkout_options_for_apply(&checkout_opts, rebase, current_commit);\n\n\tif ((error = git_indexwriter_init_for_operation(&indexwriter, rebase->repo, &checkout_opts.checkout_strategy)) < 0 ||\n\t\t(error = rebase_setupfile(rebase, MSGNUM_FILE, -1, \"%\" PRIuZ \"\\n\", rebase->current+1)) < 0 ||\n\t\t(error = rebase_setupfile(rebase, CURRENT_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, current_idstr)) < 0 ||\n\t\t(error = git_merge_trees(&index, rebase->repo, parent_tree, head_tree, current_tree, &rebase->options.merge_options)) < 0 ||\n\t\t(error = git_merge__check_result(rebase->repo, index)) < 0 ||\n\t\t(error = git_checkout_index(rebase->repo, index, &checkout_opts)) < 0 ||\n\t\t(error = git_indexwriter_commit(&indexwriter)) < 0)\n\t\tgoto done;\n\n\t*out = operation;\n\ndone:\n\tgit_indexwriter_cleanup(&indexwriter);\n\tgit_index_free(index);\n\tgit_tree_free(current_tree);\n\tgit_tree_free(head_tree);\n\tgit_tree_free(parent_tree);\n\tgit_commit_free(parent_commit);\n\tgit_commit_free(current_commit);\n\tgit_buf_free(&path);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define CURRENT_FILE        \"current\"",
            "#define MSGNUM_FILE         \"msgnum\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define CURRENT_FILE        \"current\"\n#define MSGNUM_FILE         \"msgnum\"\n\nstatic int rebase_next_merge(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_commit *current_commit = NULL, *parent_commit = NULL;\n\tgit_tree *current_tree = NULL, *head_tree = NULL, *parent_tree = NULL;\n\tgit_index *index = NULL;\n\tgit_indexwriter indexwriter = GIT_INDEXWRITER_INIT;\n\tgit_rebase_operation *operation;\n\tgit_checkout_options checkout_opts;\n\tchar current_idstr[GIT_OID_HEXSZ];\n\tunsigned int parent_count;\n\tint error;\n\n\t*out = NULL;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&current_tree, current_commit)) < 0 ||\n\t\t(error = git_repository_head_tree(&head_tree, rebase->repo)) < 0)\n\t\tgoto done;\n\n\tif ((parent_count = git_commit_parentcount(current_commit)) > 1) {\n\t\tgiterr_set(GITERR_REBASE, \"Cannot rebase a merge commit\");\n\t\terror = -1;\n\t\tgoto done;\n\t} else if (parent_count) {\n\t\tif ((error = git_commit_parent(&parent_commit, current_commit, 0)) < 0 ||\n\t\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tgit_oid_fmt(current_idstr, &operation->id);\n\n\tnormalize_checkout_options_for_apply(&checkout_opts, rebase, current_commit);\n\n\tif ((error = git_indexwriter_init_for_operation(&indexwriter, rebase->repo, &checkout_opts.checkout_strategy)) < 0 ||\n\t\t(error = rebase_setupfile(rebase, MSGNUM_FILE, -1, \"%\" PRIuZ \"\\n\", rebase->current+1)) < 0 ||\n\t\t(error = rebase_setupfile(rebase, CURRENT_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, current_idstr)) < 0 ||\n\t\t(error = git_merge_trees(&index, rebase->repo, parent_tree, head_tree, current_tree, &rebase->options.merge_options)) < 0 ||\n\t\t(error = git_merge__check_result(rebase->repo, index)) < 0 ||\n\t\t(error = git_checkout_index(rebase->repo, index, &checkout_opts)) < 0 ||\n\t\t(error = git_indexwriter_commit(&indexwriter)) < 0)\n\t\tgoto done;\n\n\t*out = operation;\n\ndone:\n\tgit_indexwriter_cleanup(&indexwriter);\n\tgit_index_free(index);\n\tgit_tree_free(current_tree);\n\tgit_tree_free(head_tree);\n\tgit_tree_free(parent_tree);\n\tgit_commit_free(parent_commit);\n\tgit_commit_free(current_commit);\n\tgit_buf_free(&path);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_next_inmemory",
          "args": [
            "out",
            "rebase"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_next_inmemory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "839-880",
          "snippet": "static int rebase_next_inmemory(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tgit_commit *current_commit = NULL, *parent_commit = NULL;\n\tgit_tree *current_tree = NULL, *head_tree = NULL, *parent_tree = NULL;\n\tgit_rebase_operation *operation;\n\tgit_index *index = NULL;\n\tint error;\n\n\t*out = NULL;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&current_tree, current_commit)) < 0 ||\n\t\t(error = git_commit_parent(&parent_commit, current_commit, 0)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_commit_tree(&head_tree, rebase->last_commit)) < 0 ||\n\t\t(error = git_merge_trees(&index, rebase->repo, parent_tree, head_tree, current_tree, &rebase->options.merge_options)) < 0)\n\t\tgoto done;\n\n\tif (!rebase->index) {\n\t\trebase->index = index;\n\t\tindex = NULL;\n\t} else {\n\t\tif ((error = git_index_read_index(rebase->index, index)) < 0)\n\t\t\tgoto done;\n\t}\n\n\t*out = operation;\n\ndone:\n\tgit_commit_free(current_commit);\n\tgit_commit_free(parent_commit);\n\tgit_tree_free(current_tree);\n\tgit_tree_free(head_tree);\n\tgit_tree_free(parent_tree);\n\tgit_index_free(index);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_next_inmemory(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tgit_commit *current_commit = NULL, *parent_commit = NULL;\n\tgit_tree *current_tree = NULL, *head_tree = NULL, *parent_tree = NULL;\n\tgit_rebase_operation *operation;\n\tgit_index *index = NULL;\n\tint error;\n\n\t*out = NULL;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&current_tree, current_commit)) < 0 ||\n\t\t(error = git_commit_parent(&parent_commit, current_commit, 0)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_commit_tree(&head_tree, rebase->last_commit)) < 0 ||\n\t\t(error = git_merge_trees(&index, rebase->repo, parent_tree, head_tree, current_tree, &rebase->options.merge_options)) < 0)\n\t\tgoto done;\n\n\tif (!rebase->index) {\n\t\trebase->index = index;\n\t\tindex = NULL;\n\t} else {\n\t\tif ((error = git_index_read_index(rebase->index, index)) < 0)\n\t\t\tgoto done;\n\t}\n\n\t*out = operation;\n\ndone:\n\tgit_commit_free(current_commit);\n\tgit_commit_free(parent_commit);\n\tgit_tree_free(current_tree);\n\tgit_tree_free(head_tree);\n\tgit_tree_free(parent_tree);\n\tgit_index_free(index);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_movenext",
          "args": [
            "rebase"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_movenext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "764-775",
          "snippet": "GIT_INLINE(int) rebase_movenext(git_rebase *rebase)\n{\n\tsize_t next = rebase->started ? rebase->current + 1 : 0;\n\n\tif (next == git_array_size(rebase->operations))\n\t\treturn GIT_ITEROVER;\n\n\trebase->started = 1;\n\trebase->current = next;\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_movenext(git_rebase *rebase)\n{\n\tsize_t next = rebase->started ? rebase->current + 1 : 0;\n\n\tif (next == git_array_size(rebase->operations))\n\t\treturn GIT_ITEROVER;\n\n\trebase->started = 1;\n\trebase->current = next;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && rebase"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nint git_rebase_next(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tint error;\n\n\tassert(out && rebase);\n\n\tif ((error = rebase_movenext(rebase)) < 0)\n\t\treturn error;\n\n\tif (rebase->inmemory)\n\t\terror = rebase_next_inmemory(out, rebase);\n\telse if (rebase->type == GIT_REBASE_TYPE_MERGE)\n\t\terror = rebase_next_merge(out, rebase);\n\telse\n\t\tabort();\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_next_inmemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "839-880",
    "snippet": "static int rebase_next_inmemory(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tgit_commit *current_commit = NULL, *parent_commit = NULL;\n\tgit_tree *current_tree = NULL, *head_tree = NULL, *parent_tree = NULL;\n\tgit_rebase_operation *operation;\n\tgit_index *index = NULL;\n\tint error;\n\n\t*out = NULL;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&current_tree, current_commit)) < 0 ||\n\t\t(error = git_commit_parent(&parent_commit, current_commit, 0)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_commit_tree(&head_tree, rebase->last_commit)) < 0 ||\n\t\t(error = git_merge_trees(&index, rebase->repo, parent_tree, head_tree, current_tree, &rebase->options.merge_options)) < 0)\n\t\tgoto done;\n\n\tif (!rebase->index) {\n\t\trebase->index = index;\n\t\tindex = NULL;\n\t} else {\n\t\tif ((error = git_index_read_index(rebase->index, index)) < 0)\n\t\t\tgoto done;\n\t}\n\n\t*out = operation;\n\ndone:\n\tgit_commit_free(current_commit);\n\tgit_commit_free(parent_commit);\n\tgit_tree_free(current_tree);\n\tgit_tree_free(head_tree);\n\tgit_tree_free(parent_tree);\n\tgit_index_free(index);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_index_free",
          "args": [
            "index"
          ],
          "line": 877
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "477-483",
          "snippet": "void git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nvoid git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "parent_tree"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "parent_commit"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_read_index",
          "args": [
            "rebase->index",
            "index"
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_read_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "2928-3062",
          "snippet": "int git_index_read_index(\n\tgit_index *index,\n\tconst git_index *new_index)\n{\n\tgit_vector new_entries = GIT_VECTOR_INIT,\n\t\tremove_entries = GIT_VECTOR_INIT;\n\tgit_idxmap *new_entries_map = NULL;\n\tgit_iterator *index_iterator = NULL;\n\tgit_iterator *new_iterator = NULL;\n\tgit_iterator_options opts = GIT_ITERATOR_OPTIONS_INIT;\n\tconst git_index_entry *old_entry, *new_entry;\n\tgit_index_entry *entry;\n\tsize_t i;\n\tint error;\n\n\tif ((error = git_vector_init(&new_entries, new_index->entries.length, index->entries._cmp)) < 0 ||\n\t\t(error = git_vector_init(&remove_entries, index->entries.length, NULL)) < 0 ||\n\t\t(error = git_idxmap_alloc(&new_entries_map)) < 0)\n\t\tgoto done;\n\n\tif (index->ignore_case)\n\t\tkh_resize(idxicase, (khash_t(idxicase) *) new_entries_map, new_index->entries.length);\n\telse\n\t\tkh_resize(idx, new_entries_map, new_index->entries.length);\n\n\topts.flags = GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\tif ((error = git_iterator_for_index(&index_iterator, git_index_owner(index), index, &opts)) < 0 ||\n\t\t(error = git_iterator_for_index(&new_iterator, git_index_owner(new_index), (git_index *)new_index, &opts)) < 0)\n\t\tgoto done;\n\n\tif (((error = git_iterator_current(&old_entry, index_iterator)) < 0 &&\n\t\t\terror != GIT_ITEROVER) ||\n\t\t((error = git_iterator_current(&new_entry, new_iterator)) < 0 &&\n\t\t\terror != GIT_ITEROVER))\n\t\tgoto done;\n\n\twhile (true) {\n\t\tgit_index_entry\n\t\t\t*dup_entry = NULL,\n\t\t\t*add_entry = NULL,\n\t\t\t*remove_entry = NULL;\n\t\tint diff;\n\n\t\terror = 0;\n\n\t\tif (old_entry && new_entry)\n\t\t\tdiff = git_index_entry_cmp(old_entry, new_entry);\n\t\telse if (!old_entry && new_entry)\n\t\t\tdiff = 1;\n\t\telse if (old_entry && !new_entry)\n\t\t\tdiff = -1;\n\t\telse\n\t\t\tbreak;\n\n\t\tif (diff < 0) {\n\t\t\tremove_entry = (git_index_entry *)old_entry;\n\t\t} else if (diff > 0) {\n\t\t\tdup_entry = (git_index_entry *)new_entry;\n\t\t} else {\n\t\t\t/* Path and stage are equal, if the OID is equal, keep it to\n\t\t\t * keep the stat cache data.\n\t\t\t */\n\t\t\tif (git_oid_equal(&old_entry->id, &new_entry->id) &&\n\t\t\t\told_entry->mode == new_entry->mode) {\n\t\t\t\tadd_entry = (git_index_entry *)old_entry;\n\t\t\t} else {\n\t\t\t\tdup_entry = (git_index_entry *)new_entry;\n\t\t\t\tremove_entry = (git_index_entry *)old_entry;\n\t\t\t}\n\t\t}\n\n\t\tif (dup_entry) {\n\t\t\tif ((error = index_entry_dup_nocache(&add_entry, index, dup_entry)) < 0)\n\t\t\t\tgoto done;\n\n\t\t\tindex_entry_adjust_namemask(add_entry,\n\t\t\t\t((struct entry_internal *)add_entry)->pathlen);\n\t\t}\n\n\t\t/* invalidate this path in the tree cache if this is new (to\n\t\t * invalidate the parent trees)\n\t\t */\n\t\tif (dup_entry && !remove_entry && index->tree)\n\t\t\tgit_tree_cache_invalidate_path(index->tree, dup_entry->path);\n\n\t\tif (add_entry) {\n\t\t\tif ((error = git_vector_insert(&new_entries, add_entry)) == 0)\n\t\t\t\tINSERT_IN_MAP_EX(index, new_entries_map, add_entry, error);\n\t\t}\n\n\t\tif (remove_entry && error >= 0)\n\t\t\terror = git_vector_insert(&remove_entries, remove_entry);\n\n\t\tif (error < 0) {\n\t\t\tgiterr_set(GITERR_INDEX, \"failed to insert entry\");\n\t\t\tgoto done;\n\t\t}\n\n\t\tif (diff <= 0) {\n\t\t\tif ((error = git_iterator_advance(&old_entry, index_iterator)) < 0 &&\n\t\t\t\terror != GIT_ITEROVER)\n\t\t\t\tgoto done;\n\t\t}\n\n\t\tif (diff >= 0) {\n\t\t\tif ((error = git_iterator_advance(&new_entry, new_iterator)) < 0 &&\n\t\t\t\terror != GIT_ITEROVER)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\tgit_index_name_clear(index);\n\tgit_index_reuc_clear(index);\n\n\tgit_vector_swap(&new_entries, &index->entries);\n\tnew_entries_map = git__swap(index->entries_map, new_entries_map);\n\n\tgit_vector_foreach(&remove_entries, i, entry) {\n\t\tif (index->tree)\n\t\t\tgit_tree_cache_invalidate_path(index->tree, entry->path);\n\n\t\tindex_entry_free(entry);\n\t}\n\n\terror = 0;\n\ndone:\n\tgit_idxmap_free(new_entries_map);\n\tgit_vector_free(&new_entries);\n\tgit_vector_free(&remove_entries);\n\tgit_iterator_free(index_iterator);\n\tgit_iterator_free(new_iterator);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);",
            "static void index_entry_free(git_index_entry *entry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\nstatic void index_entry_free(git_index_entry *entry);\n\nint git_index_read_index(\n\tgit_index *index,\n\tconst git_index *new_index)\n{\n\tgit_vector new_entries = GIT_VECTOR_INIT,\n\t\tremove_entries = GIT_VECTOR_INIT;\n\tgit_idxmap *new_entries_map = NULL;\n\tgit_iterator *index_iterator = NULL;\n\tgit_iterator *new_iterator = NULL;\n\tgit_iterator_options opts = GIT_ITERATOR_OPTIONS_INIT;\n\tconst git_index_entry *old_entry, *new_entry;\n\tgit_index_entry *entry;\n\tsize_t i;\n\tint error;\n\n\tif ((error = git_vector_init(&new_entries, new_index->entries.length, index->entries._cmp)) < 0 ||\n\t\t(error = git_vector_init(&remove_entries, index->entries.length, NULL)) < 0 ||\n\t\t(error = git_idxmap_alloc(&new_entries_map)) < 0)\n\t\tgoto done;\n\n\tif (index->ignore_case)\n\t\tkh_resize(idxicase, (khash_t(idxicase) *) new_entries_map, new_index->entries.length);\n\telse\n\t\tkh_resize(idx, new_entries_map, new_index->entries.length);\n\n\topts.flags = GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\tif ((error = git_iterator_for_index(&index_iterator, git_index_owner(index), index, &opts)) < 0 ||\n\t\t(error = git_iterator_for_index(&new_iterator, git_index_owner(new_index), (git_index *)new_index, &opts)) < 0)\n\t\tgoto done;\n\n\tif (((error = git_iterator_current(&old_entry, index_iterator)) < 0 &&\n\t\t\terror != GIT_ITEROVER) ||\n\t\t((error = git_iterator_current(&new_entry, new_iterator)) < 0 &&\n\t\t\terror != GIT_ITEROVER))\n\t\tgoto done;\n\n\twhile (true) {\n\t\tgit_index_entry\n\t\t\t*dup_entry = NULL,\n\t\t\t*add_entry = NULL,\n\t\t\t*remove_entry = NULL;\n\t\tint diff;\n\n\t\terror = 0;\n\n\t\tif (old_entry && new_entry)\n\t\t\tdiff = git_index_entry_cmp(old_entry, new_entry);\n\t\telse if (!old_entry && new_entry)\n\t\t\tdiff = 1;\n\t\telse if (old_entry && !new_entry)\n\t\t\tdiff = -1;\n\t\telse\n\t\t\tbreak;\n\n\t\tif (diff < 0) {\n\t\t\tremove_entry = (git_index_entry *)old_entry;\n\t\t} else if (diff > 0) {\n\t\t\tdup_entry = (git_index_entry *)new_entry;\n\t\t} else {\n\t\t\t/* Path and stage are equal, if the OID is equal, keep it to\n\t\t\t * keep the stat cache data.\n\t\t\t */\n\t\t\tif (git_oid_equal(&old_entry->id, &new_entry->id) &&\n\t\t\t\told_entry->mode == new_entry->mode) {\n\t\t\t\tadd_entry = (git_index_entry *)old_entry;\n\t\t\t} else {\n\t\t\t\tdup_entry = (git_index_entry *)new_entry;\n\t\t\t\tremove_entry = (git_index_entry *)old_entry;\n\t\t\t}\n\t\t}\n\n\t\tif (dup_entry) {\n\t\t\tif ((error = index_entry_dup_nocache(&add_entry, index, dup_entry)) < 0)\n\t\t\t\tgoto done;\n\n\t\t\tindex_entry_adjust_namemask(add_entry,\n\t\t\t\t((struct entry_internal *)add_entry)->pathlen);\n\t\t}\n\n\t\t/* invalidate this path in the tree cache if this is new (to\n\t\t * invalidate the parent trees)\n\t\t */\n\t\tif (dup_entry && !remove_entry && index->tree)\n\t\t\tgit_tree_cache_invalidate_path(index->tree, dup_entry->path);\n\n\t\tif (add_entry) {\n\t\t\tif ((error = git_vector_insert(&new_entries, add_entry)) == 0)\n\t\t\t\tINSERT_IN_MAP_EX(index, new_entries_map, add_entry, error);\n\t\t}\n\n\t\tif (remove_entry && error >= 0)\n\t\t\terror = git_vector_insert(&remove_entries, remove_entry);\n\n\t\tif (error < 0) {\n\t\t\tgiterr_set(GITERR_INDEX, \"failed to insert entry\");\n\t\t\tgoto done;\n\t\t}\n\n\t\tif (diff <= 0) {\n\t\t\tif ((error = git_iterator_advance(&old_entry, index_iterator)) < 0 &&\n\t\t\t\terror != GIT_ITEROVER)\n\t\t\t\tgoto done;\n\t\t}\n\n\t\tif (diff >= 0) {\n\t\t\tif ((error = git_iterator_advance(&new_entry, new_iterator)) < 0 &&\n\t\t\t\terror != GIT_ITEROVER)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\tgit_index_name_clear(index);\n\tgit_index_reuc_clear(index);\n\n\tgit_vector_swap(&new_entries, &index->entries);\n\tnew_entries_map = git__swap(index->entries_map, new_entries_map);\n\n\tgit_vector_foreach(&remove_entries, i, entry) {\n\t\tif (index->tree)\n\t\t\tgit_tree_cache_invalidate_path(index->tree, entry->path);\n\n\t\tindex_entry_free(entry);\n\t}\n\n\terror = 0;\n\ndone:\n\tgit_idxmap_free(new_entries_map);\n\tgit_vector_free(&new_entries);\n\tgit_vector_free(&remove_entries);\n\tgit_iterator_free(index_iterator);\n\tgit_iterator_free(new_iterator);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_merge_trees",
          "args": [
            "&index",
            "rebase->repo",
            "parent_tree",
            "head_tree",
            "current_tree",
            "&rebase->options.merge_options"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "git_merge_trees",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge.c",
          "lines": "1910-1941",
          "snippet": "int git_merge_trees(\n\tgit_index **out,\n\tgit_repository *repo,\n\tconst git_tree *ancestor_tree,\n\tconst git_tree *our_tree,\n\tconst git_tree *their_tree,\n\tconst git_merge_options *merge_opts)\n{\n\tgit_iterator *ancestor_iter = NULL, *our_iter = NULL, *their_iter = NULL;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error;\n\n\titer_opts.flags = GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\tif ((error = git_iterator_for_tree(\n\t\t\t&ancestor_iter, (git_tree *)ancestor_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_tree(\n\t\t\t&our_iter, (git_tree *)our_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_tree(\n\t\t\t&their_iter, (git_tree *)their_tree, &iter_opts)) < 0)\n\t\tgoto done;\n\n\terror = git_merge__iterators(\n\t\tout, repo, ancestor_iter, our_iter, their_iter, merge_opts);\n\ndone:\n\tgit_iterator_free(ancestor_iter);\n\tgit_iterator_free(our_iter);\n\tgit_iterator_free(their_iter);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/sys/hashsig.h\"",
            "#include \"git2/sys/index.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/oidarray.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/checkout.h\"",
            "#include \"git2/reset.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/types.h\"",
            "#include \"oidarray.h\"",
            "#include \"commit.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"oidarray.h\"",
            "#include \"config.h\"",
            "#include \"filebuf.h\"",
            "#include \"index.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"checkout.h\"",
            "#include \"diff.h\"",
            "#include \"refs.h\"",
            "#include \"iterator.h\"",
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"path.h\"",
            "#include \"merge.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/hashsig.h\"\n#include \"git2/sys/index.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/oidarray.h\"\n#include \"git2/tree.h\"\n#include \"git2/config.h\"\n#include \"git2/signature.h\"\n#include \"git2/checkout.h\"\n#include \"git2/reset.h\"\n#include \"git2/refs.h\"\n#include \"git2/merge.h\"\n#include \"git2/commit.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/types.h\"\n#include \"oidarray.h\"\n#include \"commit.h\"\n#include \"annotated_commit.h\"\n#include \"oidarray.h\"\n#include \"config.h\"\n#include \"filebuf.h\"\n#include \"index.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"checkout.h\"\n#include \"diff.h\"\n#include \"refs.h\"\n#include \"iterator.h\"\n#include \"object.h\"\n#include \"refs.h\"\n#include \"path.h\"\n#include \"merge.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_merge_trees(\n\tgit_index **out,\n\tgit_repository *repo,\n\tconst git_tree *ancestor_tree,\n\tconst git_tree *our_tree,\n\tconst git_tree *their_tree,\n\tconst git_merge_options *merge_opts)\n{\n\tgit_iterator *ancestor_iter = NULL, *our_iter = NULL, *their_iter = NULL;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error;\n\n\titer_opts.flags = GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\tif ((error = git_iterator_for_tree(\n\t\t\t&ancestor_iter, (git_tree *)ancestor_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_tree(\n\t\t\t&our_iter, (git_tree *)our_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_tree(\n\t\t\t&their_iter, (git_tree *)their_tree, &iter_opts)) < 0)\n\t\tgoto done;\n\n\terror = git_merge__iterators(\n\t\tout, repo, ancestor_iter, our_iter, their_iter, merge_opts);\n\ndone:\n\tgit_iterator_free(ancestor_iter);\n\tgit_iterator_free(our_iter);\n\tgit_iterator_free(their_iter);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_tree",
          "args": [
            "&head_tree",
            "rebase->last_commit"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "530-534",
          "snippet": "int git_commit_tree(git_tree **tree_out, const git_commit *commit)\n{\n\tassert(commit);\n\treturn git_tree_lookup(tree_out, commit->object.repo, &commit->tree_id);\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_commit_tree(git_tree **tree_out, const git_commit *commit)\n{\n\tassert(commit);\n\treturn git_tree_lookup(tree_out, commit->object.repo, &commit->tree_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_parent",
          "args": [
            "&parent_commit",
            "current_commit",
            "0"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_parent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "544-557",
          "snippet": "int git_commit_parent(\n\tgit_commit **parent, const git_commit *commit, unsigned int n)\n{\n\tconst git_oid *parent_id;\n\tassert(commit);\n\n\tparent_id = git_commit_parent_id(commit, n);\n\tif (parent_id == NULL) {\n\t\tgiterr_set(GITERR_INVALID, \"Parent %u does not exist\", n);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\treturn git_commit_lookup(parent, commit->object.repo, parent_id);\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_commit_parent(\n\tgit_commit **parent, const git_commit *commit, unsigned int n)\n{\n\tconst git_oid *parent_id;\n\tassert(commit);\n\n\tparent_id = git_commit_parent_id(commit, n);\n\tif (parent_id == NULL) {\n\t\tgiterr_set(GITERR_INVALID, \"Parent %u does not exist\", n);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\treturn git_commit_lookup(parent, commit->object.repo, parent_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "&current_commit",
            "rebase->repo",
            "&operation->id"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "rebase->operations",
            "rebase->current"
          ],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_next_inmemory(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tgit_commit *current_commit = NULL, *parent_commit = NULL;\n\tgit_tree *current_tree = NULL, *head_tree = NULL, *parent_tree = NULL;\n\tgit_rebase_operation *operation;\n\tgit_index *index = NULL;\n\tint error;\n\n\t*out = NULL;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&current_tree, current_commit)) < 0 ||\n\t\t(error = git_commit_parent(&parent_commit, current_commit, 0)) < 0 ||\n\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0 ||\n\t\t(error = git_commit_tree(&head_tree, rebase->last_commit)) < 0 ||\n\t\t(error = git_merge_trees(&index, rebase->repo, parent_tree, head_tree, current_tree, &rebase->options.merge_options)) < 0)\n\t\tgoto done;\n\n\tif (!rebase->index) {\n\t\trebase->index = index;\n\t\tindex = NULL;\n\t} else {\n\t\tif ((error = git_index_read_index(rebase->index, index)) < 0)\n\t\t\tgoto done;\n\t}\n\n\t*out = operation;\n\ndone:\n\tgit_commit_free(current_commit);\n\tgit_commit_free(parent_commit);\n\tgit_tree_free(current_tree);\n\tgit_tree_free(head_tree);\n\tgit_tree_free(parent_tree);\n\tgit_index_free(index);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_next_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "777-837",
    "snippet": "static int rebase_next_merge(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_commit *current_commit = NULL, *parent_commit = NULL;\n\tgit_tree *current_tree = NULL, *head_tree = NULL, *parent_tree = NULL;\n\tgit_index *index = NULL;\n\tgit_indexwriter indexwriter = GIT_INDEXWRITER_INIT;\n\tgit_rebase_operation *operation;\n\tgit_checkout_options checkout_opts;\n\tchar current_idstr[GIT_OID_HEXSZ];\n\tunsigned int parent_count;\n\tint error;\n\n\t*out = NULL;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&current_tree, current_commit)) < 0 ||\n\t\t(error = git_repository_head_tree(&head_tree, rebase->repo)) < 0)\n\t\tgoto done;\n\n\tif ((parent_count = git_commit_parentcount(current_commit)) > 1) {\n\t\tgiterr_set(GITERR_REBASE, \"Cannot rebase a merge commit\");\n\t\terror = -1;\n\t\tgoto done;\n\t} else if (parent_count) {\n\t\tif ((error = git_commit_parent(&parent_commit, current_commit, 0)) < 0 ||\n\t\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tgit_oid_fmt(current_idstr, &operation->id);\n\n\tnormalize_checkout_options_for_apply(&checkout_opts, rebase, current_commit);\n\n\tif ((error = git_indexwriter_init_for_operation(&indexwriter, rebase->repo, &checkout_opts.checkout_strategy)) < 0 ||\n\t\t(error = rebase_setupfile(rebase, MSGNUM_FILE, -1, \"%\" PRIuZ \"\\n\", rebase->current+1)) < 0 ||\n\t\t(error = rebase_setupfile(rebase, CURRENT_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, current_idstr)) < 0 ||\n\t\t(error = git_merge_trees(&index, rebase->repo, parent_tree, head_tree, current_tree, &rebase->options.merge_options)) < 0 ||\n\t\t(error = git_merge__check_result(rebase->repo, index)) < 0 ||\n\t\t(error = git_checkout_index(rebase->repo, index, &checkout_opts)) < 0 ||\n\t\t(error = git_indexwriter_commit(&indexwriter)) < 0)\n\t\tgoto done;\n\n\t*out = operation;\n\ndone:\n\tgit_indexwriter_cleanup(&indexwriter);\n\tgit_index_free(index);\n\tgit_tree_free(current_tree);\n\tgit_tree_free(head_tree);\n\tgit_tree_free(parent_tree);\n\tgit_commit_free(parent_commit);\n\tgit_commit_free(current_commit);\n\tgit_buf_free(&path);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define CURRENT_FILE        \"current\"",
      "#define MSGNUM_FILE         \"msgnum\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 834
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "current_commit"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "parent_tree"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_free",
          "args": [
            "index"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "477-483",
          "snippet": "void git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nvoid git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_indexwriter_cleanup",
          "args": [
            "&indexwriter"
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "git_indexwriter_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "3433-3439",
          "snippet": "void git_indexwriter_cleanup(git_indexwriter *writer)\n{\n\tgit_filebuf_cleanup(&writer->file);\n\n\tgit_index_free(writer->index);\n\twriter->index = NULL;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);",
            "static int write_index(git_oid *checksum, git_index *index, git_filebuf *file);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\nstatic int write_index(git_oid *checksum, git_index *index, git_filebuf *file);\n\nvoid git_indexwriter_cleanup(git_indexwriter *writer)\n{\n\tgit_filebuf_cleanup(&writer->file);\n\n\tgit_index_free(writer->index);\n\twriter->index = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_indexwriter_commit",
          "args": [
            "&indexwriter"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "git_indexwriter_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "3399-3431",
          "snippet": "int git_indexwriter_commit(git_indexwriter *writer)\n{\n\tint error;\n\tgit_oid checksum = {{ 0 }};\n\n\tif (!writer->should_write)\n\t\treturn 0;\n\n\tgit_vector_sort(&writer->index->entries);\n\tgit_vector_sort(&writer->index->reuc);\n\n\tif ((error = write_index(&checksum, writer->index, &writer->file)) < 0) {\n\t\tgit_indexwriter_cleanup(writer);\n\t\treturn error;\n\t}\n\n\tif ((error = git_filebuf_commit(&writer->file)) < 0)\n\t\treturn error;\n\n\tif ((error = git_futils_filestamp_check(\n\t\t&writer->index->stamp, writer->index->index_file_path)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Could not read index timestamp\");\n\t\treturn -1;\n\t}\n\n\twriter->index->on_disk = 1;\n\tgit_oid_cpy(&writer->index->checksum, &checksum);\n\n\tgit_index_free(writer->index);\n\twriter->index = NULL;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);",
            "static int write_index(git_oid *checksum, git_index *index, git_filebuf *file);",
            "static void index_entry_reuc_free(git_index_reuc_entry *reuc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\nstatic int write_index(git_oid *checksum, git_index *index, git_filebuf *file);\nstatic void index_entry_reuc_free(git_index_reuc_entry *reuc);\n\nint git_indexwriter_commit(git_indexwriter *writer)\n{\n\tint error;\n\tgit_oid checksum = {{ 0 }};\n\n\tif (!writer->should_write)\n\t\treturn 0;\n\n\tgit_vector_sort(&writer->index->entries);\n\tgit_vector_sort(&writer->index->reuc);\n\n\tif ((error = write_index(&checksum, writer->index, &writer->file)) < 0) {\n\t\tgit_indexwriter_cleanup(writer);\n\t\treturn error;\n\t}\n\n\tif ((error = git_filebuf_commit(&writer->file)) < 0)\n\t\treturn error;\n\n\tif ((error = git_futils_filestamp_check(\n\t\t&writer->index->stamp, writer->index->index_file_path)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Could not read index timestamp\");\n\t\treturn -1;\n\t}\n\n\twriter->index->on_disk = 1;\n\tgit_oid_cpy(&writer->index->checksum, &checksum);\n\n\tgit_index_free(writer->index);\n\twriter->index = NULL;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_checkout_index",
          "args": [
            "rebase->repo",
            "index",
            "&checkout_opts"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_merge__check_result",
          "args": [
            "rebase->repo",
            "index"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "git_merge__check_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge.c",
          "lines": "2746-2803",
          "snippet": "int git_merge__check_result(git_repository *repo, git_index *index_new)\n{\n\tgit_tree *head_tree = NULL;\n\tgit_iterator *iter_head = NULL, *iter_new = NULL;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tgit_diff *merged_list = NULL;\n\tgit_diff_options opts = GIT_DIFF_OPTIONS_INIT;\n\tgit_diff_delta *delta;\n\tgit_vector paths = GIT_VECTOR_INIT;\n\tsize_t i, index_conflicts = 0, wd_conflicts = 0, conflicts;\n\tconst git_index_entry *e;\n\tint error = 0;\n\n\titer_opts.flags = GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\tif ((error = git_repository_head_tree(&head_tree, repo)) < 0 ||\n\t\t(error = git_iterator_for_tree(&iter_head, head_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_index(&iter_new, repo, index_new, &iter_opts)) < 0 ||\n\t\t(error = git_diff__from_iterators(&merged_list, repo, iter_head, iter_new, &opts)) < 0)\n\t\tgoto done;\n\n\tgit_vector_foreach(&merged_list->deltas, i, delta) {\n\t\tif ((error = git_vector_insert(&paths, (char *)delta->new_file.path)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tfor (i = 0; i < git_index_entrycount(index_new); i++) {\n\t\te = git_index_get_byindex(index_new, i);\n\n\t\tif (git_index_entry_is_conflict(e) &&\n\t\t\t(git_vector_last(&paths) == NULL ||\n\t\t\tstrcmp(git_vector_last(&paths), e->path) != 0)) {\n\n\t\t\tif ((error = git_vector_insert(&paths, (char *)e->path)) < 0)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\t/* Make sure the index and workdir state do not prevent merging */\n\tif ((error = merge_check_index(&index_conflicts, repo, index_new, &paths)) < 0 ||\n\t\t(error = merge_check_workdir(&wd_conflicts, repo, index_new, &paths)) < 0)\n\t\tgoto done;\n\n\tif ((conflicts = index_conflicts + wd_conflicts) > 0) {\n\t\tgiterr_set(GITERR_MERGE, \"%\" PRIuZ \" uncommitted change%s would be overwritten by merge\",\n\t\t\tconflicts, (conflicts != 1) ? \"s\" : \"\");\n\t\terror = GIT_ECONFLICT;\n\t}\n\ndone:\n\tgit_vector_free(&paths);\n\tgit_tree_free(head_tree);\n\tgit_iterator_free(iter_head);\n\tgit_iterator_free(iter_new);\n\tgit_diff_free(merged_list);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/sys/hashsig.h\"",
            "#include \"git2/sys/index.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/oidarray.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/checkout.h\"",
            "#include \"git2/reset.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/types.h\"",
            "#include \"oidarray.h\"",
            "#include \"commit.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"oidarray.h\"",
            "#include \"config.h\"",
            "#include \"filebuf.h\"",
            "#include \"index.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"checkout.h\"",
            "#include \"diff.h\"",
            "#include \"refs.h\"",
            "#include \"iterator.h\"",
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"path.h\"",
            "#include \"merge.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int merge_annotated_commits(\n\tgit_index **index_out,\n\tgit_annotated_commit **base_out,\n\tgit_repository *repo,\n\tgit_annotated_commit *our_commit,\n\tgit_annotated_commit *their_commit,\n\tsize_t recursion_level,\n\tconst git_merge_options *opts);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/hashsig.h\"\n#include \"git2/sys/index.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/oidarray.h\"\n#include \"git2/tree.h\"\n#include \"git2/config.h\"\n#include \"git2/signature.h\"\n#include \"git2/checkout.h\"\n#include \"git2/reset.h\"\n#include \"git2/refs.h\"\n#include \"git2/merge.h\"\n#include \"git2/commit.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/types.h\"\n#include \"oidarray.h\"\n#include \"commit.h\"\n#include \"annotated_commit.h\"\n#include \"oidarray.h\"\n#include \"config.h\"\n#include \"filebuf.h\"\n#include \"index.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"checkout.h\"\n#include \"diff.h\"\n#include \"refs.h\"\n#include \"iterator.h\"\n#include \"object.h\"\n#include \"refs.h\"\n#include \"path.h\"\n#include \"merge.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic int merge_annotated_commits(\n\tgit_index **index_out,\n\tgit_annotated_commit **base_out,\n\tgit_repository *repo,\n\tgit_annotated_commit *our_commit,\n\tgit_annotated_commit *their_commit,\n\tsize_t recursion_level,\n\tconst git_merge_options *opts);\n\nint git_merge__check_result(git_repository *repo, git_index *index_new)\n{\n\tgit_tree *head_tree = NULL;\n\tgit_iterator *iter_head = NULL, *iter_new = NULL;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tgit_diff *merged_list = NULL;\n\tgit_diff_options opts = GIT_DIFF_OPTIONS_INIT;\n\tgit_diff_delta *delta;\n\tgit_vector paths = GIT_VECTOR_INIT;\n\tsize_t i, index_conflicts = 0, wd_conflicts = 0, conflicts;\n\tconst git_index_entry *e;\n\tint error = 0;\n\n\titer_opts.flags = GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\tif ((error = git_repository_head_tree(&head_tree, repo)) < 0 ||\n\t\t(error = git_iterator_for_tree(&iter_head, head_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_index(&iter_new, repo, index_new, &iter_opts)) < 0 ||\n\t\t(error = git_diff__from_iterators(&merged_list, repo, iter_head, iter_new, &opts)) < 0)\n\t\tgoto done;\n\n\tgit_vector_foreach(&merged_list->deltas, i, delta) {\n\t\tif ((error = git_vector_insert(&paths, (char *)delta->new_file.path)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tfor (i = 0; i < git_index_entrycount(index_new); i++) {\n\t\te = git_index_get_byindex(index_new, i);\n\n\t\tif (git_index_entry_is_conflict(e) &&\n\t\t\t(git_vector_last(&paths) == NULL ||\n\t\t\tstrcmp(git_vector_last(&paths), e->path) != 0)) {\n\n\t\t\tif ((error = git_vector_insert(&paths, (char *)e->path)) < 0)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\t/* Make sure the index and workdir state do not prevent merging */\n\tif ((error = merge_check_index(&index_conflicts, repo, index_new, &paths)) < 0 ||\n\t\t(error = merge_check_workdir(&wd_conflicts, repo, index_new, &paths)) < 0)\n\t\tgoto done;\n\n\tif ((conflicts = index_conflicts + wd_conflicts) > 0) {\n\t\tgiterr_set(GITERR_MERGE, \"%\" PRIuZ \" uncommitted change%s would be overwritten by merge\",\n\t\t\tconflicts, (conflicts != 1) ? \"s\" : \"\");\n\t\terror = GIT_ECONFLICT;\n\t}\n\ndone:\n\tgit_vector_free(&paths);\n\tgit_tree_free(head_tree);\n\tgit_iterator_free(iter_head);\n\tgit_iterator_free(iter_new);\n\tgit_diff_free(merged_list);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_merge_trees",
          "args": [
            "&index",
            "rebase->repo",
            "parent_tree",
            "head_tree",
            "current_tree",
            "&rebase->options.merge_options"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "git_merge_trees",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/merge.c",
          "lines": "1910-1941",
          "snippet": "int git_merge_trees(\n\tgit_index **out,\n\tgit_repository *repo,\n\tconst git_tree *ancestor_tree,\n\tconst git_tree *our_tree,\n\tconst git_tree *their_tree,\n\tconst git_merge_options *merge_opts)\n{\n\tgit_iterator *ancestor_iter = NULL, *our_iter = NULL, *their_iter = NULL;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error;\n\n\titer_opts.flags = GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\tif ((error = git_iterator_for_tree(\n\t\t\t&ancestor_iter, (git_tree *)ancestor_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_tree(\n\t\t\t&our_iter, (git_tree *)our_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_tree(\n\t\t\t&their_iter, (git_tree *)their_tree, &iter_opts)) < 0)\n\t\tgoto done;\n\n\terror = git_merge__iterators(\n\t\tout, repo, ancestor_iter, our_iter, their_iter, merge_opts);\n\ndone:\n\tgit_iterator_free(ancestor_iter);\n\tgit_iterator_free(our_iter);\n\tgit_iterator_free(their_iter);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/sys/hashsig.h\"",
            "#include \"git2/sys/index.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/oidarray.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/checkout.h\"",
            "#include \"git2/reset.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/merge.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/types.h\"",
            "#include \"oidarray.h\"",
            "#include \"commit.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"oidarray.h\"",
            "#include \"config.h\"",
            "#include \"filebuf.h\"",
            "#include \"index.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"checkout.h\"",
            "#include \"diff.h\"",
            "#include \"refs.h\"",
            "#include \"iterator.h\"",
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"path.h\"",
            "#include \"merge.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/hashsig.h\"\n#include \"git2/sys/index.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/oidarray.h\"\n#include \"git2/tree.h\"\n#include \"git2/config.h\"\n#include \"git2/signature.h\"\n#include \"git2/checkout.h\"\n#include \"git2/reset.h\"\n#include \"git2/refs.h\"\n#include \"git2/merge.h\"\n#include \"git2/commit.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/types.h\"\n#include \"oidarray.h\"\n#include \"commit.h\"\n#include \"annotated_commit.h\"\n#include \"oidarray.h\"\n#include \"config.h\"\n#include \"filebuf.h\"\n#include \"index.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"checkout.h\"\n#include \"diff.h\"\n#include \"refs.h\"\n#include \"iterator.h\"\n#include \"object.h\"\n#include \"refs.h\"\n#include \"path.h\"\n#include \"merge.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_merge_trees(\n\tgit_index **out,\n\tgit_repository *repo,\n\tconst git_tree *ancestor_tree,\n\tconst git_tree *our_tree,\n\tconst git_tree *their_tree,\n\tconst git_merge_options *merge_opts)\n{\n\tgit_iterator *ancestor_iter = NULL, *our_iter = NULL, *their_iter = NULL;\n\tgit_iterator_options iter_opts = GIT_ITERATOR_OPTIONS_INIT;\n\tint error;\n\n\titer_opts.flags = GIT_ITERATOR_DONT_IGNORE_CASE;\n\n\tif ((error = git_iterator_for_tree(\n\t\t\t&ancestor_iter, (git_tree *)ancestor_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_tree(\n\t\t\t&our_iter, (git_tree *)our_tree, &iter_opts)) < 0 ||\n\t\t(error = git_iterator_for_tree(\n\t\t\t&their_iter, (git_tree *)their_tree, &iter_opts)) < 0)\n\t\tgoto done;\n\n\terror = git_merge__iterators(\n\t\tout, repo, ancestor_iter, our_iter, their_iter, merge_opts);\n\ndone:\n\tgit_iterator_free(ancestor_iter);\n\tgit_iterator_free(our_iter);\n\tgit_iterator_free(their_iter);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_setupfile",
          "args": [
            "rebase",
            "CURRENT_FILE",
            "-1",
            "\"%.*s\\n\"",
            "GIT_OID_HEXSZ",
            "current_idstr"
          ],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_setupfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "412-430",
          "snippet": "static int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define REBASE_FILE_MODE    0666"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_FILE_MODE    0666\n\nstatic int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_indexwriter_init_for_operation",
          "args": [
            "&indexwriter",
            "rebase->repo",
            "&checkout_opts.checkout_strategy"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "git_indexwriter_init_for_operation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "3381-3397",
          "snippet": "int git_indexwriter_init_for_operation(\n\tgit_indexwriter *writer,\n\tgit_repository *repo,\n\tunsigned int *checkout_strategy)\n{\n\tgit_index *index;\n\tint error;\n\n\tif ((error = git_repository_index__weakptr(&index, repo)) < 0 ||\n\t\t(error = git_indexwriter_init(writer, index)) < 0)\n\t\treturn error;\n\n\twriter->should_write = (*checkout_strategy & GIT_CHECKOUT_DONT_WRITE_INDEX) == 0;\n\t*checkout_strategy |= GIT_CHECKOUT_DONT_WRITE_INDEX;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nint git_indexwriter_init_for_operation(\n\tgit_indexwriter *writer,\n\tgit_repository *repo,\n\tunsigned int *checkout_strategy)\n{\n\tgit_index *index;\n\tint error;\n\n\tif ((error = git_repository_index__weakptr(&index, repo)) < 0 ||\n\t\t(error = git_indexwriter_init(writer, index)) < 0)\n\t\treturn error;\n\n\twriter->should_write = (*checkout_strategy & GIT_CHECKOUT_DONT_WRITE_INDEX) == 0;\n\t*checkout_strategy |= GIT_CHECKOUT_DONT_WRITE_INDEX;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "normalize_checkout_options_for_apply",
          "args": [
            "&checkout_opts",
            "rebase",
            "current_commit"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "normalize_checkout_options_for_apply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "743-762",
          "snippet": "static void normalize_checkout_options_for_apply(\n\tgit_checkout_options *checkout_opts,\n\tgit_rebase *rebase,\n\tgit_commit *current_commit)\n{\n\tmemcpy(checkout_opts, &rebase->options.checkout_options, sizeof(git_checkout_options));\n\n\tif (!checkout_opts->ancestor_label)\n\t\tcheckout_opts->ancestor_label = \"ancestor\";\n\n\tif (rebase->type == GIT_REBASE_TYPE_MERGE) {\n\t\tif (!checkout_opts->our_label)\n\t\t\tcheckout_opts->our_label = rebase->onto_name;\n\n\t\tif (!checkout_opts->their_label)\n\t\t\tcheckout_opts->their_label = git_commit_summary(current_commit);\n\t} else {\n\t\tabort();\n\t}\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic void normalize_checkout_options_for_apply(\n\tgit_checkout_options *checkout_opts,\n\tgit_rebase *rebase,\n\tgit_commit *current_commit)\n{\n\tmemcpy(checkout_opts, &rebase->options.checkout_options, sizeof(git_checkout_options));\n\n\tif (!checkout_opts->ancestor_label)\n\t\tcheckout_opts->ancestor_label = \"ancestor\";\n\n\tif (rebase->type == GIT_REBASE_TYPE_MERGE) {\n\t\tif (!checkout_opts->our_label)\n\t\t\tcheckout_opts->our_label = rebase->onto_name;\n\n\t\tif (!checkout_opts->their_label)\n\t\t\tcheckout_opts->their_label = git_commit_summary(current_commit);\n\t} else {\n\t\tabort();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "current_idstr",
            "&operation->id"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_tree",
          "args": [
            "&parent_tree",
            "parent_commit"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "530-534",
          "snippet": "int git_commit_tree(git_tree **tree_out, const git_commit *commit)\n{\n\tassert(commit);\n\treturn git_tree_lookup(tree_out, commit->object.repo, &commit->tree_id);\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_commit_tree(git_tree **tree_out, const git_commit *commit)\n{\n\tassert(commit);\n\treturn git_tree_lookup(tree_out, commit->object.repo, &commit->tree_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_parent",
          "args": [
            "&parent_commit",
            "current_commit",
            "0"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_parent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "544-557",
          "snippet": "int git_commit_parent(\n\tgit_commit **parent, const git_commit *commit, unsigned int n)\n{\n\tconst git_oid *parent_id;\n\tassert(commit);\n\n\tparent_id = git_commit_parent_id(commit, n);\n\tif (parent_id == NULL) {\n\t\tgiterr_set(GITERR_INVALID, \"Parent %u does not exist\", n);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\treturn git_commit_lookup(parent, commit->object.repo, parent_id);\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nint git_commit_parent(\n\tgit_commit **parent, const git_commit *commit, unsigned int n)\n{\n\tconst git_oid *parent_id;\n\tassert(commit);\n\n\tparent_id = git_commit_parent_id(commit, n);\n\tif (parent_id == NULL) {\n\t\tgiterr_set(GITERR_INVALID, \"Parent %u does not exist\", n);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\treturn git_commit_lookup(parent, commit->object.repo, parent_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REBASE",
            "\"Cannot rebase a merge commit\""
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_parentcount",
          "args": [
            "current_commit"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_head_tree",
          "args": [
            "&head_tree",
            "rebase->repo"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_head_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1914-1931",
          "snippet": "int git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "&current_commit",
            "rebase->repo",
            "&operation->id"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "rebase->operations",
            "rebase->current"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define CURRENT_FILE        \"current\"\n#define MSGNUM_FILE         \"msgnum\"\n\nstatic int rebase_next_merge(\n\tgit_rebase_operation **out,\n\tgit_rebase *rebase)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_commit *current_commit = NULL, *parent_commit = NULL;\n\tgit_tree *current_tree = NULL, *head_tree = NULL, *parent_tree = NULL;\n\tgit_index *index = NULL;\n\tgit_indexwriter indexwriter = GIT_INDEXWRITER_INIT;\n\tgit_rebase_operation *operation;\n\tgit_checkout_options checkout_opts;\n\tchar current_idstr[GIT_OID_HEXSZ];\n\tunsigned int parent_count;\n\tint error;\n\n\t*out = NULL;\n\n\toperation = git_array_get(rebase->operations, rebase->current);\n\n\tif ((error = git_commit_lookup(&current_commit, rebase->repo, &operation->id)) < 0 ||\n\t\t(error = git_commit_tree(&current_tree, current_commit)) < 0 ||\n\t\t(error = git_repository_head_tree(&head_tree, rebase->repo)) < 0)\n\t\tgoto done;\n\n\tif ((parent_count = git_commit_parentcount(current_commit)) > 1) {\n\t\tgiterr_set(GITERR_REBASE, \"Cannot rebase a merge commit\");\n\t\terror = -1;\n\t\tgoto done;\n\t} else if (parent_count) {\n\t\tif ((error = git_commit_parent(&parent_commit, current_commit, 0)) < 0 ||\n\t\t\t(error = git_commit_tree(&parent_tree, parent_commit)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tgit_oid_fmt(current_idstr, &operation->id);\n\n\tnormalize_checkout_options_for_apply(&checkout_opts, rebase, current_commit);\n\n\tif ((error = git_indexwriter_init_for_operation(&indexwriter, rebase->repo, &checkout_opts.checkout_strategy)) < 0 ||\n\t\t(error = rebase_setupfile(rebase, MSGNUM_FILE, -1, \"%\" PRIuZ \"\\n\", rebase->current+1)) < 0 ||\n\t\t(error = rebase_setupfile(rebase, CURRENT_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, current_idstr)) < 0 ||\n\t\t(error = git_merge_trees(&index, rebase->repo, parent_tree, head_tree, current_tree, &rebase->options.merge_options)) < 0 ||\n\t\t(error = git_merge__check_result(rebase->repo, index)) < 0 ||\n\t\t(error = git_checkout_index(rebase->repo, index, &checkout_opts)) < 0 ||\n\t\t(error = git_indexwriter_commit(&indexwriter)) < 0)\n\t\tgoto done;\n\n\t*out = operation;\n\ndone:\n\tgit_indexwriter_cleanup(&indexwriter);\n\tgit_index_free(index);\n\tgit_tree_free(current_tree);\n\tgit_tree_free(head_tree);\n\tgit_tree_free(parent_tree);\n\tgit_commit_free(parent_commit);\n\tgit_commit_free(current_commit);\n\tgit_buf_free(&path);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_movenext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "764-775",
    "snippet": "GIT_INLINE(int) rebase_movenext(git_rebase *rebase)\n{\n\tsize_t next = rebase->started ? rebase->current + 1 : 0;\n\n\tif (next == git_array_size(rebase->operations))\n\t\treturn GIT_ITEROVER;\n\n\trebase->started = 1;\n\trebase->current = next;\n\n\treturn 0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "rebase->operations"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_movenext(git_rebase *rebase)\n{\n\tsize_t next = rebase->started ? rebase->current + 1 : 0;\n\n\tif (next == git_array_size(rebase->operations))\n\t\treturn GIT_ITEROVER;\n\n\trebase->started = 1;\n\trebase->current = next;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "normalize_checkout_options_for_apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "743-762",
    "snippet": "static void normalize_checkout_options_for_apply(\n\tgit_checkout_options *checkout_opts,\n\tgit_rebase *rebase,\n\tgit_commit *current_commit)\n{\n\tmemcpy(checkout_opts, &rebase->options.checkout_options, sizeof(git_checkout_options));\n\n\tif (!checkout_opts->ancestor_label)\n\t\tcheckout_opts->ancestor_label = \"ancestor\";\n\n\tif (rebase->type == GIT_REBASE_TYPE_MERGE) {\n\t\tif (!checkout_opts->our_label)\n\t\t\tcheckout_opts->our_label = rebase->onto_name;\n\n\t\tif (!checkout_opts->their_label)\n\t\t\tcheckout_opts->their_label = git_commit_summary(current_commit);\n\t} else {\n\t\tabort();\n\t}\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_commit_summary",
          "args": [
            "current_commit"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_summary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit.c",
          "lines": "458-501",
          "snippet": "const char *git_commit_summary(git_commit *commit)\n{\n\tgit_buf summary = GIT_BUF_INIT;\n\tconst char *msg, *space;\n\tbool space_contains_newline = false;\n\n\tassert(commit);\n\n\tif (!commit->summary) {\n\t\tfor (msg = git_commit_message(commit), space = NULL; *msg; ++msg) {\n\t\t\tchar next_character = msg[0];\n\t\t\t/* stop processing at the end of the first paragraph */\n\t\t\tif (next_character == '\\n' && (!msg[1] || msg[1] == '\\n'))\n\t\t\t\tbreak;\n\t\t\t/* record the beginning of contiguous whitespace runs */\n\t\t\telse if (git__isspace(next_character)) {\n\t\t\t\tif(space == NULL) {\n\t\t\t\t\tspace = msg;\n\t\t\t\t\tspace_contains_newline = false;\n\t\t\t\t}\n\t\t\t\tspace_contains_newline |= next_character == '\\n';\n\t\t\t}\n\t\t\t/* the next character is non-space */\n\t\t\telse {\n\t\t\t\t/* process any recorded whitespace */\n\t\t\t\tif (space) {\n\t\t\t\t\tif(space_contains_newline)\n\t\t\t\t\t\tgit_buf_putc(&summary, ' '); /* if the space contains a newline, collapse to ' ' */\n\t\t\t\t\telse\n\t\t\t\t\t\tgit_buf_put(&summary, space, (msg - space)); /* otherwise copy it */\n\t\t\t\t\tspace = NULL;\n\t\t\t\t}\n\t\t\t\t/* copy the next character */\n\t\t\t\tgit_buf_putc(&summary, next_character);\n\t\t\t}\n\t\t}\n\n\t\tcommit->summary = git_buf_detach(&summary);\n\t\tif (!commit->summary)\n\t\t\tcommit->summary = git__strdup(\"\");\n\t}\n\n\treturn commit->summary;\n}",
          "includes": [
            "#include \"object.h\"",
            "#include \"refs.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"commit.h\"",
            "#include \"odb.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/commit.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"object.h\"\n#include \"refs.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"commit.h\"\n#include \"odb.h\"\n#include \"common.h\"\n#include \"git2/sys/commit.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"git2/common.h\"\n\nconst char *git_commit_summary(git_commit *commit)\n{\n\tgit_buf summary = GIT_BUF_INIT;\n\tconst char *msg, *space;\n\tbool space_contains_newline = false;\n\n\tassert(commit);\n\n\tif (!commit->summary) {\n\t\tfor (msg = git_commit_message(commit), space = NULL; *msg; ++msg) {\n\t\t\tchar next_character = msg[0];\n\t\t\t/* stop processing at the end of the first paragraph */\n\t\t\tif (next_character == '\\n' && (!msg[1] || msg[1] == '\\n'))\n\t\t\t\tbreak;\n\t\t\t/* record the beginning of contiguous whitespace runs */\n\t\t\telse if (git__isspace(next_character)) {\n\t\t\t\tif(space == NULL) {\n\t\t\t\t\tspace = msg;\n\t\t\t\t\tspace_contains_newline = false;\n\t\t\t\t}\n\t\t\t\tspace_contains_newline |= next_character == '\\n';\n\t\t\t}\n\t\t\t/* the next character is non-space */\n\t\t\telse {\n\t\t\t\t/* process any recorded whitespace */\n\t\t\t\tif (space) {\n\t\t\t\t\tif(space_contains_newline)\n\t\t\t\t\t\tgit_buf_putc(&summary, ' '); /* if the space contains a newline, collapse to ' ' */\n\t\t\t\t\telse\n\t\t\t\t\t\tgit_buf_put(&summary, space, (msg - space)); /* otherwise copy it */\n\t\t\t\t\tspace = NULL;\n\t\t\t\t}\n\t\t\t\t/* copy the next character */\n\t\t\t\tgit_buf_putc(&summary, next_character);\n\t\t\t}\n\t\t}\n\n\t\tcommit->summary = git_buf_detach(&summary);\n\t\tif (!commit->summary)\n\t\t\tcommit->summary = git__strdup(\"\");\n\t}\n\n\treturn commit->summary;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "checkout_opts",
            "&rebase->options.checkout_options",
            "sizeof(git_checkout_options)"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic void normalize_checkout_options_for_apply(\n\tgit_checkout_options *checkout_opts,\n\tgit_rebase *rebase,\n\tgit_commit *current_commit)\n{\n\tmemcpy(checkout_opts, &rebase->options.checkout_options, sizeof(git_checkout_options));\n\n\tif (!checkout_opts->ancestor_label)\n\t\tcheckout_opts->ancestor_label = \"ancestor\";\n\n\tif (rebase->type == GIT_REBASE_TYPE_MERGE) {\n\t\tif (!checkout_opts->our_label)\n\t\t\tcheckout_opts->our_label = rebase->onto_name;\n\n\t\tif (!checkout_opts->their_label)\n\t\t\tcheckout_opts->their_label = git_commit_summary(current_commit);\n\t} else {\n\t\tabort();\n\t}\n}"
  },
  {
    "function_name": "git_rebase_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "674-741",
    "snippet": "int git_rebase_init(\n\tgit_rebase **out,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto,\n\tconst git_rebase_options *given_opts)\n{\n\tgit_rebase *rebase = NULL;\n\tgit_annotated_commit *head_branch = NULL;\n\tgit_reference *head_ref = NULL;\n\tbool inmemory = (given_opts && given_opts->inmemory);\n\tint error;\n\n\tassert(repo && (upstream || onto));\n\n\t*out = NULL;\n\n\tif (!onto)\n\t\tonto = upstream;\n\n\tif ((error = rebase_check_versions(given_opts)) < 0)\n\t\tgoto done;\n\n\tif (!inmemory) {\n\t\tif ((error = git_repository__ensure_not_bare(repo, \"rebase\")) < 0 ||\n\t\t\t(error = rebase_ensure_not_in_progress(repo)) < 0 ||\n\t\t\t(error = rebase_ensure_not_dirty(repo, true, true, GIT_ERROR)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif (!branch) {\n\t\tif ((error = git_repository_head(&head_ref, repo)) < 0 ||\n\t\t\t(error = git_annotated_commit_from_ref(&head_branch, repo, head_ref)) < 0)\n\t\t\tgoto done;\n\n\t\tbranch = head_branch;\n\t}\n\n\tif (rebase_alloc(&rebase, given_opts) < 0)\n\t\treturn -1;\n\n\trebase->repo = repo;\n\trebase->inmemory = inmemory;\n\trebase->type = GIT_REBASE_TYPE_MERGE;\n\n\tif ((error = rebase_init_operations(rebase, repo, branch, upstream, onto)) < 0)\n\t\tgoto done;\n\n\tif (inmemory)\n\t\terror = rebase_init_inmemory(rebase, repo, branch, upstream, onto);\n\telse\n\t\trebase_init_merge(rebase, repo, branch ,upstream, onto);\n\n\tif (error == 0)\n\t\t*out = rebase;\n\ndone:\n\tgit_reference_free(head_ref);\n\tgit_annotated_commit_free(head_branch);\n\n\tif (error < 0) {\n\t\trebase_cleanup(rebase);\n\t\tgit_rebase_free(rebase);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_rebase_free",
          "args": [
            "rebase"
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "git_rebase_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "1324-1337",
          "snippet": "void git_rebase_free(git_rebase *rebase)\n{\n\tif (rebase == NULL)\n\t\treturn;\n\n\tgit_index_free(rebase->index);\n\tgit_commit_free(rebase->last_commit);\n\tgit__free(rebase->onto_name);\n\tgit__free(rebase->orig_head_name);\n\tgit__free(rebase->state_path);\n\tgit_array_clear(rebase->operations);\n\tgit__free((char *)rebase->options.rewrite_notes_ref);\n\tgit__free(rebase);\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nvoid git_rebase_free(git_rebase *rebase)\n{\n\tif (rebase == NULL)\n\t\treturn;\n\n\tgit_index_free(rebase->index);\n\tgit_commit_free(rebase->last_commit);\n\tgit__free(rebase->onto_name);\n\tgit__free(rebase->orig_head_name);\n\tgit__free(rebase->state_path);\n\tgit_array_clear(rebase->operations);\n\tgit__free((char *)rebase->options.rewrite_notes_ref);\n\tgit__free(rebase);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_cleanup",
          "args": [
            "rebase"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "402-410",
          "snippet": "static int rebase_cleanup(git_rebase *rebase)\n{\n\tif (!rebase || rebase->inmemory)\n\t\treturn 0;\n\n\treturn git_path_isdir(rebase->state_path) ?\n\t\tgit_futils_rmdir_r(rebase->state_path, NULL, GIT_RMDIR_REMOVE_FILES) :\n\t\t0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_cleanup(git_rebase *rebase)\n{\n\tif (!rebase || rebase->inmemory)\n\t\treturn 0;\n\n\treturn git_path_isdir(rebase->state_path) ?\n\t\tgit_futils_rmdir_r(rebase->state_path, NULL, GIT_RMDIR_REMOVE_FILES) :\n\t\t0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_annotated_commit_free",
          "args": [
            "head_branch"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "git_annotated_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "181-202",
          "snippet": "void git_annotated_commit_free(git_annotated_commit *annotated_commit)\n{\n\tif (annotated_commit == NULL)\n\t\treturn;\n\n\tswitch (annotated_commit->type) {\n\t\tcase GIT_ANNOTATED_COMMIT_REAL:\n\t\t\tgit_commit_free(annotated_commit->commit);\n\t\t\tgit_tree_free(annotated_commit->tree);\n\t\t\tgit__free(annotated_commit->ref_name);\n\t\t\tgit__free(annotated_commit->remote_url);\n\t\t\tbreak;\n\t\tcase GIT_ANNOTATED_COMMIT_VIRTUAL:\n\t\t\tgit_index_free(annotated_commit->index);\n\t\t\tgit_array_clear(annotated_commit->parents);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tabort();\n\t}\n\n\tgit__free(annotated_commit);\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nvoid git_annotated_commit_free(git_annotated_commit *annotated_commit)\n{\n\tif (annotated_commit == NULL)\n\t\treturn;\n\n\tswitch (annotated_commit->type) {\n\t\tcase GIT_ANNOTATED_COMMIT_REAL:\n\t\t\tgit_commit_free(annotated_commit->commit);\n\t\t\tgit_tree_free(annotated_commit->tree);\n\t\t\tgit__free(annotated_commit->ref_name);\n\t\t\tgit__free(annotated_commit->remote_url);\n\t\t\tbreak;\n\t\tcase GIT_ANNOTATED_COMMIT_VIRTUAL:\n\t\t\tgit_index_free(annotated_commit->index);\n\t\t\tgit_array_clear(annotated_commit->parents);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tabort();\n\t}\n\n\tgit__free(annotated_commit);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "head_ref"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_init_merge",
          "args": [
            "rebase",
            "repo",
            "branch",
            "upstream",
            "onto"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_init_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "608-658",
          "snippet": "static int rebase_init_merge(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tgit_reference *head_ref = NULL;\n\tgit_commit *onto_commit = NULL;\n\tgit_buf reflog = GIT_BUF_INIT;\n\tgit_buf state_path = GIT_BUF_INIT;\n\tint error;\n\n\tGIT_UNUSED(upstream);\n\n\tif ((error = git_buf_joinpath(&state_path, repo->path_repository, REBASE_MERGE_DIR)) < 0)\n\t\tgoto done;\n\n\trebase->state_path = git_buf_detach(&state_path);\n\tGITERR_CHECK_ALLOC(rebase->state_path);\n\n\trebase->orig_head_name = git__strdup(branch->ref_name ? branch->ref_name : ORIG_DETACHED_HEAD);\n\tGITERR_CHECK_ALLOC(rebase->orig_head_name);\n\n\trebase->onto_name = git__strdup(rebase_onto_name(onto));\n\tGITERR_CHECK_ALLOC(rebase->onto_name);\n\n\trebase->quiet = rebase->options.quiet;\n\n\tgit_oid_cpy(&rebase->orig_head_id, git_annotated_commit_id(branch));\n\tgit_oid_cpy(&rebase->onto_id, git_annotated_commit_id(onto));\n\n\tif ((error = rebase_setupfiles(rebase)) < 0 ||\n\t\t(error = git_buf_printf(&reflog,\n\t\t\t\"rebase: checkout %s\", rebase_onto_name(onto))) < 0 ||\n\t\t(error = git_commit_lookup(\n\t\t\t&onto_commit, repo, git_annotated_commit_id(onto))) < 0 ||\n\t\t(error = git_checkout_tree(repo,\n\t\t\t(git_object *)onto_commit, &rebase->options.checkout_options)) < 0 ||\n\t\t(error = git_reference_create(&head_ref, repo, GIT_HEAD_FILE,\n\t\t\tgit_annotated_commit_id(onto), 1, reflog.ptr)) < 0)\n\t\tgoto done;\n\ndone:\n\tgit_reference_free(head_ref);\n\tgit_commit_free(onto_commit);\n\tgit_buf_free(&reflog);\n\tgit_buf_free(&state_path);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define ORIG_DETACHED_HEAD  \"detached HEAD\"",
            "#define REBASE_MERGE_DIR    \"rebase-merge\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define ORIG_DETACHED_HEAD  \"detached HEAD\"\n#define REBASE_MERGE_DIR    \"rebase-merge\"\n\nstatic int rebase_init_merge(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tgit_reference *head_ref = NULL;\n\tgit_commit *onto_commit = NULL;\n\tgit_buf reflog = GIT_BUF_INIT;\n\tgit_buf state_path = GIT_BUF_INIT;\n\tint error;\n\n\tGIT_UNUSED(upstream);\n\n\tif ((error = git_buf_joinpath(&state_path, repo->path_repository, REBASE_MERGE_DIR)) < 0)\n\t\tgoto done;\n\n\trebase->state_path = git_buf_detach(&state_path);\n\tGITERR_CHECK_ALLOC(rebase->state_path);\n\n\trebase->orig_head_name = git__strdup(branch->ref_name ? branch->ref_name : ORIG_DETACHED_HEAD);\n\tGITERR_CHECK_ALLOC(rebase->orig_head_name);\n\n\trebase->onto_name = git__strdup(rebase_onto_name(onto));\n\tGITERR_CHECK_ALLOC(rebase->onto_name);\n\n\trebase->quiet = rebase->options.quiet;\n\n\tgit_oid_cpy(&rebase->orig_head_id, git_annotated_commit_id(branch));\n\tgit_oid_cpy(&rebase->onto_id, git_annotated_commit_id(onto));\n\n\tif ((error = rebase_setupfiles(rebase)) < 0 ||\n\t\t(error = git_buf_printf(&reflog,\n\t\t\t\"rebase: checkout %s\", rebase_onto_name(onto))) < 0 ||\n\t\t(error = git_commit_lookup(\n\t\t\t&onto_commit, repo, git_annotated_commit_id(onto))) < 0 ||\n\t\t(error = git_checkout_tree(repo,\n\t\t\t(git_object *)onto_commit, &rebase->options.checkout_options)) < 0 ||\n\t\t(error = git_reference_create(&head_ref, repo, GIT_HEAD_FILE,\n\t\t\tgit_annotated_commit_id(onto), 1, reflog.ptr)) < 0)\n\t\tgoto done;\n\ndone:\n\tgit_reference_free(head_ref);\n\tgit_commit_free(onto_commit);\n\tgit_buf_free(&reflog);\n\tgit_buf_free(&state_path);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_init_inmemory",
          "args": [
            "rebase",
            "repo",
            "branch",
            "upstream",
            "onto"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_init_inmemory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "660-672",
          "snippet": "static int rebase_init_inmemory(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tGIT_UNUSED(branch);\n\tGIT_UNUSED(upstream);\n\n\treturn git_commit_lookup(\n\t\t&rebase->last_commit, repo, git_annotated_commit_id(onto));\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_init_inmemory(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tGIT_UNUSED(branch);\n\tGIT_UNUSED(upstream);\n\n\treturn git_commit_lookup(\n\t\t&rebase->last_commit, repo, git_annotated_commit_id(onto));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_init_operations",
          "args": [
            "rebase",
            "repo",
            "branch",
            "upstream",
            "onto"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_init_operations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "563-606",
          "snippet": "static int rebase_init_operations(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tgit_revwalk *revwalk = NULL;\n\tgit_commit *commit;\n\tgit_oid id;\n\tbool merge;\n\tgit_rebase_operation *operation;\n\tint error;\n\n\tif (!upstream)\n\t\tupstream = onto;\n\n\tif ((error = git_revwalk_new(&revwalk, rebase->repo)) < 0 ||\n\t\t(error = git_revwalk_push(revwalk, git_annotated_commit_id(branch))) < 0 ||\n\t\t(error = git_revwalk_hide(revwalk, git_annotated_commit_id(upstream))) < 0)\n\t\tgoto done;\n\n\tgit_revwalk_sorting(revwalk, GIT_SORT_REVERSE | GIT_SORT_TIME);\n\n\twhile ((error = git_revwalk_next(&id, revwalk)) == 0) {\n\t\tif ((error = git_commit_lookup(&commit, repo, &id)) < 0)\n\t\t\tgoto done;\n\n\t\tmerge = (git_commit_parentcount(commit) > 1);\n\t\tgit_commit_free(commit);\n\n\t\tif (merge)\n\t\t\tcontinue;\n\n\t\toperation = rebase_operation_alloc(rebase, GIT_REBASE_OPERATION_PICK, &id, NULL);\n\t\tGITERR_CHECK_ALLOC(operation);\n\t}\n\n\terror = 0;\n\ndone:\n\tgit_revwalk_free(revwalk);\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_init_operations(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tgit_revwalk *revwalk = NULL;\n\tgit_commit *commit;\n\tgit_oid id;\n\tbool merge;\n\tgit_rebase_operation *operation;\n\tint error;\n\n\tif (!upstream)\n\t\tupstream = onto;\n\n\tif ((error = git_revwalk_new(&revwalk, rebase->repo)) < 0 ||\n\t\t(error = git_revwalk_push(revwalk, git_annotated_commit_id(branch))) < 0 ||\n\t\t(error = git_revwalk_hide(revwalk, git_annotated_commit_id(upstream))) < 0)\n\t\tgoto done;\n\n\tgit_revwalk_sorting(revwalk, GIT_SORT_REVERSE | GIT_SORT_TIME);\n\n\twhile ((error = git_revwalk_next(&id, revwalk)) == 0) {\n\t\tif ((error = git_commit_lookup(&commit, repo, &id)) < 0)\n\t\t\tgoto done;\n\n\t\tmerge = (git_commit_parentcount(commit) > 1);\n\t\tgit_commit_free(commit);\n\n\t\tif (merge)\n\t\t\tcontinue;\n\n\t\toperation = rebase_operation_alloc(rebase, GIT_REBASE_OPERATION_PICK, &id, NULL);\n\t\tGITERR_CHECK_ALLOC(operation);\n\t}\n\n\terror = 0;\n\ndone:\n\tgit_revwalk_free(revwalk);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_alloc",
          "args": [
            "&rebase",
            "given_opts"
          ],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "260-283",
          "snippet": "static int rebase_alloc(git_rebase **out, const git_rebase_options *rebase_opts)\n{\n\tgit_rebase *rebase = git__calloc(1, sizeof(git_rebase));\n\tGITERR_CHECK_ALLOC(rebase);\n\n\t*out = NULL;\n\n\tif (rebase_opts)\n\t\tmemcpy(&rebase->options, rebase_opts, sizeof(git_rebase_options));\n\telse\n\t\tgit_rebase_init_options(&rebase->options, GIT_REBASE_OPTIONS_VERSION);\n\n\tif (rebase_opts && rebase_opts->rewrite_notes_ref) {\n\t\trebase->options.rewrite_notes_ref = git__strdup(rebase_opts->rewrite_notes_ref);\n\t\tGITERR_CHECK_ALLOC(rebase->options.rewrite_notes_ref);\n\t}\n\n\tif ((rebase->options.checkout_options.checkout_strategy & (GIT_CHECKOUT_SAFE | GIT_CHECKOUT_FORCE)) == 0)\n\t\trebase->options.checkout_options.checkout_strategy = GIT_CHECKOUT_SAFE;\n\n\t*out = rebase;\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_alloc(git_rebase **out, const git_rebase_options *rebase_opts)\n{\n\tgit_rebase *rebase = git__calloc(1, sizeof(git_rebase));\n\tGITERR_CHECK_ALLOC(rebase);\n\n\t*out = NULL;\n\n\tif (rebase_opts)\n\t\tmemcpy(&rebase->options, rebase_opts, sizeof(git_rebase_options));\n\telse\n\t\tgit_rebase_init_options(&rebase->options, GIT_REBASE_OPTIONS_VERSION);\n\n\tif (rebase_opts && rebase_opts->rewrite_notes_ref) {\n\t\trebase->options.rewrite_notes_ref = git__strdup(rebase_opts->rewrite_notes_ref);\n\t\tGITERR_CHECK_ALLOC(rebase->options.rewrite_notes_ref);\n\t}\n\n\tif ((rebase->options.checkout_options.checkout_strategy & (GIT_CHECKOUT_SAFE | GIT_CHECKOUT_FORCE)) == 0)\n\t\trebase->options.checkout_options.checkout_strategy = GIT_CHECKOUT_SAFE;\n\n\t*out = rebase;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_annotated_commit_from_ref",
          "args": [
            "&head_branch",
            "repo",
            "head_ref"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "git_annotated_commit_from_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "58-78",
          "snippet": "int git_annotated_commit_from_ref(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_reference *ref)\n{\n\tgit_reference *resolved;\n\tint error = 0;\n\n\tassert(out && repo && ref);\n\n\t*out = NULL;\n\n\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\treturn error;\n\t\n\terror = annotated_commit_init(out, repo, git_reference_target(resolved),\n\t\tgit_reference_name(ref), NULL);\n\n\tgit_reference_free(resolved);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nint git_annotated_commit_from_ref(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_reference *ref)\n{\n\tgit_reference *resolved;\n\tint error = 0;\n\n\tassert(out && repo && ref);\n\n\t*out = NULL;\n\n\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\treturn error;\n\t\n\terror = annotated_commit_init(out, repo, git_reference_target(resolved),\n\t\tgit_reference_name(ref), NULL);\n\n\tgit_reference_free(resolved);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_head",
          "args": [
            "&head_ref",
            "repo"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_head_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1914-1931",
          "snippet": "int git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_ensure_not_dirty",
          "args": [
            "repo",
            "true",
            "true",
            "GIT_ERROR"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_ensure_not_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "517-561",
          "snippet": "static int rebase_ensure_not_dirty(\n\tgit_repository *repo,\n\tbool check_index,\n\tbool check_workdir,\n\tint fail_with)\n{\n\tgit_tree *head = NULL;\n\tgit_index *index = NULL;\n\tgit_diff *diff = NULL;\n\tint error = 0;\n\n\tif (check_index) {\n\t\tif ((error = git_repository_head_tree(&head, repo)) < 0 ||\n\t\t\t(error = git_repository_index(&index, repo)) < 0 ||\n\t\t\t(error = git_diff_tree_to_index(&diff, repo, head, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Uncommitted changes exist in index\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\n\t\tgit_diff_free(diff);\n\t\tdiff = NULL;\n\t}\n\n\tif (check_workdir) {\n\t\tif ((error = git_diff_index_to_workdir(&diff, repo, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Unstaged changes exist in workdir\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\t}\n\ndone:\n\tgit_diff_free(diff);\n\tgit_index_free(index);\n\tgit_tree_free(head);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_ensure_not_dirty(\n\tgit_repository *repo,\n\tbool check_index,\n\tbool check_workdir,\n\tint fail_with)\n{\n\tgit_tree *head = NULL;\n\tgit_index *index = NULL;\n\tgit_diff *diff = NULL;\n\tint error = 0;\n\n\tif (check_index) {\n\t\tif ((error = git_repository_head_tree(&head, repo)) < 0 ||\n\t\t\t(error = git_repository_index(&index, repo)) < 0 ||\n\t\t\t(error = git_diff_tree_to_index(&diff, repo, head, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Uncommitted changes exist in index\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\n\t\tgit_diff_free(diff);\n\t\tdiff = NULL;\n\t}\n\n\tif (check_workdir) {\n\t\tif ((error = git_diff_index_to_workdir(&diff, repo, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Unstaged changes exist in workdir\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\t}\n\ndone:\n\tgit_diff_free(diff);\n\tgit_index_free(index);\n\tgit_tree_free(head);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_ensure_not_in_progress",
          "args": [
            "repo"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_ensure_not_in_progress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "501-515",
          "snippet": "static int rebase_ensure_not_in_progress(git_repository *repo)\n{\n\tint error;\n\tgit_rebase_type_t type;\n\n\tif ((error = rebase_state_type(&type, NULL, repo)) < 0)\n\t\treturn error;\n\n\tif (type != GIT_REBASE_TYPE_NONE) {\n\t\tgiterr_set(GITERR_REBASE, \"There is an existing rebase in progress\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_ensure_not_in_progress(git_repository *repo)\n{\n\tint error;\n\tgit_rebase_type_t type;\n\n\tif ((error = rebase_state_type(&type, NULL, repo)) < 0)\n\t\treturn error;\n\n\tif (type != GIT_REBASE_TYPE_NONE) {\n\t\tgiterr_set(GITERR_REBASE, \"There is an existing rebase in progress\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository__ensure_not_bare",
          "args": [
            "repo",
            "\"rebase\""
          ],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__ensure_not_bare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.h",
          "lines": "176-189",
          "snippet": "GIT_INLINE(int) git_repository__ensure_not_bare(\n\tgit_repository *repo,\n\tconst char *operation_name)\n{\n\tif (!git_repository_is_bare(repo))\n\t\treturn 0;\n\n\tgiterr_set(\n\t\tGITERR_REPOSITORY,\n\t\t\"Cannot %s. This operation is not allowed against bare repositories.\",\n\t\toperation_name);\n\n\treturn GIT_EBAREREPO;\n}",
          "includes": [
            "#include \"diff_driver.h\"",
            "#include \"submodule.h\"",
            "#include \"attrcache.h\"",
            "#include \"object.h\"",
            "#include \"buffer.h\"",
            "#include \"refs.h\"",
            "#include \"cache.h\"",
            "#include \"array.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_driver.h\"\n#include \"submodule.h\"\n#include \"attrcache.h\"\n#include \"object.h\"\n#include \"buffer.h\"\n#include \"refs.h\"\n#include \"cache.h\"\n#include \"array.h\"\n#include \"git2/config.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) git_repository__ensure_not_bare(\n\tgit_repository *repo,\n\tconst char *operation_name)\n{\n\tif (!git_repository_is_bare(repo))\n\t\treturn 0;\n\n\tgiterr_set(\n\t\tGITERR_REPOSITORY,\n\t\t\"Cannot %s. This operation is not allowed against bare repositories.\",\n\t\toperation_name);\n\n\treturn GIT_EBAREREPO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_check_versions",
          "args": [
            "given_opts"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_check_versions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "285-293",
          "snippet": "static int rebase_check_versions(const git_rebase_options *given_opts)\n{\n\tGITERR_CHECK_VERSION(given_opts, GIT_REBASE_OPTIONS_VERSION, \"git_rebase_options\");\n\n\tif (given_opts)\n\t\tGITERR_CHECK_VERSION(&given_opts->checkout_options, GIT_CHECKOUT_OPTIONS_VERSION, \"git_checkout_options\");\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_check_versions(const git_rebase_options *given_opts)\n{\n\tGITERR_CHECK_VERSION(given_opts, GIT_REBASE_OPTIONS_VERSION, \"git_rebase_options\");\n\n\tif (given_opts)\n\t\tGITERR_CHECK_VERSION(&given_opts->checkout_options, GIT_CHECKOUT_OPTIONS_VERSION, \"git_checkout_options\");\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && (upstream || onto)"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nint git_rebase_init(\n\tgit_rebase **out,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto,\n\tconst git_rebase_options *given_opts)\n{\n\tgit_rebase *rebase = NULL;\n\tgit_annotated_commit *head_branch = NULL;\n\tgit_reference *head_ref = NULL;\n\tbool inmemory = (given_opts && given_opts->inmemory);\n\tint error;\n\n\tassert(repo && (upstream || onto));\n\n\t*out = NULL;\n\n\tif (!onto)\n\t\tonto = upstream;\n\n\tif ((error = rebase_check_versions(given_opts)) < 0)\n\t\tgoto done;\n\n\tif (!inmemory) {\n\t\tif ((error = git_repository__ensure_not_bare(repo, \"rebase\")) < 0 ||\n\t\t\t(error = rebase_ensure_not_in_progress(repo)) < 0 ||\n\t\t\t(error = rebase_ensure_not_dirty(repo, true, true, GIT_ERROR)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif (!branch) {\n\t\tif ((error = git_repository_head(&head_ref, repo)) < 0 ||\n\t\t\t(error = git_annotated_commit_from_ref(&head_branch, repo, head_ref)) < 0)\n\t\t\tgoto done;\n\n\t\tbranch = head_branch;\n\t}\n\n\tif (rebase_alloc(&rebase, given_opts) < 0)\n\t\treturn -1;\n\n\trebase->repo = repo;\n\trebase->inmemory = inmemory;\n\trebase->type = GIT_REBASE_TYPE_MERGE;\n\n\tif ((error = rebase_init_operations(rebase, repo, branch, upstream, onto)) < 0)\n\t\tgoto done;\n\n\tif (inmemory)\n\t\terror = rebase_init_inmemory(rebase, repo, branch, upstream, onto);\n\telse\n\t\trebase_init_merge(rebase, repo, branch ,upstream, onto);\n\n\tif (error == 0)\n\t\t*out = rebase;\n\ndone:\n\tgit_reference_free(head_ref);\n\tgit_annotated_commit_free(head_branch);\n\n\tif (error < 0) {\n\t\trebase_cleanup(rebase);\n\t\tgit_rebase_free(rebase);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_init_inmemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "660-672",
    "snippet": "static int rebase_init_inmemory(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tGIT_UNUSED(branch);\n\tGIT_UNUSED(upstream);\n\n\treturn git_commit_lookup(\n\t\t&rebase->last_commit, repo, git_annotated_commit_id(onto));\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "&rebase->last_commit",
            "repo",
            "git_annotated_commit_id(onto)"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_annotated_commit_id",
          "args": [
            "onto"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "git_annotated_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "174-179",
          "snippet": "const git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nconst git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "upstream"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "branch"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_init_inmemory(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tGIT_UNUSED(branch);\n\tGIT_UNUSED(upstream);\n\n\treturn git_commit_lookup(\n\t\t&rebase->last_commit, repo, git_annotated_commit_id(onto));\n}"
  },
  {
    "function_name": "rebase_init_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "608-658",
    "snippet": "static int rebase_init_merge(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tgit_reference *head_ref = NULL;\n\tgit_commit *onto_commit = NULL;\n\tgit_buf reflog = GIT_BUF_INIT;\n\tgit_buf state_path = GIT_BUF_INIT;\n\tint error;\n\n\tGIT_UNUSED(upstream);\n\n\tif ((error = git_buf_joinpath(&state_path, repo->path_repository, REBASE_MERGE_DIR)) < 0)\n\t\tgoto done;\n\n\trebase->state_path = git_buf_detach(&state_path);\n\tGITERR_CHECK_ALLOC(rebase->state_path);\n\n\trebase->orig_head_name = git__strdup(branch->ref_name ? branch->ref_name : ORIG_DETACHED_HEAD);\n\tGITERR_CHECK_ALLOC(rebase->orig_head_name);\n\n\trebase->onto_name = git__strdup(rebase_onto_name(onto));\n\tGITERR_CHECK_ALLOC(rebase->onto_name);\n\n\trebase->quiet = rebase->options.quiet;\n\n\tgit_oid_cpy(&rebase->orig_head_id, git_annotated_commit_id(branch));\n\tgit_oid_cpy(&rebase->onto_id, git_annotated_commit_id(onto));\n\n\tif ((error = rebase_setupfiles(rebase)) < 0 ||\n\t\t(error = git_buf_printf(&reflog,\n\t\t\t\"rebase: checkout %s\", rebase_onto_name(onto))) < 0 ||\n\t\t(error = git_commit_lookup(\n\t\t\t&onto_commit, repo, git_annotated_commit_id(onto))) < 0 ||\n\t\t(error = git_checkout_tree(repo,\n\t\t\t(git_object *)onto_commit, &rebase->options.checkout_options)) < 0 ||\n\t\t(error = git_reference_create(&head_ref, repo, GIT_HEAD_FILE,\n\t\t\tgit_annotated_commit_id(onto), 1, reflog.ptr)) < 0)\n\t\tgoto done;\n\ndone:\n\tgit_reference_free(head_ref);\n\tgit_commit_free(onto_commit);\n\tgit_buf_free(&reflog);\n\tgit_buf_free(&state_path);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define ORIG_DETACHED_HEAD  \"detached HEAD\"",
      "#define REBASE_MERGE_DIR    \"rebase-merge\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&state_path"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "onto_commit"
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "head_ref"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_create",
          "args": [
            "&head_ref",
            "repo",
            "GIT_HEAD_FILE",
            "git_annotated_commit_id(onto)",
            "1",
            "reflog.ptr"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "464-473",
          "snippet": "int git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_annotated_commit_id",
          "args": [
            "onto"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "git_annotated_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "174-179",
          "snippet": "const git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nconst git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_checkout_tree",
          "args": [
            "repo",
            "(git_object *)onto_commit",
            "&rebase->options.checkout_options"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "&onto_commit",
            "repo",
            "git_annotated_commit_id(onto)"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "&reflog",
            "\"rebase: checkout %s\"",
            "rebase_onto_name(onto)"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_onto_name",
          "args": [
            "onto"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_onto_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "432-440",
          "snippet": "static const char *rebase_onto_name(const git_annotated_commit *onto)\n{\n\tif (onto->ref_name && git__strncmp(onto->ref_name, \"refs/heads/\", 11) == 0)\n\t\treturn onto->ref_name + 11;\n\telse if (onto->ref_name)\n\t\treturn onto->ref_name;\n\telse\n\t\treturn onto->id_str;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic const char *rebase_onto_name(const git_annotated_commit *onto)\n{\n\tif (onto->ref_name && git__strncmp(onto->ref_name, \"refs/heads/\", 11) == 0)\n\t\treturn onto->ref_name + 11;\n\telse if (onto->ref_name)\n\t\treturn onto->ref_name;\n\telse\n\t\treturn onto->id_str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_setupfiles",
          "args": [
            "rebase"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_setupfiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "472-492",
          "snippet": "static int rebase_setupfiles(git_rebase *rebase)\n{\n\tchar onto[GIT_OID_HEXSZ], orig_head[GIT_OID_HEXSZ];\n\n\tgit_oid_fmt(onto, &rebase->onto_id);\n\tgit_oid_fmt(orig_head, &rebase->orig_head_id);\n\n\tif (p_mkdir(rebase->state_path, REBASE_DIR_MODE) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to create rebase directory '%s'\", rebase->state_path);\n\t\treturn -1;\n\t}\n\n\tif (git_repository__set_orig_head(rebase->repo, &rebase->orig_head_id) < 0 ||\n\t\trebase_setupfile(rebase, HEAD_NAME_FILE, -1, \"%s\\n\", rebase->orig_head_name) < 0 ||\n\t\trebase_setupfile(rebase, ONTO_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, onto) < 0 ||\n\t\trebase_setupfile(rebase, ORIG_HEAD_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, orig_head) < 0 ||\n\t\trebase_setupfile(rebase, QUIET_FILE, -1, rebase->quiet ? \"t\\n\" : \"\\n\") < 0)\n\t\treturn -1;\n\n\treturn rebase_setupfiles_merge(rebase);\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define REBASE_DIR_MODE     0777",
            "#define QUIET_FILE          \"quiet\"",
            "#define ONTO_FILE           \"onto\"",
            "#define ORIG_HEAD_FILE      \"orig-head\"",
            "#define HEAD_NAME_FILE      \"head-name\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_DIR_MODE     0777\n#define QUIET_FILE          \"quiet\"\n#define ONTO_FILE           \"onto\"\n#define ORIG_HEAD_FILE      \"orig-head\"\n#define HEAD_NAME_FILE      \"head-name\"\n\nstatic int rebase_setupfiles(git_rebase *rebase)\n{\n\tchar onto[GIT_OID_HEXSZ], orig_head[GIT_OID_HEXSZ];\n\n\tgit_oid_fmt(onto, &rebase->onto_id);\n\tgit_oid_fmt(orig_head, &rebase->orig_head_id);\n\n\tif (p_mkdir(rebase->state_path, REBASE_DIR_MODE) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to create rebase directory '%s'\", rebase->state_path);\n\t\treturn -1;\n\t}\n\n\tif (git_repository__set_orig_head(rebase->repo, &rebase->orig_head_id) < 0 ||\n\t\trebase_setupfile(rebase, HEAD_NAME_FILE, -1, \"%s\\n\", rebase->orig_head_name) < 0 ||\n\t\trebase_setupfile(rebase, ONTO_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, onto) < 0 ||\n\t\trebase_setupfile(rebase, ORIG_HEAD_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, orig_head) < 0 ||\n\t\trebase_setupfile(rebase, QUIET_FILE, -1, rebase->quiet ? \"t\\n\" : \"\\n\") < 0)\n\t\treturn -1;\n\n\treturn rebase_setupfiles_merge(rebase);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&rebase->onto_id",
            "git_annotated_commit_id(onto)"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "rebase->onto_name"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "rebase_onto_name(onto)"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "rebase->orig_head_name"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "rebase->state_path"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&state_path"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&state_path",
            "repo->path_repository",
            "REBASE_MERGE_DIR"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "upstream"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define ORIG_DETACHED_HEAD  \"detached HEAD\"\n#define REBASE_MERGE_DIR    \"rebase-merge\"\n\nstatic int rebase_init_merge(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tgit_reference *head_ref = NULL;\n\tgit_commit *onto_commit = NULL;\n\tgit_buf reflog = GIT_BUF_INIT;\n\tgit_buf state_path = GIT_BUF_INIT;\n\tint error;\n\n\tGIT_UNUSED(upstream);\n\n\tif ((error = git_buf_joinpath(&state_path, repo->path_repository, REBASE_MERGE_DIR)) < 0)\n\t\tgoto done;\n\n\trebase->state_path = git_buf_detach(&state_path);\n\tGITERR_CHECK_ALLOC(rebase->state_path);\n\n\trebase->orig_head_name = git__strdup(branch->ref_name ? branch->ref_name : ORIG_DETACHED_HEAD);\n\tGITERR_CHECK_ALLOC(rebase->orig_head_name);\n\n\trebase->onto_name = git__strdup(rebase_onto_name(onto));\n\tGITERR_CHECK_ALLOC(rebase->onto_name);\n\n\trebase->quiet = rebase->options.quiet;\n\n\tgit_oid_cpy(&rebase->orig_head_id, git_annotated_commit_id(branch));\n\tgit_oid_cpy(&rebase->onto_id, git_annotated_commit_id(onto));\n\n\tif ((error = rebase_setupfiles(rebase)) < 0 ||\n\t\t(error = git_buf_printf(&reflog,\n\t\t\t\"rebase: checkout %s\", rebase_onto_name(onto))) < 0 ||\n\t\t(error = git_commit_lookup(\n\t\t\t&onto_commit, repo, git_annotated_commit_id(onto))) < 0 ||\n\t\t(error = git_checkout_tree(repo,\n\t\t\t(git_object *)onto_commit, &rebase->options.checkout_options)) < 0 ||\n\t\t(error = git_reference_create(&head_ref, repo, GIT_HEAD_FILE,\n\t\t\tgit_annotated_commit_id(onto), 1, reflog.ptr)) < 0)\n\t\tgoto done;\n\ndone:\n\tgit_reference_free(head_ref);\n\tgit_commit_free(onto_commit);\n\tgit_buf_free(&reflog);\n\tgit_buf_free(&state_path);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_init_operations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "563-606",
    "snippet": "static int rebase_init_operations(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tgit_revwalk *revwalk = NULL;\n\tgit_commit *commit;\n\tgit_oid id;\n\tbool merge;\n\tgit_rebase_operation *operation;\n\tint error;\n\n\tif (!upstream)\n\t\tupstream = onto;\n\n\tif ((error = git_revwalk_new(&revwalk, rebase->repo)) < 0 ||\n\t\t(error = git_revwalk_push(revwalk, git_annotated_commit_id(branch))) < 0 ||\n\t\t(error = git_revwalk_hide(revwalk, git_annotated_commit_id(upstream))) < 0)\n\t\tgoto done;\n\n\tgit_revwalk_sorting(revwalk, GIT_SORT_REVERSE | GIT_SORT_TIME);\n\n\twhile ((error = git_revwalk_next(&id, revwalk)) == 0) {\n\t\tif ((error = git_commit_lookup(&commit, repo, &id)) < 0)\n\t\t\tgoto done;\n\n\t\tmerge = (git_commit_parentcount(commit) > 1);\n\t\tgit_commit_free(commit);\n\n\t\tif (merge)\n\t\t\tcontinue;\n\n\t\toperation = rebase_operation_alloc(rebase, GIT_REBASE_OPERATION_PICK, &id, NULL);\n\t\tGITERR_CHECK_ALLOC(operation);\n\t}\n\n\terror = 0;\n\ndone:\n\tgit_revwalk_free(revwalk);\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_revwalk_free",
          "args": [
            "revwalk"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "555-567",
          "snippet": "void git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "operation"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rebase_operation_alloc",
          "args": [
            "rebase",
            "GIT_REBASE_OPERATION_PICK",
            "&id",
            "NULL"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_operation_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "180-199",
          "snippet": "static git_rebase_operation *rebase_operation_alloc(\n\tgit_rebase *rebase,\n\tgit_rebase_operation_t type,\n\tgit_oid *id,\n\tconst char *exec)\n{\n\tgit_rebase_operation *operation;\n\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !id);\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !!exec);\n\n\tif ((operation = git_array_alloc(rebase->operations)) == NULL)\n\t\treturn NULL;\n\n\toperation->type = type;\n\tgit_oid_cpy((git_oid *)&operation->id, id);\n\toperation->exec = exec;\n\n\treturn operation;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic git_rebase_operation *rebase_operation_alloc(\n\tgit_rebase *rebase,\n\tgit_rebase_operation_t type,\n\tgit_oid *id,\n\tconst char *exec)\n{\n\tgit_rebase_operation *operation;\n\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !id);\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !!exec);\n\n\tif ((operation = git_array_alloc(rebase->operations)) == NULL)\n\t\treturn NULL;\n\n\toperation->type = type;\n\tgit_oid_cpy((git_oid *)&operation->id, id);\n\toperation->exec = exec;\n\n\treturn operation;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "commit"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_parentcount",
          "args": [
            "commit"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "&commit",
            "repo",
            "&id"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_next",
          "args": [
            "&id",
            "revwalk"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "598-622",
          "snippet": "int git_revwalk_next(git_oid *oid, git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list_node *next;\n\n\tassert(walk && oid);\n\n\tif (!walk->walking) {\n\t\tif ((error = prepare_walk(walk)) < 0)\n\t\t\treturn error;\n\t}\n\n\terror = walk->get_next(&next, walk);\n\n\tif (error == GIT_ITEROVER) {\n\t\tgit_revwalk_reset(walk);\n\t\tgiterr_clear();\n\t\treturn GIT_ITEROVER;\n\t}\n\n\tif (!error)\n\t\tgit_oid_cpy(oid, &next->oid);\n\n\treturn error;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_next(git_oid *oid, git_revwalk *walk)\n{\n\tint error;\n\tgit_commit_list_node *next;\n\n\tassert(walk && oid);\n\n\tif (!walk->walking) {\n\t\tif ((error = prepare_walk(walk)) < 0)\n\t\t\treturn error;\n\t}\n\n\terror = walk->get_next(&next, walk);\n\n\tif (error == GIT_ITEROVER) {\n\t\tgit_revwalk_reset(walk);\n\t\tgiterr_clear();\n\t\treturn GIT_ITEROVER;\n\t}\n\n\tif (!error)\n\t\tgit_oid_cpy(oid, &next->oid);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_sorting",
          "args": [
            "revwalk",
            "GIT_SORT_REVERSE | GIT_SORT_TIME"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_sorting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "575-591",
          "snippet": "void git_revwalk_sorting(git_revwalk *walk, unsigned int sort_mode)\n{\n\tassert(walk);\n\n\tif (walk->walking)\n\t\tgit_revwalk_reset(walk);\n\n\twalk->sorting = sort_mode;\n\n\tif (walk->sorting & GIT_SORT_TIME) {\n\t\twalk->get_next = &revwalk_next_timesort;\n\t\twalk->enqueue = &revwalk_enqueue_timesort;\n\t} else {\n\t\twalk->get_next = &revwalk_next_unsorted;\n\t\twalk->enqueue = &revwalk_enqueue_unsorted;\n\t}\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_sorting(git_revwalk *walk, unsigned int sort_mode)\n{\n\tassert(walk);\n\n\tif (walk->walking)\n\t\tgit_revwalk_reset(walk);\n\n\twalk->sorting = sort_mode;\n\n\tif (walk->sorting & GIT_SORT_TIME) {\n\t\twalk->get_next = &revwalk_next_timesort;\n\t\twalk->enqueue = &revwalk_enqueue_timesort;\n\t} else {\n\t\twalk->get_next = &revwalk_next_unsorted;\n\t\twalk->enqueue = &revwalk_enqueue_unsorted;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_hide",
          "args": [
            "revwalk",
            "git_annotated_commit_id(upstream)"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_hide_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "306-310",
          "snippet": "int git_revwalk_hide_ref(git_revwalk *walk, const char *refname)\n{\n\tassert(walk && refname);\n\treturn push_ref(walk, refname, 1, false);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_hide_ref(git_revwalk *walk, const char *refname)\n{\n\tassert(walk && refname);\n\treturn push_ref(walk, refname, 1, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_annotated_commit_id",
          "args": [
            "upstream"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "git_annotated_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "174-179",
          "snippet": "const git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nconst git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_push",
          "args": [
            "revwalk",
            "git_annotated_commit_id(branch)"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_push_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "281-304",
          "snippet": "int git_revwalk_push_range(git_revwalk *walk, const char *range)\n{\n\tgit_revspec revspec;\n\tint error = 0;\n\n\tif ((error = git_revparse(&revspec, walk->repo, range)))\n\t\treturn error;\n\n\tif (revspec.flags & GIT_REVPARSE_MERGE_BASE) {\n\t\t/* TODO: support \"<commit>...<commit>\" */\n\t\tgiterr_set(GITERR_INVALID, \"Symmetric differences not implemented in revwalk\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif ((error = push_commit(walk, git_object_id(revspec.from), 1, false)))\n\t\tgoto out;\n\n\terror = push_commit(walk, git_object_id(revspec.to), 0, false);\n\nout:\n\tgit_object_free(revspec.from);\n\tgit_object_free(revspec.to);\n\treturn error;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_push_range(git_revwalk *walk, const char *range)\n{\n\tgit_revspec revspec;\n\tint error = 0;\n\n\tif ((error = git_revparse(&revspec, walk->repo, range)))\n\t\treturn error;\n\n\tif (revspec.flags & GIT_REVPARSE_MERGE_BASE) {\n\t\t/* TODO: support \"<commit>...<commit>\" */\n\t\tgiterr_set(GITERR_INVALID, \"Symmetric differences not implemented in revwalk\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif ((error = push_commit(walk, git_object_id(revspec.from), 1, false)))\n\t\tgoto out;\n\n\terror = push_commit(walk, git_object_id(revspec.to), 0, false);\n\nout:\n\tgit_object_free(revspec.from);\n\tgit_object_free(revspec.to);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_new",
          "args": [
            "&revwalk",
            "rebase->repo"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "529-553",
          "snippet": "int git_revwalk_new(git_revwalk **revwalk_out, git_repository *repo)\n{\n\tgit_revwalk *walk = git__calloc(1, sizeof(git_revwalk));\n\tGITERR_CHECK_ALLOC(walk);\n\n\twalk->commits = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(walk->commits);\n\n\tif (git_pqueue_init(&walk->iterator_time, 0, 8, git_commit_list_time_cmp) < 0)\n\t\treturn -1;\n\n\tgit_pool_init(&walk->commit_pool, COMMIT_ALLOC);\n\twalk->get_next = &revwalk_next_unsorted;\n\twalk->enqueue = &revwalk_enqueue_unsorted;\n\n\twalk->repo = repo;\n\n\tif (git_repository_odb(&walk->odb, repo) < 0) {\n\t\tgit_revwalk_free(walk);\n\t\treturn -1;\n\t}\n\n\t*revwalk_out = walk;\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_new(git_revwalk **revwalk_out, git_repository *repo)\n{\n\tgit_revwalk *walk = git__calloc(1, sizeof(git_revwalk));\n\tGITERR_CHECK_ALLOC(walk);\n\n\twalk->commits = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(walk->commits);\n\n\tif (git_pqueue_init(&walk->iterator_time, 0, 8, git_commit_list_time_cmp) < 0)\n\t\treturn -1;\n\n\tgit_pool_init(&walk->commit_pool, COMMIT_ALLOC);\n\twalk->get_next = &revwalk_next_unsorted;\n\twalk->enqueue = &revwalk_enqueue_unsorted;\n\n\twalk->repo = repo;\n\n\tif (git_repository_odb(&walk->odb, repo) < 0) {\n\t\tgit_revwalk_free(walk);\n\t\treturn -1;\n\t}\n\n\t*revwalk_out = walk;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_init_operations(\n\tgit_rebase *rebase,\n\tgit_repository *repo,\n\tconst git_annotated_commit *branch,\n\tconst git_annotated_commit *upstream,\n\tconst git_annotated_commit *onto)\n{\n\tgit_revwalk *revwalk = NULL;\n\tgit_commit *commit;\n\tgit_oid id;\n\tbool merge;\n\tgit_rebase_operation *operation;\n\tint error;\n\n\tif (!upstream)\n\t\tupstream = onto;\n\n\tif ((error = git_revwalk_new(&revwalk, rebase->repo)) < 0 ||\n\t\t(error = git_revwalk_push(revwalk, git_annotated_commit_id(branch))) < 0 ||\n\t\t(error = git_revwalk_hide(revwalk, git_annotated_commit_id(upstream))) < 0)\n\t\tgoto done;\n\n\tgit_revwalk_sorting(revwalk, GIT_SORT_REVERSE | GIT_SORT_TIME);\n\n\twhile ((error = git_revwalk_next(&id, revwalk)) == 0) {\n\t\tif ((error = git_commit_lookup(&commit, repo, &id)) < 0)\n\t\t\tgoto done;\n\n\t\tmerge = (git_commit_parentcount(commit) > 1);\n\t\tgit_commit_free(commit);\n\n\t\tif (merge)\n\t\t\tcontinue;\n\n\t\toperation = rebase_operation_alloc(rebase, GIT_REBASE_OPERATION_PICK, &id, NULL);\n\t\tGITERR_CHECK_ALLOC(operation);\n\t}\n\n\terror = 0;\n\ndone:\n\tgit_revwalk_free(revwalk);\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_ensure_not_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "517-561",
    "snippet": "static int rebase_ensure_not_dirty(\n\tgit_repository *repo,\n\tbool check_index,\n\tbool check_workdir,\n\tint fail_with)\n{\n\tgit_tree *head = NULL;\n\tgit_index *index = NULL;\n\tgit_diff *diff = NULL;\n\tint error = 0;\n\n\tif (check_index) {\n\t\tif ((error = git_repository_head_tree(&head, repo)) < 0 ||\n\t\t\t(error = git_repository_index(&index, repo)) < 0 ||\n\t\t\t(error = git_diff_tree_to_index(&diff, repo, head, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Uncommitted changes exist in index\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\n\t\tgit_diff_free(diff);\n\t\tdiff = NULL;\n\t}\n\n\tif (check_workdir) {\n\t\tif ((error = git_diff_index_to_workdir(&diff, repo, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Unstaged changes exist in workdir\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\t}\n\ndone:\n\tgit_diff_free(diff);\n\tgit_index_free(index);\n\tgit_tree_free(head);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "head"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_free",
          "args": [
            "index"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "477-483",
          "snippet": "void git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nvoid git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_free",
          "args": [
            "diff"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "576-582",
          "snippet": "void git_diff_free(git_diff *diff)\n{\n\tif (!diff)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(diff, diff_list_free);\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nvoid git_diff_free(git_diff *diff)\n{\n\tif (!diff)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(diff, diff_list_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REBASE",
            "\"Unstaged changes exist in workdir\""
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_num_deltas",
          "args": [
            "diff"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_num_deltas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "1486-1490",
          "snippet": "size_t git_diff_num_deltas(const git_diff *diff)\n{\n\tassert(diff);\n\treturn diff->deltas.length;\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nsize_t git_diff_num_deltas(const git_diff *diff)\n{\n\tassert(diff);\n\treturn diff->deltas.length;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_index_to_workdir",
          "args": [
            "&diff",
            "repo",
            "index",
            "NULL"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_index_to_workdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "1384-1409",
          "snippet": "int git_diff_index_to_workdir(\n\tgit_diff **diff,\n\tgit_repository *repo,\n\tgit_index *index,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\n\tassert(diff && repo);\n\n\tif (!index && (error = diff_load_index(&index, repo)) < 0)\n\t\treturn error;\n\n\tDIFF_FROM_ITERATORS(\n\t\tgit_iterator_for_index(&a, repo, index, &a_opts),\n\t\tGIT_ITERATOR_INCLUDE_CONFLICTS,\n\n\t\tgit_iterator_for_workdir(&b, repo, index, NULL, &b_opts),\n\t\tGIT_ITERATOR_DONT_AUTOEXPAND\n\t);\n\n\tif (!error && DIFF_FLAG_IS_SET(*diff, GIT_DIFF_UPDATE_INDEX) && (*diff)->index_updated)\n\t\terror = git_index_write(index);\n\n\treturn error;\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_diff_index_to_workdir(\n\tgit_diff **diff,\n\tgit_repository *repo,\n\tgit_index *index,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\n\tassert(diff && repo);\n\n\tif (!index && (error = diff_load_index(&index, repo)) < 0)\n\t\treturn error;\n\n\tDIFF_FROM_ITERATORS(\n\t\tgit_iterator_for_index(&a, repo, index, &a_opts),\n\t\tGIT_ITERATOR_INCLUDE_CONFLICTS,\n\n\t\tgit_iterator_for_workdir(&b, repo, index, NULL, &b_opts),\n\t\tGIT_ITERATOR_DONT_AUTOEXPAND\n\t);\n\n\tif (!error && DIFF_FLAG_IS_SET(*diff, GIT_DIFF_UPDATE_INDEX) && (*diff)->index_updated)\n\t\terror = git_index_write(index);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_tree_to_index",
          "args": [
            "&diff",
            "repo",
            "head",
            "index",
            "NULL"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_tree_to_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "1353-1382",
          "snippet": "int git_diff_tree_to_index(\n\tgit_diff **diff,\n\tgit_repository *repo,\n\tgit_tree *old_tree,\n\tgit_index *index,\n\tconst git_diff_options *opts)\n{\n\tgit_iterator_flag_t iflag = GIT_ITERATOR_DONT_IGNORE_CASE |\n\t\tGIT_ITERATOR_INCLUDE_CONFLICTS;\n\tbool index_ignore_case = false;\n\tint error = 0;\n\n\tassert(diff && repo);\n\n\tif (!index && (error = diff_load_index(&index, repo)) < 0)\n\t\treturn error;\n\n\tindex_ignore_case = index->ignore_case;\n\n\tDIFF_FROM_ITERATORS(\n\t\tgit_iterator_for_tree(&a, old_tree, &a_opts), iflag,\n\t\tgit_iterator_for_index(&b, repo, index, &b_opts), iflag\n\t);\n\n\t/* if index is in case-insensitive order, re-sort deltas to match */\n\tif (!error && index_ignore_case)\n\t\tdiff_set_ignore_case(*diff, true);\n\n\treturn error;\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_diff_tree_to_index(\n\tgit_diff **diff,\n\tgit_repository *repo,\n\tgit_tree *old_tree,\n\tgit_index *index,\n\tconst git_diff_options *opts)\n{\n\tgit_iterator_flag_t iflag = GIT_ITERATOR_DONT_IGNORE_CASE |\n\t\tGIT_ITERATOR_INCLUDE_CONFLICTS;\n\tbool index_ignore_case = false;\n\tint error = 0;\n\n\tassert(diff && repo);\n\n\tif (!index && (error = diff_load_index(&index, repo)) < 0)\n\t\treturn error;\n\n\tindex_ignore_case = index->ignore_case;\n\n\tDIFF_FROM_ITERATORS(\n\t\tgit_iterator_for_tree(&a, old_tree, &a_opts), iflag,\n\t\tgit_iterator_for_index(&b, repo, index, &b_opts), iflag\n\t);\n\n\t/* if index is in case-insensitive order, re-sort deltas to match */\n\tif (!error && index_ignore_case)\n\t\tdiff_set_ignore_case(*diff, true);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_index",
          "args": [
            "&index",
            "repo"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "852-859",
          "snippet": "int git_repository_index(git_index **out, git_repository *repo)\n{\n\tif (git_repository_index__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_index(git_index **out, git_repository *repo)\n{\n\tif (git_repository_index__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_head_tree",
          "args": [
            "&head",
            "repo"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_head_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1914-1931",
          "snippet": "int git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_ensure_not_dirty(\n\tgit_repository *repo,\n\tbool check_index,\n\tbool check_workdir,\n\tint fail_with)\n{\n\tgit_tree *head = NULL;\n\tgit_index *index = NULL;\n\tgit_diff *diff = NULL;\n\tint error = 0;\n\n\tif (check_index) {\n\t\tif ((error = git_repository_head_tree(&head, repo)) < 0 ||\n\t\t\t(error = git_repository_index(&index, repo)) < 0 ||\n\t\t\t(error = git_diff_tree_to_index(&diff, repo, head, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Uncommitted changes exist in index\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\n\t\tgit_diff_free(diff);\n\t\tdiff = NULL;\n\t}\n\n\tif (check_workdir) {\n\t\tif ((error = git_diff_index_to_workdir(&diff, repo, index, NULL)) < 0)\n\t\t\tgoto done;\n\n\t\tif (git_diff_num_deltas(diff) > 0) {\n\t\t\tgiterr_set(GITERR_REBASE, \"Unstaged changes exist in workdir\");\n\t\t\terror = fail_with;\n\t\t\tgoto done;\n\t\t}\n\t}\n\ndone:\n\tgit_diff_free(diff);\n\tgit_index_free(index);\n\tgit_tree_free(head);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_ensure_not_in_progress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "501-515",
    "snippet": "static int rebase_ensure_not_in_progress(git_repository *repo)\n{\n\tint error;\n\tgit_rebase_type_t type;\n\n\tif ((error = rebase_state_type(&type, NULL, repo)) < 0)\n\t\treturn error;\n\n\tif (type != GIT_REBASE_TYPE_NONE) {\n\t\tgiterr_set(GITERR_REBASE, \"There is an existing rebase in progress\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REBASE",
            "\"There is an existing rebase in progress\""
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_state_type",
          "args": [
            "&type",
            "NULL",
            "repo"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_state_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "87-121",
          "snippet": "static int rebase_state_type(\n\tgit_rebase_type_t *type_out,\n\tchar **path_out,\n\tgit_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_rebase_type_t type = GIT_REBASE_TYPE_NONE;\n\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_APPLY_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_APPLY;\n\t\tgoto done;\n\t}\n\n\tgit_buf_clear(&path);\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_MERGE_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_MERGE;\n\t\tgoto done;\n\t}\n\ndone:\n\t*type_out = type;\n\n\tif (type != GIT_REBASE_TYPE_NONE && path_out)\n\t\t*path_out = git_buf_detach(&path);\n\n\tgit_buf_free(&path);\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define REBASE_MERGE_DIR    \"rebase-merge\"",
            "#define REBASE_APPLY_DIR    \"rebase-apply\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_MERGE_DIR    \"rebase-merge\"\n#define REBASE_APPLY_DIR    \"rebase-apply\"\n\nstatic int rebase_state_type(\n\tgit_rebase_type_t *type_out,\n\tchar **path_out,\n\tgit_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_rebase_type_t type = GIT_REBASE_TYPE_NONE;\n\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_APPLY_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_APPLY;\n\t\tgoto done;\n\t}\n\n\tgit_buf_clear(&path);\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_MERGE_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_MERGE;\n\t\tgoto done;\n\t}\n\ndone:\n\t*type_out = type;\n\n\tif (type != GIT_REBASE_TYPE_NONE && path_out)\n\t\t*path_out = git_buf_detach(&path);\n\n\tgit_buf_free(&path);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_ensure_not_in_progress(git_repository *repo)\n{\n\tint error;\n\tgit_rebase_type_t type;\n\n\tif ((error = rebase_state_type(&type, NULL, repo)) < 0)\n\t\treturn error;\n\n\tif (type != GIT_REBASE_TYPE_NONE) {\n\t\tgiterr_set(GITERR_REBASE, \"There is an existing rebase in progress\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_rebase_init_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "494-499",
    "snippet": "int git_rebase_init_options(git_rebase_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_rebase_options, GIT_REBASE_OPTIONS_INIT);\n\treturn 0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_INIT_STRUCTURE_FROM_TEMPLATE",
          "args": [
            "opts",
            "version",
            "git_rebase_options",
            "GIT_REBASE_OPTIONS_INIT"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nint git_rebase_init_options(git_rebase_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_rebase_options, GIT_REBASE_OPTIONS_INIT);\n\treturn 0;\n}"
  },
  {
    "function_name": "rebase_setupfiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "472-492",
    "snippet": "static int rebase_setupfiles(git_rebase *rebase)\n{\n\tchar onto[GIT_OID_HEXSZ], orig_head[GIT_OID_HEXSZ];\n\n\tgit_oid_fmt(onto, &rebase->onto_id);\n\tgit_oid_fmt(orig_head, &rebase->orig_head_id);\n\n\tif (p_mkdir(rebase->state_path, REBASE_DIR_MODE) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to create rebase directory '%s'\", rebase->state_path);\n\t\treturn -1;\n\t}\n\n\tif (git_repository__set_orig_head(rebase->repo, &rebase->orig_head_id) < 0 ||\n\t\trebase_setupfile(rebase, HEAD_NAME_FILE, -1, \"%s\\n\", rebase->orig_head_name) < 0 ||\n\t\trebase_setupfile(rebase, ONTO_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, onto) < 0 ||\n\t\trebase_setupfile(rebase, ORIG_HEAD_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, orig_head) < 0 ||\n\t\trebase_setupfile(rebase, QUIET_FILE, -1, rebase->quiet ? \"t\\n\" : \"\\n\") < 0)\n\t\treturn -1;\n\n\treturn rebase_setupfiles_merge(rebase);\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define REBASE_DIR_MODE     0777",
      "#define QUIET_FILE          \"quiet\"",
      "#define ONTO_FILE           \"onto\"",
      "#define ORIG_HEAD_FILE      \"orig-head\"",
      "#define HEAD_NAME_FILE      \"head-name\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rebase_setupfiles_merge",
          "args": [
            "rebase"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_setupfiles_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "442-470",
          "snippet": "static int rebase_setupfiles_merge(git_rebase *rebase)\n{\n\tgit_buf commit_filename = GIT_BUF_INIT;\n\tchar id_str[GIT_OID_HEXSZ];\n\tgit_rebase_operation *operation;\n\tsize_t i;\n\tint error = 0;\n\n\tif ((error = rebase_setupfile(rebase, END_FILE, -1, \"%\" PRIuZ \"\\n\", git_array_size(rebase->operations))) < 0 ||\n\t\t(error = rebase_setupfile(rebase, ONTO_NAME_FILE, -1, \"%s\\n\", rebase->onto_name)) < 0)\n\t\tgoto done;\n\n\tfor (i = 0; i < git_array_size(rebase->operations); i++) {\n\t\toperation = git_array_get(rebase->operations, i);\n\n\t\tgit_buf_clear(&commit_filename);\n\t\tgit_buf_printf(&commit_filename, CMT_FILE_FMT, i+1);\n\n\t\tgit_oid_fmt(id_str, &operation->id);\n\n\t\tif ((error = rebase_setupfile(rebase, commit_filename.ptr, -1,\n\t\t\t\t\"%.*s\\n\", GIT_OID_HEXSZ, id_str)) < 0)\n\t\t\tgoto done;\n\t}\n\ndone:\n\tgit_buf_free(&commit_filename);\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define CMT_FILE_FMT        \"cmt.%\" PRIuZ",
            "#define END_FILE            \"end\"",
            "#define ONTO_NAME_FILE      \"onto_name\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define CMT_FILE_FMT        \"cmt.%\" PRIuZ\n#define END_FILE            \"end\"\n#define ONTO_NAME_FILE      \"onto_name\"\n\nstatic int rebase_setupfiles_merge(git_rebase *rebase)\n{\n\tgit_buf commit_filename = GIT_BUF_INIT;\n\tchar id_str[GIT_OID_HEXSZ];\n\tgit_rebase_operation *operation;\n\tsize_t i;\n\tint error = 0;\n\n\tif ((error = rebase_setupfile(rebase, END_FILE, -1, \"%\" PRIuZ \"\\n\", git_array_size(rebase->operations))) < 0 ||\n\t\t(error = rebase_setupfile(rebase, ONTO_NAME_FILE, -1, \"%s\\n\", rebase->onto_name)) < 0)\n\t\tgoto done;\n\n\tfor (i = 0; i < git_array_size(rebase->operations); i++) {\n\t\toperation = git_array_get(rebase->operations, i);\n\n\t\tgit_buf_clear(&commit_filename);\n\t\tgit_buf_printf(&commit_filename, CMT_FILE_FMT, i+1);\n\n\t\tgit_oid_fmt(id_str, &operation->id);\n\n\t\tif ((error = rebase_setupfile(rebase, commit_filename.ptr, -1,\n\t\t\t\t\"%.*s\\n\", GIT_OID_HEXSZ, id_str)) < 0)\n\t\t\tgoto done;\n\t}\n\ndone:\n\tgit_buf_free(&commit_filename);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_setupfile",
          "args": [
            "rebase",
            "QUIET_FILE",
            "-1",
            "rebase->quiet ? \"t\\n\" : \"\\n\""
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_setupfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "412-430",
          "snippet": "static int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define REBASE_FILE_MODE    0666"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_FILE_MODE    0666\n\nstatic int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository__set_orig_head",
          "args": [
            "rebase->repo",
            "&rebase->orig_head_id"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__set_orig_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1933-1953",
          "snippet": "int git_repository__set_orig_head(git_repository *repo, const git_oid *orig_head)\n{\n\tgit_filebuf file = GIT_FILEBUF_INIT;\n\tgit_buf file_path = GIT_BUF_INIT;\n\tchar orig_head_str[GIT_OID_HEXSZ];\n\tint error = 0;\n\n\tgit_oid_fmt(orig_head_str, orig_head);\n\n\tif ((error = git_buf_joinpath(&file_path, repo->path_repository, GIT_ORIG_HEAD_FILE)) == 0 &&\n\t\t(error = git_filebuf_open(&file, file_path.ptr, GIT_FILEBUF_FORCE, GIT_MERGE_FILE_MODE)) == 0 &&\n\t\t(error = git_filebuf_printf(&file, \"%.*s\\n\", GIT_OID_HEXSZ, orig_head_str)) == 0)\n\t\terror = git_filebuf_commit(&file);\n\n\tif (error < 0)\n\t\tgit_filebuf_cleanup(&file);\n\n\tgit_buf_free(&file_path);\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository__set_orig_head(git_repository *repo, const git_oid *orig_head)\n{\n\tgit_filebuf file = GIT_FILEBUF_INIT;\n\tgit_buf file_path = GIT_BUF_INIT;\n\tchar orig_head_str[GIT_OID_HEXSZ];\n\tint error = 0;\n\n\tgit_oid_fmt(orig_head_str, orig_head);\n\n\tif ((error = git_buf_joinpath(&file_path, repo->path_repository, GIT_ORIG_HEAD_FILE)) == 0 &&\n\t\t(error = git_filebuf_open(&file, file_path.ptr, GIT_FILEBUF_FORCE, GIT_MERGE_FILE_MODE)) == 0 &&\n\t\t(error = git_filebuf_printf(&file, \"%.*s\\n\", GIT_OID_HEXSZ, orig_head_str)) == 0)\n\t\terror = git_filebuf_commit(&file);\n\n\tif (error < 0)\n\t\tgit_filebuf_cleanup(&file);\n\n\tgit_buf_free(&file_path);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Failed to create rebase directory '%s'\"",
            "rebase->state_path"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_mkdir",
          "args": [
            "rebase->state_path",
            "REBASE_DIR_MODE"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "p_mkdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "72-82",
          "snippet": "int p_mkdir(const char *path, mode_t mode)\n{\n\tgit_win32_path buf;\n\n\tGIT_UNUSED(mode);\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\treturn _wmkdir(buf);\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_mkdir(const char *path, mode_t mode)\n{\n\tgit_win32_path buf;\n\n\tGIT_UNUSED(mode);\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\treturn _wmkdir(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "orig_head",
            "&rebase->orig_head_id"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_DIR_MODE     0777\n#define QUIET_FILE          \"quiet\"\n#define ONTO_FILE           \"onto\"\n#define ORIG_HEAD_FILE      \"orig-head\"\n#define HEAD_NAME_FILE      \"head-name\"\n\nstatic int rebase_setupfiles(git_rebase *rebase)\n{\n\tchar onto[GIT_OID_HEXSZ], orig_head[GIT_OID_HEXSZ];\n\n\tgit_oid_fmt(onto, &rebase->onto_id);\n\tgit_oid_fmt(orig_head, &rebase->orig_head_id);\n\n\tif (p_mkdir(rebase->state_path, REBASE_DIR_MODE) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to create rebase directory '%s'\", rebase->state_path);\n\t\treturn -1;\n\t}\n\n\tif (git_repository__set_orig_head(rebase->repo, &rebase->orig_head_id) < 0 ||\n\t\trebase_setupfile(rebase, HEAD_NAME_FILE, -1, \"%s\\n\", rebase->orig_head_name) < 0 ||\n\t\trebase_setupfile(rebase, ONTO_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, onto) < 0 ||\n\t\trebase_setupfile(rebase, ORIG_HEAD_FILE, -1, \"%.*s\\n\", GIT_OID_HEXSZ, orig_head) < 0 ||\n\t\trebase_setupfile(rebase, QUIET_FILE, -1, rebase->quiet ? \"t\\n\" : \"\\n\") < 0)\n\t\treturn -1;\n\n\treturn rebase_setupfiles_merge(rebase);\n}"
  },
  {
    "function_name": "rebase_setupfiles_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "442-470",
    "snippet": "static int rebase_setupfiles_merge(git_rebase *rebase)\n{\n\tgit_buf commit_filename = GIT_BUF_INIT;\n\tchar id_str[GIT_OID_HEXSZ];\n\tgit_rebase_operation *operation;\n\tsize_t i;\n\tint error = 0;\n\n\tif ((error = rebase_setupfile(rebase, END_FILE, -1, \"%\" PRIuZ \"\\n\", git_array_size(rebase->operations))) < 0 ||\n\t\t(error = rebase_setupfile(rebase, ONTO_NAME_FILE, -1, \"%s\\n\", rebase->onto_name)) < 0)\n\t\tgoto done;\n\n\tfor (i = 0; i < git_array_size(rebase->operations); i++) {\n\t\toperation = git_array_get(rebase->operations, i);\n\n\t\tgit_buf_clear(&commit_filename);\n\t\tgit_buf_printf(&commit_filename, CMT_FILE_FMT, i+1);\n\n\t\tgit_oid_fmt(id_str, &operation->id);\n\n\t\tif ((error = rebase_setupfile(rebase, commit_filename.ptr, -1,\n\t\t\t\t\"%.*s\\n\", GIT_OID_HEXSZ, id_str)) < 0)\n\t\t\tgoto done;\n\t}\n\ndone:\n\tgit_buf_free(&commit_filename);\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define CMT_FILE_FMT        \"cmt.%\" PRIuZ",
      "#define END_FILE            \"end\"",
      "#define ONTO_NAME_FILE      \"onto_name\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&commit_filename"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_setupfile",
          "args": [
            "rebase",
            "commit_filename.ptr",
            "-1",
            "\"%.*s\\n\"",
            "GIT_OID_HEXSZ",
            "id_str"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_setupfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "412-430",
          "snippet": "static int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define REBASE_FILE_MODE    0666"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_FILE_MODE    0666\n\nstatic int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "id_str",
            "&operation->id"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "&commit_filename",
            "CMT_FILE_FMT",
            "i+1"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "&commit_filename"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "rebase->operations",
            "i"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "rebase->operations"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "rebase->operations"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define CMT_FILE_FMT        \"cmt.%\" PRIuZ\n#define END_FILE            \"end\"\n#define ONTO_NAME_FILE      \"onto_name\"\n\nstatic int rebase_setupfiles_merge(git_rebase *rebase)\n{\n\tgit_buf commit_filename = GIT_BUF_INIT;\n\tchar id_str[GIT_OID_HEXSZ];\n\tgit_rebase_operation *operation;\n\tsize_t i;\n\tint error = 0;\n\n\tif ((error = rebase_setupfile(rebase, END_FILE, -1, \"%\" PRIuZ \"\\n\", git_array_size(rebase->operations))) < 0 ||\n\t\t(error = rebase_setupfile(rebase, ONTO_NAME_FILE, -1, \"%s\\n\", rebase->onto_name)) < 0)\n\t\tgoto done;\n\n\tfor (i = 0; i < git_array_size(rebase->operations); i++) {\n\t\toperation = git_array_get(rebase->operations, i);\n\n\t\tgit_buf_clear(&commit_filename);\n\t\tgit_buf_printf(&commit_filename, CMT_FILE_FMT, i+1);\n\n\t\tgit_oid_fmt(id_str, &operation->id);\n\n\t\tif ((error = rebase_setupfile(rebase, commit_filename.ptr, -1,\n\t\t\t\t\"%.*s\\n\", GIT_OID_HEXSZ, id_str)) < 0)\n\t\t\tgoto done;\n\t}\n\ndone:\n\tgit_buf_free(&commit_filename);\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_onto_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "432-440",
    "snippet": "static const char *rebase_onto_name(const git_annotated_commit *onto)\n{\n\tif (onto->ref_name && git__strncmp(onto->ref_name, \"refs/heads/\", 11) == 0)\n\t\treturn onto->ref_name + 11;\n\telse if (onto->ref_name)\n\t\treturn onto->ref_name;\n\telse\n\t\treturn onto->id_str;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__strncmp",
          "args": [
            "onto->ref_name",
            "\"refs/heads/\"",
            "11"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "git__strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "205-212",
          "snippet": "int git__strncmp(const char *a, const char *b, size_t sz)\n{\n\twhile (sz && *a && *b && *a == *b)\n\t\t--sz, ++a, ++b;\n\tif (!sz)\n\t\treturn 0;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strncmp(const char *a, const char *b, size_t sz)\n{\n\twhile (sz && *a && *b && *a == *b)\n\t\t--sz, ++a, ++b;\n\tif (!sz)\n\t\treturn 0;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic const char *rebase_onto_name(const git_annotated_commit *onto)\n{\n\tif (onto->ref_name && git__strncmp(onto->ref_name, \"refs/heads/\", 11) == 0)\n\t\treturn onto->ref_name + 11;\n\telse if (onto->ref_name)\n\t\treturn onto->ref_name;\n\telse\n\t\treturn onto->id_str;\n}"
  },
  {
    "function_name": "rebase_setupfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "412-430",
    "snippet": "static int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define REBASE_FILE_MODE    0666"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&contents"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_writebuffer",
          "args": [
            "&contents",
            "path.ptr",
            "flags",
            "REBASE_FILE_MODE"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_writebuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "229-254",
          "snippet": "int git_futils_writebuffer(\n\tconst git_buf *buf,\tconst char *path, int flags, mode_t mode)\n{\n\tint fd, error = 0;\n\n\tif (flags <= 0)\n\t\tflags = O_CREAT | O_TRUNC | O_WRONLY;\n\tif (!mode)\n\t\tmode = GIT_FILEMODE_BLOB;\n\n\tif ((fd = p_open(path, flags, mode)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Could not open '%s' for writing\", path);\n\t\treturn fd;\n\t}\n\n\tif ((error = p_write(fd, git_buf_cstr(buf), git_buf_len(buf))) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Could not write to '%s'\", path);\n\t\t(void)p_close(fd);\n\t\treturn error;\n\t}\n\n\tif ((error = p_close(fd)) < 0)\n\t\tgiterr_set(GITERR_OS, \"Error while closing '%s'\", path);\n\n\treturn error;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_writebuffer(\n\tconst git_buf *buf,\tconst char *path, int flags, mode_t mode)\n{\n\tint fd, error = 0;\n\n\tif (flags <= 0)\n\t\tflags = O_CREAT | O_TRUNC | O_WRONLY;\n\tif (!mode)\n\t\tmode = GIT_FILEMODE_BLOB;\n\n\tif ((fd = p_open(path, flags, mode)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Could not open '%s' for writing\", path);\n\t\treturn fd;\n\t}\n\n\tif ((error = p_write(fd, git_buf_cstr(buf), git_buf_len(buf))) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Could not write to '%s'\", path);\n\t\t(void)p_close(fd);\n\t\treturn error;\n\t}\n\n\tif ((error = p_close(fd)) < 0)\n\t\tgiterr_set(GITERR_OS, \"Error while closing '%s'\", path);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "rebase->state_path",
            "filename"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_vprintf",
          "args": [
            "&contents",
            "fmt",
            "ap"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "366-404",
          "snippet": "int git_buf_vprintf(git_buf *buf, const char *format, va_list ap)\n{\n\tsize_t expected_size, new_size;\n\tint len;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&expected_size, strlen(format), 2);\n\tGITERR_CHECK_ALLOC_ADD(&expected_size, expected_size, buf->size);\n\tENSURE_SIZE(buf, expected_size);\n\n\twhile (1) {\n\t\tva_list args;\n\t\tva_copy(args, ap);\n\n\t\tlen = p_vsnprintf(\n\t\t\tbuf->ptr + buf->size,\n\t\t\tbuf->asize - buf->size,\n\t\t\tformat, args\n\t\t);\n\n\t\tva_end(args);\n\n\t\tif (len < 0) {\n\t\t\tgit__free(buf->ptr);\n\t\t\tbuf->ptr = git_buf__oom;\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((size_t)len + 1 <= buf->asize - buf->size) {\n\t\t\tbuf->size += len;\n\t\t\tbreak;\n\t\t}\n\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nint git_buf_vprintf(git_buf *buf, const char *format, va_list ap)\n{\n\tsize_t expected_size, new_size;\n\tint len;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&expected_size, strlen(format), 2);\n\tGITERR_CHECK_ALLOC_ADD(&expected_size, expected_size, buf->size);\n\tENSURE_SIZE(buf, expected_size);\n\n\twhile (1) {\n\t\tva_list args;\n\t\tva_copy(args, ap);\n\n\t\tlen = p_vsnprintf(\n\t\t\tbuf->ptr + buf->size,\n\t\t\tbuf->asize - buf->size,\n\t\t\tformat, args\n\t\t);\n\n\t\tva_end(args);\n\n\t\tif (len < 0) {\n\t\t\tgit__free(buf->ptr);\n\t\t\tbuf->ptr = git_buf__oom;\n\t\t\treturn -1;\n\t\t}\n\n\t\tif ((size_t)len + 1 <= buf->asize - buf->size) {\n\t\t\tbuf->size += len;\n\t\t\tbreak;\n\t\t}\n\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "fmt"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_FILE_MODE    0666\n\nstatic int rebase_setupfile(git_rebase *rebase, const char *filename, int flags, const char *fmt, ...)\n{\n\tgit_buf path = GIT_BUF_INIT,\n\t\tcontents = GIT_BUF_INIT;\n\tva_list ap;\n\tint error;\n\n\tva_start(ap, fmt);\n\tgit_buf_vprintf(&contents, fmt, ap);\n\tva_end(ap);\n\n\tif ((error = git_buf_joinpath(&path, rebase->state_path, filename)) == 0)\n\t\terror = git_futils_writebuffer(&contents, path.ptr, flags, REBASE_FILE_MODE);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&contents);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "402-410",
    "snippet": "static int rebase_cleanup(git_rebase *rebase)\n{\n\tif (!rebase || rebase->inmemory)\n\t\treturn 0;\n\n\treturn git_path_isdir(rebase->state_path) ?\n\t\tgit_futils_rmdir_r(rebase->state_path, NULL, GIT_RMDIR_REMOVE_FILES) :\n\t\t0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_futils_rmdir_r",
          "args": [
            "rebase->state_path",
            "NULL",
            "GIT_RMDIR_REMOVE_FILES"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_rmdir_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "753-784",
          "snippet": "int git_futils_rmdir_r(\n\tconst char *path, const char *base, uint32_t flags)\n{\n\tint error;\n\tgit_buf fullpath = GIT_BUF_INIT;\n\tfutils__rmdir_data data;\n\n\t/* build path and find \"root\" where we should start calling mkdir */\n\tif (git_path_join_unrooted(&fullpath, path, base, NULL) < 0)\n\t\treturn -1;\n\n\tmemset(&data, 0, sizeof(data));\n\tdata.base    = base ? base : \"\";\n\tdata.baselen = base ? strlen(base) : 0;\n\tdata.flags   = flags;\n\n\terror = futils__rmdir_recurs_foreach(&data, &fullpath);\n\n\t/* remove now-empty parents if requested */\n\tif (!error && (flags & GIT_RMDIR_EMPTY_PARENTS) != 0)\n\t\terror = git_path_walk_up(\n\t\t\t&fullpath, base, futils__rmdir_empty_parent, &data);\n\n\tif (error == GIT_ITEROVER) {\n\t\tgiterr_clear();\n\t\terror = 0;\n\t}\n\n\tgit_buf_free(&fullpath);\n\n\treturn error;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_rmdir_r(\n\tconst char *path, const char *base, uint32_t flags)\n{\n\tint error;\n\tgit_buf fullpath = GIT_BUF_INIT;\n\tfutils__rmdir_data data;\n\n\t/* build path and find \"root\" where we should start calling mkdir */\n\tif (git_path_join_unrooted(&fullpath, path, base, NULL) < 0)\n\t\treturn -1;\n\n\tmemset(&data, 0, sizeof(data));\n\tdata.base    = base ? base : \"\";\n\tdata.baselen = base ? strlen(base) : 0;\n\tdata.flags   = flags;\n\n\terror = futils__rmdir_recurs_foreach(&data, &fullpath);\n\n\t/* remove now-empty parents if requested */\n\tif (!error && (flags & GIT_RMDIR_EMPTY_PARENTS) != 0)\n\t\terror = git_path_walk_up(\n\t\t\t&fullpath, base, futils__rmdir_empty_parent, &data);\n\n\tif (error == GIT_ITEROVER) {\n\t\tgiterr_clear();\n\t\terror = 0;\n\t}\n\n\tgit_buf_free(&fullpath);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_isdir",
          "args": [
            "rebase->state_path"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_isdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "509-516",
          "snippet": "bool git_path_isdir(const char *path)\n{\n\tstruct stat st;\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISDIR(st.st_mode) != 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_isdir(const char *path)\n{\n\tstruct stat st;\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISDIR(st.st_mode) != 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_cleanup(git_rebase *rebase)\n{\n\tif (!rebase || rebase->inmemory)\n\t\treturn 0;\n\n\treturn git_path_isdir(rebase->state_path) ?\n\t\tgit_futils_rmdir_r(rebase->state_path, NULL, GIT_RMDIR_REMOVE_FILES) :\n\t\t0;\n}"
  },
  {
    "function_name": "git_rebase_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "295-400",
    "snippet": "int git_rebase_open(\n\tgit_rebase **out,\n\tgit_repository *repo,\n\tconst git_rebase_options *given_opts)\n{\n\tgit_rebase *rebase;\n\tgit_buf path = GIT_BUF_INIT, orig_head_name = GIT_BUF_INIT,\n\t\torig_head_id = GIT_BUF_INIT, onto_id = GIT_BUF_INIT;\n\tint state_path_len, error;\n\n\tassert(repo);\n\n\tif ((error = rebase_check_versions(given_opts)) < 0)\n\t\treturn error;\n\n\tif (rebase_alloc(&rebase, given_opts) < 0)\n\t\treturn -1;\n\n\trebase->repo = repo;\n\n\tif ((error = rebase_state_type(&rebase->type, &rebase->state_path, repo)) < 0)\n\t\tgoto done;\n\n\tif (rebase->type == GIT_REBASE_TYPE_NONE) {\n\t\tgiterr_set(GITERR_REBASE, \"There is no rebase in progress\");\n\t\terror = GIT_ENOTFOUND;\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_puts(&path, rebase->state_path)) < 0)\n\t\tgoto done;\n\n\tstate_path_len = git_buf_len(&path);\n\n\tif ((error = git_buf_joinpath(&path, path.ptr, HEAD_NAME_FILE)) < 0 ||\n\t\t(error = git_futils_readbuffer(&orig_head_name, path.ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(&orig_head_name);\n\n\tif (strcmp(ORIG_DETACHED_HEAD, orig_head_name.ptr) == 0)\n\t\trebase->head_detached = 1;\n\n\tgit_buf_truncate(&path, state_path_len);\n\n\tif ((error = git_buf_joinpath(&path, path.ptr, ORIG_HEAD_FILE)) < 0)\n\t\tgoto done;\n\n\tif (!git_path_isfile(path.ptr)) {\n\t\t/* Previous versions of git.git used 'head' here; support that. */\n\t\tgit_buf_truncate(&path, state_path_len);\n\n\t\tif ((error = git_buf_joinpath(&path, path.ptr, HEAD_FILE)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif ((error = git_futils_readbuffer(&orig_head_id, path.ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(&orig_head_id);\n\n\tif ((error = git_oid_fromstr(&rebase->orig_head_id, orig_head_id.ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_truncate(&path, state_path_len);\n\n\tif ((error = git_buf_joinpath(&path, path.ptr, ONTO_FILE)) < 0 ||\n\t\t(error = git_futils_readbuffer(&onto_id, path.ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(&onto_id);\n\n\tif ((error = git_oid_fromstr(&rebase->onto_id, onto_id.ptr)) < 0)\n\t\tgoto done;\n\n\tif (!rebase->head_detached)\n\t\trebase->orig_head_name = git_buf_detach(&orig_head_name);\n\n\tswitch (rebase->type) {\n\tcase GIT_REBASE_TYPE_INTERACTIVE:\n\t\tgiterr_set(GITERR_REBASE, \"Interactive rebase is not supported\");\n\t\terror = -1;\n\t\tbreak;\n\tcase GIT_REBASE_TYPE_MERGE:\n\t\terror = rebase_open_merge(rebase);\n\t\tbreak;\n\tcase GIT_REBASE_TYPE_APPLY:\n\t\tgiterr_set(GITERR_REBASE, \"Patch application rebase is not supported\");\n\t\terror = -1;\n\t\tbreak;\n\tdefault:\n\t\tabort();\n\t}\n\ndone:\n\tif (error == 0)\n\t\t*out = rebase;\n\telse\n\t\tgit_rebase_free(rebase);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&orig_head_name);\n\tgit_buf_free(&orig_head_id);\n\tgit_buf_free(&onto_id);\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define ORIG_DETACHED_HEAD  \"detached HEAD\"",
      "#define ONTO_FILE           \"onto\"",
      "#define HEAD_FILE           \"head\"",
      "#define ORIG_HEAD_FILE      \"orig-head\"",
      "#define HEAD_NAME_FILE      \"head-name\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&onto_id"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rebase_free",
          "args": [
            "rebase"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "git_rebase_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "1324-1337",
          "snippet": "void git_rebase_free(git_rebase *rebase)\n{\n\tif (rebase == NULL)\n\t\treturn;\n\n\tgit_index_free(rebase->index);\n\tgit_commit_free(rebase->last_commit);\n\tgit__free(rebase->onto_name);\n\tgit__free(rebase->orig_head_name);\n\tgit__free(rebase->state_path);\n\tgit_array_clear(rebase->operations);\n\tgit__free((char *)rebase->options.rewrite_notes_ref);\n\tgit__free(rebase);\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nvoid git_rebase_free(git_rebase *rebase)\n{\n\tif (rebase == NULL)\n\t\treturn;\n\n\tgit_index_free(rebase->index);\n\tgit_commit_free(rebase->last_commit);\n\tgit__free(rebase->onto_name);\n\tgit__free(rebase->orig_head_name);\n\tgit__free(rebase->state_path);\n\tgit_array_clear(rebase->operations);\n\tgit__free((char *)rebase->options.rewrite_notes_ref);\n\tgit__free(rebase);\n}"
        }
      },
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REBASE",
            "\"Patch application rebase is not supported\""
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_open_merge",
          "args": [
            "rebase"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_open_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "201-258",
          "snippet": "static int rebase_open_merge(git_rebase *rebase)\n{\n\tgit_buf state_path = GIT_BUF_INIT, buf = GIT_BUF_INIT, cmt = GIT_BUF_INIT;\n\tgit_oid id;\n\tgit_rebase_operation *operation;\n\tsize_t i, msgnum = 0, end;\n\tint error;\n\n\tif ((error = git_buf_puts(&state_path, rebase->state_path)) < 0)\n\t\tgoto done;\n\n\t/* Read 'msgnum' if it exists (otherwise, let msgnum = 0) */\n\tif ((error = rebase_readint(&msgnum, &buf, &state_path, MSGNUM_FILE)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto done;\n\n\tif (msgnum) {\n\t\trebase->started = 1;\n\t\trebase->current = msgnum - 1;\n\t}\n\n\t/* Read 'end' */\n\tif ((error = rebase_readint(&end, &buf, &state_path, END_FILE)) < 0)\n\t\tgoto done;\n\n\t/* Read 'current' if it exists */\n\tif ((error = rebase_readoid(&id, &buf, &state_path, CURRENT_FILE)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto done;\n\n\t/* Read cmt.* */\n\tgit_array_init_to_size(rebase->operations, end);\n\tGITERR_CHECK_ARRAY(rebase->operations);\n\n\tfor (i = 0; i < end; i++) {\n\t\tgit_buf_clear(&cmt);\n\n\t\tif ((error = git_buf_printf(&cmt, \"cmt.%\" PRIuZ, (i+1))) < 0 ||\n\t\t\t(error = rebase_readoid(&id, &buf, &state_path, cmt.ptr)) < 0)\n\t\t\tgoto done;\n\n\t\toperation = rebase_operation_alloc(rebase, GIT_REBASE_OPERATION_PICK, &id, NULL);\n\t\tGITERR_CHECK_ALLOC(operation);\n\t}\n\n\t/* Read 'onto_name' */\n\tif ((error = rebase_readfile(&buf, &state_path, ONTO_NAME_FILE)) < 0)\n\t\tgoto done;\n\n\trebase->onto_name = git_buf_detach(&buf);\n\ndone:\n\tgit_buf_free(&cmt);\n\tgit_buf_free(&state_path);\n\tgit_buf_free(&buf);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define CURRENT_FILE        \"current\"",
            "#define END_FILE            \"end\"",
            "#define MSGNUM_FILE         \"msgnum\"",
            "#define ONTO_NAME_FILE      \"onto_name\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define CURRENT_FILE        \"current\"\n#define END_FILE            \"end\"\n#define MSGNUM_FILE         \"msgnum\"\n#define ONTO_NAME_FILE      \"onto_name\"\n\nstatic int rebase_open_merge(git_rebase *rebase)\n{\n\tgit_buf state_path = GIT_BUF_INIT, buf = GIT_BUF_INIT, cmt = GIT_BUF_INIT;\n\tgit_oid id;\n\tgit_rebase_operation *operation;\n\tsize_t i, msgnum = 0, end;\n\tint error;\n\n\tif ((error = git_buf_puts(&state_path, rebase->state_path)) < 0)\n\t\tgoto done;\n\n\t/* Read 'msgnum' if it exists (otherwise, let msgnum = 0) */\n\tif ((error = rebase_readint(&msgnum, &buf, &state_path, MSGNUM_FILE)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto done;\n\n\tif (msgnum) {\n\t\trebase->started = 1;\n\t\trebase->current = msgnum - 1;\n\t}\n\n\t/* Read 'end' */\n\tif ((error = rebase_readint(&end, &buf, &state_path, END_FILE)) < 0)\n\t\tgoto done;\n\n\t/* Read 'current' if it exists */\n\tif ((error = rebase_readoid(&id, &buf, &state_path, CURRENT_FILE)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto done;\n\n\t/* Read cmt.* */\n\tgit_array_init_to_size(rebase->operations, end);\n\tGITERR_CHECK_ARRAY(rebase->operations);\n\n\tfor (i = 0; i < end; i++) {\n\t\tgit_buf_clear(&cmt);\n\n\t\tif ((error = git_buf_printf(&cmt, \"cmt.%\" PRIuZ, (i+1))) < 0 ||\n\t\t\t(error = rebase_readoid(&id, &buf, &state_path, cmt.ptr)) < 0)\n\t\t\tgoto done;\n\n\t\toperation = rebase_operation_alloc(rebase, GIT_REBASE_OPERATION_PICK, &id, NULL);\n\t\tGITERR_CHECK_ALLOC(operation);\n\t}\n\n\t/* Read 'onto_name' */\n\tif ((error = rebase_readfile(&buf, &state_path, ONTO_NAME_FILE)) < 0)\n\t\tgoto done;\n\n\trebase->onto_name = git_buf_detach(&buf);\n\ndone:\n\tgit_buf_free(&cmt);\n\tgit_buf_free(&state_path);\n\tgit_buf_free(&buf);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&orig_head_name"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fromstr",
          "args": [
            "&rebase->onto_id",
            "onto_id.ptr"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "54-57",
          "snippet": "int git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_rtrim",
          "args": [
            "&onto_id"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_rtrim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "718-729",
          "snippet": "void git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_readbuffer",
          "args": [
            "&onto_id",
            "path.ptr"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_readbuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "224-227",
          "snippet": "int git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "path.ptr",
            "ONTO_FILE"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_truncate",
          "args": [
            "&path",
            "state_path_len"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "446-454",
          "snippet": "void git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_isfile",
          "args": [
            "path.ptr"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_isfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "518-527",
          "snippet": "bool git_path_isfile(const char *path)\n{\n\tstruct stat st;\n\n\tassert(path);\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISREG(st.st_mode) != 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_isfile(const char *path)\n{\n\tstruct stat st;\n\n\tassert(path);\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISREG(st.st_mode) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "ORIG_DETACHED_HEAD",
            "orig_head_name.ptr"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "&path"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "&path",
            "rebase->state_path"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_state_type",
          "args": [
            "&rebase->type",
            "&rebase->state_path",
            "repo"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_state_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "87-121",
          "snippet": "static int rebase_state_type(\n\tgit_rebase_type_t *type_out,\n\tchar **path_out,\n\tgit_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_rebase_type_t type = GIT_REBASE_TYPE_NONE;\n\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_APPLY_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_APPLY;\n\t\tgoto done;\n\t}\n\n\tgit_buf_clear(&path);\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_MERGE_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_MERGE;\n\t\tgoto done;\n\t}\n\ndone:\n\t*type_out = type;\n\n\tif (type != GIT_REBASE_TYPE_NONE && path_out)\n\t\t*path_out = git_buf_detach(&path);\n\n\tgit_buf_free(&path);\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define REBASE_MERGE_DIR    \"rebase-merge\"",
            "#define REBASE_APPLY_DIR    \"rebase-apply\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_MERGE_DIR    \"rebase-merge\"\n#define REBASE_APPLY_DIR    \"rebase-apply\"\n\nstatic int rebase_state_type(\n\tgit_rebase_type_t *type_out,\n\tchar **path_out,\n\tgit_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_rebase_type_t type = GIT_REBASE_TYPE_NONE;\n\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_APPLY_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_APPLY;\n\t\tgoto done;\n\t}\n\n\tgit_buf_clear(&path);\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_MERGE_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_MERGE;\n\t\tgoto done;\n\t}\n\ndone:\n\t*type_out = type;\n\n\tif (type != GIT_REBASE_TYPE_NONE && path_out)\n\t\t*path_out = git_buf_detach(&path);\n\n\tgit_buf_free(&path);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_alloc",
          "args": [
            "&rebase",
            "given_opts"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "260-283",
          "snippet": "static int rebase_alloc(git_rebase **out, const git_rebase_options *rebase_opts)\n{\n\tgit_rebase *rebase = git__calloc(1, sizeof(git_rebase));\n\tGITERR_CHECK_ALLOC(rebase);\n\n\t*out = NULL;\n\n\tif (rebase_opts)\n\t\tmemcpy(&rebase->options, rebase_opts, sizeof(git_rebase_options));\n\telse\n\t\tgit_rebase_init_options(&rebase->options, GIT_REBASE_OPTIONS_VERSION);\n\n\tif (rebase_opts && rebase_opts->rewrite_notes_ref) {\n\t\trebase->options.rewrite_notes_ref = git__strdup(rebase_opts->rewrite_notes_ref);\n\t\tGITERR_CHECK_ALLOC(rebase->options.rewrite_notes_ref);\n\t}\n\n\tif ((rebase->options.checkout_options.checkout_strategy & (GIT_CHECKOUT_SAFE | GIT_CHECKOUT_FORCE)) == 0)\n\t\trebase->options.checkout_options.checkout_strategy = GIT_CHECKOUT_SAFE;\n\n\t*out = rebase;\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_alloc(git_rebase **out, const git_rebase_options *rebase_opts)\n{\n\tgit_rebase *rebase = git__calloc(1, sizeof(git_rebase));\n\tGITERR_CHECK_ALLOC(rebase);\n\n\t*out = NULL;\n\n\tif (rebase_opts)\n\t\tmemcpy(&rebase->options, rebase_opts, sizeof(git_rebase_options));\n\telse\n\t\tgit_rebase_init_options(&rebase->options, GIT_REBASE_OPTIONS_VERSION);\n\n\tif (rebase_opts && rebase_opts->rewrite_notes_ref) {\n\t\trebase->options.rewrite_notes_ref = git__strdup(rebase_opts->rewrite_notes_ref);\n\t\tGITERR_CHECK_ALLOC(rebase->options.rewrite_notes_ref);\n\t}\n\n\tif ((rebase->options.checkout_options.checkout_strategy & (GIT_CHECKOUT_SAFE | GIT_CHECKOUT_FORCE)) == 0)\n\t\trebase->options.checkout_options.checkout_strategy = GIT_CHECKOUT_SAFE;\n\n\t*out = rebase;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_check_versions",
          "args": [
            "given_opts"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_check_versions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "285-293",
          "snippet": "static int rebase_check_versions(const git_rebase_options *given_opts)\n{\n\tGITERR_CHECK_VERSION(given_opts, GIT_REBASE_OPTIONS_VERSION, \"git_rebase_options\");\n\n\tif (given_opts)\n\t\tGITERR_CHECK_VERSION(&given_opts->checkout_options, GIT_CHECKOUT_OPTIONS_VERSION, \"git_checkout_options\");\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_check_versions(const git_rebase_options *given_opts)\n{\n\tGITERR_CHECK_VERSION(given_opts, GIT_REBASE_OPTIONS_VERSION, \"git_rebase_options\");\n\n\tif (given_opts)\n\t\tGITERR_CHECK_VERSION(&given_opts->checkout_options, GIT_CHECKOUT_OPTIONS_VERSION, \"git_checkout_options\");\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define ORIG_DETACHED_HEAD  \"detached HEAD\"\n#define ONTO_FILE           \"onto\"\n#define HEAD_FILE           \"head\"\n#define ORIG_HEAD_FILE      \"orig-head\"\n#define HEAD_NAME_FILE      \"head-name\"\n\nint git_rebase_open(\n\tgit_rebase **out,\n\tgit_repository *repo,\n\tconst git_rebase_options *given_opts)\n{\n\tgit_rebase *rebase;\n\tgit_buf path = GIT_BUF_INIT, orig_head_name = GIT_BUF_INIT,\n\t\torig_head_id = GIT_BUF_INIT, onto_id = GIT_BUF_INIT;\n\tint state_path_len, error;\n\n\tassert(repo);\n\n\tif ((error = rebase_check_versions(given_opts)) < 0)\n\t\treturn error;\n\n\tif (rebase_alloc(&rebase, given_opts) < 0)\n\t\treturn -1;\n\n\trebase->repo = repo;\n\n\tif ((error = rebase_state_type(&rebase->type, &rebase->state_path, repo)) < 0)\n\t\tgoto done;\n\n\tif (rebase->type == GIT_REBASE_TYPE_NONE) {\n\t\tgiterr_set(GITERR_REBASE, \"There is no rebase in progress\");\n\t\terror = GIT_ENOTFOUND;\n\t\tgoto done;\n\t}\n\n\tif ((error = git_buf_puts(&path, rebase->state_path)) < 0)\n\t\tgoto done;\n\n\tstate_path_len = git_buf_len(&path);\n\n\tif ((error = git_buf_joinpath(&path, path.ptr, HEAD_NAME_FILE)) < 0 ||\n\t\t(error = git_futils_readbuffer(&orig_head_name, path.ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(&orig_head_name);\n\n\tif (strcmp(ORIG_DETACHED_HEAD, orig_head_name.ptr) == 0)\n\t\trebase->head_detached = 1;\n\n\tgit_buf_truncate(&path, state_path_len);\n\n\tif ((error = git_buf_joinpath(&path, path.ptr, ORIG_HEAD_FILE)) < 0)\n\t\tgoto done;\n\n\tif (!git_path_isfile(path.ptr)) {\n\t\t/* Previous versions of git.git used 'head' here; support that. */\n\t\tgit_buf_truncate(&path, state_path_len);\n\n\t\tif ((error = git_buf_joinpath(&path, path.ptr, HEAD_FILE)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif ((error = git_futils_readbuffer(&orig_head_id, path.ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(&orig_head_id);\n\n\tif ((error = git_oid_fromstr(&rebase->orig_head_id, orig_head_id.ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_truncate(&path, state_path_len);\n\n\tif ((error = git_buf_joinpath(&path, path.ptr, ONTO_FILE)) < 0 ||\n\t\t(error = git_futils_readbuffer(&onto_id, path.ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(&onto_id);\n\n\tif ((error = git_oid_fromstr(&rebase->onto_id, onto_id.ptr)) < 0)\n\t\tgoto done;\n\n\tif (!rebase->head_detached)\n\t\trebase->orig_head_name = git_buf_detach(&orig_head_name);\n\n\tswitch (rebase->type) {\n\tcase GIT_REBASE_TYPE_INTERACTIVE:\n\t\tgiterr_set(GITERR_REBASE, \"Interactive rebase is not supported\");\n\t\terror = -1;\n\t\tbreak;\n\tcase GIT_REBASE_TYPE_MERGE:\n\t\terror = rebase_open_merge(rebase);\n\t\tbreak;\n\tcase GIT_REBASE_TYPE_APPLY:\n\t\tgiterr_set(GITERR_REBASE, \"Patch application rebase is not supported\");\n\t\terror = -1;\n\t\tbreak;\n\tdefault:\n\t\tabort();\n\t}\n\ndone:\n\tif (error == 0)\n\t\t*out = rebase;\n\telse\n\t\tgit_rebase_free(rebase);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&orig_head_name);\n\tgit_buf_free(&orig_head_id);\n\tgit_buf_free(&onto_id);\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_check_versions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "285-293",
    "snippet": "static int rebase_check_versions(const git_rebase_options *given_opts)\n{\n\tGITERR_CHECK_VERSION(given_opts, GIT_REBASE_OPTIONS_VERSION, \"git_rebase_options\");\n\n\tif (given_opts)\n\t\tGITERR_CHECK_VERSION(&given_opts->checkout_options, GIT_CHECKOUT_OPTIONS_VERSION, \"git_checkout_options\");\n\n\treturn 0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_VERSION",
          "args": [
            "&given_opts->checkout_options",
            "GIT_CHECKOUT_OPTIONS_VERSION",
            "\"git_checkout_options\""
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_VERSION",
          "args": [
            "given_opts",
            "GIT_REBASE_OPTIONS_VERSION",
            "\"git_rebase_options\""
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_check_versions(const git_rebase_options *given_opts)\n{\n\tGITERR_CHECK_VERSION(given_opts, GIT_REBASE_OPTIONS_VERSION, \"git_rebase_options\");\n\n\tif (given_opts)\n\t\tGITERR_CHECK_VERSION(&given_opts->checkout_options, GIT_CHECKOUT_OPTIONS_VERSION, \"git_checkout_options\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "rebase_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "260-283",
    "snippet": "static int rebase_alloc(git_rebase **out, const git_rebase_options *rebase_opts)\n{\n\tgit_rebase *rebase = git__calloc(1, sizeof(git_rebase));\n\tGITERR_CHECK_ALLOC(rebase);\n\n\t*out = NULL;\n\n\tif (rebase_opts)\n\t\tmemcpy(&rebase->options, rebase_opts, sizeof(git_rebase_options));\n\telse\n\t\tgit_rebase_init_options(&rebase->options, GIT_REBASE_OPTIONS_VERSION);\n\n\tif (rebase_opts && rebase_opts->rewrite_notes_ref) {\n\t\trebase->options.rewrite_notes_ref = git__strdup(rebase_opts->rewrite_notes_ref);\n\t\tGITERR_CHECK_ALLOC(rebase->options.rewrite_notes_ref);\n\t}\n\n\tif ((rebase->options.checkout_options.checkout_strategy & (GIT_CHECKOUT_SAFE | GIT_CHECKOUT_FORCE)) == 0)\n\t\trebase->options.checkout_options.checkout_strategy = GIT_CHECKOUT_SAFE;\n\n\t*out = rebase;\n\n\treturn 0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "rebase->options.rewrite_notes_ref"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "rebase_opts->rewrite_notes_ref"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_rebase_init_options",
          "args": [
            "&rebase->options",
            "GIT_REBASE_OPTIONS_VERSION"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "git_rebase_init_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "494-499",
          "snippet": "int git_rebase_init_options(git_rebase_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_rebase_options, GIT_REBASE_OPTIONS_INIT);\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nint git_rebase_init_options(git_rebase_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_rebase_options, GIT_REBASE_OPTIONS_INIT);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&rebase->options",
            "rebase_opts",
            "sizeof(git_rebase_options)"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "rebase"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_rebase)"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic int rebase_alloc(git_rebase **out, const git_rebase_options *rebase_opts)\n{\n\tgit_rebase *rebase = git__calloc(1, sizeof(git_rebase));\n\tGITERR_CHECK_ALLOC(rebase);\n\n\t*out = NULL;\n\n\tif (rebase_opts)\n\t\tmemcpy(&rebase->options, rebase_opts, sizeof(git_rebase_options));\n\telse\n\t\tgit_rebase_init_options(&rebase->options, GIT_REBASE_OPTIONS_VERSION);\n\n\tif (rebase_opts && rebase_opts->rewrite_notes_ref) {\n\t\trebase->options.rewrite_notes_ref = git__strdup(rebase_opts->rewrite_notes_ref);\n\t\tGITERR_CHECK_ALLOC(rebase->options.rewrite_notes_ref);\n\t}\n\n\tif ((rebase->options.checkout_options.checkout_strategy & (GIT_CHECKOUT_SAFE | GIT_CHECKOUT_FORCE)) == 0)\n\t\trebase->options.checkout_options.checkout_strategy = GIT_CHECKOUT_SAFE;\n\n\t*out = rebase;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "rebase_open_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "201-258",
    "snippet": "static int rebase_open_merge(git_rebase *rebase)\n{\n\tgit_buf state_path = GIT_BUF_INIT, buf = GIT_BUF_INIT, cmt = GIT_BUF_INIT;\n\tgit_oid id;\n\tgit_rebase_operation *operation;\n\tsize_t i, msgnum = 0, end;\n\tint error;\n\n\tif ((error = git_buf_puts(&state_path, rebase->state_path)) < 0)\n\t\tgoto done;\n\n\t/* Read 'msgnum' if it exists (otherwise, let msgnum = 0) */\n\tif ((error = rebase_readint(&msgnum, &buf, &state_path, MSGNUM_FILE)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto done;\n\n\tif (msgnum) {\n\t\trebase->started = 1;\n\t\trebase->current = msgnum - 1;\n\t}\n\n\t/* Read 'end' */\n\tif ((error = rebase_readint(&end, &buf, &state_path, END_FILE)) < 0)\n\t\tgoto done;\n\n\t/* Read 'current' if it exists */\n\tif ((error = rebase_readoid(&id, &buf, &state_path, CURRENT_FILE)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto done;\n\n\t/* Read cmt.* */\n\tgit_array_init_to_size(rebase->operations, end);\n\tGITERR_CHECK_ARRAY(rebase->operations);\n\n\tfor (i = 0; i < end; i++) {\n\t\tgit_buf_clear(&cmt);\n\n\t\tif ((error = git_buf_printf(&cmt, \"cmt.%\" PRIuZ, (i+1))) < 0 ||\n\t\t\t(error = rebase_readoid(&id, &buf, &state_path, cmt.ptr)) < 0)\n\t\t\tgoto done;\n\n\t\toperation = rebase_operation_alloc(rebase, GIT_REBASE_OPERATION_PICK, &id, NULL);\n\t\tGITERR_CHECK_ALLOC(operation);\n\t}\n\n\t/* Read 'onto_name' */\n\tif ((error = rebase_readfile(&buf, &state_path, ONTO_NAME_FILE)) < 0)\n\t\tgoto done;\n\n\trebase->onto_name = git_buf_detach(&buf);\n\ndone:\n\tgit_buf_free(&cmt);\n\tgit_buf_free(&state_path);\n\tgit_buf_free(&buf);\n\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define CURRENT_FILE        \"current\"",
      "#define END_FILE            \"end\"",
      "#define MSGNUM_FILE         \"msgnum\"",
      "#define ONTO_NAME_FILE      \"onto_name\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&buf"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_readfile",
          "args": [
            "&buf",
            "&state_path",
            "ONTO_NAME_FILE"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_readfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "123-142",
          "snippet": "GIT_INLINE(int) rebase_readfile(\n\tgit_buf *out,\n\tgit_buf *state_path,\n\tconst char *filename)\n{\n\tsize_t state_path_len = state_path->size;\n\tint error;\n\n\tgit_buf_clear(out);\n\n\tif ((error = git_buf_joinpath(state_path, state_path->ptr, filename)) < 0 ||\n\t\t(error = git_futils_readbuffer(out, state_path->ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(out);\n\ndone:\n\tgit_buf_truncate(state_path, state_path_len);\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_readfile(\n\tgit_buf *out,\n\tgit_buf *state_path,\n\tconst char *filename)\n{\n\tsize_t state_path_len = state_path->size;\n\tint error;\n\n\tgit_buf_clear(out);\n\n\tif ((error = git_buf_joinpath(state_path, state_path->ptr, filename)) < 0 ||\n\t\t(error = git_futils_readbuffer(out, state_path->ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(out);\n\ndone:\n\tgit_buf_truncate(state_path, state_path_len);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "operation"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rebase_operation_alloc",
          "args": [
            "rebase",
            "GIT_REBASE_OPERATION_PICK",
            "&id",
            "NULL"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_operation_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "180-199",
          "snippet": "static git_rebase_operation *rebase_operation_alloc(\n\tgit_rebase *rebase,\n\tgit_rebase_operation_t type,\n\tgit_oid *id,\n\tconst char *exec)\n{\n\tgit_rebase_operation *operation;\n\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !id);\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !!exec);\n\n\tif ((operation = git_array_alloc(rebase->operations)) == NULL)\n\t\treturn NULL;\n\n\toperation->type = type;\n\tgit_oid_cpy((git_oid *)&operation->id, id);\n\toperation->exec = exec;\n\n\treturn operation;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic git_rebase_operation *rebase_operation_alloc(\n\tgit_rebase *rebase,\n\tgit_rebase_operation_t type,\n\tgit_oid *id,\n\tconst char *exec)\n{\n\tgit_rebase_operation *operation;\n\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !id);\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !!exec);\n\n\tif ((operation = git_array_alloc(rebase->operations)) == NULL)\n\t\treturn NULL;\n\n\toperation->type = type;\n\tgit_oid_cpy((git_oid *)&operation->id, id);\n\toperation->exec = exec;\n\n\treturn operation;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_readoid",
          "args": [
            "&id",
            "&buf",
            "&state_path",
            "cmt.ptr"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_readoid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "164-178",
          "snippet": "GIT_INLINE(int) rebase_readoid(\n\tgit_oid *out, git_buf *str_out, git_buf *state_path, const char *filename)\n{\n\tint error;\n\n\tif ((error = rebase_readfile(str_out, state_path, filename)) < 0)\n\t\treturn error;\n\n\tif (str_out->size != GIT_OID_HEXSZ || git_oid_fromstr(out, str_out->ptr) < 0) {\n\t\tgiterr_set(GITERR_REBASE, \"The file '%s' contains an invalid object ID\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_readoid(\n\tgit_oid *out, git_buf *str_out, git_buf *state_path, const char *filename)\n{\n\tint error;\n\n\tif ((error = rebase_readfile(str_out, state_path, filename)) < 0)\n\t\treturn error;\n\n\tif (str_out->size != GIT_OID_HEXSZ || git_oid_fromstr(out, str_out->ptr) < 0) {\n\t\tgiterr_set(GITERR_REBASE, \"The file '%s' contains an invalid object ID\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "&cmt",
            "\"cmt.%\" PRIuZ",
            "(i+1)"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "&cmt"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ARRAY",
          "args": [
            "rebase->operations"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_init_to_size",
          "args": [
            "rebase->operations",
            "end"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rebase_readint",
          "args": [
            "&end",
            "&buf",
            "&state_path",
            "END_FILE"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_readint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "144-162",
          "snippet": "GIT_INLINE(int) rebase_readint(\n\tsize_t *out, git_buf *asc_out, git_buf *state_path, const char *filename)\n{\n\tint32_t num;\n\tconst char *eol;\n\tint error = 0;\n\n\tif ((error = rebase_readfile(asc_out, state_path, filename)) < 0)\n\t\treturn error;\n\n\tif (git__strtol32(&num, asc_out->ptr, &eol, 10) < 0 || num < 0 || *eol) {\n\t\tgiterr_set(GITERR_REBASE, \"The file '%s' contains an invalid numeric value\", filename);\n\t\treturn -1;\n\t}\n\n\t*out = (size_t) num;\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_readint(\n\tsize_t *out, git_buf *asc_out, git_buf *state_path, const char *filename)\n{\n\tint32_t num;\n\tconst char *eol;\n\tint error = 0;\n\n\tif ((error = rebase_readfile(asc_out, state_path, filename)) < 0)\n\t\treturn error;\n\n\tif (git__strtol32(&num, asc_out->ptr, &eol, 10) < 0 || num < 0 || *eol) {\n\t\tgiterr_set(GITERR_REBASE, \"The file '%s' contains an invalid numeric value\", filename);\n\t\treturn -1;\n\t}\n\n\t*out = (size_t) num;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "&state_path",
            "rebase->state_path"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define CURRENT_FILE        \"current\"\n#define END_FILE            \"end\"\n#define MSGNUM_FILE         \"msgnum\"\n#define ONTO_NAME_FILE      \"onto_name\"\n\nstatic int rebase_open_merge(git_rebase *rebase)\n{\n\tgit_buf state_path = GIT_BUF_INIT, buf = GIT_BUF_INIT, cmt = GIT_BUF_INIT;\n\tgit_oid id;\n\tgit_rebase_operation *operation;\n\tsize_t i, msgnum = 0, end;\n\tint error;\n\n\tif ((error = git_buf_puts(&state_path, rebase->state_path)) < 0)\n\t\tgoto done;\n\n\t/* Read 'msgnum' if it exists (otherwise, let msgnum = 0) */\n\tif ((error = rebase_readint(&msgnum, &buf, &state_path, MSGNUM_FILE)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto done;\n\n\tif (msgnum) {\n\t\trebase->started = 1;\n\t\trebase->current = msgnum - 1;\n\t}\n\n\t/* Read 'end' */\n\tif ((error = rebase_readint(&end, &buf, &state_path, END_FILE)) < 0)\n\t\tgoto done;\n\n\t/* Read 'current' if it exists */\n\tif ((error = rebase_readoid(&id, &buf, &state_path, CURRENT_FILE)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto done;\n\n\t/* Read cmt.* */\n\tgit_array_init_to_size(rebase->operations, end);\n\tGITERR_CHECK_ARRAY(rebase->operations);\n\n\tfor (i = 0; i < end; i++) {\n\t\tgit_buf_clear(&cmt);\n\n\t\tif ((error = git_buf_printf(&cmt, \"cmt.%\" PRIuZ, (i+1))) < 0 ||\n\t\t\t(error = rebase_readoid(&id, &buf, &state_path, cmt.ptr)) < 0)\n\t\t\tgoto done;\n\n\t\toperation = rebase_operation_alloc(rebase, GIT_REBASE_OPERATION_PICK, &id, NULL);\n\t\tGITERR_CHECK_ALLOC(operation);\n\t}\n\n\t/* Read 'onto_name' */\n\tif ((error = rebase_readfile(&buf, &state_path, ONTO_NAME_FILE)) < 0)\n\t\tgoto done;\n\n\trebase->onto_name = git_buf_detach(&buf);\n\ndone:\n\tgit_buf_free(&cmt);\n\tgit_buf_free(&state_path);\n\tgit_buf_free(&buf);\n\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_operation_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "180-199",
    "snippet": "static git_rebase_operation *rebase_operation_alloc(\n\tgit_rebase *rebase,\n\tgit_rebase_operation_t type,\n\tgit_oid *id,\n\tconst char *exec)\n{\n\tgit_rebase_operation *operation;\n\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !id);\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !!exec);\n\n\tif ((operation = git_array_alloc(rebase->operations)) == NULL)\n\t\treturn NULL;\n\n\toperation->type = type;\n\tgit_oid_cpy((git_oid *)&operation->id, id);\n\toperation->exec = exec;\n\n\treturn operation;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "(git_oid *)&operation->id",
            "id"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "rebase->operations"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "(type == GIT_REBASE_OPERATION_EXEC) == !!exec"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "(type == GIT_REBASE_OPERATION_EXEC) == !id"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nstatic git_rebase_operation *rebase_operation_alloc(\n\tgit_rebase *rebase,\n\tgit_rebase_operation_t type,\n\tgit_oid *id,\n\tconst char *exec)\n{\n\tgit_rebase_operation *operation;\n\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !id);\n\tassert((type == GIT_REBASE_OPERATION_EXEC) == !!exec);\n\n\tif ((operation = git_array_alloc(rebase->operations)) == NULL)\n\t\treturn NULL;\n\n\toperation->type = type;\n\tgit_oid_cpy((git_oid *)&operation->id, id);\n\toperation->exec = exec;\n\n\treturn operation;\n}"
  },
  {
    "function_name": "rebase_readoid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "164-178",
    "snippet": "GIT_INLINE(int) rebase_readoid(\n\tgit_oid *out, git_buf *str_out, git_buf *state_path, const char *filename)\n{\n\tint error;\n\n\tif ((error = rebase_readfile(str_out, state_path, filename)) < 0)\n\t\treturn error;\n\n\tif (str_out->size != GIT_OID_HEXSZ || git_oid_fromstr(out, str_out->ptr) < 0) {\n\t\tgiterr_set(GITERR_REBASE, \"The file '%s' contains an invalid object ID\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REBASE",
            "\"The file '%s' contains an invalid object ID\"",
            "filename"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fromstr",
          "args": [
            "out",
            "str_out->ptr"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "54-57",
          "snippet": "int git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_readfile",
          "args": [
            "str_out",
            "state_path",
            "filename"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_readfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "123-142",
          "snippet": "GIT_INLINE(int) rebase_readfile(\n\tgit_buf *out,\n\tgit_buf *state_path,\n\tconst char *filename)\n{\n\tsize_t state_path_len = state_path->size;\n\tint error;\n\n\tgit_buf_clear(out);\n\n\tif ((error = git_buf_joinpath(state_path, state_path->ptr, filename)) < 0 ||\n\t\t(error = git_futils_readbuffer(out, state_path->ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(out);\n\ndone:\n\tgit_buf_truncate(state_path, state_path_len);\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_readfile(\n\tgit_buf *out,\n\tgit_buf *state_path,\n\tconst char *filename)\n{\n\tsize_t state_path_len = state_path->size;\n\tint error;\n\n\tgit_buf_clear(out);\n\n\tif ((error = git_buf_joinpath(state_path, state_path->ptr, filename)) < 0 ||\n\t\t(error = git_futils_readbuffer(out, state_path->ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(out);\n\ndone:\n\tgit_buf_truncate(state_path, state_path_len);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_readoid(\n\tgit_oid *out, git_buf *str_out, git_buf *state_path, const char *filename)\n{\n\tint error;\n\n\tif ((error = rebase_readfile(str_out, state_path, filename)) < 0)\n\t\treturn error;\n\n\tif (str_out->size != GIT_OID_HEXSZ || git_oid_fromstr(out, str_out->ptr) < 0) {\n\t\tgiterr_set(GITERR_REBASE, \"The file '%s' contains an invalid object ID\", filename);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "rebase_readint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "144-162",
    "snippet": "GIT_INLINE(int) rebase_readint(\n\tsize_t *out, git_buf *asc_out, git_buf *state_path, const char *filename)\n{\n\tint32_t num;\n\tconst char *eol;\n\tint error = 0;\n\n\tif ((error = rebase_readfile(asc_out, state_path, filename)) < 0)\n\t\treturn error;\n\n\tif (git__strtol32(&num, asc_out->ptr, &eol, 10) < 0 || num < 0 || *eol) {\n\t\tgiterr_set(GITERR_REBASE, \"The file '%s' contains an invalid numeric value\", filename);\n\t\treturn -1;\n\t}\n\n\t*out = (size_t) num;\n\n\treturn 0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REBASE",
            "\"The file '%s' contains an invalid numeric value\"",
            "filename"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strtol32",
          "args": [
            "&num",
            "asc_out->ptr",
            "&eol",
            "10"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "git__strtol32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "149-167",
          "snippet": "int git__strtol32(int32_t *result, const char *nptr, const char **endptr, int base)\n{\n\tint error;\n\tint32_t tmp_int;\n\tint64_t tmp_long;\n\n\tif ((error = git__strtol64(&tmp_long, nptr, endptr, base)) < 0)\n\t\treturn error;\n\n\ttmp_int = tmp_long & 0xFFFFFFFF;\n\tif (tmp_int != tmp_long) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert. '%s' is too large\", nptr);\n\t\treturn -1;\n\t}\n\n\t*result = tmp_int;\n\n\treturn error;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strtol32(int32_t *result, const char *nptr, const char **endptr, int base)\n{\n\tint error;\n\tint32_t tmp_int;\n\tint64_t tmp_long;\n\n\tif ((error = git__strtol64(&tmp_long, nptr, endptr, base)) < 0)\n\t\treturn error;\n\n\ttmp_int = tmp_long & 0xFFFFFFFF;\n\tif (tmp_int != tmp_long) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert. '%s' is too large\", nptr);\n\t\treturn -1;\n\t}\n\n\t*result = tmp_int;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rebase_readfile",
          "args": [
            "asc_out",
            "state_path",
            "filename"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "rebase_readfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
          "lines": "123-142",
          "snippet": "GIT_INLINE(int) rebase_readfile(\n\tgit_buf *out,\n\tgit_buf *state_path,\n\tconst char *filename)\n{\n\tsize_t state_path_len = state_path->size;\n\tint error;\n\n\tgit_buf_clear(out);\n\n\tif ((error = git_buf_joinpath(state_path, state_path->ptr, filename)) < 0 ||\n\t\t(error = git_futils_readbuffer(out, state_path->ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(out);\n\ndone:\n\tgit_buf_truncate(state_path, state_path_len);\n\treturn error;\n}",
          "includes": [
            "#include <git2/notes.h>",
            "#include <git2/revwalk.h>",
            "#include <git2/reset.h>",
            "#include <git2/commit.h>",
            "#include <git2/rebase.h>",
            "#include <git2/annotated_commit.h>",
            "#include <git2/types.h>",
            "#include \"index.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"config.h\"",
            "#include \"array.h\"",
            "#include \"merge.h\"",
            "#include \"filebuf.h\"",
            "#include \"posix.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_readfile(\n\tgit_buf *out,\n\tgit_buf *state_path,\n\tconst char *filename)\n{\n\tsize_t state_path_len = state_path->size;\n\tint error;\n\n\tgit_buf_clear(out);\n\n\tif ((error = git_buf_joinpath(state_path, state_path->ptr, filename)) < 0 ||\n\t\t(error = git_futils_readbuffer(out, state_path->ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(out);\n\ndone:\n\tgit_buf_truncate(state_path, state_path_len);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_readint(\n\tsize_t *out, git_buf *asc_out, git_buf *state_path, const char *filename)\n{\n\tint32_t num;\n\tconst char *eol;\n\tint error = 0;\n\n\tif ((error = rebase_readfile(asc_out, state_path, filename)) < 0)\n\t\treturn error;\n\n\tif (git__strtol32(&num, asc_out->ptr, &eol, 10) < 0 || num < 0 || *eol) {\n\t\tgiterr_set(GITERR_REBASE, \"The file '%s' contains an invalid numeric value\", filename);\n\t\treturn -1;\n\t}\n\n\t*out = (size_t) num;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "rebase_readfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "123-142",
    "snippet": "GIT_INLINE(int) rebase_readfile(\n\tgit_buf *out,\n\tgit_buf *state_path,\n\tconst char *filename)\n{\n\tsize_t state_path_len = state_path->size;\n\tint error;\n\n\tgit_buf_clear(out);\n\n\tif ((error = git_buf_joinpath(state_path, state_path->ptr, filename)) < 0 ||\n\t\t(error = git_futils_readbuffer(out, state_path->ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(out);\n\ndone:\n\tgit_buf_truncate(state_path, state_path_len);\n\treturn error;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_truncate",
          "args": [
            "state_path",
            "state_path_len"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "446-454",
          "snippet": "void git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_truncate(git_buf *buf, size_t len)\n{\n\tif (len >= buf->size)\n\t\treturn;\n\n\tbuf->size = len;\n\tif (buf->size < buf->asize)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_rtrim",
          "args": [
            "out"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_rtrim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "718-729",
          "snippet": "void git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_readbuffer",
          "args": [
            "out",
            "state_path->ptr"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_readbuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "224-227",
          "snippet": "int git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "state_path",
            "state_path->ptr",
            "filename"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) rebase_readfile(\n\tgit_buf *out,\n\tgit_buf *state_path,\n\tconst char *filename)\n{\n\tsize_t state_path_len = state_path->size;\n\tint error;\n\n\tgit_buf_clear(out);\n\n\tif ((error = git_buf_joinpath(state_path, state_path->ptr, filename)) < 0 ||\n\t\t(error = git_futils_readbuffer(out, state_path->ptr)) < 0)\n\t\tgoto done;\n\n\tgit_buf_rtrim(out);\n\ndone:\n\tgit_buf_truncate(state_path, state_path_len);\n\treturn error;\n}"
  },
  {
    "function_name": "rebase_state_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/rebase.c",
    "lines": "87-121",
    "snippet": "static int rebase_state_type(\n\tgit_rebase_type_t *type_out,\n\tchar **path_out,\n\tgit_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_rebase_type_t type = GIT_REBASE_TYPE_NONE;\n\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_APPLY_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_APPLY;\n\t\tgoto done;\n\t}\n\n\tgit_buf_clear(&path);\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_MERGE_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_MERGE;\n\t\tgoto done;\n\t}\n\ndone:\n\t*type_out = type;\n\n\tif (type != GIT_REBASE_TYPE_NONE && path_out)\n\t\t*path_out = git_buf_detach(&path);\n\n\tgit_buf_free(&path);\n\n\treturn 0;\n}",
    "includes": [
      "#include <git2/notes.h>",
      "#include <git2/revwalk.h>",
      "#include <git2/reset.h>",
      "#include <git2/commit.h>",
      "#include <git2/rebase.h>",
      "#include <git2/annotated_commit.h>",
      "#include <git2/types.h>",
      "#include \"index.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"config.h\"",
      "#include \"array.h\"",
      "#include \"merge.h\"",
      "#include \"filebuf.h\"",
      "#include \"posix.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define REBASE_MERGE_DIR    \"rebase-merge\"",
      "#define REBASE_APPLY_DIR    \"rebase-apply\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&path"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_isdir",
          "args": [
            "git_buf_cstr(&path)"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_isdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "509-516",
          "snippet": "bool git_path_isdir(const char *path)\n{\n\tstruct stat st;\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISDIR(st.st_mode) != 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_isdir(const char *path)\n{\n\tstruct stat st;\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISDIR(st.st_mode) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&path"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "repo->path_repository",
            "REBASE_MERGE_DIR"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "&path"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include <git2/notes.h>\n#include <git2/revwalk.h>\n#include <git2/reset.h>\n#include <git2/commit.h>\n#include <git2/rebase.h>\n#include <git2/annotated_commit.h>\n#include <git2/types.h>\n#include \"index.h\"\n#include \"annotated_commit.h\"\n#include \"config.h\"\n#include \"array.h\"\n#include \"merge.h\"\n#include \"filebuf.h\"\n#include \"posix.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n\n#define REBASE_MERGE_DIR    \"rebase-merge\"\n#define REBASE_APPLY_DIR    \"rebase-apply\"\n\nstatic int rebase_state_type(\n\tgit_rebase_type_t *type_out,\n\tchar **path_out,\n\tgit_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_rebase_type_t type = GIT_REBASE_TYPE_NONE;\n\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_APPLY_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_APPLY;\n\t\tgoto done;\n\t}\n\n\tgit_buf_clear(&path);\n\tif (git_buf_joinpath(&path, repo->path_repository, REBASE_MERGE_DIR) < 0)\n\t\treturn -1;\n\n\tif (git_path_isdir(git_buf_cstr(&path))) {\n\t\ttype = GIT_REBASE_TYPE_MERGE;\n\t\tgoto done;\n\t}\n\ndone:\n\t*type_out = type;\n\n\tif (type != GIT_REBASE_TYPE_NONE && path_out)\n\t\t*path_out = git_buf_detach(&path);\n\n\tgit_buf_free(&path);\n\n\treturn 0;\n}"
  }
]