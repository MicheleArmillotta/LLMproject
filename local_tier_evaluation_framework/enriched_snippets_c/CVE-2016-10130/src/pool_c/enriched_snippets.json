[
  {
    "function_name": "git_pool_strcat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "218-236",
    "snippet": "char *git_pool_strcat(git_pool *pool, const char *a, const char *b)\n{\n\tvoid *ptr;\n\tsize_t len_a, len_b;\n\n\tassert(pool && pool->item_size == sizeof(char));\n\n\tlen_a = a ? strlen(a) : 0;\n\tlen_b = b ? strlen(b) : 0;\n\n\tif ((ptr = git_pool_malloc(pool, (uint32_t)(len_a + len_b + 1))) != NULL) {\n\t\tif (len_a)\n\t\t\tmemcpy(ptr, a, len_a);\n\t\tif (len_b)\n\t\t\tmemcpy(((char *)ptr) + len_a, b, len_b);\n\t\t*(((char *)ptr) + len_a + len_b) = '\\0';\n\t}\n\treturn ptr;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "((char *)ptr) + len_a",
            "b",
            "len_b"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ptr",
            "a",
            "len_a"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pool_malloc",
          "args": [
            "pool",
            "(uint32_t)(len_a + len_b + 1)"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_mallocz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "181-188",
          "snippet": "void *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nvoid *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "b"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "a"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "pool && pool->item_size == sizeof(char)"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nchar *git_pool_strcat(git_pool *pool, const char *a, const char *b)\n{\n\tvoid *ptr;\n\tsize_t len_a, len_b;\n\n\tassert(pool && pool->item_size == sizeof(char));\n\n\tlen_a = a ? strlen(a) : 0;\n\tlen_b = b ? strlen(b) : 0;\n\n\tif ((ptr = git_pool_malloc(pool, (uint32_t)(len_a + len_b + 1))) != NULL) {\n\t\tif (len_a)\n\t\t\tmemcpy(ptr, a, len_a);\n\t\tif (len_b)\n\t\t\tmemcpy(((char *)ptr) + len_a, b, len_b);\n\t\t*(((char *)ptr) + len_a + len_b) = '\\0';\n\t}\n\treturn ptr;\n}"
  },
  {
    "function_name": "git_pool_strdup_safe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "213-216",
    "snippet": "char *git_pool_strdup_safe(git_pool *pool, const char *str)\n{\n\treturn str ? git_pool_strdup(pool, str) : NULL;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pool_strdup",
          "args": [
            "pool",
            "str"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_strdup_safe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "213-216",
          "snippet": "char *git_pool_strdup_safe(git_pool *pool, const char *str)\n{\n\treturn str ? git_pool_strdup(pool, str) : NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nchar *git_pool_strdup_safe(git_pool *pool, const char *str)\n{\n\treturn str ? git_pool_strdup(pool, str) : NULL;\n}"
  },
  {
    "function_name": "git_pool_strdup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "207-211",
    "snippet": "char *git_pool_strdup(git_pool *pool, const char *str)\n{\n\tassert(pool && str && pool->item_size == sizeof(char));\n\treturn git_pool_strndup(pool, str, strlen(str));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pool_strndup",
          "args": [
            "pool",
            "str",
            "strlen(str)"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_strndup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "190-205",
          "snippet": "char *git_pool_strndup(git_pool *pool, const char *str, size_t n)\n{\n\tchar *ptr = NULL;\n\n\tassert(pool && str && pool->item_size == sizeof(char));\n\n\tif ((uint32_t)(n + 1) < n)\n\t\treturn NULL;\n\n\tif ((ptr = git_pool_malloc(pool, (uint32_t)(n + 1))) != NULL) {\n\t\tmemcpy(ptr, str, n);\n\t\tptr[n] = '\\0';\n\t}\n\n\treturn ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nchar *git_pool_strndup(git_pool *pool, const char *str, size_t n)\n{\n\tchar *ptr = NULL;\n\n\tassert(pool && str && pool->item_size == sizeof(char));\n\n\tif ((uint32_t)(n + 1) < n)\n\t\treturn NULL;\n\n\tif ((ptr = git_pool_malloc(pool, (uint32_t)(n + 1))) != NULL) {\n\t\tmemcpy(ptr, str, n);\n\t\tptr[n] = '\\0';\n\t}\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "pool && str && pool->item_size == sizeof(char)"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nchar *git_pool_strdup(git_pool *pool, const char *str)\n{\n\tassert(pool && str && pool->item_size == sizeof(char));\n\treturn git_pool_strndup(pool, str, strlen(str));\n}"
  },
  {
    "function_name": "git_pool_strndup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "190-205",
    "snippet": "char *git_pool_strndup(git_pool *pool, const char *str, size_t n)\n{\n\tchar *ptr = NULL;\n\n\tassert(pool && str && pool->item_size == sizeof(char));\n\n\tif ((uint32_t)(n + 1) < n)\n\t\treturn NULL;\n\n\tif ((ptr = git_pool_malloc(pool, (uint32_t)(n + 1))) != NULL) {\n\t\tmemcpy(ptr, str, n);\n\t\tptr[n] = '\\0';\n\t}\n\n\treturn ptr;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ptr",
            "str",
            "n"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pool_malloc",
          "args": [
            "pool",
            "(uint32_t)(n + 1)"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_mallocz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "181-188",
          "snippet": "void *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nvoid *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "pool && str && pool->item_size == sizeof(char)"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nchar *git_pool_strndup(git_pool *pool, const char *str, size_t n)\n{\n\tchar *ptr = NULL;\n\n\tassert(pool && str && pool->item_size == sizeof(char));\n\n\tif ((uint32_t)(n + 1) < n)\n\t\treturn NULL;\n\n\tif ((ptr = git_pool_malloc(pool, (uint32_t)(n + 1))) != NULL) {\n\t\tmemcpy(ptr, str, n);\n\t\tptr[n] = '\\0';\n\t}\n\n\treturn ptr;\n}"
  },
  {
    "function_name": "git_pool_mallocz",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "181-188",
    "snippet": "void *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ptr",
            "0x0",
            "size"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool_alloc",
          "args": [
            "pool",
            "size"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "pool_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "136-143",
          "snippet": "static void *pool_alloc(git_pool *pool, uint32_t size) {\n\tvoid *ptr = NULL;\n\tif((ptr = git__malloc(size)) == NULL) {\n\t\treturn NULL;\n\t}\n\tgit_vector_insert_sorted(&pool->allocations, ptr, NULL);\n\treturn ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nstatic void *pool_alloc(git_pool *pool, uint32_t size) {\n\tvoid *ptr = NULL;\n\tif((ptr = git__malloc(size)) == NULL) {\n\t\treturn NULL;\n\t}\n\tgit_vector_insert_sorted(&pool->allocations, ptr, NULL);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_size",
          "args": [
            "pool",
            "items"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "164-174",
          "snippet": "static uint32_t alloc_size(git_pool *pool, uint32_t count)\n{\n\tconst uint32_t align = sizeof(void *) - 1;\n\n\tif (pool->item_size > 1) {\n\t\tconst uint32_t item_size = (pool->item_size + align) & ~align;\n\t\treturn item_size * count;\n\t}\n\n\treturn (count + align) & ~align;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic uint32_t alloc_size(git_pool *pool, uint32_t count)\n{\n\tconst uint32_t align = sizeof(void *) - 1;\n\n\tif (pool->item_size > 1) {\n\t\tconst uint32_t item_size = (pool->item_size + align) & ~align;\n\t\treturn item_size * count;\n\t}\n\n\treturn (count + align) & ~align;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nvoid *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}"
  },
  {
    "function_name": "git_pool_malloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "176-179",
    "snippet": "void *git_pool_malloc(git_pool *pool, uint32_t items)\n{\n\treturn pool_alloc(pool, alloc_size(pool, items));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pool_alloc",
          "args": [
            "pool",
            "alloc_size(pool, items)"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "pool_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "136-143",
          "snippet": "static void *pool_alloc(git_pool *pool, uint32_t size) {\n\tvoid *ptr = NULL;\n\tif((ptr = git__malloc(size)) == NULL) {\n\t\treturn NULL;\n\t}\n\tgit_vector_insert_sorted(&pool->allocations, ptr, NULL);\n\treturn ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nstatic void *pool_alloc(git_pool *pool, uint32_t size) {\n\tvoid *ptr = NULL;\n\tif((ptr = git__malloc(size)) == NULL) {\n\t\treturn NULL;\n\t}\n\tgit_vector_insert_sorted(&pool->allocations, ptr, NULL);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_size",
          "args": [
            "pool",
            "items"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "164-174",
          "snippet": "static uint32_t alloc_size(git_pool *pool, uint32_t count)\n{\n\tconst uint32_t align = sizeof(void *) - 1;\n\n\tif (pool->item_size > 1) {\n\t\tconst uint32_t item_size = (pool->item_size + align) & ~align;\n\t\treturn item_size * count;\n\t}\n\n\treturn (count + align) & ~align;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic uint32_t alloc_size(git_pool *pool, uint32_t count)\n{\n\tconst uint32_t align = sizeof(void *) - 1;\n\n\tif (pool->item_size > 1) {\n\t\tconst uint32_t item_size = (pool->item_size + align) & ~align;\n\t\treturn item_size * count;\n\t}\n\n\treturn (count + align) & ~align;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid *git_pool_malloc(git_pool *pool, uint32_t items)\n{\n\treturn pool_alloc(pool, alloc_size(pool, items));\n}"
  },
  {
    "function_name": "alloc_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "164-174",
    "snippet": "static uint32_t alloc_size(git_pool *pool, uint32_t count)\n{\n\tconst uint32_t align = sizeof(void *) - 1;\n\n\tif (pool->item_size > 1) {\n\t\tconst uint32_t item_size = (pool->item_size + align) & ~align;\n\t\treturn item_size * count;\n\t}\n\n\treturn (count + align) & ~align;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic uint32_t alloc_size(git_pool *pool, uint32_t count)\n{\n\tconst uint32_t align = sizeof(void *) - 1;\n\n\tif (pool->item_size > 1) {\n\t\tconst uint32_t item_size = (pool->item_size + align) & ~align;\n\t\treturn item_size * count;\n\t}\n\n\treturn (count + align) & ~align;\n}"
  },
  {
    "function_name": "git_pool_swap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "152-162",
    "snippet": "void git_pool_swap(git_pool *a, git_pool *b)\n{\n\tgit_pool temp;\n\n\tif (a == b)\n\t\treturn;\n\n\tmemcpy(&temp, a, sizeof(temp));\n\tmemcpy(a, b, sizeof(temp));\n\tmemcpy(b, &temp, sizeof(temp));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "b",
            "&temp",
            "sizeof(temp)"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "a",
            "b",
            "sizeof(temp)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&temp",
            "a",
            "sizeof(temp)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_swap(git_pool *a, git_pool *b)\n{\n\tgit_pool temp;\n\n\tif (a == b)\n\t\treturn;\n\n\tmemcpy(&temp, a, sizeof(temp));\n\tmemcpy(a, b, sizeof(temp));\n\tmemcpy(b, &temp, sizeof(temp));\n}"
  },
  {
    "function_name": "git_pool__ptr_in_pool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "145-149",
    "snippet": "bool git_pool__ptr_in_pool(git_pool *pool, void *ptr)\n{\n\tsize_t pos;\n\treturn git_vector_bsearch(&pos, &pool->allocations, ptr) != GIT_ENOTFOUND;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_bsearch",
          "args": [
            "&pos",
            "&pool->allocations",
            "ptr"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_bsearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "55-58",
          "snippet": "GIT_INLINE(int) git_vector_bsearch(size_t *at_pos, git_vector *v, const void *key)\n{\n\treturn git_vector_bsearch2(at_pos, v, v->_cmp, key);\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(int) git_vector_bsearch(size_t *at_pos, git_vector *v, const void *key)\n{\n\treturn git_vector_bsearch2(at_pos, v, v->_cmp, key);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nbool git_pool__ptr_in_pool(git_pool *pool, void *ptr)\n{\n\tsize_t pos;\n\treturn git_vector_bsearch(&pos, &pool->allocations, ptr) != GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "pool_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "136-143",
    "snippet": "static void *pool_alloc(git_pool *pool, uint32_t size) {\n\tvoid *ptr = NULL;\n\tif((ptr = git__malloc(size)) == NULL) {\n\t\treturn NULL;\n\t}\n\tgit_vector_insert_sorted(&pool->allocations, ptr, NULL);\n\treturn ptr;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_insert_sorted",
          "args": [
            "&pool->allocations",
            "ptr",
            "NULL"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert_sorted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "141-173",
          "snippet": "int git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert_sorted(\n\tgit_vector *v, void *element, int (*on_dup)(void **old, void *new))\n{\n\tint result;\n\tsize_t pos;\n\n\tassert(v && v->_cmp);\n\n\tif (!git_vector_is_sorted(v))\n\t\tgit_vector_sort(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\t/* If we find the element and have a duplicate handler callback,\n\t * invoke it.  If it returns non-zero, then cancel insert, otherwise\n\t * proceed with normal insert.\n\t */\n\tif (!git__bsearch(v->contents, v->length, element, v->_cmp, &pos) &&\n\t\ton_dup && (result = on_dup(&v->contents[pos], element)) < 0)\n\t\treturn result;\n\n\t/* shift elements to the right */\n\tif (pos < v->length)\n\t\tmemmove(v->contents + pos + 1, v->contents + pos,\n\t\t        (v->length - pos) * sizeof(void *));\n\n\tv->contents[pos] = element;\n\tv->length++;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "size"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nstatic void *pool_alloc(git_pool *pool, uint32_t size) {\n\tvoid *ptr = NULL;\n\tif((ptr = git__malloc(size)) == NULL) {\n\t\treturn NULL;\n\t}\n\tgit_vector_insert_sorted(&pool->allocations, ptr, NULL);\n\treturn ptr;\n}"
  },
  {
    "function_name": "git_pool_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "131-134",
    "snippet": "void git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_free_deep",
          "args": [
            "&pool->allocations"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}"
  },
  {
    "function_name": "git_pool_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "120-129",
    "snippet": "void git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "&pool->allocations",
            "100",
            "git_pool__ptr_cmp"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pool__system_page_size",
          "args": [],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool__system_page_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "16-29",
          "snippet": "uint32_t git_pool__system_page_size(void)\n{\n\tstatic uint32_t size = 0;\n\n\tif (!size) {\n\t\tsize_t page_size;\n\t\tif (git__page_size(&page_size) < 0)\n\t\t\tpage_size = 4096;\n\t\t/* allow space for malloc overhead */\n\t\tsize = page_size - (2 * sizeof(void *)) - sizeof(git_pool_page);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nuint32_t git_pool__system_page_size(void)\n{\n\tstatic uint32_t size = 0;\n\n\tif (!size) {\n\t\tsize_t page_size;\n\t\tif (git__page_size(&page_size) < 0)\n\t\t\tpage_size = 4096;\n\t\t/* allow space for malloc overhead */\n\t\tsize = page_size - (2 * sizeof(void *)) - sizeof(git_pool_page);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pool",
            "0",
            "sizeof(git_pool)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "item_size >= 1"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "pool"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}"
  },
  {
    "function_name": "git_pool__ptr_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "107-118",
    "snippet": "static int git_pool__ptr_cmp(const void * a, const void * b)\n{\n\tif(a > b) {\n\t\treturn 1;\n\t}\n\tif(a < b) {\n\t\treturn -1;\n\t}\n\telse {\n\t\treturn 0;\n\t}\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic int git_pool__ptr_cmp(const void * a, const void * b)\n{\n\tif(a > b) {\n\t\treturn 1;\n\t}\n\tif(a < b) {\n\t\treturn -1;\n\t}\n\telse {\n\t\treturn 0;\n\t}\n}"
  },
  {
    "function_name": "git_pool__ptr_in_pool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "95-103",
    "snippet": "bool git_pool__ptr_in_pool(git_pool *pool, void *ptr)\n{\n\tgit_pool_page *scan;\n\tfor (scan = pool->pages; scan != NULL; scan = scan->next)\n\t\tif ((void *)scan->data <= ptr &&\n\t\t\t(void *)(((char *)scan->data) + scan->size) > ptr)\n\t\t\treturn true;\n\treturn false;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nbool git_pool__ptr_in_pool(git_pool *pool, void *ptr)\n{\n\tgit_pool_page *scan;\n\tfor (scan = pool->pages; scan != NULL; scan = scan->next)\n\t\tif ((void *)scan->data <= ptr &&\n\t\t\t(void *)(((char *)scan->data) + scan->size) > ptr)\n\t\t\treturn true;\n\treturn false;\n}"
  },
  {
    "function_name": "git_pool__open_pages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "87-93",
    "snippet": "uint32_t git_pool__open_pages(git_pool *pool)\n{\n\tuint32_t ct = 0;\n\tgit_pool_page *scan;\n\tfor (scan = pool->pages; scan != NULL; scan = scan->next) ct++;\n\treturn ct;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nuint32_t git_pool__open_pages(git_pool *pool)\n{\n\tuint32_t ct = 0;\n\tgit_pool_page *scan;\n\tfor (scan = pool->pages; scan != NULL; scan = scan->next) ct++;\n\treturn ct;\n}"
  },
  {
    "function_name": "pool_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "73-85",
    "snippet": "static void *pool_alloc(git_pool *pool, uint32_t size)\n{\n\tgit_pool_page *page = pool->pages;\n\tvoid *ptr = NULL;\n\n\tif (!page || page->avail < size)\n\t\treturn pool_alloc_page(pool, size);\n\n\tptr = &page->data[page->size - page->avail];\n\tpage->avail -= size;\n\n\treturn ptr;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pool_alloc_page",
          "args": [
            "pool",
            "size"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "pool_alloc_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "54-71",
          "snippet": "static void *pool_alloc_page(git_pool *pool, uint32_t size)\n{\n\tgit_pool_page *page;\n\tconst uint32_t new_page_size = (size <= pool->page_size) ? pool->page_size : size;\n\tsize_t alloc_size;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloc_size, new_page_size, sizeof(git_pool_page)) ||\n\t\t!(page = git__malloc(alloc_size)))\n\t\treturn NULL;\n\n\tpage->size = new_page_size;\n\tpage->avail = new_page_size - size;\n\tpage->next = pool->pages;\n\n\tpool->pages = page;\n\n\treturn page->data;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size)\n{\n\tgit_pool_page *page;\n\tconst uint32_t new_page_size = (size <= pool->page_size) ? pool->page_size : size;\n\tsize_t alloc_size;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloc_size, new_page_size, sizeof(git_pool_page)) ||\n\t\t!(page = git__malloc(alloc_size)))\n\t\treturn NULL;\n\n\tpage->size = new_page_size;\n\tpage->avail = new_page_size - size;\n\tpage->next = pool->pages;\n\n\tpool->pages = page;\n\n\treturn page->data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nstatic void *pool_alloc(git_pool *pool, uint32_t size)\n{\n\tgit_pool_page *page = pool->pages;\n\tvoid *ptr = NULL;\n\n\tif (!page || page->avail < size)\n\t\treturn pool_alloc_page(pool, size);\n\n\tptr = &page->data[page->size - page->avail];\n\tpage->avail -= size;\n\n\treturn ptr;\n}"
  },
  {
    "function_name": "pool_alloc_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "54-71",
    "snippet": "static void *pool_alloc_page(git_pool *pool, uint32_t size)\n{\n\tgit_pool_page *page;\n\tconst uint32_t new_page_size = (size <= pool->page_size) ? pool->page_size : size;\n\tsize_t alloc_size;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloc_size, new_page_size, sizeof(git_pool_page)) ||\n\t\t!(page = git__malloc(alloc_size)))\n\t\treturn NULL;\n\n\tpage->size = new_page_size;\n\tpage->avail = new_page_size - size;\n\tpage->next = pool->pages;\n\n\tpool->pages = page;\n\n\treturn page->data;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "alloc_size"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_ADD_SIZET_OVERFLOW",
          "args": [
            "&alloc_size",
            "new_page_size",
            "sizeof(git_pool_page)"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size)\n{\n\tgit_pool_page *page;\n\tconst uint32_t new_page_size = (size <= pool->page_size) ? pool->page_size : size;\n\tsize_t alloc_size;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloc_size, new_page_size, sizeof(git_pool_page)) ||\n\t\t!(page = git__malloc(alloc_size)))\n\t\treturn NULL;\n\n\tpage->size = new_page_size;\n\tpage->avail = new_page_size - size;\n\tpage->next = pool->pages;\n\n\tpool->pages = page;\n\n\treturn page->data;\n}"
  },
  {
    "function_name": "git_pool_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "42-52",
    "snippet": "void git_pool_clear(git_pool *pool)\n{\n\tgit_pool_page *scan, *next;\n\n\tfor (scan = pool->pages; scan != NULL; scan = next) {\n\t\tnext = scan->next;\n\t\tgit__free(scan);\n\t}\n\n\tpool->pages = NULL;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "scan"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_clear(git_pool *pool)\n{\n\tgit_pool_page *scan, *next;\n\n\tfor (scan = pool->pages; scan != NULL; scan = next) {\n\t\tnext = scan->next;\n\t\tgit__free(scan);\n\t}\n\n\tpool->pages = NULL;\n}"
  },
  {
    "function_name": "git_pool_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "32-40",
    "snippet": "void git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pool__system_page_size",
          "args": [],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool__system_page_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "16-29",
          "snippet": "uint32_t git_pool__system_page_size(void)\n{\n\tstatic uint32_t size = 0;\n\n\tif (!size) {\n\t\tsize_t page_size;\n\t\tif (git__page_size(&page_size) < 0)\n\t\t\tpage_size = 4096;\n\t\t/* allow space for malloc overhead */\n\t\tsize = page_size - (2 * sizeof(void *)) - sizeof(git_pool_page);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nuint32_t git_pool__system_page_size(void)\n{\n\tstatic uint32_t size = 0;\n\n\tif (!size) {\n\t\tsize_t page_size;\n\t\tif (git__page_size(&page_size) < 0)\n\t\t\tpage_size = 4096;\n\t\t/* allow space for malloc overhead */\n\t\tsize = page_size - (2 * sizeof(void *)) - sizeof(git_pool_page);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pool",
            "0",
            "sizeof(git_pool)"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "item_size >= 1"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "pool"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n}"
  },
  {
    "function_name": "git_pool__system_page_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
    "lines": "16-29",
    "snippet": "uint32_t git_pool__system_page_size(void)\n{\n\tstatic uint32_t size = 0;\n\n\tif (!size) {\n\t\tsize_t page_size;\n\t\tif (git__page_size(&page_size) < 0)\n\t\t\tpage_size = 4096;\n\t\t/* allow space for malloc overhead */\n\t\tsize = page_size - (2 * sizeof(void *)) - sizeof(git_pool_page);\n\t}\n\n\treturn size;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include \"posix.h\"",
      "#include \"pool.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__page_size",
          "args": [
            "&page_size"
          ],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "git__page_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "220-225",
          "snippet": "int git__page_size(size_t *page_size)\n{\n\t/* dummy; here we don't need any alignment anyway */\n\t*page_size = 4096;\n\treturn 0;\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git__page_size(size_t *page_size)\n{\n\t/* dummy; here we don't need any alignment anyway */\n\t*page_size = 4096;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nuint32_t git_pool__system_page_size(void)\n{\n\tstatic uint32_t size = 0;\n\n\tif (!size) {\n\t\tsize_t page_size;\n\t\tif (git__page_size(&page_size) < 0)\n\t\t\tpage_size = 4096;\n\t\t/* allow space for malloc overhead */\n\t\tsize = page_size - (2 * sizeof(void *)) - sizeof(git_pool_page);\n\t}\n\n\treturn size;\n}"
  }
]