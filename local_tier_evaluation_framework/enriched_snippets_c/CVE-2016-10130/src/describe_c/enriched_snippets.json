[
  {
    "function_name": "git_describe_init_format_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "888-893",
    "snippet": "int git_describe_init_format_options(git_describe_format_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_describe_format_options, GIT_DESCRIBE_FORMAT_OPTIONS_INIT);\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_INIT_STRUCTURE_FROM_TEMPLATE",
          "args": [
            "opts",
            "version",
            "git_describe_format_options",
            "GIT_DESCRIBE_FORMAT_OPTIONS_INIT"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nint git_describe_init_format_options(git_describe_format_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_describe_format_options, GIT_DESCRIBE_FORMAT_OPTIONS_INIT);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_describe_init_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "881-886",
    "snippet": "int git_describe_init_options(git_describe_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_describe_options, GIT_DESCRIBE_OPTIONS_INIT);\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_INIT_STRUCTURE_FROM_TEMPLATE",
          "args": [
            "opts",
            "version",
            "git_describe_options",
            "GIT_DESCRIBE_OPTIONS_INIT"
          ],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nint git_describe_init_options(git_describe_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_describe_options, GIT_DESCRIBE_OPTIONS_INIT);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_describe_result_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "860-879",
    "snippet": "void git_describe_result_free(git_describe_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tif (result->name) {\n\t\tgit_tag_free(result->name->tag);\n\t\tgit__free(result->name->path);\n\t\tgit__free(result->name);\n\t}\n\n\tif (result->tag) {\n\t\tgit_tag_free(result->tag->name->tag);\n\t\tgit__free(result->tag->name->path);\n\t\tgit__free(result->tag->name);\n\t\tgit__free(result->tag);\n\t}\n\n\tgit__free(result);\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "result"
          ],
          "line": 878
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tag_free",
          "args": [
            "result->tag->name->tag"
          ],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "git_tag_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "88-91",
          "snippet": "void git_tag_free(git_tag *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tag_free(git_tag *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nvoid git_describe_result_free(git_describe_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tif (result->name) {\n\t\tgit_tag_free(result->name->tag);\n\t\tgit__free(result->name->path);\n\t\tgit__free(result->name);\n\t}\n\n\tif (result->tag) {\n\t\tgit_tag_free(result->tag->name->tag);\n\t\tgit__free(result->tag->name->path);\n\t\tgit__free(result->tag->name);\n\t\tgit__free(result->tag);\n\t}\n\n\tgit__free(result);\n}"
  },
  {
    "function_name": "git_describe_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "780-858",
    "snippet": "int git_describe_format(git_buf *out, const git_describe_result *result, const git_describe_format_options *given)\n{\n\tint error;\n\tgit_repository *repo;\n\tstruct commit_name *name;\n\tgit_describe_format_options opts;\n\n\tassert(out && result);\n\n\tGITERR_CHECK_VERSION(given, GIT_DESCRIBE_FORMAT_OPTIONS_VERSION, \"git_describe_format_options\");\n\tnormalize_format_options(&opts, given);\n\n\tgit_buf_sanitize(out);\n\n\n\tif (opts.always_use_long_format && opts.abbreviated_size == 0) {\n\t\tgiterr_set(GITERR_DESCRIBE, \"Cannot describe - \"\n\t\t\t\"'always_use_long_format' is incompatible with a zero\"\n\t\t\t\"'abbreviated_size'\");\n\t\treturn -1;\n\t}\n\n\n\trepo = result->repo;\n\n\t/* If we did find an exact match, then it's the easier method */\n\tif (result->exact_match) {\n\t\tname = result->name;\n\t\tif ((error = display_name(out, repo, name)) < 0)\n\t\t\treturn error;\n\n\t\tif (opts.always_use_long_format) {\n\t\t\tconst git_oid *id = name->tag ? git_tag_target_id(name->tag) : &result->commit_id;\n\t\t\tif ((error = show_suffix(out, 0, repo, id, opts.abbreviated_size)) < 0)\n\t\t\t\treturn error;\n\t\t}\n\n\t\tif (result->dirty && opts.dirty_suffix)\n\t\t\tgit_buf_puts(out, opts.dirty_suffix);\n\n\t\treturn git_buf_oom(out) ? -1 : 0;\n\t}\n\n\t/* If we didn't find *any* tags, we fall back to the commit's id */\n\tif (result->fallback_to_id) {\n\t\tchar hex_oid[GIT_OID_HEXSZ + 1] = {0};\n\t\tint size = 0;\n\n\t\tif ((error = find_unique_abbrev_size(\n\t\t\t     &size, repo, &result->commit_id, opts.abbreviated_size)) < 0)\n\t\t\treturn -1;\n\n\t\tgit_oid_fmt(hex_oid, &result->commit_id);\n\t\tgit_buf_put(out, hex_oid, size);\n\n\t\tif (result->dirty && opts.dirty_suffix)\n\t\t\tgit_buf_puts(out, opts.dirty_suffix);\n\n\t\treturn git_buf_oom(out) ? -1 : 0;\n\t}\n\n\t/* Lastly, if we found a matching tag, we show that */\n\tname = result->tag->name;\n\n\tif ((error = display_name(out, repo, name)) < 0)\n\t\treturn error;\n\n\tif (opts.abbreviated_size) {\n\t\tif ((error = show_suffix(out, result->tag->depth, repo,\n\t\t\t&result->commit_id, opts.abbreviated_size)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif (result->dirty && opts.dirty_suffix) {\n\t\tgit_buf_puts(out, opts.dirty_suffix);\n\t}\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "out",
            "opts.dirty_suffix"
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "show_suffix",
          "args": [
            "out",
            "result->tag->depth",
            "repo",
            "&result->commit_id",
            "opts.abbreviated_size"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "show_suffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "399-420",
          "snippet": "static int show_suffix(\n\tgit_buf *buf,\n\tint depth,\n\tgit_repository *repo,\n\tconst git_oid* id,\n\tsize_t abbrev_size)\n{\n\tint error, size = 0;\n\n\tchar hex_oid[GIT_OID_HEXSZ];\n\n\tif ((error = find_unique_abbrev_size(&size, repo, id, abbrev_size)) < 0)\n\t\treturn error;\n\n\tgit_oid_fmt(hex_oid, id);\n\n\tgit_buf_printf(buf, \"-%d-g\", depth);\n\n\tgit_buf_put(buf, hex_oid, size);\n\n\treturn git_buf_oom(buf) ? -1 : 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int show_suffix(\n\tgit_buf *buf,\n\tint depth,\n\tgit_repository *repo,\n\tconst git_oid* id,\n\tsize_t abbrev_size)\n{\n\tint error, size = 0;\n\n\tchar hex_oid[GIT_OID_HEXSZ];\n\n\tif ((error = find_unique_abbrev_size(&size, repo, id, abbrev_size)) < 0)\n\t\treturn error;\n\n\tgit_oid_fmt(hex_oid, id);\n\n\tgit_buf_printf(buf, \"-%d-g\", depth);\n\n\tgit_buf_put(buf, hex_oid, size);\n\n\treturn git_buf_oom(buf) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "display_name",
          "args": [
            "out",
            "repo",
            "name"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "display_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "334-363",
          "snippet": "static int display_name(git_buf *buf, git_repository *repo, struct commit_name *n)\n{\n\tif (n->prio == 2 && !n->tag) {\n\t\tif (git_tag_lookup(&n->tag, repo, &n->sha1) < 0) {\n\t\t\tgiterr_set(GITERR_TAG, \"Annotated tag '%s' not available\", n->path);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif (n->tag && !n->name_checked) {\n\t\tif (!git_tag_name(n->tag)) {\n\t\t\tgiterr_set(GITERR_TAG, \"Annotated tag '%s' has no embedded name\", n->path);\n\t\t\treturn -1;\n\t\t}\n\n\t\t/* TODO: Cope with warnings\n\t\tif (strcmp(n->tag->tag, all ? n->path + 5 : n->path))\n\t\t\twarning(_(\"tag '%s' is really '%s' here\"), n->tag->tag, n->path);\n\t\t*/\n\n\t\tn->name_checked = 1;\n\t}\n\n\tif (n->tag)\n\t\tgit_buf_printf(buf, \"%s\", git_tag_name(n->tag));\n\telse\n\t\tgit_buf_printf(buf, \"%s\", n->path);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int display_name(git_buf *buf, git_repository *repo, struct commit_name *n)\n{\n\tif (n->prio == 2 && !n->tag) {\n\t\tif (git_tag_lookup(&n->tag, repo, &n->sha1) < 0) {\n\t\t\tgiterr_set(GITERR_TAG, \"Annotated tag '%s' not available\", n->path);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif (n->tag && !n->name_checked) {\n\t\tif (!git_tag_name(n->tag)) {\n\t\t\tgiterr_set(GITERR_TAG, \"Annotated tag '%s' has no embedded name\", n->path);\n\t\t\treturn -1;\n\t\t}\n\n\t\t/* TODO: Cope with warnings\n\t\tif (strcmp(n->tag->tag, all ? n->path + 5 : n->path))\n\t\t\twarning(_(\"tag '%s' is really '%s' here\"), n->tag->tag, n->path);\n\t\t*/\n\n\t\tn->name_checked = 1;\n\t}\n\n\tif (n->tag)\n\t\tgit_buf_printf(buf, \"%s\", git_tag_name(n->tag));\n\telse\n\t\tgit_buf_printf(buf, \"%s\", n->path);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "out",
            "hex_oid",
            "size"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "hex_oid",
            "&result->commit_id"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_unique_abbrev_size",
          "args": [
            "&size",
            "repo",
            "&result->commit_id",
            "opts.abbreviated_size"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "find_unique_abbrev_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "365-397",
          "snippet": "static int find_unique_abbrev_size(\n\tint *out,\n\tgit_repository *repo,\n\tconst git_oid *oid_in,\n\tint abbreviated_size)\n{\n\tsize_t size = abbreviated_size;\n\tgit_odb *odb;\n\tgit_oid dummy;\n\tint error;\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0)\n\t\treturn error;\n\n\twhile (size < GIT_OID_HEXSZ) {\n\t\tif ((error = git_odb_exists_prefix(&dummy, odb, oid_in, size)) == 0) {\n\t\t\t*out = (int) size;\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* If the error wasn't that it's not unique, then it's a proper error */\n\t\tif (error != GIT_EAMBIGUOUS)\n\t\t\treturn error;\n\n\t\t/* Try again with a larger size */\n\t\tsize++;\n\t}\n\n\t/* If we didn't find any shorter prefix, we have to do the whole thing */\n\t*out = GIT_OID_HEXSZ;\n\t\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int find_unique_abbrev_size(\n\tint *out,\n\tgit_repository *repo,\n\tconst git_oid *oid_in,\n\tint abbreviated_size)\n{\n\tsize_t size = abbreviated_size;\n\tgit_odb *odb;\n\tgit_oid dummy;\n\tint error;\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0)\n\t\treturn error;\n\n\twhile (size < GIT_OID_HEXSZ) {\n\t\tif ((error = git_odb_exists_prefix(&dummy, odb, oid_in, size)) == 0) {\n\t\t\t*out = (int) size;\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* If the error wasn't that it's not unique, then it's a proper error */\n\t\tif (error != GIT_EAMBIGUOUS)\n\t\t\treturn error;\n\n\t\t/* Try again with a larger size */\n\t\tsize++;\n\t}\n\n\t/* If we didn't find any shorter prefix, we have to do the whole thing */\n\t*out = GIT_OID_HEXSZ;\n\t\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tag_target_id",
          "args": [
            "name->tag"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "git_tag_target_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tag.c",
          "lines": "33-37",
          "snippet": "const git_oid *git_tag_target_id(const git_tag *t)\n{\n\tassert(t);\n\treturn &t->target;\n}",
          "includes": [
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/odb_backend.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst git_oid *git_tag_target_id(const git_tag *t)\n{\n\tassert(t);\n\treturn &t->target;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_DESCRIBE",
            "\"Cannot describe - \"\n\t\t\t\"'always_use_long_format' is incompatible with a zero\"\n\t\t\t\"'abbreviated_size'\""
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "out"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "normalize_format_options",
          "args": [
            "&opts",
            "given"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "normalize_format_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "767-778",
          "snippet": "static int normalize_format_options(\n\tgit_describe_format_options *dst,\n\tconst git_describe_format_options *src)\n{\n\tif (!src) {\n\t\tgit_describe_init_format_options(dst, GIT_DESCRIBE_FORMAT_OPTIONS_VERSION);\n\t\treturn 0;\n\t}\n\n\tmemcpy(dst, src, sizeof(git_describe_format_options));\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int normalize_format_options(\n\tgit_describe_format_options *dst,\n\tconst git_describe_format_options *src)\n{\n\tif (!src) {\n\t\tgit_describe_init_format_options(dst, GIT_DESCRIBE_FORMAT_OPTIONS_VERSION);\n\t\treturn 0;\n\t}\n\n\tmemcpy(dst, src, sizeof(git_describe_format_options));\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_VERSION",
          "args": [
            "given",
            "GIT_DESCRIBE_FORMAT_OPTIONS_VERSION",
            "\"git_describe_format_options\""
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && result"
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nint git_describe_format(git_buf *out, const git_describe_result *result, const git_describe_format_options *given)\n{\n\tint error;\n\tgit_repository *repo;\n\tstruct commit_name *name;\n\tgit_describe_format_options opts;\n\n\tassert(out && result);\n\n\tGITERR_CHECK_VERSION(given, GIT_DESCRIBE_FORMAT_OPTIONS_VERSION, \"git_describe_format_options\");\n\tnormalize_format_options(&opts, given);\n\n\tgit_buf_sanitize(out);\n\n\n\tif (opts.always_use_long_format && opts.abbreviated_size == 0) {\n\t\tgiterr_set(GITERR_DESCRIBE, \"Cannot describe - \"\n\t\t\t\"'always_use_long_format' is incompatible with a zero\"\n\t\t\t\"'abbreviated_size'\");\n\t\treturn -1;\n\t}\n\n\n\trepo = result->repo;\n\n\t/* If we did find an exact match, then it's the easier method */\n\tif (result->exact_match) {\n\t\tname = result->name;\n\t\tif ((error = display_name(out, repo, name)) < 0)\n\t\t\treturn error;\n\n\t\tif (opts.always_use_long_format) {\n\t\t\tconst git_oid *id = name->tag ? git_tag_target_id(name->tag) : &result->commit_id;\n\t\t\tif ((error = show_suffix(out, 0, repo, id, opts.abbreviated_size)) < 0)\n\t\t\t\treturn error;\n\t\t}\n\n\t\tif (result->dirty && opts.dirty_suffix)\n\t\t\tgit_buf_puts(out, opts.dirty_suffix);\n\n\t\treturn git_buf_oom(out) ? -1 : 0;\n\t}\n\n\t/* If we didn't find *any* tags, we fall back to the commit's id */\n\tif (result->fallback_to_id) {\n\t\tchar hex_oid[GIT_OID_HEXSZ + 1] = {0};\n\t\tint size = 0;\n\n\t\tif ((error = find_unique_abbrev_size(\n\t\t\t     &size, repo, &result->commit_id, opts.abbreviated_size)) < 0)\n\t\t\treturn -1;\n\n\t\tgit_oid_fmt(hex_oid, &result->commit_id);\n\t\tgit_buf_put(out, hex_oid, size);\n\n\t\tif (result->dirty && opts.dirty_suffix)\n\t\t\tgit_buf_puts(out, opts.dirty_suffix);\n\n\t\treturn git_buf_oom(out) ? -1 : 0;\n\t}\n\n\t/* Lastly, if we found a matching tag, we show that */\n\tname = result->tag->name;\n\n\tif ((error = display_name(out, repo, name)) < 0)\n\t\treturn error;\n\n\tif (opts.abbreviated_size) {\n\t\tif ((error = show_suffix(out, result->tag->depth, repo,\n\t\t\t&result->commit_id, opts.abbreviated_size)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif (result->dirty && opts.dirty_suffix) {\n\t\tgit_buf_puts(out, opts.dirty_suffix);\n\t}\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}"
  },
  {
    "function_name": "normalize_format_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "767-778",
    "snippet": "static int normalize_format_options(\n\tgit_describe_format_options *dst,\n\tconst git_describe_format_options *src)\n{\n\tif (!src) {\n\t\tgit_describe_init_format_options(dst, GIT_DESCRIBE_FORMAT_OPTIONS_VERSION);\n\t\treturn 0;\n\t}\n\n\tmemcpy(dst, src, sizeof(git_describe_format_options));\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src",
            "sizeof(git_describe_format_options)"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_describe_init_format_options",
          "args": [
            "dst",
            "GIT_DESCRIBE_FORMAT_OPTIONS_VERSION"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "git_describe_init_format_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "888-893",
          "snippet": "int git_describe_init_format_options(git_describe_format_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_describe_format_options, GIT_DESCRIBE_FORMAT_OPTIONS_INIT);\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nint git_describe_init_format_options(git_describe_format_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_describe_format_options, GIT_DESCRIBE_FORMAT_OPTIONS_INIT);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int normalize_format_options(\n\tgit_describe_format_options *dst,\n\tconst git_describe_format_options *src)\n{\n\tif (!src) {\n\t\tgit_describe_init_format_options(dst, GIT_DESCRIBE_FORMAT_OPTIONS_VERSION);\n\t\treturn 0;\n\t}\n\n\tmemcpy(dst, src, sizeof(git_describe_format_options));\n\treturn 0;\n}"
  },
  {
    "function_name": "git_describe_workdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "726-765",
    "snippet": "int git_describe_workdir(\n\tgit_describe_result **out,\n\tgit_repository *repo,\n\tgit_describe_options *opts)\n{\n\tint error;\n\tgit_oid current_id;\n\tgit_status_list *status = NULL;\n\tgit_status_options status_opts = GIT_STATUS_OPTIONS_INIT;\n\tgit_describe_result *result = NULL;\n\tgit_object *commit;\n\n\tif ((error = git_reference_name_to_id(&current_id, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_lookup(&commit, repo, &current_id, GIT_OBJ_COMMIT)) < 0)\n\t\treturn error;\n\n\t/* The first step is to perform a describe of HEAD, so we can leverage this */\n\tif ((error = git_describe_commit(&result, commit, opts)) < 0)\n\t\tgoto out;\n\n\tif ((error = git_status_list_new(&status, repo, &status_opts)) < 0)\n\t\tgoto out;\n\n\n\tif (git_status_list_entrycount(status) > 0)\n\t\tresult->dirty = 1;\n\nout:\n\tgit_object_free(commit);\n\tgit_status_list_free(status);\n\n\tif (error < 0)\n\t\tgit_describe_result_free(result);\n\telse\n\t\t*out = result;\n\n\treturn error;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_describe_result_free",
          "args": [
            "result"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "git_describe_result_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "860-879",
          "snippet": "void git_describe_result_free(git_describe_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tif (result->name) {\n\t\tgit_tag_free(result->name->tag);\n\t\tgit__free(result->name->path);\n\t\tgit__free(result->name);\n\t}\n\n\tif (result->tag) {\n\t\tgit_tag_free(result->tag->name->tag);\n\t\tgit__free(result->tag->name->path);\n\t\tgit__free(result->tag->name);\n\t\tgit__free(result->tag);\n\t}\n\n\tgit__free(result);\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nvoid git_describe_result_free(git_describe_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tif (result->name) {\n\t\tgit_tag_free(result->name->tag);\n\t\tgit__free(result->name->path);\n\t\tgit__free(result->name);\n\t}\n\n\tif (result->tag) {\n\t\tgit_tag_free(result->tag->name->tag);\n\t\tgit__free(result->tag->name->path);\n\t\tgit__free(result->tag->name);\n\t\tgit__free(result->tag);\n\t}\n\n\tgit__free(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_status_list_free",
          "args": [
            "status"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "git_status_list_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/status.c",
          "lines": "399-411",
          "snippet": "void git_status_list_free(git_status_list *status)\n{\n\tif (status == NULL)\n\t\treturn;\n\n\tgit_diff_free(status->head2idx);\n\tgit_diff_free(status->idx2wd);\n\n\tgit_vector_free_deep(&status->paired);\n\n\tgit__memzero(status, sizeof(*status));\n\tgit__free(status);\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"git2/diff.h\"",
            "#include \"index.h\"",
            "#include \"ignore.h\"",
            "#include \"repository.h\"",
            "#include \"git2/status.h\"",
            "#include \"status.h\"",
            "#include \"tree.h\"",
            "#include \"vector.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"git2/diff.h\"\n#include \"index.h\"\n#include \"ignore.h\"\n#include \"repository.h\"\n#include \"git2/status.h\"\n#include \"status.h\"\n#include \"tree.h\"\n#include \"vector.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2.h\"\n#include \"common.h\"\n\nvoid git_status_list_free(git_status_list *status)\n{\n\tif (status == NULL)\n\t\treturn;\n\n\tgit_diff_free(status->head2idx);\n\tgit_diff_free(status->idx2wd);\n\n\tgit_vector_free_deep(&status->paired);\n\n\tgit__memzero(status, sizeof(*status));\n\tgit__free(status);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "commit"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_status_list_entrycount",
          "args": [
            "status"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "git_status_list_entrycount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/status.c",
          "lines": "385-390",
          "snippet": "size_t git_status_list_entrycount(git_status_list *status)\n{\n\tassert(status);\n\n\treturn status->paired.length;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"git2/diff.h\"",
            "#include \"index.h\"",
            "#include \"ignore.h\"",
            "#include \"repository.h\"",
            "#include \"git2/status.h\"",
            "#include \"status.h\"",
            "#include \"tree.h\"",
            "#include \"vector.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"git2/diff.h\"\n#include \"index.h\"\n#include \"ignore.h\"\n#include \"repository.h\"\n#include \"git2/status.h\"\n#include \"status.h\"\n#include \"tree.h\"\n#include \"vector.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2.h\"\n#include \"common.h\"\n\nsize_t git_status_list_entrycount(git_status_list *status)\n{\n\tassert(status);\n\n\treturn status->paired.length;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_status_list_new",
          "args": [
            "&status",
            "repo",
            "&status_opts"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "git_status_list_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/status.c",
          "lines": "259-383",
          "snippet": "int git_status_list_new(\n\tgit_status_list **out,\n\tgit_repository *repo,\n\tconst git_status_options *opts)\n{\n\tgit_index *index = NULL;\n\tgit_status_list *status = NULL;\n\tgit_diff_options diffopt = GIT_DIFF_OPTIONS_INIT;\n\tgit_diff_find_options findopt = GIT_DIFF_FIND_OPTIONS_INIT;\n\tgit_tree *head = NULL;\n\tgit_status_show_t show =\n\t\topts ? opts->show : GIT_STATUS_SHOW_INDEX_AND_WORKDIR;\n\tint error = 0;\n\tunsigned int flags = opts ? opts->flags : GIT_STATUS_OPT_DEFAULTS;\n\n\t*out = NULL;\n\n\tif (status_validate_options(opts) < 0)\n\t\treturn -1;\n\n\tif ((error = git_repository__ensure_not_bare(repo, \"status\")) < 0 ||\n\t\t(error = git_repository_index(&index, repo)) < 0)\n\t\treturn error;\n\n\t/* if there is no HEAD, that's okay - we'll make an empty iterator */\n\tif ((error = git_repository_head_tree(&head, repo)) < 0) {\n\t\tif (error != GIT_ENOTFOUND && error != GIT_EUNBORNBRANCH)\n\t\t\tgoto done;\n\t\tgiterr_clear();\n\t}\n\n\t/* refresh index from disk unless prevented */\n\tif ((flags & GIT_STATUS_OPT_NO_REFRESH) == 0 &&\n\t\tgit_index_read(index, false) < 0)\n\t\tgiterr_clear();\n\n\tstatus = git_status_list_alloc(index);\n\tGITERR_CHECK_ALLOC(status);\n\n\tif (opts) {\n\t\tmemcpy(&status->opts, opts, sizeof(git_status_options));\n\t\tmemcpy(&diffopt.pathspec, &opts->pathspec, sizeof(diffopt.pathspec));\n\t}\n\n\tdiffopt.flags = GIT_DIFF_INCLUDE_TYPECHANGE;\n\tfindopt.flags = GIT_DIFF_FIND_FOR_UNTRACKED;\n\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_UNTRACKED) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_UNTRACKED;\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_IGNORED) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_IGNORED;\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_UNMODIFIED) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_UNMODIFIED;\n\tif ((flags & GIT_STATUS_OPT_RECURSE_UNTRACKED_DIRS) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_RECURSE_UNTRACKED_DIRS;\n\tif ((flags & GIT_STATUS_OPT_DISABLE_PATHSPEC_MATCH) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_DISABLE_PATHSPEC_MATCH;\n\tif ((flags & GIT_STATUS_OPT_RECURSE_IGNORED_DIRS) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_RECURSE_IGNORED_DIRS;\n\tif ((flags & GIT_STATUS_OPT_EXCLUDE_SUBMODULES) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_IGNORE_SUBMODULES;\n\tif ((flags & GIT_STATUS_OPT_UPDATE_INDEX) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_UPDATE_INDEX;\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_UNREADABLE) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_UNREADABLE;\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_UNREADABLE_AS_UNTRACKED) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_UNREADABLE_AS_UNTRACKED;\n\n\tif ((flags & GIT_STATUS_OPT_RENAMES_FROM_REWRITES) != 0)\n\t\tfindopt.flags = findopt.flags |\n\t\t\tGIT_DIFF_FIND_AND_BREAK_REWRITES |\n\t\t\tGIT_DIFF_FIND_RENAMES_FROM_REWRITES |\n\t\t\tGIT_DIFF_BREAK_REWRITES_FOR_RENAMES_ONLY;\n\n\tif (show != GIT_STATUS_SHOW_WORKDIR_ONLY) {\n\t\tif ((error = git_diff_tree_to_index(\n\t\t\t\t&status->head2idx, repo, head, index, &diffopt)) < 0)\n\t\t\tgoto done;\n\n\t\tif ((flags & GIT_STATUS_OPT_RENAMES_HEAD_TO_INDEX) != 0 &&\n\t\t\t(error = git_diff_find_similar(status->head2idx, &findopt)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif (show != GIT_STATUS_SHOW_INDEX_ONLY) {\n\t\tif ((error = git_diff_index_to_workdir(\n\t\t\t\t&status->idx2wd, repo, index, &diffopt)) < 0) {\n\t\t\tgoto done;\n\t\t}\n\n\t\tif ((flags & GIT_STATUS_OPT_RENAMES_INDEX_TO_WORKDIR) != 0 &&\n\t\t\t(error = git_diff_find_similar(status->idx2wd, &findopt)) < 0)\n\t\t\tgoto done;\n\t}\n\n\terror = git_diff__paired_foreach(\n\t\tstatus->head2idx, status->idx2wd, status_collect, status);\n\tif (error < 0)\n\t\tgoto done;\n\n\tif (flags & GIT_STATUS_OPT_SORT_CASE_SENSITIVELY)\n\t\tgit_vector_set_cmp(&status->paired, status_entry_cmp);\n\tif (flags & GIT_STATUS_OPT_SORT_CASE_INSENSITIVELY)\n\t\tgit_vector_set_cmp(&status->paired, status_entry_icmp);\n\n\tif ((flags &\n\t\t (GIT_STATUS_OPT_RENAMES_HEAD_TO_INDEX |\n\t\t  GIT_STATUS_OPT_RENAMES_INDEX_TO_WORKDIR |\n\t\t  GIT_STATUS_OPT_SORT_CASE_SENSITIVELY |\n\t\t  GIT_STATUS_OPT_SORT_CASE_INSENSITIVELY)) != 0)\n\t\tgit_vector_sort(&status->paired);\n\ndone:\n\tif (error < 0) {\n\t\tgit_status_list_free(status);\n\t\tstatus = NULL;\n\t}\n\n\t*out = status;\n\n\tgit_tree_free(head);\n\tgit_index_free(index);\n\n\treturn error;\n}",
          "includes": [
            "#include \"diff.h\"",
            "#include \"git2/diff.h\"",
            "#include \"index.h\"",
            "#include \"ignore.h\"",
            "#include \"repository.h\"",
            "#include \"git2/status.h\"",
            "#include \"status.h\"",
            "#include \"tree.h\"",
            "#include \"vector.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff.h\"\n#include \"git2/diff.h\"\n#include \"index.h\"\n#include \"ignore.h\"\n#include \"repository.h\"\n#include \"git2/status.h\"\n#include \"status.h\"\n#include \"tree.h\"\n#include \"vector.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2.h\"\n#include \"common.h\"\n\nint git_status_list_new(\n\tgit_status_list **out,\n\tgit_repository *repo,\n\tconst git_status_options *opts)\n{\n\tgit_index *index = NULL;\n\tgit_status_list *status = NULL;\n\tgit_diff_options diffopt = GIT_DIFF_OPTIONS_INIT;\n\tgit_diff_find_options findopt = GIT_DIFF_FIND_OPTIONS_INIT;\n\tgit_tree *head = NULL;\n\tgit_status_show_t show =\n\t\topts ? opts->show : GIT_STATUS_SHOW_INDEX_AND_WORKDIR;\n\tint error = 0;\n\tunsigned int flags = opts ? opts->flags : GIT_STATUS_OPT_DEFAULTS;\n\n\t*out = NULL;\n\n\tif (status_validate_options(opts) < 0)\n\t\treturn -1;\n\n\tif ((error = git_repository__ensure_not_bare(repo, \"status\")) < 0 ||\n\t\t(error = git_repository_index(&index, repo)) < 0)\n\t\treturn error;\n\n\t/* if there is no HEAD, that's okay - we'll make an empty iterator */\n\tif ((error = git_repository_head_tree(&head, repo)) < 0) {\n\t\tif (error != GIT_ENOTFOUND && error != GIT_EUNBORNBRANCH)\n\t\t\tgoto done;\n\t\tgiterr_clear();\n\t}\n\n\t/* refresh index from disk unless prevented */\n\tif ((flags & GIT_STATUS_OPT_NO_REFRESH) == 0 &&\n\t\tgit_index_read(index, false) < 0)\n\t\tgiterr_clear();\n\n\tstatus = git_status_list_alloc(index);\n\tGITERR_CHECK_ALLOC(status);\n\n\tif (opts) {\n\t\tmemcpy(&status->opts, opts, sizeof(git_status_options));\n\t\tmemcpy(&diffopt.pathspec, &opts->pathspec, sizeof(diffopt.pathspec));\n\t}\n\n\tdiffopt.flags = GIT_DIFF_INCLUDE_TYPECHANGE;\n\tfindopt.flags = GIT_DIFF_FIND_FOR_UNTRACKED;\n\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_UNTRACKED) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_UNTRACKED;\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_IGNORED) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_IGNORED;\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_UNMODIFIED) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_UNMODIFIED;\n\tif ((flags & GIT_STATUS_OPT_RECURSE_UNTRACKED_DIRS) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_RECURSE_UNTRACKED_DIRS;\n\tif ((flags & GIT_STATUS_OPT_DISABLE_PATHSPEC_MATCH) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_DISABLE_PATHSPEC_MATCH;\n\tif ((flags & GIT_STATUS_OPT_RECURSE_IGNORED_DIRS) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_RECURSE_IGNORED_DIRS;\n\tif ((flags & GIT_STATUS_OPT_EXCLUDE_SUBMODULES) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_IGNORE_SUBMODULES;\n\tif ((flags & GIT_STATUS_OPT_UPDATE_INDEX) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_UPDATE_INDEX;\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_UNREADABLE) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_UNREADABLE;\n\tif ((flags & GIT_STATUS_OPT_INCLUDE_UNREADABLE_AS_UNTRACKED) != 0)\n\t\tdiffopt.flags = diffopt.flags | GIT_DIFF_INCLUDE_UNREADABLE_AS_UNTRACKED;\n\n\tif ((flags & GIT_STATUS_OPT_RENAMES_FROM_REWRITES) != 0)\n\t\tfindopt.flags = findopt.flags |\n\t\t\tGIT_DIFF_FIND_AND_BREAK_REWRITES |\n\t\t\tGIT_DIFF_FIND_RENAMES_FROM_REWRITES |\n\t\t\tGIT_DIFF_BREAK_REWRITES_FOR_RENAMES_ONLY;\n\n\tif (show != GIT_STATUS_SHOW_WORKDIR_ONLY) {\n\t\tif ((error = git_diff_tree_to_index(\n\t\t\t\t&status->head2idx, repo, head, index, &diffopt)) < 0)\n\t\t\tgoto done;\n\n\t\tif ((flags & GIT_STATUS_OPT_RENAMES_HEAD_TO_INDEX) != 0 &&\n\t\t\t(error = git_diff_find_similar(status->head2idx, &findopt)) < 0)\n\t\t\tgoto done;\n\t}\n\n\tif (show != GIT_STATUS_SHOW_INDEX_ONLY) {\n\t\tif ((error = git_diff_index_to_workdir(\n\t\t\t\t&status->idx2wd, repo, index, &diffopt)) < 0) {\n\t\t\tgoto done;\n\t\t}\n\n\t\tif ((flags & GIT_STATUS_OPT_RENAMES_INDEX_TO_WORKDIR) != 0 &&\n\t\t\t(error = git_diff_find_similar(status->idx2wd, &findopt)) < 0)\n\t\t\tgoto done;\n\t}\n\n\terror = git_diff__paired_foreach(\n\t\tstatus->head2idx, status->idx2wd, status_collect, status);\n\tif (error < 0)\n\t\tgoto done;\n\n\tif (flags & GIT_STATUS_OPT_SORT_CASE_SENSITIVELY)\n\t\tgit_vector_set_cmp(&status->paired, status_entry_cmp);\n\tif (flags & GIT_STATUS_OPT_SORT_CASE_INSENSITIVELY)\n\t\tgit_vector_set_cmp(&status->paired, status_entry_icmp);\n\n\tif ((flags &\n\t\t (GIT_STATUS_OPT_RENAMES_HEAD_TO_INDEX |\n\t\t  GIT_STATUS_OPT_RENAMES_INDEX_TO_WORKDIR |\n\t\t  GIT_STATUS_OPT_SORT_CASE_SENSITIVELY |\n\t\t  GIT_STATUS_OPT_SORT_CASE_INSENSITIVELY)) != 0)\n\t\tgit_vector_sort(&status->paired);\n\ndone:\n\tif (error < 0) {\n\t\tgit_status_list_free(status);\n\t\tstatus = NULL;\n\t}\n\n\t*out = status;\n\n\tgit_tree_free(head);\n\tgit_index_free(index);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_describe_commit",
          "args": [
            "&result",
            "commit",
            "opts"
          ],
          "line": 745
        },
        "resolved": true,
        "details": {
          "function_name": "git_describe_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "656-724",
          "snippet": "int git_describe_commit(\n\tgit_describe_result **result,\n\tgit_object *committish,\n\tgit_describe_options *opts)\n{\n\tstruct get_name_data data;\n\tstruct commit_name *name;\n\tgit_commit *commit;\n\tint error = -1;\n\tgit_describe_options normalized;\n\n\tassert(committish);\n\n\tdata.result = git__calloc(1, sizeof(git_describe_result));\n\tGITERR_CHECK_ALLOC(data.result);\n\tdata.result->repo = git_object_owner(committish);\n\n\tdata.repo = git_object_owner(committish);\n\n\tif ((error = normalize_options(&normalized, opts)) < 0)\n\t\treturn error;\n\n\tGITERR_CHECK_VERSION(\n\t\t&normalized,\n\t\tGIT_DESCRIBE_OPTIONS_VERSION,\n\t\t\"git_describe_options\");\n\tdata.opts = &normalized;\n\n\tdata.names = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(data.names);\n\n\t/** TODO: contains to be implemented */\n\n\tif ((error = git_object_peel((git_object **)(&commit), committish, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_reference_foreach_name(\n\t\t\tgit_object_owner(committish),\n\t\t\tget_name, &data)) < 0)\n\t\t\t\tgoto cleanup;\n\n\tif (git_oidmap_size(data.names) == 0 && !opts->show_commit_oid_as_fallback) {\n\t\tgiterr_set(GITERR_DESCRIBE, \"Cannot describe - \"\n\t\t\t\"No reference found, cannot describe anything.\");\n\t\terror = -1;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = describe(&data, commit)) < 0)\n\t\tgoto cleanup;\n\ncleanup:\n\tgit_commit_free(commit);\n\n\tgit_oidmap_foreach_value(data.names, name, {\n\t\tgit_tag_free(name->tag);\n\t\tgit__free(name->path);\n\t\tgit__free(name);\n\t});\n\n\tgit_oidmap_free(data.names);\n\n\tif (error < 0)\n\t\tgit_describe_result_free(data.result);\n\telse\n\t\t*result = data.result;\n\n\treturn error;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nint git_describe_commit(\n\tgit_describe_result **result,\n\tgit_object *committish,\n\tgit_describe_options *opts)\n{\n\tstruct get_name_data data;\n\tstruct commit_name *name;\n\tgit_commit *commit;\n\tint error = -1;\n\tgit_describe_options normalized;\n\n\tassert(committish);\n\n\tdata.result = git__calloc(1, sizeof(git_describe_result));\n\tGITERR_CHECK_ALLOC(data.result);\n\tdata.result->repo = git_object_owner(committish);\n\n\tdata.repo = git_object_owner(committish);\n\n\tif ((error = normalize_options(&normalized, opts)) < 0)\n\t\treturn error;\n\n\tGITERR_CHECK_VERSION(\n\t\t&normalized,\n\t\tGIT_DESCRIBE_OPTIONS_VERSION,\n\t\t\"git_describe_options\");\n\tdata.opts = &normalized;\n\n\tdata.names = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(data.names);\n\n\t/** TODO: contains to be implemented */\n\n\tif ((error = git_object_peel((git_object **)(&commit), committish, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_reference_foreach_name(\n\t\t\tgit_object_owner(committish),\n\t\t\tget_name, &data)) < 0)\n\t\t\t\tgoto cleanup;\n\n\tif (git_oidmap_size(data.names) == 0 && !opts->show_commit_oid_as_fallback) {\n\t\tgiterr_set(GITERR_DESCRIBE, \"Cannot describe - \"\n\t\t\t\"No reference found, cannot describe anything.\");\n\t\terror = -1;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = describe(&data, commit)) < 0)\n\t\tgoto cleanup;\n\ncleanup:\n\tgit_commit_free(commit);\n\n\tgit_oidmap_foreach_value(data.names, name, {\n\t\tgit_tag_free(name->tag);\n\t\tgit__free(name->path);\n\t\tgit__free(name);\n\t});\n\n\tgit_oidmap_free(data.names);\n\n\tif (error < 0)\n\t\tgit_describe_result_free(data.result);\n\telse\n\t\t*result = data.result;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_lookup",
          "args": [
            "&commit",
            "repo",
            "&current_id",
            "GIT_OBJ_COMMIT"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_lookup_bypath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "390-423",
          "snippet": "int git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_name_to_id",
          "args": [
            "&current_id",
            "repo",
            "GIT_HEAD_FILE"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "152-164",
          "snippet": "int git_reference_name_to_id(\n\tgit_oid *out, git_repository *repo, const char *name)\n{\n\tint error;\n\tgit_reference *ref;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, name, -1)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(out, git_reference_target(ref));\n\tgit_reference_free(ref);\n\treturn 0;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_name_to_id(\n\tgit_oid *out, git_repository *repo, const char *name)\n{\n\tint error;\n\tgit_reference *ref;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, name, -1)) < 0)\n\t\treturn error;\n\n\tgit_oid_cpy(out, git_reference_target(ref));\n\tgit_reference_free(ref);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nint git_describe_workdir(\n\tgit_describe_result **out,\n\tgit_repository *repo,\n\tgit_describe_options *opts)\n{\n\tint error;\n\tgit_oid current_id;\n\tgit_status_list *status = NULL;\n\tgit_status_options status_opts = GIT_STATUS_OPTIONS_INIT;\n\tgit_describe_result *result = NULL;\n\tgit_object *commit;\n\n\tif ((error = git_reference_name_to_id(&current_id, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_lookup(&commit, repo, &current_id, GIT_OBJ_COMMIT)) < 0)\n\t\treturn error;\n\n\t/* The first step is to perform a describe of HEAD, so we can leverage this */\n\tif ((error = git_describe_commit(&result, commit, opts)) < 0)\n\t\tgoto out;\n\n\tif ((error = git_status_list_new(&status, repo, &status_opts)) < 0)\n\t\tgoto out;\n\n\n\tif (git_status_list_entrycount(status) > 0)\n\t\tresult->dirty = 1;\n\nout:\n\tgit_object_free(commit);\n\tgit_status_list_free(status);\n\n\tif (error < 0)\n\t\tgit_describe_result_free(result);\n\telse\n\t\t*out = result;\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_describe_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "656-724",
    "snippet": "int git_describe_commit(\n\tgit_describe_result **result,\n\tgit_object *committish,\n\tgit_describe_options *opts)\n{\n\tstruct get_name_data data;\n\tstruct commit_name *name;\n\tgit_commit *commit;\n\tint error = -1;\n\tgit_describe_options normalized;\n\n\tassert(committish);\n\n\tdata.result = git__calloc(1, sizeof(git_describe_result));\n\tGITERR_CHECK_ALLOC(data.result);\n\tdata.result->repo = git_object_owner(committish);\n\n\tdata.repo = git_object_owner(committish);\n\n\tif ((error = normalize_options(&normalized, opts)) < 0)\n\t\treturn error;\n\n\tGITERR_CHECK_VERSION(\n\t\t&normalized,\n\t\tGIT_DESCRIBE_OPTIONS_VERSION,\n\t\t\"git_describe_options\");\n\tdata.opts = &normalized;\n\n\tdata.names = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(data.names);\n\n\t/** TODO: contains to be implemented */\n\n\tif ((error = git_object_peel((git_object **)(&commit), committish, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_reference_foreach_name(\n\t\t\tgit_object_owner(committish),\n\t\t\tget_name, &data)) < 0)\n\t\t\t\tgoto cleanup;\n\n\tif (git_oidmap_size(data.names) == 0 && !opts->show_commit_oid_as_fallback) {\n\t\tgiterr_set(GITERR_DESCRIBE, \"Cannot describe - \"\n\t\t\t\"No reference found, cannot describe anything.\");\n\t\terror = -1;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = describe(&data, commit)) < 0)\n\t\tgoto cleanup;\n\ncleanup:\n\tgit_commit_free(commit);\n\n\tgit_oidmap_foreach_value(data.names, name, {\n\t\tgit_tag_free(name->tag);\n\t\tgit__free(name->path);\n\t\tgit__free(name);\n\t});\n\n\tgit_oidmap_free(data.names);\n\n\tif (error < 0)\n\t\tgit_describe_result_free(data.result);\n\telse\n\t\t*result = data.result;\n\n\treturn error;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_describe_result_free",
          "args": [
            "data.result"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "git_describe_result_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "860-879",
          "snippet": "void git_describe_result_free(git_describe_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tif (result->name) {\n\t\tgit_tag_free(result->name->tag);\n\t\tgit__free(result->name->path);\n\t\tgit__free(result->name);\n\t}\n\n\tif (result->tag) {\n\t\tgit_tag_free(result->tag->name->tag);\n\t\tgit__free(result->tag->name->path);\n\t\tgit__free(result->tag->name);\n\t\tgit__free(result->tag);\n\t}\n\n\tgit__free(result);\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nvoid git_describe_result_free(git_describe_result *result)\n{\n\tif (result == NULL)\n\t\treturn;\n\n\tif (result->name) {\n\t\tgit_tag_free(result->name->tag);\n\t\tgit__free(result->name->path);\n\t\tgit__free(result->name);\n\t}\n\n\tif (result->tag) {\n\t\tgit_tag_free(result->tag->name->tag);\n\t\tgit__free(result->tag->name->path);\n\t\tgit__free(result->tag->name);\n\t\tgit__free(result->tag);\n\t}\n\n\tgit__free(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oidmap_free",
          "args": [
            "data.names"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oidmap_foreach_value",
          "args": [
            "data.names",
            "name",
            "{\n\t\tgit_tag_free(name->tag);\n\t\tgit__free(name->path);\n\t\tgit__free(name);\n\t}"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "name"
          ],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tag_free",
          "args": [
            "name->tag"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "git_tag_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "88-91",
          "snippet": "void git_tag_free(git_tag *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tag_free(git_tag *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "commit"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "describe",
          "args": [
            "&data",
            "commit"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "git_describe_init_format_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "888-893",
          "snippet": "int git_describe_init_format_options(git_describe_format_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_describe_format_options, GIT_DESCRIBE_FORMAT_OPTIONS_INIT);\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nint git_describe_init_format_options(git_describe_format_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_describe_format_options, GIT_DESCRIBE_FORMAT_OPTIONS_INIT);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_DESCRIBE",
            "\"Cannot describe - \"\n\t\t\t\"No reference found, cannot describe anything.\""
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oidmap_size",
          "args": [
            "data.names"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_reference_foreach_name",
          "args": [
            "git_object_owner(committish)",
            "get_name",
            "&data"
          ],
          "line": 692
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_foreach_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "658-682",
          "snippet": "int git_reference_foreach_name(\n\tgit_repository *repo,\n\tgit_reference_foreach_name_cb callback,\n\tvoid *payload)\n{\n\tgit_reference_iterator *iter;\n\tconst char *refname;\n\tint error;\n\n\tif ((error = git_reference_iterator_new(&iter, repo)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_reference_next_name(&refname, iter))) {\n\t\tif ((error = callback(refname, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\tgit_reference_iterator_free(iter);\n\treturn error;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_foreach_name(\n\tgit_repository *repo,\n\tgit_reference_foreach_name_cb callback,\n\tvoid *payload)\n{\n\tgit_reference_iterator *iter;\n\tconst char *refname;\n\tint error;\n\n\tif ((error = git_reference_iterator_new(&iter, repo)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_reference_next_name(&refname, iter))) {\n\t\tif ((error = callback(refname, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\tgit_reference_iterator_free(iter);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_owner",
          "args": [
            "committish"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "221-225",
          "snippet": "git_repository *git_object_owner(const git_object *obj)\n{\n\tassert(obj);\n\treturn obj->repo;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\ngit_repository *git_object_owner(const git_object *obj)\n{\n\tassert(obj);\n\treturn obj->repo;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_peel",
          "args": [
            "(git_object **)(&commit)",
            "committish",
            "GIT_OBJ_COMMIT"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "327-381",
          "snippet": "int git_object_peel(\n\tgit_object **peeled,\n\tconst git_object *object,\n\tgit_otype target_type)\n{\n\tgit_object *source, *deref = NULL;\n\tint error;\n\n\tassert(object && peeled);\n\n\tassert(target_type == GIT_OBJ_TAG ||\n\t\ttarget_type == GIT_OBJ_COMMIT ||\n\t\ttarget_type == GIT_OBJ_TREE ||\n\t\ttarget_type == GIT_OBJ_BLOB ||\n\t\ttarget_type == GIT_OBJ_ANY);\n\n\tif ((error = check_type_combination(git_object_type(object), target_type)) < 0)\n\t\treturn peel_error(error, git_object_id(object), target_type);\n\n\tif (git_object_type(object) == target_type)\n\t\treturn git_object_dup(peeled, (git_object *)object);\n\n\tsource = (git_object *)object;\n\n\twhile (!(error = dereference_object(&deref, source))) {\n\n\t\tif (source != object)\n\t\t\tgit_object_free(source);\n\n\t\tif (git_object_type(deref) == target_type) {\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (target_type == GIT_OBJ_ANY &&\n\t\t\tgit_object_type(deref) != git_object_type(object))\n\t\t{\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tsource = deref;\n\t\tderef = NULL;\n\t}\n\n\tif (source != object)\n\t\tgit_object_free(source);\n\n\tgit_object_free(deref);\n\n\tif (error)\n\t\terror = peel_error(error, git_object_id(object), target_type);\n\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_peel(\n\tgit_object **peeled,\n\tconst git_object *object,\n\tgit_otype target_type)\n{\n\tgit_object *source, *deref = NULL;\n\tint error;\n\n\tassert(object && peeled);\n\n\tassert(target_type == GIT_OBJ_TAG ||\n\t\ttarget_type == GIT_OBJ_COMMIT ||\n\t\ttarget_type == GIT_OBJ_TREE ||\n\t\ttarget_type == GIT_OBJ_BLOB ||\n\t\ttarget_type == GIT_OBJ_ANY);\n\n\tif ((error = check_type_combination(git_object_type(object), target_type)) < 0)\n\t\treturn peel_error(error, git_object_id(object), target_type);\n\n\tif (git_object_type(object) == target_type)\n\t\treturn git_object_dup(peeled, (git_object *)object);\n\n\tsource = (git_object *)object;\n\n\twhile (!(error = dereference_object(&deref, source))) {\n\n\t\tif (source != object)\n\t\t\tgit_object_free(source);\n\n\t\tif (git_object_type(deref) == target_type) {\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (target_type == GIT_OBJ_ANY &&\n\t\t\tgit_object_type(deref) != git_object_type(object))\n\t\t{\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tsource = deref;\n\t\tderef = NULL;\n\t}\n\n\tif (source != object)\n\t\tgit_object_free(source);\n\n\tgit_object_free(deref);\n\n\tif (error)\n\t\terror = peel_error(error, git_object_id(object), target_type);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "data.names"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oidmap_alloc",
          "args": [],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_VERSION",
          "args": [
            "&normalized",
            "GIT_DESCRIBE_OPTIONS_VERSION",
            "\"git_describe_options\""
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "normalize_options",
          "args": [
            "&normalized",
            "opts"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "normalize_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "641-654",
          "snippet": "static int normalize_options(\n\tgit_describe_options *dst,\n\tconst git_describe_options *src)\n{\n\tgit_describe_options default_options = GIT_DESCRIBE_OPTIONS_INIT;\n\tif (!src) src = &default_options;\n\n\t*dst = *src;\n\n\tif (dst->max_candidates_tags > GIT_DESCRIBE_DEFAULT_MAX_CANDIDATES_TAGS)\n\t\tdst->max_candidates_tags = GIT_DESCRIBE_DEFAULT_MAX_CANDIDATES_TAGS;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int normalize_options(\n\tgit_describe_options *dst,\n\tconst git_describe_options *src)\n{\n\tgit_describe_options default_options = GIT_DESCRIBE_OPTIONS_INIT;\n\tif (!src) src = &default_options;\n\n\t*dst = *src;\n\n\tif (dst->max_candidates_tags > GIT_DESCRIBE_DEFAULT_MAX_CANDIDATES_TAGS)\n\t\tdst->max_candidates_tags = GIT_DESCRIBE_DEFAULT_MAX_CANDIDATES_TAGS;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "data.result"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_describe_result)"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "committish"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nint git_describe_commit(\n\tgit_describe_result **result,\n\tgit_object *committish,\n\tgit_describe_options *opts)\n{\n\tstruct get_name_data data;\n\tstruct commit_name *name;\n\tgit_commit *commit;\n\tint error = -1;\n\tgit_describe_options normalized;\n\n\tassert(committish);\n\n\tdata.result = git__calloc(1, sizeof(git_describe_result));\n\tGITERR_CHECK_ALLOC(data.result);\n\tdata.result->repo = git_object_owner(committish);\n\n\tdata.repo = git_object_owner(committish);\n\n\tif ((error = normalize_options(&normalized, opts)) < 0)\n\t\treturn error;\n\n\tGITERR_CHECK_VERSION(\n\t\t&normalized,\n\t\tGIT_DESCRIBE_OPTIONS_VERSION,\n\t\t\"git_describe_options\");\n\tdata.opts = &normalized;\n\n\tdata.names = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(data.names);\n\n\t/** TODO: contains to be implemented */\n\n\tif ((error = git_object_peel((git_object **)(&commit), committish, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_reference_foreach_name(\n\t\t\tgit_object_owner(committish),\n\t\t\tget_name, &data)) < 0)\n\t\t\t\tgoto cleanup;\n\n\tif (git_oidmap_size(data.names) == 0 && !opts->show_commit_oid_as_fallback) {\n\t\tgiterr_set(GITERR_DESCRIBE, \"Cannot describe - \"\n\t\t\t\"No reference found, cannot describe anything.\");\n\t\terror = -1;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = describe(&data, commit)) < 0)\n\t\tgoto cleanup;\n\ncleanup:\n\tgit_commit_free(commit);\n\n\tgit_oidmap_foreach_value(data.names, name, {\n\t\tgit_tag_free(name->tag);\n\t\tgit__free(name->path);\n\t\tgit__free(name);\n\t});\n\n\tgit_oidmap_free(data.names);\n\n\tif (error < 0)\n\t\tgit_describe_result_free(data.result);\n\telse\n\t\t*result = data.result;\n\n\treturn error;\n}"
  },
  {
    "function_name": "normalize_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "641-654",
    "snippet": "static int normalize_options(\n\tgit_describe_options *dst,\n\tconst git_describe_options *src)\n{\n\tgit_describe_options default_options = GIT_DESCRIBE_OPTIONS_INIT;\n\tif (!src) src = &default_options;\n\n\t*dst = *src;\n\n\tif (dst->max_candidates_tags > GIT_DESCRIBE_DEFAULT_MAX_CANDIDATES_TAGS)\n\t\tdst->max_candidates_tags = GIT_DESCRIBE_DEFAULT_MAX_CANDIDATES_TAGS;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int normalize_options(\n\tgit_describe_options *dst,\n\tconst git_describe_options *src)\n{\n\tgit_describe_options default_options = GIT_DESCRIBE_OPTIONS_INIT;\n\tif (!src) src = &default_options;\n\n\t*dst = *src;\n\n\tif (dst->max_candidates_tags > GIT_DESCRIBE_DEFAULT_MAX_CANDIDATES_TAGS)\n\t\tdst->max_candidates_tags = GIT_DESCRIBE_DEFAULT_MAX_CANDIDATES_TAGS;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "describe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "432-639",
    "snippet": "static int describe(\n\tstruct get_name_data *data,\n\tgit_commit *commit)\n{\n\tstruct commit_name *n;\n\tstruct possible_tag *best;\n\tbool all, tags;\n\tgit_revwalk *walk = NULL;\n\tgit_pqueue list;\n\tgit_commit_list_node *cmit, *gave_up_on = NULL;\n\tgit_vector all_matches = GIT_VECTOR_INIT;\n\tunsigned int match_cnt = 0, annotated_cnt = 0, cur_match;\n\tunsigned long seen_commits = 0;\t/* TODO: Check long */\n\tunsigned int unannotated_cnt = 0;\n\tint error;\n\n\tif (git_vector_init(&all_matches, MAX_CANDIDATES_TAGS, compare_pt) < 0)\n\t\treturn -1;\n\n\tif ((error = git_pqueue_init(&list, 0, 2, git_commit_list_time_cmp)) < 0)\n\t\tgoto cleanup;\n\n\tall = data->opts->describe_strategy == GIT_DESCRIBE_ALL;\n\ttags = data->opts->describe_strategy == GIT_DESCRIBE_TAGS;\n\n\tgit_oid_cpy(&data->result->commit_id, git_commit_id(commit));\n\n\tn = find_commit_name(data->names, git_commit_id(commit));\n\tif (n && (tags || all || n->prio == 2)) {\n\t\t/*\n\t\t * Exact match to an existing ref.\n\t\t */\n\t\tdata->result->exact_match = 1;\n\t\tif ((error = commit_name_dup(&data->result->name, n)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tgoto cleanup;\n\t}\n\n\tif (!data->opts->max_candidates_tags) {\n\t\terror = describe_not_found(\n\t\t\tgit_commit_id(commit),\n\t\t\t\"Cannot describe - no tag exactly matches '%s'\");\n\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_revwalk_new(&walk, git_commit_owner(commit))) < 0)\n\t\tgoto cleanup;\n\n\tif ((cmit = git_revwalk__commit_lookup(walk, git_commit_id(commit))) == NULL)\n\t\tgoto cleanup;\n\n\tif ((error = git_commit_list_parse(walk, cmit)) < 0)\n\t\tgoto cleanup;\n\n\tcmit->flags = SEEN;\n\n\tif ((error = git_pqueue_insert(&list, cmit)) < 0)\n\t\tgoto cleanup;\n\n\twhile (git_pqueue_size(&list) > 0)\n\t{\n\t\tint i;\n\n\t\tgit_commit_list_node *c = (git_commit_list_node *)git_pqueue_pop(&list);\n\t\tseen_commits++;\n\n\t\tn = find_commit_name(data->names, &c->oid);\n\n\t\tif (n) {\n\t\t\tif (!tags && !all && n->prio < 2) {\n\t\t\t\tunannotated_cnt++;\n\t\t\t} else if (match_cnt < data->opts->max_candidates_tags) {\n\t\t\t\tstruct possible_tag *t = git__malloc(sizeof(struct commit_name));\n\t\t\t\tGITERR_CHECK_ALLOC(t);\n\t\t\t\tif ((error = git_vector_insert(&all_matches, t)) < 0)\n\t\t\t\t\tgoto cleanup;\n\n\t\t\t\tmatch_cnt++;\n\n\t\t\t\tt->name = n;\n\t\t\t\tt->depth = seen_commits - 1;\n\t\t\t\tt->flag_within = 1u << match_cnt;\n\t\t\t\tt->found_order = match_cnt;\n\t\t\t\tc->flags |= t->flag_within;\n\t\t\t\tif (n->prio == 2)\n\t\t\t\t\tannotated_cnt++;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgave_up_on = c;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (cur_match = 0; cur_match < match_cnt; cur_match++) {\n\t\t\tstruct possible_tag *t = git_vector_get(&all_matches, cur_match);\n\t\t\tif (!(c->flags & t->flag_within))\n\t\t\t\tt->depth++;\n\t\t}\n\n\t\tif (annotated_cnt && (git_pqueue_size(&list) == 0)) {\n\t\t\t/*\n\t\t\tif (debug) {\n\t\t\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\t\t\tgit_oid_tostr(oid_str, sizeof(oid_str), &c->oid);\n\n\t\t\t\tfprintf(stderr, \"finished search at %s\\n\", oid_str);\n\t\t\t}\n\t\t\t*/\n\t\t\tbreak;\n\t\t}\n\t\tfor (i = 0; i < c->out_degree; i++) {\n\t\t\tgit_commit_list_node *p = c->parents[i];\n\t\t\tif ((error = git_commit_list_parse(walk, p)) < 0)\n\t\t\t\tgoto cleanup;\n\t\t\tif (!(p->flags & SEEN))\n\t\t\t\tif ((error = git_pqueue_insert(&list, p)) < 0)\n\t\t\t\t\tgoto cleanup;\n\t\t\tp->flags |= c->flags;\n\n\t\t\tif (data->opts->only_follow_first_parent)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!match_cnt) {\n\t\tif (data->opts->show_commit_oid_as_fallback) {\n\t\t\tdata->result->fallback_to_id = 1;\n\t\t\tgit_oid_cpy(&data->result->commit_id, &cmit->oid);\n\n\t\t\tgoto cleanup;\n\t\t}\n\t\tif (unannotated_cnt) {\n\t\t\terror = describe_not_found(git_commit_id(commit), \n\t\t\t\t\"Cannot describe - \"\n\t\t\t\t\"No annotated tags can describe '%s'.\"\n\t\t\t    \"However, there were unannotated tags.\");\n\t\t\tgoto cleanup;\n\t\t}\n\t\telse {\n\t\t\terror = describe_not_found(git_commit_id(commit), \n\t\t\t\t\"Cannot describe - \"\n\t\t\t\t\"No tags can describe '%s'.\");\n\t\t\tgoto cleanup;\n\t\t}\n\t}\n\n\tgit_vector_sort(&all_matches);\n\n\tbest = (struct possible_tag *)git_vector_get(&all_matches, 0);\n\n\tif (gave_up_on) {\n\t\tif ((error = git_pqueue_insert(&list, gave_up_on)) < 0)\n\t\t\tgoto cleanup;\n\t\tseen_commits--;\n\t}\n\tif ((error = finish_depth_computation(\n\t\t&list, walk, best)) < 0)\n\t\tgoto cleanup;\n\n\tseen_commits += error;\n\tif ((error = possible_tag_dup(&data->result->tag, best)) < 0)\n\t\tgoto cleanup;\n\n\t/*\n\t{\n\t\tstatic const char *prio_names[] = {\n\t\t\t\"head\", \"lightweight\", \"annotated\",\n\t\t};\n\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\n\t\tif (debug) {\n\t\t\tfor (cur_match = 0; cur_match < match_cnt; cur_match++) {\n\t\t\t\tstruct possible_tag *t = (struct possible_tag *)git_vector_get(&all_matches, cur_match);\n\t\t\t\tfprintf(stderr, \" %-11s %8d %s\\n\",\n\t\t\t\t\tprio_names[t->name->prio],\n\t\t\t\t\tt->depth, t->name->path);\n\t\t\t}\n\t\t\tfprintf(stderr, \"traversed %lu commits\\n\", seen_commits);\n\t\t\tif (gave_up_on) {\n\t\t\t\tgit_oid_tostr(oid_str, sizeof(oid_str), &gave_up_on->oid);\n\t\t\t\tfprintf(stderr,\n\t\t\t\t\t\"more than %i tags found; listed %i most recent\\n\"\n\t\t\t\t\t\"gave up search at %s\\n\",\n\t\t\t\t\tdata->opts->max_candidates_tags, data->opts->max_candidates_tags,\n\t\t\t\t\toid_str);\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\n\tgit_oid_cpy(&data->result->commit_id, &cmit->oid);\n\ncleanup:\n\t{\n\t\tsize_t i;\n\t\tstruct possible_tag *match;\n\t\tgit_vector_foreach(&all_matches, i, match) {\n\t\t\tgit__free(match);\n\t\t}\n\t}\n\tgit_vector_free(&all_matches);\n\tgit_pqueue_free(&list);\n\tgit_revwalk_free(walk);\n\treturn error;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [
      "#define MAX_CANDIDATES_TAGS FLAG_BITS - 1",
      "#define SEEN (1u << 0)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_revwalk_free",
          "args": [
            "walk"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "555-567",
          "snippet": "void git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_free",
          "args": [
            "&list"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "&all_matches"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "match"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&all_matches",
            "i",
            "match"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&data->result->commit_id",
            "&cmit->oid"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "possible_tag_dup",
          "args": [
            "&data->result->tag",
            "best"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "possible_tag_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "264-283",
          "snippet": "static int possible_tag_dup(struct possible_tag **out, struct possible_tag *in)\n{\n\tstruct possible_tag *tag;\n\tint error;\n\n\ttag = git__malloc(sizeof(struct possible_tag));\n\tGITERR_CHECK_ALLOC(tag);\n\n\tmemcpy(tag, in, sizeof(struct possible_tag));\n\ttag->name = NULL;\n\n\tif ((error = commit_name_dup(&tag->name, in->name)) < 0) {\n\t\tgit__free(tag);\n\t\t*out = NULL;\n\t\treturn error;\n\t}\n\n\t*out = tag;\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int possible_tag_dup(struct possible_tag **out, struct possible_tag *in)\n{\n\tstruct possible_tag *tag;\n\tint error;\n\n\ttag = git__malloc(sizeof(struct possible_tag));\n\tGITERR_CHECK_ALLOC(tag);\n\n\tmemcpy(tag, in, sizeof(struct possible_tag));\n\ttag->name = NULL;\n\n\tif ((error = commit_name_dup(&tag->name, in->name)) < 0) {\n\t\tgit__free(tag);\n\t\t*out = NULL;\n\t\treturn error;\n\t}\n\n\t*out = tag;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "finish_depth_computation",
          "args": [
            "&list",
            "walk",
            "best"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "finish_depth_computation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "298-332",
          "snippet": "static unsigned long finish_depth_computation(\n\tgit_pqueue *list,\n\tgit_revwalk *walk,\n\tstruct possible_tag *best)\n{\n\tunsigned long seen_commits = 0;\n\tint error, i;\n\n\twhile (git_pqueue_size(list) > 0) {\n\t\tgit_commit_list_node *c = git_pqueue_pop(list);\n\t\tseen_commits++;\n\t\tif (c->flags & best->flag_within) {\n\t\t\tsize_t index = 0;\n\t\t\twhile (git_pqueue_size(list) > index) {\n\t\t\t\tgit_commit_list_node *i = git_pqueue_get(list, index);\n\t\t\t\tif (!(i->flags & best->flag_within))\n\t\t\t\t\tbreak;\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\tif (index > git_pqueue_size(list))\n\t\t\t\tbreak;\n\t\t} else\n\t\t\tbest->depth++;\n\t\tfor (i = 0; i < c->out_degree; i++) {\n\t\t\tgit_commit_list_node *p = c->parents[i];\n\t\t\tif ((error = git_commit_list_parse(walk, p)) < 0)\n\t\t\t\treturn error;\n\t\t\tif (!(p->flags & SEEN))\n\t\t\t\tif ((error = git_pqueue_insert(list, p)) < 0)\n\t\t\t\t\treturn error;\n\t\t\tp->flags |= c->flags;\n\t\t}\n\t}\n\treturn seen_commits;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [
            "#define SEEN (1u << 0)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\n#define SEEN (1u << 0)\n\nstatic unsigned long finish_depth_computation(\n\tgit_pqueue *list,\n\tgit_revwalk *walk,\n\tstruct possible_tag *best)\n{\n\tunsigned long seen_commits = 0;\n\tint error, i;\n\n\twhile (git_pqueue_size(list) > 0) {\n\t\tgit_commit_list_node *c = git_pqueue_pop(list);\n\t\tseen_commits++;\n\t\tif (c->flags & best->flag_within) {\n\t\t\tsize_t index = 0;\n\t\t\twhile (git_pqueue_size(list) > index) {\n\t\t\t\tgit_commit_list_node *i = git_pqueue_get(list, index);\n\t\t\t\tif (!(i->flags & best->flag_within))\n\t\t\t\t\tbreak;\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\tif (index > git_pqueue_size(list))\n\t\t\t\tbreak;\n\t\t} else\n\t\t\tbest->depth++;\n\t\tfor (i = 0; i < c->out_degree; i++) {\n\t\t\tgit_commit_list_node *p = c->parents[i];\n\t\t\tif ((error = git_commit_list_parse(walk, p)) < 0)\n\t\t\t\treturn error;\n\t\t\tif (!(p->flags & SEEN))\n\t\t\t\tif ((error = git_pqueue_insert(list, p)) < 0)\n\t\t\t\t\treturn error;\n\t\t\tp->flags |= c->flags;\n\t\t}\n\t}\n\treturn seen_commits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_insert",
          "args": [
            "&list",
            "gave_up_on"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "81-100",
          "snippet": "int git_pqueue_insert(git_pqueue *pq, void *item)\n{\n\tint error = 0;\n\n\t/* if heap is full, pop the top element if new one should replace it */\n\tif ((pq->flags & GIT_PQUEUE_FIXED_SIZE) != 0 &&\n\t\tpq->length >= pq->_alloc_size)\n\t{\n\t\t/* skip this item if below min item in heap */\n\t\tif (pq->_cmp(item, git_vector_get(pq, 0)) <= 0)\n\t\t\treturn 0;\n\t\t/* otherwise remove the min item before inserting new */\n\t\t(void)git_pqueue_pop(pq);\n\t}\n\n\tif (!(error = git_vector_insert(pq, item)))\n\t\tpqueue_up(pq, pq->length - 1);\n\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nint git_pqueue_insert(git_pqueue *pq, void *item)\n{\n\tint error = 0;\n\n\t/* if heap is full, pop the top element if new one should replace it */\n\tif ((pq->flags & GIT_PQUEUE_FIXED_SIZE) != 0 &&\n\t\tpq->length >= pq->_alloc_size)\n\t{\n\t\t/* skip this item if below min item in heap */\n\t\tif (pq->_cmp(item, git_vector_get(pq, 0)) <= 0)\n\t\t\treturn 0;\n\t\t/* otherwise remove the min item before inserting new */\n\t\t(void)git_pqueue_pop(pq);\n\t}\n\n\tif (!(error = git_vector_insert(pq, item)))\n\t\tpqueue_up(pq, pq->length - 1);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&all_matches",
            "0"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_sort",
          "args": [
            "&all_matches"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_sort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "175-185",
          "snippet": "void git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_sort(git_vector *v)\n{\n\tassert(v);\n\n\tif (git_vector_is_sorted(v) || !v->_cmp)\n\t\treturn;\n\n\tif (v->length > 1)\n\t\tgit__tsort(v->contents, v->length, v->_cmp);\n\tgit_vector_set_sorted(v, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "describe_not_found",
          "args": [
            "git_commit_id(commit)",
            "\"Cannot describe - \"\n\t\t\t\t\"No tags can describe '%s'.\""
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "describe_not_found",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "424-430",
          "snippet": "static int describe_not_found(const git_oid *oid, const char *message_format) {\n\tchar oid_str[GIT_OID_HEXSZ + 1];\n\tgit_oid_tostr(oid_str, sizeof(oid_str), oid);\n\n\tgiterr_set(GITERR_DESCRIBE, message_format, oid_str);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int describe_not_found(const git_oid *oid, const char *message_format) {\n\tchar oid_str[GIT_OID_HEXSZ + 1];\n\tgit_oid_tostr(oid_str, sizeof(oid_str), oid);\n\n\tgiterr_set(GITERR_DESCRIBE, message_format, oid_str);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_id",
          "args": [
            "commit"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "35-38",
          "snippet": "const git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_list_parse",
          "args": [
            "walk",
            "p"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "177-199",
          "snippet": "int git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nint git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_size",
          "args": [
            "&list"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&all_matches",
            "t"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "t"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(struct commit_name)"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_commit_name",
          "args": [
            "data->names",
            "&c->oid"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "find_commit_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "47-52",
          "snippet": "static struct commit_name *find_commit_name(\n\tgit_oidmap *names,\n\tconst git_oid *peeled)\n{\n\treturn (struct commit_name *)(oidmap_value_bykey(names, peeled));\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic struct commit_name *find_commit_name(\n\tgit_oidmap *names,\n\tconst git_oid *peeled)\n{\n\treturn (struct commit_name *)(oidmap_value_bykey(names, peeled));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_pop",
          "args": [
            "&list"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_pop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "102-117",
          "snippet": "void *git_pqueue_pop(git_pqueue *pq)\n{\n\tvoid *rval = git_pqueue_get(pq, 0);\n\n\tif (git_pqueue_size(pq) > 1) {\n\t\t/* move last item to top of heap, shrink, and push item down */\n\t\tpq->contents[0] = git_vector_last(pq);\n\t\tgit_vector_pop(pq);\n\t\tpqueue_down(pq, 0);\n\t} else {\n\t\t/* all we need to do is shrink the heap in this case */\n\t\tgit_vector_pop(pq);\n\t}\n\n\treturn rval;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nvoid *git_pqueue_pop(git_pqueue *pq)\n{\n\tvoid *rval = git_pqueue_get(pq, 0);\n\n\tif (git_pqueue_size(pq) > 1) {\n\t\t/* move last item to top of heap, shrink, and push item down */\n\t\tpq->contents[0] = git_vector_last(pq);\n\t\tgit_vector_pop(pq);\n\t\tpqueue_down(pq, 0);\n\t} else {\n\t\t/* all we need to do is shrink the heap in this case */\n\t\tgit_vector_pop(pq);\n\t}\n\n\treturn rval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_size",
          "args": [
            "&list"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_revwalk__commit_lookup",
          "args": [
            "walk",
            "git_commit_id(commit)"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk__commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "17-42",
          "snippet": "GIT__USE_OIDMAP\n\ngit_commit_list_node *git_revwalk__commit_lookup(\n\tgit_revwalk *walk, const git_oid *oid)\n{\n\tgit_commit_list_node *commit;\n\tkhiter_t pos;\n\tint ret;\n\n\t/* lookup and reserve space if not already present */\n\tpos = kh_get(oid, walk->commits, oid);\n\tif (pos != kh_end(walk->commits))\n\t\treturn kh_value(walk->commits, pos);\n\n\tcommit = git_commit_list_alloc_node(walk);\n\tif (commit == NULL)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&commit->oid, oid);\n\n\tpos = kh_put(oid, walk->commits, &commit->oid, &ret);\n\tassert(ret != 0);\n\tkh_value(walk->commits, pos) = commit;\n\n\treturn commit;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nGIT__USE_OIDMAP\n\ngit_commit_list_node *git_revwalk__commit_lookup(\n\tgit_revwalk *walk, const git_oid *oid)\n{\n\tgit_commit_list_node *commit;\n\tkhiter_t pos;\n\tint ret;\n\n\t/* lookup and reserve space if not already present */\n\tpos = kh_get(oid, walk->commits, oid);\n\tif (pos != kh_end(walk->commits))\n\t\treturn kh_value(walk->commits, pos);\n\n\tcommit = git_commit_list_alloc_node(walk);\n\tif (commit == NULL)\n\t\treturn NULL;\n\n\tgit_oid_cpy(&commit->oid, oid);\n\n\tpos = kh_put(oid, walk->commits, &commit->oid, &ret);\n\tassert(ret != 0);\n\tkh_value(walk->commits, pos) = commit;\n\n\treturn commit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_new",
          "args": [
            "&walk",
            "git_commit_owner(commit)"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "529-553",
          "snippet": "int git_revwalk_new(git_revwalk **revwalk_out, git_repository *repo)\n{\n\tgit_revwalk *walk = git__calloc(1, sizeof(git_revwalk));\n\tGITERR_CHECK_ALLOC(walk);\n\n\twalk->commits = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(walk->commits);\n\n\tif (git_pqueue_init(&walk->iterator_time, 0, 8, git_commit_list_time_cmp) < 0)\n\t\treturn -1;\n\n\tgit_pool_init(&walk->commit_pool, COMMIT_ALLOC);\n\twalk->get_next = &revwalk_next_unsorted;\n\twalk->enqueue = &revwalk_enqueue_unsorted;\n\n\twalk->repo = repo;\n\n\tif (git_repository_odb(&walk->odb, repo) < 0) {\n\t\tgit_revwalk_free(walk);\n\t\treturn -1;\n\t}\n\n\t*revwalk_out = walk;\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_new(git_revwalk **revwalk_out, git_repository *repo)\n{\n\tgit_revwalk *walk = git__calloc(1, sizeof(git_revwalk));\n\tGITERR_CHECK_ALLOC(walk);\n\n\twalk->commits = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(walk->commits);\n\n\tif (git_pqueue_init(&walk->iterator_time, 0, 8, git_commit_list_time_cmp) < 0)\n\t\treturn -1;\n\n\tgit_pool_init(&walk->commit_pool, COMMIT_ALLOC);\n\twalk->get_next = &revwalk_next_unsorted;\n\twalk->enqueue = &revwalk_enqueue_unsorted;\n\n\twalk->repo = repo;\n\n\tif (git_repository_odb(&walk->odb, repo) < 0) {\n\t\tgit_revwalk_free(walk);\n\t\treturn -1;\n\t}\n\n\t*revwalk_out = walk;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_owner",
          "args": [
            "commit"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "40-43",
          "snippet": "git_repository *git_commit_owner(const git_commit *obj)\n{\n\treturn git_object_owner((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\ngit_repository *git_commit_owner(const git_commit *obj)\n{\n\treturn git_object_owner((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "commit_name_dup",
          "args": [
            "&data->result->name",
            "n"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "commit_name_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "189-208",
          "snippet": "static int commit_name_dup(struct commit_name **out, struct commit_name *in)\n{\n\tstruct commit_name *name;\n\n\tname = git__malloc(sizeof(struct commit_name));\n\tGITERR_CHECK_ALLOC(name);\n\n\tmemcpy(name, in,  sizeof(struct commit_name));\n\tname->tag = NULL;\n\tname->path = NULL;\n\n\tif (in->tag && git_object_dup((git_object **) &name->tag, (git_object *) in->tag) < 0)\n\t\treturn -1;\n\n\tname->path = git__strdup(in->path);\n\tGITERR_CHECK_ALLOC(name->path);\n\n\t*out = name;\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int commit_name_dup(struct commit_name **out, struct commit_name *in)\n{\n\tstruct commit_name *name;\n\n\tname = git__malloc(sizeof(struct commit_name));\n\tGITERR_CHECK_ALLOC(name);\n\n\tmemcpy(name, in,  sizeof(struct commit_name));\n\tname->tag = NULL;\n\tname->path = NULL;\n\n\tif (in->tag && git_object_dup((git_object **) &name->tag, (git_object *) in->tag) < 0)\n\t\treturn -1;\n\n\tname->path = git__strdup(in->path);\n\tGITERR_CHECK_ALLOC(name->path);\n\n\t*out = name;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_init",
          "args": [
            "&list",
            "0",
            "2",
            "git_commit_list_time_cmp"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "15-33",
          "snippet": "int git_pqueue_init(\n\tgit_pqueue *pq,\n\tuint32_t flags,\n\tsize_t init_size,\n\tgit_vector_cmp cmp)\n{\n\tint error = git_vector_init(pq, init_size, cmp);\n\n\tif (!error) {\n\t\t/* mix in our flags */\n\t\tpq->flags |= flags;\n\n\t\t/* if fixed size heap, pretend vector is exactly init_size elements */\n\t\tif ((flags & GIT_PQUEUE_FIXED_SIZE) && init_size > 0)\n\t\t\tpq->_alloc_size = init_size;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nint git_pqueue_init(\n\tgit_pqueue *pq,\n\tuint32_t flags,\n\tsize_t init_size,\n\tgit_vector_cmp cmp)\n{\n\tint error = git_vector_init(pq, init_size, cmp);\n\n\tif (!error) {\n\t\t/* mix in our flags */\n\t\tpq->flags |= flags;\n\n\t\t/* if fixed size heap, pretend vector is exactly init_size elements */\n\t\tif ((flags & GIT_PQUEUE_FIXED_SIZE) && init_size > 0)\n\t\t\tpq->_alloc_size = init_size;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "&all_matches",
            "MAX_CANDIDATES_TAGS",
            "compare_pt"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\n#define MAX_CANDIDATES_TAGS FLAG_BITS - 1\n#define SEEN (1u << 0)\n\nstatic int describe(\n\tstruct get_name_data *data,\n\tgit_commit *commit)\n{\n\tstruct commit_name *n;\n\tstruct possible_tag *best;\n\tbool all, tags;\n\tgit_revwalk *walk = NULL;\n\tgit_pqueue list;\n\tgit_commit_list_node *cmit, *gave_up_on = NULL;\n\tgit_vector all_matches = GIT_VECTOR_INIT;\n\tunsigned int match_cnt = 0, annotated_cnt = 0, cur_match;\n\tunsigned long seen_commits = 0;\t/* TODO: Check long */\n\tunsigned int unannotated_cnt = 0;\n\tint error;\n\n\tif (git_vector_init(&all_matches, MAX_CANDIDATES_TAGS, compare_pt) < 0)\n\t\treturn -1;\n\n\tif ((error = git_pqueue_init(&list, 0, 2, git_commit_list_time_cmp)) < 0)\n\t\tgoto cleanup;\n\n\tall = data->opts->describe_strategy == GIT_DESCRIBE_ALL;\n\ttags = data->opts->describe_strategy == GIT_DESCRIBE_TAGS;\n\n\tgit_oid_cpy(&data->result->commit_id, git_commit_id(commit));\n\n\tn = find_commit_name(data->names, git_commit_id(commit));\n\tif (n && (tags || all || n->prio == 2)) {\n\t\t/*\n\t\t * Exact match to an existing ref.\n\t\t */\n\t\tdata->result->exact_match = 1;\n\t\tif ((error = commit_name_dup(&data->result->name, n)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tgoto cleanup;\n\t}\n\n\tif (!data->opts->max_candidates_tags) {\n\t\terror = describe_not_found(\n\t\t\tgit_commit_id(commit),\n\t\t\t\"Cannot describe - no tag exactly matches '%s'\");\n\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_revwalk_new(&walk, git_commit_owner(commit))) < 0)\n\t\tgoto cleanup;\n\n\tif ((cmit = git_revwalk__commit_lookup(walk, git_commit_id(commit))) == NULL)\n\t\tgoto cleanup;\n\n\tif ((error = git_commit_list_parse(walk, cmit)) < 0)\n\t\tgoto cleanup;\n\n\tcmit->flags = SEEN;\n\n\tif ((error = git_pqueue_insert(&list, cmit)) < 0)\n\t\tgoto cleanup;\n\n\twhile (git_pqueue_size(&list) > 0)\n\t{\n\t\tint i;\n\n\t\tgit_commit_list_node *c = (git_commit_list_node *)git_pqueue_pop(&list);\n\t\tseen_commits++;\n\n\t\tn = find_commit_name(data->names, &c->oid);\n\n\t\tif (n) {\n\t\t\tif (!tags && !all && n->prio < 2) {\n\t\t\t\tunannotated_cnt++;\n\t\t\t} else if (match_cnt < data->opts->max_candidates_tags) {\n\t\t\t\tstruct possible_tag *t = git__malloc(sizeof(struct commit_name));\n\t\t\t\tGITERR_CHECK_ALLOC(t);\n\t\t\t\tif ((error = git_vector_insert(&all_matches, t)) < 0)\n\t\t\t\t\tgoto cleanup;\n\n\t\t\t\tmatch_cnt++;\n\n\t\t\t\tt->name = n;\n\t\t\t\tt->depth = seen_commits - 1;\n\t\t\t\tt->flag_within = 1u << match_cnt;\n\t\t\t\tt->found_order = match_cnt;\n\t\t\t\tc->flags |= t->flag_within;\n\t\t\t\tif (n->prio == 2)\n\t\t\t\t\tannotated_cnt++;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgave_up_on = c;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (cur_match = 0; cur_match < match_cnt; cur_match++) {\n\t\t\tstruct possible_tag *t = git_vector_get(&all_matches, cur_match);\n\t\t\tif (!(c->flags & t->flag_within))\n\t\t\t\tt->depth++;\n\t\t}\n\n\t\tif (annotated_cnt && (git_pqueue_size(&list) == 0)) {\n\t\t\t/*\n\t\t\tif (debug) {\n\t\t\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\t\t\t\tgit_oid_tostr(oid_str, sizeof(oid_str), &c->oid);\n\n\t\t\t\tfprintf(stderr, \"finished search at %s\\n\", oid_str);\n\t\t\t}\n\t\t\t*/\n\t\t\tbreak;\n\t\t}\n\t\tfor (i = 0; i < c->out_degree; i++) {\n\t\t\tgit_commit_list_node *p = c->parents[i];\n\t\t\tif ((error = git_commit_list_parse(walk, p)) < 0)\n\t\t\t\tgoto cleanup;\n\t\t\tif (!(p->flags & SEEN))\n\t\t\t\tif ((error = git_pqueue_insert(&list, p)) < 0)\n\t\t\t\t\tgoto cleanup;\n\t\t\tp->flags |= c->flags;\n\n\t\t\tif (data->opts->only_follow_first_parent)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!match_cnt) {\n\t\tif (data->opts->show_commit_oid_as_fallback) {\n\t\t\tdata->result->fallback_to_id = 1;\n\t\t\tgit_oid_cpy(&data->result->commit_id, &cmit->oid);\n\n\t\t\tgoto cleanup;\n\t\t}\n\t\tif (unannotated_cnt) {\n\t\t\terror = describe_not_found(git_commit_id(commit), \n\t\t\t\t\"Cannot describe - \"\n\t\t\t\t\"No annotated tags can describe '%s'.\"\n\t\t\t    \"However, there were unannotated tags.\");\n\t\t\tgoto cleanup;\n\t\t}\n\t\telse {\n\t\t\terror = describe_not_found(git_commit_id(commit), \n\t\t\t\t\"Cannot describe - \"\n\t\t\t\t\"No tags can describe '%s'.\");\n\t\t\tgoto cleanup;\n\t\t}\n\t}\n\n\tgit_vector_sort(&all_matches);\n\n\tbest = (struct possible_tag *)git_vector_get(&all_matches, 0);\n\n\tif (gave_up_on) {\n\t\tif ((error = git_pqueue_insert(&list, gave_up_on)) < 0)\n\t\t\tgoto cleanup;\n\t\tseen_commits--;\n\t}\n\tif ((error = finish_depth_computation(\n\t\t&list, walk, best)) < 0)\n\t\tgoto cleanup;\n\n\tseen_commits += error;\n\tif ((error = possible_tag_dup(&data->result->tag, best)) < 0)\n\t\tgoto cleanup;\n\n\t/*\n\t{\n\t\tstatic const char *prio_names[] = {\n\t\t\t\"head\", \"lightweight\", \"annotated\",\n\t\t};\n\n\t\tchar oid_str[GIT_OID_HEXSZ + 1];\n\n\t\tif (debug) {\n\t\t\tfor (cur_match = 0; cur_match < match_cnt; cur_match++) {\n\t\t\t\tstruct possible_tag *t = (struct possible_tag *)git_vector_get(&all_matches, cur_match);\n\t\t\t\tfprintf(stderr, \" %-11s %8d %s\\n\",\n\t\t\t\t\tprio_names[t->name->prio],\n\t\t\t\t\tt->depth, t->name->path);\n\t\t\t}\n\t\t\tfprintf(stderr, \"traversed %lu commits\\n\", seen_commits);\n\t\t\tif (gave_up_on) {\n\t\t\t\tgit_oid_tostr(oid_str, sizeof(oid_str), &gave_up_on->oid);\n\t\t\t\tfprintf(stderr,\n\t\t\t\t\t\"more than %i tags found; listed %i most recent\\n\"\n\t\t\t\t\t\"gave up search at %s\\n\",\n\t\t\t\t\tdata->opts->max_candidates_tags, data->opts->max_candidates_tags,\n\t\t\t\t\toid_str);\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\n\tgit_oid_cpy(&data->result->commit_id, &cmit->oid);\n\ncleanup:\n\t{\n\t\tsize_t i;\n\t\tstruct possible_tag *match;\n\t\tgit_vector_foreach(&all_matches, i, match) {\n\t\t\tgit__free(match);\n\t\t}\n\t}\n\tgit_vector_free(&all_matches);\n\tgit_pqueue_free(&list);\n\tgit_revwalk_free(walk);\n\treturn error;\n}"
  },
  {
    "function_name": "describe_not_found",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "424-430",
    "snippet": "static int describe_not_found(const git_oid *oid, const char *message_format) {\n\tchar oid_str[GIT_OID_HEXSZ + 1];\n\tgit_oid_tostr(oid_str, sizeof(oid_str), oid);\n\n\tgiterr_set(GITERR_DESCRIBE, message_format, oid_str);\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_DESCRIBE",
            "message_format",
            "oid_str"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_tostr",
          "args": [
            "oid_str",
            "sizeof(oid_str)",
            "oid"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_tostr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "119-131",
          "snippet": "char *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int describe_not_found(const git_oid *oid, const char *message_format) {\n\tchar oid_str[GIT_OID_HEXSZ + 1];\n\tgit_oid_tostr(oid_str, sizeof(oid_str), oid);\n\n\tgiterr_set(GITERR_DESCRIBE, message_format, oid_str);\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "show_suffix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "399-420",
    "snippet": "static int show_suffix(\n\tgit_buf *buf,\n\tint depth,\n\tgit_repository *repo,\n\tconst git_oid* id,\n\tsize_t abbrev_size)\n{\n\tint error, size = 0;\n\n\tchar hex_oid[GIT_OID_HEXSZ];\n\n\tif ((error = find_unique_abbrev_size(&size, repo, id, abbrev_size)) < 0)\n\t\treturn error;\n\n\tgit_oid_fmt(hex_oid, id);\n\n\tgit_buf_printf(buf, \"-%d-g\", depth);\n\n\tgit_buf_put(buf, hex_oid, size);\n\n\treturn git_buf_oom(buf) ? -1 : 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "buf"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "buf",
            "hex_oid",
            "size"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "buf",
            "\"-%d-g\"",
            "depth"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "hex_oid",
            "id"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_unique_abbrev_size",
          "args": [
            "&size",
            "repo",
            "id",
            "abbrev_size"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "find_unique_abbrev_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "365-397",
          "snippet": "static int find_unique_abbrev_size(\n\tint *out,\n\tgit_repository *repo,\n\tconst git_oid *oid_in,\n\tint abbreviated_size)\n{\n\tsize_t size = abbreviated_size;\n\tgit_odb *odb;\n\tgit_oid dummy;\n\tint error;\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0)\n\t\treturn error;\n\n\twhile (size < GIT_OID_HEXSZ) {\n\t\tif ((error = git_odb_exists_prefix(&dummy, odb, oid_in, size)) == 0) {\n\t\t\t*out = (int) size;\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* If the error wasn't that it's not unique, then it's a proper error */\n\t\tif (error != GIT_EAMBIGUOUS)\n\t\t\treturn error;\n\n\t\t/* Try again with a larger size */\n\t\tsize++;\n\t}\n\n\t/* If we didn't find any shorter prefix, we have to do the whole thing */\n\t*out = GIT_OID_HEXSZ;\n\t\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int find_unique_abbrev_size(\n\tint *out,\n\tgit_repository *repo,\n\tconst git_oid *oid_in,\n\tint abbreviated_size)\n{\n\tsize_t size = abbreviated_size;\n\tgit_odb *odb;\n\tgit_oid dummy;\n\tint error;\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0)\n\t\treturn error;\n\n\twhile (size < GIT_OID_HEXSZ) {\n\t\tif ((error = git_odb_exists_prefix(&dummy, odb, oid_in, size)) == 0) {\n\t\t\t*out = (int) size;\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* If the error wasn't that it's not unique, then it's a proper error */\n\t\tif (error != GIT_EAMBIGUOUS)\n\t\t\treturn error;\n\n\t\t/* Try again with a larger size */\n\t\tsize++;\n\t}\n\n\t/* If we didn't find any shorter prefix, we have to do the whole thing */\n\t*out = GIT_OID_HEXSZ;\n\t\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int show_suffix(\n\tgit_buf *buf,\n\tint depth,\n\tgit_repository *repo,\n\tconst git_oid* id,\n\tsize_t abbrev_size)\n{\n\tint error, size = 0;\n\n\tchar hex_oid[GIT_OID_HEXSZ];\n\n\tif ((error = find_unique_abbrev_size(&size, repo, id, abbrev_size)) < 0)\n\t\treturn error;\n\n\tgit_oid_fmt(hex_oid, id);\n\n\tgit_buf_printf(buf, \"-%d-g\", depth);\n\n\tgit_buf_put(buf, hex_oid, size);\n\n\treturn git_buf_oom(buf) ? -1 : 0;\n}"
  },
  {
    "function_name": "find_unique_abbrev_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "365-397",
    "snippet": "static int find_unique_abbrev_size(\n\tint *out,\n\tgit_repository *repo,\n\tconst git_oid *oid_in,\n\tint abbreviated_size)\n{\n\tsize_t size = abbreviated_size;\n\tgit_odb *odb;\n\tgit_oid dummy;\n\tint error;\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0)\n\t\treturn error;\n\n\twhile (size < GIT_OID_HEXSZ) {\n\t\tif ((error = git_odb_exists_prefix(&dummy, odb, oid_in, size)) == 0) {\n\t\t\t*out = (int) size;\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* If the error wasn't that it's not unique, then it's a proper error */\n\t\tif (error != GIT_EAMBIGUOUS)\n\t\t\treturn error;\n\n\t\t/* Try again with a larger size */\n\t\tsize++;\n\t}\n\n\t/* If we didn't find any shorter prefix, we have to do the whole thing */\n\t*out = GIT_OID_HEXSZ;\n\t\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_exists_prefix",
          "args": [
            "&dummy",
            "odb",
            "oid_in",
            "size"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_exists_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "709-747",
          "snippet": "int git_odb_exists_prefix(\n\tgit_oid *out, git_odb *db, const git_oid *short_id, size_t len)\n{\n\tint error;\n\tgit_oid key = {{0}}; \n\n\tassert(db && short_id);\n\n\tif (len < GIT_OID_MINPREFIXLEN)\n\t\treturn git_odb__error_ambiguous(\"prefix length too short\");\n\tif (len > GIT_OID_HEXSZ)\n\t\tlen = GIT_OID_HEXSZ;\n\n\tif (len == GIT_OID_HEXSZ) {\n\t\tif (git_odb_exists(db, short_id)) {\n\t\t\tif (out)\n\t\t\t\tgit_oid_cpy(out, short_id);\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn git_odb__error_notfound(\n\t\t\t\t\"no match for id prefix\", short_id, len);\n\t\t}\n\t}\n\n\t/* just copy valid part of short_id */\n\tmemcpy(&key.id, short_id->id, (len + 1) / 2);\n\tif (len & 1)\n\t\tkey.id[len / 2] &= 0xF0;\n\n\terror = odb_exists_prefix_1(out, db, &key, len, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_exists_prefix_1(out, db, &key, len, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id prefix\", &key, len);\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_exists_prefix(\n\tgit_oid *out, git_odb *db, const git_oid *short_id, size_t len)\n{\n\tint error;\n\tgit_oid key = {{0}}; \n\n\tassert(db && short_id);\n\n\tif (len < GIT_OID_MINPREFIXLEN)\n\t\treturn git_odb__error_ambiguous(\"prefix length too short\");\n\tif (len > GIT_OID_HEXSZ)\n\t\tlen = GIT_OID_HEXSZ;\n\n\tif (len == GIT_OID_HEXSZ) {\n\t\tif (git_odb_exists(db, short_id)) {\n\t\t\tif (out)\n\t\t\t\tgit_oid_cpy(out, short_id);\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn git_odb__error_notfound(\n\t\t\t\t\"no match for id prefix\", short_id, len);\n\t\t}\n\t}\n\n\t/* just copy valid part of short_id */\n\tmemcpy(&key.id, short_id->id, (len + 1) / 2);\n\tif (len & 1)\n\t\tkey.id[len / 2] &= 0xF0;\n\n\terror = odb_exists_prefix_1(out, db, &key, len, false);\n\n\tif (error == GIT_ENOTFOUND && !git_odb_refresh(db))\n\t\terror = odb_exists_prefix_1(out, db, &key, len, true);\n\n\tif (error == GIT_ENOTFOUND)\n\t\treturn git_odb__error_notfound(\"no match for id prefix\", &key, len);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_odb__weakptr",
          "args": [
            "&odb",
            "repo"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_odb__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "733-762",
          "snippet": "int git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int find_unique_abbrev_size(\n\tint *out,\n\tgit_repository *repo,\n\tconst git_oid *oid_in,\n\tint abbreviated_size)\n{\n\tsize_t size = abbreviated_size;\n\tgit_odb *odb;\n\tgit_oid dummy;\n\tint error;\n\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0)\n\t\treturn error;\n\n\twhile (size < GIT_OID_HEXSZ) {\n\t\tif ((error = git_odb_exists_prefix(&dummy, odb, oid_in, size)) == 0) {\n\t\t\t*out = (int) size;\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* If the error wasn't that it's not unique, then it's a proper error */\n\t\tif (error != GIT_EAMBIGUOUS)\n\t\t\treturn error;\n\n\t\t/* Try again with a larger size */\n\t\tsize++;\n\t}\n\n\t/* If we didn't find any shorter prefix, we have to do the whole thing */\n\t*out = GIT_OID_HEXSZ;\n\t\n\treturn 0;\n}"
  },
  {
    "function_name": "display_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "334-363",
    "snippet": "static int display_name(git_buf *buf, git_repository *repo, struct commit_name *n)\n{\n\tif (n->prio == 2 && !n->tag) {\n\t\tif (git_tag_lookup(&n->tag, repo, &n->sha1) < 0) {\n\t\t\tgiterr_set(GITERR_TAG, \"Annotated tag '%s' not available\", n->path);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif (n->tag && !n->name_checked) {\n\t\tif (!git_tag_name(n->tag)) {\n\t\t\tgiterr_set(GITERR_TAG, \"Annotated tag '%s' has no embedded name\", n->path);\n\t\t\treturn -1;\n\t\t}\n\n\t\t/* TODO: Cope with warnings\n\t\tif (strcmp(n->tag->tag, all ? n->path + 5 : n->path))\n\t\t\twarning(_(\"tag '%s' is really '%s' here\"), n->tag->tag, n->path);\n\t\t*/\n\n\t\tn->name_checked = 1;\n\t}\n\n\tif (n->tag)\n\t\tgit_buf_printf(buf, \"%s\", git_tag_name(n->tag));\n\telse\n\t\tgit_buf_printf(buf, \"%s\", n->path);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "buf",
            "\"%s\"",
            "n->path"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tag_name",
          "args": [
            "n->tag"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "git_tag_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tag.c",
          "lines": "45-49",
          "snippet": "const char *git_tag_name(const git_tag *t)\n{\n\tassert(t);\n\treturn t->tag_name;\n}",
          "includes": [
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/odb_backend.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nconst char *git_tag_name(const git_tag *t)\n{\n\tassert(t);\n\treturn t->tag_name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_TAG",
            "\"Annotated tag '%s' has no embedded name\"",
            "n->path"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tag_lookup",
          "args": [
            "&n->tag",
            "repo",
            "&n->sha1"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "git_tag_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "78-81",
          "snippet": "int git_tag_lookup(git_tag **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TAG);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_tag_lookup(git_tag **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TAG);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int display_name(git_buf *buf, git_repository *repo, struct commit_name *n)\n{\n\tif (n->prio == 2 && !n->tag) {\n\t\tif (git_tag_lookup(&n->tag, repo, &n->sha1) < 0) {\n\t\t\tgiterr_set(GITERR_TAG, \"Annotated tag '%s' not available\", n->path);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif (n->tag && !n->name_checked) {\n\t\tif (!git_tag_name(n->tag)) {\n\t\t\tgiterr_set(GITERR_TAG, \"Annotated tag '%s' has no embedded name\", n->path);\n\t\t\treturn -1;\n\t\t}\n\n\t\t/* TODO: Cope with warnings\n\t\tif (strcmp(n->tag->tag, all ? n->path + 5 : n->path))\n\t\t\twarning(_(\"tag '%s' is really '%s' here\"), n->tag->tag, n->path);\n\t\t*/\n\n\t\tn->name_checked = 1;\n\t}\n\n\tif (n->tag)\n\t\tgit_buf_printf(buf, \"%s\", git_tag_name(n->tag));\n\telse\n\t\tgit_buf_printf(buf, \"%s\", n->path);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "finish_depth_computation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "298-332",
    "snippet": "static unsigned long finish_depth_computation(\n\tgit_pqueue *list,\n\tgit_revwalk *walk,\n\tstruct possible_tag *best)\n{\n\tunsigned long seen_commits = 0;\n\tint error, i;\n\n\twhile (git_pqueue_size(list) > 0) {\n\t\tgit_commit_list_node *c = git_pqueue_pop(list);\n\t\tseen_commits++;\n\t\tif (c->flags & best->flag_within) {\n\t\t\tsize_t index = 0;\n\t\t\twhile (git_pqueue_size(list) > index) {\n\t\t\t\tgit_commit_list_node *i = git_pqueue_get(list, index);\n\t\t\t\tif (!(i->flags & best->flag_within))\n\t\t\t\t\tbreak;\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\tif (index > git_pqueue_size(list))\n\t\t\t\tbreak;\n\t\t} else\n\t\t\tbest->depth++;\n\t\tfor (i = 0; i < c->out_degree; i++) {\n\t\t\tgit_commit_list_node *p = c->parents[i];\n\t\t\tif ((error = git_commit_list_parse(walk, p)) < 0)\n\t\t\t\treturn error;\n\t\t\tif (!(p->flags & SEEN))\n\t\t\t\tif ((error = git_pqueue_insert(list, p)) < 0)\n\t\t\t\t\treturn error;\n\t\t\tp->flags |= c->flags;\n\t\t}\n\t}\n\treturn seen_commits;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [
      "#define SEEN (1u << 0)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_pqueue_insert",
          "args": [
            "list",
            "p"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "81-100",
          "snippet": "int git_pqueue_insert(git_pqueue *pq, void *item)\n{\n\tint error = 0;\n\n\t/* if heap is full, pop the top element if new one should replace it */\n\tif ((pq->flags & GIT_PQUEUE_FIXED_SIZE) != 0 &&\n\t\tpq->length >= pq->_alloc_size)\n\t{\n\t\t/* skip this item if below min item in heap */\n\t\tif (pq->_cmp(item, git_vector_get(pq, 0)) <= 0)\n\t\t\treturn 0;\n\t\t/* otherwise remove the min item before inserting new */\n\t\t(void)git_pqueue_pop(pq);\n\t}\n\n\tif (!(error = git_vector_insert(pq, item)))\n\t\tpqueue_up(pq, pq->length - 1);\n\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nint git_pqueue_insert(git_pqueue *pq, void *item)\n{\n\tint error = 0;\n\n\t/* if heap is full, pop the top element if new one should replace it */\n\tif ((pq->flags & GIT_PQUEUE_FIXED_SIZE) != 0 &&\n\t\tpq->length >= pq->_alloc_size)\n\t{\n\t\t/* skip this item if below min item in heap */\n\t\tif (pq->_cmp(item, git_vector_get(pq, 0)) <= 0)\n\t\t\treturn 0;\n\t\t/* otherwise remove the min item before inserting new */\n\t\t(void)git_pqueue_pop(pq);\n\t}\n\n\tif (!(error = git_vector_insert(pq, item)))\n\t\tpqueue_up(pq, pq->length - 1);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_list_parse",
          "args": [
            "walk",
            "p"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_list_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/commit_list.c",
          "lines": "177-199",
          "snippet": "int git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}",
          "includes": [
            "#include \"odb.h\"",
            "#include \"pool.h\"",
            "#include \"revwalk.h\"",
            "#include \"common.h\"",
            "#include \"commit_list.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"odb.h\"\n#include \"pool.h\"\n#include \"revwalk.h\"\n#include \"common.h\"\n#include \"commit_list.h\"\n\nint git_commit_list_parse(git_revwalk *walk, git_commit_list_node *commit)\n{\n\tgit_odb_object *obj;\n\tint error;\n\n\tif (commit->parsed)\n\t\treturn 0;\n\n\tif ((error = git_odb_read(&obj, walk->odb, &commit->oid)) < 0)\n\t\treturn error;\n\n\tif (obj->cached.type != GIT_OBJ_COMMIT) {\n\t\tgiterr_set(GITERR_INVALID, \"Object is no commit object\");\n\t\terror = -1;\n\t} else\n\t\terror = commit_quick_parse(\n\t\t\twalk, commit,\n\t\t\t(const uint8_t *)git_odb_object_data(obj),\n\t\t\tgit_odb_object_size(obj));\n\n\tgit_odb_object_free(obj);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_size",
          "args": [
            "list"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pqueue_get",
          "args": [
            "list",
            "index"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pqueue_size",
          "args": [
            "list"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pqueue_pop",
          "args": [
            "list"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "git_pqueue_pop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pqueue.c",
          "lines": "102-117",
          "snippet": "void *git_pqueue_pop(git_pqueue *pq)\n{\n\tvoid *rval = git_pqueue_get(pq, 0);\n\n\tif (git_pqueue_size(pq) > 1) {\n\t\t/* move last item to top of heap, shrink, and push item down */\n\t\tpq->contents[0] = git_vector_last(pq);\n\t\tgit_vector_pop(pq);\n\t\tpqueue_down(pq, 0);\n\t} else {\n\t\t/* all we need to do is shrink the heap in this case */\n\t\tgit_vector_pop(pq);\n\t}\n\n\treturn rval;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"pqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"pqueue.h\"\n\nvoid *git_pqueue_pop(git_pqueue *pq)\n{\n\tvoid *rval = git_pqueue_get(pq, 0);\n\n\tif (git_pqueue_size(pq) > 1) {\n\t\t/* move last item to top of heap, shrink, and push item down */\n\t\tpq->contents[0] = git_vector_last(pq);\n\t\tgit_vector_pop(pq);\n\t\tpqueue_down(pq, 0);\n\t} else {\n\t\t/* all we need to do is shrink the heap in this case */\n\t\tgit_vector_pop(pq);\n\t}\n\n\treturn rval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pqueue_size",
          "args": [
            "list"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\n#define SEEN (1u << 0)\n\nstatic unsigned long finish_depth_computation(\n\tgit_pqueue *list,\n\tgit_revwalk *walk,\n\tstruct possible_tag *best)\n{\n\tunsigned long seen_commits = 0;\n\tint error, i;\n\n\twhile (git_pqueue_size(list) > 0) {\n\t\tgit_commit_list_node *c = git_pqueue_pop(list);\n\t\tseen_commits++;\n\t\tif (c->flags & best->flag_within) {\n\t\t\tsize_t index = 0;\n\t\t\twhile (git_pqueue_size(list) > index) {\n\t\t\t\tgit_commit_list_node *i = git_pqueue_get(list, index);\n\t\t\t\tif (!(i->flags & best->flag_within))\n\t\t\t\t\tbreak;\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\tif (index > git_pqueue_size(list))\n\t\t\t\tbreak;\n\t\t} else\n\t\t\tbest->depth++;\n\t\tfor (i = 0; i < c->out_degree; i++) {\n\t\t\tgit_commit_list_node *p = c->parents[i];\n\t\t\tif ((error = git_commit_list_parse(walk, p)) < 0)\n\t\t\t\treturn error;\n\t\t\tif (!(p->flags & SEEN))\n\t\t\t\tif ((error = git_pqueue_insert(list, p)) < 0)\n\t\t\t\t\treturn error;\n\t\t\tp->flags |= c->flags;\n\t\t}\n\t}\n\treturn seen_commits;\n}"
  },
  {
    "function_name": "compare_pt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "285-294",
    "snippet": "static int compare_pt(const void *a_, const void *b_)\n{\n\tstruct possible_tag *a = (struct possible_tag *)a_;\n\tstruct possible_tag *b = (struct possible_tag *)b_;\n\tif (a->depth != b->depth)\n\t\treturn a->depth - b->depth;\n\tif (a->found_order != b->found_order)\n\t\treturn a->found_order - b->found_order;\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int compare_pt(const void *a_, const void *b_)\n{\n\tstruct possible_tag *a = (struct possible_tag *)a_;\n\tstruct possible_tag *b = (struct possible_tag *)b_;\n\tif (a->depth != b->depth)\n\t\treturn a->depth - b->depth;\n\tif (a->found_order != b->found_order)\n\t\treturn a->found_order - b->found_order;\n\treturn 0;\n}"
  },
  {
    "function_name": "possible_tag_dup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "264-283",
    "snippet": "static int possible_tag_dup(struct possible_tag **out, struct possible_tag *in)\n{\n\tstruct possible_tag *tag;\n\tint error;\n\n\ttag = git__malloc(sizeof(struct possible_tag));\n\tGITERR_CHECK_ALLOC(tag);\n\n\tmemcpy(tag, in, sizeof(struct possible_tag));\n\ttag->name = NULL;\n\n\tif ((error = commit_name_dup(&tag->name, in->name)) < 0) {\n\t\tgit__free(tag);\n\t\t*out = NULL;\n\t\treturn error;\n\t}\n\n\t*out = tag;\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "tag"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "commit_name_dup",
          "args": [
            "&tag->name",
            "in->name"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "commit_name_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "189-208",
          "snippet": "static int commit_name_dup(struct commit_name **out, struct commit_name *in)\n{\n\tstruct commit_name *name;\n\n\tname = git__malloc(sizeof(struct commit_name));\n\tGITERR_CHECK_ALLOC(name);\n\n\tmemcpy(name, in,  sizeof(struct commit_name));\n\tname->tag = NULL;\n\tname->path = NULL;\n\n\tif (in->tag && git_object_dup((git_object **) &name->tag, (git_object *) in->tag) < 0)\n\t\treturn -1;\n\n\tname->path = git__strdup(in->path);\n\tGITERR_CHECK_ALLOC(name->path);\n\n\t*out = name;\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int commit_name_dup(struct commit_name **out, struct commit_name *in)\n{\n\tstruct commit_name *name;\n\n\tname = git__malloc(sizeof(struct commit_name));\n\tGITERR_CHECK_ALLOC(name);\n\n\tmemcpy(name, in,  sizeof(struct commit_name));\n\tname->tag = NULL;\n\tname->path = NULL;\n\n\tif (in->tag && git_object_dup((git_object **) &name->tag, (git_object *) in->tag) < 0)\n\t\treturn -1;\n\n\tname->path = git__strdup(in->path);\n\tGITERR_CHECK_ALLOC(name->path);\n\n\t*out = name;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "tag",
            "in",
            "sizeof(struct possible_tag)"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "tag"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(struct possible_tag)"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int possible_tag_dup(struct possible_tag **out, struct possible_tag *in)\n{\n\tstruct possible_tag *tag;\n\tint error;\n\n\ttag = git__malloc(sizeof(struct possible_tag));\n\tGITERR_CHECK_ALLOC(tag);\n\n\tmemcpy(tag, in, sizeof(struct possible_tag));\n\ttag->name = NULL;\n\n\tif ((error = commit_name_dup(&tag->name, in->name)) < 0) {\n\t\tgit__free(tag);\n\t\t*out = NULL;\n\t\treturn error;\n\t}\n\n\t*out = tag;\n\treturn 0;\n}"
  },
  {
    "function_name": "get_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "210-255",
    "snippet": "static int get_name(const char *refname, void *payload)\n{\n\tstruct get_name_data *data;\n\tbool is_tag, is_annotated, all;\n\tgit_oid peeled, sha1;\n\tunsigned int prio;\n\tint error = 0;\n\n\tdata = (struct get_name_data *)payload;\n\tis_tag = !git__prefixcmp(refname, GIT_REFS_TAGS_DIR);\n\tall = data->opts->describe_strategy == GIT_DESCRIBE_ALL;\n\n\t/* Reject anything outside refs/tags/ unless --all */\n\tif (!all && !is_tag)\n\t\treturn 0;\n\n\t/* Accept only tags that match the pattern, if given */\n\tif (data->opts->pattern && (!is_tag || p_fnmatch(data->opts->pattern,\n\t\trefname + strlen(GIT_REFS_TAGS_DIR), 0)))\n\t\t\t\treturn 0;\n\n\t/* Is it annotated? */\n\tif ((error = retrieve_peeled_tag_or_object_oid(\n\t\t&peeled, &sha1, data->repo, refname)) < 0)\n\t\treturn error;\n\n\tis_annotated = error;\n\n\t/*\n\t * By default, we only use annotated tags, but with --tags\n\t * we fall back to lightweight ones (even without --tags,\n\t * we still remember lightweight ones, only to give hints\n\t * in an error message).  --all allows any refs to be used.\n\t */\n\tif (is_annotated)\n\t\tprio = 2;\n\telse if (is_tag)\n\t\tprio = 1;\n\telse\n\t\tprio = 0;\n\n\tadd_to_known_names(data->repo, data->names,\n\t\tall ? refname + strlen(GIT_REFS_DIR) : refname + strlen(GIT_REFS_TAGS_DIR),\n\t\t&peeled, prio, &sha1);\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_to_known_names",
          "args": [
            "data->repo",
            "data->names",
            "all ? refname + strlen(GIT_REFS_DIR) : refname + strlen(GIT_REFS_TAGS_DIR)",
            "&peeled",
            "prio",
            "&sha1"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "add_to_known_names",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "96-139",
          "snippet": "static int add_to_known_names(\n\tgit_repository *repo,\n\tgit_oidmap *names,\n\tconst char *path,\n\tconst git_oid *peeled,\n\tunsigned int prio,\n\tconst git_oid *sha1)\n{\n\tstruct commit_name *e = find_commit_name(names, peeled);\n\tbool found = (e != NULL);\n\n\tgit_tag *tag = NULL;\n\tif (replace_name(&tag, repo, e, prio, sha1)) {\n\t\tif (!found) {\n\t\t\te = git__malloc(sizeof(struct commit_name));\n\t\t\tGITERR_CHECK_ALLOC(e);\n\n\t\t\te->path = NULL;\n\t\t\te->tag = NULL;\n\t\t}\n\n\t\tif (e->tag)\n\t\t\tgit_tag_free(e->tag);\n\t\te->tag = tag;\n\t\te->prio = prio;\n\t\te->name_checked = 0;\n\t\tgit_oid_cpy(&e->sha1, sha1);\n\t\tgit__free(e->path);\n\t\te->path = git__strdup(path);\n\t\tgit_oid_cpy(&e->peeled, peeled);\n\n\t\tif (!found) {\n\t\t\tint ret;\n\n\t\t\tgit_oidmap_insert(names, &e->peeled, e, ret);\n\t\t\tif (ret < 0)\n\t\t\t\treturn -1;\n\t\t}\n\t}\n\telse\n\t\tgit_tag_free(tag);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int add_to_known_names(\n\tgit_repository *repo,\n\tgit_oidmap *names,\n\tconst char *path,\n\tconst git_oid *peeled,\n\tunsigned int prio,\n\tconst git_oid *sha1)\n{\n\tstruct commit_name *e = find_commit_name(names, peeled);\n\tbool found = (e != NULL);\n\n\tgit_tag *tag = NULL;\n\tif (replace_name(&tag, repo, e, prio, sha1)) {\n\t\tif (!found) {\n\t\t\te = git__malloc(sizeof(struct commit_name));\n\t\t\tGITERR_CHECK_ALLOC(e);\n\n\t\t\te->path = NULL;\n\t\t\te->tag = NULL;\n\t\t}\n\n\t\tif (e->tag)\n\t\t\tgit_tag_free(e->tag);\n\t\te->tag = tag;\n\t\te->prio = prio;\n\t\te->name_checked = 0;\n\t\tgit_oid_cpy(&e->sha1, sha1);\n\t\tgit__free(e->path);\n\t\te->path = git__strdup(path);\n\t\tgit_oid_cpy(&e->peeled, peeled);\n\n\t\tif (!found) {\n\t\t\tint ret;\n\n\t\t\tgit_oidmap_insert(names, &e->peeled, e, ret);\n\t\t\tif (ret < 0)\n\t\t\t\treturn -1;\n\t\t}\n\t}\n\telse\n\t\tgit_tag_free(tag);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "GIT_REFS_TAGS_DIR"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "GIT_REFS_DIR"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "retrieve_peeled_tag_or_object_oid",
          "args": [
            "&peeled",
            "&sha1",
            "data->repo",
            "refname"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "retrieve_peeled_tag_or_object_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "141-169",
          "snippet": "static int retrieve_peeled_tag_or_object_oid(\n\tgit_oid *peeled_out,\n\tgit_oid *ref_target_out,\n\tgit_repository *repo,\n\tconst char *refname)\n{\n\tgit_reference *ref;\n\tgit_object *peeled = NULL;\n\tint error;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, refname, -1)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&peeled, ref, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tgit_oid_cpy(ref_target_out, git_reference_target(ref));\n\tgit_oid_cpy(peeled_out, git_object_id(peeled));\n\n\tif (git_oid_cmp(ref_target_out, peeled_out) != 0)\n\t\terror = 1; /* The reference was pointing to a annotated tag */\n\telse\n\t\terror = 0; /* Any other object */\n\ncleanup:\n\tgit_reference_free(ref);\n\tgit_object_free(peeled);\n\treturn error;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int retrieve_peeled_tag_or_object_oid(\n\tgit_oid *peeled_out,\n\tgit_oid *ref_target_out,\n\tgit_repository *repo,\n\tconst char *refname)\n{\n\tgit_reference *ref;\n\tgit_object *peeled = NULL;\n\tint error;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, refname, -1)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&peeled, ref, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tgit_oid_cpy(ref_target_out, git_reference_target(ref));\n\tgit_oid_cpy(peeled_out, git_object_id(peeled));\n\n\tif (git_oid_cmp(ref_target_out, peeled_out) != 0)\n\t\terror = 1; /* The reference was pointing to a annotated tag */\n\telse\n\t\terror = 0; /* Any other object */\n\ncleanup:\n\tgit_reference_free(ref);\n\tgit_object_free(peeled);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_fnmatch",
          "args": [
            "data->opts->pattern",
            "refname + strlen(GIT_REFS_TAGS_DIR)",
            "0"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "p_fnmatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fnmatch.c",
          "lines": "230-234",
          "snippet": "int\np_fnmatch(const char *pattern, const char *string, int flags)\n{\n\t\treturn p_fnmatchx(pattern, string, flags, 64);\n}",
          "includes": [
            "#include \"fnmatch.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fnmatch.h\"\n#include <string.h>\n#include <stdio.h>\n#include <ctype.h>\n\nint\np_fnmatch(const char *pattern, const char *string, int flags)\n{\n\t\treturn p_fnmatchx(pattern, string, flags, 64);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "GIT_REFS_TAGS_DIR"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__prefixcmp",
          "args": [
            "refname",
            "GIT_REFS_TAGS_DIR"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "git__prefixcmp_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "252-255",
          "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int get_name(const char *refname, void *payload)\n{\n\tstruct get_name_data *data;\n\tbool is_tag, is_annotated, all;\n\tgit_oid peeled, sha1;\n\tunsigned int prio;\n\tint error = 0;\n\n\tdata = (struct get_name_data *)payload;\n\tis_tag = !git__prefixcmp(refname, GIT_REFS_TAGS_DIR);\n\tall = data->opts->describe_strategy == GIT_DESCRIBE_ALL;\n\n\t/* Reject anything outside refs/tags/ unless --all */\n\tif (!all && !is_tag)\n\t\treturn 0;\n\n\t/* Accept only tags that match the pattern, if given */\n\tif (data->opts->pattern && (!is_tag || p_fnmatch(data->opts->pattern,\n\t\trefname + strlen(GIT_REFS_TAGS_DIR), 0)))\n\t\t\t\treturn 0;\n\n\t/* Is it annotated? */\n\tif ((error = retrieve_peeled_tag_or_object_oid(\n\t\t&peeled, &sha1, data->repo, refname)) < 0)\n\t\treturn error;\n\n\tis_annotated = error;\n\n\t/*\n\t * By default, we only use annotated tags, but with --tags\n\t * we fall back to lightweight ones (even without --tags,\n\t * we still remember lightweight ones, only to give hints\n\t * in an error message).  --all allows any refs to be used.\n\t */\n\tif (is_annotated)\n\t\tprio = 2;\n\telse if (is_tag)\n\t\tprio = 1;\n\telse\n\t\tprio = 0;\n\n\tadd_to_known_names(data->repo, data->names,\n\t\tall ? refname + strlen(GIT_REFS_DIR) : refname + strlen(GIT_REFS_TAGS_DIR),\n\t\t&peeled, prio, &sha1);\n\treturn 0;\n}"
  },
  {
    "function_name": "commit_name_dup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "189-208",
    "snippet": "static int commit_name_dup(struct commit_name **out, struct commit_name *in)\n{\n\tstruct commit_name *name;\n\n\tname = git__malloc(sizeof(struct commit_name));\n\tGITERR_CHECK_ALLOC(name);\n\n\tmemcpy(name, in,  sizeof(struct commit_name));\n\tname->tag = NULL;\n\tname->path = NULL;\n\n\tif (in->tag && git_object_dup((git_object **) &name->tag, (git_object *) in->tag) < 0)\n\t\treturn -1;\n\n\tname->path = git__strdup(in->path);\n\tGITERR_CHECK_ALLOC(name->path);\n\n\t*out = name;\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "name->path"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "in->path"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_dup",
          "args": [
            "(git_object **) &name->tag",
            "(git_object *) in->tag"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_dup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "383-388",
          "snippet": "int git_object_dup(git_object **dest, git_object *source)\n{\n\tgit_cached_obj_incref(source);\n\t*dest = source;\n\treturn 0;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_dup(git_object **dest, git_object *source)\n{\n\tgit_cached_obj_incref(source);\n\t*dest = source;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "name",
            "in",
            "sizeof(struct commit_name)"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "name"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(struct commit_name)"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int commit_name_dup(struct commit_name **out, struct commit_name *in)\n{\n\tstruct commit_name *name;\n\n\tname = git__malloc(sizeof(struct commit_name));\n\tGITERR_CHECK_ALLOC(name);\n\n\tmemcpy(name, in,  sizeof(struct commit_name));\n\tname->tag = NULL;\n\tname->path = NULL;\n\n\tif (in->tag && git_object_dup((git_object **) &name->tag, (git_object *) in->tag) < 0)\n\t\treturn -1;\n\n\tname->path = git__strdup(in->path);\n\tGITERR_CHECK_ALLOC(name->path);\n\n\t*out = name;\n\treturn 0;\n}"
  },
  {
    "function_name": "retrieve_peeled_tag_or_object_oid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "141-169",
    "snippet": "static int retrieve_peeled_tag_or_object_oid(\n\tgit_oid *peeled_out,\n\tgit_oid *ref_target_out,\n\tgit_repository *repo,\n\tconst char *refname)\n{\n\tgit_reference *ref;\n\tgit_object *peeled = NULL;\n\tint error;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, refname, -1)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&peeled, ref, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tgit_oid_cpy(ref_target_out, git_reference_target(ref));\n\tgit_oid_cpy(peeled_out, git_object_id(peeled));\n\n\tif (git_oid_cmp(ref_target_out, peeled_out) != 0)\n\t\terror = 1; /* The reference was pointing to a annotated tag */\n\telse\n\t\terror = 0; /* Any other object */\n\ncleanup:\n\tgit_reference_free(ref);\n\tgit_object_free(peeled);\n\treturn error;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "peeled"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "ref"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cmp",
          "args": [
            "ref_target_out",
            "peeled_out"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "179-182",
          "snippet": "int git_oid_cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__cmp(a, b);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__cmp(a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "peeled_out",
            "git_object_id(peeled)"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_id",
          "args": [
            "peeled"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "209-213",
          "snippet": "const git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_target",
          "args": [
            "ref"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_target_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "331-339",
          "snippet": "const git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_peel",
          "args": [
            "&peeled",
            "ref",
            "GIT_OBJ_ANY"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "1224-1267",
          "snippet": "int git_reference_peel(\n\tgit_object **peeled,\n\tgit_reference *ref,\n\tgit_otype target_type)\n{\n\tgit_reference *resolved = NULL;\n\tgit_object *target = NULL;\n\tint error;\n\n\tassert(ref);\n\n\tif (ref->type == GIT_REF_OID) {\n\t\tresolved = ref;\n\t} else {\n\t\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\t\treturn peel_error(error, ref, \"Cannot resolve reference\");\n\t}\n\n\tif (!git_oid_iszero(&resolved->peel)) {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->peel, GIT_OBJ_ANY);\n\t} else {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->target.oid, GIT_OBJ_ANY);\n\t}\n\n\tif (error < 0) {\n\t\tpeel_error(error, ref, \"Cannot retrieve reference target\");\n\t\tgoto cleanup;\n\t}\n\n\tif (target_type == GIT_OBJ_ANY && git_object_type(target) != GIT_OBJ_TAG)\n\t\terror = git_object_dup(peeled, target);\n\telse\n\t\terror = git_object_peel(peeled, target, target_type);\n\ncleanup:\n\tgit_object_free(target);\n\n\tif (resolved != ref)\n\t\tgit_reference_free(resolved);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_peel(\n\tgit_object **peeled,\n\tgit_reference *ref,\n\tgit_otype target_type)\n{\n\tgit_reference *resolved = NULL;\n\tgit_object *target = NULL;\n\tint error;\n\n\tassert(ref);\n\n\tif (ref->type == GIT_REF_OID) {\n\t\tresolved = ref;\n\t} else {\n\t\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\t\treturn peel_error(error, ref, \"Cannot resolve reference\");\n\t}\n\n\tif (!git_oid_iszero(&resolved->peel)) {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->peel, GIT_OBJ_ANY);\n\t} else {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->target.oid, GIT_OBJ_ANY);\n\t}\n\n\tif (error < 0) {\n\t\tpeel_error(error, ref, \"Cannot retrieve reference target\");\n\t\tgoto cleanup;\n\t}\n\n\tif (target_type == GIT_OBJ_ANY && git_object_type(target) != GIT_OBJ_TAG)\n\t\terror = git_object_dup(peeled, target);\n\telse\n\t\terror = git_object_peel(peeled, target, target_type);\n\ncleanup:\n\tgit_object_free(target);\n\n\tif (resolved != ref)\n\t\tgit_reference_free(resolved);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup_resolved",
          "args": [
            "&ref",
            "repo",
            "refname",
            "-1"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup_resolved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "181-234",
          "snippet": "int git_reference_lookup_resolved(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tint max_nesting)\n{\n\tgit_refname_t scan_name;\n\tgit_ref_t scan_type;\n\tint error = 0, nesting;\n\tgit_reference *ref = NULL;\n\tgit_refdb *refdb;\n\n\tassert(ref_out && repo && name);\n\n\t*ref_out = NULL;\n\n\tif (max_nesting > MAX_NESTING_LEVEL)\n\t\tmax_nesting = MAX_NESTING_LEVEL;\n\telse if (max_nesting < 0)\n\t\tmax_nesting = DEFAULT_NESTING_LEVEL;\n\n\tscan_type = GIT_REF_SYMBOLIC;\n\n\tif ((error = reference_normalize_for_repo(scan_name, repo, name)) < 0)\n\t\treturn error;\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn error;\n\n\tfor (nesting = max_nesting;\n\t\t nesting >= 0 && scan_type == GIT_REF_SYMBOLIC;\n\t\t nesting--)\n\t{\n\t\tif (nesting != max_nesting) {\n\t\t\tstrncpy(scan_name, ref->target.symbolic, sizeof(scan_name));\n\t\t\tgit_reference_free(ref);\n\t\t}\n\n\t\tif ((error = git_refdb_lookup(&ref, refdb, scan_name)) < 0)\n\t\t\treturn error;\n\n\t\tscan_type = ref->type;\n\t}\n\n\tif (scan_type != GIT_REF_OID && max_nesting != 0) {\n\t\tgiterr_set(GITERR_REFERENCE,\n\t\t\t\"Cannot resolve reference (>%u levels deep)\", max_nesting);\n\t\tgit_reference_free(ref);\n\t\treturn -1;\n\t}\n\n\t*ref_out = ref;\n\treturn 0;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [
            "#define MAX_NESTING_LEVEL\t\t10",
            "#define DEFAULT_NESTING_LEVEL\t5"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\n#define MAX_NESTING_LEVEL\t\t10\n#define DEFAULT_NESTING_LEVEL\t5\n\nint git_reference_lookup_resolved(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tint max_nesting)\n{\n\tgit_refname_t scan_name;\n\tgit_ref_t scan_type;\n\tint error = 0, nesting;\n\tgit_reference *ref = NULL;\n\tgit_refdb *refdb;\n\n\tassert(ref_out && repo && name);\n\n\t*ref_out = NULL;\n\n\tif (max_nesting > MAX_NESTING_LEVEL)\n\t\tmax_nesting = MAX_NESTING_LEVEL;\n\telse if (max_nesting < 0)\n\t\tmax_nesting = DEFAULT_NESTING_LEVEL;\n\n\tscan_type = GIT_REF_SYMBOLIC;\n\n\tif ((error = reference_normalize_for_repo(scan_name, repo, name)) < 0)\n\t\treturn error;\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn error;\n\n\tfor (nesting = max_nesting;\n\t\t nesting >= 0 && scan_type == GIT_REF_SYMBOLIC;\n\t\t nesting--)\n\t{\n\t\tif (nesting != max_nesting) {\n\t\t\tstrncpy(scan_name, ref->target.symbolic, sizeof(scan_name));\n\t\t\tgit_reference_free(ref);\n\t\t}\n\n\t\tif ((error = git_refdb_lookup(&ref, refdb, scan_name)) < 0)\n\t\t\treturn error;\n\n\t\tscan_type = ref->type;\n\t}\n\n\tif (scan_type != GIT_REF_OID && max_nesting != 0) {\n\t\tgiterr_set(GITERR_REFERENCE,\n\t\t\t\"Cannot resolve reference (>%u levels deep)\", max_nesting);\n\t\tgit_reference_free(ref);\n\t\treturn -1;\n\t}\n\n\t*ref_out = ref;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int retrieve_peeled_tag_or_object_oid(\n\tgit_oid *peeled_out,\n\tgit_oid *ref_target_out,\n\tgit_repository *repo,\n\tconst char *refname)\n{\n\tgit_reference *ref;\n\tgit_object *peeled = NULL;\n\tint error;\n\n\tif ((error = git_reference_lookup_resolved(&ref, repo, refname, -1)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&peeled, ref, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tgit_oid_cpy(ref_target_out, git_reference_target(ref));\n\tgit_oid_cpy(peeled_out, git_object_id(peeled));\n\n\tif (git_oid_cmp(ref_target_out, peeled_out) != 0)\n\t\terror = 1; /* The reference was pointing to a annotated tag */\n\telse\n\t\terror = 0; /* Any other object */\n\ncleanup:\n\tgit_reference_free(ref);\n\tgit_object_free(peeled);\n\treturn error;\n}"
  },
  {
    "function_name": "add_to_known_names",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "96-139",
    "snippet": "static int add_to_known_names(\n\tgit_repository *repo,\n\tgit_oidmap *names,\n\tconst char *path,\n\tconst git_oid *peeled,\n\tunsigned int prio,\n\tconst git_oid *sha1)\n{\n\tstruct commit_name *e = find_commit_name(names, peeled);\n\tbool found = (e != NULL);\n\n\tgit_tag *tag = NULL;\n\tif (replace_name(&tag, repo, e, prio, sha1)) {\n\t\tif (!found) {\n\t\t\te = git__malloc(sizeof(struct commit_name));\n\t\t\tGITERR_CHECK_ALLOC(e);\n\n\t\t\te->path = NULL;\n\t\t\te->tag = NULL;\n\t\t}\n\n\t\tif (e->tag)\n\t\t\tgit_tag_free(e->tag);\n\t\te->tag = tag;\n\t\te->prio = prio;\n\t\te->name_checked = 0;\n\t\tgit_oid_cpy(&e->sha1, sha1);\n\t\tgit__free(e->path);\n\t\te->path = git__strdup(path);\n\t\tgit_oid_cpy(&e->peeled, peeled);\n\n\t\tif (!found) {\n\t\t\tint ret;\n\n\t\t\tgit_oidmap_insert(names, &e->peeled, e, ret);\n\t\t\tif (ret < 0)\n\t\t\t\treturn -1;\n\t\t}\n\t}\n\telse\n\t\tgit_tag_free(tag);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tag_free",
          "args": [
            "tag"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "git_tag_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "88-91",
          "snippet": "void git_tag_free(git_tag *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tag_free(git_tag *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oidmap_insert",
          "args": [
            "names",
            "&e->peeled",
            "e",
            "ret"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&e->peeled",
            "peeled"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "path"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "e->path"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "e"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(struct commit_name)"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "replace_name",
          "args": [
            "&tag",
            "repo",
            "e",
            "prio",
            "sha1"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "replace_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "54-94",
          "snippet": "static int replace_name(\n\tgit_tag **tag,\n\tgit_repository *repo,\n\tstruct commit_name *e,\n\tunsigned int prio,\n\tconst git_oid *sha1)\n{\n\tgit_time_t e_time = 0, t_time = 0;\n\n\tif (!e || e->prio < prio)\n\t\treturn 1;\n\n\tif (e->prio == 2 && prio == 2) {\n\t\t/* Multiple annotated tags point to the same commit.\n\t\t * Select one to keep based upon their tagger date.\n\t\t */\n\t\tgit_tag *t = NULL;\n\n\t\tif (!e->tag) {\n\t\t\tif (git_tag_lookup(&t, repo, &e->sha1) < 0)\n\t\t\t\treturn 1;\n\t\t\te->tag = t;\n\t\t}\n\n\t\tif (git_tag_lookup(&t, repo, sha1) < 0)\n\t\t\treturn 0;\n\n\t\t*tag = t;\n\n\t\tif (e->tag->tagger)\n\t\t\te_time = e->tag->tagger->when.time;\n\n\t\tif (t->tagger)\n\t\t\tt_time = t->tagger->when.time;\n\n\t\tif (e_time < t_time)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int replace_name(\n\tgit_tag **tag,\n\tgit_repository *repo,\n\tstruct commit_name *e,\n\tunsigned int prio,\n\tconst git_oid *sha1)\n{\n\tgit_time_t e_time = 0, t_time = 0;\n\n\tif (!e || e->prio < prio)\n\t\treturn 1;\n\n\tif (e->prio == 2 && prio == 2) {\n\t\t/* Multiple annotated tags point to the same commit.\n\t\t * Select one to keep based upon their tagger date.\n\t\t */\n\t\tgit_tag *t = NULL;\n\n\t\tif (!e->tag) {\n\t\t\tif (git_tag_lookup(&t, repo, &e->sha1) < 0)\n\t\t\t\treturn 1;\n\t\t\te->tag = t;\n\t\t}\n\n\t\tif (git_tag_lookup(&t, repo, sha1) < 0)\n\t\t\treturn 0;\n\n\t\t*tag = t;\n\n\t\tif (e->tag->tagger)\n\t\t\te_time = e->tag->tagger->when.time;\n\n\t\tif (t->tagger)\n\t\t\tt_time = t->tagger->when.time;\n\n\t\tif (e_time < t_time)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_commit_name",
          "args": [
            "names",
            "peeled"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "find_commit_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "47-52",
          "snippet": "static struct commit_name *find_commit_name(\n\tgit_oidmap *names,\n\tconst git_oid *peeled)\n{\n\treturn (struct commit_name *)(oidmap_value_bykey(names, peeled));\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic struct commit_name *find_commit_name(\n\tgit_oidmap *names,\n\tconst git_oid *peeled)\n{\n\treturn (struct commit_name *)(oidmap_value_bykey(names, peeled));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int add_to_known_names(\n\tgit_repository *repo,\n\tgit_oidmap *names,\n\tconst char *path,\n\tconst git_oid *peeled,\n\tunsigned int prio,\n\tconst git_oid *sha1)\n{\n\tstruct commit_name *e = find_commit_name(names, peeled);\n\tbool found = (e != NULL);\n\n\tgit_tag *tag = NULL;\n\tif (replace_name(&tag, repo, e, prio, sha1)) {\n\t\tif (!found) {\n\t\t\te = git__malloc(sizeof(struct commit_name));\n\t\t\tGITERR_CHECK_ALLOC(e);\n\n\t\t\te->path = NULL;\n\t\t\te->tag = NULL;\n\t\t}\n\n\t\tif (e->tag)\n\t\t\tgit_tag_free(e->tag);\n\t\te->tag = tag;\n\t\te->prio = prio;\n\t\te->name_checked = 0;\n\t\tgit_oid_cpy(&e->sha1, sha1);\n\t\tgit__free(e->path);\n\t\te->path = git__strdup(path);\n\t\tgit_oid_cpy(&e->peeled, peeled);\n\n\t\tif (!found) {\n\t\t\tint ret;\n\n\t\t\tgit_oidmap_insert(names, &e->peeled, e, ret);\n\t\t\tif (ret < 0)\n\t\t\t\treturn -1;\n\t\t}\n\t}\n\telse\n\t\tgit_tag_free(tag);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "replace_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "54-94",
    "snippet": "static int replace_name(\n\tgit_tag **tag,\n\tgit_repository *repo,\n\tstruct commit_name *e,\n\tunsigned int prio,\n\tconst git_oid *sha1)\n{\n\tgit_time_t e_time = 0, t_time = 0;\n\n\tif (!e || e->prio < prio)\n\t\treturn 1;\n\n\tif (e->prio == 2 && prio == 2) {\n\t\t/* Multiple annotated tags point to the same commit.\n\t\t * Select one to keep based upon their tagger date.\n\t\t */\n\t\tgit_tag *t = NULL;\n\n\t\tif (!e->tag) {\n\t\t\tif (git_tag_lookup(&t, repo, &e->sha1) < 0)\n\t\t\t\treturn 1;\n\t\t\te->tag = t;\n\t\t}\n\n\t\tif (git_tag_lookup(&t, repo, sha1) < 0)\n\t\t\treturn 0;\n\n\t\t*tag = t;\n\n\t\tif (e->tag->tagger)\n\t\t\te_time = e->tag->tagger->when.time;\n\n\t\tif (t->tagger)\n\t\t\tt_time = t->tagger->when.time;\n\n\t\tif (e_time < t_time)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_tag_lookup",
          "args": [
            "&t",
            "repo",
            "sha1"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "git_tag_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "78-81",
          "snippet": "int git_tag_lookup(git_tag **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TAG);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_tag_lookup(git_tag **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_TAG);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic int replace_name(\n\tgit_tag **tag,\n\tgit_repository *repo,\n\tstruct commit_name *e,\n\tunsigned int prio,\n\tconst git_oid *sha1)\n{\n\tgit_time_t e_time = 0, t_time = 0;\n\n\tif (!e || e->prio < prio)\n\t\treturn 1;\n\n\tif (e->prio == 2 && prio == 2) {\n\t\t/* Multiple annotated tags point to the same commit.\n\t\t * Select one to keep based upon their tagger date.\n\t\t */\n\t\tgit_tag *t = NULL;\n\n\t\tif (!e->tag) {\n\t\t\tif (git_tag_lookup(&t, repo, &e->sha1) < 0)\n\t\t\t\treturn 1;\n\t\t\te->tag = t;\n\t\t}\n\n\t\tif (git_tag_lookup(&t, repo, sha1) < 0)\n\t\t\treturn 0;\n\n\t\t*tag = t;\n\n\t\tif (e->tag->tagger)\n\t\t\te_time = e->tag->tagger->when.time;\n\n\t\tif (t->tagger)\n\t\t\tt_time = t->tagger->when.time;\n\n\t\tif (e_time < t_time)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "find_commit_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "47-52",
    "snippet": "static struct commit_name *find_commit_name(\n\tgit_oidmap *names,\n\tconst git_oid *peeled)\n{\n\treturn (struct commit_name *)(oidmap_value_bykey(names, peeled));\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "oidmap_value_bykey",
          "args": [
            "names",
            "peeled"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "oidmap_value_bykey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
          "lines": "37-45",
          "snippet": "static void *oidmap_value_bykey(git_oidmap *map, const git_oid *key)\n{\n\tkhint_t pos = git_oidmap_lookup_index(map, key);\n\n\tif (!git_oidmap_valid_index(map, pos))\n\t\treturn NULL;\n\n\treturn git_oidmap_value_at(map, pos);\n}",
          "includes": [
            "#include \"repository.h\"",
            "#include \"vector.h\"",
            "#include \"tag.h\"",
            "#include \"revwalk.h\"",
            "#include \"refs.h\"",
            "#include \"oidmap.h\"",
            "#include \"commit_list.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\"",
            "#include \"git2/status.h\"",
            "#include \"git2/diff.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"git2/describe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic void *oidmap_value_bykey(git_oidmap *map, const git_oid *key)\n{\n\tkhint_t pos = git_oidmap_lookup_index(map, key);\n\n\tif (!git_oidmap_valid_index(map, pos))\n\t\treturn NULL;\n\n\treturn git_oidmap_value_at(map, pos);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic struct commit_name *find_commit_name(\n\tgit_oidmap *names,\n\tconst git_oid *peeled)\n{\n\treturn (struct commit_name *)(oidmap_value_bykey(names, peeled));\n}"
  },
  {
    "function_name": "oidmap_value_bykey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/describe.c",
    "lines": "37-45",
    "snippet": "static void *oidmap_value_bykey(git_oidmap *map, const git_oid *key)\n{\n\tkhint_t pos = git_oidmap_lookup_index(map, key);\n\n\tif (!git_oidmap_valid_index(map, pos))\n\t\treturn NULL;\n\n\treturn git_oidmap_value_at(map, pos);\n}",
    "includes": [
      "#include \"repository.h\"",
      "#include \"vector.h\"",
      "#include \"tag.h\"",
      "#include \"revwalk.h\"",
      "#include \"refs.h\"",
      "#include \"oidmap.h\"",
      "#include \"commit_list.h\"",
      "#include \"commit.h\"",
      "#include \"common.h\"",
      "#include \"git2/status.h\"",
      "#include \"git2/diff.h\"",
      "#include \"git2/strarray.h\"",
      "#include \"git2/describe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oidmap_value_at",
          "args": [
            "map",
            "pos"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oidmap_valid_index",
          "args": [
            "map",
            "pos"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oidmap_lookup_index",
          "args": [
            "map",
            "key"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repository.h\"\n#include \"vector.h\"\n#include \"tag.h\"\n#include \"revwalk.h\"\n#include \"refs.h\"\n#include \"oidmap.h\"\n#include \"commit_list.h\"\n#include \"commit.h\"\n#include \"common.h\"\n#include \"git2/status.h\"\n#include \"git2/diff.h\"\n#include \"git2/strarray.h\"\n#include \"git2/describe.h\"\n\nstatic void *oidmap_value_bykey(git_oidmap *map, const git_oid *key)\n{\n\tkhint_t pos = git_oidmap_lookup_index(map, key);\n\n\tif (!git_oidmap_valid_index(map, pos))\n\t\treturn NULL;\n\n\treturn git_oidmap_value_at(map, pos);\n}"
  }
]