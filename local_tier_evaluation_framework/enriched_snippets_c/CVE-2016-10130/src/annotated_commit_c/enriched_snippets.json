[
  {
    "function_name": "git_annotated_commit_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
    "lines": "181-202",
    "snippet": "void git_annotated_commit_free(git_annotated_commit *annotated_commit)\n{\n\tif (annotated_commit == NULL)\n\t\treturn;\n\n\tswitch (annotated_commit->type) {\n\t\tcase GIT_ANNOTATED_COMMIT_REAL:\n\t\t\tgit_commit_free(annotated_commit->commit);\n\t\t\tgit_tree_free(annotated_commit->tree);\n\t\t\tgit__free(annotated_commit->ref_name);\n\t\t\tgit__free(annotated_commit->remote_url);\n\t\t\tbreak;\n\t\tcase GIT_ANNOTATED_COMMIT_VIRTUAL:\n\t\t\tgit_index_free(annotated_commit->index);\n\t\t\tgit_array_clear(annotated_commit->parents);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tabort();\n\t}\n\n\tgit__free(annotated_commit);\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/annotated_commit.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/commit.h\"",
      "#include \"cache.h\"",
      "#include \"refs.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "annotated_commit"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "annotated_commit->parents"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_index_free",
          "args": [
            "annotated_commit->index"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "477-483",
          "snippet": "void git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nvoid git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tree_free",
          "args": [
            "annotated_commit->tree"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "git_tree_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "59-62",
          "snippet": "void git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_tree_free(git_tree *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "annotated_commit->commit"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nvoid git_annotated_commit_free(git_annotated_commit *annotated_commit)\n{\n\tif (annotated_commit == NULL)\n\t\treturn;\n\n\tswitch (annotated_commit->type) {\n\t\tcase GIT_ANNOTATED_COMMIT_REAL:\n\t\t\tgit_commit_free(annotated_commit->commit);\n\t\t\tgit_tree_free(annotated_commit->tree);\n\t\t\tgit__free(annotated_commit->ref_name);\n\t\t\tgit__free(annotated_commit->remote_url);\n\t\t\tbreak;\n\t\tcase GIT_ANNOTATED_COMMIT_VIRTUAL:\n\t\t\tgit_index_free(annotated_commit->index);\n\t\t\tgit_array_clear(annotated_commit->parents);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tabort();\n\t}\n\n\tgit__free(annotated_commit);\n}"
  },
  {
    "function_name": "git_annotated_commit_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
    "lines": "174-179",
    "snippet": "const git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/annotated_commit.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/commit.h\"",
      "#include \"cache.h\"",
      "#include \"refs.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_id",
          "args": [
            "annotated_commit->commit"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "35-38",
          "snippet": "const git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "annotated_commit"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nconst git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}"
  },
  {
    "function_name": "git_annotated_commit_from_revspec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
    "lines": "147-171",
    "snippet": "int git_annotated_commit_from_revspec(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst char *revspec)\n{\n\tgit_object *obj, *commit;\n\tint error;\n\n\tassert(out && repo && revspec);\n\n\tif ((error = git_revparse_single(&obj, repo, revspec)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_peel(&commit, obj, GIT_OBJ_COMMIT))) {\n\t\tgit_object_free(obj);\n\t\treturn error;\n\t}\n\n\terror = annotated_commit_init(out, repo, git_object_id(commit), revspec, NULL);\n\n\tgit_object_free(obj);\n\tgit_object_free(commit);\n\n\treturn error;\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/annotated_commit.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/commit.h\"",
      "#include \"cache.h\"",
      "#include \"refs.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "commit"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "annotated_commit_init",
          "args": [
            "out",
            "repo",
            "git_object_id(commit)",
            "revspec",
            "NULL"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "annotated_commit_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "21-56",
          "snippet": "static int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nstatic int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_id",
          "args": [
            "commit"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "209-213",
          "snippet": "const git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_peel",
          "args": [
            "&commit",
            "obj",
            "GIT_OBJ_COMMIT"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "327-381",
          "snippet": "int git_object_peel(\n\tgit_object **peeled,\n\tconst git_object *object,\n\tgit_otype target_type)\n{\n\tgit_object *source, *deref = NULL;\n\tint error;\n\n\tassert(object && peeled);\n\n\tassert(target_type == GIT_OBJ_TAG ||\n\t\ttarget_type == GIT_OBJ_COMMIT ||\n\t\ttarget_type == GIT_OBJ_TREE ||\n\t\ttarget_type == GIT_OBJ_BLOB ||\n\t\ttarget_type == GIT_OBJ_ANY);\n\n\tif ((error = check_type_combination(git_object_type(object), target_type)) < 0)\n\t\treturn peel_error(error, git_object_id(object), target_type);\n\n\tif (git_object_type(object) == target_type)\n\t\treturn git_object_dup(peeled, (git_object *)object);\n\n\tsource = (git_object *)object;\n\n\twhile (!(error = dereference_object(&deref, source))) {\n\n\t\tif (source != object)\n\t\t\tgit_object_free(source);\n\n\t\tif (git_object_type(deref) == target_type) {\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (target_type == GIT_OBJ_ANY &&\n\t\t\tgit_object_type(deref) != git_object_type(object))\n\t\t{\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tsource = deref;\n\t\tderef = NULL;\n\t}\n\n\tif (source != object)\n\t\tgit_object_free(source);\n\n\tgit_object_free(deref);\n\n\tif (error)\n\t\terror = peel_error(error, git_object_id(object), target_type);\n\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_peel(\n\tgit_object **peeled,\n\tconst git_object *object,\n\tgit_otype target_type)\n{\n\tgit_object *source, *deref = NULL;\n\tint error;\n\n\tassert(object && peeled);\n\n\tassert(target_type == GIT_OBJ_TAG ||\n\t\ttarget_type == GIT_OBJ_COMMIT ||\n\t\ttarget_type == GIT_OBJ_TREE ||\n\t\ttarget_type == GIT_OBJ_BLOB ||\n\t\ttarget_type == GIT_OBJ_ANY);\n\n\tif ((error = check_type_combination(git_object_type(object), target_type)) < 0)\n\t\treturn peel_error(error, git_object_id(object), target_type);\n\n\tif (git_object_type(object) == target_type)\n\t\treturn git_object_dup(peeled, (git_object *)object);\n\n\tsource = (git_object *)object;\n\n\twhile (!(error = dereference_object(&deref, source))) {\n\n\t\tif (source != object)\n\t\t\tgit_object_free(source);\n\n\t\tif (git_object_type(deref) == target_type) {\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (target_type == GIT_OBJ_ANY &&\n\t\t\tgit_object_type(deref) != git_object_type(object))\n\t\t{\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tsource = deref;\n\t\tderef = NULL;\n\t}\n\n\tif (source != object)\n\t\tgit_object_free(source);\n\n\tgit_object_free(deref);\n\n\tif (error)\n\t\terror = peel_error(error, git_object_id(object), target_type);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revparse_single",
          "args": [
            "&obj",
            "repo",
            "revspec"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "git_revparse_single",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revparse.c",
          "lines": "855-876",
          "snippet": "int git_revparse_single(git_object **out, git_repository *repo, const char *spec)\n{\n\tint error;\n\tgit_object *obj = NULL;\n\tgit_reference *ref = NULL;\n\n\t*out = NULL;\n\n\tif ((error = git_revparse_ext(&obj, &ref, repo, spec)) < 0)\n\t\tgoto cleanup;\n\n\tgit_reference_free(ref);\n\n\t*out = obj;\n\n\treturn 0;\n\ncleanup:\n\tgit_object_free(obj);\n\tgit_reference_free(ref);\n\treturn error;\n}",
          "includes": [
            "#include \"git2.h\"",
            "#include \"refdb.h\"",
            "#include \"tree.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\"",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2.h\"\n#include \"refdb.h\"\n#include \"tree.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n#include <assert.h>\n\nint git_revparse_single(git_object **out, git_repository *repo, const char *spec)\n{\n\tint error;\n\tgit_object *obj = NULL;\n\tgit_reference *ref = NULL;\n\n\t*out = NULL;\n\n\tif ((error = git_revparse_ext(&obj, &ref, repo, spec)) < 0)\n\t\tgoto cleanup;\n\n\tgit_reference_free(ref);\n\n\t*out = obj;\n\n\treturn 0;\n\ncleanup:\n\tgit_object_free(obj);\n\tgit_reference_free(ref);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo && revspec"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nint git_annotated_commit_from_revspec(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst char *revspec)\n{\n\tgit_object *obj, *commit;\n\tint error;\n\n\tassert(out && repo && revspec);\n\n\tif ((error = git_revparse_single(&obj, repo, revspec)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_peel(&commit, obj, GIT_OBJ_COMMIT))) {\n\t\tgit_object_free(obj);\n\t\treturn error;\n\t}\n\n\terror = annotated_commit_init(out, repo, git_object_id(commit), revspec, NULL);\n\n\tgit_object_free(obj);\n\tgit_object_free(commit);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_annotated_commit_from_fetchhead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
    "lines": "135-145",
    "snippet": "int git_annotated_commit_from_fetchhead(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst char *branch_name,\n\tconst char *remote_url,\n\tconst git_oid *id)\n{\n\tassert(repo && id && branch_name && remote_url);\n\n\treturn annotated_commit_init(out, repo, id, branch_name, remote_url);\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/annotated_commit.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/commit.h\"",
      "#include \"cache.h\"",
      "#include \"refs.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "annotated_commit_init",
          "args": [
            "out",
            "repo",
            "id",
            "branch_name",
            "remote_url"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "annotated_commit_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "21-56",
          "snippet": "static int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nstatic int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && id && branch_name && remote_url"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nint git_annotated_commit_from_fetchhead(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst char *branch_name,\n\tconst char *remote_url,\n\tconst git_oid *id)\n{\n\tassert(repo && id && branch_name && remote_url);\n\n\treturn annotated_commit_init(out, repo, id, branch_name, remote_url);\n}"
  },
  {
    "function_name": "git_annotated_commit_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
    "lines": "125-133",
    "snippet": "int git_annotated_commit_lookup(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id)\n{\n\tassert(out && repo && id);\n\n\treturn annotated_commit_init(out, repo, id, NULL, NULL);\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/annotated_commit.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/commit.h\"",
      "#include \"cache.h\"",
      "#include \"refs.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "annotated_commit_init",
          "args": [
            "out",
            "repo",
            "id",
            "NULL",
            "NULL"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "annotated_commit_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "21-56",
          "snippet": "static int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nstatic int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo && id"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nint git_annotated_commit_lookup(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id)\n{\n\tassert(out && repo && id);\n\n\treturn annotated_commit_init(out, repo, id, NULL, NULL);\n}"
  },
  {
    "function_name": "git_annotated_commit_from_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
    "lines": "100-123",
    "snippet": "int git_annotated_commit_from_commit(\n\tgit_annotated_commit **out,\n\tgit_commit *commit)\n{\n\tgit_annotated_commit *annotated_commit;\n\n\tassert(out && commit);\n\n\t*out = NULL;\n\n\tannotated_commit = git__calloc(1, sizeof(git_annotated_commit));\n\tGITERR_CHECK_ALLOC(annotated_commit);\n\n\tannotated_commit->type = GIT_ANNOTATED_COMMIT_REAL;\n\n\tgit_cached_obj_incref(commit);\n\tannotated_commit->commit = commit;\n\n\tgit_oid_fmt(annotated_commit->id_str, git_commit_id(commit));\n\tannotated_commit->id_str[GIT_OID_HEXSZ] = '\\0';\n\n\t*out = annotated_commit;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/annotated_commit.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/commit.h\"",
      "#include \"cache.h\"",
      "#include \"refs.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "annotated_commit->id_str",
            "git_commit_id(commit)"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_id",
          "args": [
            "commit"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "35-38",
          "snippet": "const git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_commit_id(const git_commit *obj)\n{\n\treturn git_object_id((const git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cached_obj_incref",
          "args": [
            "commit"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "git_cached_obj_incref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.h",
          "lines": "59-63",
          "snippet": "GIT_INLINE(void) git_cached_obj_incref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\tgit_atomic_inc(&obj->refcount);\n}",
          "includes": [
            "#include \"oidmap.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"oidmap.h\"\n#include \"thread-utils.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(void) git_cached_obj_incref(void *_obj)\n{\n\tgit_cached_obj *obj = _obj;\n\tgit_atomic_inc(&obj->refcount);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "annotated_commit"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_annotated_commit)"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && commit"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nint git_annotated_commit_from_commit(\n\tgit_annotated_commit **out,\n\tgit_commit *commit)\n{\n\tgit_annotated_commit *annotated_commit;\n\n\tassert(out && commit);\n\n\t*out = NULL;\n\n\tannotated_commit = git__calloc(1, sizeof(git_annotated_commit));\n\tGITERR_CHECK_ALLOC(annotated_commit);\n\n\tannotated_commit->type = GIT_ANNOTATED_COMMIT_REAL;\n\n\tgit_cached_obj_incref(commit);\n\tannotated_commit->commit = commit;\n\n\tgit_oid_fmt(annotated_commit->id_str, git_commit_id(commit));\n\tannotated_commit->id_str[GIT_OID_HEXSZ] = '\\0';\n\n\t*out = annotated_commit;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_annotated_commit_from_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
    "lines": "80-98",
    "snippet": "int git_annotated_commit_from_head(\n\tgit_annotated_commit **out,\n\tgit_repository *repo)\n{\n\tgit_reference *head;\n\tint error;\n\n\tassert(out && repo);\n\n\t*out = NULL;\n\n    if ((error = git_reference_lookup(&head, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn -1;\n\n\terror = git_annotated_commit_from_ref(out, repo, head);\n\n\tgit_reference_free(head);\n\treturn error;\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/annotated_commit.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/commit.h\"",
      "#include \"cache.h\"",
      "#include \"refs.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "head"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_annotated_commit_from_ref",
          "args": [
            "out",
            "repo",
            "head"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "git_annotated_commit_from_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "58-78",
          "snippet": "int git_annotated_commit_from_ref(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_reference *ref)\n{\n\tgit_reference *resolved;\n\tint error = 0;\n\n\tassert(out && repo && ref);\n\n\t*out = NULL;\n\n\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\treturn error;\n\t\n\terror = annotated_commit_init(out, repo, git_reference_target(resolved),\n\t\tgit_reference_name(ref), NULL);\n\n\tgit_reference_free(resolved);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nint git_annotated_commit_from_ref(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_reference *ref)\n{\n\tgit_reference *resolved;\n\tint error = 0;\n\n\tassert(out && repo && ref);\n\n\t*out = NULL;\n\n\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\treturn error;\n\t\n\terror = annotated_commit_init(out, repo, git_reference_target(resolved),\n\t\tgit_reference_name(ref), NULL);\n\n\tgit_reference_free(resolved);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup",
          "args": [
            "&head",
            "repo",
            "GIT_HEAD_FILE"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "146-150",
          "snippet": "int git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nint git_annotated_commit_from_head(\n\tgit_annotated_commit **out,\n\tgit_repository *repo)\n{\n\tgit_reference *head;\n\tint error;\n\n\tassert(out && repo);\n\n\t*out = NULL;\n\n    if ((error = git_reference_lookup(&head, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn -1;\n\n\terror = git_annotated_commit_from_ref(out, repo, head);\n\n\tgit_reference_free(head);\n\treturn error;\n}"
  },
  {
    "function_name": "git_annotated_commit_from_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
    "lines": "58-78",
    "snippet": "int git_annotated_commit_from_ref(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_reference *ref)\n{\n\tgit_reference *resolved;\n\tint error = 0;\n\n\tassert(out && repo && ref);\n\n\t*out = NULL;\n\n\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\treturn error;\n\t\n\terror = annotated_commit_init(out, repo, git_reference_target(resolved),\n\t\tgit_reference_name(ref), NULL);\n\n\tgit_reference_free(resolved);\n\treturn error;\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/annotated_commit.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/commit.h\"",
      "#include \"cache.h\"",
      "#include \"refs.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "resolved"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "annotated_commit_init",
          "args": [
            "out",
            "repo",
            "git_reference_target(resolved)",
            "git_reference_name(ref)",
            "NULL"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "annotated_commit_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "21-56",
          "snippet": "static int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nstatic int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_name",
          "args": [
            "ref"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "309-313",
          "snippet": "const char *git_reference_name(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->name;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst char *git_reference_name(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_target",
          "args": [
            "resolved"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_target_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "331-339",
          "snippet": "const git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_resolve",
          "args": [
            "&resolved",
            "ref"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_resolve",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "617-630",
          "snippet": "int git_reference_resolve(git_reference **ref_out, const git_reference *ref)\n{\n\tswitch (git_reference_type(ref)) {\n\tcase GIT_REF_OID:\n\t\treturn git_reference_lookup(ref_out, ref->db->repo, ref->name);\n\n\tcase GIT_REF_SYMBOLIC:\n\t\treturn git_reference_lookup_resolved(ref_out, ref->db->repo, ref->target.symbolic, -1);\n\n\tdefault:\n\t\tgiterr_set(GITERR_REFERENCE, \"Invalid reference\");\n\t\treturn -1;\n\t}\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_resolve(git_reference **ref_out, const git_reference *ref)\n{\n\tswitch (git_reference_type(ref)) {\n\tcase GIT_REF_OID:\n\t\treturn git_reference_lookup(ref_out, ref->db->repo, ref->name);\n\n\tcase GIT_REF_SYMBOLIC:\n\t\treturn git_reference_lookup_resolved(ref_out, ref->db->repo, ref->target.symbolic, -1);\n\n\tdefault:\n\t\tgiterr_set(GITERR_REFERENCE, \"Invalid reference\");\n\t\treturn -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo && ref"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nint git_annotated_commit_from_ref(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_reference *ref)\n{\n\tgit_reference *resolved;\n\tint error = 0;\n\n\tassert(out && repo && ref);\n\n\t*out = NULL;\n\n\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\treturn error;\n\t\n\terror = annotated_commit_init(out, repo, git_reference_target(resolved),\n\t\tgit_reference_name(ref), NULL);\n\n\tgit_reference_free(resolved);\n\treturn error;\n}"
  },
  {
    "function_name": "annotated_commit_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
    "lines": "21-56",
    "snippet": "static int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}",
    "includes": [
      "#include \"git2/index.h\"",
      "#include \"git2/tree.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/annotated_commit.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/commit.h\"",
      "#include \"cache.h\"",
      "#include \"refs.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_commit_free",
          "args": [
            "commit"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "30-33",
          "snippet": "void git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_commit_free(git_commit *obj)\n{\n\tgit_object_free((git_object *)obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "annotated_commit->remote_url"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "remote_url"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "annotated_commit->ref_name"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_annotated_commit_from_commit",
          "args": [
            "&annotated_commit",
            "commit"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "git_annotated_commit_from_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "100-123",
          "snippet": "int git_annotated_commit_from_commit(\n\tgit_annotated_commit **out,\n\tgit_commit *commit)\n{\n\tgit_annotated_commit *annotated_commit;\n\n\tassert(out && commit);\n\n\t*out = NULL;\n\n\tannotated_commit = git__calloc(1, sizeof(git_annotated_commit));\n\tGITERR_CHECK_ALLOC(annotated_commit);\n\n\tannotated_commit->type = GIT_ANNOTATED_COMMIT_REAL;\n\n\tgit_cached_obj_incref(commit);\n\tannotated_commit->commit = commit;\n\n\tgit_oid_fmt(annotated_commit->id_str, git_commit_id(commit));\n\tannotated_commit->id_str[GIT_OID_HEXSZ] = '\\0';\n\n\t*out = annotated_commit;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nint git_annotated_commit_from_commit(\n\tgit_annotated_commit **out,\n\tgit_commit *commit)\n{\n\tgit_annotated_commit *annotated_commit;\n\n\tassert(out && commit);\n\n\t*out = NULL;\n\n\tannotated_commit = git__calloc(1, sizeof(git_annotated_commit));\n\tGITERR_CHECK_ALLOC(annotated_commit);\n\n\tannotated_commit->type = GIT_ANNOTATED_COMMIT_REAL;\n\n\tgit_cached_obj_incref(commit);\n\tannotated_commit->commit = commit;\n\n\tgit_oid_fmt(annotated_commit->id_str, git_commit_id(commit));\n\tannotated_commit->id_str[GIT_OID_HEXSZ] = '\\0';\n\n\t*out = annotated_commit;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_commit_lookup",
          "args": [
            "&commit",
            "repo",
            "id"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "git_commit_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "20-23",
          "snippet": "int git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_commit_lookup(git_commit **out, git_repository *repo, const git_oid *id)\n{\n\treturn git_object_lookup((git_object **)out, repo, id, GIT_OBJ_COMMIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && id"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nstatic int annotated_commit_init(\n\tgit_annotated_commit **out,\n\tgit_repository *repo,\n\tconst git_oid *id,\n\tconst char *ref_name,\n\tconst char *remote_url)\n{\n\tgit_annotated_commit *annotated_commit;\n\tgit_commit *commit = NULL;\n\tint error = 0;\n\n\tassert(out && id);\n\n\t*out = NULL;\n\n\tif ((error = git_commit_lookup(&commit, repo, id)) < 0 ||\n\t\t(error = git_annotated_commit_from_commit(&annotated_commit,\n\t\t\tcommit)) < 0)\n\t\tgoto done;\n\n\tif (ref_name) {\n\t\tannotated_commit->ref_name = git__strdup(ref_name);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->ref_name);\n\t}\n\n\tif (remote_url) {\n\t\tannotated_commit->remote_url = git__strdup(remote_url);\n\t\tGITERR_CHECK_ALLOC(annotated_commit->remote_url);\n\t}\n\n\t*out = annotated_commit;\n\ndone:\n\tgit_commit_free(commit);\n\treturn error;\n}"
  }
]