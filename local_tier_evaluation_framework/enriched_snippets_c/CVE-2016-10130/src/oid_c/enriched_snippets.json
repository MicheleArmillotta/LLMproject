[
  {
    "function_name": "git_oid_shorten_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "376-440",
    "snippet": "int git_oid_shorten_add(git_oid_shorten *os, const char *text_oid)\n{\n\tint i;\n\tbool is_leaf;\n\tnode_index idx;\n\n\tif (os->full) {\n\t\tgiterr_set(GITERR_INVALID, \"Unable to shorten OID - OID set full\");\n\t\treturn -1;\n\t}\n\n\tif (text_oid == NULL)\n\t\treturn os->min_length;\n\n\tidx = 0;\n\tis_leaf = false;\n\n\tfor (i = 0; i < GIT_OID_HEXSZ; ++i) {\n\t\tint c = git__fromhex(text_oid[i]);\n\t\ttrie_node *node;\n\n\t\tif (c == -1) {\n\t\t\tgiterr_set(GITERR_INVALID, \"Unable to shorten OID - invalid hex value\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tnode = &os->nodes[idx];\n\n\t\tif (is_leaf) {\n\t\t\tconst char *tail;\n\n\t\t\ttail = node->tail;\n\t\t\tnode->tail = NULL;\n\n\t\t\tnode = push_leaf(os, idx, git__fromhex(tail[0]), &tail[1]);\n\t\t\tif (node == NULL) {\n\t\t\t\tif (os->full)\n\t\t\t\t\tgiterr_set(GITERR_INVALID, \"Unable to shorten OID - OID set full\");\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tif (node->children[c] == 0) {\n\t\t\tif (push_leaf(os, idx, c, &text_oid[i + 1]) == NULL) {\n\t\t\t\tif (os->full)\n\t\t\t\t\tgiterr_set(GITERR_INVALID, \"Unable to shorten OID - OID set full\");\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tidx = node->children[c];\n\t\tis_leaf = false;\n\n\t\tif (idx < 0) {\n\t\t\tnode->children[c] = idx = -idx;\n\t\t\tis_leaf = true;\n\t\t}\n\t}\n\n\tif (++i > os->min_length)\n\t\tos->min_length = i;\n\n\treturn os->min_length;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Unable to shorten OID - OID set full\""
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "push_leaf",
          "args": [
            "os",
            "idx",
            "c",
            "&text_oid[i + 1]"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "push_leaf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "275-299",
          "snippet": "static trie_node *push_leaf(git_oid_shorten *os, node_index idx, int push_at, const char *oid)\n{\n\ttrie_node *node, *leaf;\n\tnode_index idx_leaf;\n\n\tif (os->node_count >= os->size) {\n\t\tif (resize_trie(os, os->size * 2) < 0)\n\t\t\treturn NULL;\n\t}\n\n\tidx_leaf = (node_index)os->node_count++;\n\n\tif (os->node_count == SHRT_MAX) {\n\t\tos->full = 1;\n        return NULL;\n    }\n\n\tnode = &os->nodes[idx];\n\tnode->children[push_at] = -idx_leaf;\n\n\tleaf = &os->nodes[idx_leaf];\n\tleaf->tail = oid;\n\n\treturn node;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic trie_node *push_leaf(git_oid_shorten *os, node_index idx, int push_at, const char *oid)\n{\n\ttrie_node *node, *leaf;\n\tnode_index idx_leaf;\n\n\tif (os->node_count >= os->size) {\n\t\tif (resize_trie(os, os->size * 2) < 0)\n\t\t\treturn NULL;\n\t}\n\n\tidx_leaf = (node_index)os->node_count++;\n\n\tif (os->node_count == SHRT_MAX) {\n\t\tos->full = 1;\n        return NULL;\n    }\n\n\tnode = &os->nodes[idx];\n\tnode->children[push_at] = -idx_leaf;\n\n\tleaf = &os->nodes[idx_leaf];\n\tleaf->tail = oid;\n\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__fromhex",
          "args": [
            "tail[0]"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "git__fromhex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "408-411",
          "snippet": "GIT_INLINE(int) git__fromhex(char h)\n{\n\treturn from_hex[(unsigned char) h];\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__fromhex(char h)\n{\n\treturn from_hex[(unsigned char) h];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_shorten_add(git_oid_shorten *os, const char *text_oid)\n{\n\tint i;\n\tbool is_leaf;\n\tnode_index idx;\n\n\tif (os->full) {\n\t\tgiterr_set(GITERR_INVALID, \"Unable to shorten OID - OID set full\");\n\t\treturn -1;\n\t}\n\n\tif (text_oid == NULL)\n\t\treturn os->min_length;\n\n\tidx = 0;\n\tis_leaf = false;\n\n\tfor (i = 0; i < GIT_OID_HEXSZ; ++i) {\n\t\tint c = git__fromhex(text_oid[i]);\n\t\ttrie_node *node;\n\n\t\tif (c == -1) {\n\t\t\tgiterr_set(GITERR_INVALID, \"Unable to shorten OID - invalid hex value\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tnode = &os->nodes[idx];\n\n\t\tif (is_leaf) {\n\t\t\tconst char *tail;\n\n\t\t\ttail = node->tail;\n\t\t\tnode->tail = NULL;\n\n\t\t\tnode = push_leaf(os, idx, git__fromhex(tail[0]), &tail[1]);\n\t\t\tif (node == NULL) {\n\t\t\t\tif (os->full)\n\t\t\t\t\tgiterr_set(GITERR_INVALID, \"Unable to shorten OID - OID set full\");\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tif (node->children[c] == 0) {\n\t\t\tif (push_leaf(os, idx, c, &text_oid[i + 1]) == NULL) {\n\t\t\t\tif (os->full)\n\t\t\t\t\tgiterr_set(GITERR_INVALID, \"Unable to shorten OID - OID set full\");\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tidx = node->children[c];\n\t\tis_leaf = false;\n\n\t\tif (idx < 0) {\n\t\t\tnode->children[c] = idx = -idx;\n\t\t\tis_leaf = true;\n\t\t}\n\t}\n\n\tif (++i > os->min_length)\n\t\tos->min_length = i;\n\n\treturn os->min_length;\n}"
  },
  {
    "function_name": "git_oid_shorten_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "322-329",
    "snippet": "void git_oid_shorten_free(git_oid_shorten *os)\n{\n\tif (os == NULL)\n\t\treturn;\n\n\tgit__free(os->nodes);\n\tgit__free(os);\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "os"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_shorten_free(git_oid_shorten *os)\n{\n\tif (os == NULL)\n\t\treturn;\n\n\tgit__free(os->nodes);\n\tgit__free(os);\n}"
  },
  {
    "function_name": "git_oid_shorten_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "301-320",
    "snippet": "git_oid_shorten *git_oid_shorten_new(size_t min_length)\n{\n\tgit_oid_shorten *os;\n\n\tassert((size_t)((int)min_length) == min_length);\n\n\tos = git__calloc(1, sizeof(git_oid_shorten));\n\tif (os == NULL)\n\t\treturn NULL;\n\n\tif (resize_trie(os, 16) < 0) {\n\t\tgit__free(os);\n\t\treturn NULL;\n\t}\n\n\tos->node_count = 1;\n\tos->min_length = (int)min_length;\n\n\treturn os;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "os"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "resize_trie",
          "args": [
            "os",
            "16"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "resize_trie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "262-273",
          "snippet": "static int resize_trie(git_oid_shorten *self, size_t new_size)\n{\n\tself->nodes = git__reallocarray(self->nodes, new_size, sizeof(trie_node));\n\tGITERR_CHECK_ALLOC(self->nodes);\n\n\tif (new_size > self->size) {\n\t\tmemset(&self->nodes[self->size], 0x0, (new_size - self->size) * sizeof(trie_node));\n\t}\n\n\tself->size = new_size;\n\treturn 0;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic int resize_trie(git_oid_shorten *self, size_t new_size)\n{\n\tself->nodes = git__reallocarray(self->nodes, new_size, sizeof(trie_node));\n\tGITERR_CHECK_ALLOC(self->nodes);\n\n\tif (new_size > self->size) {\n\t\tmemset(&self->nodes[self->size], 0x0, (new_size - self->size) * sizeof(trie_node));\n\t}\n\n\tself->size = new_size;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_oid_shorten)"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "(size_t)((int)min_length) == min_length"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\ngit_oid_shorten *git_oid_shorten_new(size_t min_length)\n{\n\tgit_oid_shorten *os;\n\n\tassert((size_t)((int)min_length) == min_length);\n\n\tos = git__calloc(1, sizeof(git_oid_shorten));\n\tif (os == NULL)\n\t\treturn NULL;\n\n\tif (resize_trie(os, 16) < 0) {\n\t\tgit__free(os);\n\t\treturn NULL;\n\t}\n\n\tos->node_count = 1;\n\tos->min_length = (int)min_length;\n\n\treturn os;\n}"
  },
  {
    "function_name": "push_leaf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "275-299",
    "snippet": "static trie_node *push_leaf(git_oid_shorten *os, node_index idx, int push_at, const char *oid)\n{\n\ttrie_node *node, *leaf;\n\tnode_index idx_leaf;\n\n\tif (os->node_count >= os->size) {\n\t\tif (resize_trie(os, os->size * 2) < 0)\n\t\t\treturn NULL;\n\t}\n\n\tidx_leaf = (node_index)os->node_count++;\n\n\tif (os->node_count == SHRT_MAX) {\n\t\tos->full = 1;\n        return NULL;\n    }\n\n\tnode = &os->nodes[idx];\n\tnode->children[push_at] = -idx_leaf;\n\n\tleaf = &os->nodes[idx_leaf];\n\tleaf->tail = oid;\n\n\treturn node;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "resize_trie",
          "args": [
            "os",
            "os->size * 2"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "resize_trie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "262-273",
          "snippet": "static int resize_trie(git_oid_shorten *self, size_t new_size)\n{\n\tself->nodes = git__reallocarray(self->nodes, new_size, sizeof(trie_node));\n\tGITERR_CHECK_ALLOC(self->nodes);\n\n\tif (new_size > self->size) {\n\t\tmemset(&self->nodes[self->size], 0x0, (new_size - self->size) * sizeof(trie_node));\n\t}\n\n\tself->size = new_size;\n\treturn 0;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic int resize_trie(git_oid_shorten *self, size_t new_size)\n{\n\tself->nodes = git__reallocarray(self->nodes, new_size, sizeof(trie_node));\n\tGITERR_CHECK_ALLOC(self->nodes);\n\n\tif (new_size > self->size) {\n\t\tmemset(&self->nodes[self->size], 0x0, (new_size - self->size) * sizeof(trie_node));\n\t}\n\n\tself->size = new_size;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic trie_node *push_leaf(git_oid_shorten *os, node_index idx, int push_at, const char *oid)\n{\n\ttrie_node *node, *leaf;\n\tnode_index idx_leaf;\n\n\tif (os->node_count >= os->size) {\n\t\tif (resize_trie(os, os->size * 2) < 0)\n\t\t\treturn NULL;\n\t}\n\n\tidx_leaf = (node_index)os->node_count++;\n\n\tif (os->node_count == SHRT_MAX) {\n\t\tos->full = 1;\n        return NULL;\n    }\n\n\tnode = &os->nodes[idx];\n\tnode->children[push_at] = -idx_leaf;\n\n\tleaf = &os->nodes[idx_leaf];\n\tleaf->tail = oid;\n\n\treturn node;\n}"
  },
  {
    "function_name": "resize_trie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "262-273",
    "snippet": "static int resize_trie(git_oid_shorten *self, size_t new_size)\n{\n\tself->nodes = git__reallocarray(self->nodes, new_size, sizeof(trie_node));\n\tGITERR_CHECK_ALLOC(self->nodes);\n\n\tif (new_size > self->size) {\n\t\tmemset(&self->nodes[self->size], 0x0, (new_size - self->size) * sizeof(trie_node));\n\t}\n\n\tself->size = new_size;\n\treturn 0;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&self->nodes[self->size]",
            "0x0",
            "(new_size - self->size) * sizeof(trie_node)"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "self->nodes"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__reallocarray",
          "args": [
            "self->nodes",
            "new_size",
            "sizeof(trie_node)"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "git__reallocarray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "227-232",
          "snippet": "GIT_INLINE(void *) git__reallocarray(void *ptr, size_t nelem, size_t elsize)\n{\n\tsize_t newsize;\n\treturn GIT_MULTIPLY_SIZET_OVERFLOW(&newsize, nelem, elsize) ?\n\t\tNULL : realloc(ptr, newsize);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__reallocarray(void *ptr, size_t nelem, size_t elsize)\n{\n\tsize_t newsize;\n\treturn GIT_MULTIPLY_SIZET_OVERFLOW(&newsize, nelem, elsize) ?\n\t\tNULL : realloc(ptr, newsize);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic int resize_trie(git_oid_shorten *self, size_t new_size)\n{\n\tself->nodes = git__reallocarray(self->nodes, new_size, sizeof(trie_node));\n\tGITERR_CHECK_ALLOC(self->nodes);\n\n\tif (new_size > self->size) {\n\t\tmemset(&self->nodes[self->size], 0x0, (new_size - self->size) * sizeof(trie_node));\n\t}\n\n\tself->size = new_size;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_oid_iszero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "239-247",
    "snippet": "int git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}"
  },
  {
    "function_name": "git_oid_streq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "234-237",
    "snippet": "int git_oid_streq(const git_oid *oid_a, const char *str)\n{\n\treturn git_oid_strcmp(oid_a, str) == 0 ? 0 : -1;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_strcmp",
          "args": [
            "oid_a",
            "str"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "212-232",
          "snippet": "int git_oid_strcmp(const git_oid *oid_a, const char *str)\n{\n\tconst unsigned char *a;\n\tunsigned char strval;\n\tint hexval;\n\n\tfor (a = oid_a->id; *str && (a - oid_a->id) < GIT_OID_RAWSZ; ++a) {\n\t\tif ((hexval = git__fromhex(*str++)) < 0)\n\t\t\treturn -1;\n\t\tstrval = (unsigned char)(hexval << 4);\n\t\tif (*str) {\n\t\t\tif ((hexval = git__fromhex(*str++)) < 0)\n\t\t\t\treturn -1;\n\t\t\tstrval |= hexval;\n\t\t}\n\t\tif (*a != strval)\n\t\t\treturn (*a - strval);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_strcmp(const git_oid *oid_a, const char *str)\n{\n\tconst unsigned char *a;\n\tunsigned char strval;\n\tint hexval;\n\n\tfor (a = oid_a->id; *str && (a - oid_a->id) < GIT_OID_RAWSZ; ++a) {\n\t\tif ((hexval = git__fromhex(*str++)) < 0)\n\t\t\treturn -1;\n\t\tstrval = (unsigned char)(hexval << 4);\n\t\tif (*str) {\n\t\t\tif ((hexval = git__fromhex(*str++)) < 0)\n\t\t\t\treturn -1;\n\t\t\tstrval |= hexval;\n\t\t}\n\t\tif (*a != strval)\n\t\t\treturn (*a - strval);\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_streq(const git_oid *oid_a, const char *str)\n{\n\treturn git_oid_strcmp(oid_a, str) == 0 ? 0 : -1;\n}"
  },
  {
    "function_name": "git_oid_strcmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "212-232",
    "snippet": "int git_oid_strcmp(const git_oid *oid_a, const char *str)\n{\n\tconst unsigned char *a;\n\tunsigned char strval;\n\tint hexval;\n\n\tfor (a = oid_a->id; *str && (a - oid_a->id) < GIT_OID_RAWSZ; ++a) {\n\t\tif ((hexval = git__fromhex(*str++)) < 0)\n\t\t\treturn -1;\n\t\tstrval = (unsigned char)(hexval << 4);\n\t\tif (*str) {\n\t\t\tif ((hexval = git__fromhex(*str++)) < 0)\n\t\t\t\treturn -1;\n\t\t\tstrval |= hexval;\n\t\t}\n\t\tif (*a != strval)\n\t\t\treturn (*a - strval);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__fromhex",
          "args": [
            "*str++"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "git__fromhex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "408-411",
          "snippet": "GIT_INLINE(int) git__fromhex(char h)\n{\n\treturn from_hex[(unsigned char) h];\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__fromhex(char h)\n{\n\treturn from_hex[(unsigned char) h];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_strcmp(const git_oid *oid_a, const char *str)\n{\n\tconst unsigned char *a;\n\tunsigned char strval;\n\tint hexval;\n\n\tfor (a = oid_a->id; *str && (a - oid_a->id) < GIT_OID_RAWSZ; ++a) {\n\t\tif ((hexval = git__fromhex(*str++)) < 0)\n\t\t\treturn -1;\n\t\tstrval = (unsigned char)(hexval << 4);\n\t\tif (*str) {\n\t\t\tif ((hexval = git__fromhex(*str++)) < 0)\n\t\t\t\treturn -1;\n\t\t\tstrval |= hexval;\n\t\t}\n\t\tif (*a != strval)\n\t\t\treturn (*a - strval);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_oid_ncmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "189-210",
    "snippet": "int git_oid_ncmp(const git_oid *oid_a, const git_oid *oid_b, size_t len)\n{\n\tconst unsigned char *a = oid_a->id;\n\tconst unsigned char *b = oid_b->id;\n\n\tif (len > GIT_OID_HEXSZ)\n\t\tlen = GIT_OID_HEXSZ;\n\n\twhile (len > 1) {\n\t\tif (*a != *b)\n\t\t\treturn 1;\n\t\ta++;\n\t\tb++;\n\t\tlen -= 2;\n\t};\n\n\tif (len)\n\t\tif ((*a ^ *b) & 0xf0)\n\t\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_ncmp(const git_oid *oid_a, const git_oid *oid_b, size_t len)\n{\n\tconst unsigned char *a = oid_a->id;\n\tconst unsigned char *b = oid_b->id;\n\n\tif (len > GIT_OID_HEXSZ)\n\t\tlen = GIT_OID_HEXSZ;\n\n\twhile (len > 1) {\n\t\tif (*a != *b)\n\t\t\treturn 1;\n\t\ta++;\n\t\tb++;\n\t\tlen -= 2;\n\t};\n\n\tif (len)\n\t\tif ((*a ^ *b) & 0xf0)\n\t\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_oid_equal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "184-187",
    "snippet": "int git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid__cmp",
          "args": [
            "a",
            "b"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid__cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.h",
          "lines": "42-45",
          "snippet": "GIT_INLINE(int) git_oid__cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__hashcmp(a->id, b->id);\n}",
          "includes": [
            "#include \"git2/oid.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n\nGIT_INLINE(int) git_oid__cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__hashcmp(a->id, b->id);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}"
  },
  {
    "function_name": "git_oid_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "179-182",
    "snippet": "int git_oid_cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__cmp(a, b);\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid__cmp",
          "args": [
            "a",
            "b"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid__cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.h",
          "lines": "42-45",
          "snippet": "GIT_INLINE(int) git_oid__cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__hashcmp(a->id, b->id);\n}",
          "includes": [
            "#include \"git2/oid.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n\nGIT_INLINE(int) git_oid__cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__hashcmp(a->id, b->id);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_cmp(const git_oid *a, const git_oid *b)\n{\n\treturn git_oid__cmp(a, b);\n}"
  },
  {
    "function_name": "git_oid_cpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "174-177",
    "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out->id",
            "src->id",
            "sizeof(out->id)"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
  },
  {
    "function_name": "git_oid_fromraw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "169-172",
    "snippet": "void git_oid_fromraw(git_oid *out, const unsigned char *raw)\n{\n\tmemcpy(out->id, raw, sizeof(out->id));\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out->id",
            "raw",
            "sizeof(out->id)"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fromraw(git_oid *out, const unsigned char *raw)\n{\n\tmemcpy(out->id, raw, sizeof(out->id));\n}"
  },
  {
    "function_name": "git_oid__writebuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "159-167",
    "snippet": "void git_oid__writebuf(git_buf *buf, const char *header, const git_oid *oid)\n{\n\tchar hex_oid[GIT_OID_HEXSZ];\n\n\tgit_oid_fmt(hex_oid, oid);\n\tgit_buf_puts(buf, header);\n\tgit_buf_put(buf, hex_oid, GIT_OID_HEXSZ);\n\tgit_buf_putc(buf, '\\n');\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "buf",
            "'\\n'"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "buf",
            "hex_oid",
            "GIT_OID_HEXSZ"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "buf",
            "header"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "hex_oid",
            "oid"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid__writebuf(git_buf *buf, const char *header, const git_oid *oid)\n{\n\tchar hex_oid[GIT_OID_HEXSZ];\n\n\tgit_oid_fmt(hex_oid, oid);\n\tgit_buf_puts(buf, header);\n\tgit_buf_put(buf, hex_oid, GIT_OID_HEXSZ);\n\tgit_buf_putc(buf, '\\n');\n}"
  },
  {
    "function_name": "git_oid__parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "133-157",
    "snippet": "int git_oid__parse(\n\tgit_oid *oid, const char **buffer_out,\n\tconst char *buffer_end, const char *header)\n{\n\tconst size_t sha_len = GIT_OID_HEXSZ;\n\tconst size_t header_len = strlen(header);\n\n\tconst char *buffer = *buffer_out;\n\n\tif (buffer + (header_len + sha_len + 1) > buffer_end)\n\t\treturn -1;\n\n\tif (memcmp(buffer, header, header_len) != 0)\n\t\treturn -1;\n\n\tif (buffer[header_len + sha_len] != '\\n')\n\t\treturn -1;\n\n\tif (git_oid_fromstr(oid, buffer + header_len) < 0)\n\t\treturn -1;\n\n\t*buffer_out = buffer + (header_len + sha_len + 1);\n\n\treturn 0;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_fromstr",
          "args": [
            "oid",
            "buffer + header_len"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "54-57",
          "snippet": "int git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "buffer",
            "header",
            "header_len"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "header"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid__parse(\n\tgit_oid *oid, const char **buffer_out,\n\tconst char *buffer_end, const char *header)\n{\n\tconst size_t sha_len = GIT_OID_HEXSZ;\n\tconst size_t header_len = strlen(header);\n\n\tconst char *buffer = *buffer_out;\n\n\tif (buffer + (header_len + sha_len + 1) > buffer_end)\n\t\treturn -1;\n\n\tif (memcmp(buffer, header, header_len) != 0)\n\t\treturn -1;\n\n\tif (buffer[header_len + sha_len] != '\\n')\n\t\treturn -1;\n\n\tif (git_oid_fromstr(oid, buffer + header_len) < 0)\n\t\treturn -1;\n\n\t*buffer_out = buffer + (header_len + sha_len + 1);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_oid_tostr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "119-131",
    "snippet": "char *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_nfmt",
          "args": [
            "out",
            "n - 1",
            "oid"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_nfmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "66-86",
          "snippet": "void git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char to_hex[] = \"0123456789abcdef\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic char to_hex[] = \"0123456789abcdef\";\n\nvoid git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}"
  },
  {
    "function_name": "git_oid_allocfmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "110-117",
    "snippet": "char *git_oid_allocfmt(const git_oid *oid)\n{\n\tchar *str = git__malloc(GIT_OID_HEXSZ + 1);\n\tif (!str)\n\t\treturn NULL;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_nfmt",
          "args": [
            "str",
            "GIT_OID_HEXSZ + 1",
            "oid"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_nfmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "66-86",
          "snippet": "void git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char to_hex[] = \"0123456789abcdef\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic char to_hex[] = \"0123456789abcdef\";\n\nvoid git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "GIT_OID_HEXSZ + 1"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_allocfmt(const git_oid *oid)\n{\n\tchar *str = git__malloc(GIT_OID_HEXSZ + 1);\n\tif (!str)\n\t\treturn NULL;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}"
  },
  {
    "function_name": "git_oid_tostr_s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "103-108",
    "snippet": "char *git_oid_tostr_s(const git_oid *oid)\n{\n\tchar *str = GIT_GLOBAL->oid_fmt;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_nfmt",
          "args": [
            "str",
            "GIT_OID_HEXSZ + 1",
            "oid"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_nfmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "66-86",
          "snippet": "void git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char to_hex[] = \"0123456789abcdef\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic char to_hex[] = \"0123456789abcdef\";\n\nvoid git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr_s(const git_oid *oid)\n{\n\tchar *str = GIT_GLOBAL->oid_fmt;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}"
  },
  {
    "function_name": "git_oid_pathfmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "93-101",
    "snippet": "void git_oid_pathfmt(char *str, const git_oid *oid)\n{\n\tsize_t i;\n\n\tstr = fmt_one(str, oid->id[0]);\n\t*str++ = '/';\n\tfor (i = 1; i < sizeof(oid->id); i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fmt_one",
          "args": [
            "str",
            "oid->id[i]"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "fmt_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "59-64",
          "snippet": "GIT_INLINE(char) *fmt_one(char *str, unsigned int val)\n{\n\t*str++ = to_hex[val >> 4];\n\t*str++ = to_hex[val & 0xf];\n\treturn str;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char to_hex[] = \"0123456789abcdef\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic char to_hex[] = \"0123456789abcdef\";\n\nGIT_INLINE(char) *fmt_one(char *str, unsigned int val)\n{\n\t*str++ = to_hex[val >> 4];\n\t*str++ = to_hex[val & 0xf];\n\treturn str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_pathfmt(char *str, const git_oid *oid)\n{\n\tsize_t i;\n\n\tstr = fmt_one(str, oid->id[0]);\n\t*str++ = '/';\n\tfor (i = 1; i < sizeof(oid->id); i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n}"
  },
  {
    "function_name": "git_oid_fmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "88-91",
    "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_nfmt",
          "args": [
            "str",
            "GIT_OID_HEXSZ",
            "oid"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_nfmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "66-86",
          "snippet": "void git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char to_hex[] = \"0123456789abcdef\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic char to_hex[] = \"0123456789abcdef\";\n\nvoid git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
  },
  {
    "function_name": "git_oid_nfmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "66-86",
    "snippet": "void git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static char to_hex[] = \"0123456789abcdef\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fmt_one",
          "args": [
            "str",
            "oid->id[i]"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "fmt_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "59-64",
          "snippet": "GIT_INLINE(char) *fmt_one(char *str, unsigned int val)\n{\n\t*str++ = to_hex[val >> 4];\n\t*str++ = to_hex[val & 0xf];\n\treturn str;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char to_hex[] = \"0123456789abcdef\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic char to_hex[] = \"0123456789abcdef\";\n\nGIT_INLINE(char) *fmt_one(char *str, unsigned int val)\n{\n\t*str++ = to_hex[val >> 4];\n\t*str++ = to_hex[val & 0xf];\n\treturn str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&str[GIT_OID_HEXSZ]",
            "0",
            "n - GIT_OID_HEXSZ"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "str",
            "0",
            "n"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic char to_hex[] = \"0123456789abcdef\";\n\nvoid git_oid_nfmt(char *str, size_t n, const git_oid *oid)\n{\n\tsize_t i, max_i;\n\n\tif (!oid) {\n\t\tmemset(str, 0, n);\n\t\treturn;\n\t}\n\tif (n > GIT_OID_HEXSZ) {\n\t\tmemset(&str[GIT_OID_HEXSZ], 0, n - GIT_OID_HEXSZ);\n\t\tn = GIT_OID_HEXSZ;\n\t}\n\n\tmax_i = n / 2;\n\n\tfor (i = 0; i < max_i; i++)\n\t\tstr = fmt_one(str, oid->id[i]);\n\n\tif (n & 1)\n\t\t*str++ = to_hex[oid->id[i] >> 4];\n}"
  },
  {
    "function_name": "fmt_one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "59-64",
    "snippet": "GIT_INLINE(char) *fmt_one(char *str, unsigned int val)\n{\n\t*str++ = to_hex[val >> 4];\n\t*str++ = to_hex[val & 0xf];\n\treturn str;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static char to_hex[] = \"0123456789abcdef\";"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic char to_hex[] = \"0123456789abcdef\";\n\nGIT_INLINE(char) *fmt_one(char *str, unsigned int val)\n{\n\t*str++ = to_hex[val >> 4];\n\t*str++ = to_hex[val & 0xf];\n\treturn str;\n}"
  },
  {
    "function_name": "git_oid_fromstr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "54-57",
    "snippet": "int git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_fromstrn",
          "args": [
            "out",
            "str",
            "GIT_OID_HEXSZ"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstrn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "23-47",
          "snippet": "int git_oid_fromstrn(git_oid *out, const char *str, size_t length)\n{\n\tsize_t p;\n\tint v;\n\n\tassert(out && str);\n\n\tif (!length)\n\t\treturn oid_error_invalid(\"too short\");\n\n\tif (length > GIT_OID_HEXSZ)\n\t\treturn oid_error_invalid(\"too long\");\n\n\tmemset(out->id, 0, GIT_OID_RAWSZ);\n\n\tfor (p = 0; p < length; p++) {\n\t\tv = git__fromhex(str[p]);\n\t\tif (v < 0)\n\t\t\treturn oid_error_invalid(\"contains invalid characters\");\n\n\t\tout->id[p / 2] |= (unsigned char)(v << (p % 2 ? 0 : 4));\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstrn(git_oid *out, const char *str, size_t length)\n{\n\tsize_t p;\n\tint v;\n\n\tassert(out && str);\n\n\tif (!length)\n\t\treturn oid_error_invalid(\"too short\");\n\n\tif (length > GIT_OID_HEXSZ)\n\t\treturn oid_error_invalid(\"too long\");\n\n\tmemset(out->id, 0, GIT_OID_RAWSZ);\n\n\tfor (p = 0; p < length; p++) {\n\t\tv = git__fromhex(str[p]);\n\t\tif (v < 0)\n\t\t\treturn oid_error_invalid(\"contains invalid characters\");\n\n\t\tout->id[p / 2] |= (unsigned char)(v << (p % 2 ? 0 : 4));\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstr(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, GIT_OID_HEXSZ);\n}"
  },
  {
    "function_name": "git_oid_fromstrp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "49-52",
    "snippet": "int git_oid_fromstrp(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, strlen(str));\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_fromstrn",
          "args": [
            "out",
            "str",
            "strlen(str)"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fromstrn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "23-47",
          "snippet": "int git_oid_fromstrn(git_oid *out, const char *str, size_t length)\n{\n\tsize_t p;\n\tint v;\n\n\tassert(out && str);\n\n\tif (!length)\n\t\treturn oid_error_invalid(\"too short\");\n\n\tif (length > GIT_OID_HEXSZ)\n\t\treturn oid_error_invalid(\"too long\");\n\n\tmemset(out->id, 0, GIT_OID_RAWSZ);\n\n\tfor (p = 0; p < length; p++) {\n\t\tv = git__fromhex(str[p]);\n\t\tif (v < 0)\n\t\t\treturn oid_error_invalid(\"contains invalid characters\");\n\n\t\tout->id[p / 2] |= (unsigned char)(v << (p % 2 ? 0 : 4));\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstrn(git_oid *out, const char *str, size_t length)\n{\n\tsize_t p;\n\tint v;\n\n\tassert(out && str);\n\n\tif (!length)\n\t\treturn oid_error_invalid(\"too short\");\n\n\tif (length > GIT_OID_HEXSZ)\n\t\treturn oid_error_invalid(\"too long\");\n\n\tmemset(out->id, 0, GIT_OID_RAWSZ);\n\n\tfor (p = 0; p < length; p++) {\n\t\tv = git__fromhex(str[p]);\n\t\tif (v < 0)\n\t\t\treturn oid_error_invalid(\"contains invalid characters\");\n\n\t\tout->id[p / 2] |= (unsigned char)(v << (p % 2 ? 0 : 4));\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstrp(git_oid *out, const char *str)\n{\n\treturn git_oid_fromstrn(out, str, strlen(str));\n}"
  },
  {
    "function_name": "git_oid_fromstrn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "23-47",
    "snippet": "int git_oid_fromstrn(git_oid *out, const char *str, size_t length)\n{\n\tsize_t p;\n\tint v;\n\n\tassert(out && str);\n\n\tif (!length)\n\t\treturn oid_error_invalid(\"too short\");\n\n\tif (length > GIT_OID_HEXSZ)\n\t\treturn oid_error_invalid(\"too long\");\n\n\tmemset(out->id, 0, GIT_OID_RAWSZ);\n\n\tfor (p = 0; p < length; p++) {\n\t\tv = git__fromhex(str[p]);\n\t\tif (v < 0)\n\t\t\treturn oid_error_invalid(\"contains invalid characters\");\n\n\t\tout->id[p / 2] |= (unsigned char)(v << (p % 2 ? 0 : 4));\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "oid_error_invalid",
          "args": [
            "\"contains invalid characters\""
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "oid_error_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "17-21",
          "snippet": "static int oid_error_invalid(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Unable to parse OID - %s\", msg);\n\treturn -1;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic int oid_error_invalid(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Unable to parse OID - %s\", msg);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__fromhex",
          "args": [
            "str[p]"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "git__fromhex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "408-411",
          "snippet": "GIT_INLINE(int) git__fromhex(char h)\n{\n\treturn from_hex[(unsigned char) h];\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__fromhex(char h)\n{\n\treturn from_hex[(unsigned char) h];\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "out->id",
            "0",
            "GIT_OID_RAWSZ"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && str"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_fromstrn(git_oid *out, const char *str, size_t length)\n{\n\tsize_t p;\n\tint v;\n\n\tassert(out && str);\n\n\tif (!length)\n\t\treturn oid_error_invalid(\"too short\");\n\n\tif (length > GIT_OID_HEXSZ)\n\t\treturn oid_error_invalid(\"too long\");\n\n\tmemset(out->id, 0, GIT_OID_RAWSZ);\n\n\tfor (p = 0; p < length; p++) {\n\t\tv = git__fromhex(str[p]);\n\t\tif (v < 0)\n\t\t\treturn oid_error_invalid(\"contains invalid characters\");\n\n\t\tout->id[p / 2] |= (unsigned char)(v << (p % 2 ? 0 : 4));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "oid_error_invalid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
    "lines": "17-21",
    "snippet": "static int oid_error_invalid(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Unable to parse OID - %s\", msg);\n\treturn -1;\n}",
    "includes": [
      "#include <limits.h>",
      "#include <string.h>",
      "#include \"global.h\"",
      "#include \"repository.h\"",
      "#include \"git2/oid.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Unable to parse OID - %s\"",
            "msg"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nstatic int oid_error_invalid(const char *msg)\n{\n\tgiterr_set(GITERR_INVALID, \"Unable to parse OID - %s\", msg);\n\treturn -1;\n}"
  }
]