[
  {
    "function_name": "git_sysdir_find_template_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "272-276",
    "snippet": "int git_sysdir_find_template_dir(git_buf *path)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, NULL, GIT_SYSDIR_TEMPLATE, \"template\");\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_sysdir_find_in_dirlist",
          "args": [
            "path",
            "NULL",
            "GIT_SYSDIR_TEMPLATE",
            "\"template\""
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_in_dirlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "207-246",
          "snippet": "static int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_template_dir(git_buf *path)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, NULL, GIT_SYSDIR_TEMPLATE, \"template\");\n}"
  },
  {
    "function_name": "git_sysdir_find_programdata_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "266-270",
    "snippet": "int git_sysdir_find_programdata_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_PROGRAMDATA, \"ProgramData\");\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_sysdir_find_in_dirlist",
          "args": [
            "path",
            "filename",
            "GIT_SYSDIR_PROGRAMDATA",
            "\"ProgramData\""
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_in_dirlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "207-246",
          "snippet": "static int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_programdata_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_PROGRAMDATA, \"ProgramData\");\n}"
  },
  {
    "function_name": "git_sysdir_find_xdg_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "260-264",
    "snippet": "int git_sysdir_find_xdg_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_XDG, \"global/xdg\");\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_sysdir_find_in_dirlist",
          "args": [
            "path",
            "filename",
            "GIT_SYSDIR_XDG",
            "\"global/xdg\""
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_in_dirlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "207-246",
          "snippet": "static int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_xdg_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_XDG, \"global/xdg\");\n}"
  },
  {
    "function_name": "git_sysdir_find_global_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "254-258",
    "snippet": "int git_sysdir_find_global_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_GLOBAL, \"global\");\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_sysdir_find_in_dirlist",
          "args": [
            "path",
            "filename",
            "GIT_SYSDIR_GLOBAL",
            "\"global\""
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_in_dirlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "207-246",
          "snippet": "static int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_global_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_GLOBAL, \"global\");\n}"
  },
  {
    "function_name": "git_sysdir_find_system_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "248-252",
    "snippet": "int git_sysdir_find_system_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_SYSTEM, \"system\");\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_sysdir_find_in_dirlist",
          "args": [
            "path",
            "filename",
            "GIT_SYSDIR_SYSTEM",
            "\"system\""
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_in_dirlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "207-246",
          "snippet": "static int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_system_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_SYSTEM, \"system\");\n}"
  },
  {
    "function_name": "git_sysdir_find_in_dirlist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "207-246",
    "snippet": "static int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"The %s file '%s' doesn't exist\"",
            "label",
            "name"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "path"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_exists",
          "args": [
            "path->ptr"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "503-507",
          "snippet": "bool git_path_exists(const char *path)\n{\n\tassert(path);\n\treturn p_access(path, F_OK) == 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_exists(const char *path)\n{\n\tassert(path);\n\treturn p_access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ERROR",
          "args": [
            "git_buf_joinpath(path, path->ptr, name)"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "path",
            "path->ptr",
            "name"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ERROR",
          "args": [
            "git_buf_set(path, scan, len)"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_set",
          "args": [
            "path",
            "scan",
            "len"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "150-169",
          "snippet": "int git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "syspath"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "syspath"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ERROR",
          "args": [
            "git_sysdir_get(&syspath, which)"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_sysdir_get",
          "args": [
            "&syspath",
            "which"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "130-140",
          "snippet": "int git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_find_in_dirlist(\n\tgit_buf *path,\n\tconst char *name,\n\tgit_sysdir_t which,\n\tconst char *label)\n{\n\tsize_t len;\n\tconst char *scan, *next = NULL;\n\tconst git_buf *syspath;\n\n\tGITERR_CHECK_ERROR(git_sysdir_get(&syspath, which));\n\tif (!syspath || !git_buf_len(syspath))\n\t\tgoto done;\n\n\tfor (scan = git_buf_cstr(syspath); scan; scan = next) {\n\t\t/* find unescaped separator or end of string */\n\t\tfor (next = scan; *next; ++next) {\n\t\t\tif (*next == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t\t(next <= scan || next[-1] != '\\\\'))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlen = (size_t)(next - scan);\n\t\tnext = (*next ? next + 1 : NULL);\n\t\tif (!len)\n\t\t\tcontinue;\n\n\t\tGITERR_CHECK_ERROR(git_buf_set(path, scan, len));\n\t\tif (name)\n\t\t\tGITERR_CHECK_ERROR(git_buf_joinpath(path, path->ptr, name));\n\n\t\tif (git_path_exists(path->ptr))\n\t\t\treturn 0;\n\t}\n\ndone:\n\tgit_buf_free(path);\n\tgiterr_set(GITERR_OS, \"The %s file '%s' doesn't exist\", label, name);\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git_sysdir_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "163-205",
    "snippet": "int git_sysdir_set(git_sysdir_t which, const char *search_path)\n{\n\tconst char *expand_path = NULL;\n\tgit_buf merge = GIT_BUF_INIT;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\tif (search_path != NULL)\n\t\texpand_path = strstr(search_path, PATH_MAGIC);\n\n\t/* reset the default if this path has been cleared */\n\tif (!search_path || expand_path)\n\t\tgit_sysdir__dirs[which].guess(&git_sysdir__dirs[which].buf);\n\n\t/* if $PATH is not referenced, then just set the path */\n\tif (!expand_path) {\n\t\tif (search_path)\n\t\t\tgit_buf_sets(&git_sysdir__dirs[which].buf, search_path);\n\n\t\tgoto done;\n\t}\n\n\t/* otherwise set to join(before $PATH, old value, after $PATH) */\n\tif (expand_path > search_path)\n\t\tgit_buf_set(&merge, search_path, expand_path - search_path);\n\n\tif (git_buf_len(&git_sysdir__dirs[which].buf))\n\t\tgit_buf_join(&merge, GIT_PATH_LIST_SEPARATOR,\n\t\t\tmerge.ptr, git_sysdir__dirs[which].buf.ptr);\n\n\texpand_path += strlen(PATH_MAGIC);\n\tif (*expand_path)\n\t\tgit_buf_join(&merge, GIT_PATH_LIST_SEPARATOR, merge.ptr, expand_path);\n\n\tgit_buf_swap(&git_sysdir__dirs[which].buf, &merge);\n\tgit_buf_free(&merge);\n\ndone:\n\tif (git_buf_oom(&git_sysdir__dirs[which].buf))\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define PATH_MAGIC \"$PATH\""
    ],
    "globals_used": [
      "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "&git_sysdir__dirs[which].buf"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&merge"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_swap",
          "args": [
            "&git_sysdir__dirs[which].buf",
            "&merge"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_swap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "470-475",
          "snippet": "void git_buf_swap(git_buf *buf_a, git_buf *buf_b)\n{\n\tgit_buf t = *buf_a;\n\t*buf_a = *buf_b;\n\t*buf_b = t;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_swap(git_buf *buf_a, git_buf *buf_b)\n{\n\tgit_buf t = *buf_a;\n\t*buf_a = *buf_b;\n\t*buf_b = t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_join",
          "args": [
            "&merge",
            "GIT_PATH_LIST_SEPARATOR",
            "merge.ptr",
            "expand_path"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "607-655",
          "snippet": "int git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "PATH_MAGIC"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "&git_sysdir__dirs[which].buf"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_set",
          "args": [
            "&merge",
            "search_path",
            "expand_path - search_path"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "150-169",
          "snippet": "int git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sets",
          "args": [
            "&git_sysdir__dirs[which].buf",
            "search_path"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "181-184",
          "snippet": "int git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_sysdir__dirs[which].guess",
          "args": [
            "&git_sysdir__dirs[which].buf"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "search_path",
            "PATH_MAGIC"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ERROR",
          "args": [
            "git_sysdir_check_selector(which)"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_sysdir_check_selector",
          "args": [
            "which"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_check_selector",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "120-127",
          "snippet": "static int git_sysdir_check_selector(git_sysdir_t which)\n{\n\tif (which < ARRAY_SIZE(git_sysdir__dirs))\n\t\treturn 0;\n\n\tgiterr_set(GITERR_INVALID, \"config directory selector out of range\");\n\treturn -1;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nstatic int git_sysdir_check_selector(git_sysdir_t which)\n{\n\tif (which < ARRAY_SIZE(git_sysdir__dirs))\n\t\treturn 0;\n\n\tgiterr_set(GITERR_INVALID, \"config directory selector out of range\");\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\n#define PATH_MAGIC \"$PATH\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_set(git_sysdir_t which, const char *search_path)\n{\n\tconst char *expand_path = NULL;\n\tgit_buf merge = GIT_BUF_INIT;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\tif (search_path != NULL)\n\t\texpand_path = strstr(search_path, PATH_MAGIC);\n\n\t/* reset the default if this path has been cleared */\n\tif (!search_path || expand_path)\n\t\tgit_sysdir__dirs[which].guess(&git_sysdir__dirs[which].buf);\n\n\t/* if $PATH is not referenced, then just set the path */\n\tif (!expand_path) {\n\t\tif (search_path)\n\t\t\tgit_buf_sets(&git_sysdir__dirs[which].buf, search_path);\n\n\t\tgoto done;\n\t}\n\n\t/* otherwise set to join(before $PATH, old value, after $PATH) */\n\tif (expand_path > search_path)\n\t\tgit_buf_set(&merge, search_path, expand_path - search_path);\n\n\tif (git_buf_len(&git_sysdir__dirs[which].buf))\n\t\tgit_buf_join(&merge, GIT_PATH_LIST_SEPARATOR,\n\t\t\tmerge.ptr, git_sysdir__dirs[which].buf.ptr);\n\n\texpand_path += strlen(PATH_MAGIC);\n\tif (*expand_path)\n\t\tgit_buf_join(&merge, GIT_PATH_LIST_SEPARATOR, merge.ptr, expand_path);\n\n\tgit_buf_swap(&git_sysdir__dirs[which].buf, &merge);\n\tgit_buf_free(&merge);\n\ndone:\n\tif (git_buf_oom(&git_sysdir__dirs[which].buf))\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_sysdir_get_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "142-159",
    "snippet": "int git_sysdir_get_str(\n\tchar *out,\n\tsize_t outlen,\n\tgit_sysdir_t which)\n{\n\tconst git_buf *path = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\tGITERR_CHECK_ERROR(git_sysdir_get(&path, which));\n\n\tif (!out || path->size >= outlen) {\n\t\tgiterr_set(GITERR_NOMEMORY, \"Buffer is too short for the path\");\n\t\treturn GIT_EBUFS;\n\t}\n\n\tgit_buf_copy_cstr(out, outlen, path);\n\treturn 0;\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_copy_cstr",
          "args": [
            "out",
            "outlen",
            "path"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_copy_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "418-434",
          "snippet": "void git_buf_copy_cstr(char *data, size_t datasize, const git_buf *buf)\n{\n\tsize_t copylen;\n\n\tassert(data && datasize && buf);\n\n\tdata[0] = '\\0';\n\n\tif (buf->size == 0 || buf->asize <= 0)\n\t\treturn;\n\n\tcopylen = buf->size;\n\tif (copylen > datasize - 1)\n\t\tcopylen = datasize - 1;\n\tmemmove(data, buf->ptr, copylen);\n\tdata[copylen] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_copy_cstr(char *data, size_t datasize, const git_buf *buf)\n{\n\tsize_t copylen;\n\n\tassert(data && datasize && buf);\n\n\tdata[0] = '\\0';\n\n\tif (buf->size == 0 || buf->asize <= 0)\n\t\treturn;\n\n\tcopylen = buf->size;\n\tif (copylen > datasize - 1)\n\t\tcopylen = datasize - 1;\n\tmemmove(data, buf->ptr, copylen);\n\tdata[copylen] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NOMEMORY",
            "\"Buffer is too short for the path\""
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ERROR",
          "args": [
            "git_sysdir_get(&path, which)"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_sysdir_get",
          "args": [
            "&path",
            "which"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "130-140",
          "snippet": "int git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ERROR",
          "args": [
            "git_sysdir_check_selector(which)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_sysdir_check_selector",
          "args": [
            "which"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_check_selector",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "120-127",
          "snippet": "static int git_sysdir_check_selector(git_sysdir_t which)\n{\n\tif (which < ARRAY_SIZE(git_sysdir__dirs))\n\t\treturn 0;\n\n\tgiterr_set(GITERR_INVALID, \"config directory selector out of range\");\n\treturn -1;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nstatic int git_sysdir_check_selector(git_sysdir_t which)\n{\n\tif (which < ARRAY_SIZE(git_sysdir__dirs))\n\t\treturn 0;\n\n\tgiterr_set(GITERR_INVALID, \"config directory selector out of range\");\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_get_str(\n\tchar *out,\n\tsize_t outlen,\n\tgit_sysdir_t which)\n{\n\tconst git_buf *path = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\tGITERR_CHECK_ERROR(git_sysdir_get(&path, which));\n\n\tif (!out || path->size >= outlen) {\n\t\tgiterr_set(GITERR_NOMEMORY, \"Buffer is too short for the path\");\n\t\treturn GIT_EBUFS;\n\t}\n\n\tgit_buf_copy_cstr(out, outlen, path);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_sysdir_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "130-140",
    "snippet": "int git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ERROR",
          "args": [
            "git_sysdir_check_selector(which)"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_sysdir_check_selector",
          "args": [
            "which"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_check_selector",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "120-127",
          "snippet": "static int git_sysdir_check_selector(git_sysdir_t which)\n{\n\tif (which < ARRAY_SIZE(git_sysdir__dirs))\n\t\treturn 0;\n\n\tgiterr_set(GITERR_INVALID, \"config directory selector out of range\");\n\treturn -1;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nstatic int git_sysdir_check_selector(git_sysdir_t which)\n{\n\tif (which < ARRAY_SIZE(git_sysdir__dirs))\n\t\treturn 0;\n\n\tgiterr_set(GITERR_INVALID, \"config directory selector out of range\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_get(const git_buf **out, git_sysdir_t which)\n{\n\tassert(out);\n\n\t*out = NULL;\n\n\tGITERR_CHECK_ERROR(git_sysdir_check_selector(which));\n\n\t*out = &git_sysdir__dirs[which].buf;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_sysdir_check_selector",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "120-127",
    "snippet": "static int git_sysdir_check_selector(git_sysdir_t which)\n{\n\tif (which < ARRAY_SIZE(git_sysdir__dirs))\n\t\treturn 0;\n\n\tgiterr_set(GITERR_INVALID, \"config directory selector out of range\");\n\treturn -1;\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"config directory selector out of range\""
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "git_sysdir__dirs"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nstatic int git_sysdir_check_selector(git_sysdir_t which)\n{\n\tif (which < ARRAY_SIZE(git_sysdir__dirs))\n\t\treturn 0;\n\n\tgiterr_set(GITERR_INVALID, \"config directory selector out of range\");\n\treturn -1;\n}"
  },
  {
    "function_name": "git_sysdir_global_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "107-118",
    "snippet": "int git_sysdir_global_init(void)\n{\n\tsize_t i;\n\tint error = 0;\n\n\tfor (i = 0; !error && i < ARRAY_SIZE(git_sysdir__dirs); i++)\n\t\terror = git_sysdir__dirs[i].guess(&git_sysdir__dirs[i].buf);\n\n\tgit__on_shutdown(git_sysdir_global_shutdown);\n\n\treturn error;\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__on_shutdown",
          "args": [
            "git_sysdir_global_shutdown"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "git__on_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "32-37",
          "snippet": "void git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MAX_SHUTDOWN_CB 8"
          ],
          "globals_used": [
            "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
            "static git_atomic git__n_shutdown_callbacks;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\n#define MAX_SHUTDOWN_CB 8\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\n\nvoid git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_sysdir__dirs[i].guess",
          "args": [
            "&git_sysdir__dirs[i].buf"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "git_sysdir__dirs"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_global_init(void)\n{\n\tsize_t i;\n\tint error = 0;\n\n\tfor (i = 0; !error && i < ARRAY_SIZE(git_sysdir__dirs); i++)\n\t\terror = git_sysdir__dirs[i].guess(&git_sysdir__dirs[i].buf);\n\n\tgit__on_shutdown(git_sysdir_global_shutdown);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_sysdir_global_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "99-105",
    "snippet": "static void git_sysdir_global_shutdown(void)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < ARRAY_SIZE(git_sysdir__dirs); ++i)\n\t\tgit_buf_free(&git_sysdir__dirs[i].buf);\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&git_sysdir__dirs[i].buf"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "git_sysdir__dirs"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nstatic void git_sysdir_global_shutdown(void)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < ARRAY_SIZE(git_sysdir__dirs); ++i)\n\t\tgit_buf_free(&git_sysdir__dirs[i].buf);\n}"
  },
  {
    "function_name": "git_sysdir_guess_template_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "77-84",
    "snippet": "static int git_sysdir_guess_template_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_system_dirs(out, L\"share\\\\git-core\\\\templates\");\n#else\n\treturn git_buf_sets(out, \"/usr/share/git-core/templates\");\n#endif\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_sets",
          "args": [
            "out",
            "\"/usr/share/git-core/templates\""
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "181-184",
          "snippet": "int git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__find_system_dirs",
          "args": [
            "out",
            "L\"share\\\\git-core\\\\templates\""
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__find_system_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "165-190",
          "snippet": "int git_win32__find_system_dirs(git_buf *out, const wchar_t *subdir)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\n\t/* directories where git.exe & git.cmd are found */\n\tif (!win32_find_git_in_path(&buf, L\"git.exe\", subdir) && buf.size)\n\t\tgit_buf_set(out, buf.ptr, buf.size);\n\telse\n\t\tgit_buf_clear(out);\n\n\tif (!win32_find_git_in_path(&buf, L\"git.cmd\", subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\t/* directories where git is installed according to registry */\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_CURRENT_USER, REG_MSYSGIT_INSTALL_LOCAL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_LOCAL_MACHINE, REG_MSYSGIT_INSTALL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [
            "#define REG_MSYSGIT_INSTALL L\"SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\"",
            "#define REG_MSYSGIT_INSTALL REG_MSYSGIT_INSTALL_LOCAL",
            "#define REG_MSYSGIT_INSTALL_LOCAL L\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\n#define REG_MSYSGIT_INSTALL L\"SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\"\n#define REG_MSYSGIT_INSTALL REG_MSYSGIT_INSTALL_LOCAL\n#define REG_MSYSGIT_INSTALL_LOCAL L\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\"\n\nint git_win32__find_system_dirs(git_buf *out, const wchar_t *subdir)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\n\t/* directories where git.exe & git.cmd are found */\n\tif (!win32_find_git_in_path(&buf, L\"git.exe\", subdir) && buf.size)\n\t\tgit_buf_set(out, buf.ptr, buf.size);\n\telse\n\t\tgit_buf_clear(out);\n\n\tif (!win32_find_git_in_path(&buf, L\"git.cmd\", subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\t/* directories where git is installed according to registry */\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_CURRENT_USER, REG_MSYSGIT_INSTALL_LOCAL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_LOCAL_MACHINE, REG_MSYSGIT_INSTALL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_guess_template_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_system_dirs(out, L\"share\\\\git-core\\\\templates\");\n#else\n\treturn git_buf_sets(out, \"/usr/share/git-core/templates\");\n#endif\n}"
  },
  {
    "function_name": "git_sysdir_guess_xdg_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "53-75",
    "snippet": "static int git_sysdir_guess_xdg_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_xdg_dirs(out);\n#else\n\tgit_buf env = GIT_BUF_INIT;\n\tint error;\n\n\tif ((error = git__getenv(&env, \"XDG_CONFIG_HOME\")) == 0)\n\t\terror = git_buf_joinpath(out, env.ptr, \"git\");\n\n\tif (error == GIT_ENOTFOUND && (error = git__getenv(&env, \"HOME\")) == 0)\n\t\terror = git_buf_joinpath(out, env.ptr, \".config/git\");\n\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = 0;\n\t}\n\n\tgit_buf_free(&env);\n\treturn error;\n#endif\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&env"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "out",
            "env.ptr",
            "\".config/git\""
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__getenv",
          "args": [
            "&env",
            "\"HOME\""
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "git__getenv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "799-809",
          "snippet": "int git__getenv(git_buf *out, const char *name)\n{\n\tconst char *val = getenv(name);\n\n\tgit_buf_clear(out);\n\n\tif (!val)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn git_buf_puts(out, val);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__getenv(git_buf *out, const char *name)\n{\n\tconst char *val = getenv(name);\n\n\tgit_buf_clear(out);\n\n\tif (!val)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn git_buf_puts(out, val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__find_xdg_dirs",
          "args": [
            "out"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__find_xdg_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "204-217",
          "snippet": "int git_win32__find_xdg_dirs(git_buf *out)\n{\n\tstatic const wchar_t *global_tmpls[7] = {\n\t\tL\"%XDG_CONFIG_HOME%\\\\git\",\n\t\tL\"%APPDATA%\\\\git\",\n\t\tL\"%LOCALAPPDATA%\\\\git\",\n\t\tL\"%HOME%\\\\.config\\\\git\",\n\t\tL\"%HOMEDRIVE%%HOMEPATH%\\\\.config\\\\git\",\n\t\tL\"%USERPROFILE%\\\\.config\\\\git\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, global_tmpls);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nint git_win32__find_xdg_dirs(git_buf *out)\n{\n\tstatic const wchar_t *global_tmpls[7] = {\n\t\tL\"%XDG_CONFIG_HOME%\\\\git\",\n\t\tL\"%APPDATA%\\\\git\",\n\t\tL\"%LOCALAPPDATA%\\\\git\",\n\t\tL\"%HOME%\\\\.config\\\\git\",\n\t\tL\"%HOMEDRIVE%%HOMEPATH%\\\\.config\\\\git\",\n\t\tL\"%USERPROFILE%\\\\.config\\\\git\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, global_tmpls);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_guess_xdg_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_xdg_dirs(out);\n#else\n\tgit_buf env = GIT_BUF_INIT;\n\tint error;\n\n\tif ((error = git__getenv(&env, \"XDG_CONFIG_HOME\")) == 0)\n\t\terror = git_buf_joinpath(out, env.ptr, \"git\");\n\n\tif (error == GIT_ENOTFOUND && (error = git__getenv(&env, \"HOME\")) == 0)\n\t\terror = git_buf_joinpath(out, env.ptr, \".config/git\");\n\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = 0;\n\t}\n\n\tgit_buf_free(&env);\n\treturn error;\n#endif\n}"
  },
  {
    "function_name": "git_sysdir_guess_global_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "37-51",
    "snippet": "static int git_sysdir_guess_global_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_global_dirs(out);\n#else\n\tint error = git__getenv(out, \"HOME\");\n\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = 0;\n\t}\n\n\treturn error;\n#endif\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__getenv",
          "args": [
            "out",
            "\"HOME\""
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "git__getenv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "799-809",
          "snippet": "int git__getenv(git_buf *out, const char *name)\n{\n\tconst char *val = getenv(name);\n\n\tgit_buf_clear(out);\n\n\tif (!val)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn git_buf_puts(out, val);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__getenv(git_buf *out, const char *name)\n{\n\tconst char *val = getenv(name);\n\n\tgit_buf_clear(out);\n\n\tif (!val)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn git_buf_puts(out, val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__find_global_dirs",
          "args": [
            "out"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__find_global_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "192-202",
          "snippet": "int git_win32__find_global_dirs(git_buf *out)\n{\n\tstatic const wchar_t *global_tmpls[4] = {\n\t\tL\"%HOME%\\\\\",\n\t\tL\"%HOMEDRIVE%%HOMEPATH%\\\\\",\n\t\tL\"%USERPROFILE%\\\\\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, global_tmpls);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nint git_win32__find_global_dirs(git_buf *out)\n{\n\tstatic const wchar_t *global_tmpls[4] = {\n\t\tL\"%HOME%\\\\\",\n\t\tL\"%HOMEDRIVE%%HOMEPATH%\\\\\",\n\t\tL\"%USERPROFILE%\\\\\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, global_tmpls);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_guess_global_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_global_dirs(out);\n#else\n\tint error = git__getenv(out, \"HOME\");\n\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\terror = 0;\n\t}\n\n\treturn error;\n#endif\n}"
  },
  {
    "function_name": "git_sysdir_guess_system_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "28-35",
    "snippet": "static int git_sysdir_guess_system_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_system_dirs(out, L\"etc\\\\\");\n#else\n\treturn git_buf_sets(out, \"/etc\");\n#endif\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_sets",
          "args": [
            "out",
            "\"/etc\""
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "181-184",
          "snippet": "int git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__find_system_dirs",
          "args": [
            "out",
            "L\"etc\\\\\""
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__find_system_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "165-190",
          "snippet": "int git_win32__find_system_dirs(git_buf *out, const wchar_t *subdir)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\n\t/* directories where git.exe & git.cmd are found */\n\tif (!win32_find_git_in_path(&buf, L\"git.exe\", subdir) && buf.size)\n\t\tgit_buf_set(out, buf.ptr, buf.size);\n\telse\n\t\tgit_buf_clear(out);\n\n\tif (!win32_find_git_in_path(&buf, L\"git.cmd\", subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\t/* directories where git is installed according to registry */\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_CURRENT_USER, REG_MSYSGIT_INSTALL_LOCAL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_LOCAL_MACHINE, REG_MSYSGIT_INSTALL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [
            "#define REG_MSYSGIT_INSTALL L\"SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\"",
            "#define REG_MSYSGIT_INSTALL REG_MSYSGIT_INSTALL_LOCAL",
            "#define REG_MSYSGIT_INSTALL_LOCAL L\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\n#define REG_MSYSGIT_INSTALL L\"SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\"\n#define REG_MSYSGIT_INSTALL REG_MSYSGIT_INSTALL_LOCAL\n#define REG_MSYSGIT_INSTALL_LOCAL L\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Git_is1\"\n\nint git_win32__find_system_dirs(git_buf *out, const wchar_t *subdir)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\n\t/* directories where git.exe & git.cmd are found */\n\tif (!win32_find_git_in_path(&buf, L\"git.exe\", subdir) && buf.size)\n\t\tgit_buf_set(out, buf.ptr, buf.size);\n\telse\n\t\tgit_buf_clear(out);\n\n\tif (!win32_find_git_in_path(&buf, L\"git.cmd\", subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\t/* directories where git is installed according to registry */\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_CURRENT_USER, REG_MSYSGIT_INSTALL_LOCAL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tif (!win32_find_git_in_registry(\n\t\t\t&buf, HKEY_LOCAL_MACHINE, REG_MSYSGIT_INSTALL, subdir) && buf.size)\n\t\tgit_buf_join(out, GIT_PATH_LIST_SEPARATOR, out->ptr, buf.ptr);\n\n\tgit_buf_free(&buf);\n\n\treturn (git_buf_oom(out) ? -1 : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_guess_system_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_system_dirs(out, L\"etc\\\\\");\n#else\n\treturn git_buf_sets(out, \"/etc\");\n#endif\n}"
  },
  {
    "function_name": "git_sysdir_guess_programdata_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
    "lines": "18-26",
    "snippet": "static int git_sysdir_guess_programdata_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_programdata_dirs(out);\n#else\n\tgit_buf_clear(out);\n\treturn 0;\n#endif\n}",
    "includes": [
      "#include \"win32/findfile.h\"",
      "#include <ctype.h>",
      "#include \"path.h\"",
      "#include \"buffer.h\"",
      "#include \"global.h\"",
      "#include \"sysdir.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__find_programdata_dirs",
          "args": [
            "out"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__find_programdata_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/findfile.c",
          "lines": "219-227",
          "snippet": "int git_win32__find_programdata_dirs(git_buf *out)\n{\n\tstatic const wchar_t *programdata_tmpls[2] = {\n\t\tL\"%PROGRAMDATA%\\\\Git\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, programdata_tmpls);\n}",
          "includes": [
            "#include \"findfile.h\"",
            "#include \"path.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"findfile.h\"\n#include \"path.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n\nint git_win32__find_programdata_dirs(git_buf *out)\n{\n\tstatic const wchar_t *programdata_tmpls[2] = {\n\t\tL\"%PROGRAMDATA%\\\\Git\",\n\t\tNULL,\n\t};\n\n\treturn win32_find_existing_dirs(out, programdata_tmpls);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic int git_sysdir_guess_programdata_dirs(git_buf *out)\n{\n#ifdef GIT_WIN32\n\treturn git_win32__find_programdata_dirs(out);\n#else\n\tgit_buf_clear(out);\n\treturn 0;\n#endif\n}"
  }
]