[
  {
    "function_name": "git_refdb_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "254-259",
    "snippet": "int git_refdb_unlock(git_refdb *db, void *payload, int success, int update_reflog, const git_reference *ref, const git_signature *sig, const char *message)\n{\n\tassert(db);\n\n\treturn db->backend->unlock(db->backend, payload, success, update_reflog, ref, sig, message);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->backend->unlock",
          "args": [
            "db->backend",
            "payload",
            "success",
            "update_reflog",
            "ref",
            "sig",
            "message"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_unlock(git_refdb *db, void *payload, int success, int update_reflog, const git_reference *ref, const git_signature *sig, const char *message)\n{\n\tassert(db);\n\n\treturn db->backend->unlock(db->backend, payload, success, update_reflog, ref, sig, message);\n}"
  },
  {
    "function_name": "git_refdb_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "242-252",
    "snippet": "int git_refdb_lock(void **payload, git_refdb *db, const char *refname)\n{\n\tassert(payload && db && refname);\n\n\tif (!db->backend->lock) {\n\t\tgiterr_set(GITERR_REFERENCE, \"backend does not support locking\");\n\t\treturn -1;\n\t}\n\n\treturn db->backend->lock(payload, db->backend, refname);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->backend->lock",
          "args": [
            "payload",
            "db->backend",
            "refname"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REFERENCE",
            "\"backend does not support locking\""
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "payload && db && refname"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_lock(void **payload, git_refdb *db, const char *refname)\n{\n\tassert(payload && db && refname);\n\n\tif (!db->backend->lock) {\n\t\tgiterr_set(GITERR_REFERENCE, \"backend does not support locking\");\n\t\treturn -1;\n\t}\n\n\treturn db->backend->lock(payload, db->backend, refname);\n}"
  },
  {
    "function_name": "git_refdb_init_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "235-240",
    "snippet": "int git_refdb_init_backend(git_refdb_backend *backend, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\tbackend, version, git_refdb_backend, GIT_REFDB_BACKEND_INIT);\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_INIT_STRUCTURE_FROM_TEMPLATE",
          "args": [
            "backend",
            "version",
            "git_refdb_backend",
            "GIT_REFDB_BACKEND_INIT"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_init_backend(git_refdb_backend *backend, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\tbackend, version, git_refdb_backend, GIT_REFDB_BACKEND_INIT);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_refdb_ensure_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "228-233",
    "snippet": "int git_refdb_ensure_log(git_refdb *db, const char *refname)\n{\n\tassert(db && refname);\n\n\treturn db->backend->ensure_log(db->backend, refname);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->backend->ensure_log",
          "args": [
            "db->backend",
            "refname"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && refname"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_ensure_log(git_refdb *db, const char *refname)\n{\n\tassert(db && refname);\n\n\treturn db->backend->ensure_log(db->backend, refname);\n}"
  },
  {
    "function_name": "git_refdb_has_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "221-226",
    "snippet": "int git_refdb_has_log(git_refdb *db, const char *refname)\n{\n\tassert(db && refname);\n\n\treturn db->backend->has_log(db->backend, refname);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->backend->has_log",
          "args": [
            "db->backend",
            "refname"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && refname"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_has_log(git_refdb *db, const char *refname)\n{\n\tassert(db && refname);\n\n\treturn db->backend->has_log(db->backend, refname);\n}"
  },
  {
    "function_name": "git_refdb_reflog_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "206-219",
    "snippet": "int git_refdb_reflog_read(git_reflog **out, git_refdb *db,  const char *name)\n{\n\tint error;\n\n\tassert(db && db->backend);\n\n\tif ((error = db->backend->reflog_read(out, db->backend, name)) < 0)\n\t\treturn error;\n\n\tGIT_REFCOUNT_INC(db);\n\t(*out)->db = db;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "db"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db->backend->reflog_read",
          "args": [
            "out",
            "db->backend",
            "name"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && db->backend"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_reflog_read(git_reflog **out, git_refdb *db,  const char *name)\n{\n\tint error;\n\n\tassert(db && db->backend);\n\n\tif ((error = db->backend->reflog_read(out, db->backend, name)) < 0)\n\t\treturn error;\n\n\tGIT_REFCOUNT_INC(db);\n\t(*out)->db = db;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_refdb_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "200-204",
    "snippet": "int git_refdb_delete(struct git_refdb *db, const char *ref_name, const git_oid *old_id, const char *old_target)\n{\n\tassert(db && db->backend);\n\treturn db->backend->del(db->backend, ref_name, old_id, old_target);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->backend->del",
          "args": [
            "db->backend",
            "ref_name",
            "old_id",
            "old_target"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && db->backend"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_delete(struct git_refdb *db, const char *ref_name, const git_oid *old_id, const char *old_target)\n{\n\tassert(db && db->backend);\n\treturn db->backend->del(db->backend, ref_name, old_id, old_target);\n}"
  },
  {
    "function_name": "git_refdb_rename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "176-198",
    "snippet": "int git_refdb_rename(\n\tgit_reference **out,\n\tgit_refdb *db,\n\tconst char *old_name,\n\tconst char *new_name,\n\tint force,\n\tconst git_signature *who,\n\tconst char *message)\n{\n\tint error;\n\n\tassert(db && db->backend);\n\terror = db->backend->rename(out, db->backend, old_name, new_name, force, who, message);\n\tif (error < 0)\n\t\treturn error;\n\n\tif (out) {\n\t\tGIT_REFCOUNT_INC(db);\n\t\t(*out)->db = db;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "db"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db->backend->rename",
          "args": [
            "out",
            "db->backend",
            "old_name",
            "new_name",
            "force",
            "who",
            "message"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && db->backend"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_rename(\n\tgit_reference **out,\n\tgit_refdb *db,\n\tconst char *old_name,\n\tconst char *new_name,\n\tint force,\n\tconst git_signature *who,\n\tconst char *message)\n{\n\tint error;\n\n\tassert(db && db->backend);\n\terror = db->backend->rename(out, db->backend, old_name, new_name, force, who, message);\n\tif (error < 0)\n\t\treturn error;\n\n\tif (out) {\n\t\tGIT_REFCOUNT_INC(db);\n\t\t(*out)->db = db;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_refdb_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "166-174",
    "snippet": "int git_refdb_write(git_refdb *db, git_reference *ref, int force, const git_signature *who, const char *message, const git_oid *old_id, const char *old_target)\n{\n\tassert(db && db->backend);\n\n\tGIT_REFCOUNT_INC(db);\n\tref->db = db;\n\n\treturn db->backend->write(db->backend, ref, force, who, message, old_id, old_target);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->backend->write",
          "args": [
            "db->backend",
            "ref",
            "force",
            "who",
            "message",
            "old_id",
            "old_target"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "db"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && db->backend"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_write(git_refdb *db, git_reference *ref, int force, const git_signature *who, const char *message, const git_oid *old_id, const char *old_target)\n{\n\tassert(db && db->backend);\n\n\tGIT_REFCOUNT_INC(db);\n\tref->db = db;\n\n\treturn db->backend->write(db->backend, ref, force, who, message, old_id, old_target);\n}"
  },
  {
    "function_name": "git_refdb_iterator_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "160-164",
    "snippet": "void git_refdb_iterator_free(git_reference_iterator *iter)\n{\n\tGIT_REFCOUNT_DEC(iter->db, git_refdb__free);\n\titer->free(iter);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->free",
          "args": [
            "iter"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_DEC",
          "args": [
            "iter->db",
            "git_refdb__free"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid git_refdb_iterator_free(git_reference_iterator *iter)\n{\n\tGIT_REFCOUNT_DEC(iter->db, git_refdb__free);\n\titer->free(iter);\n}"
  },
  {
    "function_name": "git_refdb_iterator_next_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "155-158",
    "snippet": "int git_refdb_iterator_next_name(const char **out, git_reference_iterator *iter)\n{\n\treturn iter->next_name(out, iter);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->next_name",
          "args": [
            "out",
            "iter"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_iterator_next_name(const char **out, git_reference_iterator *iter)\n{\n\treturn iter->next_name(out, iter);\n}"
  },
  {
    "function_name": "git_refdb_iterator_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "142-153",
    "snippet": "int git_refdb_iterator_next(git_reference **out, git_reference_iterator *iter)\n{\n\tint error;\n\n\tif ((error = iter->next(out, iter)) < 0)\n\t\treturn error;\n\n\tGIT_REFCOUNT_INC(iter->db);\n\t(*out)->db = iter->db;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "iter->db"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->next",
          "args": [
            "out",
            "iter"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_iterator_next(git_reference **out, git_reference_iterator *iter)\n{\n\tint error;\n\n\tif ((error = iter->next(out, iter)) < 0)\n\t\treturn error;\n\n\tGIT_REFCOUNT_INC(iter->db);\n\t(*out)->db = iter->db;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_refdb_iterator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "126-140",
    "snippet": "int git_refdb_iterator(git_reference_iterator **out, git_refdb *db, const char *glob)\n{\n\tif (!db->backend || !db->backend->iterator) {\n\t\tgiterr_set(GITERR_REFERENCE, \"This backend doesn't support iterators\");\n\t\treturn -1;\n\t}\n\n\tif (db->backend->iterator(out, db->backend, glob) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(db);\n\t(*out)->db = db;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "db"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db->backend->iterator",
          "args": [
            "out",
            "db->backend",
            "glob"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REFERENCE",
            "\"This backend doesn't support iterators\""
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_iterator(git_reference_iterator **out, git_refdb *db, const char *glob)\n{\n\tif (!db->backend || !db->backend->iterator) {\n\t\tgiterr_set(GITERR_REFERENCE, \"This backend doesn't support iterators\");\n\t\treturn -1;\n\t}\n\n\tif (db->backend->iterator(out, db->backend, glob) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(db);\n\t(*out)->db = db;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_refdb_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "108-124",
    "snippet": "int git_refdb_lookup(git_reference **out, git_refdb *db, const char *ref_name)\n{\n\tgit_reference *ref;\n\tint error;\n\n\tassert(db && db->backend && out && ref_name);\n\n\terror = db->backend->lookup(&ref, db->backend, ref_name);\n\tif (error < 0)\n\t\treturn error;\n\n\tGIT_REFCOUNT_INC(db);\n\tref->db = db;\n\n\t*out = ref;\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "db"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db->backend->lookup",
          "args": [
            "&ref",
            "db->backend",
            "ref_name"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db && db->backend && out && ref_name"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_lookup(git_reference **out, git_refdb *db, const char *ref_name)\n{\n\tgit_reference *ref;\n\tint error;\n\n\tassert(db && db->backend && out && ref_name);\n\n\terror = db->backend->lookup(&ref, db->backend, ref_name);\n\tif (error < 0)\n\t\treturn error;\n\n\tGIT_REFCOUNT_INC(db);\n\tref->db = db;\n\n\t*out = ref;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_refdb_exists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "101-106",
    "snippet": "int git_refdb_exists(int *exists, git_refdb *refdb, const char *ref_name)\n{\n\tassert(exists && refdb && refdb->backend);\n\n\treturn refdb->backend->exists(exists, refdb->backend, ref_name);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "refdb->backend->exists",
          "args": [
            "exists",
            "refdb->backend",
            "ref_name"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "exists && refdb && refdb->backend"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_exists(int *exists, git_refdb *refdb, const char *ref_name)\n{\n\tassert(exists && refdb && refdb->backend);\n\n\treturn refdb->backend->exists(exists, refdb->backend, ref_name);\n}"
  },
  {
    "function_name": "git_refdb_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "93-99",
    "snippet": "void git_refdb_free(git_refdb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, git_refdb__free);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_DEC",
          "args": [
            "db",
            "git_refdb__free"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid git_refdb_free(git_refdb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, git_refdb__free);\n}"
  },
  {
    "function_name": "git_refdb__free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "86-91",
    "snippet": "void git_refdb__free(git_refdb *db)\n{\n\trefdb_free_backend(db);\n\tgit__memzero(db, sizeof(*db));\n\tgit__free(db);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "db"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__memzero",
          "args": [
            "db",
            "sizeof(*db)"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "git__memzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "521-531",
          "snippet": "GIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "refdb_free_backend",
          "args": [
            "db"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "refdb_free_backend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
          "lines": "62-66",
          "snippet": "static void refdb_free_backend(git_refdb *db)\n{\n\tif (db->backend)\n\t\tdb->backend->free(db->backend);\n}",
          "includes": [
            "#include \"reflog.h\"",
            "#include \"refs.h\"",
            "#include \"refdb.h\"",
            "#include \"hash.h\"",
            "#include \"git2/sys/refdb_backend.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/object.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic void refdb_free_backend(git_refdb *db)\n{\n\tif (db->backend)\n\t\tdb->backend->free(db->backend);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid git_refdb__free(git_refdb *db)\n{\n\trefdb_free_backend(db);\n\tgit__memzero(db, sizeof(*db));\n\tgit__free(db);\n}"
  },
  {
    "function_name": "git_refdb_compress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "76-84",
    "snippet": "int git_refdb_compress(git_refdb *db)\n{\n\tassert(db);\n\n\tif (db->backend->compress)\n\t\treturn db->backend->compress(db->backend);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->backend->compress",
          "args": [
            "db->backend"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "db"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_compress(git_refdb *db)\n{\n\tassert(db);\n\n\tif (db->backend->compress)\n\t\treturn db->backend->compress(db->backend);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_refdb_set_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "68-74",
    "snippet": "int git_refdb_set_backend(git_refdb *db, git_refdb_backend *backend)\n{\n\trefdb_free_backend(db);\n\tdb->backend = backend;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "refdb_free_backend",
          "args": [
            "db"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "refdb_free_backend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
          "lines": "62-66",
          "snippet": "static void refdb_free_backend(git_refdb *db)\n{\n\tif (db->backend)\n\t\tdb->backend->free(db->backend);\n}",
          "includes": [
            "#include \"reflog.h\"",
            "#include \"refs.h\"",
            "#include \"refdb.h\"",
            "#include \"hash.h\"",
            "#include \"git2/sys/refdb_backend.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/object.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic void refdb_free_backend(git_refdb *db)\n{\n\tif (db->backend)\n\t\tdb->backend->free(db->backend);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_set_backend(git_refdb *db, git_refdb_backend *backend)\n{\n\trefdb_free_backend(db);\n\tdb->backend = backend;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "refdb_free_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "62-66",
    "snippet": "static void refdb_free_backend(git_refdb *db)\n{\n\tif (db->backend)\n\t\tdb->backend->free(db->backend);\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->backend->free",
          "args": [
            "db->backend"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nstatic void refdb_free_backend(git_refdb *db)\n{\n\tif (db->backend)\n\t\tdb->backend->free(db->backend);\n}"
  },
  {
    "function_name": "git_refdb_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "37-60",
    "snippet": "int git_refdb_open(git_refdb **out, git_repository *repo)\n{\n\tgit_refdb *db;\n\tgit_refdb_backend *dir;\n\n\tassert(out && repo);\n\n\t*out = NULL;\n\n\tif (git_refdb_new(&db, repo) < 0)\n\t\treturn -1;\n\n\t/* Add the default (filesystem) backend */\n\tif (git_refdb_backend_fs(&dir, repo) < 0) {\n\t\tgit_refdb_free(db);\n\t\treturn -1;\n\t}\n\n\tdb->repo = repo;\n\tdb->backend = dir;\n\n\t*out = db;\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_refdb_free",
          "args": [
            "db"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "git_refdb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
          "lines": "93-99",
          "snippet": "void git_refdb_free(git_refdb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, git_refdb__free);\n}",
          "includes": [
            "#include \"reflog.h\"",
            "#include \"refs.h\"",
            "#include \"refdb.h\"",
            "#include \"hash.h\"",
            "#include \"git2/sys/refdb_backend.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/object.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid git_refdb_free(git_refdb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, git_refdb__free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_refdb_backend_fs",
          "args": [
            "&dir",
            "repo"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "git_refdb_backend_fs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb_fs.c",
          "lines": "1918-1978",
          "snippet": "int git_refdb_backend_fs(\n\tgit_refdb_backend **backend_out,\n\tgit_repository *repository)\n{\n\tint t = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\trefdb_fs_backend *backend;\n\n\tbackend = git__calloc(1, sizeof(refdb_fs_backend));\n\tGITERR_CHECK_ALLOC(backend);\n\n\tbackend->repo = repository;\n\n\tif (setup_namespace(&path, repository) < 0)\n\t\tgoto fail;\n\n\tbackend->path = git_buf_detach(&path);\n\n\tif (git_buf_joinpath(&path, backend->path, GIT_PACKEDREFS_FILE) < 0 ||\n\t\tgit_sortedcache_new(\n\t\t\t&backend->refcache, offsetof(struct packref, name),\n\t\t\tNULL, NULL, packref_cmp, git_buf_cstr(&path)) < 0)\n\t\tgoto fail;\n\n\tgit_buf_free(&path);\n\n\tif (!git_repository__cvar(&t, backend->repo, GIT_CVAR_IGNORECASE) && t) {\n\t\tbackend->iterator_flags |= GIT_ITERATOR_IGNORE_CASE;\n\t\tbackend->direach_flags  |= GIT_PATH_DIR_IGNORE_CASE;\n\t}\n\tif (!git_repository__cvar(&t, backend->repo, GIT_CVAR_PRECOMPOSE) && t) {\n\t\tbackend->iterator_flags |= GIT_ITERATOR_PRECOMPOSE_UNICODE;\n\t\tbackend->direach_flags  |= GIT_PATH_DIR_PRECOMPOSE_UNICODE;\n\t}\n\n\tbackend->parent.exists = &refdb_fs_backend__exists;\n\tbackend->parent.lookup = &refdb_fs_backend__lookup;\n\tbackend->parent.iterator = &refdb_fs_backend__iterator;\n\tbackend->parent.write = &refdb_fs_backend__write;\n\tbackend->parent.del = &refdb_fs_backend__delete;\n\tbackend->parent.rename = &refdb_fs_backend__rename;\n\tbackend->parent.compress = &refdb_fs_backend__compress;\n\tbackend->parent.lock = &refdb_fs_backend__lock;\n\tbackend->parent.unlock = &refdb_fs_backend__unlock;\n\tbackend->parent.has_log = &refdb_reflog_fs__has_log;\n\tbackend->parent.ensure_log = &refdb_reflog_fs__ensure_log;\n\tbackend->parent.free = &refdb_fs_backend__free;\n\tbackend->parent.reflog_read = &refdb_reflog_fs__read;\n\tbackend->parent.reflog_write = &refdb_reflog_fs__write;\n\tbackend->parent.reflog_rename = &refdb_reflog_fs__rename;\n\tbackend->parent.reflog_delete = &refdb_reflog_fs__delete;\n\n\t*backend_out = (git_refdb_backend *)backend;\n\treturn 0;\n\nfail:\n\tgit_buf_free(&path);\n\tgit__free(backend->path);\n\tgit__free(backend);\n\treturn -1;\n}",
          "includes": [
            "#include <git2/sys/reflog.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/sys/refdb_backend.h>",
            "#include <git2/branch.h>",
            "#include <git2/refdb.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"signature.h\"",
            "#include \"sortedcache.h\"",
            "#include \"iterator.h\"",
            "#include \"refdb_fs.h\"",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int refdb_reflog_fs__delete(git_refdb_backend *_backend, const char *name);",
            "static int has_reflog(git_repository *repo, const char *name);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <git2/sys/reflog.h>\n#include <git2/sys/refs.h>\n#include <git2/sys/refdb_backend.h>\n#include <git2/branch.h>\n#include <git2/refdb.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"signature.h\"\n#include \"sortedcache.h\"\n#include \"iterator.h\"\n#include \"refdb_fs.h\"\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nstatic int refdb_reflog_fs__delete(git_refdb_backend *_backend, const char *name);\nstatic int has_reflog(git_repository *repo, const char *name);\n\nint git_refdb_backend_fs(\n\tgit_refdb_backend **backend_out,\n\tgit_repository *repository)\n{\n\tint t = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\trefdb_fs_backend *backend;\n\n\tbackend = git__calloc(1, sizeof(refdb_fs_backend));\n\tGITERR_CHECK_ALLOC(backend);\n\n\tbackend->repo = repository;\n\n\tif (setup_namespace(&path, repository) < 0)\n\t\tgoto fail;\n\n\tbackend->path = git_buf_detach(&path);\n\n\tif (git_buf_joinpath(&path, backend->path, GIT_PACKEDREFS_FILE) < 0 ||\n\t\tgit_sortedcache_new(\n\t\t\t&backend->refcache, offsetof(struct packref, name),\n\t\t\tNULL, NULL, packref_cmp, git_buf_cstr(&path)) < 0)\n\t\tgoto fail;\n\n\tgit_buf_free(&path);\n\n\tif (!git_repository__cvar(&t, backend->repo, GIT_CVAR_IGNORECASE) && t) {\n\t\tbackend->iterator_flags |= GIT_ITERATOR_IGNORE_CASE;\n\t\tbackend->direach_flags  |= GIT_PATH_DIR_IGNORE_CASE;\n\t}\n\tif (!git_repository__cvar(&t, backend->repo, GIT_CVAR_PRECOMPOSE) && t) {\n\t\tbackend->iterator_flags |= GIT_ITERATOR_PRECOMPOSE_UNICODE;\n\t\tbackend->direach_flags  |= GIT_PATH_DIR_PRECOMPOSE_UNICODE;\n\t}\n\n\tbackend->parent.exists = &refdb_fs_backend__exists;\n\tbackend->parent.lookup = &refdb_fs_backend__lookup;\n\tbackend->parent.iterator = &refdb_fs_backend__iterator;\n\tbackend->parent.write = &refdb_fs_backend__write;\n\tbackend->parent.del = &refdb_fs_backend__delete;\n\tbackend->parent.rename = &refdb_fs_backend__rename;\n\tbackend->parent.compress = &refdb_fs_backend__compress;\n\tbackend->parent.lock = &refdb_fs_backend__lock;\n\tbackend->parent.unlock = &refdb_fs_backend__unlock;\n\tbackend->parent.has_log = &refdb_reflog_fs__has_log;\n\tbackend->parent.ensure_log = &refdb_reflog_fs__ensure_log;\n\tbackend->parent.free = &refdb_fs_backend__free;\n\tbackend->parent.reflog_read = &refdb_reflog_fs__read;\n\tbackend->parent.reflog_write = &refdb_reflog_fs__write;\n\tbackend->parent.reflog_rename = &refdb_reflog_fs__rename;\n\tbackend->parent.reflog_delete = &refdb_reflog_fs__delete;\n\n\t*backend_out = (git_refdb_backend *)backend;\n\treturn 0;\n\nfail:\n\tgit_buf_free(&path);\n\tgit__free(backend->path);\n\tgit__free(backend);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_refdb_new",
          "args": [
            "&db",
            "repo"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "git_refdb_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
          "lines": "21-35",
          "snippet": "int git_refdb_new(git_refdb **out, git_repository *repo)\n{\n\tgit_refdb *db;\n\n\tassert(out && repo);\n\n\tdb = git__calloc(1, sizeof(*db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tdb->repo = repo;\n\n\t*out = db;\n\tGIT_REFCOUNT_INC(db);\n\treturn 0;\n}",
          "includes": [
            "#include \"reflog.h\"",
            "#include \"refs.h\"",
            "#include \"refdb.h\"",
            "#include \"hash.h\"",
            "#include \"git2/sys/refdb_backend.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/object.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_new(git_refdb **out, git_repository *repo)\n{\n\tgit_refdb *db;\n\n\tassert(out && repo);\n\n\tdb = git__calloc(1, sizeof(*db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tdb->repo = repo;\n\n\t*out = db;\n\tGIT_REFCOUNT_INC(db);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_open(git_refdb **out, git_repository *repo)\n{\n\tgit_refdb *db;\n\tgit_refdb_backend *dir;\n\n\tassert(out && repo);\n\n\t*out = NULL;\n\n\tif (git_refdb_new(&db, repo) < 0)\n\t\treturn -1;\n\n\t/* Add the default (filesystem) backend */\n\tif (git_refdb_backend_fs(&dir, repo) < 0) {\n\t\tgit_refdb_free(db);\n\t\treturn -1;\n\t}\n\n\tdb->repo = repo;\n\tdb->backend = dir;\n\n\t*out = db;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_refdb_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
    "lines": "21-35",
    "snippet": "int git_refdb_new(git_refdb **out, git_repository *repo)\n{\n\tgit_refdb *db;\n\n\tassert(out && repo);\n\n\tdb = git__calloc(1, sizeof(*db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tdb->repo = repo;\n\n\t*out = db;\n\tGIT_REFCOUNT_INC(db);\n\treturn 0;\n}",
    "includes": [
      "#include \"reflog.h\"",
      "#include \"refs.h\"",
      "#include \"refdb.h\"",
      "#include \"hash.h\"",
      "#include \"git2/sys/refdb_backend.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/refs.h\"",
      "#include \"git2/object.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "db"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "db"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(*db)"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_new(git_refdb **out, git_repository *repo)\n{\n\tgit_refdb *db;\n\n\tassert(out && repo);\n\n\tdb = git__calloc(1, sizeof(*db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tdb->repo = repo;\n\n\t*out = db;\n\tGIT_REFCOUNT_INC(db);\n\treturn 0;\n}"
  }
]