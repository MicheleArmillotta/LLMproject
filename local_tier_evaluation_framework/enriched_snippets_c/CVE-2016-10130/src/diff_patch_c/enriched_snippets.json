[
  {
    "function_name": "diff_output_to_patch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "1132-1142",
    "snippet": "static void diff_output_to_patch(git_diff_output *out, git_patch *patch)\n{\n\tdiff_output_init(\n\t\tout,\n\t\tNULL,\n\t\tdiff_patch_file_cb,\n\t\tdiff_patch_binary_cb,\n\t\tdiff_patch_hunk_cb,\n\t\tdiff_patch_line_cb,\n\t\tpatch);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_output_init",
          "args": [
            "out",
            "NULL",
            "diff_patch_file_cb",
            "diff_patch_binary_cb",
            "diff_patch_hunk_cb",
            "diff_patch_line_cb",
            "patch"
          ],
          "line": 1134
        },
        "resolved": true,
        "details": {
          "function_name": "diff_output_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "1112-1130",
          "snippet": "static void diff_output_init(\n\tgit_diff_output *out,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tGIT_UNUSED(opts);\n\n\tmemset(out, 0, sizeof(*out));\n\n\tout->file_cb = file_cb;\n\tout->binary_cb = binary_cb;\n\tout->hunk_cb = hunk_cb;\n\tout->data_cb = data_cb;\n\tout->payload = payload;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nstatic void diff_output_init(\n\tgit_diff_output *out,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tGIT_UNUSED(opts);\n\n\tmemset(out, 0, sizeof(*out));\n\n\tout->file_cb = file_cb;\n\tout->binary_cb = binary_cb;\n\tout->hunk_cb = hunk_cb;\n\tout->data_cb = data_cb;\n\tout->payload = payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_output_to_patch(git_diff_output *out, git_patch *patch)\n{\n\tdiff_output_init(\n\t\tout,\n\t\tNULL,\n\t\tdiff_patch_file_cb,\n\t\tdiff_patch_binary_cb,\n\t\tdiff_patch_hunk_cb,\n\t\tdiff_patch_line_cb,\n\t\tpatch);\n}"
  },
  {
    "function_name": "diff_output_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "1112-1130",
    "snippet": "static void diff_output_init(\n\tgit_diff_output *out,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tGIT_UNUSED(opts);\n\n\tmemset(out, 0, sizeof(*out));\n\n\tout->file_cb = file_cb;\n\tout->binary_cb = binary_cb;\n\tout->hunk_cb = hunk_cb;\n\tout->data_cb = data_cb;\n\tout->payload = payload;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "out",
            "0",
            "sizeof(*out)"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "opts"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nstatic void diff_output_init(\n\tgit_diff_output *out,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tGIT_UNUSED(opts);\n\n\tmemset(out, 0, sizeof(*out));\n\n\tout->file_cb = file_cb;\n\tout->binary_cb = binary_cb;\n\tout->hunk_cb = hunk_cb;\n\tout->data_cb = data_cb;\n\tout->payload = payload;\n}"
  },
  {
    "function_name": "diff_patch_line_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "1073-1110",
    "snippet": "static int diff_patch_line_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk_,\n\tconst git_diff_line *line_,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\tdiff_patch_hunk *hunk;\n\tgit_diff_line   *line;\n\n\tGIT_UNUSED(delta);\n\tGIT_UNUSED(hunk_);\n\n\thunk = git_array_last(patch->hunks);\n\tassert(hunk); /* programmer error if no hunk is available */\n\n\tline = git_array_alloc(patch->lines);\n\tGITERR_CHECK_ALLOC(line);\n\n\tmemcpy(line, line_, sizeof(*line));\n\n\t/* do some bookkeeping so we can provide old/new line numbers */\n\n\tpatch->content_size += line->content_len;\n\n\tif (line->origin == GIT_DIFF_LINE_ADDITION ||\n\t\tline->origin == GIT_DIFF_LINE_DELETION)\n\t\tpatch->content_size += 1;\n\telse if (line->origin == GIT_DIFF_LINE_CONTEXT) {\n\t\tpatch->content_size += 1;\n\t\tpatch->context_size += line->content_len + 1;\n\t} else if (line->origin == GIT_DIFF_LINE_CONTEXT_EOFNL)\n\t\tpatch->context_size += line->content_len;\n\n\thunk->line_count++;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "line",
            "line_",
            "sizeof(*line)"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "line"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "patch->lines"
          ],
          "line": 1089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "hunk"
          ],
          "line": 1087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_last",
          "args": [
            "patch->hunks"
          ],
          "line": 1086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "hunk_"
          ],
          "line": 1084
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "delta"
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_line_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk_,\n\tconst git_diff_line *line_,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\tdiff_patch_hunk *hunk;\n\tgit_diff_line   *line;\n\n\tGIT_UNUSED(delta);\n\tGIT_UNUSED(hunk_);\n\n\thunk = git_array_last(patch->hunks);\n\tassert(hunk); /* programmer error if no hunk is available */\n\n\tline = git_array_alloc(patch->lines);\n\tGITERR_CHECK_ALLOC(line);\n\n\tmemcpy(line, line_, sizeof(*line));\n\n\t/* do some bookkeeping so we can provide old/new line numbers */\n\n\tpatch->content_size += line->content_len;\n\n\tif (line->origin == GIT_DIFF_LINE_ADDITION ||\n\t\tline->origin == GIT_DIFF_LINE_DELETION)\n\t\tpatch->content_size += 1;\n\telse if (line->origin == GIT_DIFF_LINE_CONTEXT) {\n\t\tpatch->content_size += 1;\n\t\tpatch->context_size += line->content_len + 1;\n\t} else if (line->origin == GIT_DIFF_LINE_CONTEXT_EOFNL)\n\t\tpatch->context_size += line->content_len;\n\n\thunk->line_count++;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "diff_patch_hunk_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "1050-1071",
    "snippet": "static int diff_patch_hunk_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk_,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\tdiff_patch_hunk *hunk;\n\n\tGIT_UNUSED(delta);\n\n\thunk = git_array_alloc(patch->hunks);\n\tGITERR_CHECK_ALLOC(hunk);\n\n\tmemcpy(&hunk->hunk, hunk_, sizeof(hunk->hunk));\n\n\tpatch->header_size += hunk_->header_len;\n\n\thunk->line_start = git_array_size(patch->lines);\n\thunk->line_count = 0;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "patch->lines"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&hunk->hunk",
            "hunk_",
            "sizeof(hunk->hunk)"
          ],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "hunk"
          ],
          "line": 1061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "patch->hunks"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "delta"
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_hunk_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk_,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\tdiff_patch_hunk *hunk;\n\n\tGIT_UNUSED(delta);\n\n\thunk = git_array_alloc(patch->hunks);\n\tGITERR_CHECK_ALLOC(hunk);\n\n\tmemcpy(&hunk->hunk, hunk_, sizeof(hunk->hunk));\n\n\tpatch->header_size += hunk_->header_len;\n\n\thunk->line_start = git_array_size(patch->lines);\n\thunk->line_count = 0;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "diff_patch_binary_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "1020-1048",
    "snippet": "static int diff_patch_binary_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_binary *binary,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\n\tGIT_UNUSED(delta);\n\n\tmemcpy(&patch->binary, binary, sizeof(git_diff_binary));\n\n\tif (binary->old_file.data) {\n\t\tpatch->binary.old_file.data = git__malloc(binary->old_file.datalen);\n\t\tGITERR_CHECK_ALLOC(patch->binary.old_file.data);\n\n\t\tmemcpy((char *)patch->binary.old_file.data,\n\t\t\tbinary->old_file.data, binary->old_file.datalen);\n\t}\n\n\tif (binary->new_file.data) {\n\t\tpatch->binary.new_file.data = git__malloc(binary->new_file.datalen);\n\t\tGITERR_CHECK_ALLOC(patch->binary.new_file.data);\n\n\t\tmemcpy((char *)patch->binary.new_file.data,\n\t\t\tbinary->new_file.data, binary->new_file.datalen);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(char *)patch->binary.new_file.data",
            "binary->new_file.data",
            "binary->new_file.datalen"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "patch->binary.new_file.data"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "binary->new_file.datalen"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(char *)patch->binary.old_file.data",
            "binary->old_file.data",
            "binary->old_file.datalen"
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "patch->binary.old_file.data"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&patch->binary",
            "binary",
            "sizeof(git_diff_binary)"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "delta"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_binary_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_binary *binary,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\n\tGIT_UNUSED(delta);\n\n\tmemcpy(&patch->binary, binary, sizeof(git_diff_binary));\n\n\tif (binary->old_file.data) {\n\t\tpatch->binary.old_file.data = git__malloc(binary->old_file.datalen);\n\t\tGITERR_CHECK_ALLOC(patch->binary.old_file.data);\n\n\t\tmemcpy((char *)patch->binary.old_file.data,\n\t\t\tbinary->old_file.data, binary->old_file.datalen);\n\t}\n\n\tif (binary->new_file.data) {\n\t\tpatch->binary.new_file.data = git__malloc(binary->new_file.datalen);\n\t\tGITERR_CHECK_ALLOC(patch->binary.new_file.data);\n\n\t\tmemcpy((char *)patch->binary.new_file.data,\n\t\t\tbinary->new_file.data, binary->new_file.datalen);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "diff_patch_file_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "1011-1018",
    "snippet": "static int diff_patch_file_cb(\n\tconst git_diff_delta *delta,\n\tfloat progress,\n\tvoid *payload)\n{\n\tGIT_UNUSED(delta); GIT_UNUSED(progress); GIT_UNUSED(payload);\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "payload"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "progress"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "delta"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_file_cb(\n\tconst git_diff_delta *delta,\n\tfloat progress,\n\tvoid *payload)\n{\n\tGIT_UNUSED(delta); GIT_UNUSED(progress); GIT_UNUSED(payload);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_patch__invoke_callbacks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "966-1008",
    "snippet": "int git_patch__invoke_callbacks(\n\tgit_patch *patch,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb line_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tuint32_t i, j;\n\n\tif (file_cb)\n\t\terror = file_cb(patch->delta, 0, payload);\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (binary_cb)\n\t\t\terror = binary_cb(patch->delta, &patch->binary, payload);\n\n\t\treturn error;\n\t}\n\n\tif (!hunk_cb && !line_cb)\n\t\treturn error;\n\n\tfor (i = 0; !error && i < git_array_size(patch->hunks); ++i) {\n\t\tdiff_patch_hunk *h = git_array_get(patch->hunks, i);\n\n\t\tif (hunk_cb)\n\t\t\terror = hunk_cb(patch->delta, &h->hunk, payload);\n\n\t\tif (!line_cb)\n\t\t\tcontinue;\n\n\t\tfor (j = 0; !error && j < h->line_count; ++j) {\n\t\t\tgit_diff_line *l =\n\t\t\t\tgit_array_get(patch->lines, h->line_start + j);\n\n\t\t\terror = line_cb(patch->delta, &h->hunk, l, payload);\n\t\t}\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);",
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "line_cb",
          "args": [
            "patch->delta",
            "&h->hunk",
            "l",
            "payload"
          ],
          "line": 1003
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_line_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "1073-1110",
          "snippet": "static int diff_patch_line_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk_,\n\tconst git_diff_line *line_,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\tdiff_patch_hunk *hunk;\n\tgit_diff_line   *line;\n\n\tGIT_UNUSED(delta);\n\tGIT_UNUSED(hunk_);\n\n\thunk = git_array_last(patch->hunks);\n\tassert(hunk); /* programmer error if no hunk is available */\n\n\tline = git_array_alloc(patch->lines);\n\tGITERR_CHECK_ALLOC(line);\n\n\tmemcpy(line, line_, sizeof(*line));\n\n\t/* do some bookkeeping so we can provide old/new line numbers */\n\n\tpatch->content_size += line->content_len;\n\n\tif (line->origin == GIT_DIFF_LINE_ADDITION ||\n\t\tline->origin == GIT_DIFF_LINE_DELETION)\n\t\tpatch->content_size += 1;\n\telse if (line->origin == GIT_DIFF_LINE_CONTEXT) {\n\t\tpatch->content_size += 1;\n\t\tpatch->context_size += line->content_len + 1;\n\t} else if (line->origin == GIT_DIFF_LINE_CONTEXT_EOFNL)\n\t\tpatch->context_size += line->content_len;\n\n\thunk->line_count++;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_line_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk_,\n\tconst git_diff_line *line_,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\tdiff_patch_hunk *hunk;\n\tgit_diff_line   *line;\n\n\tGIT_UNUSED(delta);\n\tGIT_UNUSED(hunk_);\n\n\thunk = git_array_last(patch->hunks);\n\tassert(hunk); /* programmer error if no hunk is available */\n\n\tline = git_array_alloc(patch->lines);\n\tGITERR_CHECK_ALLOC(line);\n\n\tmemcpy(line, line_, sizeof(*line));\n\n\t/* do some bookkeeping so we can provide old/new line numbers */\n\n\tpatch->content_size += line->content_len;\n\n\tif (line->origin == GIT_DIFF_LINE_ADDITION ||\n\t\tline->origin == GIT_DIFF_LINE_DELETION)\n\t\tpatch->content_size += 1;\n\telse if (line->origin == GIT_DIFF_LINE_CONTEXT) {\n\t\tpatch->content_size += 1;\n\t\tpatch->context_size += line->content_len + 1;\n\t} else if (line->origin == GIT_DIFF_LINE_CONTEXT_EOFNL)\n\t\tpatch->context_size += line->content_len;\n\n\thunk->line_count++;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "patch->lines",
            "h->line_start + j"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hunk_cb",
          "args": [
            "patch->delta",
            "&h->hunk",
            "payload"
          ],
          "line": 994
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_hunk_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "1050-1071",
          "snippet": "static int diff_patch_hunk_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk_,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\tdiff_patch_hunk *hunk;\n\n\tGIT_UNUSED(delta);\n\n\thunk = git_array_alloc(patch->hunks);\n\tGITERR_CHECK_ALLOC(hunk);\n\n\tmemcpy(&hunk->hunk, hunk_, sizeof(hunk->hunk));\n\n\tpatch->header_size += hunk_->header_len;\n\n\thunk->line_start = git_array_size(patch->lines);\n\thunk->line_count = 0;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_hunk_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_hunk *hunk_,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\tdiff_patch_hunk *hunk;\n\n\tGIT_UNUSED(delta);\n\n\thunk = git_array_alloc(patch->hunks);\n\tGITERR_CHECK_ALLOC(hunk);\n\n\tmemcpy(&hunk->hunk, hunk_, sizeof(hunk->hunk));\n\n\tpatch->header_size += hunk_->header_len;\n\n\thunk->line_start = git_array_size(patch->lines);\n\thunk->line_count = 0;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "patch->hunks",
            "i"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "patch->hunks"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "binary_cb",
          "args": [
            "patch->delta",
            "&patch->binary",
            "payload"
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_binary_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "1020-1048",
          "snippet": "static int diff_patch_binary_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_binary *binary,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\n\tGIT_UNUSED(delta);\n\n\tmemcpy(&patch->binary, binary, sizeof(git_diff_binary));\n\n\tif (binary->old_file.data) {\n\t\tpatch->binary.old_file.data = git__malloc(binary->old_file.datalen);\n\t\tGITERR_CHECK_ALLOC(patch->binary.old_file.data);\n\n\t\tmemcpy((char *)patch->binary.old_file.data,\n\t\t\tbinary->old_file.data, binary->old_file.datalen);\n\t}\n\n\tif (binary->new_file.data) {\n\t\tpatch->binary.new_file.data = git__malloc(binary->new_file.datalen);\n\t\tGITERR_CHECK_ALLOC(patch->binary.new_file.data);\n\n\t\tmemcpy((char *)patch->binary.new_file.data,\n\t\t\tbinary->new_file.data, binary->new_file.datalen);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_binary_cb(\n\tconst git_diff_delta *delta,\n\tconst git_diff_binary *binary,\n\tvoid *payload)\n{\n\tgit_patch *patch = payload;\n\n\tGIT_UNUSED(delta);\n\n\tmemcpy(&patch->binary, binary, sizeof(git_diff_binary));\n\n\tif (binary->old_file.data) {\n\t\tpatch->binary.old_file.data = git__malloc(binary->old_file.datalen);\n\t\tGITERR_CHECK_ALLOC(patch->binary.old_file.data);\n\n\t\tmemcpy((char *)patch->binary.old_file.data,\n\t\t\tbinary->old_file.data, binary->old_file.datalen);\n\t}\n\n\tif (binary->new_file.data) {\n\t\tpatch->binary.new_file.data = git__malloc(binary->new_file.datalen);\n\t\tGITERR_CHECK_ALLOC(patch->binary.new_file.data);\n\n\t\tmemcpy((char *)patch->binary.new_file.data,\n\t\t\tbinary->new_file.data, binary->new_file.datalen);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_cb",
          "args": [
            "patch->delta",
            "0",
            "payload"
          ],
          "line": 978
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_file_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "1011-1018",
          "snippet": "static int diff_patch_file_cb(\n\tconst git_diff_delta *delta,\n\tfloat progress,\n\tvoid *payload)\n{\n\tGIT_UNUSED(delta); GIT_UNUSED(progress); GIT_UNUSED(payload);\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_file_cb(\n\tconst git_diff_delta *delta,\n\tfloat progress,\n\tvoid *payload)\n{\n\tGIT_UNUSED(delta); GIT_UNUSED(progress); GIT_UNUSED(payload);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch__invoke_callbacks(\n\tgit_patch *patch,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb line_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tuint32_t i, j;\n\n\tif (file_cb)\n\t\terror = file_cb(patch->delta, 0, payload);\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (binary_cb)\n\t\t\terror = binary_cb(patch->delta, &patch->binary, payload);\n\n\t\treturn error;\n\t}\n\n\tif (!hunk_cb && !line_cb)\n\t\treturn error;\n\n\tfor (i = 0; !error && i < git_array_size(patch->hunks); ++i) {\n\t\tdiff_patch_hunk *h = git_array_get(patch->hunks, i);\n\n\t\tif (hunk_cb)\n\t\t\terror = hunk_cb(patch->delta, &h->hunk, payload);\n\n\t\tif (!line_cb)\n\t\t\tcontinue;\n\n\t\tfor (j = 0; !error && j < h->line_count; ++j) {\n\t\t\tgit_diff_line *l =\n\t\t\t\tgit_array_get(patch->lines, h->line_start + j);\n\n\t\t\terror = line_cb(patch->delta, &h->hunk, l, payload);\n\t\t}\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_patch__new_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "959-964",
    "snippet": "void git_patch__new_data(\n\tchar **ptr, size_t *len, git_patch *patch)\n{\n\t*ptr = patch->nfile.map.data;\n\t*len = patch->nfile.map.len;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch__new_data(\n\tchar **ptr, size_t *len, git_patch *patch)\n{\n\t*ptr = patch->nfile.map.data;\n\t*len = patch->nfile.map.len;\n}"
  },
  {
    "function_name": "git_patch__old_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "952-957",
    "snippet": "void git_patch__old_data(\n\tchar **ptr, size_t *len, git_patch *patch)\n{\n\t*ptr = patch->ofile.map.data;\n\t*len = patch->ofile.map.len;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch__old_data(\n\tchar **ptr, size_t *len, git_patch *patch)\n{\n\t*ptr = patch->ofile.map.data;\n\t*len = patch->ofile.map.len;\n}"
  },
  {
    "function_name": "git_patch__driver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "946-950",
    "snippet": "git_diff_driver *git_patch__driver(git_patch *patch)\n{\n\t/* ofile driver is representative for whole patch */\n\treturn patch->ofile.driver;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\ngit_diff_driver *git_patch__driver(git_patch *patch)\n{\n\t/* ofile driver is representative for whole patch */\n\treturn patch->ofile.driver;\n}"
  },
  {
    "function_name": "git_patch__diff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "941-944",
    "snippet": "git_diff *git_patch__diff(git_patch *patch)\n{\n\treturn patch->diff;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\ngit_diff *git_patch__diff(git_patch *patch)\n{\n\treturn patch->diff;\n}"
  },
  {
    "function_name": "git_patch_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "908-939",
    "snippet": "size_t git_patch_size(\n\tgit_patch *patch,\n\tint include_context,\n\tint include_hunk_headers,\n\tint include_file_headers)\n{\n\tsize_t out;\n\n\tassert(patch);\n\n\tout = patch->content_size;\n\n\tif (!include_context)\n\t\tout -= patch->context_size;\n\n\tif (include_hunk_headers)\n\t\tout += patch->header_size;\n\n\tif (include_file_headers) {\n\t\tgit_buf file_header = GIT_BUF_INIT;\n\n\t\tif (git_diff_delta__format_file_header(\n\t\t\t\t&file_header, patch->delta, NULL, NULL, 0) < 0)\n\t\t\tgiterr_clear();\n\t\telse\n\t\t\tout += git_buf_len(&file_header);\n\n\t\tgit_buf_free(&file_header);\n\t}\n\n\treturn out;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&file_header"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "&file_header"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 931
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_delta__format_file_header",
          "args": [
            "&file_header",
            "patch->delta",
            "NULL",
            "NULL",
            "0"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_delta__format_file_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_print.c",
          "lines": "304-330",
          "snippet": "int git_diff_delta__format_file_header(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tint oid_strlen)\n{\n\tif (!oldpfx)\n\t\toldpfx = DIFF_OLD_PREFIX_DEFAULT;\n\tif (!newpfx)\n\t\tnewpfx = DIFF_NEW_PREFIX_DEFAULT;\n\tif (!oid_strlen)\n\t\toid_strlen = GIT_ABBREV_DEFAULT + 1;\n\n\tgit_buf_clear(out);\n\n\tgit_buf_printf(out, \"diff --git %s%s %s%s\\n\",\n\t\toldpfx, delta->old_file.path, newpfx, delta->new_file.path);\n\n\tGITERR_CHECK_ERROR(diff_print_oid_range(out, delta, oid_strlen));\n\n\tif ((delta->flags & GIT_DIFF_FLAG_BINARY) == 0)\n\t\tdiff_delta_format_with_paths(\n\t\t\tout, delta, oldpfx, newpfx, \"--- %s%s\\n+++ %s%s\\n\");\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}",
          "includes": [
            "#include \"git2/sys/diff.h\"",
            "#include \"delta.h\"",
            "#include \"blob.h\"",
            "#include \"zstream.h\"",
            "#include \"fileops.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/diff.h\"\n#include \"delta.h\"\n#include \"blob.h\"\n#include \"zstream.h\"\n#include \"fileops.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nint git_diff_delta__format_file_header(\n\tgit_buf *out,\n\tconst git_diff_delta *delta,\n\tconst char *oldpfx,\n\tconst char *newpfx,\n\tint oid_strlen)\n{\n\tif (!oldpfx)\n\t\toldpfx = DIFF_OLD_PREFIX_DEFAULT;\n\tif (!newpfx)\n\t\tnewpfx = DIFF_NEW_PREFIX_DEFAULT;\n\tif (!oid_strlen)\n\t\toid_strlen = GIT_ABBREV_DEFAULT + 1;\n\n\tgit_buf_clear(out);\n\n\tgit_buf_printf(out, \"diff --git %s%s %s%s\\n\",\n\t\toldpfx, delta->old_file.path, newpfx, delta->new_file.path);\n\n\tGITERR_CHECK_ERROR(diff_print_oid_range(out, delta, oid_strlen));\n\n\tif ((delta->flags & GIT_DIFF_FLAG_BINARY) == 0)\n\t\tdiff_delta_format_with_paths(\n\t\t\tout, delta, oldpfx, newpfx, \"--- %s%s\\n+++ %s%s\\n\");\n\n\treturn git_buf_oom(out) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "patch"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nsize_t git_patch_size(\n\tgit_patch *patch,\n\tint include_context,\n\tint include_hunk_headers,\n\tint include_file_headers)\n{\n\tsize_t out;\n\n\tassert(patch);\n\n\tout = patch->content_size;\n\n\tif (!include_context)\n\t\tout -= patch->context_size;\n\n\tif (include_hunk_headers)\n\t\tout += patch->header_size;\n\n\tif (include_file_headers) {\n\t\tgit_buf file_header = GIT_BUF_INIT;\n\n\t\tif (git_diff_delta__format_file_header(\n\t\t\t\t&file_header, patch->delta, NULL, NULL, 0) < 0)\n\t\t\tgiterr_clear();\n\t\telse\n\t\t\tout += git_buf_len(&file_header);\n\n\t\tgit_buf_free(&file_header);\n\t}\n\n\treturn out;\n}"
  },
  {
    "function_name": "git_patch_get_line_in_hunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "881-906",
    "snippet": "int git_patch_get_line_in_hunk(\n\tconst git_diff_line **out,\n\tgit_patch *patch,\n\tsize_t hunk_idx,\n\tsize_t line_of_hunk)\n{\n\tdiff_patch_hunk *hunk;\n\tgit_diff_line *line;\n\n\tassert(patch);\n\n\tif (!(hunk = git_array_get(patch->hunks, hunk_idx))) {\n\t\tif (out) *out = NULL;\n\t\treturn diff_error_outofrange(\"hunk\");\n\t}\n\n\tif (line_of_hunk >= hunk->line_count ||\n\t\t!(line = git_array_get(\n\t\t\tpatch->lines, hunk->line_start + line_of_hunk))) {\n\t\tif (out) *out = NULL;\n\t\treturn diff_error_outofrange(\"line\");\n\t}\n\n\tif (out) *out = line;\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_error_outofrange",
          "args": [
            "\"line\""
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "diff_error_outofrange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "843-847",
          "snippet": "static int diff_error_outofrange(const char *thing)\n{\n\tgiterr_set(GITERR_INVALID, \"Diff patch %s index out of range\", thing);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_error_outofrange(const char *thing)\n{\n\tgiterr_set(GITERR_INVALID, \"Diff patch %s index out of range\", thing);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "patch->lines",
            "hunk->line_start + line_of_hunk"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "patch->hunks",
            "hunk_idx"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "patch"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_get_line_in_hunk(\n\tconst git_diff_line **out,\n\tgit_patch *patch,\n\tsize_t hunk_idx,\n\tsize_t line_of_hunk)\n{\n\tdiff_patch_hunk *hunk;\n\tgit_diff_line *line;\n\n\tassert(patch);\n\n\tif (!(hunk = git_array_get(patch->hunks, hunk_idx))) {\n\t\tif (out) *out = NULL;\n\t\treturn diff_error_outofrange(\"hunk\");\n\t}\n\n\tif (line_of_hunk >= hunk->line_count ||\n\t\t!(line = git_array_get(\n\t\t\tpatch->lines, hunk->line_start + line_of_hunk))) {\n\t\tif (out) *out = NULL;\n\t\treturn diff_error_outofrange(\"line\");\n\t}\n\n\tif (out) *out = line;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_patch_num_lines_in_hunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "871-879",
    "snippet": "int git_patch_num_lines_in_hunk(const git_patch *patch, size_t hunk_idx)\n{\n\tdiff_patch_hunk *hunk;\n\tassert(patch);\n\n\tif (!(hunk = git_array_get(patch->hunks, hunk_idx)))\n\t\treturn diff_error_outofrange(\"hunk\");\n\treturn (int)hunk->line_count;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_error_outofrange",
          "args": [
            "\"hunk\""
          ],
          "line": 877
        },
        "resolved": true,
        "details": {
          "function_name": "diff_error_outofrange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "843-847",
          "snippet": "static int diff_error_outofrange(const char *thing)\n{\n\tgiterr_set(GITERR_INVALID, \"Diff patch %s index out of range\", thing);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_error_outofrange(const char *thing)\n{\n\tgiterr_set(GITERR_INVALID, \"Diff patch %s index out of range\", thing);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "patch->hunks",
            "hunk_idx"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "patch"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_num_lines_in_hunk(const git_patch *patch, size_t hunk_idx)\n{\n\tdiff_patch_hunk *hunk;\n\tassert(patch);\n\n\tif (!(hunk = git_array_get(patch->hunks, hunk_idx)))\n\t\treturn diff_error_outofrange(\"hunk\");\n\treturn (int)hunk->line_count;\n}"
  },
  {
    "function_name": "git_patch_get_hunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "849-869",
    "snippet": "int git_patch_get_hunk(\n\tconst git_diff_hunk **out,\n\tsize_t *lines_in_hunk,\n\tgit_patch *patch,\n\tsize_t hunk_idx)\n{\n\tdiff_patch_hunk *hunk;\n\tassert(patch);\n\n\thunk = git_array_get(patch->hunks, hunk_idx);\n\n\tif (!hunk) {\n\t\tif (out) *out = NULL;\n\t\tif (lines_in_hunk) *lines_in_hunk = 0;\n\t\treturn diff_error_outofrange(\"hunk\");\n\t}\n\n\tif (out) *out = &hunk->hunk;\n\tif (lines_in_hunk) *lines_in_hunk = hunk->line_count;\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_error_outofrange",
          "args": [
            "\"hunk\""
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "diff_error_outofrange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "843-847",
          "snippet": "static int diff_error_outofrange(const char *thing)\n{\n\tgiterr_set(GITERR_INVALID, \"Diff patch %s index out of range\", thing);\n\treturn GIT_ENOTFOUND;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_error_outofrange(const char *thing)\n{\n\tgiterr_set(GITERR_INVALID, \"Diff patch %s index out of range\", thing);\n\treturn GIT_ENOTFOUND;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "patch->hunks",
            "hunk_idx"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "patch"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_get_hunk(\n\tconst git_diff_hunk **out,\n\tsize_t *lines_in_hunk,\n\tgit_patch *patch,\n\tsize_t hunk_idx)\n{\n\tdiff_patch_hunk *hunk;\n\tassert(patch);\n\n\thunk = git_array_get(patch->hunks, hunk_idx);\n\n\tif (!hunk) {\n\t\tif (out) *out = NULL;\n\t\tif (lines_in_hunk) *lines_in_hunk = 0;\n\t\treturn diff_error_outofrange(\"hunk\");\n\t}\n\n\tif (out) *out = &hunk->hunk;\n\tif (lines_in_hunk) *lines_in_hunk = hunk->line_count;\n\treturn 0;\n}"
  },
  {
    "function_name": "diff_error_outofrange",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "843-847",
    "snippet": "static int diff_error_outofrange(const char *thing)\n{\n\tgiterr_set(GITERR_INVALID, \"Diff patch %s index out of range\", thing);\n\treturn GIT_ENOTFOUND;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Diff patch %s index out of range\"",
            "thing"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_error_outofrange(const char *thing)\n{\n\tgiterr_set(GITERR_INVALID, \"Diff patch %s index out of range\", thing);\n\treturn GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git_patch_line_stats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "806-841",
    "snippet": "int git_patch_line_stats(\n\tsize_t *total_ctxt,\n\tsize_t *total_adds,\n\tsize_t *total_dels,\n\tconst git_patch *patch)\n{\n\tsize_t totals[3], idx;\n\n\tmemset(totals, 0, sizeof(totals));\n\n\tfor (idx = 0; idx < git_array_size(patch->lines); ++idx) {\n\t\tgit_diff_line *line = git_array_get(patch->lines, idx);\n\t\tif (!line)\n\t\t\tcontinue;\n\n\t\tswitch (line->origin) {\n\t\tcase GIT_DIFF_LINE_CONTEXT:  totals[0]++; break;\n\t\tcase GIT_DIFF_LINE_ADDITION: totals[1]++; break;\n\t\tcase GIT_DIFF_LINE_DELETION: totals[2]++; break;\n\t\tdefault:\n\t\t\t/* diff --stat and --numstat don't count EOFNL marks because\n\t\t\t * they will always be paired with a ADDITION or DELETION line.\n\t\t\t */\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (total_ctxt)\n\t\t*total_ctxt = totals[0];\n\tif (total_adds)\n\t\t*total_adds = totals[1];\n\tif (total_dels)\n\t\t*total_dels = totals[2];\n\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "patch->lines",
            "idx"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "patch->lines"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "totals",
            "0",
            "sizeof(totals)"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_line_stats(\n\tsize_t *total_ctxt,\n\tsize_t *total_adds,\n\tsize_t *total_dels,\n\tconst git_patch *patch)\n{\n\tsize_t totals[3], idx;\n\n\tmemset(totals, 0, sizeof(totals));\n\n\tfor (idx = 0; idx < git_array_size(patch->lines); ++idx) {\n\t\tgit_diff_line *line = git_array_get(patch->lines, idx);\n\t\tif (!line)\n\t\t\tcontinue;\n\n\t\tswitch (line->origin) {\n\t\tcase GIT_DIFF_LINE_CONTEXT:  totals[0]++; break;\n\t\tcase GIT_DIFF_LINE_ADDITION: totals[1]++; break;\n\t\tcase GIT_DIFF_LINE_DELETION: totals[2]++; break;\n\t\tdefault:\n\t\t\t/* diff --stat and --numstat don't count EOFNL marks because\n\t\t\t * they will always be paired with a ADDITION or DELETION line.\n\t\t\t */\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (total_ctxt)\n\t\t*total_ctxt = totals[0];\n\tif (total_adds)\n\t\t*total_adds = totals[1];\n\tif (total_dels)\n\t\t*total_dels = totals[2];\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_patch_num_hunks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "800-804",
    "snippet": "size_t git_patch_num_hunks(const git_patch *patch)\n{\n\tassert(patch);\n\treturn git_array_size(patch->hunks);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_array_size",
          "args": [
            "patch->hunks"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "patch"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nsize_t git_patch_num_hunks(const git_patch *patch)\n{\n\tassert(patch);\n\treturn git_array_size(patch->hunks);\n}"
  },
  {
    "function_name": "git_patch_get_delta",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "794-798",
    "snippet": "const git_diff_delta *git_patch_get_delta(const git_patch *patch)\n{\n\tassert(patch);\n\treturn patch->delta;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "patch"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nconst git_diff_delta *git_patch_get_delta(const git_patch *patch)\n{\n\tassert(patch);\n\treturn patch->delta;\n}"
  },
  {
    "function_name": "git_patch_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "788-792",
    "snippet": "void git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_DEC",
          "args": [
            "patch",
            "diff_patch_free"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}"
  },
  {
    "function_name": "git_patch_from_diff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "735-786",
    "snippet": "int git_patch_from_diff(\n\tgit_patch **patch_ptr, git_diff *diff, size_t idx)\n{\n\tint error = 0;\n\tgit_xdiff_output xo;\n\tgit_diff_delta *delta = NULL;\n\tgit_patch *patch = NULL;\n\n\tif (patch_ptr) *patch_ptr = NULL;\n\n\tif (diff_required(diff, \"git_patch_from_diff\") < 0)\n\t\treturn -1;\n\n\tdelta = git_vector_get(&diff->deltas, idx);\n\tif (!delta) {\n\t\tgiterr_set(GITERR_INVALID, \"Index out of range for delta in diff\");\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (git_diff_delta__should_skip(&diff->opts, delta))\n\t\treturn 0;\n\n\t/* don't load the patch data unless we need it for binary check */\n\tif (!patch_ptr &&\n\t\t((delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0 ||\n\t\t (diff->opts.flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0))\n\t\treturn 0;\n\n\tif ((error = diff_patch_alloc_from_diff(&patch, diff, idx)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, patch);\n\tgit_xdiff_init(&xo, &diff->opts);\n\n\terror = diff_patch_invoke_file_callback(patch, &xo.output);\n\n\tif (!error)\n\t\terror = diff_patch_generate(patch, &xo.output);\n\n\tif (!error) {\n\t\t/* TODO: if cumulative diff size is < 0.5 total size, flatten patch */\n\t\t/* TODO: and unload the file content */\n\t}\n\n\tif (error || !patch_ptr)\n\t\tgit_patch_free(patch);\n\telse\n\t\t*patch_ptr = patch;\n\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_patch_free",
          "args": [
            "patch"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "788-792",
          "snippet": "void git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_generate",
          "args": [
            "patch",
            "&xo.output"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_generate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "342-371",
          "snippet": "static int diff_patch_generate(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFED) != 0)\n\t\treturn 0;\n\n\t/* if we are not looking at the binary or text data, don't do the diff */\n\tif (!output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) == 0 &&\n\t\t(error = diff_patch_load(patch, output)) < 0)\n\t\treturn error;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFABLE) == 0)\n\t\treturn 0;\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (output->binary_cb)\n\t\t\terror = diff_binary(output, patch);\n\t}\n\telse {\n\t\tif (output->diff_cb)\n\t\t\terror = output->diff_cb(output, patch);\n\t}\n\n\tpatch->flags |= GIT_DIFF_PATCH_DIFFED;\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_generate(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFED) != 0)\n\t\treturn 0;\n\n\t/* if we are not looking at the binary or text data, don't do the diff */\n\tif (!output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) == 0 &&\n\t\t(error = diff_patch_load(patch, output)) < 0)\n\t\treturn error;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFABLE) == 0)\n\t\treturn 0;\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (output->binary_cb)\n\t\t\terror = diff_binary(output, patch);\n\t}\n\telse {\n\t\tif (output->diff_cb)\n\t\t\terror = output->diff_cb(output, patch);\n\t}\n\n\tpatch->flags |= GIT_DIFF_PATCH_DIFFED;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_invoke_file_callback",
          "args": [
            "patch",
            "&xo.output"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_invoke_file_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "231-243",
          "snippet": "static int diff_patch_invoke_file_callback(\n\tgit_patch *patch, git_diff_output *output)\n{\n\tfloat progress = patch->diff ?\n\t\t((float)patch->delta_index / patch->diff->deltas.length) : 1.0f;\n\n\tif (!output->file_cb)\n\t\treturn 0;\n\n\treturn giterr_set_after_callback_function(\n\t\toutput->file_cb(patch->delta, progress, output->payload),\n\t\t\"git_patch\");\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_invoke_file_callback(\n\tgit_patch *patch, git_diff_output *output)\n{\n\tfloat progress = patch->diff ?\n\t\t((float)patch->delta_index / patch->diff->deltas.length) : 1.0f;\n\n\tif (!output->file_cb)\n\t\treturn 0;\n\n\treturn giterr_set_after_callback_function(\n\t\toutput->file_cb(patch->delta, progress, output->payload),\n\t\t\"git_patch\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_xdiff_init",
          "args": [
            "&xo",
            "&diff->opts"
          ],
          "line": 768
        },
        "resolved": true,
        "details": {
          "function_name": "git_xdiff_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
          "lines": "226-248",
          "snippet": "void git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nvoid git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_output_to_patch",
          "args": [
            "&xo.output",
            "patch"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "diff_output_to_patch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "1132-1142",
          "snippet": "static void diff_output_to_patch(git_diff_output *out, git_patch *patch)\n{\n\tdiff_output_init(\n\t\tout,\n\t\tNULL,\n\t\tdiff_patch_file_cb,\n\t\tdiff_patch_binary_cb,\n\t\tdiff_patch_hunk_cb,\n\t\tdiff_patch_line_cb,\n\t\tpatch);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_output_to_patch(git_diff_output *out, git_patch *patch)\n{\n\tdiff_output_init(\n\t\tout,\n\t\tNULL,\n\t\tdiff_patch_file_cb,\n\t\tdiff_patch_binary_cb,\n\t\tdiff_patch_hunk_cb,\n\t\tdiff_patch_line_cb,\n\t\tpatch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&xo",
            "0",
            "sizeof(xo)"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diff_patch_alloc_from_diff",
          "args": [
            "&patch",
            "diff",
            "idx"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_alloc_from_diff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "101-118",
          "snippet": "static int diff_patch_alloc_from_diff(\n\tgit_patch **out, git_diff *diff, size_t delta_index)\n{\n\tint error;\n\tgit_patch *patch = git__calloc(1, sizeof(git_patch));\n\tGITERR_CHECK_ALLOC(patch);\n\n\tif (!(error = diff_patch_init_from_diff(patch, diff, delta_index))) {\n\t\tpatch->flags |= GIT_DIFF_PATCH_ALLOCATED;\n\t\tGIT_REFCOUNT_INC(patch);\n\t} else {\n\t\tgit__free(patch);\n\t\tpatch = NULL;\n\t}\n\n\t*out = patch;\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_alloc_from_diff(\n\tgit_patch **out, git_diff *diff, size_t delta_index)\n{\n\tint error;\n\tgit_patch *patch = git__calloc(1, sizeof(git_patch));\n\tGITERR_CHECK_ALLOC(patch);\n\n\tif (!(error = diff_patch_init_from_diff(patch, diff, delta_index))) {\n\t\tpatch->flags |= GIT_DIFF_PATCH_ALLOCATED;\n\t\tGIT_REFCOUNT_INC(patch);\n\t} else {\n\t\tgit__free(patch);\n\t\tpatch = NULL;\n\t}\n\n\t*out = patch;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_delta__should_skip",
          "args": [
            "&diff->opts",
            "delta"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_delta__should_skip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "328-350",
          "snippet": "bool git_diff_delta__should_skip(\n\tconst git_diff_options *opts, const git_diff_delta *delta)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\tif (delta->status == GIT_DELTA_UNMODIFIED &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNMODIFIED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_IGNORED &&\n\t\t(flags & GIT_DIFF_INCLUDE_IGNORED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_UNTRACKED &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNTRACKED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_UNREADABLE &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNREADABLE) == 0)\n\t\treturn true;\n\n\treturn false;\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nbool git_diff_delta__should_skip(\n\tconst git_diff_options *opts, const git_diff_delta *delta)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\tif (delta->status == GIT_DELTA_UNMODIFIED &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNMODIFIED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_IGNORED &&\n\t\t(flags & GIT_DIFF_INCLUDE_IGNORED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_UNTRACKED &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNTRACKED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_UNREADABLE &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNREADABLE) == 0)\n\t\treturn true;\n\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Index out of range for delta in diff\""
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&diff->deltas",
            "idx"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_required",
          "args": [
            "diff",
            "\"git_patch_from_diff\""
          ],
          "line": 745
        },
        "resolved": true,
        "details": {
          "function_name": "diff_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "396-402",
          "snippet": "static int diff_required(git_diff *diff, const char *action)\n{\n\tif (diff)\n\t\treturn 0;\n\tgiterr_set(GITERR_INVALID, \"Must provide valid diff to %s\", action);\n\treturn -1;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_required(git_diff *diff, const char *action)\n{\n\tif (diff)\n\t\treturn 0;\n\tgiterr_set(GITERR_INVALID, \"Must provide valid diff to %s\", action);\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_from_diff(\n\tgit_patch **patch_ptr, git_diff *diff, size_t idx)\n{\n\tint error = 0;\n\tgit_xdiff_output xo;\n\tgit_diff_delta *delta = NULL;\n\tgit_patch *patch = NULL;\n\n\tif (patch_ptr) *patch_ptr = NULL;\n\n\tif (diff_required(diff, \"git_patch_from_diff\") < 0)\n\t\treturn -1;\n\n\tdelta = git_vector_get(&diff->deltas, idx);\n\tif (!delta) {\n\t\tgiterr_set(GITERR_INVALID, \"Index out of range for delta in diff\");\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (git_diff_delta__should_skip(&diff->opts, delta))\n\t\treturn 0;\n\n\t/* don't load the patch data unless we need it for binary check */\n\tif (!patch_ptr &&\n\t\t((delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0 ||\n\t\t (diff->opts.flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0))\n\t\treturn 0;\n\n\tif ((error = diff_patch_alloc_from_diff(&patch, diff, idx)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, patch);\n\tgit_xdiff_init(&xo, &diff->opts);\n\n\terror = diff_patch_invoke_file_callback(patch, &xo.output);\n\n\tif (!error)\n\t\terror = diff_patch_generate(patch, &xo.output);\n\n\tif (!error) {\n\t\t/* TODO: if cumulative diff size is < 0.5 total size, flatten patch */\n\t\t/* TODO: and unload the file content */\n\t}\n\n\tif (error || !patch_ptr)\n\t\tgit_patch_free(patch);\n\telse\n\t\t*patch_ptr = patch;\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_patch_from_buffers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "718-733",
    "snippet": "int git_patch_from_buffers(\n\tgit_patch **out,\n\tconst void *old_buf,\n\tsize_t old_len,\n\tconst char *old_path,\n\tconst char *new_buf,\n\tsize_t new_len,\n\tconst char *new_path,\n\tconst git_diff_options *opts)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(old_buf, old_len, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(new_buf, new_len, new_path);\n\treturn patch_from_sources(out, &osrc, &nsrc, opts);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "patch_from_sources",
          "args": [
            "out",
            "&osrc",
            "&nsrc",
            "opts"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "patch_from_sources",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "595-622",
          "snippet": "static int patch_from_sources(\n\tgit_patch **out,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tdiff_patch_with_delta *pd;\n\tgit_xdiff_output xo;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif ((error = diff_patch_with_delta_alloc(\n\t\t\t&pd, &oldsrc->as_path, &newsrc->as_path)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, &pd->patch);\n\tgit_xdiff_init(&xo, opts);\n\n\tif (!(error = diff_patch_from_sources(pd, &xo, oldsrc, newsrc, opts)))\n\t\t*out = (git_patch *)pd;\n\telse\n\t\tgit_patch_free((git_patch *)pd);\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int patch_from_sources(\n\tgit_patch **out,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tdiff_patch_with_delta *pd;\n\tgit_xdiff_output xo;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif ((error = diff_patch_with_delta_alloc(\n\t\t\t&pd, &oldsrc->as_path, &newsrc->as_path)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, &pd->patch);\n\tgit_xdiff_init(&xo, opts);\n\n\tif (!(error = diff_patch_from_sources(pd, &xo, oldsrc, newsrc, opts)))\n\t\t*out = (git_patch *)pd;\n\telse\n\t\tgit_patch_free((git_patch *)pd);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BUF",
          "args": [
            "new_buf",
            "new_len",
            "new_path"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BUF",
          "args": [
            "old_buf",
            "old_len",
            "old_path"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_from_buffers(\n\tgit_patch **out,\n\tconst void *old_buf,\n\tsize_t old_len,\n\tconst char *old_path,\n\tconst char *new_buf,\n\tsize_t new_len,\n\tconst char *new_path,\n\tconst git_diff_options *opts)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(old_buf, old_len, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(new_buf, new_len, new_path);\n\treturn patch_from_sources(out, &osrc, &nsrc, opts);\n}"
  },
  {
    "function_name": "git_diff_buffers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "696-716",
    "snippet": "int git_diff_buffers(\n\tconst void *old_buf,\n\tsize_t old_len,\n\tconst char *old_path,\n\tconst void *new_buf,\n\tsize_t new_len,\n\tconst char *new_path,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(old_buf, old_len, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(new_buf, new_len, new_path);\n\treturn diff_from_sources(\n\t\t&osrc, &nsrc, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_from_sources",
          "args": [
            "&osrc",
            "&nsrc",
            "opts",
            "file_cb",
            "binary_cb",
            "hunk_cb",
            "data_cb",
            "payload"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "diff_from_sources",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "567-593",
          "snippet": "static int diff_from_sources(\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tdiff_patch_with_delta pd;\n\tgit_xdiff_output xo;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_init(\n\t\t&xo.output, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, opts);\n\n\tmemset(&pd, 0, sizeof(pd));\n\n\terror = diff_patch_from_sources(&pd, &xo, oldsrc, newsrc, opts);\n\n\tgit_patch_free(&pd.patch);\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nstatic int diff_from_sources(\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tdiff_patch_with_delta pd;\n\tgit_xdiff_output xo;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_init(\n\t\t&xo.output, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, opts);\n\n\tmemset(&pd, 0, sizeof(pd));\n\n\terror = diff_patch_from_sources(&pd, &xo, oldsrc, newsrc, opts);\n\n\tgit_patch_free(&pd.patch);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BUF",
          "args": [
            "new_buf",
            "new_len",
            "new_path"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BUF",
          "args": [
            "old_buf",
            "old_len",
            "old_path"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nint git_diff_buffers(\n\tconst void *old_buf,\n\tsize_t old_len,\n\tconst char *old_path,\n\tconst void *new_buf,\n\tsize_t new_len,\n\tconst char *new_path,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(old_buf, old_len, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(new_buf, new_len, new_path);\n\treturn diff_from_sources(\n\t\t&osrc, &nsrc, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n}"
  },
  {
    "function_name": "git_patch_from_blob_and_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "680-694",
    "snippet": "int git_patch_from_blob_and_buffer(\n\tgit_patch **out,\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst char *buf,\n\tsize_t buflen,\n\tconst char *buf_path,\n\tconst git_diff_options *opts)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(buf, buflen, buf_path);\n\treturn patch_from_sources(out, &osrc, &nsrc, opts);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "patch_from_sources",
          "args": [
            "out",
            "&osrc",
            "&nsrc",
            "opts"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "patch_from_sources",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "595-622",
          "snippet": "static int patch_from_sources(\n\tgit_patch **out,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tdiff_patch_with_delta *pd;\n\tgit_xdiff_output xo;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif ((error = diff_patch_with_delta_alloc(\n\t\t\t&pd, &oldsrc->as_path, &newsrc->as_path)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, &pd->patch);\n\tgit_xdiff_init(&xo, opts);\n\n\tif (!(error = diff_patch_from_sources(pd, &xo, oldsrc, newsrc, opts)))\n\t\t*out = (git_patch *)pd;\n\telse\n\t\tgit_patch_free((git_patch *)pd);\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int patch_from_sources(\n\tgit_patch **out,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tdiff_patch_with_delta *pd;\n\tgit_xdiff_output xo;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif ((error = diff_patch_with_delta_alloc(\n\t\t\t&pd, &oldsrc->as_path, &newsrc->as_path)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, &pd->patch);\n\tgit_xdiff_init(&xo, opts);\n\n\tif (!(error = diff_patch_from_sources(pd, &xo, oldsrc, newsrc, opts)))\n\t\t*out = (git_patch *)pd;\n\telse\n\t\tgit_patch_free((git_patch *)pd);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BUF",
          "args": [
            "buf",
            "buflen",
            "buf_path"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BLOB",
          "args": [
            "old_blob",
            "old_path"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_from_blob_and_buffer(\n\tgit_patch **out,\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst char *buf,\n\tsize_t buflen,\n\tconst char *buf_path,\n\tconst git_diff_options *opts)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(buf, buflen, buf_path);\n\treturn patch_from_sources(out, &osrc, &nsrc, opts);\n}"
  },
  {
    "function_name": "git_diff_blob_to_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "659-678",
    "snippet": "int git_diff_blob_to_buffer(\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst char *buf,\n\tsize_t buflen,\n\tconst char *buf_path,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(buf, buflen, buf_path);\n\treturn diff_from_sources(\n\t\t&osrc, &nsrc, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_from_sources",
          "args": [
            "&osrc",
            "&nsrc",
            "opts",
            "file_cb",
            "binary_cb",
            "hunk_cb",
            "data_cb",
            "payload"
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "diff_from_sources",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "567-593",
          "snippet": "static int diff_from_sources(\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tdiff_patch_with_delta pd;\n\tgit_xdiff_output xo;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_init(\n\t\t&xo.output, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, opts);\n\n\tmemset(&pd, 0, sizeof(pd));\n\n\terror = diff_patch_from_sources(&pd, &xo, oldsrc, newsrc, opts);\n\n\tgit_patch_free(&pd.patch);\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nstatic int diff_from_sources(\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tdiff_patch_with_delta pd;\n\tgit_xdiff_output xo;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_init(\n\t\t&xo.output, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, opts);\n\n\tmemset(&pd, 0, sizeof(pd));\n\n\terror = diff_patch_from_sources(&pd, &xo, oldsrc, newsrc, opts);\n\n\tgit_patch_free(&pd.patch);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BUF",
          "args": [
            "buf",
            "buflen",
            "buf_path"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BLOB",
          "args": [
            "old_blob",
            "old_path"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nint git_diff_blob_to_buffer(\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst char *buf,\n\tsize_t buflen,\n\tconst char *buf_path,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BUF(buf, buflen, buf_path);\n\treturn diff_from_sources(\n\t\t&osrc, &nsrc, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n}"
  },
  {
    "function_name": "git_patch_from_blobs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "644-657",
    "snippet": "int git_patch_from_blobs(\n\tgit_patch **out,\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst git_blob *new_blob,\n\tconst char *new_path,\n\tconst git_diff_options *opts)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(new_blob, new_path);\n\treturn patch_from_sources(out, &osrc, &nsrc, opts);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "patch_from_sources",
          "args": [
            "out",
            "&osrc",
            "&nsrc",
            "opts"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "patch_from_sources",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "595-622",
          "snippet": "static int patch_from_sources(\n\tgit_patch **out,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tdiff_patch_with_delta *pd;\n\tgit_xdiff_output xo;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif ((error = diff_patch_with_delta_alloc(\n\t\t\t&pd, &oldsrc->as_path, &newsrc->as_path)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, &pd->patch);\n\tgit_xdiff_init(&xo, opts);\n\n\tif (!(error = diff_patch_from_sources(pd, &xo, oldsrc, newsrc, opts)))\n\t\t*out = (git_patch *)pd;\n\telse\n\t\tgit_patch_free((git_patch *)pd);\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int patch_from_sources(\n\tgit_patch **out,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tdiff_patch_with_delta *pd;\n\tgit_xdiff_output xo;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif ((error = diff_patch_with_delta_alloc(\n\t\t\t&pd, &oldsrc->as_path, &newsrc->as_path)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, &pd->patch);\n\tgit_xdiff_init(&xo, opts);\n\n\tif (!(error = diff_patch_from_sources(pd, &xo, oldsrc, newsrc, opts)))\n\t\t*out = (git_patch *)pd;\n\telse\n\t\tgit_patch_free((git_patch *)pd);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BLOB",
          "args": [
            "new_blob",
            "new_path"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BLOB",
          "args": [
            "old_blob",
            "old_path"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_patch_from_blobs(\n\tgit_patch **out,\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst git_blob *new_blob,\n\tconst char *new_path,\n\tconst git_diff_options *opts)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(new_blob, new_path);\n\treturn patch_from_sources(out, &osrc, &nsrc, opts);\n}"
  },
  {
    "function_name": "git_diff_blobs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "624-642",
    "snippet": "int git_diff_blobs(\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst git_blob *new_blob,\n\tconst char *new_path,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(new_blob, new_path);\n\treturn diff_from_sources(\n\t\t&osrc, &nsrc, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_from_sources",
          "args": [
            "&osrc",
            "&nsrc",
            "opts",
            "file_cb",
            "binary_cb",
            "hunk_cb",
            "data_cb",
            "payload"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "diff_from_sources",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "567-593",
          "snippet": "static int diff_from_sources(\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tdiff_patch_with_delta pd;\n\tgit_xdiff_output xo;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_init(\n\t\t&xo.output, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, opts);\n\n\tmemset(&pd, 0, sizeof(pd));\n\n\terror = diff_patch_from_sources(&pd, &xo, oldsrc, newsrc, opts);\n\n\tgit_patch_free(&pd.patch);\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nstatic int diff_from_sources(\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tdiff_patch_with_delta pd;\n\tgit_xdiff_output xo;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_init(\n\t\t&xo.output, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, opts);\n\n\tmemset(&pd, 0, sizeof(pd));\n\n\terror = diff_patch_from_sources(&pd, &xo, oldsrc, newsrc, opts);\n\n\tgit_patch_free(&pd.patch);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BLOB",
          "args": [
            "new_blob",
            "new_path"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_DIFF_FILE_CONTENT_SRC__BLOB",
          "args": [
            "old_blob",
            "old_path"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nint git_diff_blobs(\n\tconst git_blob *old_blob,\n\tconst char *old_path,\n\tconst git_blob *new_blob,\n\tconst char *new_path,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tgit_diff_file_content_src osrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(old_blob, old_path);\n\tgit_diff_file_content_src nsrc =\n\t\tGIT_DIFF_FILE_CONTENT_SRC__BLOB(new_blob, new_path);\n\treturn diff_from_sources(\n\t\t&osrc, &nsrc, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n}"
  },
  {
    "function_name": "patch_from_sources",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "595-622",
    "snippet": "static int patch_from_sources(\n\tgit_patch **out,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tdiff_patch_with_delta *pd;\n\tgit_xdiff_output xo;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif ((error = diff_patch_with_delta_alloc(\n\t\t\t&pd, &oldsrc->as_path, &newsrc->as_path)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, &pd->patch);\n\tgit_xdiff_init(&xo, opts);\n\n\tif (!(error = diff_patch_from_sources(pd, &xo, oldsrc, newsrc, opts)))\n\t\t*out = (git_patch *)pd;\n\telse\n\t\tgit_patch_free((git_patch *)pd);\n\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_patch_free",
          "args": [
            "(git_patch *)pd"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "788-792",
          "snippet": "void git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_from_sources",
          "args": [
            "pd",
            "&xo",
            "oldsrc",
            "newsrc",
            "opts"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_from_sources",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "488-531",
          "snippet": "static int diff_patch_from_sources(\n\tdiff_patch_with_delta *pd,\n\tgit_xdiff_output *xo,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tgit_repository *repo =\n\t\toldsrc->blob ? git_blob_owner(oldsrc->blob) :\n\t\tnewsrc->blob ? git_blob_owner(newsrc->blob) : NULL;\n\tgit_diff_file *lfile = &pd->delta.old_file, *rfile = &pd->delta.new_file;\n\tgit_diff_file_content *ldata = &pd->patch.ofile, *rdata = &pd->patch.nfile;\n\n\tif ((error = diff_patch_normalize_options(&pd->patch.diff_opts, opts)) < 0)\n\t\treturn error;\n\n\tif (opts && (opts->flags & GIT_DIFF_REVERSE) != 0) {\n\t\tvoid *tmp = lfile; lfile = rfile; rfile = tmp;\n\t\ttmp = ldata; ldata = rdata; rdata = tmp;\n\t}\n\n\tpd->patch.delta = &pd->delta;\n\n\tif (!oldsrc->as_path) {\n\t\tif (newsrc->as_path)\n\t\t\toldsrc->as_path = newsrc->as_path;\n\t\telse\n\t\t\toldsrc->as_path = newsrc->as_path = \"file\";\n\t}\n\telse if (!newsrc->as_path)\n\t\tnewsrc->as_path = oldsrc->as_path;\n\n\tlfile->path = oldsrc->as_path;\n\trfile->path = newsrc->as_path;\n\n\tif ((error = git_diff_file_content__init_from_src(\n\t\t\tldata, repo, opts, oldsrc, lfile)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_src(\n\t\t\trdata, repo, opts, newsrc, rfile)) < 0)\n\t\treturn error;\n\n\treturn diff_single_generate(pd, xo);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_from_sources(\n\tdiff_patch_with_delta *pd,\n\tgit_xdiff_output *xo,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tgit_repository *repo =\n\t\toldsrc->blob ? git_blob_owner(oldsrc->blob) :\n\t\tnewsrc->blob ? git_blob_owner(newsrc->blob) : NULL;\n\tgit_diff_file *lfile = &pd->delta.old_file, *rfile = &pd->delta.new_file;\n\tgit_diff_file_content *ldata = &pd->patch.ofile, *rdata = &pd->patch.nfile;\n\n\tif ((error = diff_patch_normalize_options(&pd->patch.diff_opts, opts)) < 0)\n\t\treturn error;\n\n\tif (opts && (opts->flags & GIT_DIFF_REVERSE) != 0) {\n\t\tvoid *tmp = lfile; lfile = rfile; rfile = tmp;\n\t\ttmp = ldata; ldata = rdata; rdata = tmp;\n\t}\n\n\tpd->patch.delta = &pd->delta;\n\n\tif (!oldsrc->as_path) {\n\t\tif (newsrc->as_path)\n\t\t\toldsrc->as_path = newsrc->as_path;\n\t\telse\n\t\t\toldsrc->as_path = newsrc->as_path = \"file\";\n\t}\n\telse if (!newsrc->as_path)\n\t\tnewsrc->as_path = oldsrc->as_path;\n\n\tlfile->path = oldsrc->as_path;\n\trfile->path = newsrc->as_path;\n\n\tif ((error = git_diff_file_content__init_from_src(\n\t\t\tldata, repo, opts, oldsrc, lfile)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_src(\n\t\t\trdata, repo, opts, newsrc, rfile)) < 0)\n\t\treturn error;\n\n\treturn diff_single_generate(pd, xo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_xdiff_init",
          "args": [
            "&xo",
            "opts"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "git_xdiff_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
          "lines": "226-248",
          "snippet": "void git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nvoid git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_output_to_patch",
          "args": [
            "&xo.output",
            "&pd->patch"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "diff_output_to_patch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "1132-1142",
          "snippet": "static void diff_output_to_patch(git_diff_output *out, git_patch *patch)\n{\n\tdiff_output_init(\n\t\tout,\n\t\tNULL,\n\t\tdiff_patch_file_cb,\n\t\tdiff_patch_binary_cb,\n\t\tdiff_patch_hunk_cb,\n\t\tdiff_patch_line_cb,\n\t\tpatch);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_output_to_patch(git_diff_output *out, git_patch *patch)\n{\n\tdiff_output_init(\n\t\tout,\n\t\tNULL,\n\t\tdiff_patch_file_cb,\n\t\tdiff_patch_binary_cb,\n\t\tdiff_patch_hunk_cb,\n\t\tdiff_patch_line_cb,\n\t\tpatch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&xo",
            "0",
            "sizeof(xo)"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diff_patch_with_delta_alloc",
          "args": [
            "&pd",
            "&oldsrc->as_path",
            "&newsrc->as_path"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_with_delta_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "533-565",
          "snippet": "static int diff_patch_with_delta_alloc(\n\tdiff_patch_with_delta **out,\n\tconst char **old_path,\n\tconst char **new_path)\n{\n\tdiff_patch_with_delta *pd;\n\tsize_t old_len = *old_path ? strlen(*old_path) : 0;\n\tsize_t new_len = *new_path ? strlen(*new_path) : 0;\n\tsize_t alloc_len;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, sizeof(*pd), old_len);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, new_len);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 2);\n\n\t*out = pd = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(pd);\n\n\tpd->patch.flags = GIT_DIFF_PATCH_ALLOCATED;\n\n\tif (*old_path) {\n\t\tmemcpy(&pd->paths[0], *old_path, old_len);\n\t\t*old_path = &pd->paths[0];\n\t} else if (*new_path)\n\t\t*old_path = &pd->paths[old_len + 1];\n\n\tif (*new_path) {\n\t\tmemcpy(&pd->paths[old_len + 1], *new_path, new_len);\n\t\t*new_path = &pd->paths[old_len + 1];\n\t} else if (*old_path)\n\t\t*new_path = &pd->paths[0];\n\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_with_delta_alloc(\n\tdiff_patch_with_delta **out,\n\tconst char **old_path,\n\tconst char **new_path)\n{\n\tdiff_patch_with_delta *pd;\n\tsize_t old_len = *old_path ? strlen(*old_path) : 0;\n\tsize_t new_len = *new_path ? strlen(*new_path) : 0;\n\tsize_t alloc_len;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, sizeof(*pd), old_len);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, new_len);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 2);\n\n\t*out = pd = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(pd);\n\n\tpd->patch.flags = GIT_DIFF_PATCH_ALLOCATED;\n\n\tif (*old_path) {\n\t\tmemcpy(&pd->paths[0], *old_path, old_len);\n\t\t*old_path = &pd->paths[0];\n\t} else if (*new_path)\n\t\t*old_path = &pd->paths[old_len + 1];\n\n\tif (*new_path) {\n\t\tmemcpy(&pd->paths[old_len + 1], *new_path, new_len);\n\t\t*new_path = &pd->paths[old_len + 1];\n\t} else if (*old_path)\n\t\t*new_path = &pd->paths[0];\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int patch_from_sources(\n\tgit_patch **out,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tdiff_patch_with_delta *pd;\n\tgit_xdiff_output xo;\n\n\tassert(out);\n\t*out = NULL;\n\n\tif ((error = diff_patch_with_delta_alloc(\n\t\t\t&pd, &oldsrc->as_path, &newsrc->as_path)) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_to_patch(&xo.output, &pd->patch);\n\tgit_xdiff_init(&xo, opts);\n\n\tif (!(error = diff_patch_from_sources(pd, &xo, oldsrc, newsrc, opts)))\n\t\t*out = (git_patch *)pd;\n\telse\n\t\tgit_patch_free((git_patch *)pd);\n\n\treturn error;\n}"
  },
  {
    "function_name": "diff_from_sources",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "567-593",
    "snippet": "static int diff_from_sources(\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tdiff_patch_with_delta pd;\n\tgit_xdiff_output xo;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_init(\n\t\t&xo.output, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, opts);\n\n\tmemset(&pd, 0, sizeof(pd));\n\n\terror = diff_patch_from_sources(&pd, &xo, oldsrc, newsrc, opts);\n\n\tgit_patch_free(&pd.patch);\n\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_patch_free",
          "args": [
            "&pd.patch"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "788-792",
          "snippet": "void git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_from_sources",
          "args": [
            "&pd",
            "&xo",
            "oldsrc",
            "newsrc",
            "opts"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_from_sources",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "488-531",
          "snippet": "static int diff_patch_from_sources(\n\tdiff_patch_with_delta *pd,\n\tgit_xdiff_output *xo,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tgit_repository *repo =\n\t\toldsrc->blob ? git_blob_owner(oldsrc->blob) :\n\t\tnewsrc->blob ? git_blob_owner(newsrc->blob) : NULL;\n\tgit_diff_file *lfile = &pd->delta.old_file, *rfile = &pd->delta.new_file;\n\tgit_diff_file_content *ldata = &pd->patch.ofile, *rdata = &pd->patch.nfile;\n\n\tif ((error = diff_patch_normalize_options(&pd->patch.diff_opts, opts)) < 0)\n\t\treturn error;\n\n\tif (opts && (opts->flags & GIT_DIFF_REVERSE) != 0) {\n\t\tvoid *tmp = lfile; lfile = rfile; rfile = tmp;\n\t\ttmp = ldata; ldata = rdata; rdata = tmp;\n\t}\n\n\tpd->patch.delta = &pd->delta;\n\n\tif (!oldsrc->as_path) {\n\t\tif (newsrc->as_path)\n\t\t\toldsrc->as_path = newsrc->as_path;\n\t\telse\n\t\t\toldsrc->as_path = newsrc->as_path = \"file\";\n\t}\n\telse if (!newsrc->as_path)\n\t\tnewsrc->as_path = oldsrc->as_path;\n\n\tlfile->path = oldsrc->as_path;\n\trfile->path = newsrc->as_path;\n\n\tif ((error = git_diff_file_content__init_from_src(\n\t\t\tldata, repo, opts, oldsrc, lfile)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_src(\n\t\t\trdata, repo, opts, newsrc, rfile)) < 0)\n\t\treturn error;\n\n\treturn diff_single_generate(pd, xo);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_from_sources(\n\tdiff_patch_with_delta *pd,\n\tgit_xdiff_output *xo,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tgit_repository *repo =\n\t\toldsrc->blob ? git_blob_owner(oldsrc->blob) :\n\t\tnewsrc->blob ? git_blob_owner(newsrc->blob) : NULL;\n\tgit_diff_file *lfile = &pd->delta.old_file, *rfile = &pd->delta.new_file;\n\tgit_diff_file_content *ldata = &pd->patch.ofile, *rdata = &pd->patch.nfile;\n\n\tif ((error = diff_patch_normalize_options(&pd->patch.diff_opts, opts)) < 0)\n\t\treturn error;\n\n\tif (opts && (opts->flags & GIT_DIFF_REVERSE) != 0) {\n\t\tvoid *tmp = lfile; lfile = rfile; rfile = tmp;\n\t\ttmp = ldata; ldata = rdata; rdata = tmp;\n\t}\n\n\tpd->patch.delta = &pd->delta;\n\n\tif (!oldsrc->as_path) {\n\t\tif (newsrc->as_path)\n\t\t\toldsrc->as_path = newsrc->as_path;\n\t\telse\n\t\t\toldsrc->as_path = newsrc->as_path = \"file\";\n\t}\n\telse if (!newsrc->as_path)\n\t\tnewsrc->as_path = oldsrc->as_path;\n\n\tlfile->path = oldsrc->as_path;\n\trfile->path = newsrc->as_path;\n\n\tif ((error = git_diff_file_content__init_from_src(\n\t\t\tldata, repo, opts, oldsrc, lfile)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_src(\n\t\t\trdata, repo, opts, newsrc, rfile)) < 0)\n\t\treturn error;\n\n\treturn diff_single_generate(pd, xo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&pd",
            "0",
            "sizeof(pd)"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_xdiff_init",
          "args": [
            "&xo",
            "opts"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "git_xdiff_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
          "lines": "226-248",
          "snippet": "void git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nvoid git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_output_init",
          "args": [
            "&xo.output",
            "opts",
            "file_cb",
            "binary_cb",
            "hunk_cb",
            "data_cb",
            "payload"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "diff_output_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "1112-1130",
          "snippet": "static void diff_output_init(\n\tgit_diff_output *out,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tGIT_UNUSED(opts);\n\n\tmemset(out, 0, sizeof(*out));\n\n\tout->file_cb = file_cb;\n\tout->binary_cb = binary_cb;\n\tout->hunk_cb = hunk_cb;\n\tout->data_cb = data_cb;\n\tout->payload = payload;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nstatic void diff_output_init(\n\tgit_diff_output *out,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tGIT_UNUSED(opts);\n\n\tmemset(out, 0, sizeof(*out));\n\n\tout->file_cb = file_cb;\n\tout->binary_cb = binary_cb;\n\tout->hunk_cb = hunk_cb;\n\tout->data_cb = data_cb;\n\tout->payload = payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&xo",
            "0",
            "sizeof(xo)"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nstatic int diff_from_sources(\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tdiff_patch_with_delta pd;\n\tgit_xdiff_output xo;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tdiff_output_init(\n\t\t&xo.output, opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, opts);\n\n\tmemset(&pd, 0, sizeof(pd));\n\n\terror = diff_patch_from_sources(&pd, &xo, oldsrc, newsrc, opts);\n\n\tgit_patch_free(&pd.patch);\n\n\treturn error;\n}"
  },
  {
    "function_name": "diff_patch_with_delta_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "533-565",
    "snippet": "static int diff_patch_with_delta_alloc(\n\tdiff_patch_with_delta **out,\n\tconst char **old_path,\n\tconst char **new_path)\n{\n\tdiff_patch_with_delta *pd;\n\tsize_t old_len = *old_path ? strlen(*old_path) : 0;\n\tsize_t new_len = *new_path ? strlen(*new_path) : 0;\n\tsize_t alloc_len;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, sizeof(*pd), old_len);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, new_len);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 2);\n\n\t*out = pd = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(pd);\n\n\tpd->patch.flags = GIT_DIFF_PATCH_ALLOCATED;\n\n\tif (*old_path) {\n\t\tmemcpy(&pd->paths[0], *old_path, old_len);\n\t\t*old_path = &pd->paths[0];\n\t} else if (*new_path)\n\t\t*old_path = &pd->paths[old_len + 1];\n\n\tif (*new_path) {\n\t\tmemcpy(&pd->paths[old_len + 1], *new_path, new_len);\n\t\t*new_path = &pd->paths[old_len + 1];\n\t} else if (*old_path)\n\t\t*new_path = &pd->paths[0];\n\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&pd->paths[old_len + 1]",
            "*new_path",
            "new_len"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&pd->paths[0]",
            "*old_path",
            "old_len"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "pd"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "alloc_len"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloc_len",
            "alloc_len",
            "2"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloc_len",
            "alloc_len",
            "new_len"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloc_len",
            "sizeof(*pd)",
            "old_len"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "*new_path"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "*old_path"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_with_delta_alloc(\n\tdiff_patch_with_delta **out,\n\tconst char **old_path,\n\tconst char **new_path)\n{\n\tdiff_patch_with_delta *pd;\n\tsize_t old_len = *old_path ? strlen(*old_path) : 0;\n\tsize_t new_len = *new_path ? strlen(*new_path) : 0;\n\tsize_t alloc_len;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, sizeof(*pd), old_len);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, new_len);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 2);\n\n\t*out = pd = git__calloc(1, alloc_len);\n\tGITERR_CHECK_ALLOC(pd);\n\n\tpd->patch.flags = GIT_DIFF_PATCH_ALLOCATED;\n\n\tif (*old_path) {\n\t\tmemcpy(&pd->paths[0], *old_path, old_len);\n\t\t*old_path = &pd->paths[0];\n\t} else if (*new_path)\n\t\t*old_path = &pd->paths[old_len + 1];\n\n\tif (*new_path) {\n\t\tmemcpy(&pd->paths[old_len + 1], *new_path, new_len);\n\t\t*new_path = &pd->paths[old_len + 1];\n\t} else if (*old_path)\n\t\t*new_path = &pd->paths[0];\n\n\treturn 0;\n}"
  },
  {
    "function_name": "diff_patch_from_sources",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "488-531",
    "snippet": "static int diff_patch_from_sources(\n\tdiff_patch_with_delta *pd,\n\tgit_xdiff_output *xo,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tgit_repository *repo =\n\t\toldsrc->blob ? git_blob_owner(oldsrc->blob) :\n\t\tnewsrc->blob ? git_blob_owner(newsrc->blob) : NULL;\n\tgit_diff_file *lfile = &pd->delta.old_file, *rfile = &pd->delta.new_file;\n\tgit_diff_file_content *ldata = &pd->patch.ofile, *rdata = &pd->patch.nfile;\n\n\tif ((error = diff_patch_normalize_options(&pd->patch.diff_opts, opts)) < 0)\n\t\treturn error;\n\n\tif (opts && (opts->flags & GIT_DIFF_REVERSE) != 0) {\n\t\tvoid *tmp = lfile; lfile = rfile; rfile = tmp;\n\t\ttmp = ldata; ldata = rdata; rdata = tmp;\n\t}\n\n\tpd->patch.delta = &pd->delta;\n\n\tif (!oldsrc->as_path) {\n\t\tif (newsrc->as_path)\n\t\t\toldsrc->as_path = newsrc->as_path;\n\t\telse\n\t\t\toldsrc->as_path = newsrc->as_path = \"file\";\n\t}\n\telse if (!newsrc->as_path)\n\t\tnewsrc->as_path = oldsrc->as_path;\n\n\tlfile->path = oldsrc->as_path;\n\trfile->path = newsrc->as_path;\n\n\tif ((error = git_diff_file_content__init_from_src(\n\t\t\tldata, repo, opts, oldsrc, lfile)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_src(\n\t\t\trdata, repo, opts, newsrc, rfile)) < 0)\n\t\treturn error;\n\n\treturn diff_single_generate(pd, xo);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_single_generate",
          "args": [
            "pd",
            "xo"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "diff_single_generate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "458-486",
          "snippet": "static int diff_single_generate(diff_patch_with_delta *pd, git_xdiff_output *xo)\n{\n\tint error = 0;\n\tgit_patch *patch = &pd->patch;\n\tbool has_old = ((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) == 0);\n\tbool has_new = ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) == 0);\n\n\tpd->delta.status = has_new ?\n\t\t(has_old ? GIT_DELTA_MODIFIED : GIT_DELTA_ADDED) :\n\t\t(has_old ? GIT_DELTA_DELETED : GIT_DELTA_UNTRACKED);\n\n\tif (git_oid_equal(&patch->nfile.file->id, &patch->ofile.file->id))\n\t\tpd->delta.status = GIT_DELTA_UNMODIFIED;\n\n\tpatch->delta = &pd->delta;\n\n\tdiff_patch_init_common(patch);\n\n\tif (pd->delta.status == GIT_DELTA_UNMODIFIED &&\n\t\t!(patch->ofile.opts_flags & GIT_DIFF_INCLUDE_UNMODIFIED))\n\t\treturn error;\n\n\terror = diff_patch_invoke_file_callback(patch, (git_diff_output *)xo);\n\n\tif (!error)\n\t\terror = diff_patch_generate(patch, (git_diff_output *)xo);\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_single_generate(diff_patch_with_delta *pd, git_xdiff_output *xo)\n{\n\tint error = 0;\n\tgit_patch *patch = &pd->patch;\n\tbool has_old = ((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) == 0);\n\tbool has_new = ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) == 0);\n\n\tpd->delta.status = has_new ?\n\t\t(has_old ? GIT_DELTA_MODIFIED : GIT_DELTA_ADDED) :\n\t\t(has_old ? GIT_DELTA_DELETED : GIT_DELTA_UNTRACKED);\n\n\tif (git_oid_equal(&patch->nfile.file->id, &patch->ofile.file->id))\n\t\tpd->delta.status = GIT_DELTA_UNMODIFIED;\n\n\tpatch->delta = &pd->delta;\n\n\tdiff_patch_init_common(patch);\n\n\tif (pd->delta.status == GIT_DELTA_UNMODIFIED &&\n\t\t!(patch->ofile.opts_flags & GIT_DIFF_INCLUDE_UNMODIFIED))\n\t\treturn error;\n\n\terror = diff_patch_invoke_file_callback(patch, (git_diff_output *)xo);\n\n\tif (!error)\n\t\terror = diff_patch_generate(patch, (git_diff_output *)xo);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_file_content__init_from_src",
          "args": [
            "rdata",
            "repo",
            "opts",
            "newsrc",
            "rfile"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_file_content__init_from_src",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_file.c",
          "lines": "130-165",
          "snippet": "int git_diff_file_content__init_from_src(\n\tgit_diff_file_content *fc,\n\tgit_repository *repo,\n\tconst git_diff_options *opts,\n\tconst git_diff_file_content_src *src,\n\tgit_diff_file *as_file)\n{\n\tmemset(fc, 0, sizeof(*fc));\n\tfc->repo = repo;\n\tfc->file = as_file;\n\tfc->blob = src->blob;\n\n\tif (!src->blob && !src->buf) {\n\t\tfc->flags |= GIT_DIFF_FLAG__NO_DATA;\n\t} else {\n\t\tfc->flags |= GIT_DIFF_FLAG__LOADED;\n\t\tfc->file->flags |= GIT_DIFF_FLAG_VALID_ID;\n\t\tfc->file->mode = GIT_FILEMODE_BLOB;\n\n\t\tif (src->blob) {\n\t\t\tfc->file->size = git_blob_rawsize(src->blob);\n\t\t\tgit_oid_cpy(&fc->file->id, git_blob_id(src->blob));\n\n\t\t\tfc->map.len  = (size_t)fc->file->size;\n\t\t\tfc->map.data = (char *)git_blob_rawcontent(src->blob);\n\t\t} else {\n\t\t\tfc->file->size = src->buflen;\n\t\t\tgit_odb_hash(&fc->file->id, src->buf, src->buflen, GIT_OBJ_BLOB);\n\n\t\t\tfc->map.len  = src->buflen;\n\t\t\tfc->map.data = (char *)src->buf;\n\t\t}\n\t}\n\n\treturn diff_file_content_init_common(fc, opts);\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"fileops.h\"",
            "#include \"odb.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/submodule.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"fileops.h\"\n#include \"odb.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/submodule.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nint git_diff_file_content__init_from_src(\n\tgit_diff_file_content *fc,\n\tgit_repository *repo,\n\tconst git_diff_options *opts,\n\tconst git_diff_file_content_src *src,\n\tgit_diff_file *as_file)\n{\n\tmemset(fc, 0, sizeof(*fc));\n\tfc->repo = repo;\n\tfc->file = as_file;\n\tfc->blob = src->blob;\n\n\tif (!src->blob && !src->buf) {\n\t\tfc->flags |= GIT_DIFF_FLAG__NO_DATA;\n\t} else {\n\t\tfc->flags |= GIT_DIFF_FLAG__LOADED;\n\t\tfc->file->flags |= GIT_DIFF_FLAG_VALID_ID;\n\t\tfc->file->mode = GIT_FILEMODE_BLOB;\n\n\t\tif (src->blob) {\n\t\t\tfc->file->size = git_blob_rawsize(src->blob);\n\t\t\tgit_oid_cpy(&fc->file->id, git_blob_id(src->blob));\n\n\t\t\tfc->map.len  = (size_t)fc->file->size;\n\t\t\tfc->map.data = (char *)git_blob_rawcontent(src->blob);\n\t\t} else {\n\t\t\tfc->file->size = src->buflen;\n\t\t\tgit_odb_hash(&fc->file->id, src->buf, src->buflen, GIT_OBJ_BLOB);\n\n\t\t\tfc->map.len  = src->buflen;\n\t\t\tfc->map.data = (char *)src->buf;\n\t\t}\n\t}\n\n\treturn diff_file_content_init_common(fc, opts);\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_normalize_options",
          "args": [
            "&pd->patch.diff_opts",
            "opts"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_normalize_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "52-76",
          "snippet": "static int diff_patch_normalize_options(\n\tgit_diff_options *out,\n\tconst git_diff_options *opts)\n{\n\tif (opts) {\n\t\tGITERR_CHECK_VERSION(opts, GIT_DIFF_OPTIONS_VERSION, \"git_diff_options\");\n\t\tmemcpy(out, opts, sizeof(git_diff_options));\n\t} else {\n\t\tgit_diff_options default_opts = GIT_DIFF_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_diff_options));\n\t}\n\n\tout->old_prefix = opts && opts->old_prefix ?\n\t\tgit__strdup(opts->old_prefix) :\n\t\tgit__strdup(DIFF_OLD_PREFIX_DEFAULT);\n\n\tout->new_prefix = opts && opts->new_prefix ?\n\t\tgit__strdup(opts->new_prefix) :\n\t\tgit__strdup(DIFF_NEW_PREFIX_DEFAULT);\n\n\tGITERR_CHECK_ALLOC(out->old_prefix);\n\tGITERR_CHECK_ALLOC(out->new_prefix);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_normalize_options(\n\tgit_diff_options *out,\n\tconst git_diff_options *opts)\n{\n\tif (opts) {\n\t\tGITERR_CHECK_VERSION(opts, GIT_DIFF_OPTIONS_VERSION, \"git_diff_options\");\n\t\tmemcpy(out, opts, sizeof(git_diff_options));\n\t} else {\n\t\tgit_diff_options default_opts = GIT_DIFF_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_diff_options));\n\t}\n\n\tout->old_prefix = opts && opts->old_prefix ?\n\t\tgit__strdup(opts->old_prefix) :\n\t\tgit__strdup(DIFF_OLD_PREFIX_DEFAULT);\n\n\tout->new_prefix = opts && opts->new_prefix ?\n\t\tgit__strdup(opts->new_prefix) :\n\t\tgit__strdup(DIFF_NEW_PREFIX_DEFAULT);\n\n\tGITERR_CHECK_ALLOC(out->old_prefix);\n\tGITERR_CHECK_ALLOC(out->new_prefix);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_blob_owner",
          "args": [
            "newsrc->blob"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "git_blob_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object_api.c",
          "lines": "126-129",
          "snippet": "git_repository *git_blob_owner(const git_blob *obj)\n{\n\treturn git_object_owner((const git_object *)obj);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\ngit_repository *git_blob_owner(const git_blob *obj)\n{\n\treturn git_object_owner((const git_object *)obj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_from_sources(\n\tdiff_patch_with_delta *pd,\n\tgit_xdiff_output *xo,\n\tgit_diff_file_content_src *oldsrc,\n\tgit_diff_file_content_src *newsrc,\n\tconst git_diff_options *opts)\n{\n\tint error = 0;\n\tgit_repository *repo =\n\t\toldsrc->blob ? git_blob_owner(oldsrc->blob) :\n\t\tnewsrc->blob ? git_blob_owner(newsrc->blob) : NULL;\n\tgit_diff_file *lfile = &pd->delta.old_file, *rfile = &pd->delta.new_file;\n\tgit_diff_file_content *ldata = &pd->patch.ofile, *rdata = &pd->patch.nfile;\n\n\tif ((error = diff_patch_normalize_options(&pd->patch.diff_opts, opts)) < 0)\n\t\treturn error;\n\n\tif (opts && (opts->flags & GIT_DIFF_REVERSE) != 0) {\n\t\tvoid *tmp = lfile; lfile = rfile; rfile = tmp;\n\t\ttmp = ldata; ldata = rdata; rdata = tmp;\n\t}\n\n\tpd->patch.delta = &pd->delta;\n\n\tif (!oldsrc->as_path) {\n\t\tif (newsrc->as_path)\n\t\t\toldsrc->as_path = newsrc->as_path;\n\t\telse\n\t\t\toldsrc->as_path = newsrc->as_path = \"file\";\n\t}\n\telse if (!newsrc->as_path)\n\t\tnewsrc->as_path = oldsrc->as_path;\n\n\tlfile->path = oldsrc->as_path;\n\trfile->path = newsrc->as_path;\n\n\tif ((error = git_diff_file_content__init_from_src(\n\t\t\tldata, repo, opts, oldsrc, lfile)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_src(\n\t\t\trdata, repo, opts, newsrc, rfile)) < 0)\n\t\treturn error;\n\n\treturn diff_single_generate(pd, xo);\n}"
  },
  {
    "function_name": "diff_single_generate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "458-486",
    "snippet": "static int diff_single_generate(diff_patch_with_delta *pd, git_xdiff_output *xo)\n{\n\tint error = 0;\n\tgit_patch *patch = &pd->patch;\n\tbool has_old = ((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) == 0);\n\tbool has_new = ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) == 0);\n\n\tpd->delta.status = has_new ?\n\t\t(has_old ? GIT_DELTA_MODIFIED : GIT_DELTA_ADDED) :\n\t\t(has_old ? GIT_DELTA_DELETED : GIT_DELTA_UNTRACKED);\n\n\tif (git_oid_equal(&patch->nfile.file->id, &patch->ofile.file->id))\n\t\tpd->delta.status = GIT_DELTA_UNMODIFIED;\n\n\tpatch->delta = &pd->delta;\n\n\tdiff_patch_init_common(patch);\n\n\tif (pd->delta.status == GIT_DELTA_UNMODIFIED &&\n\t\t!(patch->ofile.opts_flags & GIT_DIFF_INCLUDE_UNMODIFIED))\n\t\treturn error;\n\n\terror = diff_patch_invoke_file_callback(patch, (git_diff_output *)xo);\n\n\tif (!error)\n\t\terror = diff_patch_generate(patch, (git_diff_output *)xo);\n\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_patch_generate",
          "args": [
            "patch",
            "(git_diff_output *)xo"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_generate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "342-371",
          "snippet": "static int diff_patch_generate(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFED) != 0)\n\t\treturn 0;\n\n\t/* if we are not looking at the binary or text data, don't do the diff */\n\tif (!output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) == 0 &&\n\t\t(error = diff_patch_load(patch, output)) < 0)\n\t\treturn error;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFABLE) == 0)\n\t\treturn 0;\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (output->binary_cb)\n\t\t\terror = diff_binary(output, patch);\n\t}\n\telse {\n\t\tif (output->diff_cb)\n\t\t\terror = output->diff_cb(output, patch);\n\t}\n\n\tpatch->flags |= GIT_DIFF_PATCH_DIFFED;\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_generate(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFED) != 0)\n\t\treturn 0;\n\n\t/* if we are not looking at the binary or text data, don't do the diff */\n\tif (!output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) == 0 &&\n\t\t(error = diff_patch_load(patch, output)) < 0)\n\t\treturn error;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFABLE) == 0)\n\t\treturn 0;\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (output->binary_cb)\n\t\t\terror = diff_binary(output, patch);\n\t}\n\telse {\n\t\tif (output->diff_cb)\n\t\t\terror = output->diff_cb(output, patch);\n\t}\n\n\tpatch->flags |= GIT_DIFF_PATCH_DIFFED;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_invoke_file_callback",
          "args": [
            "patch",
            "(git_diff_output *)xo"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_invoke_file_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "231-243",
          "snippet": "static int diff_patch_invoke_file_callback(\n\tgit_patch *patch, git_diff_output *output)\n{\n\tfloat progress = patch->diff ?\n\t\t((float)patch->delta_index / patch->diff->deltas.length) : 1.0f;\n\n\tif (!output->file_cb)\n\t\treturn 0;\n\n\treturn giterr_set_after_callback_function(\n\t\toutput->file_cb(patch->delta, progress, output->payload),\n\t\t\"git_patch\");\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_invoke_file_callback(\n\tgit_patch *patch, git_diff_output *output)\n{\n\tfloat progress = patch->diff ?\n\t\t((float)patch->delta_index / patch->diff->deltas.length) : 1.0f;\n\n\tif (!output->file_cb)\n\t\treturn 0;\n\n\treturn giterr_set_after_callback_function(\n\t\toutput->file_cb(patch->delta, progress, output->payload),\n\t\t\"git_patch\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_init_common",
          "args": [
            "patch"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_init_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "42-50",
          "snippet": "static void diff_patch_init_common(git_patch *patch)\n{\n\tdiff_patch_update_binary(patch);\n\n\tpatch->flags |= GIT_DIFF_PATCH_INITIALIZED;\n\n\tif (patch->diff)\n\t\tgit_diff_addref(patch->diff);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_patch_init_common(git_patch *patch)\n{\n\tdiff_patch_update_binary(patch);\n\n\tpatch->flags |= GIT_DIFF_PATCH_INITIALIZED;\n\n\tif (patch->diff)\n\t\tgit_diff_addref(patch->diff);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_equal",
          "args": [
            "&patch->nfile.file->id",
            "&patch->ofile.file->id"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "184-187",
          "snippet": "int git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_single_generate(diff_patch_with_delta *pd, git_xdiff_output *xo)\n{\n\tint error = 0;\n\tgit_patch *patch = &pd->patch;\n\tbool has_old = ((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) == 0);\n\tbool has_new = ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) == 0);\n\n\tpd->delta.status = has_new ?\n\t\t(has_old ? GIT_DELTA_MODIFIED : GIT_DELTA_ADDED) :\n\t\t(has_old ? GIT_DELTA_DELETED : GIT_DELTA_UNTRACKED);\n\n\tif (git_oid_equal(&patch->nfile.file->id, &patch->ofile.file->id))\n\t\tpd->delta.status = GIT_DELTA_UNMODIFIED;\n\n\tpatch->delta = &pd->delta;\n\n\tdiff_patch_init_common(patch);\n\n\tif (pd->delta.status == GIT_DELTA_UNMODIFIED &&\n\t\t!(patch->ofile.opts_flags & GIT_DIFF_INCLUDE_UNMODIFIED))\n\t\treturn error;\n\n\terror = diff_patch_invoke_file_callback(patch, (git_diff_output *)xo);\n\n\tif (!error)\n\t\terror = diff_patch_generate(patch, (git_diff_output *)xo);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_diff_foreach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "404-450",
    "snippet": "int git_diff_foreach(\n\tgit_diff *diff,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tgit_xdiff_output xo;\n\tsize_t idx;\n\tgit_patch patch;\n\n\tif ((error = diff_required(diff, \"git_diff_foreach\")) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tmemset(&patch, 0, sizeof(patch));\n\tdiff_output_init(\n\t\t&xo.output, &diff->opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, &diff->opts);\n\n\tgit_vector_foreach(&diff->deltas, idx, patch.delta) {\n\n\t\t/* check flags against patch status */\n\t\tif (git_diff_delta__should_skip(&diff->opts, patch.delta))\n\t\t\tcontinue;\n\n\t\tif (binary_cb || hunk_cb || data_cb) {\n\t\t\tif ((error = diff_patch_init_from_diff(&patch, diff, idx)) != 0 ||\n\t\t\t\t(error = diff_patch_load(&patch, &xo.output)) != 0)\n\t\t\t\treturn error;\n\t\t}\n\n\t\tif ((error = diff_patch_invoke_file_callback(&patch, &xo.output)) == 0) {\n\t\t\tif (binary_cb || hunk_cb || data_cb)\n\t\t\t\t\terror = diff_patch_generate(&patch, &xo.output);\n\t\t}\n\n\t\tgit_patch_free(&patch);\n\n\t\tif (error)\n\t\t\tbreak;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);",
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_patch_free",
          "args": [
            "&patch"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "788-792",
          "snippet": "void git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch_free(git_patch *patch)\n{\n\tif (patch)\n\t\tGIT_REFCOUNT_DEC(patch, diff_patch_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_generate",
          "args": [
            "&patch",
            "&xo.output"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_generate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "342-371",
          "snippet": "static int diff_patch_generate(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFED) != 0)\n\t\treturn 0;\n\n\t/* if we are not looking at the binary or text data, don't do the diff */\n\tif (!output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) == 0 &&\n\t\t(error = diff_patch_load(patch, output)) < 0)\n\t\treturn error;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFABLE) == 0)\n\t\treturn 0;\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (output->binary_cb)\n\t\t\terror = diff_binary(output, patch);\n\t}\n\telse {\n\t\tif (output->diff_cb)\n\t\t\terror = output->diff_cb(output, patch);\n\t}\n\n\tpatch->flags |= GIT_DIFF_PATCH_DIFFED;\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_generate(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFED) != 0)\n\t\treturn 0;\n\n\t/* if we are not looking at the binary or text data, don't do the diff */\n\tif (!output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) == 0 &&\n\t\t(error = diff_patch_load(patch, output)) < 0)\n\t\treturn error;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFABLE) == 0)\n\t\treturn 0;\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (output->binary_cb)\n\t\t\terror = diff_binary(output, patch);\n\t}\n\telse {\n\t\tif (output->diff_cb)\n\t\t\terror = output->diff_cb(output, patch);\n\t}\n\n\tpatch->flags |= GIT_DIFF_PATCH_DIFFED;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_invoke_file_callback",
          "args": [
            "&patch",
            "&xo.output"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_invoke_file_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "231-243",
          "snippet": "static int diff_patch_invoke_file_callback(\n\tgit_patch *patch, git_diff_output *output)\n{\n\tfloat progress = patch->diff ?\n\t\t((float)patch->delta_index / patch->diff->deltas.length) : 1.0f;\n\n\tif (!output->file_cb)\n\t\treturn 0;\n\n\treturn giterr_set_after_callback_function(\n\t\toutput->file_cb(patch->delta, progress, output->payload),\n\t\t\"git_patch\");\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_invoke_file_callback(\n\tgit_patch *patch, git_diff_output *output)\n{\n\tfloat progress = patch->diff ?\n\t\t((float)patch->delta_index / patch->diff->deltas.length) : 1.0f;\n\n\tif (!output->file_cb)\n\t\treturn 0;\n\n\treturn giterr_set_after_callback_function(\n\t\toutput->file_cb(patch->delta, progress, output->payload),\n\t\t\"git_patch\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_load",
          "args": [
            "&patch",
            "&xo.output"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "157-229",
          "snippet": "static int diff_patch_load(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\tbool incomplete_data;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) != 0)\n\t\treturn 0;\n\n\t/* if no hunk and data callbacks and user doesn't care if data looks\n\t * binary, then there is no need to actually load the data\n\t */\n\tif ((patch->ofile.opts_flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0 &&\n\t\toutput && !output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tincomplete_data =\n\t\t(((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->ofile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0) &&\n\t\t ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->nfile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0));\n\n\t/* always try to load workdir content first because filtering may\n\t * need 2x data size and this minimizes peak memory footprint\n\t */\n\tif (patch->ofile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* once workdir has been tried, load other data as needed */\n\tif (patch->ofile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* if previously missing an oid, and now that we have it the two sides\n\t * are the same (and not submodules), update MODIFIED -> UNMODIFIED\n\t */\n\tif (incomplete_data &&\n\t\tpatch->ofile.file->mode == patch->nfile.file->mode &&\n\t\tpatch->ofile.file->mode != GIT_FILEMODE_COMMIT &&\n\t\tgit_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id) &&\n\t\tpatch->delta->status == GIT_DELTA_MODIFIED) /* not RENAMED/COPIED! */\n\t\tpatch->delta->status = GIT_DELTA_UNMODIFIED;\n\ncleanup:\n\tdiff_patch_update_binary(patch);\n\n\tif (!error) {\n\t\tif (diff_patch_diffable(patch))\n\t\t\tpatch->flags |= GIT_DIFF_PATCH_DIFFABLE;\n\n\t\tpatch->flags |= GIT_DIFF_PATCH_LOADED;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_load(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\tbool incomplete_data;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) != 0)\n\t\treturn 0;\n\n\t/* if no hunk and data callbacks and user doesn't care if data looks\n\t * binary, then there is no need to actually load the data\n\t */\n\tif ((patch->ofile.opts_flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0 &&\n\t\toutput && !output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tincomplete_data =\n\t\t(((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->ofile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0) &&\n\t\t ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->nfile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0));\n\n\t/* always try to load workdir content first because filtering may\n\t * need 2x data size and this minimizes peak memory footprint\n\t */\n\tif (patch->ofile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* once workdir has been tried, load other data as needed */\n\tif (patch->ofile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* if previously missing an oid, and now that we have it the two sides\n\t * are the same (and not submodules), update MODIFIED -> UNMODIFIED\n\t */\n\tif (incomplete_data &&\n\t\tpatch->ofile.file->mode == patch->nfile.file->mode &&\n\t\tpatch->ofile.file->mode != GIT_FILEMODE_COMMIT &&\n\t\tgit_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id) &&\n\t\tpatch->delta->status == GIT_DELTA_MODIFIED) /* not RENAMED/COPIED! */\n\t\tpatch->delta->status = GIT_DELTA_UNMODIFIED;\n\ncleanup:\n\tdiff_patch_update_binary(patch);\n\n\tif (!error) {\n\t\tif (diff_patch_diffable(patch))\n\t\t\tpatch->flags |= GIT_DIFF_PATCH_DIFFABLE;\n\n\t\tpatch->flags |= GIT_DIFF_PATCH_LOADED;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_init_from_diff",
          "args": [
            "&patch",
            "diff",
            "idx"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_init_from_diff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "78-99",
          "snippet": "static int diff_patch_init_from_diff(\n\tgit_patch *patch, git_diff *diff, size_t delta_index)\n{\n\tint error = 0;\n\n\tmemset(patch, 0, sizeof(*patch));\n\tpatch->diff  = diff;\n\tpatch->delta = git_vector_get(&diff->deltas, delta_index);\n\tpatch->delta_index = delta_index;\n\n\tif ((error = diff_patch_normalize_options(\n\t\t\t&patch->diff_opts, &diff->opts)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->ofile, diff, patch->delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->nfile, diff, patch->delta, false)) < 0)\n\t\treturn error;\n\n\tdiff_patch_init_common(patch);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_init_from_diff(\n\tgit_patch *patch, git_diff *diff, size_t delta_index)\n{\n\tint error = 0;\n\n\tmemset(patch, 0, sizeof(*patch));\n\tpatch->diff  = diff;\n\tpatch->delta = git_vector_get(&diff->deltas, delta_index);\n\tpatch->delta_index = delta_index;\n\n\tif ((error = diff_patch_normalize_options(\n\t\t\t&patch->diff_opts, &diff->opts)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->ofile, diff, patch->delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->nfile, diff, patch->delta, false)) < 0)\n\t\treturn error;\n\n\tdiff_patch_init_common(patch);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_delta__should_skip",
          "args": [
            "&diff->opts",
            "patch.delta"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_delta__should_skip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "328-350",
          "snippet": "bool git_diff_delta__should_skip(\n\tconst git_diff_options *opts, const git_diff_delta *delta)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\tif (delta->status == GIT_DELTA_UNMODIFIED &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNMODIFIED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_IGNORED &&\n\t\t(flags & GIT_DIFF_INCLUDE_IGNORED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_UNTRACKED &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNTRACKED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_UNREADABLE &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNREADABLE) == 0)\n\t\treturn true;\n\n\treturn false;\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nbool git_diff_delta__should_skip(\n\tconst git_diff_options *opts, const git_diff_delta *delta)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\tif (delta->status == GIT_DELTA_UNMODIFIED &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNMODIFIED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_IGNORED &&\n\t\t(flags & GIT_DIFF_INCLUDE_IGNORED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_UNTRACKED &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNTRACKED) == 0)\n\t\treturn true;\n\n\tif (delta->status == GIT_DELTA_UNREADABLE &&\n\t\t(flags & GIT_DIFF_INCLUDE_UNREADABLE) == 0)\n\t\treturn true;\n\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&diff->deltas",
            "idx",
            "patch.delta"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_xdiff_init",
          "args": [
            "&xo",
            "&diff->opts"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "git_xdiff_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
          "lines": "226-248",
          "snippet": "void git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nvoid git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_output_init",
          "args": [
            "&xo.output",
            "&diff->opts",
            "file_cb",
            "binary_cb",
            "hunk_cb",
            "data_cb",
            "payload"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "diff_output_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "1112-1130",
          "snippet": "static void diff_output_init(\n\tgit_diff_output *out,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tGIT_UNUSED(opts);\n\n\tmemset(out, 0, sizeof(*out));\n\n\tout->file_cb = file_cb;\n\tout->binary_cb = binary_cb;\n\tout->hunk_cb = hunk_cb;\n\tout->data_cb = data_cb;\n\tout->payload = payload;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\n\nstatic void diff_output_init(\n\tgit_diff_output *out,\n\tconst git_diff_options *opts,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tGIT_UNUSED(opts);\n\n\tmemset(out, 0, sizeof(*out));\n\n\tout->file_cb = file_cb;\n\tout->binary_cb = binary_cb;\n\tout->hunk_cb = hunk_cb;\n\tout->data_cb = data_cb;\n\tout->payload = payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&patch",
            "0",
            "sizeof(patch)"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&xo",
            "0",
            "sizeof(xo)"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diff_required",
          "args": [
            "diff",
            "\"git_diff_foreach\""
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "diff_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "396-402",
          "snippet": "static int diff_required(git_diff *diff, const char *action)\n{\n\tif (diff)\n\t\treturn 0;\n\tgiterr_set(GITERR_INVALID, \"Must provide valid diff to %s\", action);\n\treturn -1;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_required(git_diff *diff, const char *action)\n{\n\tif (diff)\n\t\treturn 0;\n\tgiterr_set(GITERR_INVALID, \"Must provide valid diff to %s\", action);\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_init(\n\tgit_diff_output*, const git_diff_options*, git_diff_file_cb,\n\tgit_diff_binary_cb, git_diff_hunk_cb, git_diff_line_cb, void*);\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nint git_diff_foreach(\n\tgit_diff *diff,\n\tgit_diff_file_cb file_cb,\n\tgit_diff_binary_cb binary_cb,\n\tgit_diff_hunk_cb hunk_cb,\n\tgit_diff_line_cb data_cb,\n\tvoid *payload)\n{\n\tint error = 0;\n\tgit_xdiff_output xo;\n\tsize_t idx;\n\tgit_patch patch;\n\n\tif ((error = diff_required(diff, \"git_diff_foreach\")) < 0)\n\t\treturn error;\n\n\tmemset(&xo, 0, sizeof(xo));\n\tmemset(&patch, 0, sizeof(patch));\n\tdiff_output_init(\n\t\t&xo.output, &diff->opts, file_cb, binary_cb, hunk_cb, data_cb, payload);\n\tgit_xdiff_init(&xo, &diff->opts);\n\n\tgit_vector_foreach(&diff->deltas, idx, patch.delta) {\n\n\t\t/* check flags against patch status */\n\t\tif (git_diff_delta__should_skip(&diff->opts, patch.delta))\n\t\t\tcontinue;\n\n\t\tif (binary_cb || hunk_cb || data_cb) {\n\t\t\tif ((error = diff_patch_init_from_diff(&patch, diff, idx)) != 0 ||\n\t\t\t\t(error = diff_patch_load(&patch, &xo.output)) != 0)\n\t\t\t\treturn error;\n\t\t}\n\n\t\tif ((error = diff_patch_invoke_file_callback(&patch, &xo.output)) == 0) {\n\t\t\tif (binary_cb || hunk_cb || data_cb)\n\t\t\t\t\terror = diff_patch_generate(&patch, &xo.output);\n\t\t}\n\n\t\tgit_patch_free(&patch);\n\n\t\tif (error)\n\t\t\tbreak;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "diff_required",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "396-402",
    "snippet": "static int diff_required(git_diff *diff, const char *action)\n{\n\tif (diff)\n\t\treturn 0;\n\tgiterr_set(GITERR_INVALID, \"Must provide valid diff to %s\", action);\n\treturn -1;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Must provide valid diff to %s\"",
            "action"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_required(git_diff *diff, const char *action)\n{\n\tif (diff)\n\t\treturn 0;\n\tgiterr_set(GITERR_INVALID, \"Must provide valid diff to %s\", action);\n\treturn -1;\n}"
  },
  {
    "function_name": "diff_patch_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "373-394",
    "snippet": "static void diff_patch_free(git_patch *patch)\n{\n\tgit_diff_file_content__clear(&patch->ofile);\n\tgit_diff_file_content__clear(&patch->nfile);\n\n\tgit_array_clear(patch->lines);\n\tgit_array_clear(patch->hunks);\n\n\tgit_diff_free(patch->diff); /* decrements refcount */\n\tpatch->diff = NULL;\n\n\tgit_pool_clear(&patch->flattened);\n\n\tgit__free((char *)patch->diff_opts.old_prefix);\n\tgit__free((char *)patch->diff_opts.new_prefix);\n\n\tgit__free((char *)patch->binary.old_file.data);\n\tgit__free((char *)patch->binary.new_file.data);\n\n\tif (patch->flags & GIT_DIFF_PATCH_ALLOCATED)\n\t\tgit__free(patch);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "patch"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pool_clear",
          "args": [
            "&patch->flattened"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "131-134",
          "snippet": "void git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_free",
          "args": [
            "patch->diff"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "576-582",
          "snippet": "void git_diff_free(git_diff *diff)\n{\n\tif (!diff)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(diff, diff_list_free);\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nvoid git_diff_free(git_diff *diff)\n{\n\tif (!diff)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(diff, diff_list_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "patch->hunks"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "patch->lines"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_diff_file_content__clear",
          "args": [
            "&patch->nfile"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_file_content__clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_file.c",
          "lines": "459-464",
          "snippet": "void git_diff_file_content__clear(git_diff_file_content *fc)\n{\n\tgit_diff_file_content__unload(fc);\n\n\t/* for now, nothing else to do */\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"fileops.h\"",
            "#include \"odb.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/submodule.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"fileops.h\"\n#include \"odb.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/submodule.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nvoid git_diff_file_content__clear(git_diff_file_content *fc)\n{\n\tgit_diff_file_content__unload(fc);\n\n\t/* for now, nothing else to do */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_patch_free(git_patch *patch)\n{\n\tgit_diff_file_content__clear(&patch->ofile);\n\tgit_diff_file_content__clear(&patch->nfile);\n\n\tgit_array_clear(patch->lines);\n\tgit_array_clear(patch->hunks);\n\n\tgit_diff_free(patch->diff); /* decrements refcount */\n\tpatch->diff = NULL;\n\n\tgit_pool_clear(&patch->flattened);\n\n\tgit__free((char *)patch->diff_opts.old_prefix);\n\tgit__free((char *)patch->diff_opts.new_prefix);\n\n\tgit__free((char *)patch->binary.old_file.data);\n\tgit__free((char *)patch->binary.new_file.data);\n\n\tif (patch->flags & GIT_DIFF_PATCH_ALLOCATED)\n\t\tgit__free(patch);\n}"
  },
  {
    "function_name": "diff_patch_generate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "342-371",
    "snippet": "static int diff_patch_generate(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFED) != 0)\n\t\treturn 0;\n\n\t/* if we are not looking at the binary or text data, don't do the diff */\n\tif (!output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) == 0 &&\n\t\t(error = diff_patch_load(patch, output)) < 0)\n\t\treturn error;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFABLE) == 0)\n\t\treturn 0;\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (output->binary_cb)\n\t\t\terror = diff_binary(output, patch);\n\t}\n\telse {\n\t\tif (output->diff_cb)\n\t\t\terror = output->diff_cb(output, patch);\n\t}\n\n\tpatch->flags |= GIT_DIFF_PATCH_DIFFED;\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "output->diff_cb",
          "args": [
            "output",
            "patch"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diff_binary",
          "args": [
            "output",
            "patch"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "diff_binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "308-340",
          "snippet": "static int diff_binary(git_diff_output *output, git_patch *patch)\n{\n\tgit_diff_binary binary = {{0}};\n\tconst char *old_data = patch->ofile.map.data;\n\tconst char *new_data = patch->nfile.map.data;\n\tsize_t old_len = patch->ofile.map.len,\n\t\tnew_len = patch->nfile.map.len;\n\tint error;\n\n\t/* Create the old->new delta (as the \"new\" side of the patch),\n\t * and the new->old delta (as the \"old\" side)\n\t */\n\tif ((error = create_binary(&binary.old_file.type,\n\t\t\t(char **)&binary.old_file.data,\n\t\t\t&binary.old_file.datalen,\n\t\t\t&binary.old_file.inflatedlen,\n\t\t\tnew_data, new_len, old_data, old_len)) < 0 ||\n\t\t(error = create_binary(&binary.new_file.type,\n\t\t\t(char **)&binary.new_file.data,\n\t\t\t&binary.new_file.datalen,\n\t\t\t&binary.new_file.inflatedlen,\n\t\t\told_data, old_len, new_data, new_len)) < 0)\n\t\treturn error;\n\n\terror = giterr_set_after_callback_function(\n\t\toutput->binary_cb(patch->delta, &binary, output->payload),\n\t\t\"git_patch\");\n\n\tgit__free((char *) binary.old_file.data);\n\tgit__free((char *) binary.new_file.data);\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_binary(git_diff_output *output, git_patch *patch)\n{\n\tgit_diff_binary binary = {{0}};\n\tconst char *old_data = patch->ofile.map.data;\n\tconst char *new_data = patch->nfile.map.data;\n\tsize_t old_len = patch->ofile.map.len,\n\t\tnew_len = patch->nfile.map.len;\n\tint error;\n\n\t/* Create the old->new delta (as the \"new\" side of the patch),\n\t * and the new->old delta (as the \"old\" side)\n\t */\n\tif ((error = create_binary(&binary.old_file.type,\n\t\t\t(char **)&binary.old_file.data,\n\t\t\t&binary.old_file.datalen,\n\t\t\t&binary.old_file.inflatedlen,\n\t\t\tnew_data, new_len, old_data, old_len)) < 0 ||\n\t\t(error = create_binary(&binary.new_file.type,\n\t\t\t(char **)&binary.new_file.data,\n\t\t\t&binary.new_file.datalen,\n\t\t\t&binary.new_file.inflatedlen,\n\t\t\told_data, old_len, new_data, new_len)) < 0)\n\t\treturn error;\n\n\terror = giterr_set_after_callback_function(\n\t\toutput->binary_cb(patch->delta, &binary, output->payload),\n\t\t\"git_patch\");\n\n\tgit__free((char *) binary.old_file.data);\n\tgit__free((char *) binary.new_file.data);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_load",
          "args": [
            "patch",
            "output"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "157-229",
          "snippet": "static int diff_patch_load(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\tbool incomplete_data;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) != 0)\n\t\treturn 0;\n\n\t/* if no hunk and data callbacks and user doesn't care if data looks\n\t * binary, then there is no need to actually load the data\n\t */\n\tif ((patch->ofile.opts_flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0 &&\n\t\toutput && !output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tincomplete_data =\n\t\t(((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->ofile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0) &&\n\t\t ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->nfile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0));\n\n\t/* always try to load workdir content first because filtering may\n\t * need 2x data size and this minimizes peak memory footprint\n\t */\n\tif (patch->ofile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* once workdir has been tried, load other data as needed */\n\tif (patch->ofile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* if previously missing an oid, and now that we have it the two sides\n\t * are the same (and not submodules), update MODIFIED -> UNMODIFIED\n\t */\n\tif (incomplete_data &&\n\t\tpatch->ofile.file->mode == patch->nfile.file->mode &&\n\t\tpatch->ofile.file->mode != GIT_FILEMODE_COMMIT &&\n\t\tgit_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id) &&\n\t\tpatch->delta->status == GIT_DELTA_MODIFIED) /* not RENAMED/COPIED! */\n\t\tpatch->delta->status = GIT_DELTA_UNMODIFIED;\n\ncleanup:\n\tdiff_patch_update_binary(patch);\n\n\tif (!error) {\n\t\tif (diff_patch_diffable(patch))\n\t\t\tpatch->flags |= GIT_DIFF_PATCH_DIFFABLE;\n\n\t\tpatch->flags |= GIT_DIFF_PATCH_LOADED;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_load(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\tbool incomplete_data;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) != 0)\n\t\treturn 0;\n\n\t/* if no hunk and data callbacks and user doesn't care if data looks\n\t * binary, then there is no need to actually load the data\n\t */\n\tif ((patch->ofile.opts_flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0 &&\n\t\toutput && !output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tincomplete_data =\n\t\t(((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->ofile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0) &&\n\t\t ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->nfile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0));\n\n\t/* always try to load workdir content first because filtering may\n\t * need 2x data size and this minimizes peak memory footprint\n\t */\n\tif (patch->ofile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* once workdir has been tried, load other data as needed */\n\tif (patch->ofile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* if previously missing an oid, and now that we have it the two sides\n\t * are the same (and not submodules), update MODIFIED -> UNMODIFIED\n\t */\n\tif (incomplete_data &&\n\t\tpatch->ofile.file->mode == patch->nfile.file->mode &&\n\t\tpatch->ofile.file->mode != GIT_FILEMODE_COMMIT &&\n\t\tgit_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id) &&\n\t\tpatch->delta->status == GIT_DELTA_MODIFIED) /* not RENAMED/COPIED! */\n\t\tpatch->delta->status = GIT_DELTA_UNMODIFIED;\n\ncleanup:\n\tdiff_patch_update_binary(patch);\n\n\tif (!error) {\n\t\tif (diff_patch_diffable(patch))\n\t\t\tpatch->flags |= GIT_DIFF_PATCH_DIFFABLE;\n\n\t\tpatch->flags |= GIT_DIFF_PATCH_LOADED;\n\t}\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_generate(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFED) != 0)\n\t\treturn 0;\n\n\t/* if we are not looking at the binary or text data, don't do the diff */\n\tif (!output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) == 0 &&\n\t\t(error = diff_patch_load(patch, output)) < 0)\n\t\treturn error;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_DIFFABLE) == 0)\n\t\treturn 0;\n\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0) {\n\t\tif (output->binary_cb)\n\t\t\terror = diff_binary(output, patch);\n\t}\n\telse {\n\t\tif (output->diff_cb)\n\t\t\terror = output->diff_cb(output, patch);\n\t}\n\n\tpatch->flags |= GIT_DIFF_PATCH_DIFFED;\n\treturn error;\n}"
  },
  {
    "function_name": "diff_binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "308-340",
    "snippet": "static int diff_binary(git_diff_output *output, git_patch *patch)\n{\n\tgit_diff_binary binary = {{0}};\n\tconst char *old_data = patch->ofile.map.data;\n\tconst char *new_data = patch->nfile.map.data;\n\tsize_t old_len = patch->ofile.map.len,\n\t\tnew_len = patch->nfile.map.len;\n\tint error;\n\n\t/* Create the old->new delta (as the \"new\" side of the patch),\n\t * and the new->old delta (as the \"old\" side)\n\t */\n\tif ((error = create_binary(&binary.old_file.type,\n\t\t\t(char **)&binary.old_file.data,\n\t\t\t&binary.old_file.datalen,\n\t\t\t&binary.old_file.inflatedlen,\n\t\t\tnew_data, new_len, old_data, old_len)) < 0 ||\n\t\t(error = create_binary(&binary.new_file.type,\n\t\t\t(char **)&binary.new_file.data,\n\t\t\t&binary.new_file.datalen,\n\t\t\t&binary.new_file.inflatedlen,\n\t\t\told_data, old_len, new_data, new_len)) < 0)\n\t\treturn error;\n\n\terror = giterr_set_after_callback_function(\n\t\toutput->binary_cb(patch->delta, &binary, output->payload),\n\t\t\"git_patch\");\n\n\tgit__free((char *) binary.old_file.data);\n\tgit__free((char *) binary.new_file.data);\n\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "(char *) binary.new_file.data"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set_after_callback_function",
          "args": [
            "output->binary_cb(patch->delta, &binary, output->payload)",
            "\"git_patch\""
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "output->binary_cb",
          "args": [
            "patch->delta",
            "&binary",
            "output->payload"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_binary",
          "args": [
            "&binary.new_file.type",
            "(char **)&binary.new_file.data",
            "&binary.new_file.datalen",
            "&binary.new_file.inflatedlen",
            "old_data",
            "old_len",
            "new_data",
            "new_len"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "create_binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "245-306",
          "snippet": "static int create_binary(\n\tgit_diff_binary_t *out_type,\n\tchar **out_data,\n\tsize_t *out_datalen,\n\tsize_t *out_inflatedlen,\n\tconst char *a_data,\n\tsize_t a_datalen,\n\tconst char *b_data,\n\tsize_t b_datalen)\n{\n\tgit_buf deflate = GIT_BUF_INIT, delta = GIT_BUF_INIT;\n\tunsigned long delta_data_len;\n\tint error;\n\n\t/* The git_delta function accepts unsigned long only */\n\tif (!git__is_ulong(a_datalen) || !git__is_ulong(b_datalen))\n\t\treturn GIT_EBUFS;\n\n\tif ((error = git_zstream_deflatebuf(&deflate, b_data, b_datalen)) < 0)\n\t\tgoto done;\n\n\t/* The git_delta function accepts unsigned long only */\n\tif (!git__is_ulong(deflate.size)) {\n\t\terror = GIT_EBUFS;\n\t\tgoto done;\n\t}\n\n\tif (a_datalen && b_datalen) {\n\t\tvoid *delta_data = git_delta(\n\t\t\ta_data, (unsigned long)a_datalen,\n\t\t\tb_data, (unsigned long)b_datalen,\n\t\t\t&delta_data_len, (unsigned long)deflate.size);\n\n\t\tif (delta_data) {\n\t\t\terror = git_zstream_deflatebuf(\n\t\t\t\t&delta, delta_data, (size_t)delta_data_len);\n\n\t\t\tgit__free(delta_data);\n\n\t\t\tif (error < 0)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (delta.size && delta.size < deflate.size) {\n\t\t*out_type = GIT_DIFF_BINARY_DELTA;\n\t\t*out_datalen = delta.size;\n\t\t*out_data = git_buf_detach(&delta);\n\t\t*out_inflatedlen = delta_data_len;\n\t} else {\n\t\t*out_type = GIT_DIFF_BINARY_LITERAL;\n\t\t*out_datalen = deflate.size;\n\t\t*out_data = git_buf_detach(&deflate);\n\t\t*out_inflatedlen = b_datalen;\n\t}\n\ndone:\n\tgit_buf_free(&deflate);\n\tgit_buf_free(&delta);\n\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int create_binary(\n\tgit_diff_binary_t *out_type,\n\tchar **out_data,\n\tsize_t *out_datalen,\n\tsize_t *out_inflatedlen,\n\tconst char *a_data,\n\tsize_t a_datalen,\n\tconst char *b_data,\n\tsize_t b_datalen)\n{\n\tgit_buf deflate = GIT_BUF_INIT, delta = GIT_BUF_INIT;\n\tunsigned long delta_data_len;\n\tint error;\n\n\t/* The git_delta function accepts unsigned long only */\n\tif (!git__is_ulong(a_datalen) || !git__is_ulong(b_datalen))\n\t\treturn GIT_EBUFS;\n\n\tif ((error = git_zstream_deflatebuf(&deflate, b_data, b_datalen)) < 0)\n\t\tgoto done;\n\n\t/* The git_delta function accepts unsigned long only */\n\tif (!git__is_ulong(deflate.size)) {\n\t\terror = GIT_EBUFS;\n\t\tgoto done;\n\t}\n\n\tif (a_datalen && b_datalen) {\n\t\tvoid *delta_data = git_delta(\n\t\t\ta_data, (unsigned long)a_datalen,\n\t\t\tb_data, (unsigned long)b_datalen,\n\t\t\t&delta_data_len, (unsigned long)deflate.size);\n\n\t\tif (delta_data) {\n\t\t\terror = git_zstream_deflatebuf(\n\t\t\t\t&delta, delta_data, (size_t)delta_data_len);\n\n\t\t\tgit__free(delta_data);\n\n\t\t\tif (error < 0)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (delta.size && delta.size < deflate.size) {\n\t\t*out_type = GIT_DIFF_BINARY_DELTA;\n\t\t*out_datalen = delta.size;\n\t\t*out_data = git_buf_detach(&delta);\n\t\t*out_inflatedlen = delta_data_len;\n\t} else {\n\t\t*out_type = GIT_DIFF_BINARY_LITERAL;\n\t\t*out_datalen = deflate.size;\n\t\t*out_data = git_buf_detach(&deflate);\n\t\t*out_inflatedlen = b_datalen;\n\t}\n\ndone:\n\tgit_buf_free(&deflate);\n\tgit_buf_free(&delta);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_binary(git_diff_output *output, git_patch *patch)\n{\n\tgit_diff_binary binary = {{0}};\n\tconst char *old_data = patch->ofile.map.data;\n\tconst char *new_data = patch->nfile.map.data;\n\tsize_t old_len = patch->ofile.map.len,\n\t\tnew_len = patch->nfile.map.len;\n\tint error;\n\n\t/* Create the old->new delta (as the \"new\" side of the patch),\n\t * and the new->old delta (as the \"old\" side)\n\t */\n\tif ((error = create_binary(&binary.old_file.type,\n\t\t\t(char **)&binary.old_file.data,\n\t\t\t&binary.old_file.datalen,\n\t\t\t&binary.old_file.inflatedlen,\n\t\t\tnew_data, new_len, old_data, old_len)) < 0 ||\n\t\t(error = create_binary(&binary.new_file.type,\n\t\t\t(char **)&binary.new_file.data,\n\t\t\t&binary.new_file.datalen,\n\t\t\t&binary.new_file.inflatedlen,\n\t\t\told_data, old_len, new_data, new_len)) < 0)\n\t\treturn error;\n\n\terror = giterr_set_after_callback_function(\n\t\toutput->binary_cb(patch->delta, &binary, output->payload),\n\t\t\"git_patch\");\n\n\tgit__free((char *) binary.old_file.data);\n\tgit__free((char *) binary.new_file.data);\n\n\treturn error;\n}"
  },
  {
    "function_name": "create_binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "245-306",
    "snippet": "static int create_binary(\n\tgit_diff_binary_t *out_type,\n\tchar **out_data,\n\tsize_t *out_datalen,\n\tsize_t *out_inflatedlen,\n\tconst char *a_data,\n\tsize_t a_datalen,\n\tconst char *b_data,\n\tsize_t b_datalen)\n{\n\tgit_buf deflate = GIT_BUF_INIT, delta = GIT_BUF_INIT;\n\tunsigned long delta_data_len;\n\tint error;\n\n\t/* The git_delta function accepts unsigned long only */\n\tif (!git__is_ulong(a_datalen) || !git__is_ulong(b_datalen))\n\t\treturn GIT_EBUFS;\n\n\tif ((error = git_zstream_deflatebuf(&deflate, b_data, b_datalen)) < 0)\n\t\tgoto done;\n\n\t/* The git_delta function accepts unsigned long only */\n\tif (!git__is_ulong(deflate.size)) {\n\t\terror = GIT_EBUFS;\n\t\tgoto done;\n\t}\n\n\tif (a_datalen && b_datalen) {\n\t\tvoid *delta_data = git_delta(\n\t\t\ta_data, (unsigned long)a_datalen,\n\t\t\tb_data, (unsigned long)b_datalen,\n\t\t\t&delta_data_len, (unsigned long)deflate.size);\n\n\t\tif (delta_data) {\n\t\t\terror = git_zstream_deflatebuf(\n\t\t\t\t&delta, delta_data, (size_t)delta_data_len);\n\n\t\t\tgit__free(delta_data);\n\n\t\t\tif (error < 0)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (delta.size && delta.size < deflate.size) {\n\t\t*out_type = GIT_DIFF_BINARY_DELTA;\n\t\t*out_datalen = delta.size;\n\t\t*out_data = git_buf_detach(&delta);\n\t\t*out_inflatedlen = delta_data_len;\n\t} else {\n\t\t*out_type = GIT_DIFF_BINARY_LITERAL;\n\t\t*out_datalen = deflate.size;\n\t\t*out_data = git_buf_detach(&deflate);\n\t\t*out_inflatedlen = b_datalen;\n\t}\n\ndone:\n\tgit_buf_free(&deflate);\n\tgit_buf_free(&delta);\n\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&delta"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&deflate"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "delta_data"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_zstream_deflatebuf",
          "args": [
            "&delta",
            "delta_data",
            "(size_t)delta_data_len"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "git_zstream_deflatebuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/zstream.c",
          "lines": "123-156",
          "snippet": "int git_zstream_deflatebuf(git_buf *out, const void *in, size_t in_len)\n{\n\tgit_zstream zs = GIT_ZSTREAM_INIT;\n\tint error = 0;\n\n\tif ((error = git_zstream_init(&zs)) < 0)\n\t\treturn error;\n\n\tif ((error = git_zstream_set_input(&zs, in, in_len)) < 0)\n\t\tgoto done;\n\n\twhile (!git_zstream_done(&zs)) {\n\t\tsize_t step = git_zstream_suggest_output_len(&zs), written;\n\n\t\tif ((error = git_buf_grow_by(out, step)) < 0)\n\t\t\tgoto done;\n\n\t\twritten = out->asize - out->size;\n\n\t\tif ((error = git_zstream_get_output(\n\t\t\t\tout->ptr + out->size, &written, &zs)) < 0)\n\t\t\tgoto done;\n\n\t\tout->size += written;\n\t}\n\n\t/* NULL terminate for consistency if possible */\n\tif (out->size < out->asize)\n\t\tout->ptr[out->size] = '\\0';\n\ndone:\n\tgit_zstream_free(&zs);\n\treturn error;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"zstream.h\"",
            "#include <zlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"zstream.h\"\n#include <zlib.h>\n\nint git_zstream_deflatebuf(git_buf *out, const void *in, size_t in_len)\n{\n\tgit_zstream zs = GIT_ZSTREAM_INIT;\n\tint error = 0;\n\n\tif ((error = git_zstream_init(&zs)) < 0)\n\t\treturn error;\n\n\tif ((error = git_zstream_set_input(&zs, in, in_len)) < 0)\n\t\tgoto done;\n\n\twhile (!git_zstream_done(&zs)) {\n\t\tsize_t step = git_zstream_suggest_output_len(&zs), written;\n\n\t\tif ((error = git_buf_grow_by(out, step)) < 0)\n\t\t\tgoto done;\n\n\t\twritten = out->asize - out->size;\n\n\t\tif ((error = git_zstream_get_output(\n\t\t\t\tout->ptr + out->size, &written, &zs)) < 0)\n\t\t\tgoto done;\n\n\t\tout->size += written;\n\t}\n\n\t/* NULL terminate for consistency if possible */\n\tif (out->size < out->asize)\n\t\tout->ptr[out->size] = '\\0';\n\ndone:\n\tgit_zstream_free(&zs);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_delta",
          "args": [
            "a_data",
            "(unsigned long)a_datalen",
            "b_data",
            "(unsigned long)b_datalen",
            "&delta_data_len",
            "(unsigned long)deflate.size"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "git_delta",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/delta.h",
          "lines": "64-78",
          "snippet": "GIT_INLINE(void *) git_delta(\n\tconst void *src_buf, unsigned long src_bufsize,\n\tconst void *trg_buf, unsigned long trg_bufsize,\n\tunsigned long *delta_size,\n\tunsigned long max_delta_size)\n{\n\tstruct git_delta_index *index = git_delta_create_index(src_buf, src_bufsize);\n\tif (index) {\n\t\tvoid *delta = git_delta_create(\n\t\t\tindex, trg_buf, trg_bufsize, delta_size, max_delta_size);\n\t\tgit_delta_free_index(index);\n\t\treturn delta;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_delta(\n\tconst void *src_buf, unsigned long src_bufsize,\n\tconst void *trg_buf, unsigned long trg_bufsize,\n\tunsigned long *delta_size,\n\tunsigned long max_delta_size)\n{\n\tstruct git_delta_index *index = git_delta_create_index(src_buf, src_bufsize);\n\tif (index) {\n\t\tvoid *delta = git_delta_create(\n\t\t\tindex, trg_buf, trg_bufsize, delta_size, max_delta_size);\n\t\tgit_delta_free_index(index);\n\t\treturn delta;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__is_ulong",
          "args": [
            "deflate.size"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "git__is_ulong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/integer.h",
          "lines": "32-36",
          "snippet": "GIT_INLINE(int) git__is_ulong(git_off_t p)\n{\n\tunsigned long r = (unsigned long)p;\n\treturn p == (git_off_t)r;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "GIT_INLINE(int) git__is_ulong(git_off_t p)\n{\n\tunsigned long r = (unsigned long)p;\n\treturn p == (git_off_t)r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int create_binary(\n\tgit_diff_binary_t *out_type,\n\tchar **out_data,\n\tsize_t *out_datalen,\n\tsize_t *out_inflatedlen,\n\tconst char *a_data,\n\tsize_t a_datalen,\n\tconst char *b_data,\n\tsize_t b_datalen)\n{\n\tgit_buf deflate = GIT_BUF_INIT, delta = GIT_BUF_INIT;\n\tunsigned long delta_data_len;\n\tint error;\n\n\t/* The git_delta function accepts unsigned long only */\n\tif (!git__is_ulong(a_datalen) || !git__is_ulong(b_datalen))\n\t\treturn GIT_EBUFS;\n\n\tif ((error = git_zstream_deflatebuf(&deflate, b_data, b_datalen)) < 0)\n\t\tgoto done;\n\n\t/* The git_delta function accepts unsigned long only */\n\tif (!git__is_ulong(deflate.size)) {\n\t\terror = GIT_EBUFS;\n\t\tgoto done;\n\t}\n\n\tif (a_datalen && b_datalen) {\n\t\tvoid *delta_data = git_delta(\n\t\t\ta_data, (unsigned long)a_datalen,\n\t\t\tb_data, (unsigned long)b_datalen,\n\t\t\t&delta_data_len, (unsigned long)deflate.size);\n\n\t\tif (delta_data) {\n\t\t\terror = git_zstream_deflatebuf(\n\t\t\t\t&delta, delta_data, (size_t)delta_data_len);\n\n\t\t\tgit__free(delta_data);\n\n\t\t\tif (error < 0)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\tif (delta.size && delta.size < deflate.size) {\n\t\t*out_type = GIT_DIFF_BINARY_DELTA;\n\t\t*out_datalen = delta.size;\n\t\t*out_data = git_buf_detach(&delta);\n\t\t*out_inflatedlen = delta_data_len;\n\t} else {\n\t\t*out_type = GIT_DIFF_BINARY_LITERAL;\n\t\t*out_datalen = deflate.size;\n\t\t*out_data = git_buf_detach(&deflate);\n\t\t*out_inflatedlen = b_datalen;\n\t}\n\ndone:\n\tgit_buf_free(&deflate);\n\tgit_buf_free(&delta);\n\n\treturn error;\n}"
  },
  {
    "function_name": "diff_patch_invoke_file_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "231-243",
    "snippet": "static int diff_patch_invoke_file_callback(\n\tgit_patch *patch, git_diff_output *output)\n{\n\tfloat progress = patch->diff ?\n\t\t((float)patch->delta_index / patch->diff->deltas.length) : 1.0f;\n\n\tif (!output->file_cb)\n\t\treturn 0;\n\n\treturn giterr_set_after_callback_function(\n\t\toutput->file_cb(patch->delta, progress, output->payload),\n\t\t\"git_patch\");\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set_after_callback_function",
          "args": [
            "output->file_cb(patch->delta, progress, output->payload)",
            "\"git_patch\""
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "output->file_cb",
          "args": [
            "patch->delta",
            "progress",
            "output->payload"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_invoke_file_callback(\n\tgit_patch *patch, git_diff_output *output)\n{\n\tfloat progress = patch->diff ?\n\t\t((float)patch->delta_index / patch->diff->deltas.length) : 1.0f;\n\n\tif (!output->file_cb)\n\t\treturn 0;\n\n\treturn giterr_set_after_callback_function(\n\t\toutput->file_cb(patch->delta, progress, output->payload),\n\t\t\"git_patch\");\n}"
  },
  {
    "function_name": "diff_patch_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "157-229",
    "snippet": "static int diff_patch_load(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\tbool incomplete_data;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) != 0)\n\t\treturn 0;\n\n\t/* if no hunk and data callbacks and user doesn't care if data looks\n\t * binary, then there is no need to actually load the data\n\t */\n\tif ((patch->ofile.opts_flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0 &&\n\t\toutput && !output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tincomplete_data =\n\t\t(((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->ofile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0) &&\n\t\t ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->nfile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0));\n\n\t/* always try to load workdir content first because filtering may\n\t * need 2x data size and this minimizes peak memory footprint\n\t */\n\tif (patch->ofile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* once workdir has been tried, load other data as needed */\n\tif (patch->ofile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* if previously missing an oid, and now that we have it the two sides\n\t * are the same (and not submodules), update MODIFIED -> UNMODIFIED\n\t */\n\tif (incomplete_data &&\n\t\tpatch->ofile.file->mode == patch->nfile.file->mode &&\n\t\tpatch->ofile.file->mode != GIT_FILEMODE_COMMIT &&\n\t\tgit_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id) &&\n\t\tpatch->delta->status == GIT_DELTA_MODIFIED) /* not RENAMED/COPIED! */\n\t\tpatch->delta->status = GIT_DELTA_UNMODIFIED;\n\ncleanup:\n\tdiff_patch_update_binary(patch);\n\n\tif (!error) {\n\t\tif (diff_patch_diffable(patch))\n\t\t\tpatch->flags |= GIT_DIFF_PATCH_DIFFABLE;\n\n\t\tpatch->flags |= GIT_DIFF_PATCH_LOADED;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_patch_diffable",
          "args": [
            "patch"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_diffable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "128-155",
          "snippet": "static bool diff_patch_diffable(git_patch *patch)\n{\n\tsize_t olen, nlen;\n\n\tif (patch->delta->status == GIT_DELTA_UNMODIFIED)\n\t\treturn false;\n\n\t/* if we've determined this to be binary (and we are not showing binary\n\t * data) then we have skipped loading the map data.  instead, query the\n\t * file data itself.\n\t */\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0 &&\n\t\t(patch->diff_opts.flags & GIT_DIFF_SHOW_BINARY) == 0) {\n\t\tolen = (size_t)patch->ofile.file->size;\n\t\tnlen = (size_t)patch->nfile.file->size;\n\t} else {\n\t\tolen = patch->ofile.map.len;\n\t\tnlen = patch->nfile.map.len;\n\t}\n\n\t/* if both sides are empty, files are identical */\n\tif (!olen && !nlen)\n\t\treturn false;\n\n\t/* otherwise, check the file sizes and the oid */\n\treturn (olen != nlen ||\n\t\t!git_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id));\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic bool diff_patch_diffable(git_patch *patch)\n{\n\tsize_t olen, nlen;\n\n\tif (patch->delta->status == GIT_DELTA_UNMODIFIED)\n\t\treturn false;\n\n\t/* if we've determined this to be binary (and we are not showing binary\n\t * data) then we have skipped loading the map data.  instead, query the\n\t * file data itself.\n\t */\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0 &&\n\t\t(patch->diff_opts.flags & GIT_DIFF_SHOW_BINARY) == 0) {\n\t\tolen = (size_t)patch->ofile.file->size;\n\t\tnlen = (size_t)patch->nfile.file->size;\n\t} else {\n\t\tolen = patch->ofile.map.len;\n\t\tnlen = patch->nfile.map.len;\n\t}\n\n\t/* if both sides are empty, files are identical */\n\tif (!olen && !nlen)\n\t\treturn false;\n\n\t/* otherwise, check the file sizes and the oid */\n\treturn (olen != nlen ||\n\t\t!git_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_update_binary",
          "args": [
            "patch"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_update_binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "24-40",
          "snippet": "static void diff_patch_update_binary(git_patch *patch)\n{\n\tif ((patch->delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0)\n\t\treturn;\n\n\tif ((patch->ofile.file->flags & GIT_DIFF_FLAG_BINARY) != 0 ||\n\t\t(patch->nfile.file->flags & GIT_DIFF_FLAG_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if (patch->ofile.file->size > GIT_XDIFF_MAX_SIZE ||\n\t\t\t patch->nfile.file->size > GIT_XDIFF_MAX_SIZE)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if ((patch->ofile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0 &&\n\t\t\t (patch->nfile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_NOT_BINARY;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_patch_update_binary(git_patch *patch)\n{\n\tif ((patch->delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0)\n\t\treturn;\n\n\tif ((patch->ofile.file->flags & GIT_DIFF_FLAG_BINARY) != 0 ||\n\t\t(patch->nfile.file->flags & GIT_DIFF_FLAG_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if (patch->ofile.file->size > GIT_XDIFF_MAX_SIZE ||\n\t\t\t patch->nfile.file->size > GIT_XDIFF_MAX_SIZE)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if ((patch->ofile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0 &&\n\t\t\t (patch->nfile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_NOT_BINARY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_equal",
          "args": [
            "&patch->ofile.file->id",
            "&patch->nfile.file->id"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "184-187",
          "snippet": "int git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "should_skip_binary",
          "args": [
            "patch",
            "patch->nfile.file"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "should_skip_binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "120-126",
          "snippet": "GIT_INLINE(bool) should_skip_binary(git_patch *patch, git_diff_file *file)\n{\n\tif ((patch->diff_opts.flags & GIT_DIFF_SHOW_BINARY) != 0)\n\t\treturn false;\n\n\treturn (file->flags & GIT_DIFF_FLAG_BINARY) != 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nGIT_INLINE(bool) should_skip_binary(git_patch *patch, git_diff_file *file)\n{\n\tif ((patch->diff_opts.flags & GIT_DIFF_SHOW_BINARY) != 0)\n\t\treturn false;\n\n\treturn (file->flags & GIT_DIFF_FLAG_BINARY) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_file_content__load",
          "args": [
            "&patch->nfile",
            "&patch->diff_opts"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_file_content__load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_file.c",
          "lines": "405-430",
          "snippet": "int git_diff_file_content__load(\n\tgit_diff_file_content *fc,\n\tgit_diff_options *diff_opts)\n{\n\tint error = 0;\n\n\tif ((fc->flags & GIT_DIFF_FLAG__LOADED) != 0)\n\t\treturn 0;\n\n\tif ((fc->file->flags & GIT_DIFF_FLAG_BINARY) != 0 &&\n\t\t(diff_opts->flags & GIT_DIFF_SHOW_BINARY) == 0)\n\t\treturn 0;\n\n\tif (fc->src == GIT_ITERATOR_TYPE_WORKDIR)\n\t\terror = diff_file_content_load_workdir(fc, diff_opts);\n\telse\n\t\terror = diff_file_content_load_blob(fc, diff_opts);\n\tif (error)\n\t\treturn error;\n\n\tfc->flags |= GIT_DIFF_FLAG__LOADED;\n\n\tdiff_file_content_binary_by_content(fc);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"fileops.h\"",
            "#include \"odb.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/submodule.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"fileops.h\"\n#include \"odb.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/submodule.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nint git_diff_file_content__load(\n\tgit_diff_file_content *fc,\n\tgit_diff_options *diff_opts)\n{\n\tint error = 0;\n\n\tif ((fc->flags & GIT_DIFF_FLAG__LOADED) != 0)\n\t\treturn 0;\n\n\tif ((fc->file->flags & GIT_DIFF_FLAG_BINARY) != 0 &&\n\t\t(diff_opts->flags & GIT_DIFF_SHOW_BINARY) == 0)\n\t\treturn 0;\n\n\tif (fc->src == GIT_ITERATOR_TYPE_WORKDIR)\n\t\terror = diff_file_content_load_workdir(fc, diff_opts);\n\telse\n\t\terror = diff_file_content_load_blob(fc, diff_opts);\n\tif (error)\n\t\treturn error;\n\n\tfc->flags |= GIT_DIFF_FLAG__LOADED;\n\n\tdiff_file_content_binary_by_content(fc);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_load(git_patch *patch, git_diff_output *output)\n{\n\tint error = 0;\n\tbool incomplete_data;\n\n\tif ((patch->flags & GIT_DIFF_PATCH_LOADED) != 0)\n\t\treturn 0;\n\n\t/* if no hunk and data callbacks and user doesn't care if data looks\n\t * binary, then there is no need to actually load the data\n\t */\n\tif ((patch->ofile.opts_flags & GIT_DIFF_SKIP_BINARY_CHECK) != 0 &&\n\t\toutput && !output->binary_cb && !output->hunk_cb && !output->data_cb)\n\t\treturn 0;\n\n\tincomplete_data =\n\t\t(((patch->ofile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->ofile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0) &&\n\t\t ((patch->nfile.flags & GIT_DIFF_FLAG__NO_DATA) != 0 ||\n\t\t  (patch->nfile.file->flags & GIT_DIFF_FLAG_VALID_ID) != 0));\n\n\t/* always try to load workdir content first because filtering may\n\t * need 2x data size and this minimizes peak memory footprint\n\t */\n\tif (patch->ofile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src == GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* once workdir has been tried, load other data as needed */\n\tif (patch->ofile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->ofile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->ofile.file))\n\t\t\tgoto cleanup;\n\t}\n\tif (patch->nfile.src != GIT_ITERATOR_TYPE_WORKDIR) {\n\t\tif ((error = git_diff_file_content__load(\n\t\t\t\t&patch->nfile, &patch->diff_opts)) < 0 ||\n\t\t\tshould_skip_binary(patch, patch->nfile.file))\n\t\t\tgoto cleanup;\n\t}\n\n\t/* if previously missing an oid, and now that we have it the two sides\n\t * are the same (and not submodules), update MODIFIED -> UNMODIFIED\n\t */\n\tif (incomplete_data &&\n\t\tpatch->ofile.file->mode == patch->nfile.file->mode &&\n\t\tpatch->ofile.file->mode != GIT_FILEMODE_COMMIT &&\n\t\tgit_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id) &&\n\t\tpatch->delta->status == GIT_DELTA_MODIFIED) /* not RENAMED/COPIED! */\n\t\tpatch->delta->status = GIT_DELTA_UNMODIFIED;\n\ncleanup:\n\tdiff_patch_update_binary(patch);\n\n\tif (!error) {\n\t\tif (diff_patch_diffable(patch))\n\t\t\tpatch->flags |= GIT_DIFF_PATCH_DIFFABLE;\n\n\t\tpatch->flags |= GIT_DIFF_PATCH_LOADED;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "diff_patch_diffable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "128-155",
    "snippet": "static bool diff_patch_diffable(git_patch *patch)\n{\n\tsize_t olen, nlen;\n\n\tif (patch->delta->status == GIT_DELTA_UNMODIFIED)\n\t\treturn false;\n\n\t/* if we've determined this to be binary (and we are not showing binary\n\t * data) then we have skipped loading the map data.  instead, query the\n\t * file data itself.\n\t */\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0 &&\n\t\t(patch->diff_opts.flags & GIT_DIFF_SHOW_BINARY) == 0) {\n\t\tolen = (size_t)patch->ofile.file->size;\n\t\tnlen = (size_t)patch->nfile.file->size;\n\t} else {\n\t\tolen = patch->ofile.map.len;\n\t\tnlen = patch->nfile.map.len;\n\t}\n\n\t/* if both sides are empty, files are identical */\n\tif (!olen && !nlen)\n\t\treturn false;\n\n\t/* otherwise, check the file sizes and the oid */\n\treturn (olen != nlen ||\n\t\t!git_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id));\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oid_equal",
          "args": [
            "&patch->ofile.file->id",
            "&patch->nfile.file->id"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "184-187",
          "snippet": "int git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_equal(const git_oid *a, const git_oid *b)\n{\n\treturn (git_oid__cmp(a, b) == 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic bool diff_patch_diffable(git_patch *patch)\n{\n\tsize_t olen, nlen;\n\n\tif (patch->delta->status == GIT_DELTA_UNMODIFIED)\n\t\treturn false;\n\n\t/* if we've determined this to be binary (and we are not showing binary\n\t * data) then we have skipped loading the map data.  instead, query the\n\t * file data itself.\n\t */\n\tif ((patch->delta->flags & GIT_DIFF_FLAG_BINARY) != 0 &&\n\t\t(patch->diff_opts.flags & GIT_DIFF_SHOW_BINARY) == 0) {\n\t\tolen = (size_t)patch->ofile.file->size;\n\t\tnlen = (size_t)patch->nfile.file->size;\n\t} else {\n\t\tolen = patch->ofile.map.len;\n\t\tnlen = patch->nfile.map.len;\n\t}\n\n\t/* if both sides are empty, files are identical */\n\tif (!olen && !nlen)\n\t\treturn false;\n\n\t/* otherwise, check the file sizes and the oid */\n\treturn (olen != nlen ||\n\t\t!git_oid_equal(&patch->ofile.file->id, &patch->nfile.file->id));\n}"
  },
  {
    "function_name": "should_skip_binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "120-126",
    "snippet": "GIT_INLINE(bool) should_skip_binary(git_patch *patch, git_diff_file *file)\n{\n\tif ((patch->diff_opts.flags & GIT_DIFF_SHOW_BINARY) != 0)\n\t\treturn false;\n\n\treturn (file->flags & GIT_DIFF_FLAG_BINARY) != 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nGIT_INLINE(bool) should_skip_binary(git_patch *patch, git_diff_file *file)\n{\n\tif ((patch->diff_opts.flags & GIT_DIFF_SHOW_BINARY) != 0)\n\t\treturn false;\n\n\treturn (file->flags & GIT_DIFF_FLAG_BINARY) != 0;\n}"
  },
  {
    "function_name": "diff_patch_alloc_from_diff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "101-118",
    "snippet": "static int diff_patch_alloc_from_diff(\n\tgit_patch **out, git_diff *diff, size_t delta_index)\n{\n\tint error;\n\tgit_patch *patch = git__calloc(1, sizeof(git_patch));\n\tGITERR_CHECK_ALLOC(patch);\n\n\tif (!(error = diff_patch_init_from_diff(patch, diff, delta_index))) {\n\t\tpatch->flags |= GIT_DIFF_PATCH_ALLOCATED;\n\t\tGIT_REFCOUNT_INC(patch);\n\t} else {\n\t\tgit__free(patch);\n\t\tpatch = NULL;\n\t}\n\n\t*out = patch;\n\treturn error;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "patch"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "patch"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diff_patch_init_from_diff",
          "args": [
            "patch",
            "diff",
            "delta_index"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_init_from_diff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "78-99",
          "snippet": "static int diff_patch_init_from_diff(\n\tgit_patch *patch, git_diff *diff, size_t delta_index)\n{\n\tint error = 0;\n\n\tmemset(patch, 0, sizeof(*patch));\n\tpatch->diff  = diff;\n\tpatch->delta = git_vector_get(&diff->deltas, delta_index);\n\tpatch->delta_index = delta_index;\n\n\tif ((error = diff_patch_normalize_options(\n\t\t\t&patch->diff_opts, &diff->opts)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->ofile, diff, patch->delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->nfile, diff, patch->delta, false)) < 0)\n\t\treturn error;\n\n\tdiff_patch_init_common(patch);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_init_from_diff(\n\tgit_patch *patch, git_diff *diff, size_t delta_index)\n{\n\tint error = 0;\n\n\tmemset(patch, 0, sizeof(*patch));\n\tpatch->diff  = diff;\n\tpatch->delta = git_vector_get(&diff->deltas, delta_index);\n\tpatch->delta_index = delta_index;\n\n\tif ((error = diff_patch_normalize_options(\n\t\t\t&patch->diff_opts, &diff->opts)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->ofile, diff, patch->delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->nfile, diff, patch->delta, false)) < 0)\n\t\treturn error;\n\n\tdiff_patch_init_common(patch);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "patch"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_patch)"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_alloc_from_diff(\n\tgit_patch **out, git_diff *diff, size_t delta_index)\n{\n\tint error;\n\tgit_patch *patch = git__calloc(1, sizeof(git_patch));\n\tGITERR_CHECK_ALLOC(patch);\n\n\tif (!(error = diff_patch_init_from_diff(patch, diff, delta_index))) {\n\t\tpatch->flags |= GIT_DIFF_PATCH_ALLOCATED;\n\t\tGIT_REFCOUNT_INC(patch);\n\t} else {\n\t\tgit__free(patch);\n\t\tpatch = NULL;\n\t}\n\n\t*out = patch;\n\treturn error;\n}"
  },
  {
    "function_name": "diff_patch_init_from_diff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "78-99",
    "snippet": "static int diff_patch_init_from_diff(\n\tgit_patch *patch, git_diff *diff, size_t delta_index)\n{\n\tint error = 0;\n\n\tmemset(patch, 0, sizeof(*patch));\n\tpatch->diff  = diff;\n\tpatch->delta = git_vector_get(&diff->deltas, delta_index);\n\tpatch->delta_index = delta_index;\n\n\tif ((error = diff_patch_normalize_options(\n\t\t\t&patch->diff_opts, &diff->opts)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->ofile, diff, patch->delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->nfile, diff, patch->delta, false)) < 0)\n\t\treturn error;\n\n\tdiff_patch_init_common(patch);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "diff_patch_init_common",
          "args": [
            "patch"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_init_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "42-50",
          "snippet": "static void diff_patch_init_common(git_patch *patch)\n{\n\tdiff_patch_update_binary(patch);\n\n\tpatch->flags |= GIT_DIFF_PATCH_INITIALIZED;\n\n\tif (patch->diff)\n\t\tgit_diff_addref(patch->diff);\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_patch_init_common(git_patch *patch)\n{\n\tdiff_patch_update_binary(patch);\n\n\tpatch->flags |= GIT_DIFF_PATCH_INITIALIZED;\n\n\tif (patch->diff)\n\t\tgit_diff_addref(patch->diff);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_file_content__init_from_diff",
          "args": [
            "&patch->nfile",
            "diff",
            "patch->delta",
            "false"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_file_content__init_from_diff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_file.c",
          "lines": "89-128",
          "snippet": "int git_diff_file_content__init_from_diff(\n\tgit_diff_file_content *fc,\n\tgit_diff *diff,\n\tgit_diff_delta *delta,\n\tbool use_old)\n{\n\tbool has_data = true;\n\n\tmemset(fc, 0, sizeof(*fc));\n\tfc->repo = diff->repo;\n\tfc->file = use_old ? &delta->old_file : &delta->new_file;\n\tfc->src  = use_old ? diff->old_src : diff->new_src;\n\n\tif (git_diff_driver_lookup(&fc->driver, fc->repo, fc->file->path) < 0)\n\t\treturn -1;\n\n\tswitch (delta->status) {\n\tcase GIT_DELTA_ADDED:\n\t\thas_data = !use_old; break;\n\tcase GIT_DELTA_DELETED:\n\t\thas_data = use_old; break;\n\tcase GIT_DELTA_UNTRACKED:\n\t\thas_data = !use_old &&\n\t\t\t(diff->opts.flags & GIT_DIFF_SHOW_UNTRACKED_CONTENT) != 0;\n\t\tbreak;\n\tcase GIT_DELTA_UNREADABLE:\n\tcase GIT_DELTA_MODIFIED:\n\tcase GIT_DELTA_COPIED:\n\tcase GIT_DELTA_RENAMED:\n\t\tbreak;\n\tdefault:\n\t\thas_data = false;\n\t\tbreak;\n\t}\n\n\tif (!has_data)\n\t\tfc->flags |= GIT_DIFF_FLAG__NO_DATA;\n\n\treturn diff_file_content_init_common(fc, &diff->opts);\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"fileops.h\"",
            "#include \"odb.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/submodule.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"fileops.h\"\n#include \"odb.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/submodule.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nint git_diff_file_content__init_from_diff(\n\tgit_diff_file_content *fc,\n\tgit_diff *diff,\n\tgit_diff_delta *delta,\n\tbool use_old)\n{\n\tbool has_data = true;\n\n\tmemset(fc, 0, sizeof(*fc));\n\tfc->repo = diff->repo;\n\tfc->file = use_old ? &delta->old_file : &delta->new_file;\n\tfc->src  = use_old ? diff->old_src : diff->new_src;\n\n\tif (git_diff_driver_lookup(&fc->driver, fc->repo, fc->file->path) < 0)\n\t\treturn -1;\n\n\tswitch (delta->status) {\n\tcase GIT_DELTA_ADDED:\n\t\thas_data = !use_old; break;\n\tcase GIT_DELTA_DELETED:\n\t\thas_data = use_old; break;\n\tcase GIT_DELTA_UNTRACKED:\n\t\thas_data = !use_old &&\n\t\t\t(diff->opts.flags & GIT_DIFF_SHOW_UNTRACKED_CONTENT) != 0;\n\t\tbreak;\n\tcase GIT_DELTA_UNREADABLE:\n\tcase GIT_DELTA_MODIFIED:\n\tcase GIT_DELTA_COPIED:\n\tcase GIT_DELTA_RENAMED:\n\t\tbreak;\n\tdefault:\n\t\thas_data = false;\n\t\tbreak;\n\t}\n\n\tif (!has_data)\n\t\tfc->flags |= GIT_DIFF_FLAG__NO_DATA;\n\n\treturn diff_file_content_init_common(fc, &diff->opts);\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_normalize_options",
          "args": [
            "&patch->diff_opts",
            "&diff->opts"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_normalize_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "52-76",
          "snippet": "static int diff_patch_normalize_options(\n\tgit_diff_options *out,\n\tconst git_diff_options *opts)\n{\n\tif (opts) {\n\t\tGITERR_CHECK_VERSION(opts, GIT_DIFF_OPTIONS_VERSION, \"git_diff_options\");\n\t\tmemcpy(out, opts, sizeof(git_diff_options));\n\t} else {\n\t\tgit_diff_options default_opts = GIT_DIFF_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_diff_options));\n\t}\n\n\tout->old_prefix = opts && opts->old_prefix ?\n\t\tgit__strdup(opts->old_prefix) :\n\t\tgit__strdup(DIFF_OLD_PREFIX_DEFAULT);\n\n\tout->new_prefix = opts && opts->new_prefix ?\n\t\tgit__strdup(opts->new_prefix) :\n\t\tgit__strdup(DIFF_NEW_PREFIX_DEFAULT);\n\n\tGITERR_CHECK_ALLOC(out->old_prefix);\n\tGITERR_CHECK_ALLOC(out->new_prefix);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_normalize_options(\n\tgit_diff_options *out,\n\tconst git_diff_options *opts)\n{\n\tif (opts) {\n\t\tGITERR_CHECK_VERSION(opts, GIT_DIFF_OPTIONS_VERSION, \"git_diff_options\");\n\t\tmemcpy(out, opts, sizeof(git_diff_options));\n\t} else {\n\t\tgit_diff_options default_opts = GIT_DIFF_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_diff_options));\n\t}\n\n\tout->old_prefix = opts && opts->old_prefix ?\n\t\tgit__strdup(opts->old_prefix) :\n\t\tgit__strdup(DIFF_OLD_PREFIX_DEFAULT);\n\n\tout->new_prefix = opts && opts->new_prefix ?\n\t\tgit__strdup(opts->new_prefix) :\n\t\tgit__strdup(DIFF_NEW_PREFIX_DEFAULT);\n\n\tGITERR_CHECK_ALLOC(out->old_prefix);\n\tGITERR_CHECK_ALLOC(out->new_prefix);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "&diff->deltas",
            "delta_index"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "patch",
            "0",
            "sizeof(*patch)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic int diff_patch_init_from_diff(\n\tgit_patch *patch, git_diff *diff, size_t delta_index)\n{\n\tint error = 0;\n\n\tmemset(patch, 0, sizeof(*patch));\n\tpatch->diff  = diff;\n\tpatch->delta = git_vector_get(&diff->deltas, delta_index);\n\tpatch->delta_index = delta_index;\n\n\tif ((error = diff_patch_normalize_options(\n\t\t\t&patch->diff_opts, &diff->opts)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->ofile, diff, patch->delta, true)) < 0 ||\n\t\t(error = git_diff_file_content__init_from_diff(\n\t\t\t&patch->nfile, diff, patch->delta, false)) < 0)\n\t\treturn error;\n\n\tdiff_patch_init_common(patch);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "diff_patch_normalize_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "52-76",
    "snippet": "static int diff_patch_normalize_options(\n\tgit_diff_options *out,\n\tconst git_diff_options *opts)\n{\n\tif (opts) {\n\t\tGITERR_CHECK_VERSION(opts, GIT_DIFF_OPTIONS_VERSION, \"git_diff_options\");\n\t\tmemcpy(out, opts, sizeof(git_diff_options));\n\t} else {\n\t\tgit_diff_options default_opts = GIT_DIFF_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_diff_options));\n\t}\n\n\tout->old_prefix = opts && opts->old_prefix ?\n\t\tgit__strdup(opts->old_prefix) :\n\t\tgit__strdup(DIFF_OLD_PREFIX_DEFAULT);\n\n\tout->new_prefix = opts && opts->new_prefix ?\n\t\tgit__strdup(opts->new_prefix) :\n\t\tgit__strdup(DIFF_NEW_PREFIX_DEFAULT);\n\n\tGITERR_CHECK_ALLOC(out->old_prefix);\n\tGITERR_CHECK_ALLOC(out->new_prefix);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "out->new_prefix"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "out->old_prefix"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "DIFF_NEW_PREFIX_DEFAULT"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out",
            "&default_opts",
            "sizeof(git_diff_options)"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out",
            "opts",
            "sizeof(git_diff_options)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_VERSION",
          "args": [
            "opts",
            "GIT_DIFF_OPTIONS_VERSION",
            "\"git_diff_options\""
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic int diff_patch_normalize_options(\n\tgit_diff_options *out,\n\tconst git_diff_options *opts)\n{\n\tif (opts) {\n\t\tGITERR_CHECK_VERSION(opts, GIT_DIFF_OPTIONS_VERSION, \"git_diff_options\");\n\t\tmemcpy(out, opts, sizeof(git_diff_options));\n\t} else {\n\t\tgit_diff_options default_opts = GIT_DIFF_OPTIONS_INIT;\n\t\tmemcpy(out, &default_opts, sizeof(git_diff_options));\n\t}\n\n\tout->old_prefix = opts && opts->old_prefix ?\n\t\tgit__strdup(opts->old_prefix) :\n\t\tgit__strdup(DIFF_OLD_PREFIX_DEFAULT);\n\n\tout->new_prefix = opts && opts->new_prefix ?\n\t\tgit__strdup(opts->new_prefix) :\n\t\tgit__strdup(DIFF_NEW_PREFIX_DEFAULT);\n\n\tGITERR_CHECK_ALLOC(out->old_prefix);\n\tGITERR_CHECK_ALLOC(out->new_prefix);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "diff_patch_init_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "42-50",
    "snippet": "static void diff_patch_init_common(git_patch *patch)\n{\n\tdiff_patch_update_binary(patch);\n\n\tpatch->flags |= GIT_DIFF_PATCH_INITIALIZED;\n\n\tif (patch->diff)\n\t\tgit_diff_addref(patch->diff);\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_diff_addref",
          "args": [
            "patch->diff"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_addref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff.c",
          "lines": "584-587",
          "snippet": "void git_diff_addref(git_diff *diff)\n{\n\tGIT_REFCOUNT_INC(diff);\n}",
          "includes": [
            "#include \"submodule.h\"",
            "#include \"odb.h\"",
            "#include \"index.h\"",
            "#include \"pathspec.h\"",
            "#include \"filter.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"fileops.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"submodule.h\"\n#include \"odb.h\"\n#include \"index.h\"\n#include \"pathspec.h\"\n#include \"filter.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"fileops.h\"\n#include \"diff.h\"\n#include \"common.h\"\n\nvoid git_diff_addref(git_diff *diff)\n{\n\tGIT_REFCOUNT_INC(diff);\n}"
        }
      },
      {
        "call_info": {
          "callee": "diff_patch_update_binary",
          "args": [
            "patch"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "diff_patch_update_binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "24-40",
          "snippet": "static void diff_patch_update_binary(git_patch *patch)\n{\n\tif ((patch->delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0)\n\t\treturn;\n\n\tif ((patch->ofile.file->flags & GIT_DIFF_FLAG_BINARY) != 0 ||\n\t\t(patch->nfile.file->flags & GIT_DIFF_FLAG_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if (patch->ofile.file->size > GIT_XDIFF_MAX_SIZE ||\n\t\t\t patch->nfile.file->size > GIT_XDIFF_MAX_SIZE)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if ((patch->ofile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0 &&\n\t\t\t (patch->nfile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_NOT_BINARY;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_patch_update_binary(git_patch *patch)\n{\n\tif ((patch->delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0)\n\t\treturn;\n\n\tif ((patch->ofile.file->flags & GIT_DIFF_FLAG_BINARY) != 0 ||\n\t\t(patch->nfile.file->flags & GIT_DIFF_FLAG_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if (patch->ofile.file->size > GIT_XDIFF_MAX_SIZE ||\n\t\t\t patch->nfile.file->size > GIT_XDIFF_MAX_SIZE)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if ((patch->ofile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0 &&\n\t\t\t (patch->nfile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_NOT_BINARY;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_patch_init_common(git_patch *patch)\n{\n\tdiff_patch_update_binary(patch);\n\n\tpatch->flags |= GIT_DIFF_PATCH_INITIALIZED;\n\n\tif (patch->diff)\n\t\tgit_diff_addref(patch->diff);\n}"
  },
  {
    "function_name": "diff_patch_update_binary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
    "lines": "24-40",
    "snippet": "static void diff_patch_update_binary(git_patch *patch)\n{\n\tif ((patch->delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0)\n\t\treturn;\n\n\tif ((patch->ofile.file->flags & GIT_DIFF_FLAG_BINARY) != 0 ||\n\t\t(patch->nfile.file->flags & GIT_DIFF_FLAG_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if (patch->ofile.file->size > GIT_XDIFF_MAX_SIZE ||\n\t\t\t patch->nfile.file->size > GIT_XDIFF_MAX_SIZE)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if ((patch->ofile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0 &&\n\t\t\t (patch->nfile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_NOT_BINARY;\n}",
    "includes": [
      "#include \"fileops.h\"",
      "#include \"zstream.h\"",
      "#include \"delta.h\"",
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff_file.h\"",
      "#include \"diff.h\"",
      "#include \"git2/blob.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void diff_output_to_patch(git_diff_output *, git_patch *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nstatic void diff_patch_update_binary(git_patch *patch)\n{\n\tif ((patch->delta->flags & DIFF_FLAGS_KNOWN_BINARY) != 0)\n\t\treturn;\n\n\tif ((patch->ofile.file->flags & GIT_DIFF_FLAG_BINARY) != 0 ||\n\t\t(patch->nfile.file->flags & GIT_DIFF_FLAG_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if (patch->ofile.file->size > GIT_XDIFF_MAX_SIZE ||\n\t\t\t patch->nfile.file->size > GIT_XDIFF_MAX_SIZE)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_BINARY;\n\n\telse if ((patch->ofile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0 &&\n\t\t\t (patch->nfile.file->flags & DIFF_FLAGS_NOT_BINARY) != 0)\n\t\tpatch->delta->flags |= GIT_DIFF_FLAG_NOT_BINARY;\n}"
  }
]