[
  {
    "function_name": "p_munmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "261-267",
    "snippet": "int p_munmap(git_map *map)\n{\n\tassert(map != NULL);\n\tfree(map->data);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "map->data"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "p_freeaddrinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "81-92",
          "snippet": "void p_freeaddrinfo(struct addrinfo *info)\n{\n\tstruct addrinfo *p, *next;\n\n\tp = info;\n\n\twhile(p != NULL) {\n\t\tnext = p->ai_next;\n\t\tfree(p);\n\t\tp = next;\n\t}\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid p_freeaddrinfo(struct addrinfo *info)\n{\n\tstruct addrinfo *p, *next;\n\n\tp = info;\n\n\twhile(p != NULL) {\n\t\tnext = p->ai_next;\n\t\tfree(p);\n\t\tp = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "map != NULL"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_munmap(git_map *map)\n{\n\tassert(map != NULL);\n\tfree(map->data);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "p_mmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "235-259",
    "snippet": "int p_mmap(git_map *out, size_t len, int prot, int flags, int fd, git_off_t offset)\n{\n\tGIT_MMAP_VALIDATE(out, len, prot, flags);\n\n\tout->data = NULL;\n\tout->len = 0;\n\n\tif ((prot & GIT_PROT_WRITE) && ((flags & GIT_MAP_TYPE) == GIT_MAP_SHARED)) {\n\t\tgiterr_set(GITERR_OS, \"Trying to map shared-writeable\");\n\t\treturn -1;\n\t}\n\n\tout->data = malloc(len);\n\tGITERR_CHECK_ALLOC(out->data);\n\n\tif (!git__is_ssizet(len) ||\n\t\t(p_lseek(fd, offset, SEEK_SET) < 0) ||\n\t\t(p_read(fd, out->data, len) != (ssize_t)len)) {\n\t\tgiterr_set(GITERR_OS, \"mmap emulation failed\");\n\t\treturn -1;\n\t}\n\n\tout->len = len;\n\treturn 0;\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"mmap emulation failed\""
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_read",
          "args": [
            "fd",
            "out->data",
            "len"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "p_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "157-187",
          "snippet": "ssize_t p_read(git_file fd, void *buf, size_t cnt)\n{\n\tchar *b = buf;\n\n\tif (!git__is_ssizet(cnt)) {\n#ifdef GIT_WIN32\n\t\tSetLastError(ERROR_INVALID_PARAMETER);\n#endif\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tr = read(fd, b, cnt > INT_MAX ? INT_MAX : (unsigned int)cnt);\n#else\n\t\tr = read(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || errno == EAGAIN)\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r)\n\t\t\tbreak;\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn (b - (char *)buf);\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nssize_t p_read(git_file fd, void *buf, size_t cnt)\n{\n\tchar *b = buf;\n\n\tif (!git__is_ssizet(cnt)) {\n#ifdef GIT_WIN32\n\t\tSetLastError(ERROR_INVALID_PARAMETER);\n#endif\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tr = read(fd, b, cnt > INT_MAX ? INT_MAX : (unsigned int)cnt);\n#else\n\t\tr = read(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || errno == EAGAIN)\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r)\n\t\t\tbreak;\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn (b - (char *)buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_lseek",
          "args": [
            "fd",
            "offset",
            "SEEK_SET"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__is_ssizet",
          "args": [
            "len"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "git__is_ssizet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/integer.h",
          "lines": "18-22",
          "snippet": "GIT_INLINE(int) git__is_ssizet(size_t p)\n{\n\tssize_t r = (ssize_t)p;\n\treturn p == (size_t)r;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "GIT_INLINE(int) git__is_ssizet(size_t p)\n{\n\tssize_t r = (ssize_t)p;\n\treturn p == (size_t)r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "out->data"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "len"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_MMAP_VALIDATE",
          "args": [
            "out",
            "len",
            "prot",
            "flags"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_mmap(git_map *out, size_t len, int prot, int flags, int fd, git_off_t offset)\n{\n\tGIT_MMAP_VALIDATE(out, len, prot, flags);\n\n\tout->data = NULL;\n\tout->len = 0;\n\n\tif ((prot & GIT_PROT_WRITE) && ((flags & GIT_MAP_TYPE) == GIT_MAP_SHARED)) {\n\t\tgiterr_set(GITERR_OS, \"Trying to map shared-writeable\");\n\t\treturn -1;\n\t}\n\n\tout->data = malloc(len);\n\tGITERR_CHECK_ALLOC(out->data);\n\n\tif (!git__is_ssizet(len) ||\n\t\t(p_lseek(fd, offset, SEEK_SET) < 0) ||\n\t\t(p_read(fd, out->data, len) != (ssize_t)len)) {\n\t\tgiterr_set(GITERR_OS, \"mmap emulation failed\");\n\t\treturn -1;\n\t}\n\n\tout->len = len;\n\treturn 0;\n}"
  },
  {
    "function_name": "git__mmap_alignment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "227-232",
    "snippet": "int git__mmap_alignment(size_t *alignment)\n{\n\t/* dummy; here we don't need any alignment anyway */\n\t*alignment = 4096;\n\treturn 0;\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git__mmap_alignment(size_t *alignment)\n{\n\t/* dummy; here we don't need any alignment anyway */\n\t*alignment = 4096;\n\treturn 0;\n}"
  },
  {
    "function_name": "git__page_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "220-225",
    "snippet": "int git__page_size(size_t *page_size)\n{\n\t/* dummy; here we don't need any alignment anyway */\n\t*page_size = 4096;\n\treturn 0;\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git__page_size(size_t *page_size)\n{\n\t/* dummy; here we don't need any alignment anyway */\n\t*page_size = 4096;\n\treturn 0;\n}"
  },
  {
    "function_name": "p_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "189-214",
    "snippet": "int p_write(git_file fd, const void *buf, size_t cnt)\n{\n\tconst char *b = buf;\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tassert((size_t)((unsigned int)cnt) == cnt);\n\t\tr = write(fd, b, (unsigned int)cnt);\n#else\n\t\tr = write(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || GIT_ISBLOCKED(errno))\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r) {\n\t\t\terrno = EPIPE;\n\t\t\treturn -1;\n\t\t}\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_ISBLOCKED",
          "args": [
            "errno"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write",
          "args": [
            "fd",
            "b",
            "cnt"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "p_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "189-214",
          "snippet": "int p_write(git_file fd, const void *buf, size_t cnt)\n{\n\tconst char *b = buf;\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tassert((size_t)((unsigned int)cnt) == cnt);\n\t\tr = write(fd, b, (unsigned int)cnt);\n#else\n\t\tr = write(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || GIT_ISBLOCKED(errno))\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r) {\n\t\t\terrno = EPIPE;\n\t\t\treturn -1;\n\t\t}\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "(size_t)((unsigned int)cnt) == cnt"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_write(git_file fd, const void *buf, size_t cnt)\n{\n\tconst char *b = buf;\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tassert((size_t)((unsigned int)cnt) == cnt);\n\t\tr = write(fd, b, (unsigned int)cnt);\n#else\n\t\tr = write(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || GIT_ISBLOCKED(errno))\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r) {\n\t\t\terrno = EPIPE;\n\t\t\treturn -1;\n\t\t}\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "p_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "157-187",
    "snippet": "ssize_t p_read(git_file fd, void *buf, size_t cnt)\n{\n\tchar *b = buf;\n\n\tif (!git__is_ssizet(cnt)) {\n#ifdef GIT_WIN32\n\t\tSetLastError(ERROR_INVALID_PARAMETER);\n#endif\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tr = read(fd, b, cnt > INT_MAX ? INT_MAX : (unsigned int)cnt);\n#else\n\t\tr = read(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || errno == EAGAIN)\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r)\n\t\t\tbreak;\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn (b - (char *)buf);\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "b",
            "cnt"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "p_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "157-187",
          "snippet": "ssize_t p_read(git_file fd, void *buf, size_t cnt)\n{\n\tchar *b = buf;\n\n\tif (!git__is_ssizet(cnt)) {\n#ifdef GIT_WIN32\n\t\tSetLastError(ERROR_INVALID_PARAMETER);\n#endif\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tr = read(fd, b, cnt > INT_MAX ? INT_MAX : (unsigned int)cnt);\n#else\n\t\tr = read(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || errno == EAGAIN)\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r)\n\t\t\tbreak;\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn (b - (char *)buf);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "SetLastError",
          "args": [
            "ERROR_INVALID_PARAMETER"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__is_ssizet",
          "args": [
            "cnt"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "git__is_ssizet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/integer.h",
          "lines": "18-22",
          "snippet": "GIT_INLINE(int) git__is_ssizet(size_t p)\n{\n\tssize_t r = (ssize_t)p;\n\treturn p == (size_t)r;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "GIT_INLINE(int) git__is_ssizet(size_t p)\n{\n\tssize_t r = (ssize_t)p;\n\treturn p == (size_t)r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nssize_t p_read(git_file fd, void *buf, size_t cnt)\n{\n\tchar *b = buf;\n\n\tif (!git__is_ssizet(cnt)) {\n#ifdef GIT_WIN32\n\t\tSetLastError(ERROR_INVALID_PARAMETER);\n#endif\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tr = read(fd, b, cnt > INT_MAX ? INT_MAX : (unsigned int)cnt);\n#else\n\t\tr = read(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || errno == EAGAIN)\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r)\n\t\t\tbreak;\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn (b - (char *)buf);\n}"
  },
  {
    "function_name": "p_rename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "142-153",
    "snippet": "int p_rename(const char *from, const char *to)\n{\n\tif (!link(from, to)) {\n\t\tp_unlink(from);\n\t\treturn 0;\n\t}\n\n\tif (!rename(from, to))\n\t\treturn 0;\n\n\treturn -1;\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rename",
          "args": [
            "from",
            "to"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "p_rename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "142-153",
          "snippet": "int p_rename(const char *from, const char *to)\n{\n\tif (!link(from, to)) {\n\t\tp_unlink(from);\n\t\treturn 0;\n\t}\n\n\tif (!rename(from, to))\n\t\treturn 0;\n\n\treturn -1;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "p_unlink",
          "args": [
            "from"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "p_unlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "92-110",
          "snippet": "int p_unlink(const char *path)\n{\n\tgit_win32_path buf;\n\tint error;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\terror = _wunlink(buf);\n\n\t/* If the file could not be deleted because it was\n\t * read-only, clear the bit and try again */\n\tif (error == -1 && errno == EACCES) {\n\t\t_wchmod(buf, 0666);\n\t\terror = _wunlink(buf);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_unlink(const char *path)\n{\n\tgit_win32_path buf;\n\tint error;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\terror = _wunlink(buf);\n\n\t/* If the file could not be deleted because it was\n\t * read-only, clear the bit and try again */\n\tif (error == -1 && errno == EACCES) {\n\t\t_wchmod(buf, 0666);\n\t\terror = _wunlink(buf);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "link",
          "args": [
            "from",
            "to"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_fake_symlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "786-795",
          "snippet": "int git_futils_fake_symlink(const char *old, const char *new)\n{\n\tint retcode = GIT_ERROR;\n\tint fd = git_futils_creat_withpath(new, 0755, 0644);\n\tif (fd >= 0) {\n\t\tretcode = p_write(fd, old, strlen(old));\n\t\tp_close(fd);\n\t}\n\treturn retcode;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_fake_symlink(const char *old, const char *new)\n{\n\tint retcode = GIT_ERROR;\n\tint fd = git_futils_creat_withpath(new, 0755, 0644);\n\tif (fd >= 0) {\n\t\tretcode = p_write(fd, old, strlen(old));\n\t\tp_close(fd);\n\t}\n\treturn retcode;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_rename(const char *from, const char *to)\n{\n\tif (!link(from, to)) {\n\t\tp_unlink(from);\n\t\treturn 0;\n\t}\n\n\tif (!rename(from, to))\n\t\treturn 0;\n\n\treturn -1;\n}"
  },
  {
    "function_name": "p_getcwd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "125-140",
    "snippet": "int p_getcwd(char *buffer_out, size_t size)\n{\n\tchar *cwd_buffer;\n\n\tassert(buffer_out && size > 0);\n\n\tcwd_buffer = getcwd(buffer_out, size);\n\n\tif (cwd_buffer == NULL)\n\t\treturn -1;\n\n\tgit_path_mkposix(buffer_out);\n\tgit_path_string_to_dir(buffer_out, size); /* append trailing slash */\n\n\treturn 0;\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_path_string_to_dir",
          "args": [
            "buffer_out",
            "size"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_string_to_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "351-359",
          "snippet": "void git_path_string_to_dir(char* path, size_t size)\n{\n\tsize_t end = strlen(path);\n\n\tif (end && path[end - 1] != '/' && end < size) {\n\t\tpath[end] = '/';\n\t\tpath[end + 1] = '\\0';\n\t}\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nvoid git_path_string_to_dir(char* path, size_t size)\n{\n\tsize_t end = strlen(path);\n\n\tif (end && path[end - 1] != '/' && end < size) {\n\t\tpath[end] = '/';\n\t\tpath[end + 1] = '\\0';\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_mkposix",
          "args": [
            "buffer_out"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_mkposix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.h",
          "lines": "110-118",
          "snippet": "GIT_INLINE(void) git_path_mkposix(char *path)\n{\n\twhile (*path) {\n\t\tif (*path == '\\\\')\n\t\t\t*path = '/';\n\n\t\tpath++;\n\t}\n}",
          "includes": [
            "#include <iconv.h>",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iconv.h>\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) git_path_mkposix(char *path)\n{\n\twhile (*path) {\n\t\tif (*path == '\\\\')\n\t\t\t*path = '/';\n\n\t\tpath++;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "getcwd",
          "args": [
            "buffer_out",
            "size"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "p_getcwd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "125-140",
          "snippet": "int p_getcwd(char *buffer_out, size_t size)\n{\n\tchar *cwd_buffer;\n\n\tassert(buffer_out && size > 0);\n\n\tcwd_buffer = getcwd(buffer_out, size);\n\n\tif (cwd_buffer == NULL)\n\t\treturn -1;\n\n\tgit_path_mkposix(buffer_out);\n\tgit_path_string_to_dir(buffer_out, size); /* append trailing slash */\n\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "buffer_out && size > 0"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_getcwd(char *buffer_out, size_t size)\n{\n\tchar *cwd_buffer;\n\n\tassert(buffer_out && size > 0);\n\n\tcwd_buffer = getcwd(buffer_out, size);\n\n\tif (cwd_buffer == NULL)\n\t\treturn -1;\n\n\tgit_path_mkposix(buffer_out);\n\tgit_path_string_to_dir(buffer_out, size); /* append trailing slash */\n\n\treturn 0;\n}"
  },
  {
    "function_name": "p_creat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "120-123",
    "snippet": "int p_creat(const char *path, mode_t mode)\n{\n\treturn open(path, O_WRONLY | O_CREAT | O_TRUNC | O_BINARY | O_CLOEXEC, mode);\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_WRONLY | O_CREAT | O_TRUNC | O_BINARY | O_CLOEXEC",
            "mode"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "p_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "105-118",
          "snippet": "int p_open(const char *path, volatile int flags, ...)\n{\n\tmode_t mode = 0;\n\n\tif (flags & O_CREAT) {\n\t\tva_list arg_list;\n\n\t\tva_start(arg_list, flags);\n\t\tmode = (mode_t)va_arg(arg_list, int);\n\t\tva_end(arg_list);\n\t}\n\n\treturn open(path, flags | O_BINARY | O_CLOEXEC, mode);\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_open(const char *path, volatile int flags, ...)\n{\n\tmode_t mode = 0;\n\n\tif (flags & O_CREAT) {\n\t\tva_list arg_list;\n\n\t\tva_start(arg_list, flags);\n\t\tmode = (mode_t)va_arg(arg_list, int);\n\t\tva_end(arg_list);\n\t}\n\n\treturn open(path, flags | O_BINARY | O_CLOEXEC, mode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_creat(const char *path, mode_t mode)\n{\n\treturn open(path, O_WRONLY | O_CREAT | O_TRUNC | O_BINARY | O_CLOEXEC, mode);\n}"
  },
  {
    "function_name": "p_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "105-118",
    "snippet": "int p_open(const char *path, volatile int flags, ...)\n{\n\tmode_t mode = 0;\n\n\tif (flags & O_CREAT) {\n\t\tva_list arg_list;\n\n\t\tva_start(arg_list, flags);\n\t\tmode = (mode_t)va_arg(arg_list, int);\n\t\tva_end(arg_list);\n\t}\n\n\treturn open(path, flags | O_BINARY | O_CLOEXEC, mode);\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "flags | O_BINARY | O_CLOEXEC",
            "mode"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "p_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "105-118",
          "snippet": "int p_open(const char *path, volatile int flags, ...)\n{\n\tmode_t mode = 0;\n\n\tif (flags & O_CREAT) {\n\t\tva_list arg_list;\n\n\t\tva_start(arg_list, flags);\n\t\tmode = (mode_t)va_arg(arg_list, int);\n\t\tva_end(arg_list);\n\t}\n\n\treturn open(path, flags | O_BINARY | O_CLOEXEC, mode);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg_list"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "arg_list",
            "int"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arg_list",
            "flags"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_open(const char *path, volatile int flags, ...)\n{\n\tmode_t mode = 0;\n\n\tif (flags & O_CREAT) {\n\t\tva_list arg_list;\n\n\t\tva_start(arg_list, flags);\n\t\tmode = (mode_t)va_arg(arg_list, int);\n\t\tva_end(arg_list);\n\t}\n\n\treturn open(path, flags | O_BINARY | O_CLOEXEC, mode);\n}"
  },
  {
    "function_name": "p_gai_strerror",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "94-101",
    "snippet": "const char *p_gai_strerror(int ret)\n{\n\tswitch(ret) {\n\tcase -1: return \"Out of memory\"; break;\n\tcase -2: return \"Address lookup failed\"; break;\n\tdefault: return \"Unknown error\"; break;\n\t}\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nconst char *p_gai_strerror(int ret)\n{\n\tswitch(ret) {\n\tcase -1: return \"Out of memory\"; break;\n\tcase -2: return \"Address lookup failed\"; break;\n\tdefault: return \"Unknown error\"; break;\n\t}\n}"
  },
  {
    "function_name": "p_freeaddrinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "81-92",
    "snippet": "void p_freeaddrinfo(struct addrinfo *info)\n{\n\tstruct addrinfo *p, *next;\n\n\tp = info;\n\n\twhile(p != NULL) {\n\t\tnext = p->ai_next;\n\t\tfree(p);\n\t\tp = next;\n\t}\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "p"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "p_freeaddrinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "81-92",
          "snippet": "void p_freeaddrinfo(struct addrinfo *info)\n{\n\tstruct addrinfo *p, *next;\n\n\tp = info;\n\n\twhile(p != NULL) {\n\t\tnext = p->ai_next;\n\t\tfree(p);\n\t\tp = next;\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid p_freeaddrinfo(struct addrinfo *info)\n{\n\tstruct addrinfo *p, *next;\n\n\tp = info;\n\n\twhile(p != NULL) {\n\t\tnext = p->ai_next;\n\t\tfree(p);\n\t\tp = next;\n\t}\n}"
  },
  {
    "function_name": "p_getaddrinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
    "lines": "17-79",
    "snippet": "int p_getaddrinfo(\n\tconst char *host,\n\tconst char *port,\n\tstruct addrinfo *hints,\n\tstruct addrinfo **info)\n{\n\tstruct addrinfo *ainfo, *ai;\n\tint p = 0;\n\n\tGIT_UNUSED(hints);\n\n\tif ((ainfo = malloc(sizeof(struct addrinfo))) == NULL)\n\t\treturn -1;\n\n\tif ((ainfo->ai_hostent = gethostbyname(host)) == NULL) {\n\t\tfree(ainfo);\n\t\treturn -2;\n\t}\n\n\tainfo->ai_servent = getservbyname(port, 0);\n\n\tif (ainfo->ai_servent)\n\t\tainfo->ai_port = ainfo->ai_servent->s_port;\n\telse\n\t\tainfo->ai_port = atol(port);\n\n\tmemcpy(&ainfo->ai_addr_in.sin_addr,\n\t\t\tainfo->ai_hostent->h_addr_list[0],\n\t\t\tainfo->ai_hostent->h_length);\n\n\tainfo->ai_protocol = 0;\n\tainfo->ai_socktype = hints->ai_socktype;\n\tainfo->ai_family = ainfo->ai_hostent->h_addrtype;\n\tainfo->ai_addr_in.sin_family = ainfo->ai_family;\n\tainfo->ai_addr_in.sin_port = ainfo->ai_port;\n\tainfo->ai_addr = (struct addrinfo *)&ainfo->ai_addr_in;\n\tainfo->ai_addrlen = sizeof(struct sockaddr_in);\n\n\t*info = ainfo;\n\n\tif (ainfo->ai_hostent->h_addr_list[1] == NULL) {\n\t\tainfo->ai_next = NULL;\n\t\treturn 0;\n\t}\n\n\tai = ainfo;\n\n\tfor (p = 1; ainfo->ai_hostent->h_addr_list[p] != NULL; p++) {\n\t\tif (!(ai->ai_next = malloc(sizeof(struct addrinfo)))) {\n\t\t\tp_freeaddrinfo(ainfo);\n\t\t\treturn -1;\n\t\t}\n\t\tmemcpy(ai->ai_next, ainfo, sizeof(struct addrinfo));\n\t\tmemcpy(&ai->ai_next->ai_addr_in.sin_addr,\n\t\t\tainfo->ai_hostent->h_addr_list[p],\n\t\t\tainfo->ai_hostent->h_length);\n\t\tai->ai_next->ai_addr = (struct addrinfo *)&ai->ai_next->ai_addr_in;\n\t\tai = ai->ai_next;\n\t}\n\n\tai->ai_next = NULL;\n\treturn 0;\n}",
    "includes": [
      "#include \"map.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ai->ai_next->ai_addr_in.sin_addr",
            "ainfo->ai_hostent->h_addr_list[p]",
            "ainfo->ai_hostent->h_length"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ai->ai_next",
            "ainfo",
            "sizeof(struct addrinfo)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_freeaddrinfo",
          "args": [
            "ainfo"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "p_freeaddrinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "81-92",
          "snippet": "void p_freeaddrinfo(struct addrinfo *info)\n{\n\tstruct addrinfo *p, *next;\n\n\tp = info;\n\n\twhile(p != NULL) {\n\t\tnext = p->ai_next;\n\t\tfree(p);\n\t\tp = next;\n\t}\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid p_freeaddrinfo(struct addrinfo *info)\n{\n\tstruct addrinfo *p, *next;\n\n\tp = info;\n\n\twhile(p != NULL) {\n\t\tnext = p->ai_next;\n\t\tfree(p);\n\t\tp = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct addrinfo)"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ainfo->ai_addr_in.sin_addr",
            "ainfo->ai_hostent->h_addr_list[0]",
            "ainfo->ai_hostent->h_length"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atol",
          "args": [
            "port"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getservbyname",
          "args": [
            "port",
            "0"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gethostbyname",
          "args": [
            "host"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "hints"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_getaddrinfo(\n\tconst char *host,\n\tconst char *port,\n\tstruct addrinfo *hints,\n\tstruct addrinfo **info)\n{\n\tstruct addrinfo *ainfo, *ai;\n\tint p = 0;\n\n\tGIT_UNUSED(hints);\n\n\tif ((ainfo = malloc(sizeof(struct addrinfo))) == NULL)\n\t\treturn -1;\n\n\tif ((ainfo->ai_hostent = gethostbyname(host)) == NULL) {\n\t\tfree(ainfo);\n\t\treturn -2;\n\t}\n\n\tainfo->ai_servent = getservbyname(port, 0);\n\n\tif (ainfo->ai_servent)\n\t\tainfo->ai_port = ainfo->ai_servent->s_port;\n\telse\n\t\tainfo->ai_port = atol(port);\n\n\tmemcpy(&ainfo->ai_addr_in.sin_addr,\n\t\t\tainfo->ai_hostent->h_addr_list[0],\n\t\t\tainfo->ai_hostent->h_length);\n\n\tainfo->ai_protocol = 0;\n\tainfo->ai_socktype = hints->ai_socktype;\n\tainfo->ai_family = ainfo->ai_hostent->h_addrtype;\n\tainfo->ai_addr_in.sin_family = ainfo->ai_family;\n\tainfo->ai_addr_in.sin_port = ainfo->ai_port;\n\tainfo->ai_addr = (struct addrinfo *)&ainfo->ai_addr_in;\n\tainfo->ai_addrlen = sizeof(struct sockaddr_in);\n\n\t*info = ainfo;\n\n\tif (ainfo->ai_hostent->h_addr_list[1] == NULL) {\n\t\tainfo->ai_next = NULL;\n\t\treturn 0;\n\t}\n\n\tai = ainfo;\n\n\tfor (p = 1; ainfo->ai_hostent->h_addr_list[p] != NULL; p++) {\n\t\tif (!(ai->ai_next = malloc(sizeof(struct addrinfo)))) {\n\t\t\tp_freeaddrinfo(ainfo);\n\t\t\treturn -1;\n\t\t}\n\t\tmemcpy(ai->ai_next, ainfo, sizeof(struct addrinfo));\n\t\tmemcpy(&ai->ai_next->ai_addr_in.sin_addr,\n\t\t\tainfo->ai_hostent->h_addr_list[p],\n\t\t\tainfo->ai_hostent->h_length);\n\t\tai->ai_next->ai_addr = (struct addrinfo *)&ai->ai_next->ai_addr_in;\n\t\tai = ai->ai_next;\n\t}\n\n\tai->ai_next = NULL;\n\treturn 0;\n}"
  }
]