[
  {
    "function_name": "git__global_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "351-354",
    "snippet": "git_global_st *git__global_state(void)\n{\n\treturn &__state;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\ngit_global_st *git__global_state(void)\n{\n\treturn &__state;\n}"
  },
  {
    "function_name": "git_libgit2_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "338-349",
    "snippet": "int git_libgit2_shutdown(void)\n{\n\tint ret;\n\n\t/* Shut down any subsystems that have global state */\n\tif ((ret = git_atomic_dec(&git__n_inits)) == 0) {\n\t\tshutdown_common();\n\t\tgit__global_state_cleanup(&__state);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_atomic git__n_inits;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__global_state_cleanup",
          "args": [
            "&__state"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "git__global_state_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "39-46",
          "snippet": "static void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "shutdown_common",
          "args": [],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "shutdown_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "71-89",
          "snippet": "static void shutdown_common(void)\n{\n\tint pos;\n\n\t/* Shutdown subsystems that have registered */\n\tfor (pos = git_atomic_get(&git__n_shutdown_callbacks);\n\t\tpos > 0;\n\t\tpos = git_atomic_dec(&git__n_shutdown_callbacks)) {\n\n\t\tgit_global_shutdown_fn cb = git__swap(\n\t\t\tgit__shutdown_callbacks[pos - 1], NULL);\n\n\t\tif (cb != NULL)\n\t\t\tcb();\n\t}\n\n\tgit__free(git__user_agent);\n\tgit__free(git__ssl_ciphers);\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
            "static git_atomic git__n_shutdown_callbacks;",
            "char *git__user_agent;",
            "char *git__ssl_ciphers;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\nchar *git__user_agent;\nchar *git__ssl_ciphers;\n\nstatic void shutdown_common(void)\n{\n\tint pos;\n\n\t/* Shutdown subsystems that have registered */\n\tfor (pos = git_atomic_get(&git__n_shutdown_callbacks);\n\t\tpos > 0;\n\t\tpos = git_atomic_dec(&git__n_shutdown_callbacks)) {\n\n\t\tgit_global_shutdown_fn cb = git__swap(\n\t\t\tgit__shutdown_callbacks[pos - 1], NULL);\n\n\t\tif (cb != NULL)\n\t\t\tcb();\n\t}\n\n\tgit__free(git__user_agent);\n\tgit__free(git__ssl_ciphers);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_atomic_dec",
          "args": [
            "&git__n_inits"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "182-185",
          "snippet": "GIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_atomic git__n_inits;\n\nint git_libgit2_shutdown(void)\n{\n\tint ret;\n\n\t/* Shut down any subsystems that have global state */\n\tif ((ret = git_atomic_dec(&git__n_inits)) == 0) {\n\t\tshutdown_common();\n\t\tgit__global_state_cleanup(&__state);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git_libgit2_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "324-336",
    "snippet": "int git_libgit2_init(void)\n{\n\tint ret;\n\n\t/* Only init SSL the first time */\n\tif ((ret = git_atomic_inc(&git__n_inits)) != 1)\n\t\treturn ret;\n\n\tif ((ret = init_common()) < 0)\n\t\treturn ret;\n\n\treturn 1;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_atomic git__n_inits;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_common",
          "args": [],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "init_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "48-69",
          "snippet": "static int init_common(void)\n{\n\tint ret;\n\n\t/* Initialize the CRT debug allocator first, before our first malloc */\n#if defined(GIT_MSVC_CRTDBG)\n\tgit_win32__crtdbg_stacktrace_init();\n\tgit_win32__stack_init();\n#endif\n\n\t/* Initialize any other subsystems that have global state */\n\tif ((ret = git_hash_global_init()) == 0 &&\n\t\t(ret = git_sysdir_global_init()) == 0 &&\n\t\t(ret = git_filter_global_init()) == 0 &&\n\t\t(ret = git_transport_ssh_global_init()) == 0 &&\n\t\t(ret = git_openssl_stream_global_init()) == 0)\n\t\tret = git_mwindow_global_init();\n\n\tGIT_MEMORY_BARRIER;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic int init_common(void)\n{\n\tint ret;\n\n\t/* Initialize the CRT debug allocator first, before our first malloc */\n#if defined(GIT_MSVC_CRTDBG)\n\tgit_win32__crtdbg_stacktrace_init();\n\tgit_win32__stack_init();\n#endif\n\n\t/* Initialize any other subsystems that have global state */\n\tif ((ret = git_hash_global_init()) == 0 &&\n\t\t(ret = git_sysdir_global_init()) == 0 &&\n\t\t(ret = git_filter_global_init()) == 0 &&\n\t\t(ret = git_transport_ssh_global_init()) == 0 &&\n\t\t(ret = git_openssl_stream_global_init()) == 0)\n\t\tret = git_mwindow_global_init();\n\n\tGIT_MEMORY_BARRIER;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_atomic_inc",
          "args": [
            "&git__n_inits"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "171-174",
          "snippet": "GIT_INLINE(int) git_atomic_inc(git_atomic *a)\n{\n\treturn ++a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_inc(git_atomic *a)\n{\n\treturn ++a->val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_atomic git__n_inits;\n\nint git_libgit2_init(void)\n{\n\tint ret;\n\n\t/* Only init SSL the first time */\n\tif ((ret = git_atomic_inc(&git__n_inits)) != 1)\n\t\treturn ret;\n\n\tif ((ret = init_common()) < 0)\n\t\treturn ret;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "git__global_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "302-318",
    "snippet": "git_global_st *git__global_state(void)\n{\n\tgit_global_st *ptr;\n\n\tassert(git_atomic_get(&git__n_inits) > 0);\n\n\tif ((ptr = pthread_getspecific(_tls_key)) != NULL)\n\t\treturn ptr;\n\n\tptr = git__calloc(1, sizeof(git_global_st));\n\tif (!ptr)\n\t\treturn NULL;\n\n\tgit_buf_init(&ptr->error_buf, 0);\n\tpthread_setspecific(_tls_key, ptr);\n\treturn ptr;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_atomic git__n_inits;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_setspecific",
          "args": [
            "_tls_key",
            "ptr"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_init",
          "args": [
            "&ptr->error_buf",
            "0"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "25-33",
          "snippet": "void git_buf_init(git_buf *buf, size_t initial_size)\n{\n\tbuf->asize = 0;\n\tbuf->size = 0;\n\tbuf->ptr = git_buf__initbuf;\n\n\tif (initial_size)\n\t\tgit_buf_grow(buf, initial_size);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_init(git_buf *buf, size_t initial_size)\n{\n\tbuf->asize = 0;\n\tbuf->size = 0;\n\tbuf->ptr = git_buf__initbuf;\n\n\tif (initial_size)\n\t\tgit_buf_grow(buf, initial_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_global_st)"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_getspecific",
          "args": [
            "_tls_key"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "git_atomic_get(&git__n_inits) > 0"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_atomic_get",
          "args": [
            "&git__n_inits"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "217-220",
          "snippet": "GIT_INLINE(int) git_atomic_get(git_atomic *a)\n{\n\treturn (int)a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_get(git_atomic *a)\n{\n\treturn (int)a->val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_atomic git__n_inits;\n\ngit_global_st *git__global_state(void)\n{\n\tgit_global_st *ptr;\n\n\tassert(git_atomic_get(&git__n_inits) > 0);\n\n\tif ((ptr = pthread_getspecific(_tls_key)) != NULL)\n\t\treturn ptr;\n\n\tptr = git__calloc(1, sizeof(git_global_st));\n\tif (!ptr)\n\t\treturn NULL;\n\n\tgit_buf_init(&ptr->error_buf, 0);\n\tpthread_setspecific(_tls_key, ptr);\n\treturn ptr;\n}"
  },
  {
    "function_name": "git_libgit2_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "277-300",
    "snippet": "int git_libgit2_shutdown(void)\n{\n\tvoid *ptr = NULL;\n\tpthread_once_t new_once = PTHREAD_ONCE_INIT;\n\tint ret;\n\n\tif ((ret = git_atomic_dec(&git__n_inits)) != 0)\n\t\treturn ret;\n\n\t/* Shut down any subsystems that have global state */\n\tshutdown_common();\n\n\tptr = pthread_getspecific(_tls_key);\n\tpthread_setspecific(_tls_key, NULL);\n\n\tgit__global_state_cleanup(ptr);\n\tgit__free(ptr);\n\n\tpthread_key_delete(_tls_key);\n\tgit_mutex_free(&git__mwindow_mutex);\n\t_once_init = new_once;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "git_mutex git__mwindow_mutex;",
      "static git_atomic git__n_inits;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_mutex_free",
          "args": [
            "&git__mwindow_mutex"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "104-108",
          "snippet": "int git_mutex_free(git_mutex *mutex)\n{\n\tDeleteCriticalSection(mutex);\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nint git_mutex_free(git_mutex *mutex)\n{\n\tDeleteCriticalSection(mutex);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_key_delete",
          "args": [
            "_tls_key"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "ptr"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__global_state_cleanup",
          "args": [
            "ptr"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "git__global_state_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "39-46",
          "snippet": "static void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_setspecific",
          "args": [
            "_tls_key",
            "NULL"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_getspecific",
          "args": [
            "_tls_key"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shutdown_common",
          "args": [],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "shutdown_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "71-89",
          "snippet": "static void shutdown_common(void)\n{\n\tint pos;\n\n\t/* Shutdown subsystems that have registered */\n\tfor (pos = git_atomic_get(&git__n_shutdown_callbacks);\n\t\tpos > 0;\n\t\tpos = git_atomic_dec(&git__n_shutdown_callbacks)) {\n\n\t\tgit_global_shutdown_fn cb = git__swap(\n\t\t\tgit__shutdown_callbacks[pos - 1], NULL);\n\n\t\tif (cb != NULL)\n\t\t\tcb();\n\t}\n\n\tgit__free(git__user_agent);\n\tgit__free(git__ssl_ciphers);\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
            "static git_atomic git__n_shutdown_callbacks;",
            "char *git__user_agent;",
            "char *git__ssl_ciphers;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\nchar *git__user_agent;\nchar *git__ssl_ciphers;\n\nstatic void shutdown_common(void)\n{\n\tint pos;\n\n\t/* Shutdown subsystems that have registered */\n\tfor (pos = git_atomic_get(&git__n_shutdown_callbacks);\n\t\tpos > 0;\n\t\tpos = git_atomic_dec(&git__n_shutdown_callbacks)) {\n\n\t\tgit_global_shutdown_fn cb = git__swap(\n\t\t\tgit__shutdown_callbacks[pos - 1], NULL);\n\n\t\tif (cb != NULL)\n\t\t\tcb();\n\t}\n\n\tgit__free(git__user_agent);\n\tgit__free(git__ssl_ciphers);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_atomic_dec",
          "args": [
            "&git__n_inits"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "182-185",
          "snippet": "GIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\ngit_mutex git__mwindow_mutex;\nstatic git_atomic git__n_inits;\n\nint git_libgit2_shutdown(void)\n{\n\tvoid *ptr = NULL;\n\tpthread_once_t new_once = PTHREAD_ONCE_INIT;\n\tint ret;\n\n\tif ((ret = git_atomic_dec(&git__n_inits)) != 0)\n\t\treturn ret;\n\n\t/* Shut down any subsystems that have global state */\n\tshutdown_common();\n\n\tptr = pthread_getspecific(_tls_key);\n\tpthread_setspecific(_tls_key, NULL);\n\n\tgit__global_state_cleanup(ptr);\n\tgit__free(ptr);\n\n\tpthread_key_delete(_tls_key);\n\tgit_mutex_free(&git__mwindow_mutex);\n\t_once_init = new_once;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_libgit2_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "267-275",
    "snippet": "int git_libgit2_init(void)\n{\n\tint ret;\n\n\tret = git_atomic_inc(&git__n_inits);\n\tpthread_once(&_once_init, init_once);\n\n\treturn init_error ? init_error : ret;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_atomic git__n_inits;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_once",
          "args": [
            "&_once_init",
            "init_once"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_atomic_inc",
          "args": [
            "&git__n_inits"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "171-174",
          "snippet": "GIT_INLINE(int) git_atomic_inc(git_atomic *a)\n{\n\treturn ++a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_inc(git_atomic *a)\n{\n\treturn ++a->val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_atomic git__n_inits;\n\nint git_libgit2_init(void)\n{\n\tint ret;\n\n\tret = git_atomic_inc(&git__n_inits);\n\tpthread_once(&_once_init, init_once);\n\n\treturn init_error ? init_error : ret;\n}"
  },
  {
    "function_name": "init_once",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "257-265",
    "snippet": "static void init_once(void)\n{\n\tif ((init_error = git_mutex_init(&git__mwindow_mutex)) != 0)\n\t\treturn;\n\n\tpthread_key_create(&_tls_key, &cb__free_status);\n\n\tinit_error = init_common();\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "git_mutex git__mwindow_mutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_common",
          "args": [],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "init_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "48-69",
          "snippet": "static int init_common(void)\n{\n\tint ret;\n\n\t/* Initialize the CRT debug allocator first, before our first malloc */\n#if defined(GIT_MSVC_CRTDBG)\n\tgit_win32__crtdbg_stacktrace_init();\n\tgit_win32__stack_init();\n#endif\n\n\t/* Initialize any other subsystems that have global state */\n\tif ((ret = git_hash_global_init()) == 0 &&\n\t\t(ret = git_sysdir_global_init()) == 0 &&\n\t\t(ret = git_filter_global_init()) == 0 &&\n\t\t(ret = git_transport_ssh_global_init()) == 0 &&\n\t\t(ret = git_openssl_stream_global_init()) == 0)\n\t\tret = git_mwindow_global_init();\n\n\tGIT_MEMORY_BARRIER;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic int init_common(void)\n{\n\tint ret;\n\n\t/* Initialize the CRT debug allocator first, before our first malloc */\n#if defined(GIT_MSVC_CRTDBG)\n\tgit_win32__crtdbg_stacktrace_init();\n\tgit_win32__stack_init();\n#endif\n\n\t/* Initialize any other subsystems that have global state */\n\tif ((ret = git_hash_global_init()) == 0 &&\n\t\t(ret = git_sysdir_global_init()) == 0 &&\n\t\t(ret = git_filter_global_init()) == 0 &&\n\t\t(ret = git_transport_ssh_global_init()) == 0 &&\n\t\t(ret = git_openssl_stream_global_init()) == 0)\n\t\tret = git_mwindow_global_init();\n\n\tGIT_MEMORY_BARRIER;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_key_create",
          "args": [
            "&_tls_key",
            "&cb__free_status"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_mutex_init",
          "args": [
            "&git__mwindow_mutex"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "140-141",
          "snippet": "GIT_INLINE(int) git_mutex_init(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [
            "#define git_mutex unsigned int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\n#define git_mutex unsigned int\n\nGIT_INLINE(int) git_mutex_init(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\ngit_mutex git__mwindow_mutex;\n\nstatic void init_once(void)\n{\n\tif ((init_error = git_mutex_init(&git__mwindow_mutex)) != 0)\n\t\treturn;\n\n\tpthread_key_create(&_tls_key, &cb__free_status);\n\n\tinit_error = init_common();\n}"
  },
  {
    "function_name": "cb__free_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "251-255",
    "snippet": "static void cb__free_status(void *st)\n{\n\tgit__global_state_cleanup(st);\n\tgit__free(st);\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "st"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__global_state_cleanup",
          "args": [
            "st"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "git__global_state_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "39-46",
          "snippet": "static void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void cb__free_status(void *st)\n{\n\tgit__global_state_cleanup(st);\n\tgit__free(st);\n}"
  },
  {
    "function_name": "DllMain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "228-243",
    "snippet": "BOOL WINAPI DllMain(HINSTANCE hInstDll, DWORD fdwReason, LPVOID lpvReserved)\n{\n\tGIT_UNUSED(hInstDll);\n\tGIT_UNUSED(lpvReserved);\n\n\t/* This is how Windows lets us know our thread is being shut down */\n\tif (fdwReason == DLL_THREAD_DETACH) {\n\t\tgit__free_tls_data();\n\t}\n\n\t/*\n\t * Windows pays attention to this during library loading. We don't do anything\n\t * so we trivially succeed.\n\t */\n\treturn TRUE;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free_tls_data",
          "args": [],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "git__free_tls_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "217-226",
          "snippet": "void git__free_tls_data(void)\n{\n\tvoid *ptr = TlsGetValue(_tls_index);\n\tif (!ptr)\n\t\treturn;\n\n\tgit__global_state_cleanup(ptr);\n\tgit__free(ptr);\n\tTlsSetValue(_tls_index, NULL);\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid git__free_tls_data(void)\n{\n\tvoid *ptr = TlsGetValue(_tls_index);\n\tif (!ptr)\n\t\treturn;\n\n\tgit__global_state_cleanup(ptr);\n\tgit__free(ptr);\n\tTlsSetValue(_tls_index, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "lpvReserved"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "hInstDll"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nBOOL WINAPI DllMain(HINSTANCE hInstDll, DWORD fdwReason, LPVOID lpvReserved)\n{\n\tGIT_UNUSED(hInstDll);\n\tGIT_UNUSED(lpvReserved);\n\n\t/* This is how Windows lets us know our thread is being shut down */\n\tif (fdwReason == DLL_THREAD_DETACH) {\n\t\tgit__free_tls_data();\n\t}\n\n\t/*\n\t * Windows pays attention to this during library loading. We don't do anything\n\t * so we trivially succeed.\n\t */\n\treturn TRUE;\n}"
  },
  {
    "function_name": "git__free_tls_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "217-226",
    "snippet": "void git__free_tls_data(void)\n{\n\tvoid *ptr = TlsGetValue(_tls_index);\n\tif (!ptr)\n\t\treturn;\n\n\tgit__global_state_cleanup(ptr);\n\tgit__free(ptr);\n\tTlsSetValue(_tls_index, NULL);\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TlsSetValue",
          "args": [
            "_tls_index",
            "NULL"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "ptr"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__global_state_cleanup",
          "args": [
            "ptr"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "git__global_state_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "39-46",
          "snippet": "static void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TlsGetValue",
          "args": [
            "_tls_index"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid git__free_tls_data(void)\n{\n\tvoid *ptr = TlsGetValue(_tls_index);\n\tif (!ptr)\n\t\treturn;\n\n\tgit__global_state_cleanup(ptr);\n\tgit__free(ptr);\n\tTlsSetValue(_tls_index, NULL);\n}"
  },
  {
    "function_name": "git__global_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "193-210",
    "snippet": "git_global_st *git__global_state(void)\n{\n\tgit_global_st *ptr;\n\n\tassert(git_atomic_get(&git__n_inits) > 0);\n\n\tif ((ptr = TlsGetValue(_tls_index)) != NULL)\n\t\treturn ptr;\n\n\tptr = git__calloc(1, sizeof(git_global_st));\n\tif (!ptr)\n\t\treturn NULL;\n\n\tgit_buf_init(&ptr->error_buf, 0);\n\n\tTlsSetValue(_tls_index, ptr);\n\treturn ptr;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_atomic git__n_inits;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "TlsSetValue",
          "args": [
            "_tls_index",
            "ptr"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_init",
          "args": [
            "&ptr->error_buf",
            "0"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "25-33",
          "snippet": "void git_buf_init(git_buf *buf, size_t initial_size)\n{\n\tbuf->asize = 0;\n\tbuf->size = 0;\n\tbuf->ptr = git_buf__initbuf;\n\n\tif (initial_size)\n\t\tgit_buf_grow(buf, initial_size);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_init(git_buf *buf, size_t initial_size)\n{\n\tbuf->asize = 0;\n\tbuf->size = 0;\n\tbuf->ptr = git_buf__initbuf;\n\n\tif (initial_size)\n\t\tgit_buf_grow(buf, initial_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_global_st)"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TlsGetValue",
          "args": [
            "_tls_index"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "git_atomic_get(&git__n_inits) > 0"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_atomic_get",
          "args": [
            "&git__n_inits"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "217-220",
          "snippet": "GIT_INLINE(int) git_atomic_get(git_atomic *a)\n{\n\treturn (int)a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_get(git_atomic *a)\n{\n\treturn (int)a->val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_atomic git__n_inits;\n\ngit_global_st *git__global_state(void)\n{\n\tgit_global_st *ptr;\n\n\tassert(git_atomic_get(&git__n_inits) > 0);\n\n\tif ((ptr = TlsGetValue(_tls_index)) != NULL)\n\t\treturn ptr;\n\n\tptr = git__calloc(1, sizeof(git_global_st));\n\tif (!ptr)\n\t\treturn NULL;\n\n\tgit_buf_init(&ptr->error_buf, 0);\n\n\tTlsSetValue(_tls_index, ptr);\n\treturn ptr;\n}"
  },
  {
    "function_name": "git_libgit2_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "165-191",
    "snippet": "int git_libgit2_shutdown(void)\n{\n\tint ret;\n\n\t/* Enter the lock */\n\twhile (InterlockedCompareExchange(&_mutex, 1, 0)) { Sleep(0); }\n\n\t/* Only do work on a 1 -> 0 transition of the refcount */\n\tif ((ret = git_atomic_dec(&git__n_inits)) == 0) {\n\t\tshutdown_common();\n\n\t\tgit__free_tls_data();\n\n\t\tTlsFree(_tls_index);\n\t\tgit_mutex_free(&git__mwindow_mutex);\n\n#if defined(GIT_MSVC_CRTDBG)\n\t\tgit_win32__crtdbg_stacktrace_cleanup();\n\t\tgit_win32__stack_cleanup();\n#endif\n\t}\n\n\t/* Exit the lock */\n\tInterlockedExchange(&_mutex, 0);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "git_mutex git__mwindow_mutex;",
      "static git_atomic git__n_inits;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "InterlockedExchange",
          "args": [
            "&_mutex",
            "0"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_win32__stack_cleanup",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__stack_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_stack.c",
          "lines": "45-52",
          "snippet": "void git_win32__stack_cleanup(void)\n{\n\tif (g_win32_stack_initialized) {\n\t\tSymCleanup(g_win32_stack_process);\n\t\tg_win32_stack_process = INVALID_HANDLE_VALUE;\n\t\tg_win32_stack_initialized = false;\n\t}\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"w32_stack.h\"",
            "#include \"win32/posix.h\"",
            "#include \"Dbghelp.h\"",
            "#include \"Windows.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"w32_stack.h\"\n#include \"win32/posix.h\"\n#include \"Dbghelp.h\"\n#include \"Windows.h\"\n\nvoid git_win32__stack_cleanup(void)\n{\n\tif (g_win32_stack_initialized) {\n\t\tSymCleanup(g_win32_stack_process);\n\t\tg_win32_stack_process = INVALID_HANDLE_VALUE;\n\t\tg_win32_stack_initialized = false;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__crtdbg_stacktrace_cleanup",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__crtdbg_stacktrace_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_crtdbg_stacktrace.c",
          "lines": "303-317",
          "snippet": "void git_win32__crtdbg_stacktrace_cleanup(void)\n{\n\t/* At shutdown/cleanup, dump cummulative leak info\n\t * with everything since startup.  This might generate\n\t * extra noise if the caller has been doing checkpoint\n\t * dumps, but it might also eliminate some false\n\t * positives for resources previously reported during\n\t * checkpoints.\n\t */\n\tgit_win32__crtdbg_stacktrace__dump(\n\t\tGIT_WIN32__CRTDBG_STACKTRACE__LEAKS_TOTAL,\n\t\t\"CLEANUP\");\n\n\tDeleteCriticalSection(&g_crtdbg_stacktrace_cs);\n}",
          "includes": [
            "#include \"w32_crtdbg_stacktrace.h\"",
            "#include \"w32_stack.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"w32_crtdbg_stacktrace.h\"\n#include \"w32_stack.h\"\n\nvoid git_win32__crtdbg_stacktrace_cleanup(void)\n{\n\t/* At shutdown/cleanup, dump cummulative leak info\n\t * with everything since startup.  This might generate\n\t * extra noise if the caller has been doing checkpoint\n\t * dumps, but it might also eliminate some false\n\t * positives for resources previously reported during\n\t * checkpoints.\n\t */\n\tgit_win32__crtdbg_stacktrace__dump(\n\t\tGIT_WIN32__CRTDBG_STACKTRACE__LEAKS_TOTAL,\n\t\t\"CLEANUP\");\n\n\tDeleteCriticalSection(&g_crtdbg_stacktrace_cs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_mutex_free",
          "args": [
            "&git__mwindow_mutex"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "104-108",
          "snippet": "int git_mutex_free(git_mutex *mutex)\n{\n\tDeleteCriticalSection(mutex);\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nint git_mutex_free(git_mutex *mutex)\n{\n\tDeleteCriticalSection(mutex);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TlsFree",
          "args": [
            "_tls_index"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free_tls_data",
          "args": [],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "git__free_tls_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "217-226",
          "snippet": "void git__free_tls_data(void)\n{\n\tvoid *ptr = TlsGetValue(_tls_index);\n\tif (!ptr)\n\t\treturn;\n\n\tgit__global_state_cleanup(ptr);\n\tgit__free(ptr);\n\tTlsSetValue(_tls_index, NULL);\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid git__free_tls_data(void)\n{\n\tvoid *ptr = TlsGetValue(_tls_index);\n\tif (!ptr)\n\t\treturn;\n\n\tgit__global_state_cleanup(ptr);\n\tgit__free(ptr);\n\tTlsSetValue(_tls_index, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shutdown_common",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "shutdown_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "71-89",
          "snippet": "static void shutdown_common(void)\n{\n\tint pos;\n\n\t/* Shutdown subsystems that have registered */\n\tfor (pos = git_atomic_get(&git__n_shutdown_callbacks);\n\t\tpos > 0;\n\t\tpos = git_atomic_dec(&git__n_shutdown_callbacks)) {\n\n\t\tgit_global_shutdown_fn cb = git__swap(\n\t\t\tgit__shutdown_callbacks[pos - 1], NULL);\n\n\t\tif (cb != NULL)\n\t\t\tcb();\n\t}\n\n\tgit__free(git__user_agent);\n\tgit__free(git__ssl_ciphers);\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
            "static git_atomic git__n_shutdown_callbacks;",
            "char *git__user_agent;",
            "char *git__ssl_ciphers;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\nchar *git__user_agent;\nchar *git__ssl_ciphers;\n\nstatic void shutdown_common(void)\n{\n\tint pos;\n\n\t/* Shutdown subsystems that have registered */\n\tfor (pos = git_atomic_get(&git__n_shutdown_callbacks);\n\t\tpos > 0;\n\t\tpos = git_atomic_dec(&git__n_shutdown_callbacks)) {\n\n\t\tgit_global_shutdown_fn cb = git__swap(\n\t\t\tgit__shutdown_callbacks[pos - 1], NULL);\n\n\t\tif (cb != NULL)\n\t\t\tcb();\n\t}\n\n\tgit__free(git__user_agent);\n\tgit__free(git__ssl_ciphers);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_atomic_dec",
          "args": [
            "&git__n_inits"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "182-185",
          "snippet": "GIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Sleep",
          "args": [
            "0"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InterlockedCompareExchange",
          "args": [
            "&_mutex",
            "1",
            "0"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\ngit_mutex git__mwindow_mutex;\nstatic git_atomic git__n_inits;\n\nint git_libgit2_shutdown(void)\n{\n\tint ret;\n\n\t/* Enter the lock */\n\twhile (InterlockedCompareExchange(&_mutex, 1, 0)) { Sleep(0); }\n\n\t/* Only do work on a 1 -> 0 transition of the refcount */\n\tif ((ret = git_atomic_dec(&git__n_inits)) == 0) {\n\t\tshutdown_common();\n\n\t\tgit__free_tls_data();\n\n\t\tTlsFree(_tls_index);\n\t\tgit_mutex_free(&git__mwindow_mutex);\n\n#if defined(GIT_MSVC_CRTDBG)\n\t\tgit_win32__crtdbg_stacktrace_cleanup();\n\t\tgit_win32__stack_cleanup();\n#endif\n\t}\n\n\t/* Exit the lock */\n\tInterlockedExchange(&_mutex, 0);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git_libgit2_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "146-163",
    "snippet": "int git_libgit2_init(void)\n{\n\tint ret;\n\n\t/* Enter the lock */\n\twhile (InterlockedCompareExchange(&_mutex, 1, 0)) { Sleep(0); }\n\n\t/* Only do work on a 0 -> 1 transition of the refcount */\n\tif ((ret = git_atomic_inc(&git__n_inits)) == 1) {\n\t\tif (synchronized_threads_init() < 0)\n\t\t\tret = -1;\n\t}\n\n\t/* Exit the lock */\n\tInterlockedExchange(&_mutex, 0);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_atomic git__n_inits;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "InterlockedExchange",
          "args": [
            "&_mutex",
            "0"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "synchronized_threads_init",
          "args": [],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "synchronized_threads_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "130-144",
          "snippet": "static int synchronized_threads_init(void)\n{\n\tint error;\n\n\t_tls_index = TlsAlloc();\n\n\tgit_threads_init();\n\n\tif (git_mutex_init(&git__mwindow_mutex))\n\t\treturn -1;\n\n\terror = init_common();\n\n\treturn error;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "git_mutex git__mwindow_mutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\ngit_mutex git__mwindow_mutex;\n\nstatic int synchronized_threads_init(void)\n{\n\tint error;\n\n\t_tls_index = TlsAlloc();\n\n\tgit_threads_init();\n\n\tif (git_mutex_init(&git__mwindow_mutex))\n\t\treturn -1;\n\n\terror = init_common();\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_atomic_inc",
          "args": [
            "&git__n_inits"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "171-174",
          "snippet": "GIT_INLINE(int) git_atomic_inc(git_atomic *a)\n{\n\treturn ++a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_inc(git_atomic *a)\n{\n\treturn ++a->val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Sleep",
          "args": [
            "0"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InterlockedCompareExchange",
          "args": [
            "&_mutex",
            "1",
            "0"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_atomic git__n_inits;\n\nint git_libgit2_init(void)\n{\n\tint ret;\n\n\t/* Enter the lock */\n\twhile (InterlockedCompareExchange(&_mutex, 1, 0)) { Sleep(0); }\n\n\t/* Only do work on a 0 -> 1 transition of the refcount */\n\tif ((ret = git_atomic_inc(&git__n_inits)) == 1) {\n\t\tif (synchronized_threads_init() < 0)\n\t\t\tret = -1;\n\t}\n\n\t/* Exit the lock */\n\tInterlockedExchange(&_mutex, 0);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "synchronized_threads_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "130-144",
    "snippet": "static int synchronized_threads_init(void)\n{\n\tint error;\n\n\t_tls_index = TlsAlloc();\n\n\tgit_threads_init();\n\n\tif (git_mutex_init(&git__mwindow_mutex))\n\t\treturn -1;\n\n\terror = init_common();\n\n\treturn error;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "git_mutex git__mwindow_mutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_common",
          "args": [],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "init_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "48-69",
          "snippet": "static int init_common(void)\n{\n\tint ret;\n\n\t/* Initialize the CRT debug allocator first, before our first malloc */\n#if defined(GIT_MSVC_CRTDBG)\n\tgit_win32__crtdbg_stacktrace_init();\n\tgit_win32__stack_init();\n#endif\n\n\t/* Initialize any other subsystems that have global state */\n\tif ((ret = git_hash_global_init()) == 0 &&\n\t\t(ret = git_sysdir_global_init()) == 0 &&\n\t\t(ret = git_filter_global_init()) == 0 &&\n\t\t(ret = git_transport_ssh_global_init()) == 0 &&\n\t\t(ret = git_openssl_stream_global_init()) == 0)\n\t\tret = git_mwindow_global_init();\n\n\tGIT_MEMORY_BARRIER;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic int init_common(void)\n{\n\tint ret;\n\n\t/* Initialize the CRT debug allocator first, before our first malloc */\n#if defined(GIT_MSVC_CRTDBG)\n\tgit_win32__crtdbg_stacktrace_init();\n\tgit_win32__stack_init();\n#endif\n\n\t/* Initialize any other subsystems that have global state */\n\tif ((ret = git_hash_global_init()) == 0 &&\n\t\t(ret = git_sysdir_global_init()) == 0 &&\n\t\t(ret = git_filter_global_init()) == 0 &&\n\t\t(ret = git_transport_ssh_global_init()) == 0 &&\n\t\t(ret = git_openssl_stream_global_init()) == 0)\n\t\tret = git_mwindow_global_init();\n\n\tGIT_MEMORY_BARRIER;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_mutex_init",
          "args": [
            "&git__mwindow_mutex"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "140-141",
          "snippet": "GIT_INLINE(int) git_mutex_init(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [
            "#define git_mutex unsigned int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\n#define git_mutex unsigned int\n\nGIT_INLINE(int) git_mutex_init(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "git_threads_init",
          "args": [],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "git_threads_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "36-54",
          "snippet": "int git_threads_init(void)\n{\n\tHMODULE hModule = GetModuleHandleW(L\"kernel32\");\n\n\tif (hModule) {\n\t\twin32_srwlock_initialize = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"InitializeSRWLock\");\n\t\twin32_srwlock_acquire_shared = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"AcquireSRWLockShared\");\n\t\twin32_srwlock_release_shared = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"ReleaseSRWLockShared\");\n\t\twin32_srwlock_acquire_exclusive = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"AcquireSRWLockExclusive\");\n\t\twin32_srwlock_release_exclusive = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"ReleaseSRWLockExclusive\");\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static win32_srwlock_fn win32_srwlock_initialize;",
            "static win32_srwlock_fn win32_srwlock_acquire_shared;",
            "static win32_srwlock_fn win32_srwlock_release_shared;",
            "static win32_srwlock_fn win32_srwlock_acquire_exclusive;",
            "static win32_srwlock_fn win32_srwlock_release_exclusive;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nstatic win32_srwlock_fn win32_srwlock_initialize;\nstatic win32_srwlock_fn win32_srwlock_acquire_shared;\nstatic win32_srwlock_fn win32_srwlock_release_shared;\nstatic win32_srwlock_fn win32_srwlock_acquire_exclusive;\nstatic win32_srwlock_fn win32_srwlock_release_exclusive;\n\nint git_threads_init(void)\n{\n\tHMODULE hModule = GetModuleHandleW(L\"kernel32\");\n\n\tif (hModule) {\n\t\twin32_srwlock_initialize = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"InitializeSRWLock\");\n\t\twin32_srwlock_acquire_shared = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"AcquireSRWLockShared\");\n\t\twin32_srwlock_release_shared = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"ReleaseSRWLockShared\");\n\t\twin32_srwlock_acquire_exclusive = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"AcquireSRWLockExclusive\");\n\t\twin32_srwlock_release_exclusive = (win32_srwlock_fn)\n\t\t\tGetProcAddress(hModule, \"ReleaseSRWLockExclusive\");\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TlsAlloc",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\ngit_mutex git__mwindow_mutex;\n\nstatic int synchronized_threads_init(void)\n{\n\tint error;\n\n\t_tls_index = TlsAlloc();\n\n\tgit_threads_init();\n\n\tif (git_mutex_init(&git__mwindow_mutex))\n\t\treturn -1;\n\n\terror = init_common();\n\n\treturn error;\n}"
  },
  {
    "function_name": "shutdown_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "71-89",
    "snippet": "static void shutdown_common(void)\n{\n\tint pos;\n\n\t/* Shutdown subsystems that have registered */\n\tfor (pos = git_atomic_get(&git__n_shutdown_callbacks);\n\t\tpos > 0;\n\t\tpos = git_atomic_dec(&git__n_shutdown_callbacks)) {\n\n\t\tgit_global_shutdown_fn cb = git__swap(\n\t\t\tgit__shutdown_callbacks[pos - 1], NULL);\n\n\t\tif (cb != NULL)\n\t\t\tcb();\n\t}\n\n\tgit__free(git__user_agent);\n\tgit__free(git__ssl_ciphers);\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
      "static git_atomic git__n_shutdown_callbacks;",
      "char *git__user_agent;",
      "char *git__ssl_ciphers;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "git__ssl_ciphers"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cb",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__swap",
          "args": [
            "git__shutdown_callbacks[pos - 1]",
            "NULL"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_atomic_dec",
          "args": [
            "&git__n_shutdown_callbacks"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "182-185",
          "snippet": "GIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_dec(git_atomic *a)\n{\n\treturn --a->val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_atomic_get",
          "args": [
            "&git__n_shutdown_callbacks"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "217-220",
          "snippet": "GIT_INLINE(int) git_atomic_get(git_atomic *a)\n{\n\treturn (int)a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_get(git_atomic *a)\n{\n\treturn (int)a->val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\nchar *git__user_agent;\nchar *git__ssl_ciphers;\n\nstatic void shutdown_common(void)\n{\n\tint pos;\n\n\t/* Shutdown subsystems that have registered */\n\tfor (pos = git_atomic_get(&git__n_shutdown_callbacks);\n\t\tpos > 0;\n\t\tpos = git_atomic_dec(&git__n_shutdown_callbacks)) {\n\n\t\tgit_global_shutdown_fn cb = git__swap(\n\t\t\tgit__shutdown_callbacks[pos - 1], NULL);\n\n\t\tif (cb != NULL)\n\t\t\tcb();\n\t}\n\n\tgit__free(git__user_agent);\n\tgit__free(git__ssl_ciphers);\n}"
  },
  {
    "function_name": "init_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "48-69",
    "snippet": "static int init_common(void)\n{\n\tint ret;\n\n\t/* Initialize the CRT debug allocator first, before our first malloc */\n#if defined(GIT_MSVC_CRTDBG)\n\tgit_win32__crtdbg_stacktrace_init();\n\tgit_win32__stack_init();\n#endif\n\n\t/* Initialize any other subsystems that have global state */\n\tif ((ret = git_hash_global_init()) == 0 &&\n\t\t(ret = git_sysdir_global_init()) == 0 &&\n\t\t(ret = git_filter_global_init()) == 0 &&\n\t\t(ret = git_transport_ssh_global_init()) == 0 &&\n\t\t(ret = git_openssl_stream_global_init()) == 0)\n\t\tret = git_mwindow_global_init();\n\n\tGIT_MEMORY_BARRIER;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_mwindow_global_init",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "git_mwindow_global_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/mwindow.c",
          "lines": "44-50",
          "snippet": "int git_mwindow_global_init(void)\n{\n\tassert(!git__pack_cache);\n\n\tgit__on_shutdown(git_mwindow_files_free);\n\treturn git_strmap_alloc(&git__pack_cache);\n}",
          "includes": [
            "#include \"pack.h\"",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"map.h\"",
            "#include \"fileops.h\"",
            "#include \"vector.h\"",
            "#include \"mwindow.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "git_strmap *git__pack_cache = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pack.h\"\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"map.h\"\n#include \"fileops.h\"\n#include \"vector.h\"\n#include \"mwindow.h\"\n#include \"common.h\"\n\ngit_strmap *git__pack_cache = NULL;\n\nint git_mwindow_global_init(void)\n{\n\tassert(!git__pack_cache);\n\n\tgit__on_shutdown(git_mwindow_files_free);\n\treturn git_strmap_alloc(&git__pack_cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_openssl_stream_global_init",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "git_openssl_stream_global_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/openssl_stream.c",
          "lines": "629-632",
          "snippet": "int git_openssl_stream_global_init(void)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/openssl.h\"",
            "#include \"stream.h\"",
            "#include <openssl/bio.h>",
            "#include <openssl/x509v3.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "# include <netinet/in.h>",
            "# include <sys/socket.h>",
            "# include <sys/types.h>",
            "# include \"curl_stream.h\"",
            "#include \"git2/sys/openssl.h\"",
            "#include \"git2/transport.h\"",
            "#include \"netops.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/openssl.h\"\n#include \"stream.h\"\n#include <openssl/bio.h>\n#include <openssl/x509v3.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n# include <netinet/in.h>\n# include <sys/socket.h>\n# include <sys/types.h>\n# include \"curl_stream.h\"\n#include \"git2/sys/openssl.h\"\n#include \"git2/transport.h\"\n#include \"netops.h\"\n#include \"openssl_stream.h\"\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include <ctype.h>\n\nint git_openssl_stream_global_init(void)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_transport_ssh_global_init",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "git_transport_ssh_global_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/ssh.c",
          "lines": "896-909",
          "snippet": "int git_transport_ssh_global_init(void)\n{\n#ifdef GIT_SSH\n\n\tlibssh2_init(0);\n\treturn 0;\n\n#else\n\n\t/* Nothing to initialize */\n\treturn 0;\n\n#endif\n}",
          "includes": [
            "#include \"ssh.h\"",
            "#include \"socket_stream.h\"",
            "#include \"cred.h\"",
            "#include \"smart.h\"",
            "#include \"netops.h\"",
            "#include \"buffer.h\"",
            "#include \"git2.h\"",
            "#include <libssh2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh.h\"\n#include \"socket_stream.h\"\n#include \"cred.h\"\n#include \"smart.h\"\n#include \"netops.h\"\n#include \"buffer.h\"\n#include \"git2.h\"\n#include <libssh2.h>\n\nint git_transport_ssh_global_init(void)\n{\n#ifdef GIT_SSH\n\n\tlibssh2_init(0);\n\treturn 0;\n\n#else\n\n\t/* Nothing to initialize */\n\treturn 0;\n\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filter_global_init",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_global_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "188-217",
          "snippet": "int git_filter_global_init(void)\n{\n\tgit_filter *crlf = NULL, *ident = NULL;\n\tint error = 0;\n\n\tif (git_rwlock_init(&filter_registry.lock) < 0)\n\t\treturn -1;\n\n\tif ((error = git_vector_init(&filter_registry.filters, 2,\n\t\tfilter_def_priority_cmp)) < 0)\n\t\tgoto done;\n\n\tif ((crlf = git_crlf_filter_new()) == NULL ||\n\t\tfilter_registry_insert(\n\t\t\tGIT_FILTER_CRLF, crlf, GIT_FILTER_CRLF_PRIORITY) < 0 ||\n\t\t(ident = git_ident_filter_new()) == NULL ||\n\t\tfilter_registry_insert(\n\t\t\tGIT_FILTER_IDENT, ident, GIT_FILTER_IDENT_PRIORITY) < 0)\n\t\terror = -1;\n\n\tgit__on_shutdown(git_filter_global_shutdown);\n\ndone:\n\tif (error) {\n\t\tgit_filter_free(crlf);\n\t\tgit_filter_free(ident);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_filter_registry filter_registry;",
            "static void git_filter_global_shutdown(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nstatic struct git_filter_registry filter_registry;\nstatic void git_filter_global_shutdown(void);\n\nint git_filter_global_init(void)\n{\n\tgit_filter *crlf = NULL, *ident = NULL;\n\tint error = 0;\n\n\tif (git_rwlock_init(&filter_registry.lock) < 0)\n\t\treturn -1;\n\n\tif ((error = git_vector_init(&filter_registry.filters, 2,\n\t\tfilter_def_priority_cmp)) < 0)\n\t\tgoto done;\n\n\tif ((crlf = git_crlf_filter_new()) == NULL ||\n\t\tfilter_registry_insert(\n\t\t\tGIT_FILTER_CRLF, crlf, GIT_FILTER_CRLF_PRIORITY) < 0 ||\n\t\t(ident = git_ident_filter_new()) == NULL ||\n\t\tfilter_registry_insert(\n\t\t\tGIT_FILTER_IDENT, ident, GIT_FILTER_IDENT_PRIORITY) < 0)\n\t\terror = -1;\n\n\tgit__on_shutdown(git_filter_global_shutdown);\n\ndone:\n\tif (error) {\n\t\tgit_filter_free(crlf);\n\t\tgit_filter_free(ident);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_sysdir_global_init",
          "args": [],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_global_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "107-118",
          "snippet": "int git_sysdir_global_init(void)\n{\n\tsize_t i;\n\tint error = 0;\n\n\tfor (i = 0; !error && i < ARRAY_SIZE(git_sysdir__dirs); i++)\n\t\terror = git_sysdir__dirs[i].guess(&git_sysdir__dirs[i].buf);\n\n\tgit__on_shutdown(git_sysdir_global_shutdown);\n\n\treturn error;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nstatic struct git_sysdir__dir git_sysdir__dirs[] = {\n\t{ GIT_BUF_INIT, git_sysdir_guess_system_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_global_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_xdg_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_programdata_dirs },\n\t{ GIT_BUF_INIT, git_sysdir_guess_template_dirs },\n};\n\nint git_sysdir_global_init(void)\n{\n\tsize_t i;\n\tint error = 0;\n\n\tfor (i = 0; !error && i < ARRAY_SIZE(git_sysdir__dirs); i++)\n\t\terror = git_sysdir__dirs[i].guess(&git_sysdir__dirs[i].buf);\n\n\tgit__on_shutdown(git_sysdir_global_shutdown);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_hash_global_init",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_global_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "100-113",
          "snippet": "int git_hash_global_init(void)\n{\n\tint error = 0;\n\n\tif (hash_prov.type != INVALID)\n\t\treturn 0;\n\n\tif ((error = hash_cng_prov_init()) < 0)\n\t\terror = hash_cryptoapi_prov_init();\n\n\tgit__on_shutdown(git_hash_global_shutdown);\n\n\treturn error;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nint git_hash_global_init(void)\n{\n\tint error = 0;\n\n\tif (hash_prov.type != INVALID)\n\t\treturn 0;\n\n\tif ((error = hash_cng_prov_init()) < 0)\n\t\terror = hash_cryptoapi_prov_init();\n\n\tgit__on_shutdown(git_hash_global_shutdown);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__stack_init",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__stack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_stack.c",
          "lines": "35-43",
          "snippet": "void git_win32__stack_init(void)\n{\n\tif (!g_win32_stack_initialized) {\n\t\tg_win32_stack_process = GetCurrentProcess();\n\t\tSymSetOptions(SYMOPT_LOAD_LINES);\n\t\tSymInitialize(g_win32_stack_process, NULL, TRUE);\n\t\tg_win32_stack_initialized = true;\n\t}\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"w32_stack.h\"",
            "#include \"win32/posix.h\"",
            "#include \"Dbghelp.h\"",
            "#include \"Windows.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"w32_stack.h\"\n#include \"win32/posix.h\"\n#include \"Dbghelp.h\"\n#include \"Windows.h\"\n\nvoid git_win32__stack_init(void)\n{\n\tif (!g_win32_stack_initialized) {\n\t\tg_win32_stack_process = GetCurrentProcess();\n\t\tSymSetOptions(SYMOPT_LOAD_LINES);\n\t\tSymInitialize(g_win32_stack_process, NULL, TRUE);\n\t\tg_win32_stack_initialized = true;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__crtdbg_stacktrace_init",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__crtdbg_stacktrace_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_crtdbg_stacktrace.c",
          "lines": "221-238",
          "snippet": "void git_win32__crtdbg_stacktrace_init(void)\n{\n\tInitializeCriticalSection(&g_crtdbg_stacktrace_cs);\n\n\tEnterCriticalSection(&g_crtdbg_stacktrace_cs);\n\n\t_CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);\n\n\t_CrtSetReportMode(_CRT_ASSERT, _CRTDBG_MODE_DEBUG | _CRTDBG_MODE_FILE);\n\t_CrtSetReportMode(_CRT_ERROR,  _CRTDBG_MODE_DEBUG | _CRTDBG_MODE_FILE);\n\t_CrtSetReportMode(_CRT_WARN,   _CRTDBG_MODE_DEBUG | _CRTDBG_MODE_FILE);\n\n\t_CrtSetReportFile(_CRT_ASSERT, _CRTDBG_FILE_STDERR);\n\t_CrtSetReportFile(_CRT_ERROR,  _CRTDBG_FILE_STDERR);\n\t_CrtSetReportFile(_CRT_WARN,   _CRTDBG_FILE_STDERR);\n\n\tLeaveCriticalSection(&g_crtdbg_stacktrace_cs);\n}",
          "includes": [
            "#include \"w32_crtdbg_stacktrace.h\"",
            "#include \"w32_stack.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"w32_crtdbg_stacktrace.h\"\n#include \"w32_stack.h\"\n\nvoid git_win32__crtdbg_stacktrace_init(void)\n{\n\tInitializeCriticalSection(&g_crtdbg_stacktrace_cs);\n\n\tEnterCriticalSection(&g_crtdbg_stacktrace_cs);\n\n\t_CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);\n\n\t_CrtSetReportMode(_CRT_ASSERT, _CRTDBG_MODE_DEBUG | _CRTDBG_MODE_FILE);\n\t_CrtSetReportMode(_CRT_ERROR,  _CRTDBG_MODE_DEBUG | _CRTDBG_MODE_FILE);\n\t_CrtSetReportMode(_CRT_WARN,   _CRTDBG_MODE_DEBUG | _CRTDBG_MODE_FILE);\n\n\t_CrtSetReportFile(_CRT_ASSERT, _CRTDBG_FILE_STDERR);\n\t_CrtSetReportFile(_CRT_ERROR,  _CRTDBG_FILE_STDERR);\n\t_CrtSetReportFile(_CRT_WARN,   _CRTDBG_FILE_STDERR);\n\n\tLeaveCriticalSection(&g_crtdbg_stacktrace_cs);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic int init_common(void)\n{\n\tint ret;\n\n\t/* Initialize the CRT debug allocator first, before our first malloc */\n#if defined(GIT_MSVC_CRTDBG)\n\tgit_win32__crtdbg_stacktrace_init();\n\tgit_win32__stack_init();\n#endif\n\n\t/* Initialize any other subsystems that have global state */\n\tif ((ret = git_hash_global_init()) == 0 &&\n\t\t(ret = git_sysdir_global_init()) == 0 &&\n\t\t(ret = git_filter_global_init()) == 0 &&\n\t\t(ret = git_transport_ssh_global_init()) == 0 &&\n\t\t(ret = git_openssl_stream_global_init()) == 0)\n\t\tret = git_mwindow_global_init();\n\n\tGIT_MEMORY_BARRIER;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "git__global_state_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "39-46",
    "snippet": "static void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "st->error_t.message"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic void git__global_state_cleanup(git_global_st *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tgit__free(st->error_t.message);\n\tst->error_t.message = NULL;\n}"
  },
  {
    "function_name": "git__on_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
    "lines": "32-37",
    "snippet": "void git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}",
    "includes": [
      "#include \"win32/w32_crtdbg_stacktrace.h\"",
      "#include \"win32/w32_stack.h\"",
      "#include \"transports/ssh.h\"",
      "#include \"git2/global.h\"",
      "#include \"thread-utils.h\"",
      "#include \"openssl_stream.h\"",
      "#include \"filter.h\"",
      "#include \"sysdir.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [
      "#define MAX_SHUTDOWN_CB 8"
    ],
    "globals_used": [
      "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
      "static git_atomic git__n_shutdown_callbacks;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "count <= MAX_SHUTDOWN_CB && count > 0"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_atomic_inc",
          "args": [
            "&git__n_shutdown_callbacks"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "171-174",
          "snippet": "GIT_INLINE(int) git_atomic_inc(git_atomic *a)\n{\n\treturn ++a->val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(int) git_atomic_inc(git_atomic *a)\n{\n\treturn ++a->val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\n#define MAX_SHUTDOWN_CB 8\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\n\nvoid git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}"
  }
]