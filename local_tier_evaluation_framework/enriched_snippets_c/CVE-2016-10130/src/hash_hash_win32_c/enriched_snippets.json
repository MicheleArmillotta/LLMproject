[
  {
    "function_name": "git_hash_ctx_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "268-276",
    "snippet": "void git_hash_ctx_cleanup(git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\n\tif (ctx->type == CNG)\n\t\thash_ctx_cng_cleanup(ctx);\n\telse if(ctx->type == CRYPTOAPI)\n\t\thash_ctx_cryptoapi_cleanup(ctx);\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_ctx_cryptoapi_cleanup",
          "args": [
            "ctx"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "hash_ctx_cryptoapi_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "165-169",
          "snippet": "GIT_INLINE(void) hash_ctx_cryptoapi_cleanup(git_hash_ctx *ctx)\n{\n\tif (ctx->ctx.cryptoapi.valid)\n\t\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) hash_ctx_cryptoapi_cleanup(git_hash_ctx *ctx)\n{\n\tif (ctx->ctx.cryptoapi.valid)\n\t\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_ctx_cng_cleanup",
          "args": [
            "ctx"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "hash_ctx_cng_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "223-227",
          "snippet": "GIT_INLINE(void) hash_ctx_cng_cleanup(git_hash_ctx *ctx)\n{\n\tctx->prov->prov.cng.destroy_hash(ctx->ctx.cng.hash_handle);\n\tgit__free(ctx->ctx.cng.hash_object);\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) hash_ctx_cng_cleanup(git_hash_ctx *ctx)\n{\n\tctx->prov->prov.cng.destroy_hash(ctx->ctx.cng.hash_handle);\n\tgit__free(ctx->ctx.cng.hash_object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ctx"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid git_hash_ctx_cleanup(git_hash_ctx *ctx)\n{\n\tassert(ctx);\n\n\tif (ctx->type == CNG)\n\t\thash_ctx_cng_cleanup(ctx);\n\telse if(ctx->type == CRYPTOAPI)\n\t\thash_ctx_cryptoapi_cleanup(ctx);\n}"
  },
  {
    "function_name": "git_hash_final",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "262-266",
    "snippet": "int git_hash_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tassert(ctx && ctx->type);\n\treturn (ctx->type == CNG) ? hash_cng_final(out, ctx) : hash_cryptoapi_final(out, ctx);\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_cryptoapi_final",
          "args": [
            "out",
            "ctx"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cryptoapi_final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "149-163",
          "snippet": "GIT_INLINE(int) hash_cryptoapi_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tDWORD len = 20;\n\tint error = 0;\n\n\tassert(ctx->ctx.cryptoapi.valid);\n\n\tif (!CryptGetHashParam(ctx->ctx.cryptoapi.hash_handle, HP_HASHVAL, out->id, &len, 0))\n\t\terror = -1;\n\n\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n\tctx->ctx.cryptoapi.valid = 0;\n\n\treturn error;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cryptoapi_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tDWORD len = 20;\n\tint error = 0;\n\n\tassert(ctx->ctx.cryptoapi.valid);\n\n\tif (!CryptGetHashParam(ctx->ctx.cryptoapi.hash_handle, HP_HASHVAL, out->id, &len, 0))\n\t\terror = -1;\n\n\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n\tctx->ctx.cryptoapi.valid = 0;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_cng_final",
          "args": [
            "out",
            "ctx"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cng_final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "213-221",
          "snippet": "GIT_INLINE(int) hash_cng_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tif (ctx->prov->prov.cng.finish_hash(ctx->ctx.cng.hash_handle, out->id, GIT_OID_RAWSZ, 0) < 0)\n\t\treturn -1;\n\n\tctx->ctx.cng.updated = 0;\n\n\treturn 0;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cng_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tif (ctx->prov->prov.cng.finish_hash(ctx->ctx.cng.hash_handle, out->id, GIT_OID_RAWSZ, 0) < 0)\n\t\treturn -1;\n\n\tctx->ctx.cng.updated = 0;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ctx && ctx->type"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint git_hash_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tassert(ctx && ctx->type);\n\treturn (ctx->type == CNG) ? hash_cng_final(out, ctx) : hash_cryptoapi_final(out, ctx);\n}"
  },
  {
    "function_name": "git_hash_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "256-260",
    "snippet": "int git_hash_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx && ctx->type);\n\treturn (ctx->type == CNG) ? hash_cng_update(ctx, data, len) : hash_cryptoapi_update(ctx, data, len);\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_cryptoapi_update",
          "args": [
            "ctx",
            "data",
            "len"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cryptoapi_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "139-147",
          "snippet": "GIT_INLINE(int) hash_cryptoapi_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx->ctx.cryptoapi.valid);\n\n\tif (!CryptHashData(ctx->ctx.cryptoapi.hash_handle, (const BYTE *)data, (DWORD)len, 0))\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cryptoapi_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx->ctx.cryptoapi.valid);\n\n\tif (!CryptHashData(ctx->ctx.cryptoapi.hash_handle, (const BYTE *)data, (DWORD)len, 0))\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_cng_update",
          "args": [
            "ctx",
            "data",
            "len"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cng_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "205-211",
          "snippet": "GIT_INLINE(int) hash_cng_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tif (ctx->prov->prov.cng.hash_data(ctx->ctx.cng.hash_handle, (PBYTE)data, (ULONG)len, 0) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cng_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tif (ctx->prov->prov.cng.hash_data(ctx->ctx.cng.hash_handle, (PBYTE)data, (ULONG)len, 0) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ctx && ctx->type"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint git_hash_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx && ctx->type);\n\treturn (ctx->type == CNG) ? hash_cng_update(ctx, data, len) : hash_cryptoapi_update(ctx, data, len);\n}"
  },
  {
    "function_name": "git_hash_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "250-254",
    "snippet": "int git_hash_init(git_hash_ctx *ctx)\n{\n\tassert(ctx && ctx->type);\n\treturn (ctx->type == CNG) ? hash_cng_init(ctx) : hash_cryptoapi_init(ctx);\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_cryptoapi_init",
          "args": [
            "ctx"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cryptoapi_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "125-137",
          "snippet": "GIT_INLINE(int) hash_cryptoapi_init(git_hash_ctx *ctx)\n{\n\tif (ctx->ctx.cryptoapi.valid)\n\t\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n\n\tif (!CryptCreateHash(ctx->prov->prov.cryptoapi.handle, CALG_SHA1, 0, 0, &ctx->ctx.cryptoapi.hash_handle)) {\n\t\tctx->ctx.cryptoapi.valid = 0;\n\t\treturn -1;\n\t}\n\n\tctx->ctx.cryptoapi.valid = 1;\n\treturn 0;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cryptoapi_init(git_hash_ctx *ctx)\n{\n\tif (ctx->ctx.cryptoapi.valid)\n\t\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n\n\tif (!CryptCreateHash(ctx->prov->prov.cryptoapi.handle, CALG_SHA1, 0, 0, &ctx->ctx.cryptoapi.hash_handle)) {\n\t\tctx->ctx.cryptoapi.valid = 0;\n\t\treturn -1;\n\t}\n\n\tctx->ctx.cryptoapi.valid = 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_cng_init",
          "args": [
            "ctx"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cng_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "189-203",
          "snippet": "GIT_INLINE(int) hash_cng_init(git_hash_ctx *ctx)\n{\n\tBYTE hash[GIT_OID_RAWSZ];\n\n\tif (!ctx->ctx.cng.updated)\n\t\treturn 0;\n\n\t/* CNG needs to be finished to restart */\n\tif (ctx->prov->prov.cng.finish_hash(ctx->ctx.cng.hash_handle, hash, GIT_OID_RAWSZ, 0) < 0)\n\t\treturn -1;\n\n\tctx->ctx.cng.updated = 0;\n\n\treturn 0;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cng_init(git_hash_ctx *ctx)\n{\n\tBYTE hash[GIT_OID_RAWSZ];\n\n\tif (!ctx->ctx.cng.updated)\n\t\treturn 0;\n\n\t/* CNG needs to be finished to restart */\n\tif (ctx->prov->prov.cng.finish_hash(ctx->ctx.cng.hash_handle, hash, GIT_OID_RAWSZ, 0) < 0)\n\t\treturn -1;\n\n\tctx->ctx.cng.updated = 0;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ctx && ctx->type"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint git_hash_init(git_hash_ctx *ctx)\n{\n\tassert(ctx && ctx->type);\n\treturn (ctx->type == CNG) ? hash_cng_init(ctx) : hash_cryptoapi_init(ctx);\n}"
  },
  {
    "function_name": "git_hash_ctx_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "231-248",
    "snippet": "int git_hash_ctx_init(git_hash_ctx *ctx)\n{\n\tint error = 0;\n\n\tassert(ctx);\n\n\t/*\n\t * When compiled with GIT_THREADS, the global hash_prov data is\n\t * initialized with git_libgit2_init.  Otherwise, it must be initialized\n\t * at first use.\n\t */\n\tif (hash_prov.type == INVALID && (error = git_hash_global_init()) < 0)\n\t\treturn error;\n\n\tmemset(ctx, 0x0, sizeof(git_hash_ctx));\n\n\treturn (hash_prov.type == CNG) ? hash_ctx_cng_init(ctx) : hash_ctx_cryptoapi_init(ctx);\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_hash_prov hash_prov = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_ctx_cryptoapi_init",
          "args": [
            "ctx"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "hash_ctx_cryptoapi_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "117-123",
          "snippet": "GIT_INLINE(int) hash_ctx_cryptoapi_init(git_hash_ctx *ctx)\n{\n\tctx->type = CRYPTOAPI;\n\tctx->prov = &hash_prov;\n\n\treturn git_hash_init(ctx);\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(int) hash_ctx_cryptoapi_init(git_hash_ctx *ctx)\n{\n\tctx->type = CRYPTOAPI;\n\tctx->prov = &hash_prov;\n\n\treturn git_hash_init(ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_ctx_cng_init",
          "args": [
            "ctx"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "hash_ctx_cng_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "173-187",
          "snippet": "GIT_INLINE(int) hash_ctx_cng_init(git_hash_ctx *ctx)\n{\n\tif ((ctx->ctx.cng.hash_object = git__malloc(hash_prov.prov.cng.hash_object_size)) == NULL)\n\t\treturn -1;\n\n\tif (hash_prov.prov.cng.create_hash(hash_prov.prov.cng.handle, &ctx->ctx.cng.hash_handle, ctx->ctx.cng.hash_object, hash_prov.prov.cng.hash_object_size, NULL, 0, 0) < 0) {\n\t\tgit__free(ctx->ctx.cng.hash_object);\n\t\treturn -1;\n\t}\n\n\tctx->type = CNG;\n\tctx->prov = &hash_prov;\n\n\treturn 0;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(int) hash_ctx_cng_init(git_hash_ctx *ctx)\n{\n\tif ((ctx->ctx.cng.hash_object = git__malloc(hash_prov.prov.cng.hash_object_size)) == NULL)\n\t\treturn -1;\n\n\tif (hash_prov.prov.cng.create_hash(hash_prov.prov.cng.handle, &ctx->ctx.cng.hash_handle, ctx->ctx.cng.hash_object, hash_prov.prov.cng.hash_object_size, NULL, 0, 0) < 0) {\n\t\tgit__free(ctx->ctx.cng.hash_object);\n\t\treturn -1;\n\t}\n\n\tctx->type = CNG;\n\tctx->prov = &hash_prov;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ctx",
            "0x0",
            "sizeof(git_hash_ctx)"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_hash_global_init",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_global_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "100-113",
          "snippet": "int git_hash_global_init(void)\n{\n\tint error = 0;\n\n\tif (hash_prov.type != INVALID)\n\t\treturn 0;\n\n\tif ((error = hash_cng_prov_init()) < 0)\n\t\terror = hash_cryptoapi_prov_init();\n\n\tgit__on_shutdown(git_hash_global_shutdown);\n\n\treturn error;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nint git_hash_global_init(void)\n{\n\tint error = 0;\n\n\tif (hash_prov.type != INVALID)\n\t\treturn 0;\n\n\tif ((error = hash_cng_prov_init()) < 0)\n\t\terror = hash_cryptoapi_prov_init();\n\n\tgit__on_shutdown(git_hash_global_shutdown);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ctx"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nint git_hash_ctx_init(git_hash_ctx *ctx)\n{\n\tint error = 0;\n\n\tassert(ctx);\n\n\t/*\n\t * When compiled with GIT_THREADS, the global hash_prov data is\n\t * initialized with git_libgit2_init.  Otherwise, it must be initialized\n\t * at first use.\n\t */\n\tif (hash_prov.type == INVALID && (error = git_hash_global_init()) < 0)\n\t\treturn error;\n\n\tmemset(ctx, 0x0, sizeof(git_hash_ctx));\n\n\treturn (hash_prov.type == CNG) ? hash_ctx_cng_init(ctx) : hash_ctx_cryptoapi_init(ctx);\n}"
  },
  {
    "function_name": "hash_ctx_cng_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "223-227",
    "snippet": "GIT_INLINE(void) hash_ctx_cng_cleanup(git_hash_ctx *ctx)\n{\n\tctx->prov->prov.cng.destroy_hash(ctx->ctx.cng.hash_handle);\n\tgit__free(ctx->ctx.cng.hash_object);\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "ctx->ctx.cng.hash_object"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctx->prov->prov.cng.destroy_hash",
          "args": [
            "ctx->ctx.cng.hash_handle"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) hash_ctx_cng_cleanup(git_hash_ctx *ctx)\n{\n\tctx->prov->prov.cng.destroy_hash(ctx->ctx.cng.hash_handle);\n\tgit__free(ctx->ctx.cng.hash_object);\n}"
  },
  {
    "function_name": "hash_cng_final",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "213-221",
    "snippet": "GIT_INLINE(int) hash_cng_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tif (ctx->prov->prov.cng.finish_hash(ctx->ctx.cng.hash_handle, out->id, GIT_OID_RAWSZ, 0) < 0)\n\t\treturn -1;\n\n\tctx->ctx.cng.updated = 0;\n\n\treturn 0;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ctx->prov->prov.cng.finish_hash",
          "args": [
            "ctx->ctx.cng.hash_handle",
            "out->id",
            "GIT_OID_RAWSZ",
            "0"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cng_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tif (ctx->prov->prov.cng.finish_hash(ctx->ctx.cng.hash_handle, out->id, GIT_OID_RAWSZ, 0) < 0)\n\t\treturn -1;\n\n\tctx->ctx.cng.updated = 0;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hash_cng_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "205-211",
    "snippet": "GIT_INLINE(int) hash_cng_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tif (ctx->prov->prov.cng.hash_data(ctx->ctx.cng.hash_handle, (PBYTE)data, (ULONG)len, 0) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ctx->prov->prov.cng.hash_data",
          "args": [
            "ctx->ctx.cng.hash_handle",
            "(PBYTE)data",
            "(ULONG)len",
            "0"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cng_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tif (ctx->prov->prov.cng.hash_data(ctx->ctx.cng.hash_handle, (PBYTE)data, (ULONG)len, 0) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hash_cng_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "189-203",
    "snippet": "GIT_INLINE(int) hash_cng_init(git_hash_ctx *ctx)\n{\n\tBYTE hash[GIT_OID_RAWSZ];\n\n\tif (!ctx->ctx.cng.updated)\n\t\treturn 0;\n\n\t/* CNG needs to be finished to restart */\n\tif (ctx->prov->prov.cng.finish_hash(ctx->ctx.cng.hash_handle, hash, GIT_OID_RAWSZ, 0) < 0)\n\t\treturn -1;\n\n\tctx->ctx.cng.updated = 0;\n\n\treturn 0;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ctx->prov->prov.cng.finish_hash",
          "args": [
            "ctx->ctx.cng.hash_handle",
            "hash",
            "GIT_OID_RAWSZ",
            "0"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cng_init(git_hash_ctx *ctx)\n{\n\tBYTE hash[GIT_OID_RAWSZ];\n\n\tif (!ctx->ctx.cng.updated)\n\t\treturn 0;\n\n\t/* CNG needs to be finished to restart */\n\tif (ctx->prov->prov.cng.finish_hash(ctx->ctx.cng.hash_handle, hash, GIT_OID_RAWSZ, 0) < 0)\n\t\treturn -1;\n\n\tctx->ctx.cng.updated = 0;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hash_ctx_cng_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "173-187",
    "snippet": "GIT_INLINE(int) hash_ctx_cng_init(git_hash_ctx *ctx)\n{\n\tif ((ctx->ctx.cng.hash_object = git__malloc(hash_prov.prov.cng.hash_object_size)) == NULL)\n\t\treturn -1;\n\n\tif (hash_prov.prov.cng.create_hash(hash_prov.prov.cng.handle, &ctx->ctx.cng.hash_handle, ctx->ctx.cng.hash_object, hash_prov.prov.cng.hash_object_size, NULL, 0, 0) < 0) {\n\t\tgit__free(ctx->ctx.cng.hash_object);\n\t\treturn -1;\n\t}\n\n\tctx->type = CNG;\n\tctx->prov = &hash_prov;\n\n\treturn 0;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_hash_prov hash_prov = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "ctx->ctx.cng.hash_object"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_prov.prov.cng.create_hash",
          "args": [
            "hash_prov.prov.cng.handle",
            "&ctx->ctx.cng.hash_handle",
            "ctx->ctx.cng.hash_object",
            "hash_prov.prov.cng.hash_object_size",
            "NULL",
            "0",
            "0"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "hash_prov.prov.cng.hash_object_size"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(int) hash_ctx_cng_init(git_hash_ctx *ctx)\n{\n\tif ((ctx->ctx.cng.hash_object = git__malloc(hash_prov.prov.cng.hash_object_size)) == NULL)\n\t\treturn -1;\n\n\tif (hash_prov.prov.cng.create_hash(hash_prov.prov.cng.handle, &ctx->ctx.cng.hash_handle, ctx->ctx.cng.hash_object, hash_prov.prov.cng.hash_object_size, NULL, 0, 0) < 0) {\n\t\tgit__free(ctx->ctx.cng.hash_object);\n\t\treturn -1;\n\t}\n\n\tctx->type = CNG;\n\tctx->prov = &hash_prov;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hash_ctx_cryptoapi_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "165-169",
    "snippet": "GIT_INLINE(void) hash_ctx_cryptoapi_cleanup(git_hash_ctx *ctx)\n{\n\tif (ctx->ctx.cryptoapi.valid)\n\t\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CryptDestroyHash",
          "args": [
            "ctx->ctx.cryptoapi.hash_handle"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) hash_ctx_cryptoapi_cleanup(git_hash_ctx *ctx)\n{\n\tif (ctx->ctx.cryptoapi.valid)\n\t\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n}"
  },
  {
    "function_name": "hash_cryptoapi_final",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "149-163",
    "snippet": "GIT_INLINE(int) hash_cryptoapi_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tDWORD len = 20;\n\tint error = 0;\n\n\tassert(ctx->ctx.cryptoapi.valid);\n\n\tif (!CryptGetHashParam(ctx->ctx.cryptoapi.hash_handle, HP_HASHVAL, out->id, &len, 0))\n\t\terror = -1;\n\n\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n\tctx->ctx.cryptoapi.valid = 0;\n\n\treturn error;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CryptDestroyHash",
          "args": [
            "ctx->ctx.cryptoapi.hash_handle"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CryptGetHashParam",
          "args": [
            "ctx->ctx.cryptoapi.hash_handle",
            "HP_HASHVAL",
            "out->id",
            "&len",
            "0"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ctx->ctx.cryptoapi.valid"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cryptoapi_final(git_oid *out, git_hash_ctx *ctx)\n{\n\tDWORD len = 20;\n\tint error = 0;\n\n\tassert(ctx->ctx.cryptoapi.valid);\n\n\tif (!CryptGetHashParam(ctx->ctx.cryptoapi.hash_handle, HP_HASHVAL, out->id, &len, 0))\n\t\terror = -1;\n\n\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n\tctx->ctx.cryptoapi.valid = 0;\n\n\treturn error;\n}"
  },
  {
    "function_name": "hash_cryptoapi_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "139-147",
    "snippet": "GIT_INLINE(int) hash_cryptoapi_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx->ctx.cryptoapi.valid);\n\n\tif (!CryptHashData(ctx->ctx.cryptoapi.hash_handle, (const BYTE *)data, (DWORD)len, 0))\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CryptHashData",
          "args": [
            "ctx->ctx.cryptoapi.hash_handle",
            "(const BYTE *)data",
            "(DWORD)len",
            "0"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "ctx->ctx.cryptoapi.valid"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cryptoapi_update(git_hash_ctx *ctx, const void *data, size_t len)\n{\n\tassert(ctx->ctx.cryptoapi.valid);\n\n\tif (!CryptHashData(ctx->ctx.cryptoapi.hash_handle, (const BYTE *)data, (DWORD)len, 0))\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hash_cryptoapi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "125-137",
    "snippet": "GIT_INLINE(int) hash_cryptoapi_init(git_hash_ctx *ctx)\n{\n\tif (ctx->ctx.cryptoapi.valid)\n\t\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n\n\tif (!CryptCreateHash(ctx->prov->prov.cryptoapi.handle, CALG_SHA1, 0, 0, &ctx->ctx.cryptoapi.hash_handle)) {\n\t\tctx->ctx.cryptoapi.valid = 0;\n\t\treturn -1;\n\t}\n\n\tctx->ctx.cryptoapi.valid = 1;\n\treturn 0;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CryptCreateHash",
          "args": [
            "ctx->prov->prov.cryptoapi.handle",
            "CALG_SHA1",
            "0",
            "0",
            "&ctx->ctx.cryptoapi.hash_handle"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CryptDestroyHash",
          "args": [
            "ctx->ctx.cryptoapi.hash_handle"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) hash_cryptoapi_init(git_hash_ctx *ctx)\n{\n\tif (ctx->ctx.cryptoapi.valid)\n\t\tCryptDestroyHash(ctx->ctx.cryptoapi.hash_handle);\n\n\tif (!CryptCreateHash(ctx->prov->prov.cryptoapi.handle, CALG_SHA1, 0, 0, &ctx->ctx.cryptoapi.hash_handle)) {\n\t\tctx->ctx.cryptoapi.valid = 0;\n\t\treturn -1;\n\t}\n\n\tctx->ctx.cryptoapi.valid = 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "hash_ctx_cryptoapi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "117-123",
    "snippet": "GIT_INLINE(int) hash_ctx_cryptoapi_init(git_hash_ctx *ctx)\n{\n\tctx->type = CRYPTOAPI;\n\tctx->prov = &hash_prov;\n\n\treturn git_hash_init(ctx);\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_hash_prov hash_prov = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_hash_init",
          "args": [
            "ctx"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "git_hash_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "250-254",
          "snippet": "int git_hash_init(git_hash_ctx *ctx)\n{\n\tassert(ctx && ctx->type);\n\treturn (ctx->type == CNG) ? hash_cng_init(ctx) : hash_cryptoapi_init(ctx);\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nint git_hash_init(git_hash_ctx *ctx)\n{\n\tassert(ctx && ctx->type);\n\treturn (ctx->type == CNG) ? hash_cng_init(ctx) : hash_cryptoapi_init(ctx);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(int) hash_ctx_cryptoapi_init(git_hash_ctx *ctx)\n{\n\tctx->type = CRYPTOAPI;\n\tctx->prov = &hash_prov;\n\n\treturn git_hash_init(ctx);\n}"
  },
  {
    "function_name": "git_hash_global_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "100-113",
    "snippet": "int git_hash_global_init(void)\n{\n\tint error = 0;\n\n\tif (hash_prov.type != INVALID)\n\t\treturn 0;\n\n\tif ((error = hash_cng_prov_init()) < 0)\n\t\terror = hash_cryptoapi_prov_init();\n\n\tgit__on_shutdown(git_hash_global_shutdown);\n\n\treturn error;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_hash_prov hash_prov = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__on_shutdown",
          "args": [
            "git_hash_global_shutdown"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "git__on_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/global.c",
          "lines": "32-37",
          "snippet": "void git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}",
          "includes": [
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include \"win32/w32_stack.h\"",
            "#include \"transports/ssh.h\"",
            "#include \"git2/global.h\"",
            "#include \"thread-utils.h\"",
            "#include \"openssl_stream.h\"",
            "#include \"filter.h\"",
            "#include \"sysdir.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MAX_SHUTDOWN_CB 8"
          ],
          "globals_used": [
            "static git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];",
            "static git_atomic git__n_shutdown_callbacks;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/w32_crtdbg_stacktrace.h\"\n#include \"win32/w32_stack.h\"\n#include \"transports/ssh.h\"\n#include \"git2/global.h\"\n#include \"thread-utils.h\"\n#include \"openssl_stream.h\"\n#include \"filter.h\"\n#include \"sysdir.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\n#define MAX_SHUTDOWN_CB 8\n\nstatic git_global_shutdown_fn git__shutdown_callbacks[MAX_SHUTDOWN_CB];\nstatic git_atomic git__n_shutdown_callbacks;\n\nvoid git__on_shutdown(git_global_shutdown_fn callback)\n{\n\tint count = git_atomic_inc(&git__n_shutdown_callbacks);\n\tassert(count <= MAX_SHUTDOWN_CB && count > 0);\n\tgit__shutdown_callbacks[count - 1] = callback;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_cryptoapi_prov_init",
          "args": [],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cryptoapi_prov_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "76-83",
          "snippet": "GIT_INLINE(int) hash_cryptoapi_prov_init()\n{\n\tif (!CryptAcquireContext(&hash_prov.prov.cryptoapi.handle, NULL, 0, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT))\n\t\treturn -1;\n\n\thash_prov.type = CRYPTOAPI;\n\treturn 0;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(int) hash_cryptoapi_prov_init()\n{\n\tif (!CryptAcquireContext(&hash_prov.prov.cryptoapi.handle, NULL, 0, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT))\n\t\treturn -1;\n\n\thash_prov.type = CRYPTOAPI;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_cng_prov_init",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cng_prov_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "21-65",
          "snippet": "GIT_INLINE(int) hash_cng_prov_init(void)\n{\n\tchar dll_path[MAX_PATH];\n\tDWORD dll_path_len, size_len;\n\n\t/* Only use CNG on Windows 2008 / Vista SP1  or better (Windows 6.0 SP1) */\n\tif (!git_has_win32_version(6, 0, 1))\n\t\treturn -1;\n\n\t/* Load bcrypt.dll explicitly from the system directory */\n\tif ((dll_path_len = GetSystemDirectory(dll_path, MAX_PATH)) == 0 ||\n\t\tdll_path_len > MAX_PATH ||\n\t\tStringCchCat(dll_path, MAX_PATH, \"\\\\\") < 0 ||\n\t\tStringCchCat(dll_path, MAX_PATH, GIT_HASH_CNG_DLL_NAME) < 0 ||\n\t\t(hash_prov.prov.cng.dll = LoadLibrary(dll_path)) == NULL)\n\t\treturn -1;\n\n\t/* Load the function addresses */\n\tif ((hash_prov.prov.cng.open_algorithm_provider = (hash_win32_cng_open_algorithm_provider_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptOpenAlgorithmProvider\")) == NULL ||\n\t\t(hash_prov.prov.cng.get_property = (hash_win32_cng_get_property_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptGetProperty\")) == NULL ||\n\t\t(hash_prov.prov.cng.create_hash = (hash_win32_cng_create_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptCreateHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.finish_hash = (hash_win32_cng_finish_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptFinishHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.hash_data = (hash_win32_cng_hash_data_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptHashData\")) == NULL ||\n\t\t(hash_prov.prov.cng.destroy_hash = (hash_win32_cng_destroy_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptDestroyHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.close_algorithm_provider = (hash_win32_cng_close_algorithm_provider_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptCloseAlgorithmProvider\")) == NULL) {\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\t/* Load the SHA1 algorithm */\n\tif (hash_prov.prov.cng.open_algorithm_provider(&hash_prov.prov.cng.handle, GIT_HASH_CNG_HASH_TYPE, NULL, GIT_HASH_CNG_HASH_REUSABLE) < 0) {\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\t/* Get storage space for the hash object */\n\tif (hash_prov.prov.cng.get_property(hash_prov.prov.cng.handle, GIT_HASH_CNG_HASH_OBJECT_LEN, (PBYTE)&hash_prov.prov.cng.hash_object_size, sizeof(DWORD), &size_len, 0) < 0) {\n\t\thash_prov.prov.cng.close_algorithm_provider(hash_prov.prov.cng.handle, 0);\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\thash_prov.type = CNG;\n\treturn 0;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(int) hash_cng_prov_init(void)\n{\n\tchar dll_path[MAX_PATH];\n\tDWORD dll_path_len, size_len;\n\n\t/* Only use CNG on Windows 2008 / Vista SP1  or better (Windows 6.0 SP1) */\n\tif (!git_has_win32_version(6, 0, 1))\n\t\treturn -1;\n\n\t/* Load bcrypt.dll explicitly from the system directory */\n\tif ((dll_path_len = GetSystemDirectory(dll_path, MAX_PATH)) == 0 ||\n\t\tdll_path_len > MAX_PATH ||\n\t\tStringCchCat(dll_path, MAX_PATH, \"\\\\\") < 0 ||\n\t\tStringCchCat(dll_path, MAX_PATH, GIT_HASH_CNG_DLL_NAME) < 0 ||\n\t\t(hash_prov.prov.cng.dll = LoadLibrary(dll_path)) == NULL)\n\t\treturn -1;\n\n\t/* Load the function addresses */\n\tif ((hash_prov.prov.cng.open_algorithm_provider = (hash_win32_cng_open_algorithm_provider_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptOpenAlgorithmProvider\")) == NULL ||\n\t\t(hash_prov.prov.cng.get_property = (hash_win32_cng_get_property_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptGetProperty\")) == NULL ||\n\t\t(hash_prov.prov.cng.create_hash = (hash_win32_cng_create_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptCreateHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.finish_hash = (hash_win32_cng_finish_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptFinishHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.hash_data = (hash_win32_cng_hash_data_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptHashData\")) == NULL ||\n\t\t(hash_prov.prov.cng.destroy_hash = (hash_win32_cng_destroy_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptDestroyHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.close_algorithm_provider = (hash_win32_cng_close_algorithm_provider_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptCloseAlgorithmProvider\")) == NULL) {\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\t/* Load the SHA1 algorithm */\n\tif (hash_prov.prov.cng.open_algorithm_provider(&hash_prov.prov.cng.handle, GIT_HASH_CNG_HASH_TYPE, NULL, GIT_HASH_CNG_HASH_REUSABLE) < 0) {\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\t/* Get storage space for the hash object */\n\tif (hash_prov.prov.cng.get_property(hash_prov.prov.cng.handle, GIT_HASH_CNG_HASH_OBJECT_LEN, (PBYTE)&hash_prov.prov.cng.hash_object_size, sizeof(DWORD), &size_len, 0) < 0) {\n\t\thash_prov.prov.cng.close_algorithm_provider(hash_prov.prov.cng.handle, 0);\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\thash_prov.type = CNG;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nint git_hash_global_init(void)\n{\n\tint error = 0;\n\n\tif (hash_prov.type != INVALID)\n\t\treturn 0;\n\n\tif ((error = hash_cng_prov_init()) < 0)\n\t\terror = hash_cryptoapi_prov_init();\n\n\tgit__on_shutdown(git_hash_global_shutdown);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_hash_global_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "92-98",
    "snippet": "static void git_hash_global_shutdown(void)\n{\n\tif (hash_prov.type == CNG)\n\t\thash_cng_prov_shutdown();\n\telse if(hash_prov.type == CRYPTOAPI)\n\t\thash_cryptoapi_prov_shutdown();\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_hash_prov hash_prov = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_cryptoapi_prov_shutdown",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cryptoapi_prov_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "85-90",
          "snippet": "GIT_INLINE(void) hash_cryptoapi_prov_shutdown(void)\n{\n\tCryptReleaseContext(hash_prov.prov.cryptoapi.handle, 0);\n\n\thash_prov.type = INVALID;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(void) hash_cryptoapi_prov_shutdown(void)\n{\n\tCryptReleaseContext(hash_prov.prov.cryptoapi.handle, 0);\n\n\thash_prov.type = INVALID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_cng_prov_shutdown",
          "args": [],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "hash_cng_prov_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
          "lines": "67-73",
          "snippet": "GIT_INLINE(void) hash_cng_prov_shutdown(void)\n{\n\thash_prov.prov.cng.close_algorithm_provider(hash_prov.prov.cng.handle, 0);\n\tFreeLibrary(hash_prov.prov.cng.dll);\n\n\thash_prov.type = INVALID;\n}",
          "includes": [
            "#include <strsafe.h>",
            "#include <wincrypt.h>",
            "#include \"hash/hash_win32.h\"",
            "#include \"hash.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct git_hash_prov hash_prov = {0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(void) hash_cng_prov_shutdown(void)\n{\n\thash_prov.prov.cng.close_algorithm_provider(hash_prov.prov.cng.handle, 0);\n\tFreeLibrary(hash_prov.prov.cng.dll);\n\n\thash_prov.type = INVALID;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nstatic void git_hash_global_shutdown(void)\n{\n\tif (hash_prov.type == CNG)\n\t\thash_cng_prov_shutdown();\n\telse if(hash_prov.type == CRYPTOAPI)\n\t\thash_cryptoapi_prov_shutdown();\n}"
  },
  {
    "function_name": "hash_cryptoapi_prov_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "85-90",
    "snippet": "GIT_INLINE(void) hash_cryptoapi_prov_shutdown(void)\n{\n\tCryptReleaseContext(hash_prov.prov.cryptoapi.handle, 0);\n\n\thash_prov.type = INVALID;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_hash_prov hash_prov = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "CryptReleaseContext",
          "args": [
            "hash_prov.prov.cryptoapi.handle",
            "0"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(void) hash_cryptoapi_prov_shutdown(void)\n{\n\tCryptReleaseContext(hash_prov.prov.cryptoapi.handle, 0);\n\n\thash_prov.type = INVALID;\n}"
  },
  {
    "function_name": "hash_cryptoapi_prov_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "76-83",
    "snippet": "GIT_INLINE(int) hash_cryptoapi_prov_init()\n{\n\tif (!CryptAcquireContext(&hash_prov.prov.cryptoapi.handle, NULL, 0, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT))\n\t\treturn -1;\n\n\thash_prov.type = CRYPTOAPI;\n\treturn 0;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_hash_prov hash_prov = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "CryptAcquireContext",
          "args": [
            "&hash_prov.prov.cryptoapi.handle",
            "NULL",
            "0",
            "PROV_RSA_FULL",
            "CRYPT_VERIFYCONTEXT"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(int) hash_cryptoapi_prov_init()\n{\n\tif (!CryptAcquireContext(&hash_prov.prov.cryptoapi.handle, NULL, 0, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT))\n\t\treturn -1;\n\n\thash_prov.type = CRYPTOAPI;\n\treturn 0;\n}"
  },
  {
    "function_name": "hash_cng_prov_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "67-73",
    "snippet": "GIT_INLINE(void) hash_cng_prov_shutdown(void)\n{\n\thash_prov.prov.cng.close_algorithm_provider(hash_prov.prov.cng.handle, 0);\n\tFreeLibrary(hash_prov.prov.cng.dll);\n\n\thash_prov.type = INVALID;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_hash_prov hash_prov = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "FreeLibrary",
          "args": [
            "hash_prov.prov.cng.dll"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_prov.prov.cng.close_algorithm_provider",
          "args": [
            "hash_prov.prov.cng.handle",
            "0"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(void) hash_cng_prov_shutdown(void)\n{\n\thash_prov.prov.cng.close_algorithm_provider(hash_prov.prov.cng.handle, 0);\n\tFreeLibrary(hash_prov.prov.cng.dll);\n\n\thash_prov.type = INVALID;\n}"
  },
  {
    "function_name": "hash_cng_prov_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/hash/hash_win32.c",
    "lines": "21-65",
    "snippet": "GIT_INLINE(int) hash_cng_prov_init(void)\n{\n\tchar dll_path[MAX_PATH];\n\tDWORD dll_path_len, size_len;\n\n\t/* Only use CNG on Windows 2008 / Vista SP1  or better (Windows 6.0 SP1) */\n\tif (!git_has_win32_version(6, 0, 1))\n\t\treturn -1;\n\n\t/* Load bcrypt.dll explicitly from the system directory */\n\tif ((dll_path_len = GetSystemDirectory(dll_path, MAX_PATH)) == 0 ||\n\t\tdll_path_len > MAX_PATH ||\n\t\tStringCchCat(dll_path, MAX_PATH, \"\\\\\") < 0 ||\n\t\tStringCchCat(dll_path, MAX_PATH, GIT_HASH_CNG_DLL_NAME) < 0 ||\n\t\t(hash_prov.prov.cng.dll = LoadLibrary(dll_path)) == NULL)\n\t\treturn -1;\n\n\t/* Load the function addresses */\n\tif ((hash_prov.prov.cng.open_algorithm_provider = (hash_win32_cng_open_algorithm_provider_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptOpenAlgorithmProvider\")) == NULL ||\n\t\t(hash_prov.prov.cng.get_property = (hash_win32_cng_get_property_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptGetProperty\")) == NULL ||\n\t\t(hash_prov.prov.cng.create_hash = (hash_win32_cng_create_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptCreateHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.finish_hash = (hash_win32_cng_finish_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptFinishHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.hash_data = (hash_win32_cng_hash_data_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptHashData\")) == NULL ||\n\t\t(hash_prov.prov.cng.destroy_hash = (hash_win32_cng_destroy_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptDestroyHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.close_algorithm_provider = (hash_win32_cng_close_algorithm_provider_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptCloseAlgorithmProvider\")) == NULL) {\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\t/* Load the SHA1 algorithm */\n\tif (hash_prov.prov.cng.open_algorithm_provider(&hash_prov.prov.cng.handle, GIT_HASH_CNG_HASH_TYPE, NULL, GIT_HASH_CNG_HASH_REUSABLE) < 0) {\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\t/* Get storage space for the hash object */\n\tif (hash_prov.prov.cng.get_property(hash_prov.prov.cng.handle, GIT_HASH_CNG_HASH_OBJECT_LEN, (PBYTE)&hash_prov.prov.cng.hash_object_size, sizeof(DWORD), &size_len, 0) < 0) {\n\t\thash_prov.prov.cng.close_algorithm_provider(hash_prov.prov.cng.handle, 0);\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\thash_prov.type = CNG;\n\treturn 0;\n}",
    "includes": [
      "#include <strsafe.h>",
      "#include <wincrypt.h>",
      "#include \"hash/hash_win32.h\"",
      "#include \"hash.h\"",
      "#include \"global.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct git_hash_prov hash_prov = {0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "FreeLibrary",
          "args": [
            "hash_prov.prov.cng.dll"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_prov.prov.cng.close_algorithm_provider",
          "args": [
            "hash_prov.prov.cng.handle",
            "0"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_prov.prov.cng.get_property",
          "args": [
            "hash_prov.prov.cng.handle",
            "GIT_HASH_CNG_HASH_OBJECT_LEN",
            "(PBYTE)&hash_prov.prov.cng.hash_object_size",
            "sizeof(DWORD)",
            "&size_len",
            "0"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FreeLibrary",
          "args": [
            "hash_prov.prov.cng.dll"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_prov.prov.cng.open_algorithm_provider",
          "args": [
            "&hash_prov.prov.cng.handle",
            "GIT_HASH_CNG_HASH_TYPE",
            "NULL",
            "GIT_HASH_CNG_HASH_REUSABLE"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FreeLibrary",
          "args": [
            "hash_prov.prov.cng.dll"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetProcAddress",
          "args": [
            "hash_prov.prov.cng.dll",
            "\"BCryptCloseAlgorithmProvider\""
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetProcAddress",
          "args": [
            "hash_prov.prov.cng.dll",
            "\"BCryptDestroyHash\""
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetProcAddress",
          "args": [
            "hash_prov.prov.cng.dll",
            "\"BCryptHashData\""
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetProcAddress",
          "args": [
            "hash_prov.prov.cng.dll",
            "\"BCryptFinishHash\""
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetProcAddress",
          "args": [
            "hash_prov.prov.cng.dll",
            "\"BCryptCreateHash\""
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetProcAddress",
          "args": [
            "hash_prov.prov.cng.dll",
            "\"BCryptGetProperty\""
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetProcAddress",
          "args": [
            "hash_prov.prov.cng.dll",
            "\"BCryptOpenAlgorithmProvider\""
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LoadLibrary",
          "args": [
            "dll_path"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringCchCat",
          "args": [
            "dll_path",
            "MAX_PATH",
            "GIT_HASH_CNG_DLL_NAME"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringCchCat",
          "args": [
            "dll_path",
            "MAX_PATH",
            "\"\\\\\""
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSystemDirectory",
          "args": [
            "dll_path",
            "MAX_PATH"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_has_win32_version",
          "args": [
            "6",
            "0",
            "1"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "git_has_win32_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/version.h",
          "lines": "12-35",
          "snippet": "GIT_INLINE(int) git_has_win32_version(int major, int minor, int service_pack)\n{\n\tOSVERSIONINFOEX version_test = {0};\n\tDWORD version_test_mask;\n\tDWORDLONG version_condition_mask = 0;\n\t\n\tversion_test.dwOSVersionInfoSize = sizeof(OSVERSIONINFOEX);\n\tversion_test.dwMajorVersion = major;\n\tversion_test.dwMinorVersion = minor;\n\tversion_test.wServicePackMajor = (WORD)service_pack;\n\tversion_test.wServicePackMinor = 0;\n\n\tversion_test_mask = (VER_MAJORVERSION | VER_MINORVERSION | VER_SERVICEPACKMAJOR | VER_SERVICEPACKMINOR);\n\n\tVER_SET_CONDITION(version_condition_mask, VER_MAJORVERSION, VER_GREATER_EQUAL);\n\tVER_SET_CONDITION(version_condition_mask, VER_MINORVERSION, VER_GREATER_EQUAL);\n\tVER_SET_CONDITION(version_condition_mask, VER_SERVICEPACKMAJOR, VER_GREATER_EQUAL);\n\tVER_SET_CONDITION(version_condition_mask, VER_SERVICEPACKMINOR, VER_GREATER_EQUAL);\n\n\tif (!VerifyVersionInfo(&version_test, version_test_mask, version_condition_mask))\n\t\treturn 0;\n\n\treturn 1;\n}",
          "includes": [
            "#include <windows.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n\nGIT_INLINE(int) git_has_win32_version(int major, int minor, int service_pack)\n{\n\tOSVERSIONINFOEX version_test = {0};\n\tDWORD version_test_mask;\n\tDWORDLONG version_condition_mask = 0;\n\t\n\tversion_test.dwOSVersionInfoSize = sizeof(OSVERSIONINFOEX);\n\tversion_test.dwMajorVersion = major;\n\tversion_test.dwMinorVersion = minor;\n\tversion_test.wServicePackMajor = (WORD)service_pack;\n\tversion_test.wServicePackMinor = 0;\n\n\tversion_test_mask = (VER_MAJORVERSION | VER_MINORVERSION | VER_SERVICEPACKMAJOR | VER_SERVICEPACKMINOR);\n\n\tVER_SET_CONDITION(version_condition_mask, VER_MAJORVERSION, VER_GREATER_EQUAL);\n\tVER_SET_CONDITION(version_condition_mask, VER_MINORVERSION, VER_GREATER_EQUAL);\n\tVER_SET_CONDITION(version_condition_mask, VER_SERVICEPACKMAJOR, VER_GREATER_EQUAL);\n\tVER_SET_CONDITION(version_condition_mask, VER_SERVICEPACKMINOR, VER_GREATER_EQUAL);\n\n\tif (!VerifyVersionInfo(&version_test, version_test_mask, version_condition_mask))\n\t\treturn 0;\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <strsafe.h>\n#include <wincrypt.h>\n#include \"hash/hash_win32.h\"\n#include \"hash.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nstatic struct git_hash_prov hash_prov = {0};\n\nGIT_INLINE(int) hash_cng_prov_init(void)\n{\n\tchar dll_path[MAX_PATH];\n\tDWORD dll_path_len, size_len;\n\n\t/* Only use CNG on Windows 2008 / Vista SP1  or better (Windows 6.0 SP1) */\n\tif (!git_has_win32_version(6, 0, 1))\n\t\treturn -1;\n\n\t/* Load bcrypt.dll explicitly from the system directory */\n\tif ((dll_path_len = GetSystemDirectory(dll_path, MAX_PATH)) == 0 ||\n\t\tdll_path_len > MAX_PATH ||\n\t\tStringCchCat(dll_path, MAX_PATH, \"\\\\\") < 0 ||\n\t\tStringCchCat(dll_path, MAX_PATH, GIT_HASH_CNG_DLL_NAME) < 0 ||\n\t\t(hash_prov.prov.cng.dll = LoadLibrary(dll_path)) == NULL)\n\t\treturn -1;\n\n\t/* Load the function addresses */\n\tif ((hash_prov.prov.cng.open_algorithm_provider = (hash_win32_cng_open_algorithm_provider_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptOpenAlgorithmProvider\")) == NULL ||\n\t\t(hash_prov.prov.cng.get_property = (hash_win32_cng_get_property_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptGetProperty\")) == NULL ||\n\t\t(hash_prov.prov.cng.create_hash = (hash_win32_cng_create_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptCreateHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.finish_hash = (hash_win32_cng_finish_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptFinishHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.hash_data = (hash_win32_cng_hash_data_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptHashData\")) == NULL ||\n\t\t(hash_prov.prov.cng.destroy_hash = (hash_win32_cng_destroy_hash_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptDestroyHash\")) == NULL ||\n\t\t(hash_prov.prov.cng.close_algorithm_provider = (hash_win32_cng_close_algorithm_provider_fn)GetProcAddress(hash_prov.prov.cng.dll, \"BCryptCloseAlgorithmProvider\")) == NULL) {\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\t/* Load the SHA1 algorithm */\n\tif (hash_prov.prov.cng.open_algorithm_provider(&hash_prov.prov.cng.handle, GIT_HASH_CNG_HASH_TYPE, NULL, GIT_HASH_CNG_HASH_REUSABLE) < 0) {\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\t/* Get storage space for the hash object */\n\tif (hash_prov.prov.cng.get_property(hash_prov.prov.cng.handle, GIT_HASH_CNG_HASH_OBJECT_LEN, (PBYTE)&hash_prov.prov.cng.hash_object_size, sizeof(DWORD), &size_len, 0) < 0) {\n\t\thash_prov.prov.cng.close_algorithm_provider(hash_prov.prov.cng.handle, 0);\n\t\tFreeLibrary(hash_prov.prov.cng.dll);\n\t\treturn -1;\n\t}\n\n\thash_prov.type = CNG;\n\treturn 0;\n}"
  }
]