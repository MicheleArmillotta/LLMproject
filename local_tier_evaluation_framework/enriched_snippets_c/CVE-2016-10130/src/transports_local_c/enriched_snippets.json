[
  {
    "function_name": "git_transport_local",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "685-718",
    "snippet": "int git_transport_local(git_transport **out, git_remote *owner, void *param)\n{\n\tint error;\n\ttransport_local *t;\n\n\tGIT_UNUSED(param);\n\n\tt = git__calloc(1, sizeof(transport_local));\n\tGITERR_CHECK_ALLOC(t);\n\n\tt->parent.version = GIT_TRANSPORT_VERSION;\n\tt->parent.set_callbacks = local_set_callbacks;\n\tt->parent.connect = local_connect;\n\tt->parent.negotiate_fetch = local_negotiate_fetch;\n\tt->parent.download_pack = local_download_pack;\n\tt->parent.push = local_push;\n\tt->parent.close = local_close;\n\tt->parent.free = local_free;\n\tt->parent.ls = local_ls;\n\tt->parent.is_connected = local_is_connected;\n\tt->parent.read_flags = local_read_flags;\n\tt->parent.cancel = local_cancel;\n\n\tif ((error = git_vector_init(&t->refs, 0, NULL)) < 0) {\n\t\tgit__free(t);\n\t\treturn error;\n\t}\n\n\tt->owner = owner;\n\n\t*out = (git_transport *) t;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "t"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_init",
          "args": [
            "&t->refs",
            "0",
            "NULL"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "97-108",
          "snippet": "int git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [
            "#define MIN_ALLOCSIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\n#define MIN_ALLOCSIZE\t8\n\nint git_vector_init(git_vector *v, size_t initial_size, git_vector_cmp cmp)\n{\n\tassert(v);\n\n\tv->_alloc_size = 0;\n\tv->_cmp = cmp;\n\tv->length = 0;\n\tv->flags = GIT_VECTOR_SORTED;\n\tv->contents = NULL;\n\n\treturn resize_vector(v, max(initial_size, MIN_ALLOCSIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "t"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(transport_local)"
          ],
          "line": 692
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "param"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nint git_transport_local(git_transport **out, git_remote *owner, void *param)\n{\n\tint error;\n\ttransport_local *t;\n\n\tGIT_UNUSED(param);\n\n\tt = git__calloc(1, sizeof(transport_local));\n\tGITERR_CHECK_ALLOC(t);\n\n\tt->parent.version = GIT_TRANSPORT_VERSION;\n\tt->parent.set_callbacks = local_set_callbacks;\n\tt->parent.connect = local_connect;\n\tt->parent.negotiate_fetch = local_negotiate_fetch;\n\tt->parent.download_pack = local_download_pack;\n\tt->parent.push = local_push;\n\tt->parent.close = local_close;\n\tt->parent.free = local_free;\n\tt->parent.ls = local_ls;\n\tt->parent.is_connected = local_is_connected;\n\tt->parent.read_flags = local_read_flags;\n\tt->parent.cancel = local_cancel;\n\n\tif ((error = git_vector_init(&t->refs, 0, NULL)) < 0) {\n\t\tgit__free(t);\n\t\treturn error;\n\t}\n\n\tt->owner = owner;\n\n\t*out = (git_transport *) t;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "local_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "668-679",
    "snippet": "static void local_free(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tfree_heads(&t->refs);\n\n\t/* Close the transport, if it's still open. */\n\tlocal_close(transport);\n\n\t/* Free the transport */\n\tgit__free(t);\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "t"
          ],
          "line": 678
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_close",
          "args": [
            "transport"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "local_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
          "lines": "649-666",
          "snippet": "static int local_close(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tt->connected = 0;\n\n\tif (t->repo) {\n\t\tgit_repository_free(t->repo);\n\t\tt->repo = NULL;\n\t}\n\n\tif (t->url) {\n\t\tgit__free(t->url);\n\t\tt->url = NULL;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"remote.h\"",
            "#include \"push.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"refs.h\"",
            "#include \"pack-objects.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/net.h\"",
            "#include \"git2/types.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_close(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tt->connected = 0;\n\n\tif (t->repo) {\n\t\tgit_repository_free(t->repo);\n\t\tt->repo = NULL;\n\t}\n\n\tif (t->url) {\n\t\tgit__free(t->url);\n\t\tt->url = NULL;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_heads",
          "args": [
            "&t->refs"
          ],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "free_heads",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
          "lines": "52-61",
          "snippet": "static void free_heads(git_vector *heads)\n{\n\tgit_remote_head *head;\n\tsize_t i;\n\n\tgit_vector_foreach(heads, i, head)\n\t\tfree_head(head);\n\n\tgit_vector_free(heads);\n}",
          "includes": [
            "#include \"remote.h\"",
            "#include \"push.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"refs.h\"",
            "#include \"pack-objects.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/net.h\"",
            "#include \"git2/types.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic void free_heads(git_vector *heads)\n{\n\tgit_remote_head *head;\n\tsize_t i;\n\n\tgit_vector_foreach(heads, i, head)\n\t\tfree_head(head);\n\n\tgit_vector_free(heads);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic void local_free(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tfree_heads(&t->refs);\n\n\t/* Close the transport, if it's still open. */\n\tlocal_close(transport);\n\n\t/* Free the transport */\n\tgit__free(t);\n}"
  },
  {
    "function_name": "local_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "649-666",
    "snippet": "static int local_close(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tt->connected = 0;\n\n\tif (t->repo) {\n\t\tgit_repository_free(t->repo);\n\t\tt->repo = NULL;\n\t}\n\n\tif (t->url) {\n\t\tgit__free(t->url);\n\t\tt->url = NULL;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "t->url"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_free",
          "args": [
            "t->repo"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "121-148",
          "snippet": "void git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_close(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tt->connected = 0;\n\n\tif (t->repo) {\n\t\tgit_repository_free(t->repo);\n\t\tt->repo = NULL;\n\t}\n\n\tif (t->url) {\n\t\tgit__free(t->url);\n\t\tt->url = NULL;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "local_cancel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "642-647",
    "snippet": "static void local_cancel(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tgit_atomic_set(&t->cancelled, 1);\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_atomic_set",
          "args": [
            "&t->cancelled",
            "1"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "git_atomic_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "166-169",
          "snippet": "GIT_INLINE(void) git_atomic_set(git_atomic *a, int val)\n{\n\ta->val = val;\n}",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\nGIT_INLINE(void) git_atomic_set(git_atomic *a, int val)\n{\n\ta->val = val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic void local_cancel(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tgit_atomic_set(&t->cancelled, 1);\n}"
  },
  {
    "function_name": "local_read_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "633-640",
    "snippet": "static int local_read_flags(git_transport *transport, int *flags)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\t*flags = t->flags;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_read_flags(git_transport *transport, int *flags)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\t*flags = t->flags;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "local_is_connected",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "626-631",
    "snippet": "static int local_is_connected(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\treturn t->connected;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_is_connected(git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\treturn t->connected;\n}"
  },
  {
    "function_name": "local_set_callbacks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "608-624",
    "snippet": "static int local_set_callbacks(\n\tgit_transport *transport,\n\tgit_transport_message_cb progress_cb,\n\tgit_transport_message_cb error_cb,\n\tgit_transport_certificate_check_cb certificate_check_cb,\n\tvoid *message_cb_payload)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tGIT_UNUSED(certificate_check_cb);\n\n\tt->progress_cb = progress_cb;\n\tt->error_cb = error_cb;\n\tt->message_cb_payload = message_cb_payload;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "certificate_check_cb"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_set_callbacks(\n\tgit_transport *transport,\n\tgit_transport_message_cb progress_cb,\n\tgit_transport_message_cb error_cb,\n\tgit_transport_certificate_check_cb certificate_check_cb,\n\tvoid *message_cb_payload)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tGIT_UNUSED(certificate_check_cb);\n\n\tt->progress_cb = progress_cb;\n\tt->error_cb = error_cb;\n\tt->message_cb_payload = message_cb_payload;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "local_download_pack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "503-606",
    "snippet": "static int local_download_pack(\n\t\tgit_transport *transport,\n\t\tgit_repository *repo,\n\t\tgit_transfer_progress *stats,\n\t\tgit_transfer_progress_cb progress_cb,\n\t\tvoid *progress_payload)\n{\n\ttransport_local *t = (transport_local*)transport;\n\tgit_revwalk *walk = NULL;\n\tgit_remote_head *rhead;\n\tunsigned int i;\n\tint error = -1;\n\tgit_packbuilder *pack = NULL;\n\tgit_odb_writepack *writepack = NULL;\n\tgit_odb *odb = NULL;\n\tgit_buf progress_info = GIT_BUF_INIT;\n\n\tif ((error = git_revwalk_new(&walk, t->repo)) < 0)\n\t\tgoto cleanup;\n\tgit_revwalk_sorting(walk, GIT_SORT_TIME);\n\n\tif ((error = git_packbuilder_new(&pack, t->repo)) < 0)\n\t\tgoto cleanup;\n\n\tgit_packbuilder_set_callbacks(pack, local_counting, t);\n\n\tstats->total_objects = 0;\n\tstats->indexed_objects = 0;\n\tstats->received_objects = 0;\n\tstats->received_bytes = 0;\n\n\tgit_vector_foreach(&t->refs, i, rhead) {\n\t\tgit_object *obj;\n\t\tif ((error = git_object_lookup(&obj, t->repo, &rhead->oid, GIT_OBJ_ANY)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tif (git_object_type(obj) == GIT_OBJ_COMMIT) {\n\t\t\t/* Revwalker includes only wanted commits */\n\t\t\terror = git_revwalk_push(walk, &rhead->oid);\n\t\t\tif (!error && !git_oid_iszero(&rhead->loid)) {\n\t\t\t\terror = git_revwalk_hide(walk, &rhead->loid);\n\t\t\t\tif (error == GIT_ENOTFOUND)\n\t\t\t\t\terror = 0;\n\t\t\t}\n\t\t} else {\n\t\t\t/* Tag or some other wanted object. Add it on its own */\n\t\t\terror = git_packbuilder_insert_recur(pack, &rhead->oid, rhead->name);\n\t\t}\n\t\tgit_object_free(obj);\n\t\tif (error < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_packbuilder_insert_walk(pack, walk)))\n\t\tgoto cleanup;\n\n\tif ((error = git_buf_printf(&progress_info, counting_objects_fmt, git_packbuilder_object_count(pack))) < 0)\n\t\tgoto cleanup;\n\n\tif (t->progress_cb &&\n\t    (error = t->progress_cb(git_buf_cstr(&progress_info), git_buf_len(&progress_info), t->message_cb_payload)) < 0)\n\t\tgoto cleanup;\n\n\t/* Walk the objects, building a packfile */\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0)\n\t\tgoto cleanup;\n\n\t/* One last one with the newline */\n\tgit_buf_clear(&progress_info);\n\tgit_buf_printf(&progress_info, counting_objects_fmt, git_packbuilder_object_count(pack));\n\tif ((error = git_buf_putc(&progress_info, '\\n')) < 0)\n\t\tgoto cleanup;\n\n\tif (t->progress_cb &&\n\t    (error = t->progress_cb(git_buf_cstr(&progress_info), git_buf_len(&progress_info), t->message_cb_payload)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_odb_write_pack(&writepack, odb, progress_cb, progress_payload)) != 0)\n\t\tgoto cleanup;\n\n\t/* Write the data to the ODB */\n\t{\n\t\tforeach_data data = {0};\n\t\tdata.stats = stats;\n\t\tdata.progress_cb = progress_cb;\n\t\tdata.progress_payload = progress_payload;\n\t\tdata.writepack = writepack;\n\n\t\t/* autodetect */\n\t\tgit_packbuilder_set_threads(pack, 0);\n\n\t\tif ((error = git_packbuilder_foreach(pack, foreach_cb, &data)) != 0)\n\t\t\tgoto cleanup;\n\t}\n\n\terror = writepack->commit(writepack, stats);\n\ncleanup:\n\tif (writepack) writepack->free(writepack);\n\tgit_buf_free(&progress_info);\n\tgit_packbuilder_free(pack);\n\tgit_revwalk_free(walk);\n\treturn error;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *counting_objects_fmt = \"Counting objects %d\\r\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_revwalk_free",
          "args": [
            "walk"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "555-567",
          "snippet": "void git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_free(git_revwalk *walk)\n{\n\tif (walk == NULL)\n\t\treturn;\n\n\tgit_revwalk_reset(walk);\n\tgit_odb_free(walk->odb);\n\n\tgit_oidmap_free(walk->commits);\n\tgit_pool_clear(&walk->commit_pool);\n\tgit_pqueue_free(&walk->iterator_time);\n\tgit__free(walk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_packbuilder_free",
          "args": [
            "pack"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1726-1755",
          "snippet": "void git_packbuilder_free(git_packbuilder *pb)\n{\n\tif (pb == NULL)\n\t\treturn;\n\n#ifdef GIT_THREADS\n\n\tgit_mutex_free(&pb->cache_mutex);\n\tgit_mutex_free(&pb->progress_mutex);\n\tgit_cond_free(&pb->progress_cond);\n\n#endif\n\n\tif (pb->odb)\n\t\tgit_odb_free(pb->odb);\n\n\tif (pb->object_ix)\n\t\tgit_oidmap_free(pb->object_ix);\n\n\tif (pb->object_list)\n\t\tgit__free(pb->object_list);\n\n\tgit_oidmap_free(pb->walk_objects);\n\tgit_pool_clear(&pb->object_pool);\n\n\tgit_hash_ctx_cleanup(&pb->ctx);\n\tgit_zstream_free(&pb->zstream);\n\n\tgit__free(pb);\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nvoid git_packbuilder_free(git_packbuilder *pb)\n{\n\tif (pb == NULL)\n\t\treturn;\n\n#ifdef GIT_THREADS\n\n\tgit_mutex_free(&pb->cache_mutex);\n\tgit_mutex_free(&pb->progress_mutex);\n\tgit_cond_free(&pb->progress_cond);\n\n#endif\n\n\tif (pb->odb)\n\t\tgit_odb_free(pb->odb);\n\n\tif (pb->object_ix)\n\t\tgit_oidmap_free(pb->object_ix);\n\n\tif (pb->object_list)\n\t\tgit__free(pb->object_list);\n\n\tgit_oidmap_free(pb->walk_objects);\n\tgit_pool_clear(&pb->object_pool);\n\n\tgit_hash_ctx_cleanup(&pb->ctx);\n\tgit_zstream_free(&pb->zstream);\n\n\tgit__free(pb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&progress_info"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "writepack->free",
          "args": [
            "writepack"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writepack->commit",
          "args": [
            "writepack",
            "stats"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_packbuilder_foreach",
          "args": [
            "pack",
            "foreach_cb",
            "&data"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_foreach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1333-1337",
          "snippet": "int git_packbuilder_foreach(git_packbuilder *pb, int (*cb)(void *buf, size_t size, void *payload), void *payload)\n{\n\tPREPARE_PACK;\n\treturn write_pack(pb, cb, payload);\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [
            "#define PREPARE_PACK if (prepare_pack(pb) < 0) { return -1; }"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\n#define PREPARE_PACK if (prepare_pack(pb) < 0) { return -1; }\n\nint git_packbuilder_foreach(git_packbuilder *pb, int (*cb)(void *buf, size_t size, void *payload), void *payload)\n{\n\tPREPARE_PACK;\n\treturn write_pack(pb, cb, payload);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_packbuilder_set_threads",
          "args": [
            "pack",
            "0"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_set_threads",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "172-184",
          "snippet": "unsigned int git_packbuilder_set_threads(git_packbuilder *pb, unsigned int n)\n{\n\tassert(pb);\n\n#ifdef GIT_THREADS\n\tpb->nr_threads = n;\n#else\n\tGIT_UNUSED(n);\n\tassert(1 == pb->nr_threads);\n#endif\n\n\treturn pb->nr_threads;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nunsigned int git_packbuilder_set_threads(git_packbuilder *pb, unsigned int n)\n{\n\tassert(pb);\n\n#ifdef GIT_THREADS\n\tpb->nr_threads = n;\n#else\n\tGIT_UNUSED(n);\n\tassert(1 == pb->nr_threads);\n#endif\n\n\treturn pb->nr_threads;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_write_pack",
          "args": [
            "&writepack",
            "odb",
            "progress_cb",
            "progress_payload"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_write_pack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "1166-1193",
          "snippet": "int git_odb_write_pack(struct git_odb_writepack **out, git_odb *db, git_transfer_progress_cb progress_cb, void *progress_payload)\n{\n\tsize_t i, writes = 0;\n\tint error = GIT_ERROR;\n\n\tassert(out && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->writepack != NULL) {\n\t\t\t++writes;\n\t\t\terror = b->writepack(out, b, db, progress_cb, progress_payload);\n\t\t}\n\t}\n\n\tif (error == GIT_PASSTHROUGH)\n\t\terror = 0;\n\tif (error < 0 && !writes)\n\t\terror = git_odb__error_unsupported_in_backend(\"write pack\");\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_write_pack(struct git_odb_writepack **out, git_odb *db, git_transfer_progress_cb progress_cb, void *progress_payload)\n{\n\tsize_t i, writes = 0;\n\tint error = GIT_ERROR;\n\n\tassert(out && db);\n\n\tfor (i = 0; i < db->backends.length && error < 0; ++i) {\n\t\tbackend_internal *internal = git_vector_get(&db->backends, i);\n\t\tgit_odb_backend *b = internal->backend;\n\n\t\t/* we don't write in alternates! */\n\t\tif (internal->is_alternate)\n\t\t\tcontinue;\n\n\t\tif (b->writepack != NULL) {\n\t\t\t++writes;\n\t\t\terror = b->writepack(out, b, db, progress_cb, progress_payload);\n\t\t}\n\t}\n\n\tif (error == GIT_PASSTHROUGH)\n\t\terror = 0;\n\tif (error < 0 && !writes)\n\t\terror = git_odb__error_unsupported_in_backend(\"write pack\");\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "t->progress_cb",
          "args": [
            "git_buf_cstr(&progress_info)",
            "git_buf_len(&progress_info)",
            "t->message_cb_payload"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "&progress_info"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&progress_info"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "&progress_info",
            "'\\n'"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "&progress_info",
            "counting_objects_fmt",
            "git_packbuilder_object_count(pack)"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_packbuilder_object_count",
          "args": [
            "pack"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_object_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1476-1479",
          "snippet": "uint32_t git_packbuilder_object_count(git_packbuilder *pb)\n{\n\treturn pb->nr_objects;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nuint32_t git_packbuilder_object_count(git_packbuilder *pb)\n{\n\treturn pb->nr_objects;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "&progress_info"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_odb__weakptr",
          "args": [
            "&odb",
            "repo"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_odb__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "733-762",
          "snippet": "int git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "t->progress_cb",
          "args": [
            "git_buf_cstr(&progress_info)",
            "git_buf_len(&progress_info)",
            "t->message_cb_payload"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_packbuilder_insert_walk",
          "args": [
            "pack",
            "walk"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_insert_walk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1679-1713",
          "snippet": "int git_packbuilder_insert_walk(git_packbuilder *pb, git_revwalk *walk)\n{\n\tint error;\n\tgit_oid id;\n\tgit_walk_object *obj;\n\n\tassert(pb && walk);\n\n\tif ((error = mark_edges_uninteresting(pb, walk->user_input)) < 0)\n\t\treturn error;\n\n\t/*\n\t * TODO: git marks the parents of the edges\n\t * uninteresting. This may provide a speed advantage, but does\n\t * seem to assume the remote does not have a single-commit\n\t * history on the other end.\n\t */\n\n\t/* walk down each tree up to the blobs and insert them, stopping when uninteresting */\n\twhile ((error = git_revwalk_next(&id, walk)) == 0) {\n\t\tif ((error = retrieve_object(&obj, pb, &id)) < 0)\n\t\t\treturn error;\n\n\t\tif (obj->seen || obj->uninteresting)\n\t\t\tcontinue;\n\n\t\tif ((error = insert_commit(pb, obj)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nint git_packbuilder_insert_walk(git_packbuilder *pb, git_revwalk *walk)\n{\n\tint error;\n\tgit_oid id;\n\tgit_walk_object *obj;\n\n\tassert(pb && walk);\n\n\tif ((error = mark_edges_uninteresting(pb, walk->user_input)) < 0)\n\t\treturn error;\n\n\t/*\n\t * TODO: git marks the parents of the edges\n\t * uninteresting. This may provide a speed advantage, but does\n\t * seem to assume the remote does not have a single-commit\n\t * history on the other end.\n\t */\n\n\t/* walk down each tree up to the blobs and insert them, stopping when uninteresting */\n\twhile ((error = git_revwalk_next(&id, walk)) == 0) {\n\t\tif ((error = retrieve_object(&obj, pb, &id)) < 0)\n\t\t\treturn error;\n\n\t\tif (obj->seen || obj->uninteresting)\n\t\t\tcontinue;\n\n\t\tif ((error = insert_commit(pb, obj)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "obj"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_packbuilder_insert_recur",
          "args": [
            "pack",
            "&rhead->oid",
            "rhead->name"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_insert_recur",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1440-1474",
          "snippet": "int git_packbuilder_insert_recur(git_packbuilder *pb, const git_oid *id, const char *name)\n{\n\tgit_object *obj;\n\tint error;\n\n\tassert(pb && id);\n\n\tif ((error = git_object_lookup(&obj, pb->repo, id, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\tswitch (git_object_type(obj)) {\n\tcase GIT_OBJ_BLOB:\n\t\terror = git_packbuilder_insert(pb, id, name);\n\t\tbreak;\n\tcase GIT_OBJ_TREE:\n\t\terror = git_packbuilder_insert_tree(pb, id);\n\t\tbreak;\n\tcase GIT_OBJ_COMMIT:\n\t\terror = git_packbuilder_insert_commit(pb, id);\n\t\tbreak;\n\tcase GIT_OBJ_TAG:\n\t\tif ((error = git_packbuilder_insert(pb, id, name)) < 0)\n\t\t\tgoto cleanup;\n\t\terror = git_packbuilder_insert_recur(pb, git_tag_target_id((git_tag *) obj), NULL);\n\t\tbreak;\n\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"unknown object type\");\n\t\terror = -1;\n\t}\n\ncleanup:\n\tgit_object_free(obj);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nint git_packbuilder_insert_recur(git_packbuilder *pb, const git_oid *id, const char *name)\n{\n\tgit_object *obj;\n\tint error;\n\n\tassert(pb && id);\n\n\tif ((error = git_object_lookup(&obj, pb->repo, id, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\tswitch (git_object_type(obj)) {\n\tcase GIT_OBJ_BLOB:\n\t\terror = git_packbuilder_insert(pb, id, name);\n\t\tbreak;\n\tcase GIT_OBJ_TREE:\n\t\terror = git_packbuilder_insert_tree(pb, id);\n\t\tbreak;\n\tcase GIT_OBJ_COMMIT:\n\t\terror = git_packbuilder_insert_commit(pb, id);\n\t\tbreak;\n\tcase GIT_OBJ_TAG:\n\t\tif ((error = git_packbuilder_insert(pb, id, name)) < 0)\n\t\t\tgoto cleanup;\n\t\terror = git_packbuilder_insert_recur(pb, git_tag_target_id((git_tag *) obj), NULL);\n\t\tbreak;\n\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"unknown object type\");\n\t\terror = -1;\n\t}\n\ncleanup:\n\tgit_object_free(obj);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_hide",
          "args": [
            "walk",
            "&rhead->loid"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_hide_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "306-310",
          "snippet": "int git_revwalk_hide_ref(git_revwalk *walk, const char *refname)\n{\n\tassert(walk && refname);\n\treturn push_ref(walk, refname, 1, false);\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_hide_ref(git_revwalk *walk, const char *refname)\n{\n\tassert(walk && refname);\n\treturn push_ref(walk, refname, 1, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_iszero",
          "args": [
            "&rhead->loid"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_iszero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "239-247",
          "snippet": "int git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_push",
          "args": [
            "walk",
            "&rhead->oid"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_push_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "281-304",
          "snippet": "int git_revwalk_push_range(git_revwalk *walk, const char *range)\n{\n\tgit_revspec revspec;\n\tint error = 0;\n\n\tif ((error = git_revparse(&revspec, walk->repo, range)))\n\t\treturn error;\n\n\tif (revspec.flags & GIT_REVPARSE_MERGE_BASE) {\n\t\t/* TODO: support \"<commit>...<commit>\" */\n\t\tgiterr_set(GITERR_INVALID, \"Symmetric differences not implemented in revwalk\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif ((error = push_commit(walk, git_object_id(revspec.from), 1, false)))\n\t\tgoto out;\n\n\terror = push_commit(walk, git_object_id(revspec.to), 0, false);\n\nout:\n\tgit_object_free(revspec.from);\n\tgit_object_free(revspec.to);\n\treturn error;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_push_range(git_revwalk *walk, const char *range)\n{\n\tgit_revspec revspec;\n\tint error = 0;\n\n\tif ((error = git_revparse(&revspec, walk->repo, range)))\n\t\treturn error;\n\n\tif (revspec.flags & GIT_REVPARSE_MERGE_BASE) {\n\t\t/* TODO: support \"<commit>...<commit>\" */\n\t\tgiterr_set(GITERR_INVALID, \"Symmetric differences not implemented in revwalk\");\n\t\treturn GIT_EINVALIDSPEC;\n\t}\n\n\tif ((error = push_commit(walk, git_object_id(revspec.from), 1, false)))\n\t\tgoto out;\n\n\terror = push_commit(walk, git_object_id(revspec.to), 0, false);\n\nout:\n\tgit_object_free(revspec.from);\n\tgit_object_free(revspec.to);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_type",
          "args": [
            "obj"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_typeisloose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "249-255",
          "snippet": "int git_object_typeisloose(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn 0;\n\n\treturn (git_objects_table[type].size > 0) ? 1 : 0;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nstatic git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};\n\nint git_object_typeisloose(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn 0;\n\n\treturn (git_objects_table[type].size > 0) ? 1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_lookup",
          "args": [
            "&obj",
            "t->repo",
            "&rhead->oid",
            "GIT_OBJ_ANY"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_lookup_bypath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "390-423",
          "snippet": "int git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&t->refs",
            "i",
            "rhead"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_packbuilder_set_callbacks",
          "args": [
            "pack",
            "local_counting",
            "t"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_set_callbacks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1715-1724",
          "snippet": "int git_packbuilder_set_callbacks(git_packbuilder *pb, git_packbuilder_progress progress_cb, void *progress_cb_payload)\n{\n\tif (!pb)\n\t\treturn -1;\n\n\tpb->progress_cb = progress_cb;\n\tpb->progress_cb_payload = progress_cb_payload;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nint git_packbuilder_set_callbacks(git_packbuilder *pb, git_packbuilder_progress progress_cb, void *progress_cb_payload)\n{\n\tif (!pb)\n\t\treturn -1;\n\n\tpb->progress_cb = progress_cb;\n\tpb->progress_cb_payload = progress_cb_payload;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_packbuilder_new",
          "args": [
            "&pack",
            "t->repo"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "124-170",
          "snippet": "int git_packbuilder_new(git_packbuilder **out, git_repository *repo)\n{\n\tgit_packbuilder *pb;\n\n\t*out = NULL;\n\n\tpb = git__calloc(1, sizeof(*pb));\n\tGITERR_CHECK_ALLOC(pb);\n\n\tpb->object_ix = git_oidmap_alloc();\n\tif (!pb->object_ix)\n\t\tgoto on_error;\n\n\tpb->walk_objects = git_oidmap_alloc();\n\tif (!pb->walk_objects)\n\t\tgoto on_error;\n\n\tgit_pool_init(&pb->object_pool, sizeof(git_walk_object));\n\n\tpb->repo = repo;\n\tpb->nr_threads = 1; /* do not spawn any thread by default */\n\n\tif (git_hash_ctx_init(&pb->ctx) < 0 ||\n\t\tgit_zstream_init(&pb->zstream) < 0 ||\n\t\tgit_repository_odb(&pb->odb, repo) < 0 ||\n\t\tpackbuilder_config(pb) < 0)\n\t\tgoto on_error;\n\n#ifdef GIT_THREADS\n\n\tif (git_mutex_init(&pb->cache_mutex) ||\n\t\tgit_mutex_init(&pb->progress_mutex) ||\n\t\tgit_cond_init(&pb->progress_cond))\n\t{\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize packbuilder mutex\");\n\t\tgoto on_error;\n\t}\n\n#endif\n\n\t*out = pb;\n\treturn 0;\n\non_error:\n\tgit_packbuilder_free(pb);\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nint git_packbuilder_new(git_packbuilder **out, git_repository *repo)\n{\n\tgit_packbuilder *pb;\n\n\t*out = NULL;\n\n\tpb = git__calloc(1, sizeof(*pb));\n\tGITERR_CHECK_ALLOC(pb);\n\n\tpb->object_ix = git_oidmap_alloc();\n\tif (!pb->object_ix)\n\t\tgoto on_error;\n\n\tpb->walk_objects = git_oidmap_alloc();\n\tif (!pb->walk_objects)\n\t\tgoto on_error;\n\n\tgit_pool_init(&pb->object_pool, sizeof(git_walk_object));\n\n\tpb->repo = repo;\n\tpb->nr_threads = 1; /* do not spawn any thread by default */\n\n\tif (git_hash_ctx_init(&pb->ctx) < 0 ||\n\t\tgit_zstream_init(&pb->zstream) < 0 ||\n\t\tgit_repository_odb(&pb->odb, repo) < 0 ||\n\t\tpackbuilder_config(pb) < 0)\n\t\tgoto on_error;\n\n#ifdef GIT_THREADS\n\n\tif (git_mutex_init(&pb->cache_mutex) ||\n\t\tgit_mutex_init(&pb->progress_mutex) ||\n\t\tgit_cond_init(&pb->progress_cond))\n\t{\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize packbuilder mutex\");\n\t\tgoto on_error;\n\t}\n\n#endif\n\n\t*out = pb;\n\treturn 0;\n\non_error:\n\tgit_packbuilder_free(pb);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_sorting",
          "args": [
            "walk",
            "GIT_SORT_TIME"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_sorting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "575-591",
          "snippet": "void git_revwalk_sorting(git_revwalk *walk, unsigned int sort_mode)\n{\n\tassert(walk);\n\n\tif (walk->walking)\n\t\tgit_revwalk_reset(walk);\n\n\twalk->sorting = sort_mode;\n\n\tif (walk->sorting & GIT_SORT_TIME) {\n\t\twalk->get_next = &revwalk_next_timesort;\n\t\twalk->enqueue = &revwalk_enqueue_timesort;\n\t} else {\n\t\twalk->get_next = &revwalk_next_unsorted;\n\t\twalk->enqueue = &revwalk_enqueue_unsorted;\n\t}\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nvoid git_revwalk_sorting(git_revwalk *walk, unsigned int sort_mode)\n{\n\tassert(walk);\n\n\tif (walk->walking)\n\t\tgit_revwalk_reset(walk);\n\n\twalk->sorting = sort_mode;\n\n\tif (walk->sorting & GIT_SORT_TIME) {\n\t\twalk->get_next = &revwalk_next_timesort;\n\t\twalk->enqueue = &revwalk_enqueue_timesort;\n\t} else {\n\t\twalk->get_next = &revwalk_next_unsorted;\n\t\twalk->enqueue = &revwalk_enqueue_unsorted;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revwalk_new",
          "args": [
            "&walk",
            "t->repo"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "git_revwalk_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revwalk.c",
          "lines": "529-553",
          "snippet": "int git_revwalk_new(git_revwalk **revwalk_out, git_repository *repo)\n{\n\tgit_revwalk *walk = git__calloc(1, sizeof(git_revwalk));\n\tGITERR_CHECK_ALLOC(walk);\n\n\twalk->commits = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(walk->commits);\n\n\tif (git_pqueue_init(&walk->iterator_time, 0, 8, git_commit_list_time_cmp) < 0)\n\t\treturn -1;\n\n\tgit_pool_init(&walk->commit_pool, COMMIT_ALLOC);\n\twalk->get_next = &revwalk_next_unsorted;\n\twalk->enqueue = &revwalk_enqueue_unsorted;\n\n\twalk->repo = repo;\n\n\tif (git_repository_odb(&walk->odb, repo) < 0) {\n\t\tgit_revwalk_free(walk);\n\t\treturn -1;\n\t}\n\n\t*revwalk_out = walk;\n\treturn 0;\n}",
          "includes": [
            "#include \"merge.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"revwalk.h\"",
            "#include \"pool.h\"",
            "#include \"odb.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"merge.h\"\n#include \"git2/revparse.h\"\n#include \"revwalk.h\"\n#include \"pool.h\"\n#include \"odb.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_revwalk_new(git_revwalk **revwalk_out, git_repository *repo)\n{\n\tgit_revwalk *walk = git__calloc(1, sizeof(git_revwalk));\n\tGITERR_CHECK_ALLOC(walk);\n\n\twalk->commits = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(walk->commits);\n\n\tif (git_pqueue_init(&walk->iterator_time, 0, 8, git_commit_list_time_cmp) < 0)\n\t\treturn -1;\n\n\tgit_pool_init(&walk->commit_pool, COMMIT_ALLOC);\n\twalk->get_next = &revwalk_next_unsorted;\n\twalk->enqueue = &revwalk_enqueue_unsorted;\n\n\twalk->repo = repo;\n\n\tif (git_repository_odb(&walk->odb, repo) < 0) {\n\t\tgit_revwalk_free(walk);\n\t\treturn -1;\n\t}\n\n\t*revwalk_out = walk;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic const char *counting_objects_fmt = \"Counting objects %d\\r\";\n\nstatic int local_download_pack(\n\t\tgit_transport *transport,\n\t\tgit_repository *repo,\n\t\tgit_transfer_progress *stats,\n\t\tgit_transfer_progress_cb progress_cb,\n\t\tvoid *progress_payload)\n{\n\ttransport_local *t = (transport_local*)transport;\n\tgit_revwalk *walk = NULL;\n\tgit_remote_head *rhead;\n\tunsigned int i;\n\tint error = -1;\n\tgit_packbuilder *pack = NULL;\n\tgit_odb_writepack *writepack = NULL;\n\tgit_odb *odb = NULL;\n\tgit_buf progress_info = GIT_BUF_INIT;\n\n\tif ((error = git_revwalk_new(&walk, t->repo)) < 0)\n\t\tgoto cleanup;\n\tgit_revwalk_sorting(walk, GIT_SORT_TIME);\n\n\tif ((error = git_packbuilder_new(&pack, t->repo)) < 0)\n\t\tgoto cleanup;\n\n\tgit_packbuilder_set_callbacks(pack, local_counting, t);\n\n\tstats->total_objects = 0;\n\tstats->indexed_objects = 0;\n\tstats->received_objects = 0;\n\tstats->received_bytes = 0;\n\n\tgit_vector_foreach(&t->refs, i, rhead) {\n\t\tgit_object *obj;\n\t\tif ((error = git_object_lookup(&obj, t->repo, &rhead->oid, GIT_OBJ_ANY)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tif (git_object_type(obj) == GIT_OBJ_COMMIT) {\n\t\t\t/* Revwalker includes only wanted commits */\n\t\t\terror = git_revwalk_push(walk, &rhead->oid);\n\t\t\tif (!error && !git_oid_iszero(&rhead->loid)) {\n\t\t\t\terror = git_revwalk_hide(walk, &rhead->loid);\n\t\t\t\tif (error == GIT_ENOTFOUND)\n\t\t\t\t\terror = 0;\n\t\t\t}\n\t\t} else {\n\t\t\t/* Tag or some other wanted object. Add it on its own */\n\t\t\terror = git_packbuilder_insert_recur(pack, &rhead->oid, rhead->name);\n\t\t}\n\t\tgit_object_free(obj);\n\t\tif (error < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_packbuilder_insert_walk(pack, walk)))\n\t\tgoto cleanup;\n\n\tif ((error = git_buf_printf(&progress_info, counting_objects_fmt, git_packbuilder_object_count(pack))) < 0)\n\t\tgoto cleanup;\n\n\tif (t->progress_cb &&\n\t    (error = t->progress_cb(git_buf_cstr(&progress_info), git_buf_len(&progress_info), t->message_cb_payload)) < 0)\n\t\tgoto cleanup;\n\n\t/* Walk the objects, building a packfile */\n\tif ((error = git_repository_odb__weakptr(&odb, repo)) < 0)\n\t\tgoto cleanup;\n\n\t/* One last one with the newline */\n\tgit_buf_clear(&progress_info);\n\tgit_buf_printf(&progress_info, counting_objects_fmt, git_packbuilder_object_count(pack));\n\tif ((error = git_buf_putc(&progress_info, '\\n')) < 0)\n\t\tgoto cleanup;\n\n\tif (t->progress_cb &&\n\t    (error = t->progress_cb(git_buf_cstr(&progress_info), git_buf_len(&progress_info), t->message_cb_payload)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_odb_write_pack(&writepack, odb, progress_cb, progress_payload)) != 0)\n\t\tgoto cleanup;\n\n\t/* Write the data to the ODB */\n\t{\n\t\tforeach_data data = {0};\n\t\tdata.stats = stats;\n\t\tdata.progress_cb = progress_cb;\n\t\tdata.progress_payload = progress_payload;\n\t\tdata.writepack = writepack;\n\n\t\t/* autodetect */\n\t\tgit_packbuilder_set_threads(pack, 0);\n\n\t\tif ((error = git_packbuilder_foreach(pack, foreach_cb, &data)) != 0)\n\t\t\tgoto cleanup;\n\t}\n\n\terror = writepack->commit(writepack, stats);\n\ncleanup:\n\tif (writepack) writepack->free(writepack);\n\tgit_buf_free(&progress_info);\n\tgit_packbuilder_free(pack);\n\tgit_revwalk_free(walk);\n\treturn error;\n}"
  },
  {
    "function_name": "local_counting",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "473-501",
    "snippet": "static int local_counting(int stage, unsigned int current, unsigned int total, void *payload)\n{\n\tgit_buf progress_info = GIT_BUF_INIT;\n\ttransport_local *t = payload;\n\tint error;\n\n\tif (!t->progress_cb)\n\t\treturn 0;\n\n\tif (stage == GIT_PACKBUILDER_ADDING_OBJECTS) {\n\t\tgit_buf_printf(&progress_info, counting_objects_fmt, current);\n\t} else if (stage == GIT_PACKBUILDER_DELTAFICATION) {\n\t\tfloat perc = (((float) current) / total) * 100;\n\t\tgit_buf_printf(&progress_info, compressing_objects_fmt, perc, current, total);\n\t\tif (current == total)\n\t\t\tgit_buf_printf(&progress_info, \", done\\n\");\n\t\telse\n\t\t\tgit_buf_putc(&progress_info, '\\r');\n\n\t}\n\n\tif (git_buf_oom(&progress_info))\n\t\treturn -1;\n\n\terror = t->progress_cb(git_buf_cstr(&progress_info), git_buf_len(&progress_info), t->message_cb_payload);\n\tgit_buf_free(&progress_info);\n\n\treturn error;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *counting_objects_fmt = \"Counting objects %d\\r\";",
      "static const char *compressing_objects_fmt = \"Compressing objects: %.0f%% (%d/%d)\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&progress_info"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "t->progress_cb",
          "args": [
            "git_buf_cstr(&progress_info)",
            "git_buf_len(&progress_info)",
            "t->message_cb_payload"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "&progress_info"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&progress_info"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "&progress_info"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_putc",
          "args": [
            "&progress_info",
            "'\\r'"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "186-194",
          "snippet": "int git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_putc(git_buf *buf, char c)\n{\n\tsize_t new_size;\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, 2);\n\tENSURE_SIZE(buf, new_size);\n\tbuf->ptr[buf->size++] = c;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_printf",
          "args": [
            "&progress_info",
            "\", done\\n\""
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic const char *counting_objects_fmt = \"Counting objects %d\\r\";\nstatic const char *compressing_objects_fmt = \"Compressing objects: %.0f%% (%d/%d)\";\n\nstatic int local_counting(int stage, unsigned int current, unsigned int total, void *payload)\n{\n\tgit_buf progress_info = GIT_BUF_INIT;\n\ttransport_local *t = payload;\n\tint error;\n\n\tif (!t->progress_cb)\n\t\treturn 0;\n\n\tif (stage == GIT_PACKBUILDER_ADDING_OBJECTS) {\n\t\tgit_buf_printf(&progress_info, counting_objects_fmt, current);\n\t} else if (stage == GIT_PACKBUILDER_DELTAFICATION) {\n\t\tfloat perc = (((float) current) / total) * 100;\n\t\tgit_buf_printf(&progress_info, compressing_objects_fmt, perc, current, total);\n\t\tif (current == total)\n\t\t\tgit_buf_printf(&progress_info, \", done\\n\");\n\t\telse\n\t\t\tgit_buf_putc(&progress_info, '\\r');\n\n\t}\n\n\tif (git_buf_oom(&progress_info))\n\t\treturn -1;\n\n\terror = t->progress_cb(git_buf_cstr(&progress_info), git_buf_len(&progress_info), t->message_cb_payload);\n\tgit_buf_free(&progress_info);\n\n\treturn error;\n}"
  },
  {
    "function_name": "foreach_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "462-468",
    "snippet": "static int foreach_cb(void *buf, size_t len, void *payload)\n{\n\tforeach_data *data = (foreach_data*)payload;\n\n\tdata->stats->received_bytes += len;\n\treturn data->writepack->append(data->writepack, buf, len, data->stats);\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data->writepack->append",
          "args": [
            "data->writepack",
            "buf",
            "len",
            "data->stats"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int foreach_cb(void *buf, size_t len, void *payload)\n{\n\tforeach_data *data = (foreach_data*)payload;\n\n\tdata->stats->received_bytes += len;\n\treturn data->writepack->append(data->writepack, buf, len, data->stats);\n}"
  },
  {
    "function_name": "local_push",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "333-453",
    "snippet": "static int local_push(\n\tgit_transport *transport,\n\tgit_push *push,\n\tconst git_remote_callbacks *cbs)\n{\n\ttransport_local *t = (transport_local *)transport;\n\tgit_repository *remote_repo = NULL;\n\tpush_spec *spec;\n\tchar *url = NULL;\n\tconst char *path;\n\tgit_buf buf = GIT_BUF_INIT, odb_path = GIT_BUF_INIT;\n\tint error;\n\tsize_t j;\n\n\tGIT_UNUSED(cbs);\n\n\t/* 'push->remote->url' may be a url or path; convert to a path */\n\tif ((error = git_path_from_url_or_path(&buf, push->remote->url)) < 0) {\n\t\tgit_buf_free(&buf);\n\t\treturn error;\n\t}\n\tpath = git_buf_cstr(&buf);\n\n\terror = git_repository_open(&remote_repo, path);\n\n\tgit_buf_free(&buf);\n\n\tif (error < 0)\n\t\treturn error;\n\n\t/* We don't currently support pushing locally to non-bare repos. Proper\n\t   non-bare repo push support would require checking configs to see if\n\t   we should override the default 'don't let this happen' behavior.\n\n\t   Note that this is only an issue when pushing to the current branch,\n\t   but we forbid all pushes just in case */\n\tif (!remote_repo->is_bare) {\n\t\terror = GIT_EBAREREPO;\n\t\tgiterr_set(GITERR_INVALID, \"Local push doesn't (yet) support pushing to non-bare repos.\");\n\t\tgoto on_error;\n\t}\n\n\tif ((error = git_buf_joinpath(&odb_path, git_repository_path(remote_repo), \"objects/pack\")) < 0)\n\t\tgoto on_error;\n\n\terror = git_packbuilder_write(push->pb, odb_path.ptr, 0, transfer_to_push_transfer, (void *) cbs);\n\tgit_buf_free(&odb_path);\n\n\tif (error < 0)\n\t\tgoto on_error;\n\n\tpush->unpack_ok = 1;\n\n\tgit_vector_foreach(&push->specs, j, spec) {\n\t\tpush_status *status;\n\t\tconst git_error *last;\n\t\tchar *ref = spec->refspec.dst;\n\n\t\tstatus = git__calloc(1, sizeof(push_status));\n\t\tif (!status)\n\t\t\tgoto on_error;\n\n\t\tstatus->ref = git__strdup(ref);\n\t\tif (!status->ref) {\n\t\t\tgit_push_status_free(status);\n\t\t\tgoto on_error;\n\t\t}\n\n\t\terror = local_push_update_remote_ref(remote_repo, spec->refspec.src, spec->refspec.dst,\n\t\t\t&spec->loid, &spec->roid);\n\n\t\tswitch (error) {\n\t\t\tcase GIT_OK:\n\t\t\t\tbreak;\n\t\t\tcase GIT_EINVALIDSPEC:\n\t\t\t\tstatus->msg = git__strdup(\"funny refname\");\n\t\t\t\tbreak;\n\t\t\tcase GIT_ENOTFOUND:\n\t\t\t\tstatus->msg = git__strdup(\"Remote branch not found to delete\");\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlast = giterr_last();\n\n\t\t\t\tif (last && last->message)\n\t\t\t\t\tstatus->msg = git__strdup(last->message);\n\t\t\t\telse\n\t\t\t\t\tstatus->msg = git__strdup(\"Unspecified error encountered\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\t/* failed to allocate memory for a status message */\n\t\tif (error < 0 && !status->msg) {\n\t\t\tgit_push_status_free(status);\n\t\t\tgoto on_error;\n\t\t}\n\n\t\t/* failed to insert the ref update status */\n\t\tif ((error = git_vector_insert(&push->status, status)) < 0) {\n\t\t\tgit_push_status_free(status);\n\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\tif (push->specs.length) {\n\t\tint flags = t->flags;\n\t\turl = git__strdup(t->url);\n\n\t\tif (!url || t->parent.close(&t->parent) < 0 ||\n\t\t\tt->parent.connect(&t->parent, url,\n\t\t\tNULL, NULL, GIT_DIRECTION_PUSH, flags))\n\t\t\tgoto on_error;\n\t}\n\n\terror = 0;\n\non_error:\n\tgit_repository_free(remote_repo);\n\tgit__free(url);\n\n\treturn error;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "url"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_free",
          "args": [
            "remote_repo"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "121-148",
          "snippet": "void git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "t->parent.connect",
          "args": [
            "&t->parent",
            "url",
            "NULL",
            "NULL",
            "GIT_DIRECTION_PUSH",
            "flags"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->parent.close",
          "args": [
            "&t->parent"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "t->url"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_push_status_free",
          "args": [
            "status"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "git_push_status_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/push.c",
          "lines": "673-681",
          "snippet": "void git_push_status_free(push_status *status)\n{\n\tif (status == NULL)\n\t\treturn;\n\n\tgit__free(status->msg);\n\tgit__free(status->ref);\n\tgit__free(status);\n}",
          "includes": [
            "#include \"tree.h\"",
            "#include \"push.h\"",
            "#include \"vector.h\"",
            "#include \"remote.h\"",
            "#include \"pack-objects.h\"",
            "#include \"pack.h\"",
            "#include \"common.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tree.h\"\n#include \"push.h\"\n#include \"vector.h\"\n#include \"remote.h\"\n#include \"pack-objects.h\"\n#include \"pack.h\"\n#include \"common.h\"\n#include \"git2.h\"\n\nvoid git_push_status_free(push_status *status)\n{\n\tif (status == NULL)\n\t\treturn;\n\n\tgit__free(status->msg);\n\tgit__free(status->ref);\n\tgit__free(status);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&push->status",
            "status"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_last",
          "args": [],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_last",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "134-137",
          "snippet": "const git_error *giterr_last(void)\n{\n\treturn GIT_GLOBAL->last_error;\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nconst git_error *giterr_last(void)\n{\n\treturn GIT_GLOBAL->last_error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_push_update_remote_ref",
          "args": [
            "remote_repo",
            "spec->refspec.src",
            "spec->refspec.dst",
            "&spec->loid",
            "&spec->roid"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "local_push_update_remote_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
          "lines": "292-320",
          "snippet": "static int local_push_update_remote_ref(\n\tgit_repository *remote_repo,\n\tconst char *lref,\n\tconst char *rref,\n\tgit_oid *loid,\n\tgit_oid *roid)\n{\n\tint error;\n\tgit_reference *remote_ref = NULL;\n\n\t/* check for lhs, if it's empty it means to delete */\n\tif (lref[0] != '\\0') {\n\t\t/* Create or update a ref */\n\t\terror = git_reference_create(NULL, remote_repo, rref, loid,\n\t\t\t\t\t     !git_oid_iszero(roid), NULL);\n\t} else {\n\t\t/* Delete a ref */\n\t\tif ((error = git_reference_lookup(&remote_ref, remote_repo, rref)) < 0) {\n\t\t\tif (error == GIT_ENOTFOUND)\n\t\t\t\terror = 0;\n\t\t\treturn error;\n\t\t}\n\n\t\terror = git_reference_delete(remote_ref);\n\t\tgit_reference_free(remote_ref);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"remote.h\"",
            "#include \"push.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"refs.h\"",
            "#include \"pack-objects.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/net.h\"",
            "#include \"git2/types.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_push_update_remote_ref(\n\tgit_repository *remote_repo,\n\tconst char *lref,\n\tconst char *rref,\n\tgit_oid *loid,\n\tgit_oid *roid)\n{\n\tint error;\n\tgit_reference *remote_ref = NULL;\n\n\t/* check for lhs, if it's empty it means to delete */\n\tif (lref[0] != '\\0') {\n\t\t/* Create or update a ref */\n\t\terror = git_reference_create(NULL, remote_repo, rref, loid,\n\t\t\t\t\t     !git_oid_iszero(roid), NULL);\n\t} else {\n\t\t/* Delete a ref */\n\t\tif ((error = git_reference_lookup(&remote_ref, remote_repo, rref)) < 0) {\n\t\t\tif (error == GIT_ENOTFOUND)\n\t\t\t\terror = 0;\n\t\t\treturn error;\n\t\t}\n\n\t\terror = git_reference_delete(remote_ref);\n\t\tgit_reference_free(remote_ref);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(push_status)"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&push->specs",
            "j",
            "spec"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&odb_path"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_packbuilder_write",
          "args": [
            "push->pb",
            "odb_path.ptr",
            "0",
            "transfer_to_push_transfer",
            "(void *) cbs"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1352-1382",
          "snippet": "int git_packbuilder_write(\n\tgit_packbuilder *pb,\n\tconst char *path,\n\tunsigned int mode,\n\tgit_transfer_progress_cb progress_cb,\n\tvoid *progress_cb_payload)\n{\n\tgit_indexer *indexer;\n\tgit_transfer_progress stats;\n\tstruct pack_write_context ctx;\n\n\tPREPARE_PACK;\n\n\tif (git_indexer_new(\n\t\t&indexer, path, mode, pb->odb, progress_cb, progress_cb_payload) < 0)\n\t\treturn -1;\n\n\tctx.indexer = indexer;\n\tctx.stats = &stats;\n\n\tif (git_packbuilder_foreach(pb, write_cb, &ctx) < 0 ||\n\t\tgit_indexer_commit(indexer, &stats) < 0) {\n\t\tgit_indexer_free(indexer);\n\t\treturn -1;\n\t}\n\n\tgit_oid_cpy(&pb->pack_oid, git_indexer_hash(indexer));\n\n\tgit_indexer_free(indexer);\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [
            "#define PREPARE_PACK if (prepare_pack(pb) < 0) { return -1; }"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\n#define PREPARE_PACK if (prepare_pack(pb) < 0) { return -1; }\n\nint git_packbuilder_write(\n\tgit_packbuilder *pb,\n\tconst char *path,\n\tunsigned int mode,\n\tgit_transfer_progress_cb progress_cb,\n\tvoid *progress_cb_payload)\n{\n\tgit_indexer *indexer;\n\tgit_transfer_progress stats;\n\tstruct pack_write_context ctx;\n\n\tPREPARE_PACK;\n\n\tif (git_indexer_new(\n\t\t&indexer, path, mode, pb->odb, progress_cb, progress_cb_payload) < 0)\n\t\treturn -1;\n\n\tctx.indexer = indexer;\n\tctx.stats = &stats;\n\n\tif (git_packbuilder_foreach(pb, write_cb, &ctx) < 0 ||\n\t\tgit_indexer_commit(indexer, &stats) < 0) {\n\t\tgit_indexer_free(indexer);\n\t\treturn -1;\n\t}\n\n\tgit_oid_cpy(&pb->pack_oid, git_indexer_hash(indexer));\n\n\tgit_indexer_free(indexer);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&odb_path",
            "git_repository_path(remote_repo)",
            "\"objects/pack\""
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_path",
          "args": [
            "remote_repo"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1822-1826",
          "snippet": "const char *git_repository_path(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->path_repository;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_path(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->path_repository;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Local push doesn't (yet) support pushing to non-bare repos.\""
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_open",
          "args": [
            "&remote_repo",
            "path"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "557-561",
          "snippet": "int git_repository_open(git_repository **repo_out, const char *path)\n{\n\treturn git_repository_open_ext(\n\t\trepo_out, path, GIT_REPOSITORY_OPEN_NO_SEARCH, NULL);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_open(git_repository **repo_out, const char *path)\n{\n\treturn git_repository_open_ext(\n\t\trepo_out, path, GIT_REPOSITORY_OPEN_NO_SEARCH, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&buf"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_from_url_or_path",
          "args": [
            "&buf",
            "push->remote->url"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_from_url_or_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "1434-1440",
          "snippet": "int git_path_from_url_or_path(git_buf *local_path_out, const char *url_or_path)\n{\n\tif (git_path_is_local_file_url(url_or_path))\n\t\treturn git_path_fromurl(local_path_out, url_or_path);\n\telse\n\t\treturn git_buf_sets(local_path_out, url_or_path);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_from_url_or_path(git_buf *local_path_out, const char *url_or_path)\n{\n\tif (git_path_is_local_file_url(url_or_path))\n\t\treturn git_path_fromurl(local_path_out, url_or_path);\n\telse\n\t\treturn git_buf_sets(local_path_out, url_or_path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "cbs"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_push(\n\tgit_transport *transport,\n\tgit_push *push,\n\tconst git_remote_callbacks *cbs)\n{\n\ttransport_local *t = (transport_local *)transport;\n\tgit_repository *remote_repo = NULL;\n\tpush_spec *spec;\n\tchar *url = NULL;\n\tconst char *path;\n\tgit_buf buf = GIT_BUF_INIT, odb_path = GIT_BUF_INIT;\n\tint error;\n\tsize_t j;\n\n\tGIT_UNUSED(cbs);\n\n\t/* 'push->remote->url' may be a url or path; convert to a path */\n\tif ((error = git_path_from_url_or_path(&buf, push->remote->url)) < 0) {\n\t\tgit_buf_free(&buf);\n\t\treturn error;\n\t}\n\tpath = git_buf_cstr(&buf);\n\n\terror = git_repository_open(&remote_repo, path);\n\n\tgit_buf_free(&buf);\n\n\tif (error < 0)\n\t\treturn error;\n\n\t/* We don't currently support pushing locally to non-bare repos. Proper\n\t   non-bare repo push support would require checking configs to see if\n\t   we should override the default 'don't let this happen' behavior.\n\n\t   Note that this is only an issue when pushing to the current branch,\n\t   but we forbid all pushes just in case */\n\tif (!remote_repo->is_bare) {\n\t\terror = GIT_EBAREREPO;\n\t\tgiterr_set(GITERR_INVALID, \"Local push doesn't (yet) support pushing to non-bare repos.\");\n\t\tgoto on_error;\n\t}\n\n\tif ((error = git_buf_joinpath(&odb_path, git_repository_path(remote_repo), \"objects/pack\")) < 0)\n\t\tgoto on_error;\n\n\terror = git_packbuilder_write(push->pb, odb_path.ptr, 0, transfer_to_push_transfer, (void *) cbs);\n\tgit_buf_free(&odb_path);\n\n\tif (error < 0)\n\t\tgoto on_error;\n\n\tpush->unpack_ok = 1;\n\n\tgit_vector_foreach(&push->specs, j, spec) {\n\t\tpush_status *status;\n\t\tconst git_error *last;\n\t\tchar *ref = spec->refspec.dst;\n\n\t\tstatus = git__calloc(1, sizeof(push_status));\n\t\tif (!status)\n\t\t\tgoto on_error;\n\n\t\tstatus->ref = git__strdup(ref);\n\t\tif (!status->ref) {\n\t\t\tgit_push_status_free(status);\n\t\t\tgoto on_error;\n\t\t}\n\n\t\terror = local_push_update_remote_ref(remote_repo, spec->refspec.src, spec->refspec.dst,\n\t\t\t&spec->loid, &spec->roid);\n\n\t\tswitch (error) {\n\t\t\tcase GIT_OK:\n\t\t\t\tbreak;\n\t\t\tcase GIT_EINVALIDSPEC:\n\t\t\t\tstatus->msg = git__strdup(\"funny refname\");\n\t\t\t\tbreak;\n\t\t\tcase GIT_ENOTFOUND:\n\t\t\t\tstatus->msg = git__strdup(\"Remote branch not found to delete\");\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlast = giterr_last();\n\n\t\t\t\tif (last && last->message)\n\t\t\t\t\tstatus->msg = git__strdup(last->message);\n\t\t\t\telse\n\t\t\t\t\tstatus->msg = git__strdup(\"Unspecified error encountered\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\t/* failed to allocate memory for a status message */\n\t\tif (error < 0 && !status->msg) {\n\t\t\tgit_push_status_free(status);\n\t\t\tgoto on_error;\n\t\t}\n\n\t\t/* failed to insert the ref update status */\n\t\tif ((error = git_vector_insert(&push->status, status)) < 0) {\n\t\t\tgit_push_status_free(status);\n\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\tif (push->specs.length) {\n\t\tint flags = t->flags;\n\t\turl = git__strdup(t->url);\n\n\t\tif (!url || t->parent.close(&t->parent) < 0 ||\n\t\t\tt->parent.connect(&t->parent, url,\n\t\t\tNULL, NULL, GIT_DIRECTION_PUSH, flags))\n\t\t\tgoto on_error;\n\t}\n\n\terror = 0;\n\non_error:\n\tgit_repository_free(remote_repo);\n\tgit__free(url);\n\n\treturn error;\n}"
  },
  {
    "function_name": "transfer_to_push_transfer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "322-331",
    "snippet": "static int transfer_to_push_transfer(const git_transfer_progress *stats, void *payload)\n{\n\tconst git_remote_callbacks *cbs = payload;\n\n\tif (!cbs || !cbs->push_transfer_progress)\n\t\treturn 0;\n\n\treturn cbs->push_transfer_progress(stats->received_objects, stats->total_objects, stats->received_bytes,\n\t\t\t\t\t   cbs->payload);\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cbs->push_transfer_progress",
          "args": [
            "stats->received_objects",
            "stats->total_objects",
            "stats->received_bytes",
            "cbs->payload"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int transfer_to_push_transfer(const git_transfer_progress *stats, void *payload)\n{\n\tconst git_remote_callbacks *cbs = payload;\n\n\tif (!cbs || !cbs->push_transfer_progress)\n\t\treturn 0;\n\n\treturn cbs->push_transfer_progress(stats->received_objects, stats->total_objects, stats->received_bytes,\n\t\t\t\t\t   cbs->payload);\n}"
  },
  {
    "function_name": "local_push_update_remote_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "292-320",
    "snippet": "static int local_push_update_remote_ref(\n\tgit_repository *remote_repo,\n\tconst char *lref,\n\tconst char *rref,\n\tgit_oid *loid,\n\tgit_oid *roid)\n{\n\tint error;\n\tgit_reference *remote_ref = NULL;\n\n\t/* check for lhs, if it's empty it means to delete */\n\tif (lref[0] != '\\0') {\n\t\t/* Create or update a ref */\n\t\terror = git_reference_create(NULL, remote_repo, rref, loid,\n\t\t\t\t\t     !git_oid_iszero(roid), NULL);\n\t} else {\n\t\t/* Delete a ref */\n\t\tif ((error = git_reference_lookup(&remote_ref, remote_repo, rref)) < 0) {\n\t\t\tif (error == GIT_ENOTFOUND)\n\t\t\t\terror = 0;\n\t\t\treturn error;\n\t\t}\n\n\t\terror = git_reference_delete(remote_ref);\n\t\tgit_reference_free(remote_ref);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "remote_ref"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_delete",
          "args": [
            "remote_ref"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "122-133",
          "snippet": "int git_reference_delete(git_reference *ref)\n{\n\tconst git_oid *old_id = NULL;\n\tconst char *old_target = NULL;\n\n\tif (ref->type == GIT_REF_OID)\n\t\told_id = &ref->target.oid;\n\telse\n\t\told_target = ref->target.symbolic;\n\n\treturn git_refdb_delete(ref->db, ref->name, old_id, old_target);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_delete(git_reference *ref)\n{\n\tconst git_oid *old_id = NULL;\n\tconst char *old_target = NULL;\n\n\tif (ref->type == GIT_REF_OID)\n\t\told_id = &ref->target.oid;\n\telse\n\t\told_target = ref->target.symbolic;\n\n\treturn git_refdb_delete(ref->db, ref->name, old_id, old_target);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup",
          "args": [
            "&remote_ref",
            "remote_repo",
            "rref"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "146-150",
          "snippet": "int git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_create",
          "args": [
            "NULL",
            "remote_repo",
            "rref",
            "loid",
            "!git_oid_iszero(roid)",
            "NULL"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "464-473",
          "snippet": "int git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_iszero",
          "args": [
            "roid"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_iszero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "239-247",
          "snippet": "int git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nint git_oid_iszero(const git_oid *oid_a)\n{\n\tconst unsigned char *a = oid_a->id;\n\tunsigned int i;\n\tfor (i = 0; i < GIT_OID_RAWSZ; ++i, ++a)\n\t\tif (*a != 0)\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_push_update_remote_ref(\n\tgit_repository *remote_repo,\n\tconst char *lref,\n\tconst char *rref,\n\tgit_oid *loid,\n\tgit_oid *roid)\n{\n\tint error;\n\tgit_reference *remote_ref = NULL;\n\n\t/* check for lhs, if it's empty it means to delete */\n\tif (lref[0] != '\\0') {\n\t\t/* Create or update a ref */\n\t\terror = git_reference_create(NULL, remote_repo, rref, loid,\n\t\t\t\t\t     !git_oid_iszero(roid), NULL);\n\t} else {\n\t\t/* Delete a ref */\n\t\tif ((error = git_reference_lookup(&remote_ref, remote_repo, rref)) < 0) {\n\t\t\tif (error == GIT_ENOTFOUND)\n\t\t\t\terror = 0;\n\t\t\treturn error;\n\t\t}\n\n\t\terror = git_reference_delete(remote_ref);\n\t\tgit_reference_free(remote_ref);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "local_negotiate_fetch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "262-290",
    "snippet": "static int local_negotiate_fetch(\n\tgit_transport *transport,\n\tgit_repository *repo,\n\tconst git_remote_head * const *refs,\n\tsize_t count)\n{\n\ttransport_local *t = (transport_local*)transport;\n\tgit_remote_head *rhead;\n\tunsigned int i;\n\n\tGIT_UNUSED(refs);\n\tGIT_UNUSED(count);\n\n\t/* Fill in the loids */\n\tgit_vector_foreach(&t->refs, i, rhead) {\n\t\tgit_object *obj;\n\n\t\tint error = git_revparse_single(&obj, repo, rhead->name);\n\t\tif (!error)\n\t\t\tgit_oid_cpy(&rhead->loid, git_object_id(obj));\n\t\telse if (error != GIT_ENOTFOUND)\n\t\t\treturn error;\n\t\telse\n\t\t\tgiterr_clear();\n\t\tgit_object_free(obj);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "obj"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&rhead->loid",
            "git_object_id(obj)"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_id",
          "args": [
            "obj"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "209-213",
          "snippet": "const git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_revparse_single",
          "args": [
            "&obj",
            "repo",
            "rhead->name"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "git_revparse_single",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/revparse.c",
          "lines": "855-876",
          "snippet": "int git_revparse_single(git_object **out, git_repository *repo, const char *spec)\n{\n\tint error;\n\tgit_object *obj = NULL;\n\tgit_reference *ref = NULL;\n\n\t*out = NULL;\n\n\tif ((error = git_revparse_ext(&obj, &ref, repo, spec)) < 0)\n\t\tgoto cleanup;\n\n\tgit_reference_free(ref);\n\n\t*out = obj;\n\n\treturn 0;\n\ncleanup:\n\tgit_object_free(obj);\n\tgit_reference_free(ref);\n\treturn error;\n}",
          "includes": [
            "#include \"git2.h\"",
            "#include \"refdb.h\"",
            "#include \"tree.h\"",
            "#include \"buffer.h\"",
            "#include \"common.h\"",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2.h\"\n#include \"refdb.h\"\n#include \"tree.h\"\n#include \"buffer.h\"\n#include \"common.h\"\n#include <assert.h>\n\nint git_revparse_single(git_object **out, git_repository *repo, const char *spec)\n{\n\tint error;\n\tgit_object *obj = NULL;\n\tgit_reference *ref = NULL;\n\n\t*out = NULL;\n\n\tif ((error = git_revparse_ext(&obj, &ref, repo, spec)) < 0)\n\t\tgoto cleanup;\n\n\tgit_reference_free(ref);\n\n\t*out = obj;\n\n\treturn 0;\n\ncleanup:\n\tgit_object_free(obj);\n\tgit_reference_free(ref);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&t->refs",
            "i",
            "rhead"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "count"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "refs"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_negotiate_fetch(\n\tgit_transport *transport,\n\tgit_repository *repo,\n\tconst git_remote_head * const *refs,\n\tsize_t count)\n{\n\ttransport_local *t = (transport_local*)transport;\n\tgit_remote_head *rhead;\n\tunsigned int i;\n\n\tGIT_UNUSED(refs);\n\tGIT_UNUSED(count);\n\n\t/* Fill in the loids */\n\tgit_vector_foreach(&t->refs, i, rhead) {\n\t\tgit_object *obj;\n\n\t\tint error = git_revparse_single(&obj, repo, rhead->name);\n\t\tif (!error)\n\t\t\tgit_oid_cpy(&rhead->loid, git_object_id(obj));\n\t\telse if (error != GIT_ENOTFOUND)\n\t\t\treturn error;\n\t\telse\n\t\t\tgiterr_clear();\n\t\tgit_object_free(obj);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "local_ls",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "247-260",
    "snippet": "static int local_ls(const git_remote_head ***out, size_t *size, git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tif (!t->have_refs) {\n\t\tgiterr_set(GITERR_NET, \"The transport has not yet loaded the refs\");\n\t\treturn -1;\n\t}\n\n\t*out = (const git_remote_head **)t->refs.contents;\n\t*size = t->refs.length;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"The transport has not yet loaded the refs\""
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_ls(const git_remote_head ***out, size_t *size, git_transport *transport)\n{\n\ttransport_local *t = (transport_local *)transport;\n\n\tif (!t->have_refs) {\n\t\tgiterr_set(GITERR_NET, \"The transport has not yet loaded the refs\");\n\t\treturn -1;\n\t}\n\n\t*out = (const git_remote_head **)t->refs.contents;\n\t*size = t->refs.length;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "local_connect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "197-245",
    "snippet": "static int local_connect(\n\tgit_transport *transport,\n\tconst char *url,\n\tgit_cred_acquire_cb cred_acquire_cb,\n\tvoid *cred_acquire_payload,\n\tint direction, int flags)\n{\n\tgit_repository *repo;\n\tint error;\n\ttransport_local *t = (transport_local *) transport;\n\tconst char *path;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tGIT_UNUSED(cred_acquire_cb);\n\tGIT_UNUSED(cred_acquire_payload);\n\n\tif (t->connected)\n\t\treturn 0;\n\n\tfree_heads(&t->refs);\n\n\tt->url = git__strdup(url);\n\tGITERR_CHECK_ALLOC(t->url);\n\tt->direction = direction;\n\tt->flags = flags;\n\n\t/* 'url' may be a url or path; convert to a path */\n\tif ((error = git_path_from_url_or_path(&buf, url)) < 0) {\n\t\tgit_buf_free(&buf);\n\t\treturn error;\n\t}\n\tpath = git_buf_cstr(&buf);\n\n\terror = git_repository_open(&repo, path);\n\n\tgit_buf_free(&buf);\n\n\tif (error < 0)\n\t\treturn -1;\n\n\tt->repo = repo;\n\n\tif (store_refs(t) < 0)\n\t\treturn -1;\n\n\tt->connected = 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "store_refs",
          "args": [
            "t"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "store_refs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
          "lines": "151-191",
          "snippet": "static int store_refs(transport_local *t)\n{\n\tsize_t i;\n\tgit_remote_head *head;\n\tgit_strarray ref_names = {0};\n\n\tassert(t);\n\n\tif (git_reference_list(&ref_names, t->repo) < 0)\n\t\tgoto on_error;\n\n\t/* Clear all heads we might have fetched in a previous connect */\n\tgit_vector_foreach(&t->refs, i, head) {\n\t\tgit__free(head->name);\n\t\tgit__free(head);\n\t}\n\n\t/* Clear the vector so we can reuse it */\n\tgit_vector_clear(&t->refs);\n\n\t/* Sort the references first */\n\tgit__tsort((void **)ref_names.strings, ref_names.count, &git__strcmp_cb);\n\n\t/* Add HEAD iff direction is fetch */\n\tif (t->direction == GIT_DIRECTION_FETCH && add_ref(t, GIT_HEAD_FILE) < 0)\n\t\tgoto on_error;\n\n\tfor (i = 0; i < ref_names.count; ++i) {\n\t\tif (add_ref(t, ref_names.strings[i]) < 0)\n\t\t\tgoto on_error;\n\t}\n\n\tt->have_refs = 1;\n\tgit_strarray_free(&ref_names);\n\treturn 0;\n\non_error:\n\tgit_vector_free(&t->refs);\n\tgit_strarray_free(&ref_names);\n\treturn -1;\n}",
          "includes": [
            "#include \"remote.h\"",
            "#include \"push.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"refs.h\"",
            "#include \"pack-objects.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/net.h\"",
            "#include \"git2/types.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int store_refs(transport_local *t)\n{\n\tsize_t i;\n\tgit_remote_head *head;\n\tgit_strarray ref_names = {0};\n\n\tassert(t);\n\n\tif (git_reference_list(&ref_names, t->repo) < 0)\n\t\tgoto on_error;\n\n\t/* Clear all heads we might have fetched in a previous connect */\n\tgit_vector_foreach(&t->refs, i, head) {\n\t\tgit__free(head->name);\n\t\tgit__free(head);\n\t}\n\n\t/* Clear the vector so we can reuse it */\n\tgit_vector_clear(&t->refs);\n\n\t/* Sort the references first */\n\tgit__tsort((void **)ref_names.strings, ref_names.count, &git__strcmp_cb);\n\n\t/* Add HEAD iff direction is fetch */\n\tif (t->direction == GIT_DIRECTION_FETCH && add_ref(t, GIT_HEAD_FILE) < 0)\n\t\tgoto on_error;\n\n\tfor (i = 0; i < ref_names.count; ++i) {\n\t\tif (add_ref(t, ref_names.strings[i]) < 0)\n\t\t\tgoto on_error;\n\t}\n\n\tt->have_refs = 1;\n\tgit_strarray_free(&ref_names);\n\treturn 0;\n\non_error:\n\tgit_vector_free(&t->refs);\n\tgit_strarray_free(&ref_names);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_open",
          "args": [
            "&repo",
            "path"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "557-561",
          "snippet": "int git_repository_open(git_repository **repo_out, const char *path)\n{\n\treturn git_repository_open_ext(\n\t\trepo_out, path, GIT_REPOSITORY_OPEN_NO_SEARCH, NULL);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_open(git_repository **repo_out, const char *path)\n{\n\treturn git_repository_open_ext(\n\t\trepo_out, path, GIT_REPOSITORY_OPEN_NO_SEARCH, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&buf"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_from_url_or_path",
          "args": [
            "&buf",
            "url"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_from_url_or_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "1434-1440",
          "snippet": "int git_path_from_url_or_path(git_buf *local_path_out, const char *url_or_path)\n{\n\tif (git_path_is_local_file_url(url_or_path))\n\t\treturn git_path_fromurl(local_path_out, url_or_path);\n\telse\n\t\treturn git_buf_sets(local_path_out, url_or_path);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_from_url_or_path(git_buf *local_path_out, const char *url_or_path)\n{\n\tif (git_path_is_local_file_url(url_or_path))\n\t\treturn git_path_fromurl(local_path_out, url_or_path);\n\telse\n\t\treturn git_buf_sets(local_path_out, url_or_path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "t->url"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "url"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_heads",
          "args": [
            "&t->refs"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "free_heads",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
          "lines": "52-61",
          "snippet": "static void free_heads(git_vector *heads)\n{\n\tgit_remote_head *head;\n\tsize_t i;\n\n\tgit_vector_foreach(heads, i, head)\n\t\tfree_head(head);\n\n\tgit_vector_free(heads);\n}",
          "includes": [
            "#include \"remote.h\"",
            "#include \"push.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"refs.h\"",
            "#include \"pack-objects.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/net.h\"",
            "#include \"git2/types.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic void free_heads(git_vector *heads)\n{\n\tgit_remote_head *head;\n\tsize_t i;\n\n\tgit_vector_foreach(heads, i, head)\n\t\tfree_head(head);\n\n\tgit_vector_free(heads);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "cred_acquire_payload"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "cred_acquire_cb"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int local_connect(\n\tgit_transport *transport,\n\tconst char *url,\n\tgit_cred_acquire_cb cred_acquire_cb,\n\tvoid *cred_acquire_payload,\n\tint direction, int flags)\n{\n\tgit_repository *repo;\n\tint error;\n\ttransport_local *t = (transport_local *) transport;\n\tconst char *path;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tGIT_UNUSED(cred_acquire_cb);\n\tGIT_UNUSED(cred_acquire_payload);\n\n\tif (t->connected)\n\t\treturn 0;\n\n\tfree_heads(&t->refs);\n\n\tt->url = git__strdup(url);\n\tGITERR_CHECK_ALLOC(t->url);\n\tt->direction = direction;\n\tt->flags = flags;\n\n\t/* 'url' may be a url or path; convert to a path */\n\tif ((error = git_path_from_url_or_path(&buf, url)) < 0) {\n\t\tgit_buf_free(&buf);\n\t\treturn error;\n\t}\n\tpath = git_buf_cstr(&buf);\n\n\terror = git_repository_open(&repo, path);\n\n\tgit_buf_free(&buf);\n\n\tif (error < 0)\n\t\treturn -1;\n\n\tt->repo = repo;\n\n\tif (store_refs(t) < 0)\n\t\treturn -1;\n\n\tt->connected = 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "store_refs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "151-191",
    "snippet": "static int store_refs(transport_local *t)\n{\n\tsize_t i;\n\tgit_remote_head *head;\n\tgit_strarray ref_names = {0};\n\n\tassert(t);\n\n\tif (git_reference_list(&ref_names, t->repo) < 0)\n\t\tgoto on_error;\n\n\t/* Clear all heads we might have fetched in a previous connect */\n\tgit_vector_foreach(&t->refs, i, head) {\n\t\tgit__free(head->name);\n\t\tgit__free(head);\n\t}\n\n\t/* Clear the vector so we can reuse it */\n\tgit_vector_clear(&t->refs);\n\n\t/* Sort the references first */\n\tgit__tsort((void **)ref_names.strings, ref_names.count, &git__strcmp_cb);\n\n\t/* Add HEAD iff direction is fetch */\n\tif (t->direction == GIT_DIRECTION_FETCH && add_ref(t, GIT_HEAD_FILE) < 0)\n\t\tgoto on_error;\n\n\tfor (i = 0; i < ref_names.count; ++i) {\n\t\tif (add_ref(t, ref_names.strings[i]) < 0)\n\t\t\tgoto on_error;\n\t}\n\n\tt->have_refs = 1;\n\tgit_strarray_free(&ref_names);\n\treturn 0;\n\non_error:\n\tgit_vector_free(&t->refs);\n\tgit_strarray_free(&ref_names);\n\treturn -1;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_strarray_free",
          "args": [
            "&ref_names"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "git_strarray_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "21-34",
          "snippet": "void git_strarray_free(git_strarray *array)\n{\n\tsize_t i;\n\n\tif (array == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < array->count; ++i)\n\t\tgit__free(array->strings[i]);\n\n\tgit__free(array->strings);\n\n\tmemset(array, 0, sizeof(*array));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git_strarray_free(git_strarray *array)\n{\n\tsize_t i;\n\n\tif (array == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < array->count; ++i)\n\t\tgit__free(array->strings[i]);\n\n\tgit__free(array->strings);\n\n\tmemset(array, 0, sizeof(*array));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "&t->refs"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_ref",
          "args": [
            "t",
            "ref_names.strings[i]"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "add_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
          "lines": "63-149",
          "snippet": "static int add_ref(transport_local *t, const char *name)\n{\n\tconst char peeled[] = \"^{}\";\n\tgit_reference *ref, *resolved;\n\tgit_remote_head *head;\n\tgit_oid obj_id;\n\tgit_object *obj = NULL, *target = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\n\tif ((error = git_reference_lookup(&ref, t->repo, name)) < 0)\n\t\treturn error;\n\n\terror = git_reference_resolve(&resolved, ref);\n\tif (error < 0) {\n\t\tgit_reference_free(ref);\n\t\tif (!strcmp(name, GIT_HEAD_FILE) && error == GIT_ENOTFOUND) {\n\t\t\t/* This is actually okay.  Empty repos often have a HEAD that\n\t\t\t * points to a nonexistent \"refs/heads/master\". */\n\t\t\tgiterr_clear();\n\t\t\treturn 0;\n\t\t}\n\t\treturn error;\n\t}\n\n\tgit_oid_cpy(&obj_id, git_reference_target(resolved));\n\tgit_reference_free(resolved);\n\n\thead = git__calloc(1, sizeof(git_remote_head));\n\tGITERR_CHECK_ALLOC(head);\n\n\thead->name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(head->name);\n\n\tgit_oid_cpy(&head->oid, &obj_id);\n\n\tif (git_reference_type(ref) == GIT_REF_SYMBOLIC) {\n\t\thead->symref_target = git__strdup(git_reference_symbolic_target(ref));\n\t\tGITERR_CHECK_ALLOC(head->symref_target);\n\t}\n\tgit_reference_free(ref);\n\n\tif ((error = git_vector_insert(&t->refs, head)) < 0) {\n\t\tfree_head(head);\n\t\treturn error;\n\t}\n\n\t/* If it's not a tag, we don't need to try to peel it */\n\tif (git__prefixcmp(name, GIT_REFS_TAGS_DIR))\n\t\treturn 0;\n\n\tif ((error = git_object_lookup(&obj, t->repo, &head->oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\thead = NULL;\n\n\t/* If it's not an annotated tag, or if we're mocking\n\t * git-receive-pack, just get out */\n\tif (git_object_type(obj) != GIT_OBJ_TAG ||\n\t\tt->direction != GIT_DIRECTION_FETCH) {\n\t\tgit_object_free(obj);\n\t\treturn 0;\n\t}\n\n\t/* And if it's a tag, peel it, and add it to the list */\n\thead = git__calloc(1, sizeof(git_remote_head));\n\tGITERR_CHECK_ALLOC(head);\n\n\tif (git_buf_join(&buf, 0, name, peeled) < 0) {\n\t\tfree_head(head);\n\t\treturn -1;\n\t}\n\thead->name = git_buf_detach(&buf);\n\n\tif (!(error = git_tag_peel(&target, (git_tag *)obj))) {\n\t\tgit_oid_cpy(&head->oid, git_object_id(target));\n\n\t\tif ((error = git_vector_insert(&t->refs, head)) < 0) {\n\t\t\tfree_head(head);\n\t\t}\n\t}\n\n\tgit_object_free(obj);\n\tgit_object_free(target);\n\n\treturn error;\n}",
          "includes": [
            "#include \"remote.h\"",
            "#include \"push.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"refs.h\"",
            "#include \"pack-objects.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/net.h\"",
            "#include \"git2/types.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int add_ref(transport_local *t, const char *name)\n{\n\tconst char peeled[] = \"^{}\";\n\tgit_reference *ref, *resolved;\n\tgit_remote_head *head;\n\tgit_oid obj_id;\n\tgit_object *obj = NULL, *target = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\n\tif ((error = git_reference_lookup(&ref, t->repo, name)) < 0)\n\t\treturn error;\n\n\terror = git_reference_resolve(&resolved, ref);\n\tif (error < 0) {\n\t\tgit_reference_free(ref);\n\t\tif (!strcmp(name, GIT_HEAD_FILE) && error == GIT_ENOTFOUND) {\n\t\t\t/* This is actually okay.  Empty repos often have a HEAD that\n\t\t\t * points to a nonexistent \"refs/heads/master\". */\n\t\t\tgiterr_clear();\n\t\t\treturn 0;\n\t\t}\n\t\treturn error;\n\t}\n\n\tgit_oid_cpy(&obj_id, git_reference_target(resolved));\n\tgit_reference_free(resolved);\n\n\thead = git__calloc(1, sizeof(git_remote_head));\n\tGITERR_CHECK_ALLOC(head);\n\n\thead->name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(head->name);\n\n\tgit_oid_cpy(&head->oid, &obj_id);\n\n\tif (git_reference_type(ref) == GIT_REF_SYMBOLIC) {\n\t\thead->symref_target = git__strdup(git_reference_symbolic_target(ref));\n\t\tGITERR_CHECK_ALLOC(head->symref_target);\n\t}\n\tgit_reference_free(ref);\n\n\tif ((error = git_vector_insert(&t->refs, head)) < 0) {\n\t\tfree_head(head);\n\t\treturn error;\n\t}\n\n\t/* If it's not a tag, we don't need to try to peel it */\n\tif (git__prefixcmp(name, GIT_REFS_TAGS_DIR))\n\t\treturn 0;\n\n\tif ((error = git_object_lookup(&obj, t->repo, &head->oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\thead = NULL;\n\n\t/* If it's not an annotated tag, or if we're mocking\n\t * git-receive-pack, just get out */\n\tif (git_object_type(obj) != GIT_OBJ_TAG ||\n\t\tt->direction != GIT_DIRECTION_FETCH) {\n\t\tgit_object_free(obj);\n\t\treturn 0;\n\t}\n\n\t/* And if it's a tag, peel it, and add it to the list */\n\thead = git__calloc(1, sizeof(git_remote_head));\n\tGITERR_CHECK_ALLOC(head);\n\n\tif (git_buf_join(&buf, 0, name, peeled) < 0) {\n\t\tfree_head(head);\n\t\treturn -1;\n\t}\n\thead->name = git_buf_detach(&buf);\n\n\tif (!(error = git_tag_peel(&target, (git_tag *)obj))) {\n\t\tgit_oid_cpy(&head->oid, git_object_id(target));\n\n\t\tif ((error = git_vector_insert(&t->refs, head)) < 0) {\n\t\t\tfree_head(head);\n\t\t}\n\t}\n\n\tgit_object_free(obj);\n\tgit_object_free(target);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__tsort",
          "args": [
            "(void **)ref_names.strings",
            "ref_names.count",
            "&git__strcmp_cb"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "git__tsort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tsort.c",
          "lines": "382-385",
          "snippet": "void git__tsort(void **dst, size_t size, git__tsort_cmp cmp)\n{\n\tgit__tsort_r(dst, size, tsort_r_cmp, cmp);\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nvoid git__tsort(void **dst, size_t size, git__tsort_cmp cmp)\n{\n\tgit__tsort_r(dst, size, tsort_r_cmp, cmp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_clear",
          "args": [
            "&t->refs"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "298-303",
          "snippet": "void git_vector_clear(git_vector *v)\n{\n\tassert(v);\n\tv->length = 0;\n\tgit_vector_set_sorted(v, 1);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_clear(git_vector *v)\n{\n\tassert(v);\n\tv->length = 0;\n\tgit_vector_set_sorted(v, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "head"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "&t->refs",
            "i",
            "head"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_reference_list",
          "args": [
            "&ref_names",
            "t->repo"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "757-780",
          "snippet": "int git_reference_list(\n\tgit_strarray *array,\n\tgit_repository *repo)\n{\n\tgit_vector ref_list;\n\n\tassert(array && repo);\n\n\tarray->strings = NULL;\n\tarray->count = 0;\n\n\tif (git_vector_init(&ref_list, 8, NULL) < 0)\n\t\treturn -1;\n\n\tif (git_reference_foreach_name(\n\t\t\trepo, &cb__reflist_add, (void *)&ref_list) < 0) {\n\t\tgit_vector_free(&ref_list);\n\t\treturn -1;\n\t}\n\n\tarray->strings = (char **)git_vector_detach(&array->count, NULL, &ref_list);\n\n\treturn 0;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_list(\n\tgit_strarray *array,\n\tgit_repository *repo)\n{\n\tgit_vector ref_list;\n\n\tassert(array && repo);\n\n\tarray->strings = NULL;\n\tarray->count = 0;\n\n\tif (git_vector_init(&ref_list, 8, NULL) < 0)\n\t\treturn -1;\n\n\tif (git_reference_foreach_name(\n\t\t\trepo, &cb__reflist_add, (void *)&ref_list) < 0) {\n\t\tgit_vector_free(&ref_list);\n\t\treturn -1;\n\t}\n\n\tarray->strings = (char **)git_vector_detach(&array->count, NULL, &ref_list);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "t"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int store_refs(transport_local *t)\n{\n\tsize_t i;\n\tgit_remote_head *head;\n\tgit_strarray ref_names = {0};\n\n\tassert(t);\n\n\tif (git_reference_list(&ref_names, t->repo) < 0)\n\t\tgoto on_error;\n\n\t/* Clear all heads we might have fetched in a previous connect */\n\tgit_vector_foreach(&t->refs, i, head) {\n\t\tgit__free(head->name);\n\t\tgit__free(head);\n\t}\n\n\t/* Clear the vector so we can reuse it */\n\tgit_vector_clear(&t->refs);\n\n\t/* Sort the references first */\n\tgit__tsort((void **)ref_names.strings, ref_names.count, &git__strcmp_cb);\n\n\t/* Add HEAD iff direction is fetch */\n\tif (t->direction == GIT_DIRECTION_FETCH && add_ref(t, GIT_HEAD_FILE) < 0)\n\t\tgoto on_error;\n\n\tfor (i = 0; i < ref_names.count; ++i) {\n\t\tif (add_ref(t, ref_names.strings[i]) < 0)\n\t\t\tgoto on_error;\n\t}\n\n\tt->have_refs = 1;\n\tgit_strarray_free(&ref_names);\n\treturn 0;\n\non_error:\n\tgit_vector_free(&t->refs);\n\tgit_strarray_free(&ref_names);\n\treturn -1;\n}"
  },
  {
    "function_name": "add_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "63-149",
    "snippet": "static int add_ref(transport_local *t, const char *name)\n{\n\tconst char peeled[] = \"^{}\";\n\tgit_reference *ref, *resolved;\n\tgit_remote_head *head;\n\tgit_oid obj_id;\n\tgit_object *obj = NULL, *target = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\n\tif ((error = git_reference_lookup(&ref, t->repo, name)) < 0)\n\t\treturn error;\n\n\terror = git_reference_resolve(&resolved, ref);\n\tif (error < 0) {\n\t\tgit_reference_free(ref);\n\t\tif (!strcmp(name, GIT_HEAD_FILE) && error == GIT_ENOTFOUND) {\n\t\t\t/* This is actually okay.  Empty repos often have a HEAD that\n\t\t\t * points to a nonexistent \"refs/heads/master\". */\n\t\t\tgiterr_clear();\n\t\t\treturn 0;\n\t\t}\n\t\treturn error;\n\t}\n\n\tgit_oid_cpy(&obj_id, git_reference_target(resolved));\n\tgit_reference_free(resolved);\n\n\thead = git__calloc(1, sizeof(git_remote_head));\n\tGITERR_CHECK_ALLOC(head);\n\n\thead->name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(head->name);\n\n\tgit_oid_cpy(&head->oid, &obj_id);\n\n\tif (git_reference_type(ref) == GIT_REF_SYMBOLIC) {\n\t\thead->symref_target = git__strdup(git_reference_symbolic_target(ref));\n\t\tGITERR_CHECK_ALLOC(head->symref_target);\n\t}\n\tgit_reference_free(ref);\n\n\tif ((error = git_vector_insert(&t->refs, head)) < 0) {\n\t\tfree_head(head);\n\t\treturn error;\n\t}\n\n\t/* If it's not a tag, we don't need to try to peel it */\n\tif (git__prefixcmp(name, GIT_REFS_TAGS_DIR))\n\t\treturn 0;\n\n\tif ((error = git_object_lookup(&obj, t->repo, &head->oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\thead = NULL;\n\n\t/* If it's not an annotated tag, or if we're mocking\n\t * git-receive-pack, just get out */\n\tif (git_object_type(obj) != GIT_OBJ_TAG ||\n\t\tt->direction != GIT_DIRECTION_FETCH) {\n\t\tgit_object_free(obj);\n\t\treturn 0;\n\t}\n\n\t/* And if it's a tag, peel it, and add it to the list */\n\thead = git__calloc(1, sizeof(git_remote_head));\n\tGITERR_CHECK_ALLOC(head);\n\n\tif (git_buf_join(&buf, 0, name, peeled) < 0) {\n\t\tfree_head(head);\n\t\treturn -1;\n\t}\n\thead->name = git_buf_detach(&buf);\n\n\tif (!(error = git_tag_peel(&target, (git_tag *)obj))) {\n\t\tgit_oid_cpy(&head->oid, git_object_id(target));\n\n\t\tif ((error = git_vector_insert(&t->refs, head)) < 0) {\n\t\t\tfree_head(head);\n\t\t}\n\t}\n\n\tgit_object_free(obj);\n\tgit_object_free(target);\n\n\treturn error;\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "target"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_head",
          "args": [
            "head"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "free_heads",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
          "lines": "52-61",
          "snippet": "static void free_heads(git_vector *heads)\n{\n\tgit_remote_head *head;\n\tsize_t i;\n\n\tgit_vector_foreach(heads, i, head)\n\t\tfree_head(head);\n\n\tgit_vector_free(heads);\n}",
          "includes": [
            "#include \"remote.h\"",
            "#include \"push.h\"",
            "#include \"odb.h\"",
            "#include \"repository.h\"",
            "#include \"buffer.h\"",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"refs.h\"",
            "#include \"pack-objects.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/revwalk.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/net.h\"",
            "#include \"git2/types.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic void free_heads(git_vector *heads)\n{\n\tgit_remote_head *head;\n\tsize_t i;\n\n\tgit_vector_foreach(heads, i, head)\n\t\tfree_head(head);\n\n\tgit_vector_free(heads);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_insert",
          "args": [
            "&t->refs",
            "head"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "126-139",
          "snippet": "int git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_insert(git_vector *v, void *element)\n{\n\tassert(v);\n\n\tif (v->length >= v->_alloc_size &&\n\t\tresize_vector(v, compute_new_size(v)) < 0)\n\t\treturn -1;\n\n\tv->contents[v->length++] = element;\n\n\tgit_vector_set_sorted(v, v->length <= 1);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&head->oid",
            "git_object_id(target)"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_id",
          "args": [
            "target"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "209-213",
          "snippet": "const git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_tag_peel",
          "args": [
            "&target",
            "(git_tag *)obj"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "git_tag_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/tag.c",
          "lines": "514-517",
          "snippet": "int git_tag_peel(git_object **tag_target, const git_tag *tag)\n{\n\treturn git_object_peel(tag_target, (const git_object *)tag, GIT_OBJ_ANY);\n}",
          "includes": [
            "#include \"git2/odb_backend.h\"",
            "#include \"git2/signature.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/object.h\"",
            "#include \"message.h\"",
            "#include \"signature.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/odb_backend.h\"\n#include \"git2/signature.h\"\n#include \"git2/repository.h\"\n#include \"git2/object.h\"\n#include \"message.h\"\n#include \"signature.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"common.h\"\n\nint git_tag_peel(git_object **tag_target, const git_tag *tag)\n{\n\treturn git_object_peel(tag_target, (const git_object *)tag, GIT_OBJ_ANY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&buf"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_join",
          "args": [
            "&buf",
            "0",
            "name",
            "peeled"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "607-655",
          "snippet": "int git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "head"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_remote_head)"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_type",
          "args": [
            "obj"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_typeisloose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "249-255",
          "snippet": "int git_object_typeisloose(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn 0;\n\n\treturn (git_objects_table[type].size > 0) ? 1 : 0;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nstatic git_object_def git_objects_table[] = {\n\t/* 0 = GIT_OBJ__EXT1 */\n\t{ \"\", 0, NULL, NULL },\n\n\t/* 1 = GIT_OBJ_COMMIT */\n\t{ \"commit\", sizeof(git_commit), git_commit__parse, git_commit__free },\n\n\t/* 2 = GIT_OBJ_TREE */\n\t{ \"tree\", sizeof(git_tree), git_tree__parse, git_tree__free },\n\n\t/* 3 = GIT_OBJ_BLOB */\n\t{ \"blob\", sizeof(git_blob), git_blob__parse, git_blob__free },\n\n\t/* 4 = GIT_OBJ_TAG */\n\t{ \"tag\", sizeof(git_tag), git_tag__parse, git_tag__free },\n\n\t/* 5 = GIT_OBJ__EXT2 */\n\t{ \"\", 0, NULL, NULL },\n\t/* 6 = GIT_OBJ_OFS_DELTA */\n\t{ \"OFS_DELTA\", 0, NULL, NULL },\n\t/* 7 = GIT_OBJ_REF_DELTA */\n\t{ \"REF_DELTA\", 0, NULL, NULL },\n};\n\nint git_object_typeisloose(git_otype type)\n{\n\tif (type < 0 || ((size_t) type) >= ARRAY_SIZE(git_objects_table))\n\t\treturn 0;\n\n\treturn (git_objects_table[type].size > 0) ? 1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_lookup",
          "args": [
            "&obj",
            "t->repo",
            "&head->oid",
            "GIT_OBJ_ANY"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_lookup_bypath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "390-423",
          "snippet": "int git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__prefixcmp",
          "args": [
            "name",
            "GIT_REFS_TAGS_DIR"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "git__prefixcmp_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "252-255",
          "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "ref"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "head->symref_target"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "git_reference_symbolic_target(ref)"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_symbolic_target",
          "args": [
            "ref"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_symbolic_target",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "341-349",
          "snippet": "const char *git_reference_symbolic_target(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_SYMBOLIC)\n\t\treturn NULL;\n\n\treturn ref->target.symbolic;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst char *git_reference_symbolic_target(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_SYMBOLIC)\n\t\treturn NULL;\n\n\treturn ref->target.symbolic;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_type",
          "args": [
            "ref"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "303-307",
          "snippet": "git_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\ngit_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "head->name"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "head"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_reference_target",
          "args": [
            "resolved"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_target_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "331-339",
          "snippet": "const git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "GIT_HEAD_FILE"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_resolve",
          "args": [
            "&resolved",
            "ref"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_resolve",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "617-630",
          "snippet": "int git_reference_resolve(git_reference **ref_out, const git_reference *ref)\n{\n\tswitch (git_reference_type(ref)) {\n\tcase GIT_REF_OID:\n\t\treturn git_reference_lookup(ref_out, ref->db->repo, ref->name);\n\n\tcase GIT_REF_SYMBOLIC:\n\t\treturn git_reference_lookup_resolved(ref_out, ref->db->repo, ref->target.symbolic, -1);\n\n\tdefault:\n\t\tgiterr_set(GITERR_REFERENCE, \"Invalid reference\");\n\t\treturn -1;\n\t}\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_resolve(git_reference **ref_out, const git_reference *ref)\n{\n\tswitch (git_reference_type(ref)) {\n\tcase GIT_REF_OID:\n\t\treturn git_reference_lookup(ref_out, ref->db->repo, ref->name);\n\n\tcase GIT_REF_SYMBOLIC:\n\t\treturn git_reference_lookup_resolved(ref_out, ref->db->repo, ref->target.symbolic, -1);\n\n\tdefault:\n\t\tgiterr_set(GITERR_REFERENCE, \"Invalid reference\");\n\t\treturn -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup",
          "args": [
            "&ref",
            "t->repo",
            "name"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "146-150",
          "snippet": "int git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic int add_ref(transport_local *t, const char *name)\n{\n\tconst char peeled[] = \"^{}\";\n\tgit_reference *ref, *resolved;\n\tgit_remote_head *head;\n\tgit_oid obj_id;\n\tgit_object *obj = NULL, *target = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\n\tif ((error = git_reference_lookup(&ref, t->repo, name)) < 0)\n\t\treturn error;\n\n\terror = git_reference_resolve(&resolved, ref);\n\tif (error < 0) {\n\t\tgit_reference_free(ref);\n\t\tif (!strcmp(name, GIT_HEAD_FILE) && error == GIT_ENOTFOUND) {\n\t\t\t/* This is actually okay.  Empty repos often have a HEAD that\n\t\t\t * points to a nonexistent \"refs/heads/master\". */\n\t\t\tgiterr_clear();\n\t\t\treturn 0;\n\t\t}\n\t\treturn error;\n\t}\n\n\tgit_oid_cpy(&obj_id, git_reference_target(resolved));\n\tgit_reference_free(resolved);\n\n\thead = git__calloc(1, sizeof(git_remote_head));\n\tGITERR_CHECK_ALLOC(head);\n\n\thead->name = git__strdup(name);\n\tGITERR_CHECK_ALLOC(head->name);\n\n\tgit_oid_cpy(&head->oid, &obj_id);\n\n\tif (git_reference_type(ref) == GIT_REF_SYMBOLIC) {\n\t\thead->symref_target = git__strdup(git_reference_symbolic_target(ref));\n\t\tGITERR_CHECK_ALLOC(head->symref_target);\n\t}\n\tgit_reference_free(ref);\n\n\tif ((error = git_vector_insert(&t->refs, head)) < 0) {\n\t\tfree_head(head);\n\t\treturn error;\n\t}\n\n\t/* If it's not a tag, we don't need to try to peel it */\n\tif (git__prefixcmp(name, GIT_REFS_TAGS_DIR))\n\t\treturn 0;\n\n\tif ((error = git_object_lookup(&obj, t->repo, &head->oid, GIT_OBJ_ANY)) < 0)\n\t\treturn error;\n\n\thead = NULL;\n\n\t/* If it's not an annotated tag, or if we're mocking\n\t * git-receive-pack, just get out */\n\tif (git_object_type(obj) != GIT_OBJ_TAG ||\n\t\tt->direction != GIT_DIRECTION_FETCH) {\n\t\tgit_object_free(obj);\n\t\treturn 0;\n\t}\n\n\t/* And if it's a tag, peel it, and add it to the list */\n\thead = git__calloc(1, sizeof(git_remote_head));\n\tGITERR_CHECK_ALLOC(head);\n\n\tif (git_buf_join(&buf, 0, name, peeled) < 0) {\n\t\tfree_head(head);\n\t\treturn -1;\n\t}\n\thead->name = git_buf_detach(&buf);\n\n\tif (!(error = git_tag_peel(&target, (git_tag *)obj))) {\n\t\tgit_oid_cpy(&head->oid, git_object_id(target));\n\n\t\tif ((error = git_vector_insert(&t->refs, head)) < 0) {\n\t\t\tfree_head(head);\n\t\t}\n\t}\n\n\tgit_object_free(obj);\n\tgit_object_free(target);\n\n\treturn error;\n}"
  },
  {
    "function_name": "free_heads",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "52-61",
    "snippet": "static void free_heads(git_vector *heads)\n{\n\tgit_remote_head *head;\n\tsize_t i;\n\n\tgit_vector_foreach(heads, i, head)\n\t\tfree_head(head);\n\n\tgit_vector_free(heads);\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_free",
          "args": [
            "heads"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_free_deep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "83-95",
          "snippet": "void git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nvoid git_vector_free_deep(git_vector *v)\n{\n\tsize_t i;\n\n\tassert(v);\n\n\tfor (i = 0; i < v->length; ++i) {\n\t\tgit__free(v->contents[i]);\n\t\tv->contents[i] = NULL;\n\t}\n\n\tgit_vector_free(v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_head",
          "args": [
            "head"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "free_heads",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
          "lines": "52-61",
          "snippet": "static void free_heads(git_vector *heads)\n{\n\tgit_remote_head *head;\n\tsize_t i;\n\n\tgit_vector_foreach(heads, i, head)\n\t\tfree_head(head);\n\n\tgit_vector_free(heads);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "git_vector_foreach",
          "args": [
            "heads",
            "i",
            "head"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic void free_heads(git_vector *heads)\n{\n\tgit_remote_head *head;\n\tsize_t i;\n\n\tgit_vector_foreach(heads, i, head)\n\t\tfree_head(head);\n\n\tgit_vector_free(heads);\n}"
  },
  {
    "function_name": "free_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/local.c",
    "lines": "45-50",
    "snippet": "static void free_head(git_remote_head *head)\n{\n\tgit__free(head->name);\n\tgit__free(head->symref_target);\n\tgit__free(head);\n}",
    "includes": [
      "#include \"remote.h\"",
      "#include \"push.h\"",
      "#include \"odb.h\"",
      "#include \"repository.h\"",
      "#include \"buffer.h\"",
      "#include \"path.h\"",
      "#include \"posix.h\"",
      "#include \"refs.h\"",
      "#include \"pack-objects.h\"",
      "#include \"git2/revparse.h\"",
      "#include \"git2/commit.h\"",
      "#include \"git2/pack.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"git2/revwalk.h\"",
      "#include \"git2/transport.h\"",
      "#include \"git2/tag.h\"",
      "#include \"git2/object.h\"",
      "#include \"git2/repository.h\"",
      "#include \"git2/net.h\"",
      "#include \"git2/types.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "head"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"remote.h\"\n#include \"push.h\"\n#include \"odb.h\"\n#include \"repository.h\"\n#include \"buffer.h\"\n#include \"path.h\"\n#include \"posix.h\"\n#include \"refs.h\"\n#include \"pack-objects.h\"\n#include \"git2/revparse.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"git2/odb_backend.h\"\n#include \"git2/revwalk.h\"\n#include \"git2/transport.h\"\n#include \"git2/tag.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/net.h\"\n#include \"git2/types.h\"\n#include \"common.h\"\n\nstatic void free_head(git_remote_head *head)\n{\n\tgit__free(head->name);\n\tgit__free(head->symref_target);\n\tgit__free(head);\n}"
  }
]