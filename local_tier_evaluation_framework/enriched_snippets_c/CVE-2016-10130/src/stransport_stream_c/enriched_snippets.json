[
  {
    "function_name": "git_stransport_stream_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "237-290",
    "snippet": "int git_stransport_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tstransport_stream *st;\n\tint error;\n\tOSStatus ret;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(stransport_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n#ifdef GIT_CURL\n\terror = git_curl_stream_new(&st->io, host, port);\n#else\n\terror = git_socket_stream_new(&st->io, host, port);\n#endif\n\n\tif (error < 0){\n\t\tgit__free(st);\n\t\treturn error;\n\t}\n\n\tst->ctx = SSLCreateContext(NULL, kSSLClientSide, kSSLStreamType);\n\tif (!st->ctx) {\n\t\tgiterr_set(GITERR_NET, \"failed to create SSL context\");\n\t\tgit__free(st);\n\t\treturn -1;\n\t}\n\n\tif ((ret = SSLSetIOFuncs(st->ctx, read_cb, write_cb)) != noErr ||\n\t    (ret = SSLSetConnection(st->ctx, st->io)) != noErr ||\n\t    (ret = SSLSetSessionOption(st->ctx, kSSLSessionOptionBreakOnServerAuth, true)) != noErr ||\n\t    (ret = SSLSetProtocolVersionMin(st->ctx, kTLSProtocol1)) != noErr ||\n\t    (ret = SSLSetProtocolVersionMax(st->ctx, kTLSProtocol12)) != noErr ||\n\t    (ret = SSLSetPeerDomainName(st->ctx, host, strlen(host))) != noErr) {\n\t\tCFRelease(st->ctx);\n\t\tgit__free(st);\n\t\treturn stransport_error(ret);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.encrypted = 1;\n\tst->parent.proxy_support = git_stream_supports_proxy(st->io);\n\tst->parent.connect = stransport_connect;\n\tst->parent.certificate = stransport_certificate;\n\tst->parent.set_proxy = stransport_set_proxy;\n\tst->parent.read = stransport_read;\n\tst->parent.write = stransport_write;\n\tst->parent.close = stransport_close;\n\tst->parent.free = stransport_free;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_supports_proxy",
          "args": [
            "st->io"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_supports_proxy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "33-36",
          "snippet": "GIT_INLINE(int) git_stream_supports_proxy(git_stream *st)\n{\n\treturn st->proxy_support;\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_supports_proxy(git_stream *st)\n{\n\treturn st->proxy_support;\n}"
        }
      },
      {
        "call_info": {
          "callee": "stransport_error",
          "args": [
            "ret"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "stransport_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
          "lines": "19-40",
          "snippet": "static int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}",
          "includes": [
            "#include \"curl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"git2/transport.h\"",
            "#include <Security/SecCertificate.h>",
            "#include <Security/SecureTransport.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "st"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CFRelease",
          "args": [
            "st->ctx"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSLSetPeerDomainName",
          "args": [
            "st->ctx",
            "host",
            "strlen(host)"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "host"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSLSetProtocolVersionMax",
          "args": [
            "st->ctx",
            "kTLSProtocol12"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSLSetProtocolVersionMin",
          "args": [
            "st->ctx",
            "kTLSProtocol1"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSLSetSessionOption",
          "args": [
            "st->ctx",
            "kSSLSessionOptionBreakOnServerAuth",
            "true"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSLSetConnection",
          "args": [
            "st->ctx",
            "st->io"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSLSetIOFuncs",
          "args": [
            "st->ctx",
            "read_cb",
            "write_cb"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"failed to create SSL context\""
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSLCreateContext",
          "args": [
            "NULL",
            "kSSLClientSide",
            "kSSLStreamType"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_socket_stream_new",
          "args": [
            "&st->io",
            "host",
            "port"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "git_socket_stream_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/socket_stream.c",
          "lines": "185-212",
          "snippet": "int git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}",
          "includes": [
            "#\tinclude <ws2tcpip.h>",
            "#\tinclude <winsock2.h>",
            "#       include <arpa/inet.h>",
            "#\tinclude <netinet/in.h>",
            "#\tinclude <netdb.h>",
            "#\tinclude <sys/time.h>",
            "#\tinclude <sys/select.h>",
            "#\tinclude <sys/socket.h>",
            "#\tinclude <sys/types.h>",
            "#include \"socket_stream.h\"",
            "#include \"stream.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <ws2tcpip.h>\n#\tinclude <winsock2.h>\n#       include <arpa/inet.h>\n#\tinclude <netinet/in.h>\n#\tinclude <netdb.h>\n#\tinclude <sys/time.h>\n#\tinclude <sys/select.h>\n#\tinclude <sys/socket.h>\n#\tinclude <sys/types.h>\n#include \"socket_stream.h\"\n#include \"stream.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_socket_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tgit_socket_stream *st;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(git_socket_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n\tst->host = git__strdup(host);\n\tGITERR_CHECK_ALLOC(st->host);\n\n\tif (port) {\n\t\tst->port = git__strdup(port);\n\t\tGITERR_CHECK_ALLOC(st->port);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.connect = socket_connect;\n\tst->parent.write = socket_write;\n\tst->parent.read = socket_read;\n\tst->parent.close = socket_close;\n\tst->parent.free = socket_free;\n\tst->s = INVALID_SOCKET;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_curl_stream_new",
          "args": [
            "&st->io",
            "host",
            "port"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "git_curl_stream_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/curl_stream.c",
          "lines": "251-259",
          "snippet": "int git_curl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(host);\n\tGIT_UNUSED(port);\n\n\tgiterr_set(GITERR_NET, \"curl is not supported in this version\");\n\treturn -1;\n}",
          "includes": [
            "#include \"stream.h\"",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"stream.h\"",
            "#include <curl/curl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stream.h\"\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"stream.h\"\n#include <curl/curl.h>\n\nint git_curl_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tGIT_UNUSED(out);\n\tGIT_UNUSED(host);\n\tGIT_UNUSED(port);\n\n\tgiterr_set(GITERR_NET, \"curl is not supported in this version\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "st"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(stransport_stream)"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && host"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nint git_stransport_stream_new(git_stream **out, const char *host, const char *port)\n{\n\tstransport_stream *st;\n\tint error;\n\tOSStatus ret;\n\n\tassert(out && host);\n\n\tst = git__calloc(1, sizeof(stransport_stream));\n\tGITERR_CHECK_ALLOC(st);\n\n#ifdef GIT_CURL\n\terror = git_curl_stream_new(&st->io, host, port);\n#else\n\terror = git_socket_stream_new(&st->io, host, port);\n#endif\n\n\tif (error < 0){\n\t\tgit__free(st);\n\t\treturn error;\n\t}\n\n\tst->ctx = SSLCreateContext(NULL, kSSLClientSide, kSSLStreamType);\n\tif (!st->ctx) {\n\t\tgiterr_set(GITERR_NET, \"failed to create SSL context\");\n\t\tgit__free(st);\n\t\treturn -1;\n\t}\n\n\tif ((ret = SSLSetIOFuncs(st->ctx, read_cb, write_cb)) != noErr ||\n\t    (ret = SSLSetConnection(st->ctx, st->io)) != noErr ||\n\t    (ret = SSLSetSessionOption(st->ctx, kSSLSessionOptionBreakOnServerAuth, true)) != noErr ||\n\t    (ret = SSLSetProtocolVersionMin(st->ctx, kTLSProtocol1)) != noErr ||\n\t    (ret = SSLSetProtocolVersionMax(st->ctx, kTLSProtocol12)) != noErr ||\n\t    (ret = SSLSetPeerDomainName(st->ctx, host, strlen(host))) != noErr) {\n\t\tCFRelease(st->ctx);\n\t\tgit__free(st);\n\t\treturn stransport_error(ret);\n\t}\n\n\tst->parent.version = GIT_STREAM_VERSION;\n\tst->parent.encrypted = 1;\n\tst->parent.proxy_support = git_stream_supports_proxy(st->io);\n\tst->parent.connect = stransport_connect;\n\tst->parent.certificate = stransport_certificate;\n\tst->parent.set_proxy = stransport_set_proxy;\n\tst->parent.read = stransport_read;\n\tst->parent.write = stransport_write;\n\tst->parent.close = stransport_close;\n\tst->parent.free = stransport_free;\n\n\t*out = (git_stream *) st;\n\treturn 0;\n}"
  },
  {
    "function_name": "stransport_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "226-235",
    "snippet": "static void stransport_free(git_stream *stream)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\n\tgit_stream_free(st->io);\n\tCFRelease(st->ctx);\n\tif (st->der_data)\n\t\tCFRelease(st->der_data);\n\tgit__free(st);\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "st"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CFRelease",
          "args": [
            "st->der_data"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFRelease",
          "args": [
            "st->ctx"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_stream_free",
          "args": [
            "st->io"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "63-69",
          "snippet": "GIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) git_stream_free(git_stream *st)\n{\n\tif (!st)\n\t\treturn;\n\n\tst->free(st);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic void stransport_free(git_stream *stream)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\n\tgit_stream_free(st->io);\n\tCFRelease(st->ctx);\n\tif (st->der_data)\n\t\tCFRelease(st->der_data);\n\tgit__free(st);\n}"
  },
  {
    "function_name": "stransport_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "214-224",
    "snippet": "static int stransport_close(git_stream *stream)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tOSStatus ret;\n\n\tret = SSLClose(st->ctx);\n\tif (ret != noErr && ret != errSSLClosedGraceful)\n\t\treturn stransport_error(ret);\n\n\treturn git_stream_close(st->io);\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_close",
          "args": [
            "st->io"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "58-61",
          "snippet": "GIT_INLINE(int) git_stream_close(git_stream *st)\n{\n\treturn st->close(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_close(git_stream *st)\n{\n\treturn st->close(st);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stransport_error",
          "args": [
            "ret"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "stransport_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
          "lines": "19-40",
          "snippet": "static int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}",
          "includes": [
            "#include \"curl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"git2/transport.h\"",
            "#include <Security/SecCertificate.h>",
            "#include <Security/SecureTransport.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSLClose",
          "args": [
            "st->ctx"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_close(git_stream *stream)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tOSStatus ret;\n\n\tret = SSLClose(st->ctx);\n\tif (ret != noErr && ret != errSSLClosedGraceful)\n\t\treturn stransport_error(ret);\n\n\treturn git_stream_close(st->io);\n}"
  },
  {
    "function_name": "stransport_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "202-212",
    "snippet": "static ssize_t stransport_read(git_stream *stream, void *data, size_t len)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tsize_t processed;\n\tOSStatus ret;\n\n\tif ((ret = SSLRead(st->ctx, data, len, &processed)) != noErr)\n\t\treturn stransport_error(ret);\n\n\treturn processed;\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stransport_error",
          "args": [
            "ret"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "stransport_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
          "lines": "19-40",
          "snippet": "static int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}",
          "includes": [
            "#include \"curl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"git2/transport.h\"",
            "#include <Security/SecCertificate.h>",
            "#include <Security/SecureTransport.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSLRead",
          "args": [
            "st->ctx",
            "data",
            "len",
            "&processed"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic ssize_t stransport_read(git_stream *stream, void *data, size_t len)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tsize_t processed;\n\tOSStatus ret;\n\n\tif ((ret = SSLRead(st->ctx, data, len, &processed)) != noErr)\n\t\treturn stransport_error(ret);\n\n\treturn processed;\n}"
  },
  {
    "function_name": "read_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "177-200",
    "snippet": "static OSStatus read_cb(SSLConnectionRef conn, void *data, size_t *len)\n{\n\tgit_stream *io = (git_stream *) conn;\n\tOSStatus error = noErr;\n\tsize_t off = 0;\n\tssize_t ret;\n\n\tdo {\n\t\tret = git_stream_read(io, data + off, *len - off);\n\t\tif (ret < 0) {\n\t\t\terror = -36; /* \"ioErr\" from MacErrors.h which is not available on iOS */\n\t\t\tbreak;\n\t\t}\n\t\tif (ret == 0) {\n\t\t\terror = errSSLClosedGraceful;\n\t\t\tbreak;\n\t\t}\n\n\t\toff += ret;\n\t} while (off < *len);\n\n\t*len = off;\n\treturn error;\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_read",
          "args": [
            "io",
            "data + off",
            "*len - off"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "48-51",
          "snippet": "GIT_INLINE(ssize_t) git_stream_read(git_stream *st, void *data, size_t len)\n{\n\treturn st->read(st, data, len);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(ssize_t) git_stream_read(git_stream *st, void *data, size_t len)\n{\n\treturn st->read(st, data, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic OSStatus read_cb(SSLConnectionRef conn, void *data, size_t *len)\n{\n\tgit_stream *io = (git_stream *) conn;\n\tOSStatus error = noErr;\n\tsize_t off = 0;\n\tssize_t ret;\n\n\tdo {\n\t\tret = git_stream_read(io, data + off, *len - off);\n\t\tif (ret < 0) {\n\t\t\terror = -36; /* \"ioErr\" from MacErrors.h which is not available on iOS */\n\t\t\tbreak;\n\t\t}\n\t\tif (ret == 0) {\n\t\t\terror = errSSLClosedGraceful;\n\t\t\tbreak;\n\t\t}\n\n\t\toff += ret;\n\t} while (off < *len);\n\n\t*len = off;\n\treturn error;\n}"
  },
  {
    "function_name": "stransport_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "153-166",
    "snippet": "static ssize_t stransport_write(git_stream *stream, const char *data, size_t len, int flags)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tsize_t data_len, processed;\n\tOSStatus ret;\n\n\tGIT_UNUSED(flags);\n\n\tdata_len = len;\n\tif ((ret = SSLWrite(st->ctx, data, data_len, &processed)) != noErr)\n\t\treturn stransport_error(ret);\n\n\treturn processed;\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stransport_error",
          "args": [
            "ret"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "stransport_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
          "lines": "19-40",
          "snippet": "static int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}",
          "includes": [
            "#include \"curl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"git2/transport.h\"",
            "#include <Security/SecCertificate.h>",
            "#include <Security/SecureTransport.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSLWrite",
          "args": [
            "st->ctx",
            "data",
            "data_len",
            "&processed"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "flags"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic ssize_t stransport_write(git_stream *stream, const char *data, size_t len, int flags)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tsize_t data_len, processed;\n\tOSStatus ret;\n\n\tGIT_UNUSED(flags);\n\n\tdata_len = len;\n\tif ((ret = SSLWrite(st->ctx, data, data_len, &processed)) != noErr)\n\t\treturn stransport_error(ret);\n\n\treturn processed;\n}"
  },
  {
    "function_name": "write_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "142-151",
    "snippet": "static OSStatus write_cb(SSLConnectionRef conn, const void *data, size_t *len)\n{\n\tgit_stream *io = (git_stream *) conn;\n\n\tif (git_stream_write(io, data, *len, 0) < 0) {\n\t\treturn -36; /* \"ioErr\" from MacErrors.h which is not available on iOS */\n\t}\n\n\treturn noErr;\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_write",
          "args": [
            "io",
            "data",
            "*len",
            "0"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "53-56",
          "snippet": "GIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(ssize_t) git_stream_write(git_stream *st, const char *data, size_t len, int flags)\n{\n\treturn st->write(st, data, len, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic OSStatus write_cb(SSLConnectionRef conn, const void *data, size_t *len)\n{\n\tgit_stream *io = (git_stream *) conn;\n\n\tif (git_stream_write(io, data, *len, 0) < 0) {\n\t\treturn -36; /* \"ioErr\" from MacErrors.h which is not available on iOS */\n\t}\n\n\treturn noErr;\n}"
  },
  {
    "function_name": "stransport_set_proxy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "123-128",
    "snippet": "static int stransport_set_proxy(git_stream *stream, const char *proxy)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\n\treturn git_stream_set_proxy(st->io, proxy);\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_stream_set_proxy",
          "args": [
            "st->io",
            "proxy"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_set_proxy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "38-46",
          "snippet": "GIT_INLINE(int) git_stream_set_proxy(git_stream *st, const char *proxy_url)\n{\n\tif (!st->proxy_support) {\n\t\tgiterr_set(GITERR_INVALID, \"proxy not supported on this stream\");\n\t\treturn -1;\n\t}\n\n\treturn st->set_proxy(st, proxy_url);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_set_proxy(git_stream *st, const char *proxy_url)\n{\n\tif (!st->proxy_support) {\n\t\tgiterr_set(GITERR_INVALID, \"proxy not supported on this stream\");\n\t\treturn -1;\n\t}\n\n\treturn st->set_proxy(st, proxy_url);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_set_proxy(git_stream *stream, const char *proxy)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\n\treturn git_stream_set_proxy(st->io, proxy);\n}"
  },
  {
    "function_name": "stransport_certificate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "96-121",
    "snippet": "static int stransport_certificate(git_cert **out, git_stream *stream)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tSecTrustRef trust = NULL;\n\tSecCertificateRef sec_cert;\n\tOSStatus ret;\n\n\tif ((ret = SSLCopyPeerTrust(st->ctx, &trust)) != noErr)\n\t\treturn stransport_error(ret);\n\n\tsec_cert = SecTrustGetCertificateAtIndex(trust, 0);\n\tst->der_data = SecCertificateCopyData(sec_cert);\n\tCFRelease(trust);\n\n\tif (st->der_data == NULL) {\n\t\tgiterr_set(GITERR_SSL, \"retrieved invalid certificate data\");\n\t\treturn -1;\n\t}\n\n\tst->cert_info.parent.cert_type = GIT_CERT_X509;\n\tst->cert_info.data = (void *) CFDataGetBytePtr(st->der_data);\n\tst->cert_info.len = CFDataGetLength(st->der_data);\n\n\t*out = (git_cert *)&st->cert_info;\n\treturn 0;\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CFDataGetLength",
          "args": [
            "st->der_data"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFDataGetBytePtr",
          "args": [
            "st->der_data"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_SSL",
            "\"retrieved invalid certificate data\""
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CFRelease",
          "args": [
            "trust"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SecCertificateCopyData",
          "args": [
            "sec_cert"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SecTrustGetCertificateAtIndex",
          "args": [
            "trust",
            "0"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stransport_error",
          "args": [
            "ret"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "stransport_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
          "lines": "19-40",
          "snippet": "static int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}",
          "includes": [
            "#include \"curl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"git2/transport.h\"",
            "#include <Security/SecCertificate.h>",
            "#include <Security/SecureTransport.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSLCopyPeerTrust",
          "args": [
            "st->ctx",
            "&trust"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_certificate(git_cert **out, git_stream *stream)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tSecTrustRef trust = NULL;\n\tSecCertificateRef sec_cert;\n\tOSStatus ret;\n\n\tif ((ret = SSLCopyPeerTrust(st->ctx, &trust)) != noErr)\n\t\treturn stransport_error(ret);\n\n\tsec_cert = SecTrustGetCertificateAtIndex(trust, 0);\n\tst->der_data = SecCertificateCopyData(sec_cert);\n\tCFRelease(trust);\n\n\tif (st->der_data == NULL) {\n\t\tgiterr_set(GITERR_SSL, \"retrieved invalid certificate data\");\n\t\treturn -1;\n\t}\n\n\tst->cert_info.parent.cert_type = GIT_CERT_X509;\n\tst->cert_info.data = (void *) CFDataGetBytePtr(st->der_data);\n\tst->cert_info.len = CFDataGetLength(st->der_data);\n\n\t*out = (git_cert *)&st->cert_info;\n\treturn 0;\n}"
  },
  {
    "function_name": "stransport_connect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "50-94",
    "snippet": "static int stransport_connect(git_stream *stream)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tint error;\n\tSecTrustRef trust = NULL;\n\tSecTrustResultType sec_res;\n\tOSStatus ret;\n\n\tif ((error = git_stream_connect(st->io)) < 0)\n\t\treturn error;\n\n\tret = SSLHandshake(st->ctx);\n\tif (ret != errSSLServerAuthCompleted) {\n\t\tgiterr_set(GITERR_SSL, \"unexpected return value from ssl handshake %d\", ret);\n\t\treturn -1;\n\t}\n\n\tif ((ret = SSLCopyPeerTrust(st->ctx, &trust)) != noErr)\n\t\tgoto on_error;\n\n\tif (!trust)\n\t\treturn GIT_ECERTIFICATE;\n\n\tif ((ret = SecTrustEvaluate(trust, &sec_res)) != noErr)\n\t\tgoto on_error;\n\n\tCFRelease(trust);\n\n\tif (sec_res == kSecTrustResultInvalid || sec_res == kSecTrustResultOtherError) {\n\t\tgiterr_set(GITERR_SSL, \"internal security trust error\");\n\t\treturn -1;\n\t}\n\n\tif (sec_res == kSecTrustResultDeny || sec_res == kSecTrustResultRecoverableTrustFailure ||\n\t    sec_res == kSecTrustResultFatalTrustFailure)\n\t\treturn GIT_ECERTIFICATE;\n\n\treturn 0;\n\non_error:\n\tif (trust)\n\t\tCFRelease(trust);\n\n\treturn stransport_error(ret);\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stransport_error",
          "args": [
            "ret"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "stransport_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
          "lines": "19-40",
          "snippet": "static int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}",
          "includes": [
            "#include \"curl_stream.h\"",
            "#include \"socket_stream.h\"",
            "#include \"git2/transport.h\"",
            "#include <Security/SecCertificate.h>",
            "#include <Security/SecureTransport.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CFRelease",
          "args": [
            "trust"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_SSL",
            "\"internal security trust error\""
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CFRelease",
          "args": [
            "trust"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SecTrustEvaluate",
          "args": [
            "trust",
            "&sec_res"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSLCopyPeerTrust",
          "args": [
            "st->ctx",
            "&trust"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_SSL",
            "\"unexpected return value from ssl handshake %d\"",
            "ret"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSLHandshake",
          "args": [
            "st->ctx"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_stream_connect",
          "args": [
            "st->io"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "git_stream_connect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stream.h",
          "lines": "13-16",
          "snippet": "GIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}",
          "includes": [
            "#include \"git2/sys/stream.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/stream.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_stream_connect(git_stream *st)\n{\n\treturn st->connect(st);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_connect(git_stream *stream)\n{\n\tstransport_stream *st = (stransport_stream *) stream;\n\tint error;\n\tSecTrustRef trust = NULL;\n\tSecTrustResultType sec_res;\n\tOSStatus ret;\n\n\tif ((error = git_stream_connect(st->io)) < 0)\n\t\treturn error;\n\n\tret = SSLHandshake(st->ctx);\n\tif (ret != errSSLServerAuthCompleted) {\n\t\tgiterr_set(GITERR_SSL, \"unexpected return value from ssl handshake %d\", ret);\n\t\treturn -1;\n\t}\n\n\tif ((ret = SSLCopyPeerTrust(st->ctx, &trust)) != noErr)\n\t\tgoto on_error;\n\n\tif (!trust)\n\t\treturn GIT_ECERTIFICATE;\n\n\tif ((ret = SecTrustEvaluate(trust, &sec_res)) != noErr)\n\t\tgoto on_error;\n\n\tCFRelease(trust);\n\n\tif (sec_res == kSecTrustResultInvalid || sec_res == kSecTrustResultOtherError) {\n\t\tgiterr_set(GITERR_SSL, \"internal security trust error\");\n\t\treturn -1;\n\t}\n\n\tif (sec_res == kSecTrustResultDeny || sec_res == kSecTrustResultRecoverableTrustFailure ||\n\t    sec_res == kSecTrustResultFatalTrustFailure)\n\t\treturn GIT_ECERTIFICATE;\n\n\treturn 0;\n\non_error:\n\tif (trust)\n\t\tCFRelease(trust);\n\n\treturn stransport_error(ret);\n}"
  },
  {
    "function_name": "stransport_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/stransport_stream.c",
    "lines": "19-40",
    "snippet": "static int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}",
    "includes": [
      "#include \"curl_stream.h\"",
      "#include \"socket_stream.h\"",
      "#include \"git2/transport.h\"",
      "#include <Security/SecCertificate.h>",
      "#include <Security/SecureTransport.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "message"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_NET",
            "\"SecureTransport error: OSStatus %d\"",
            "(unsigned int)ret"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CFRelease",
          "args": [
            "message"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFStringGetCStringPtr",
          "args": [
            "message",
            "kCFStringEncodingUTF8"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "message"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SecCopyErrorMessageString",
          "args": [
            "ret",
            "NULL"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"curl_stream.h\"\n#include \"socket_stream.h\"\n#include \"git2/transport.h\"\n#include <Security/SecCertificate.h>\n#include <Security/SecureTransport.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nstatic int stransport_error(OSStatus ret)\n{\n\tCFStringRef message;\n\n\tif (ret == noErr || ret == errSSLClosedGraceful) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n#if !TARGET_OS_IPHONE\n\tmessage = SecCopyErrorMessageString(ret, NULL);\n\tGITERR_CHECK_ALLOC(message);\n\n\tgiterr_set(GITERR_NET, \"SecureTransport error: %s\", CFStringGetCStringPtr(message, kCFStringEncodingUTF8));\n\tCFRelease(message);\n#else\n    giterr_set(GITERR_NET, \"SecureTransport error: OSStatus %d\", (unsigned int)ret);\n    GIT_UNUSED(message);\n#endif\n\n\treturn -1;\n}"
  }
]