[
  {
    "function_name": "git_ident_filter_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
    "lines": "115-127",
    "snippet": "git_filter *git_ident_filter_new(void)\n{\n\tgit_filter *f = git__calloc(1, sizeof(git_filter));\n\tif (f == NULL)\n\t\treturn NULL;\n\n\tf->version = GIT_FILTER_VERSION;\n\tf->attributes = \"+ident\"; /* apply to files with ident attribute set */\n\tf->shutdown = git_filter_free;\n\tf->apply    = ident_apply;\n\n\treturn f;\n}",
    "includes": [
      "#include \"buf_text.h\"",
      "#include \"buffer.h\"",
      "#include \"filter.h\"",
      "#include \"git2/sys/filter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_filter)"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\ngit_filter *git_ident_filter_new(void)\n{\n\tgit_filter *f = git__calloc(1, sizeof(git_filter));\n\tif (f == NULL)\n\t\treturn NULL;\n\n\tf->version = GIT_FILTER_VERSION;\n\tf->attributes = \"+ident\"; /* apply to files with ident attribute set */\n\tf->shutdown = git_filter_free;\n\tf->apply    = ident_apply;\n\n\treturn f;\n}"
  },
  {
    "function_name": "ident_apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
    "lines": "96-113",
    "snippet": "static int ident_apply(\n\tgit_filter     *self,\n\tvoid          **payload,\n\tgit_buf        *to,\n\tconst git_buf  *from,\n\tconst git_filter_source *src)\n{\n\tGIT_UNUSED(self); GIT_UNUSED(payload);\n\n\t/* Don't filter binary files */\n\tif (git_buf_text_is_binary(from))\n\t\treturn GIT_PASSTHROUGH;\n\n\tif (git_filter_source_mode(src) == GIT_FILTER_SMUDGE)\n\t\treturn ident_insert_id(to, from, src);\n\telse\n\t\treturn ident_remove_id(to, from);\n}",
    "includes": [
      "#include \"buf_text.h\"",
      "#include \"buffer.h\"",
      "#include \"filter.h\"",
      "#include \"git2/sys/filter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ident_remove_id",
          "args": [
            "to",
            "from"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "ident_remove_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
          "lines": "74-94",
          "snippet": "static int ident_remove_id(\n\tgit_buf *to, const git_buf *from)\n{\n\tconst char *id_start, *id_end, *from_end = from->ptr + from->size;\n\tsize_t need_size;\n\n\tif (ident_find_id(&id_start, &id_end, from->ptr, from->size) < 0)\n\t\treturn GIT_PASSTHROUGH;\n\n\tneed_size = (size_t)(id_start - from->ptr) +\n\t\t4 /* \"$Id$\" */ + (size_t)(from_end - id_end);\n\n\tif (git_buf_grow(to, need_size) < 0)\n\t\treturn -1;\n\n\tgit_buf_set(to, from->ptr, (size_t)(id_start - from->ptr));\n\tgit_buf_put(to, \"$Id$\", 4);\n\tgit_buf_put(to, id_end, (size_t)(from_end - id_end));\n\n\treturn git_buf_oom(to) ? -1 : 0;\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"filter.h\"",
            "#include \"git2/sys/filter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\nstatic int ident_remove_id(\n\tgit_buf *to, const git_buf *from)\n{\n\tconst char *id_start, *id_end, *from_end = from->ptr + from->size;\n\tsize_t need_size;\n\n\tif (ident_find_id(&id_start, &id_end, from->ptr, from->size) < 0)\n\t\treturn GIT_PASSTHROUGH;\n\n\tneed_size = (size_t)(id_start - from->ptr) +\n\t\t4 /* \"$Id$\" */ + (size_t)(from_end - id_end);\n\n\tif (git_buf_grow(to, need_size) < 0)\n\t\treturn -1;\n\n\tgit_buf_set(to, from->ptr, (size_t)(id_start - from->ptr));\n\tgit_buf_put(to, \"$Id$\", 4);\n\tgit_buf_put(to, id_end, (size_t)(from_end - id_end));\n\n\treturn git_buf_oom(to) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ident_insert_id",
          "args": [
            "to",
            "from",
            "src"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "ident_insert_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
          "lines": "41-72",
          "snippet": "static int ident_insert_id(\n\tgit_buf *to, const git_buf *from, const git_filter_source *src)\n{\n\tchar oid[GIT_OID_HEXSZ+1];\n\tconst char *id_start, *id_end, *from_end = from->ptr + from->size;\n\tsize_t need_size;\n\n\t/* replace $Id$ with blob id */\n\n\tif (!git_filter_source_id(src))\n\t\treturn GIT_PASSTHROUGH;\n\n\tgit_oid_tostr(oid, sizeof(oid), git_filter_source_id(src));\n\n\tif (ident_find_id(&id_start, &id_end, from->ptr, from->size) < 0)\n\t\treturn GIT_PASSTHROUGH;\n\n\tneed_size = (size_t)(id_start - from->ptr) +\n\t\t5 /* \"$Id: \" */ + GIT_OID_HEXSZ + 2 /* \" $\" */ +\n\t\t(size_t)(from_end - id_end);\n\n\tif (git_buf_grow(to, need_size) < 0)\n\t\treturn -1;\n\n\tgit_buf_set(to, from->ptr, (size_t)(id_start - from->ptr));\n\tgit_buf_put(to, \"$Id: \", 5);\n\tgit_buf_put(to, oid, GIT_OID_HEXSZ);\n\tgit_buf_put(to, \" $\", 2);\n\tgit_buf_put(to, id_end, (size_t)(from_end - id_end));\n\n\treturn git_buf_oom(to) ? -1 : 0;\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"filter.h\"",
            "#include \"git2/sys/filter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\nstatic int ident_insert_id(\n\tgit_buf *to, const git_buf *from, const git_filter_source *src)\n{\n\tchar oid[GIT_OID_HEXSZ+1];\n\tconst char *id_start, *id_end, *from_end = from->ptr + from->size;\n\tsize_t need_size;\n\n\t/* replace $Id$ with blob id */\n\n\tif (!git_filter_source_id(src))\n\t\treturn GIT_PASSTHROUGH;\n\n\tgit_oid_tostr(oid, sizeof(oid), git_filter_source_id(src));\n\n\tif (ident_find_id(&id_start, &id_end, from->ptr, from->size) < 0)\n\t\treturn GIT_PASSTHROUGH;\n\n\tneed_size = (size_t)(id_start - from->ptr) +\n\t\t5 /* \"$Id: \" */ + GIT_OID_HEXSZ + 2 /* \" $\" */ +\n\t\t(size_t)(from_end - id_end);\n\n\tif (git_buf_grow(to, need_size) < 0)\n\t\treturn -1;\n\n\tgit_buf_set(to, from->ptr, (size_t)(id_start - from->ptr));\n\tgit_buf_put(to, \"$Id: \", 5);\n\tgit_buf_put(to, oid, GIT_OID_HEXSZ);\n\tgit_buf_put(to, \" $\", 2);\n\tgit_buf_put(to, id_end, (size_t)(from_end - id_end));\n\n\treturn git_buf_oom(to) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filter_source_mode",
          "args": [
            "src"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_source_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "390-393",
          "snippet": "git_filter_mode_t git_filter_source_mode(const git_filter_source *src)\n{\n\treturn src->mode;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\ngit_filter_mode_t git_filter_source_mode(const git_filter_source *src)\n{\n\treturn src->mode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_text_is_binary",
          "args": [
            "from"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_text_is_binary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buf_text.c",
          "lines": "185-211",
          "snippet": "bool git_buf_text_is_binary(const git_buf *buf)\n{\n\tconst char *scan = buf->ptr, *end = buf->ptr + buf->size;\n\tgit_bom_t bom;\n\tint printable = 0, nonprintable = 0;\n\n\tscan += git_buf_text_detect_bom(&bom, buf, 0);\n\n\tif (bom > GIT_BOM_UTF8)\n\t\treturn 1;\n\n\twhile (scan < end) {\n\t\tunsigned char c = *scan++;\n\n\t\t/* Printable characters are those above SPACE (0x1F) excluding DEL,\n\t\t * and including BS, ESC and FF.\n\t\t */\n\t\tif ((c > 0x1F && c != 127) || c == '\\b' || c == '\\033' || c == '\\014')\n\t\t\tprintable++;\n\t\telse if (c == '\\0')\n\t\t\treturn true;\n\t\telse if (!git__isspace(c))\n\t\t\tnonprintable++;\n\t}\n\n\treturn ((printable >> 7) < nonprintable);\n}",
          "includes": [
            "#include \"buf_text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n\nbool git_buf_text_is_binary(const git_buf *buf)\n{\n\tconst char *scan = buf->ptr, *end = buf->ptr + buf->size;\n\tgit_bom_t bom;\n\tint printable = 0, nonprintable = 0;\n\n\tscan += git_buf_text_detect_bom(&bom, buf, 0);\n\n\tif (bom > GIT_BOM_UTF8)\n\t\treturn 1;\n\n\twhile (scan < end) {\n\t\tunsigned char c = *scan++;\n\n\t\t/* Printable characters are those above SPACE (0x1F) excluding DEL,\n\t\t * and including BS, ESC and FF.\n\t\t */\n\t\tif ((c > 0x1F && c != 127) || c == '\\b' || c == '\\033' || c == '\\014')\n\t\t\tprintable++;\n\t\telse if (c == '\\0')\n\t\t\treturn true;\n\t\telse if (!git__isspace(c))\n\t\t\tnonprintable++;\n\t}\n\n\treturn ((printable >> 7) < nonprintable);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "payload"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "self"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\nstatic int ident_apply(\n\tgit_filter     *self,\n\tvoid          **payload,\n\tgit_buf        *to,\n\tconst git_buf  *from,\n\tconst git_filter_source *src)\n{\n\tGIT_UNUSED(self); GIT_UNUSED(payload);\n\n\t/* Don't filter binary files */\n\tif (git_buf_text_is_binary(from))\n\t\treturn GIT_PASSTHROUGH;\n\n\tif (git_filter_source_mode(src) == GIT_FILTER_SMUDGE)\n\t\treturn ident_insert_id(to, from, src);\n\telse\n\t\treturn ident_remove_id(to, from);\n}"
  },
  {
    "function_name": "ident_remove_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
    "lines": "74-94",
    "snippet": "static int ident_remove_id(\n\tgit_buf *to, const git_buf *from)\n{\n\tconst char *id_start, *id_end, *from_end = from->ptr + from->size;\n\tsize_t need_size;\n\n\tif (ident_find_id(&id_start, &id_end, from->ptr, from->size) < 0)\n\t\treturn GIT_PASSTHROUGH;\n\n\tneed_size = (size_t)(id_start - from->ptr) +\n\t\t4 /* \"$Id$\" */ + (size_t)(from_end - id_end);\n\n\tif (git_buf_grow(to, need_size) < 0)\n\t\treturn -1;\n\n\tgit_buf_set(to, from->ptr, (size_t)(id_start - from->ptr));\n\tgit_buf_put(to, \"$Id$\", 4);\n\tgit_buf_put(to, id_end, (size_t)(from_end - id_end));\n\n\treturn git_buf_oom(to) ? -1 : 0;\n}",
    "includes": [
      "#include \"buf_text.h\"",
      "#include \"buffer.h\"",
      "#include \"filter.h\"",
      "#include \"git2/sys/filter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "to"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "to",
            "id_end",
            "(size_t)(from_end - id_end)"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_set",
          "args": [
            "to",
            "from->ptr",
            "(size_t)(id_start - from->ptr)"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "150-169",
          "snippet": "int git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_grow",
          "args": [
            "to",
            "need_size"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_grow_by",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "106-116",
          "snippet": "int git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nint git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ident_find_id",
          "args": [
            "&id_start",
            "&id_end",
            "from->ptr",
            "from->size"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "ident_find_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
          "lines": "13-39",
          "snippet": "static int ident_find_id(\n\tconst char **id_start, const char **id_end, const char *start, size_t len)\n{\n\tconst char *end = start + len, *found = NULL;\n\n\twhile (len > 3 && (found = memchr(start, '$', len)) != NULL) {\n\t\tsize_t remaining = (size_t)(end - found) - 1;\n\t\tif (remaining < 3)\n\t\t\treturn GIT_ENOTFOUND;\n\n\t\tstart = found + 1;\n\t\tlen   = remaining;\n\n\t\tif (start[0] == 'I' && start[1] == 'd')\n\t\t\tbreak;\n\t}\n\n\tif (len < 3 || !found)\n\t\treturn GIT_ENOTFOUND;\n\t*id_start = found;\n\n\tif ((found = memchr(start + 2, '$', len - 2)) == NULL)\n\t\treturn GIT_ENOTFOUND;\n\n\t*id_end = found + 1;\n\treturn 0;\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"filter.h\"",
            "#include \"git2/sys/filter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\nstatic int ident_find_id(\n\tconst char **id_start, const char **id_end, const char *start, size_t len)\n{\n\tconst char *end = start + len, *found = NULL;\n\n\twhile (len > 3 && (found = memchr(start, '$', len)) != NULL) {\n\t\tsize_t remaining = (size_t)(end - found) - 1;\n\t\tif (remaining < 3)\n\t\t\treturn GIT_ENOTFOUND;\n\n\t\tstart = found + 1;\n\t\tlen   = remaining;\n\n\t\tif (start[0] == 'I' && start[1] == 'd')\n\t\t\tbreak;\n\t}\n\n\tif (len < 3 || !found)\n\t\treturn GIT_ENOTFOUND;\n\t*id_start = found;\n\n\tif ((found = memchr(start + 2, '$', len - 2)) == NULL)\n\t\treturn GIT_ENOTFOUND;\n\n\t*id_end = found + 1;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\nstatic int ident_remove_id(\n\tgit_buf *to, const git_buf *from)\n{\n\tconst char *id_start, *id_end, *from_end = from->ptr + from->size;\n\tsize_t need_size;\n\n\tif (ident_find_id(&id_start, &id_end, from->ptr, from->size) < 0)\n\t\treturn GIT_PASSTHROUGH;\n\n\tneed_size = (size_t)(id_start - from->ptr) +\n\t\t4 /* \"$Id$\" */ + (size_t)(from_end - id_end);\n\n\tif (git_buf_grow(to, need_size) < 0)\n\t\treturn -1;\n\n\tgit_buf_set(to, from->ptr, (size_t)(id_start - from->ptr));\n\tgit_buf_put(to, \"$Id$\", 4);\n\tgit_buf_put(to, id_end, (size_t)(from_end - id_end));\n\n\treturn git_buf_oom(to) ? -1 : 0;\n}"
  },
  {
    "function_name": "ident_insert_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
    "lines": "41-72",
    "snippet": "static int ident_insert_id(\n\tgit_buf *to, const git_buf *from, const git_filter_source *src)\n{\n\tchar oid[GIT_OID_HEXSZ+1];\n\tconst char *id_start, *id_end, *from_end = from->ptr + from->size;\n\tsize_t need_size;\n\n\t/* replace $Id$ with blob id */\n\n\tif (!git_filter_source_id(src))\n\t\treturn GIT_PASSTHROUGH;\n\n\tgit_oid_tostr(oid, sizeof(oid), git_filter_source_id(src));\n\n\tif (ident_find_id(&id_start, &id_end, from->ptr, from->size) < 0)\n\t\treturn GIT_PASSTHROUGH;\n\n\tneed_size = (size_t)(id_start - from->ptr) +\n\t\t5 /* \"$Id: \" */ + GIT_OID_HEXSZ + 2 /* \" $\" */ +\n\t\t(size_t)(from_end - id_end);\n\n\tif (git_buf_grow(to, need_size) < 0)\n\t\treturn -1;\n\n\tgit_buf_set(to, from->ptr, (size_t)(id_start - from->ptr));\n\tgit_buf_put(to, \"$Id: \", 5);\n\tgit_buf_put(to, oid, GIT_OID_HEXSZ);\n\tgit_buf_put(to, \" $\", 2);\n\tgit_buf_put(to, id_end, (size_t)(from_end - id_end));\n\n\treturn git_buf_oom(to) ? -1 : 0;\n}",
    "includes": [
      "#include \"buf_text.h\"",
      "#include \"buffer.h\"",
      "#include \"filter.h\"",
      "#include \"git2/sys/filter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "to"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "to",
            "id_end",
            "(size_t)(from_end - id_end)"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_set",
          "args": [
            "to",
            "from->ptr",
            "(size_t)(id_start - from->ptr)"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "150-169",
          "snippet": "int git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_grow",
          "args": [
            "to",
            "need_size"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_grow_by",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "106-116",
          "snippet": "int git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nint git_buf_grow_by(git_buf *buffer, size_t additional_size)\n{\n\tsize_t newsize;\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&newsize, buffer->size, additional_size)) {\n\t\tbuffer->ptr = git_buf__oom;\n\t\treturn -1;\n\t}\n\n\treturn git_buf_try_grow(buffer, newsize, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ident_find_id",
          "args": [
            "&id_start",
            "&id_end",
            "from->ptr",
            "from->size"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "ident_find_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
          "lines": "13-39",
          "snippet": "static int ident_find_id(\n\tconst char **id_start, const char **id_end, const char *start, size_t len)\n{\n\tconst char *end = start + len, *found = NULL;\n\n\twhile (len > 3 && (found = memchr(start, '$', len)) != NULL) {\n\t\tsize_t remaining = (size_t)(end - found) - 1;\n\t\tif (remaining < 3)\n\t\t\treturn GIT_ENOTFOUND;\n\n\t\tstart = found + 1;\n\t\tlen   = remaining;\n\n\t\tif (start[0] == 'I' && start[1] == 'd')\n\t\t\tbreak;\n\t}\n\n\tif (len < 3 || !found)\n\t\treturn GIT_ENOTFOUND;\n\t*id_start = found;\n\n\tif ((found = memchr(start + 2, '$', len - 2)) == NULL)\n\t\treturn GIT_ENOTFOUND;\n\n\t*id_end = found + 1;\n\treturn 0;\n}",
          "includes": [
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"filter.h\"",
            "#include \"git2/sys/filter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\nstatic int ident_find_id(\n\tconst char **id_start, const char **id_end, const char *start, size_t len)\n{\n\tconst char *end = start + len, *found = NULL;\n\n\twhile (len > 3 && (found = memchr(start, '$', len)) != NULL) {\n\t\tsize_t remaining = (size_t)(end - found) - 1;\n\t\tif (remaining < 3)\n\t\t\treturn GIT_ENOTFOUND;\n\n\t\tstart = found + 1;\n\t\tlen   = remaining;\n\n\t\tif (start[0] == 'I' && start[1] == 'd')\n\t\t\tbreak;\n\t}\n\n\tif (len < 3 || !found)\n\t\treturn GIT_ENOTFOUND;\n\t*id_start = found;\n\n\tif ((found = memchr(start + 2, '$', len - 2)) == NULL)\n\t\treturn GIT_ENOTFOUND;\n\n\t*id_end = found + 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_tostr",
          "args": [
            "oid",
            "sizeof(oid)",
            "git_filter_source_id(src)"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_tostr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "119-131",
          "snippet": "char *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr(char *out, size_t n, const git_oid *oid)\n{\n\tif (!out || n == 0)\n\t\treturn \"\";\n\n\tif (n > GIT_OID_HEXSZ + 1)\n\t\tn = GIT_OID_HEXSZ + 1;\n\n\tgit_oid_nfmt(out, n - 1, oid); /* allow room for terminating NUL */\n\tout[n - 1] = '\\0';\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filter_source_id",
          "args": [
            "src"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_source_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "385-388",
          "snippet": "const git_oid *git_filter_source_id(const git_filter_source *src)\n{\n\treturn git_oid_iszero(&src->oid) ? NULL : &src->oid;\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nconst git_oid *git_filter_source_id(const git_filter_source *src)\n{\n\treturn git_oid_iszero(&src->oid) ? NULL : &src->oid;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\nstatic int ident_insert_id(\n\tgit_buf *to, const git_buf *from, const git_filter_source *src)\n{\n\tchar oid[GIT_OID_HEXSZ+1];\n\tconst char *id_start, *id_end, *from_end = from->ptr + from->size;\n\tsize_t need_size;\n\n\t/* replace $Id$ with blob id */\n\n\tif (!git_filter_source_id(src))\n\t\treturn GIT_PASSTHROUGH;\n\n\tgit_oid_tostr(oid, sizeof(oid), git_filter_source_id(src));\n\n\tif (ident_find_id(&id_start, &id_end, from->ptr, from->size) < 0)\n\t\treturn GIT_PASSTHROUGH;\n\n\tneed_size = (size_t)(id_start - from->ptr) +\n\t\t5 /* \"$Id: \" */ + GIT_OID_HEXSZ + 2 /* \" $\" */ +\n\t\t(size_t)(from_end - id_end);\n\n\tif (git_buf_grow(to, need_size) < 0)\n\t\treturn -1;\n\n\tgit_buf_set(to, from->ptr, (size_t)(id_start - from->ptr));\n\tgit_buf_put(to, \"$Id: \", 5);\n\tgit_buf_put(to, oid, GIT_OID_HEXSZ);\n\tgit_buf_put(to, \" $\", 2);\n\tgit_buf_put(to, id_end, (size_t)(from_end - id_end));\n\n\treturn git_buf_oom(to) ? -1 : 0;\n}"
  },
  {
    "function_name": "ident_find_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/ident.c",
    "lines": "13-39",
    "snippet": "static int ident_find_id(\n\tconst char **id_start, const char **id_end, const char *start, size_t len)\n{\n\tconst char *end = start + len, *found = NULL;\n\n\twhile (len > 3 && (found = memchr(start, '$', len)) != NULL) {\n\t\tsize_t remaining = (size_t)(end - found) - 1;\n\t\tif (remaining < 3)\n\t\t\treturn GIT_ENOTFOUND;\n\n\t\tstart = found + 1;\n\t\tlen   = remaining;\n\n\t\tif (start[0] == 'I' && start[1] == 'd')\n\t\t\tbreak;\n\t}\n\n\tif (len < 3 || !found)\n\t\treturn GIT_ENOTFOUND;\n\t*id_start = found;\n\n\tif ((found = memchr(start + 2, '$', len - 2)) == NULL)\n\t\treturn GIT_ENOTFOUND;\n\n\t*id_end = found + 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"buf_text.h\"",
      "#include \"buffer.h\"",
      "#include \"filter.h\"",
      "#include \"git2/sys/filter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "start + 2",
            "'$'",
            "len - 2"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "start",
            "'$'",
            "len"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"filter.h\"\n#include \"git2/sys/filter.h\"\n\nstatic int ident_find_id(\n\tconst char **id_start, const char **id_end, const char *start, size_t len)\n{\n\tconst char *end = start + len, *found = NULL;\n\n\twhile (len > 3 && (found = memchr(start, '$', len)) != NULL) {\n\t\tsize_t remaining = (size_t)(end - found) - 1;\n\t\tif (remaining < 3)\n\t\t\treturn GIT_ENOTFOUND;\n\n\t\tstart = found + 1;\n\t\tlen   = remaining;\n\n\t\tif (start[0] == 'I' && start[1] == 'd')\n\t\t\tbreak;\n\t}\n\n\tif (len < 3 || !found)\n\t\treturn GIT_ENOTFOUND;\n\t*id_start = found;\n\n\tif ((found = memchr(start + 2, '$', len - 2)) == NULL)\n\t\treturn GIT_ENOTFOUND;\n\n\t*id_end = found + 1;\n\treturn 0;\n}"
  }
]