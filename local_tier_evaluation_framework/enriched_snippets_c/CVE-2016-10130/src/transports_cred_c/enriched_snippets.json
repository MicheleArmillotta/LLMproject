[
  {
    "function_name": "git_cred_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "382-388",
    "snippet": "void git_cred_free(git_cred *cred)\n{\n\tif (!cred)\n\t\treturn;\n\n\tcred->free(cred);\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cred->free",
          "args": [
            "cred"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nvoid git_cred_free(git_cred *cred)\n{\n\tif (!cred)\n\t\treturn;\n\n\tcred->free(cred);\n}"
  },
  {
    "function_name": "git_cred_username_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "360-380",
    "snippet": "int git_cred_username_new(git_cred **cred, const char *username)\n{\n\tgit_cred_username *c;\n\tsize_t len, allocsize;\n\n\tassert(cred);\n\n\tlen = strlen(username);\n\n\tGITERR_CHECK_ALLOC_ADD(&allocsize, sizeof(git_cred_username), len);\n\tGITERR_CHECK_ALLOC_ADD(&allocsize, allocsize, 1);\n\tc = git__malloc(allocsize);\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_USERNAME;\n\tc->parent.free = username_free;\n\tmemcpy(c->username, username, len + 1);\n\n\t*cred = (git_cred *) c;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "c->username",
            "username",
            "len + 1"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "allocsize"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&allocsize",
            "allocsize",
            "1"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&allocsize",
            "sizeof(git_cred_username)",
            "len"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "username"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cred"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nint git_cred_username_new(git_cred **cred, const char *username)\n{\n\tgit_cred_username *c;\n\tsize_t len, allocsize;\n\n\tassert(cred);\n\n\tlen = strlen(username);\n\n\tGITERR_CHECK_ALLOC_ADD(&allocsize, sizeof(git_cred_username), len);\n\tGITERR_CHECK_ALLOC_ADD(&allocsize, allocsize, 1);\n\tc = git__malloc(allocsize);\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_USERNAME;\n\tc->parent.free = username_free;\n\tmemcpy(c->username, username, len + 1);\n\n\t*cred = (git_cred *) c;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_cred_default_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "344-358",
    "snippet": "int git_cred_default_new(git_cred **cred)\n{\n\tgit_cred_default *c;\n\n\tassert(cred);\n\n\tc = git__calloc(1, sizeof(git_cred_default));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->credtype = GIT_CREDTYPE_DEFAULT;\n\tc->free = default_free;\n\n\t*cred = c;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_cred_default)"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cred"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nint git_cred_default_new(git_cred **cred)\n{\n\tgit_cred_default *c;\n\n\tassert(cred);\n\n\tc = git__calloc(1, sizeof(git_cred_default));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->credtype = GIT_CREDTYPE_DEFAULT;\n\tc->free = default_free;\n\n\t*cred = c;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_cred_ssh_custom_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "308-342",
    "snippet": "int git_cred_ssh_custom_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tsize_t publickey_len,\n\tgit_cred_sign_callback sign_callback,\n\tvoid *payload)\n{\n\tgit_cred_ssh_custom *c;\n\n\tassert(username && cred);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_custom));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_SSH_CUSTOM;\n\tc->parent.free = ssh_custom_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tif (publickey_len > 0) {\n\t\tc->publickey = git__malloc(publickey_len);\n\t\tGITERR_CHECK_ALLOC(c->publickey);\n\n\t\tmemcpy(c->publickey, publickey, publickey_len);\n\t}\n\n\tc->publickey_len = publickey_len;\n\tc->sign_callback = sign_callback;\n\tc->payload = payload;\n\n\t*cred = &c->parent;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "c->publickey",
            "publickey",
            "publickey_len"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c->publickey"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "publickey_len"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c->username"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "username"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_cred_ssh_custom)"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "username && cred"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nint git_cred_ssh_custom_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tsize_t publickey_len,\n\tgit_cred_sign_callback sign_callback,\n\tvoid *payload)\n{\n\tgit_cred_ssh_custom *c;\n\n\tassert(username && cred);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_custom));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_SSH_CUSTOM;\n\tc->parent.free = ssh_custom_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tif (publickey_len > 0) {\n\t\tc->publickey = git__malloc(publickey_len);\n\t\tGITERR_CHECK_ALLOC(c->publickey);\n\n\t\tmemcpy(c->publickey, publickey, publickey_len);\n\t}\n\n\tc->publickey_len = publickey_len;\n\tc->sign_callback = sign_callback;\n\tc->payload = payload;\n\n\t*cred = &c->parent;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_cred_ssh_key_from_agent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "288-306",
    "snippet": "int git_cred_ssh_key_from_agent(git_cred **cred, const char *username) {\n\tgit_cred_ssh_key *c;\n\n\tassert(username && cred);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_key));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_SSH_KEY;\n\tc->parent.free = ssh_key_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->privatekey = NULL;\n\n\t*cred = &c->parent;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c->username"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "username"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_cred_ssh_key)"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "username && cred"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nint git_cred_ssh_key_from_agent(git_cred **cred, const char *username) {\n\tgit_cred_ssh_key *c;\n\n\tassert(username && cred);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_key));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_SSH_KEY;\n\tc->parent.free = ssh_key_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->privatekey = NULL;\n\n\t*cred = &c->parent;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_cred_ssh_interactive_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "262-286",
    "snippet": "int git_cred_ssh_interactive_new(\n\tgit_cred **out,\n\tconst char *username,\n\tgit_cred_ssh_interactive_callback prompt_callback,\n\tvoid *payload)\n{\n\tgit_cred_ssh_interactive *c;\n\n\tassert(out && username && prompt_callback);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_interactive));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_SSH_INTERACTIVE;\n\tc->parent.free = ssh_interactive_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->prompt_callback = prompt_callback;\n\tc->payload = payload;\n\n\t*out = &c->parent;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c->username"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "username"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_cred_ssh_interactive)"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && username && prompt_callback"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nint git_cred_ssh_interactive_new(\n\tgit_cred **out,\n\tconst char *username,\n\tgit_cred_ssh_interactive_callback prompt_callback,\n\tvoid *payload)\n{\n\tgit_cred_ssh_interactive *c;\n\n\tassert(out && username && prompt_callback);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_interactive));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_SSH_INTERACTIVE;\n\tc->parent.free = ssh_interactive_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->prompt_callback = prompt_callback;\n\tc->payload = payload;\n\n\t*out = &c->parent;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_cred_ssh_key_type_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "224-260",
    "snippet": "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype)\n{\n\tgit_cred_ssh_key *c;\n\n\tassert(username && cred && privatekey);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_key));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = credtype;\n\tc->parent.free = ssh_key_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->privatekey = git__strdup(privatekey);\n\tGITERR_CHECK_ALLOC(c->privatekey);\n\n\tif (publickey) {\n\t\tc->publickey = git__strdup(publickey);\n\t\tGITERR_CHECK_ALLOC(c->publickey);\n\t}\n\n\tif (passphrase) {\n\t\tc->passphrase = git__strdup(passphrase);\n\t\tGITERR_CHECK_ALLOC(c->passphrase);\n\t}\n\n\t*cred = &c->parent;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c->passphrase"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "passphrase"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c->publickey"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c->privatekey"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c->username"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_cred_ssh_key)"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "username && cred && privatekey"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype)\n{\n\tgit_cred_ssh_key *c;\n\n\tassert(username && cred && privatekey);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_key));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = credtype;\n\tc->parent.free = ssh_key_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->privatekey = git__strdup(privatekey);\n\tGITERR_CHECK_ALLOC(c->privatekey);\n\n\tif (publickey) {\n\t\tc->publickey = git__strdup(publickey);\n\t\tGITERR_CHECK_ALLOC(c->publickey);\n\t}\n\n\tif (passphrase) {\n\t\tc->passphrase = git__strdup(passphrase);\n\t\tGITERR_CHECK_ALLOC(c->passphrase);\n\t}\n\n\t*cred = &c->parent;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_cred_ssh_key_memory_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "196-222",
    "snippet": "int git_cred_ssh_key_memory_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase)\n{\n#ifdef GIT_SSH_MEMORY_CREDENTIALS\n\treturn git_cred_ssh_key_type_new(\n\t\tcred,\n\t\tusername,\n\t\tpublickey,\n\t\tprivatekey,\n\t\tpassphrase,\n\t\tGIT_CREDTYPE_SSH_MEMORY);\n#else\n\tGIT_UNUSED(cred);\n\tGIT_UNUSED(username);\n\tGIT_UNUSED(publickey);\n\tGIT_UNUSED(privatekey);\n\tGIT_UNUSED(passphrase);\n\n\tgiterr_set(GITERR_INVALID,\n\t\t\"This version of libgit2 was not built with ssh memory credentials.\");\n\treturn -1;\n#endif\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"This version of libgit2 was not built with ssh memory credentials.\""
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "passphrase"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "privatekey"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "publickey"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "username"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "cred"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_cred_ssh_key_type_new",
          "args": [
            "cred",
            "username",
            "publickey",
            "privatekey",
            "passphrase",
            "GIT_CREDTYPE_SSH_MEMORY"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "git_cred_ssh_key_type_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
          "lines": "224-260",
          "snippet": "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype)\n{\n\tgit_cred_ssh_key *c;\n\n\tassert(username && cred && privatekey);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_key));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = credtype;\n\tc->parent.free = ssh_key_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->privatekey = git__strdup(privatekey);\n\tGITERR_CHECK_ALLOC(c->privatekey);\n\n\tif (publickey) {\n\t\tc->publickey = git__strdup(publickey);\n\t\tGITERR_CHECK_ALLOC(c->publickey);\n\t}\n\n\tif (passphrase) {\n\t\tc->passphrase = git__strdup(passphrase);\n\t\tGITERR_CHECK_ALLOC(c->passphrase);\n\t}\n\n\t*cred = &c->parent;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/cred_helpers.h\"",
            "#include \"smart.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype)\n{\n\tgit_cred_ssh_key *c;\n\n\tassert(username && cred && privatekey);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_key));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = credtype;\n\tc->parent.free = ssh_key_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->privatekey = git__strdup(privatekey);\n\tGITERR_CHECK_ALLOC(c->privatekey);\n\n\tif (publickey) {\n\t\tc->publickey = git__strdup(publickey);\n\t\tGITERR_CHECK_ALLOC(c->publickey);\n\t}\n\n\tif (passphrase) {\n\t\tc->passphrase = git__strdup(passphrase);\n\t\tGITERR_CHECK_ALLOC(c->passphrase);\n\t}\n\n\t*cred = &c->parent;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nint git_cred_ssh_key_memory_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase)\n{\n#ifdef GIT_SSH_MEMORY_CREDENTIALS\n\treturn git_cred_ssh_key_type_new(\n\t\tcred,\n\t\tusername,\n\t\tpublickey,\n\t\tprivatekey,\n\t\tpassphrase,\n\t\tGIT_CREDTYPE_SSH_MEMORY);\n#else\n\tGIT_UNUSED(cred);\n\tGIT_UNUSED(username);\n\tGIT_UNUSED(publickey);\n\tGIT_UNUSED(privatekey);\n\tGIT_UNUSED(passphrase);\n\n\tgiterr_set(GITERR_INVALID,\n\t\t\"This version of libgit2 was not built with ssh memory credentials.\");\n\treturn -1;\n#endif\n}"
  },
  {
    "function_name": "git_cred_ssh_key_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "180-194",
    "snippet": "int git_cred_ssh_key_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase)\n{\n\treturn git_cred_ssh_key_type_new(\n\t\tcred,\n\t\tusername,\n\t\tpublickey,\n\t\tprivatekey,\n\t\tpassphrase,\n\t\tGIT_CREDTYPE_SSH_KEY);\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_cred_ssh_key_type_new",
          "args": [
            "cred",
            "username",
            "publickey",
            "privatekey",
            "passphrase",
            "GIT_CREDTYPE_SSH_KEY"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "git_cred_ssh_key_type_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
          "lines": "224-260",
          "snippet": "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype)\n{\n\tgit_cred_ssh_key *c;\n\n\tassert(username && cred && privatekey);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_key));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = credtype;\n\tc->parent.free = ssh_key_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->privatekey = git__strdup(privatekey);\n\tGITERR_CHECK_ALLOC(c->privatekey);\n\n\tif (publickey) {\n\t\tc->publickey = git__strdup(publickey);\n\t\tGITERR_CHECK_ALLOC(c->publickey);\n\t}\n\n\tif (passphrase) {\n\t\tc->passphrase = git__strdup(passphrase);\n\t\tGITERR_CHECK_ALLOC(c->passphrase);\n\t}\n\n\t*cred = &c->parent;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/cred_helpers.h\"",
            "#include \"smart.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype)\n{\n\tgit_cred_ssh_key *c;\n\n\tassert(username && cred && privatekey);\n\n\tc = git__calloc(1, sizeof(git_cred_ssh_key));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = credtype;\n\tc->parent.free = ssh_key_free;\n\n\tc->username = git__strdup(username);\n\tGITERR_CHECK_ALLOC(c->username);\n\n\tc->privatekey = git__strdup(privatekey);\n\tGITERR_CHECK_ALLOC(c->privatekey);\n\n\tif (publickey) {\n\t\tc->publickey = git__strdup(publickey);\n\t\tGITERR_CHECK_ALLOC(c->publickey);\n\t}\n\n\tif (passphrase) {\n\t\tc->passphrase = git__strdup(passphrase);\n\t\tGITERR_CHECK_ALLOC(c->passphrase);\n\t}\n\n\t*cred = &c->parent;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nint git_cred_ssh_key_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase)\n{\n\treturn git_cred_ssh_key_type_new(\n\t\tcred,\n\t\tusername,\n\t\tpublickey,\n\t\tprivatekey,\n\t\tpassphrase,\n\t\tGIT_CREDTYPE_SSH_KEY);\n}"
  },
  {
    "function_name": "username_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "175-178",
    "snippet": "static void username_free(struct git_cred *cred)\n{\n\tgit__free(cred);\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "cred"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic void username_free(struct git_cred *cred)\n{\n\tgit__free(cred);\n}"
  },
  {
    "function_name": "default_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "168-173",
    "snippet": "static void default_free(struct git_cred *cred)\n{\n\tgit_cred_default *c = (git_cred_default *)cred;\n\n\tgit__free(c);\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "c"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic void default_free(struct git_cred *cred)\n{\n\tgit_cred_default *c = (git_cred_default *)cred;\n\n\tgit__free(c);\n}"
  },
  {
    "function_name": "ssh_custom_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "152-166",
    "snippet": "static void ssh_custom_free(struct git_cred *cred)\n{\n\tgit_cred_ssh_custom *c = (git_cred_ssh_custom *)cred;\n\n\tgit__free(c->username);\n\n\tif (c->publickey) {\n\t\t/* Zero the memory which previously held the publickey */\n\t\tsize_t key_len = strlen(c->publickey);\n\t\tgit__memzero(c->publickey, key_len);\n\t\tgit__free(c->publickey);\n\t}\n\n\tgit__free(c);\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "c"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__memzero",
          "args": [
            "c->publickey",
            "key_len"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "git__memzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "521-531",
          "snippet": "GIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "c->publickey"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic void ssh_custom_free(struct git_cred *cred)\n{\n\tgit_cred_ssh_custom *c = (git_cred_ssh_custom *)cred;\n\n\tgit__free(c->username);\n\n\tif (c->publickey) {\n\t\t/* Zero the memory which previously held the publickey */\n\t\tsize_t key_len = strlen(c->publickey);\n\t\tgit__memzero(c->publickey, key_len);\n\t\tgit__free(c->publickey);\n\t}\n\n\tgit__free(c);\n}"
  },
  {
    "function_name": "ssh_interactive_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "143-150",
    "snippet": "static void ssh_interactive_free(struct git_cred *cred)\n{\n\tgit_cred_ssh_interactive *c = (git_cred_ssh_interactive *)cred;\n\n\tgit__free(c->username);\n\n\tgit__free(c);\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "c"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic void ssh_interactive_free(struct git_cred *cred)\n{\n\tgit_cred_ssh_interactive *c = (git_cred_ssh_interactive *)cred;\n\n\tgit__free(c->username);\n\n\tgit__free(c);\n}"
  },
  {
    "function_name": "ssh_key_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "112-141",
    "snippet": "static void ssh_key_free(struct git_cred *cred)\n{\n\tgit_cred_ssh_key *c =\n\t\t(git_cred_ssh_key *)cred;\n\n\tgit__free(c->username);\n\n\tif (c->privatekey) {\n\t\t/* Zero the memory which previously held the private key */\n\t\tsize_t key_len = strlen(c->privatekey);\n\t\tgit__memzero(c->privatekey, key_len);\n\t\tgit__free(c->privatekey);\n\t}\n\n\tif (c->passphrase) {\n\t\t/* Zero the memory which previously held the passphrase */\n\t\tsize_t pass_len = strlen(c->passphrase);\n\t\tgit__memzero(c->passphrase, pass_len);\n\t\tgit__free(c->passphrase);\n\t}\n\n\tif (c->publickey) {\n\t\t/* Zero the memory which previously held the public key */\n\t\tsize_t key_len = strlen(c->publickey);\n\t\tgit__memzero(c->publickey, key_len);\n\t\tgit__free(c->publickey);\n\t}\n\n\tgit__free(c);\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "c"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__memzero",
          "args": [
            "c->publickey",
            "key_len"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "git__memzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "521-531",
          "snippet": "GIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "c->publickey"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "c->passphrase"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "c->privatekey"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic void ssh_key_free(struct git_cred *cred)\n{\n\tgit_cred_ssh_key *c =\n\t\t(git_cred_ssh_key *)cred;\n\n\tgit__free(c->username);\n\n\tif (c->privatekey) {\n\t\t/* Zero the memory which previously held the private key */\n\t\tsize_t key_len = strlen(c->privatekey);\n\t\tgit__memzero(c->privatekey, key_len);\n\t\tgit__free(c->privatekey);\n\t}\n\n\tif (c->passphrase) {\n\t\t/* Zero the memory which previously held the passphrase */\n\t\tsize_t pass_len = strlen(c->passphrase);\n\t\tgit__memzero(c->passphrase, pass_len);\n\t\tgit__free(c->passphrase);\n\t}\n\n\tif (c->publickey) {\n\t\t/* Zero the memory which previously held the public key */\n\t\tsize_t key_len = strlen(c->publickey);\n\t\tgit__memzero(c->publickey, key_len);\n\t\tgit__free(c->publickey);\n\t}\n\n\tgit__free(c);\n}"
  },
  {
    "function_name": "git_cred_userpass_plaintext_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "79-110",
    "snippet": "int git_cred_userpass_plaintext_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *password)\n{\n\tgit_cred_userpass_plaintext *c;\n\n\tassert(cred && username && password);\n\n\tc = git__malloc(sizeof(git_cred_userpass_plaintext));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_USERPASS_PLAINTEXT;\n\tc->parent.free = plaintext_free;\n\tc->username = git__strdup(username);\n\n\tif (!c->username) {\n\t\tgit__free(c);\n\t\treturn -1;\n\t}\n\n\tc->password = git__strdup(password);\n\n\tif (!c->password) {\n\t\tgit__free(c->username);\n\t\tgit__free(c);\n\t\treturn -1;\n\t}\n\n\t*cred = &c->parent;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "c"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "password"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "c"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "sizeof(git_cred_userpass_plaintext)"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cred && username && password"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nint git_cred_userpass_plaintext_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *password)\n{\n\tgit_cred_userpass_plaintext *c;\n\n\tassert(cred && username && password);\n\n\tc = git__malloc(sizeof(git_cred_userpass_plaintext));\n\tGITERR_CHECK_ALLOC(c);\n\n\tc->parent.credtype = GIT_CREDTYPE_USERPASS_PLAINTEXT;\n\tc->parent.free = plaintext_free;\n\tc->username = git__strdup(username);\n\n\tif (!c->username) {\n\t\tgit__free(c);\n\t\treturn -1;\n\t}\n\n\tc->password = git__strdup(password);\n\n\tif (!c->password) {\n\t\tgit__free(c->username);\n\t\tgit__free(c);\n\t\treturn -1;\n\t}\n\n\t*cred = &c->parent;\n\treturn 0;\n}"
  },
  {
    "function_name": "plaintext_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "63-77",
    "snippet": "static void plaintext_free(struct git_cred *cred)\n{\n\tgit_cred_userpass_plaintext *c = (git_cred_userpass_plaintext *)cred;\n\n\tgit__free(c->username);\n\n\t/* Zero the memory which previously held the password */\n\tif (c->password) {\n\t\tsize_t pass_len = strlen(c->password);\n\t\tgit__memzero(c->password, pass_len);\n\t\tgit__free(c->password);\n\t}\n\n\tgit__free(c);\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "c"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__memzero",
          "args": [
            "c->password",
            "pass_len"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "git__memzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "521-531",
          "snippet": "GIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "c->password"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic void plaintext_free(struct git_cred *cred)\n{\n\tgit_cred_userpass_plaintext *c = (git_cred_userpass_plaintext *)cred;\n\n\tgit__free(c->username);\n\n\t/* Zero the memory which previously held the password */\n\tif (c->password) {\n\t\tsize_t pass_len = strlen(c->password);\n\t\tgit__memzero(c->password, pass_len);\n\t\tgit__free(c->password);\n\t}\n\n\tgit__free(c);\n}"
  },
  {
    "function_name": "git_cred__username",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "28-61",
    "snippet": "const char *git_cred__username(git_cred *cred)\n{\n\tswitch (cred->credtype) {\n\tcase GIT_CREDTYPE_USERNAME:\n\t{\n\t\tgit_cred_username *c = (git_cred_username *) cred;\n\t\treturn c->username;\n\t}\n\tcase GIT_CREDTYPE_USERPASS_PLAINTEXT:\n\t{\n\t\tgit_cred_userpass_plaintext *c = (git_cred_userpass_plaintext *) cred;\n\t\treturn c->username;\n\t}\n\tcase GIT_CREDTYPE_SSH_KEY:\n\tcase GIT_CREDTYPE_SSH_MEMORY:\n\t{\n\t\tgit_cred_ssh_key *c = (git_cred_ssh_key *) cred;\n\t\treturn c->username;\n\t}\n\tcase GIT_CREDTYPE_SSH_CUSTOM:\n\t{\n\t\tgit_cred_ssh_custom *c = (git_cred_ssh_custom *) cred;\n\t\treturn c->username;\n\t}\n\tcase GIT_CREDTYPE_SSH_INTERACTIVE:\n\t{\n\t\tgit_cred_ssh_interactive *c = (git_cred_ssh_interactive *) cred;\n\t\treturn c->username;\n\t}\n\n\tdefault:\n\t\treturn NULL;\n\t}\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nconst char *git_cred__username(git_cred *cred)\n{\n\tswitch (cred->credtype) {\n\tcase GIT_CREDTYPE_USERNAME:\n\t{\n\t\tgit_cred_username *c = (git_cred_username *) cred;\n\t\treturn c->username;\n\t}\n\tcase GIT_CREDTYPE_USERPASS_PLAINTEXT:\n\t{\n\t\tgit_cred_userpass_plaintext *c = (git_cred_userpass_plaintext *) cred;\n\t\treturn c->username;\n\t}\n\tcase GIT_CREDTYPE_SSH_KEY:\n\tcase GIT_CREDTYPE_SSH_MEMORY:\n\t{\n\t\tgit_cred_ssh_key *c = (git_cred_ssh_key *) cred;\n\t\treturn c->username;\n\t}\n\tcase GIT_CREDTYPE_SSH_CUSTOM:\n\t{\n\t\tgit_cred_ssh_custom *c = (git_cred_ssh_custom *) cred;\n\t\treturn c->username;\n\t}\n\tcase GIT_CREDTYPE_SSH_INTERACTIVE:\n\t{\n\t\tgit_cred_ssh_interactive *c = (git_cred_ssh_interactive *) cred;\n\t\treturn c->username;\n\t}\n\n\tdefault:\n\t\treturn NULL;\n\t}\n}"
  },
  {
    "function_name": "git_cred_has_username",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/cred.c",
    "lines": "20-26",
    "snippet": "int git_cred_has_username(git_cred *cred)\n{\n\tif (cred->credtype == GIT_CREDTYPE_DEFAULT)\n\t\treturn 0;\n\n\treturn 1;\n}",
    "includes": [
      "#include \"git2/cred_helpers.h\"",
      "#include \"smart.h\"",
      "#include \"git2.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"git2/cred_helpers.h\"\n#include \"smart.h\"\n#include \"git2.h\"\n\nstatic int git_cred_ssh_key_type_new(\n\tgit_cred **cred,\n\tconst char *username,\n\tconst char *publickey,\n\tconst char *privatekey,\n\tconst char *passphrase,\n\tgit_credtype_t credtype);\n\nint git_cred_has_username(git_cred *cred)\n{\n\tif (cred->credtype == GIT_CREDTYPE_DEFAULT)\n\t\treturn 0;\n\n\treturn 1;\n}"
  }
]