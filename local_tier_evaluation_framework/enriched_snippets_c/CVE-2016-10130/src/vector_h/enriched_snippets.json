[
  {
    "function_name": "git_vector_set_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
    "lines": "107-113",
    "snippet": "GIT_INLINE(void) git_vector_set_cmp(git_vector *v, git_vector_cmp cmp)\n{\n\tif (cmp != v->_cmp) {\n\t\tv->_cmp = cmp;\n\t\tgit_vector_set_sorted(v, 0);\n\t}\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_set_sorted",
          "args": [
            "v",
            "0"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void) git_vector_set_cmp(git_vector *v, git_vector_cmp cmp)\n{\n\tif (cmp != v->_cmp) {\n\t\tv->_cmp = cmp;\n\t\tgit_vector_set_sorted(v, 0);\n\t}\n}"
  },
  {
    "function_name": "git_vector_last",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
    "lines": "72-75",
    "snippet": "GIT_INLINE(void *) git_vector_last(const git_vector *v)\n{\n\treturn (v->length > 0) ? git_vector_get(v, v->length - 1) : NULL;\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_get",
          "args": [
            "v",
            "v->length - 1"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
          "lines": "60-63",
          "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_last(const git_vector *v)\n{\n\treturn (v->length > 0) ? git_vector_get(v, v->length - 1) : NULL;\n}"
  },
  {
    "function_name": "git_vector_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
    "lines": "67-70",
    "snippet": "GIT_INLINE(size_t) git_vector_length(const git_vector *v)\n{\n\treturn v->length;\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(size_t) git_vector_length(const git_vector *v)\n{\n\treturn v->length;\n}"
  },
  {
    "function_name": "git_vector_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
    "lines": "60-63",
    "snippet": "GIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(void *) git_vector_get(const git_vector *v, size_t position)\n{\n\treturn (position < v->length) ? v->contents[position] : NULL;\n}"
  },
  {
    "function_name": "git_vector_bsearch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.h",
    "lines": "55-58",
    "snippet": "GIT_INLINE(int) git_vector_bsearch(size_t *at_pos, git_vector *v, const void *key)\n{\n\treturn git_vector_bsearch2(at_pos, v, v->_cmp, key);\n}",
    "includes": [
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_vector_bsearch2",
          "args": [
            "at_pos",
            "v",
            "v->_cmp",
            "key"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "git_vector_bsearch2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/vector.c",
          "lines": "187-202",
          "snippet": "int git_vector_bsearch2(\n\tsize_t *at_pos,\n\tgit_vector *v,\n\tgit_vector_cmp key_lookup,\n\tconst void *key)\n{\n\tassert(v && key && key_lookup);\n\n\t/* need comparison function to sort the vector */\n\tif (!v->_cmp)\n\t\treturn -1;\n\n\tgit_vector_sort(v);\n\n\treturn git__bsearch(v->contents, v->length, key, key_lookup, at_pos);\n}",
          "includes": [
            "#include \"vector.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vector.h\"\n#include \"common.h\"\n\nint git_vector_bsearch2(\n\tsize_t *at_pos,\n\tgit_vector *v,\n\tgit_vector_cmp key_lookup,\n\tconst void *key)\n{\n\tassert(v && key && key_lookup);\n\n\t/* need comparison function to sort the vector */\n\tif (!v->_cmp)\n\t\treturn -1;\n\n\tgit_vector_sort(v);\n\n\treturn git__bsearch(v->contents, v->length, key, key_lookup, at_pos);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n\nGIT_INLINE(int) git_vector_bsearch(size_t *at_pos, git_vector *v, const void *key)\n{\n\treturn git_vector_bsearch2(at_pos, v, v->_cmp, key);\n}"
  }
]