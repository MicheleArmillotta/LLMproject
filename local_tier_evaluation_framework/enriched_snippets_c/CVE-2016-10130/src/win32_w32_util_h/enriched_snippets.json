[
  {
    "function_name": "git_win32__file_attribute_to_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.h",
    "lines": "155-184",
    "snippet": "GIT_INLINE(int) git_win32__file_attribute_to_stat(\n\tstruct stat *st,\n\tconst WIN32_FILE_ATTRIBUTE_DATA *attrdata,\n\tconst wchar_t *path)\n{\n\tgit_win32__stat_init(st,\n\t\tattrdata->dwFileAttributes,\n\t\tattrdata->nFileSizeHigh,\n\t\tattrdata->nFileSizeLow,\n\t\tattrdata->ftCreationTime,\n\t\tattrdata->ftLastAccessTime,\n\t\tattrdata->ftLastWriteTime);\n\n\tif (attrdata->dwFileAttributes & FILE_ATTRIBUTE_REPARSE_POINT && path) {\n\t\tgit_win32_path target;\n\n\t\tif (git_win32_path_readlink_w(target, path) >= 0) {\n\t\t\tst->st_mode = (st->st_mode & ~S_IFMT) | S_IFLNK;\n\n\t\t\t/* st_size gets the UTF-8 length of the target name, in bytes,\n\t\t\t * not counting the NULL terminator */\n\t\t\tif ((st->st_size = git__utf16_to_8(NULL, 0, target)) < 0) {\n\t\t\t\tgiterr_set(GITERR_OS, \"Could not convert reparse point name for '%s'\", path);\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"path_w32.h\"",
      "#include \"posix.h\"",
      "#include \"utf-conv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Could not convert reparse point name for '%s'\"",
            "path"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__utf16_to_8",
          "args": [
            "NULL",
            "0",
            "target"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "git__utf16_to_8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/utf-conv.c",
          "lines": "48-59",
          "snippet": "int git__utf16_to_8(char *dest, size_t dest_size, const wchar_t *src)\n{\n\tint len;\n\n\t/* Length of -1 indicates NULL termination of the input string. Subtract 1 from the result to\n\t * turn 0 into -1 (an error code) and to not count the NULL terminator as part of the string's\n\t * length. WideCharToMultiByte never returns int's minvalue, so underflow is not possible */\n\tif ((len = WideCharToMultiByte(CP_UTF8, WC_ERR_INVALID_CHARS, src, -1, dest, (int)dest_size, NULL, NULL) - 1) < 0)\n\t\tgit__set_errno();\n\n\treturn len;\n}",
          "includes": [
            "#include \"utf-conv.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utf-conv.h\"\n#include \"common.h\"\n\nint git__utf16_to_8(char *dest, size_t dest_size, const wchar_t *src)\n{\n\tint len;\n\n\t/* Length of -1 indicates NULL termination of the input string. Subtract 1 from the result to\n\t * turn 0 into -1 (an error code) and to not count the NULL terminator as part of the string's\n\t * length. WideCharToMultiByte never returns int's minvalue, so underflow is not possible */\n\tif ((len = WideCharToMultiByte(CP_UTF8, WC_ERR_INVALID_CHARS, src, -1, dest, (int)dest_size, NULL, NULL) - 1) < 0)\n\t\tgit__set_errno();\n\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32_path_readlink_w",
          "args": [
            "target",
            "path"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32_path_readlink_w",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/path_w32.c",
          "lines": "324-387",
          "snippet": "int git_win32_path_readlink_w(git_win32_path dest, const git_win32_path path)\n{\n\tBYTE buf[MAXIMUM_REPARSE_DATA_BUFFER_SIZE];\n\tGIT_REPARSE_DATA_BUFFER *reparse_buf = (GIT_REPARSE_DATA_BUFFER *)buf;\n\tHANDLE handle = NULL;\n\tDWORD ioctl_ret;\n\twchar_t *target;\n\tsize_t target_len;\n\n\tint error = -1;\n\n\thandle = CreateFileW(path, GENERIC_READ,\n\t\tFILE_SHARE_READ | FILE_SHARE_DELETE, NULL, OPEN_EXISTING,\n\t\tFILE_FLAG_OPEN_REPARSE_POINT | FILE_FLAG_BACKUP_SEMANTICS, NULL);\n\n\tif (handle == INVALID_HANDLE_VALUE) {\n\t\terrno = ENOENT;\n\t\treturn -1;\n\t}\n\n\tif (!DeviceIoControl(handle, FSCTL_GET_REPARSE_POINT, NULL, 0,\n\t\treparse_buf, sizeof(buf), &ioctl_ret, NULL)) {\n\t\terrno = EINVAL;\n\t\tgoto on_error;\n\t}\n\n\tswitch (reparse_buf->ReparseTag) {\n\tcase IO_REPARSE_TAG_SYMLINK:\n\t\ttarget = reparse_buf->SymbolicLinkReparseBuffer.PathBuffer +\n\t\t\t(reparse_buf->SymbolicLinkReparseBuffer.SubstituteNameOffset / sizeof(WCHAR));\n\t\ttarget_len = reparse_buf->SymbolicLinkReparseBuffer.SubstituteNameLength / sizeof(WCHAR);\n\tbreak;\n\tcase IO_REPARSE_TAG_MOUNT_POINT:\n\t\ttarget = reparse_buf->MountPointReparseBuffer.PathBuffer +\n\t\t\t(reparse_buf->MountPointReparseBuffer.SubstituteNameOffset / sizeof(WCHAR));\n\t\ttarget_len = reparse_buf->MountPointReparseBuffer.SubstituteNameLength / sizeof(WCHAR);\n\tbreak;\n\tdefault:\n\t\terrno = EINVAL;\n\t\tgoto on_error;\n\t}\n\n\tif (path_is_volume(target, target_len)) {\n\t\t/* This path is a reparse point that represents another volume mounted\n\t\t* at this location, it is not a symbolic link our input was canonical.\n\t\t*/\n\t\terrno = EINVAL;\n\t\terror = -1;\n\t} else if (target_len) {\n\t\t/* The path may need to have a prefix removed. */\n\t\ttarget_len = git_win32__canonicalize_path(target, target_len);\n\n\t\t/* Need one additional character in the target buffer\n\t\t* for the terminating NULL. */\n\t\tif (GIT_WIN_PATH_UTF16 > target_len) {\n\t\t\twcscpy(dest, target);\n\t\t\terror = (int)target_len;\n\t\t}\n\t}\n\non_error:\n\tCloseHandle(handle);\n\treturn error;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"reparse.h\"",
            "#include \"posix.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"reparse.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_win32_path_readlink_w(git_win32_path dest, const git_win32_path path)\n{\n\tBYTE buf[MAXIMUM_REPARSE_DATA_BUFFER_SIZE];\n\tGIT_REPARSE_DATA_BUFFER *reparse_buf = (GIT_REPARSE_DATA_BUFFER *)buf;\n\tHANDLE handle = NULL;\n\tDWORD ioctl_ret;\n\twchar_t *target;\n\tsize_t target_len;\n\n\tint error = -1;\n\n\thandle = CreateFileW(path, GENERIC_READ,\n\t\tFILE_SHARE_READ | FILE_SHARE_DELETE, NULL, OPEN_EXISTING,\n\t\tFILE_FLAG_OPEN_REPARSE_POINT | FILE_FLAG_BACKUP_SEMANTICS, NULL);\n\n\tif (handle == INVALID_HANDLE_VALUE) {\n\t\terrno = ENOENT;\n\t\treturn -1;\n\t}\n\n\tif (!DeviceIoControl(handle, FSCTL_GET_REPARSE_POINT, NULL, 0,\n\t\treparse_buf, sizeof(buf), &ioctl_ret, NULL)) {\n\t\terrno = EINVAL;\n\t\tgoto on_error;\n\t}\n\n\tswitch (reparse_buf->ReparseTag) {\n\tcase IO_REPARSE_TAG_SYMLINK:\n\t\ttarget = reparse_buf->SymbolicLinkReparseBuffer.PathBuffer +\n\t\t\t(reparse_buf->SymbolicLinkReparseBuffer.SubstituteNameOffset / sizeof(WCHAR));\n\t\ttarget_len = reparse_buf->SymbolicLinkReparseBuffer.SubstituteNameLength / sizeof(WCHAR);\n\tbreak;\n\tcase IO_REPARSE_TAG_MOUNT_POINT:\n\t\ttarget = reparse_buf->MountPointReparseBuffer.PathBuffer +\n\t\t\t(reparse_buf->MountPointReparseBuffer.SubstituteNameOffset / sizeof(WCHAR));\n\t\ttarget_len = reparse_buf->MountPointReparseBuffer.SubstituteNameLength / sizeof(WCHAR);\n\tbreak;\n\tdefault:\n\t\terrno = EINVAL;\n\t\tgoto on_error;\n\t}\n\n\tif (path_is_volume(target, target_len)) {\n\t\t/* This path is a reparse point that represents another volume mounted\n\t\t* at this location, it is not a symbolic link our input was canonical.\n\t\t*/\n\t\terrno = EINVAL;\n\t\terror = -1;\n\t} else if (target_len) {\n\t\t/* The path may need to have a prefix removed. */\n\t\ttarget_len = git_win32__canonicalize_path(target, target_len);\n\n\t\t/* Need one additional character in the target buffer\n\t\t* for the terminating NULL. */\n\t\tif (GIT_WIN_PATH_UTF16 > target_len) {\n\t\t\twcscpy(dest, target);\n\t\t\terror = (int)target_len;\n\t\t}\n\t}\n\non_error:\n\tCloseHandle(handle);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__stat_init",
          "args": [
            "st",
            "attrdata->dwFileAttributes",
            "attrdata->nFileSizeHigh",
            "attrdata->nFileSizeLow",
            "attrdata->ftCreationTime",
            "attrdata->ftLastAccessTime",
            "attrdata->ftLastWriteTime"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__stat_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.h",
          "lines": "108-140",
          "snippet": "GIT_INLINE(void) git_win32__stat_init(\n\tstruct stat *st,\n\tDWORD dwFileAttributes,\n\tDWORD nFileSizeHigh,\n\tDWORD nFileSizeLow,\n\tFILETIME ftCreationTime,\n\tFILETIME ftLastAccessTime,\n\tFILETIME ftLastWriteTime)\n{\n\tmode_t mode = S_IREAD;\n\n\tmemset(st, 0, sizeof(struct stat));\n\n\tif (dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)\n\t\tmode |= S_IFDIR;\n\telse\n\t\tmode |= S_IFREG;\n\n\tif ((dwFileAttributes & FILE_ATTRIBUTE_READONLY) == 0)\n\t\tmode |= S_IWRITE;\n\n\tst->st_ino = 0;\n\tst->st_gid = 0;\n\tst->st_uid = 0;\n\tst->st_nlink = 1;\n\tst->st_mode = mode;\n\tst->st_size = ((git_off_t)nFileSizeHigh << 32) + nFileSizeLow;\n\tst->st_dev = _getdrive() - 1;\n\tst->st_rdev = st->st_dev;\n\tgit_win32__filetime_to_timespec(&ftLastAccessTime, &(st->st_atim));\n\tgit_win32__filetime_to_timespec(&ftLastWriteTime, &(st->st_mtim));\n\tgit_win32__filetime_to_timespec(&ftCreationTime, &(st->st_ctim));\n}",
          "includes": [
            "#include \"path_w32.h\"",
            "#include \"posix.h\"",
            "#include \"utf-conv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"path_w32.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n\nGIT_INLINE(void) git_win32__stat_init(\n\tstruct stat *st,\n\tDWORD dwFileAttributes,\n\tDWORD nFileSizeHigh,\n\tDWORD nFileSizeLow,\n\tFILETIME ftCreationTime,\n\tFILETIME ftLastAccessTime,\n\tFILETIME ftLastWriteTime)\n{\n\tmode_t mode = S_IREAD;\n\n\tmemset(st, 0, sizeof(struct stat));\n\n\tif (dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)\n\t\tmode |= S_IFDIR;\n\telse\n\t\tmode |= S_IFREG;\n\n\tif ((dwFileAttributes & FILE_ATTRIBUTE_READONLY) == 0)\n\t\tmode |= S_IWRITE;\n\n\tst->st_ino = 0;\n\tst->st_gid = 0;\n\tst->st_uid = 0;\n\tst->st_nlink = 1;\n\tst->st_mode = mode;\n\tst->st_size = ((git_off_t)nFileSizeHigh << 32) + nFileSizeLow;\n\tst->st_dev = _getdrive() - 1;\n\tst->st_rdev = st->st_dev;\n\tgit_win32__filetime_to_timespec(&ftLastAccessTime, &(st->st_atim));\n\tgit_win32__filetime_to_timespec(&ftLastWriteTime, &(st->st_mtim));\n\tgit_win32__filetime_to_timespec(&ftCreationTime, &(st->st_ctim));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"path_w32.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n\nGIT_INLINE(int) git_win32__file_attribute_to_stat(\n\tstruct stat *st,\n\tconst WIN32_FILE_ATTRIBUTE_DATA *attrdata,\n\tconst wchar_t *path)\n{\n\tgit_win32__stat_init(st,\n\t\tattrdata->dwFileAttributes,\n\t\tattrdata->nFileSizeHigh,\n\t\tattrdata->nFileSizeLow,\n\t\tattrdata->ftCreationTime,\n\t\tattrdata->ftLastAccessTime,\n\t\tattrdata->ftLastWriteTime);\n\n\tif (attrdata->dwFileAttributes & FILE_ATTRIBUTE_REPARSE_POINT && path) {\n\t\tgit_win32_path target;\n\n\t\tif (git_win32_path_readlink_w(target, path) >= 0) {\n\t\t\tst->st_mode = (st->st_mode & ~S_IFMT) | S_IFLNK;\n\n\t\t\t/* st_size gets the UTF-8 length of the target name, in bytes,\n\t\t\t * not counting the NULL terminator */\n\t\t\tif ((st->st_size = git__utf16_to_8(NULL, 0, target)) < 0) {\n\t\t\t\tgiterr_set(GITERR_OS, \"Could not convert reparse point name for '%s'\", path);\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_win32__file_information_to_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.h",
    "lines": "142-153",
    "snippet": "GIT_INLINE(void) git_win32__file_information_to_stat(\n\tstruct stat *st,\n\tconst BY_HANDLE_FILE_INFORMATION *fileinfo)\n{\n\tgit_win32__stat_init(st,\n\t\tfileinfo->dwFileAttributes,\n\t\tfileinfo->nFileSizeHigh,\n\t\tfileinfo->nFileSizeLow,\n\t\tfileinfo->ftCreationTime,\n\t\tfileinfo->ftLastAccessTime,\n\t\tfileinfo->ftLastWriteTime);\n}",
    "includes": [
      "#include \"path_w32.h\"",
      "#include \"posix.h\"",
      "#include \"utf-conv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_win32__stat_init",
          "args": [
            "st",
            "fileinfo->dwFileAttributes",
            "fileinfo->nFileSizeHigh",
            "fileinfo->nFileSizeLow",
            "fileinfo->ftCreationTime",
            "fileinfo->ftLastAccessTime",
            "fileinfo->ftLastWriteTime"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__stat_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.h",
          "lines": "108-140",
          "snippet": "GIT_INLINE(void) git_win32__stat_init(\n\tstruct stat *st,\n\tDWORD dwFileAttributes,\n\tDWORD nFileSizeHigh,\n\tDWORD nFileSizeLow,\n\tFILETIME ftCreationTime,\n\tFILETIME ftLastAccessTime,\n\tFILETIME ftLastWriteTime)\n{\n\tmode_t mode = S_IREAD;\n\n\tmemset(st, 0, sizeof(struct stat));\n\n\tif (dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)\n\t\tmode |= S_IFDIR;\n\telse\n\t\tmode |= S_IFREG;\n\n\tif ((dwFileAttributes & FILE_ATTRIBUTE_READONLY) == 0)\n\t\tmode |= S_IWRITE;\n\n\tst->st_ino = 0;\n\tst->st_gid = 0;\n\tst->st_uid = 0;\n\tst->st_nlink = 1;\n\tst->st_mode = mode;\n\tst->st_size = ((git_off_t)nFileSizeHigh << 32) + nFileSizeLow;\n\tst->st_dev = _getdrive() - 1;\n\tst->st_rdev = st->st_dev;\n\tgit_win32__filetime_to_timespec(&ftLastAccessTime, &(st->st_atim));\n\tgit_win32__filetime_to_timespec(&ftLastWriteTime, &(st->st_mtim));\n\tgit_win32__filetime_to_timespec(&ftCreationTime, &(st->st_ctim));\n}",
          "includes": [
            "#include \"path_w32.h\"",
            "#include \"posix.h\"",
            "#include \"utf-conv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"path_w32.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n\nGIT_INLINE(void) git_win32__stat_init(\n\tstruct stat *st,\n\tDWORD dwFileAttributes,\n\tDWORD nFileSizeHigh,\n\tDWORD nFileSizeLow,\n\tFILETIME ftCreationTime,\n\tFILETIME ftLastAccessTime,\n\tFILETIME ftLastWriteTime)\n{\n\tmode_t mode = S_IREAD;\n\n\tmemset(st, 0, sizeof(struct stat));\n\n\tif (dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)\n\t\tmode |= S_IFDIR;\n\telse\n\t\tmode |= S_IFREG;\n\n\tif ((dwFileAttributes & FILE_ATTRIBUTE_READONLY) == 0)\n\t\tmode |= S_IWRITE;\n\n\tst->st_ino = 0;\n\tst->st_gid = 0;\n\tst->st_uid = 0;\n\tst->st_nlink = 1;\n\tst->st_mode = mode;\n\tst->st_size = ((git_off_t)nFileSizeHigh << 32) + nFileSizeLow;\n\tst->st_dev = _getdrive() - 1;\n\tst->st_rdev = st->st_dev;\n\tgit_win32__filetime_to_timespec(&ftLastAccessTime, &(st->st_atim));\n\tgit_win32__filetime_to_timespec(&ftLastWriteTime, &(st->st_mtim));\n\tgit_win32__filetime_to_timespec(&ftCreationTime, &(st->st_ctim));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"path_w32.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n\nGIT_INLINE(void) git_win32__file_information_to_stat(\n\tstruct stat *st,\n\tconst BY_HANDLE_FILE_INFORMATION *fileinfo)\n{\n\tgit_win32__stat_init(st,\n\t\tfileinfo->dwFileAttributes,\n\t\tfileinfo->nFileSizeHigh,\n\t\tfileinfo->nFileSizeLow,\n\t\tfileinfo->ftCreationTime,\n\t\tfileinfo->ftLastAccessTime,\n\t\tfileinfo->ftLastWriteTime);\n}"
  },
  {
    "function_name": "git_win32__stat_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.h",
    "lines": "108-140",
    "snippet": "GIT_INLINE(void) git_win32__stat_init(\n\tstruct stat *st,\n\tDWORD dwFileAttributes,\n\tDWORD nFileSizeHigh,\n\tDWORD nFileSizeLow,\n\tFILETIME ftCreationTime,\n\tFILETIME ftLastAccessTime,\n\tFILETIME ftLastWriteTime)\n{\n\tmode_t mode = S_IREAD;\n\n\tmemset(st, 0, sizeof(struct stat));\n\n\tif (dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)\n\t\tmode |= S_IFDIR;\n\telse\n\t\tmode |= S_IFREG;\n\n\tif ((dwFileAttributes & FILE_ATTRIBUTE_READONLY) == 0)\n\t\tmode |= S_IWRITE;\n\n\tst->st_ino = 0;\n\tst->st_gid = 0;\n\tst->st_uid = 0;\n\tst->st_nlink = 1;\n\tst->st_mode = mode;\n\tst->st_size = ((git_off_t)nFileSizeHigh << 32) + nFileSizeLow;\n\tst->st_dev = _getdrive() - 1;\n\tst->st_rdev = st->st_dev;\n\tgit_win32__filetime_to_timespec(&ftLastAccessTime, &(st->st_atim));\n\tgit_win32__filetime_to_timespec(&ftLastWriteTime, &(st->st_mtim));\n\tgit_win32__filetime_to_timespec(&ftCreationTime, &(st->st_ctim));\n}",
    "includes": [
      "#include \"path_w32.h\"",
      "#include \"posix.h\"",
      "#include \"utf-conv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_win32__filetime_to_timespec",
          "args": [
            "&ftCreationTime",
            "&(st->st_ctim)"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__filetime_to_timespec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.h",
          "lines": "84-96",
          "snippet": "GIT_INLINE(void) git_win32__filetime_to_timespec(\n\tconst FILETIME *ft,\n\tstruct timespec *ts)\n{\n\tlong long winTime = ((long long)ft->dwHighDateTime << 32) + ft->dwLowDateTime;\n\twinTime -= 116444736000000000LL; /* Windows to Unix Epoch conversion */\n\tts->tv_sec = (time_t)(winTime / 10000000);\n#ifdef GIT_USE_NSEC\n\tts->tv_nsec = (winTime % 10000000) * 100;\n#else\n\tts->tv_nsec = 0;\n#endif\n}",
          "includes": [
            "#include \"path_w32.h\"",
            "#include \"posix.h\"",
            "#include \"utf-conv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"path_w32.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n\nGIT_INLINE(void) git_win32__filetime_to_timespec(\n\tconst FILETIME *ft,\n\tstruct timespec *ts)\n{\n\tlong long winTime = ((long long)ft->dwHighDateTime << 32) + ft->dwLowDateTime;\n\twinTime -= 116444736000000000LL; /* Windows to Unix Epoch conversion */\n\tts->tv_sec = (time_t)(winTime / 10000000);\n#ifdef GIT_USE_NSEC\n\tts->tv_nsec = (winTime % 10000000) * 100;\n#else\n\tts->tv_nsec = 0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "_getdrive",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "st",
            "0",
            "sizeof(struct stat)"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"path_w32.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n\nGIT_INLINE(void) git_win32__stat_init(\n\tstruct stat *st,\n\tDWORD dwFileAttributes,\n\tDWORD nFileSizeHigh,\n\tDWORD nFileSizeLow,\n\tFILETIME ftCreationTime,\n\tFILETIME ftLastAccessTime,\n\tFILETIME ftLastWriteTime)\n{\n\tmode_t mode = S_IREAD;\n\n\tmemset(st, 0, sizeof(struct stat));\n\n\tif (dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)\n\t\tmode |= S_IFDIR;\n\telse\n\t\tmode |= S_IFREG;\n\n\tif ((dwFileAttributes & FILE_ATTRIBUTE_READONLY) == 0)\n\t\tmode |= S_IWRITE;\n\n\tst->st_ino = 0;\n\tst->st_gid = 0;\n\tst->st_uid = 0;\n\tst->st_nlink = 1;\n\tst->st_mode = mode;\n\tst->st_size = ((git_off_t)nFileSizeHigh << 32) + nFileSizeLow;\n\tst->st_dev = _getdrive() - 1;\n\tst->st_rdev = st->st_dev;\n\tgit_win32__filetime_to_timespec(&ftLastAccessTime, &(st->st_atim));\n\tgit_win32__filetime_to_timespec(&ftLastWriteTime, &(st->st_mtim));\n\tgit_win32__filetime_to_timespec(&ftCreationTime, &(st->st_ctim));\n}"
  },
  {
    "function_name": "git_win32__timeval_to_filetime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.h",
    "lines": "98-106",
    "snippet": "GIT_INLINE(void) git_win32__timeval_to_filetime(\n\tFILETIME *ft, const struct p_timeval tv)\n{\n\tlong long ticks = (tv.tv_sec * 10000000LL) +\n\t\t(tv.tv_usec * 10LL) + 116444736000000000LL;\n\n\tft->dwHighDateTime = ((ticks >> 32) & 0xffffffffLL);\n\tft->dwLowDateTime = (ticks & 0xffffffffLL);\n}",
    "includes": [
      "#include \"path_w32.h\"",
      "#include \"posix.h\"",
      "#include \"utf-conv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"path_w32.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n\nGIT_INLINE(void) git_win32__timeval_to_filetime(\n\tFILETIME *ft, const struct p_timeval tv)\n{\n\tlong long ticks = (tv.tv_sec * 10000000LL) +\n\t\t(tv.tv_usec * 10LL) + 116444736000000000LL;\n\n\tft->dwHighDateTime = ((ticks >> 32) & 0xffffffffLL);\n\tft->dwLowDateTime = (ticks & 0xffffffffLL);\n}"
  },
  {
    "function_name": "git_win32__filetime_to_timespec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.h",
    "lines": "84-96",
    "snippet": "GIT_INLINE(void) git_win32__filetime_to_timespec(\n\tconst FILETIME *ft,\n\tstruct timespec *ts)\n{\n\tlong long winTime = ((long long)ft->dwHighDateTime << 32) + ft->dwLowDateTime;\n\twinTime -= 116444736000000000LL; /* Windows to Unix Epoch conversion */\n\tts->tv_sec = (time_t)(winTime / 10000000);\n#ifdef GIT_USE_NSEC\n\tts->tv_nsec = (winTime % 10000000) * 100;\n#else\n\tts->tv_nsec = 0;\n#endif\n}",
    "includes": [
      "#include \"path_w32.h\"",
      "#include \"posix.h\"",
      "#include \"utf-conv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "winTime / 10000000"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"path_w32.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n\nGIT_INLINE(void) git_win32__filetime_to_timespec(\n\tconst FILETIME *ft,\n\tstruct timespec *ts)\n{\n\tlong long winTime = ((long long)ft->dwHighDateTime << 32) + ft->dwLowDateTime;\n\twinTime -= 116444736000000000LL; /* Windows to Unix Epoch conversion */\n\tts->tv_sec = (time_t)(winTime / 10000000);\n#ifdef GIT_USE_NSEC\n\tts->tv_nsec = (winTime % 10000000) * 100;\n#else\n\tts->tv_nsec = 0;\n#endif\n}"
  },
  {
    "function_name": "git_win32__isalpha",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.h",
    "lines": "27-30",
    "snippet": "GIT_INLINE(bool) git_win32__isalpha(wchar_t c)\n{\n\treturn ((c >= L'A' && c <= L'Z') || (c >= L'a' && c <= L'z'));\n}",
    "includes": [
      "#include \"path_w32.h\"",
      "#include \"posix.h\"",
      "#include \"utf-conv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"path_w32.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n\nGIT_INLINE(bool) git_win32__isalpha(wchar_t c)\n{\n\treturn ((c >= L'A' && c <= L'Z') || (c >= L'a' && c <= L'z'));\n}"
  }
]