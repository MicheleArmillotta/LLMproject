[
  {
    "function_name": "git_xdiff_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
    "lines": "226-248",
    "snippet": "void git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}",
    "includes": [
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nvoid git_xdiff_init(git_xdiff_output *xo, const git_diff_options *opts)\n{\n\tuint32_t flags = opts ? opts->flags : 0;\n\n\txo->output.diff_cb = git_xdiff;\n\n\txo->config.ctxlen = opts ? opts->context_lines : 3;\n\txo->config.interhunkctxlen = opts ? opts->interhunk_lines : 0;\n\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE)\n\t\txo->params.flags |= XDF_WHITESPACE_FLAGS;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_CHANGE)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_CHANGE;\n\tif (flags & GIT_DIFF_IGNORE_WHITESPACE_EOL)\n\t\txo->params.flags |= XDF_IGNORE_WHITESPACE_AT_EOL;\n\n\tif (flags & GIT_DIFF_PATIENCE)\n\t\txo->params.flags |= XDF_PATIENCE_DIFF;\n\tif (flags & GIT_DIFF_MINIMAL)\n\t\txo->params.flags |= XDF_NEED_MINIMAL;\n\n\txo->callback.outf = git_xdiff_cb;\n}"
  },
  {
    "function_name": "git_xdiff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
    "lines": "184-224",
    "snippet": "static int git_xdiff(git_diff_output *output, git_patch *patch)\n{\n\tgit_xdiff_output *xo = (git_xdiff_output *)output;\n\tgit_xdiff_info info;\n\tgit_diff_find_context_payload findctxt;\n\n\tmemset(&info, 0, sizeof(info));\n\tinfo.patch = patch;\n\tinfo.xo    = xo;\n\n\txo->callback.priv = &info;\n\n\tgit_diff_find_context_init(\n\t\t&xo->config.find_func, &findctxt, git_patch__driver(patch));\n\txo->config.find_func_priv = &findctxt;\n\n\tif (xo->config.find_func != NULL)\n\t\txo->config.flags |= XDL_EMIT_FUNCNAMES;\n\telse\n\t\txo->config.flags &= ~XDL_EMIT_FUNCNAMES;\n\n\t/* TODO: check ofile.opts_flags to see if driver-specific per-file\n\t * updates are needed to xo->params.flags\n\t */\n\n\tgit_patch__old_data(&info.xd_old_data.ptr, &info.xd_old_data.size, patch);\n\tgit_patch__new_data(&info.xd_new_data.ptr, &info.xd_new_data.size, patch);\n\n\tif (info.xd_old_data.size > GIT_XDIFF_MAX_SIZE ||\n\t\tinfo.xd_new_data.size > GIT_XDIFF_MAX_SIZE) {\n\t\tgiterr_set(GITERR_INVALID, \"files too large for diff\");\n\t\treturn -1;\n\t}\n\n\txdl_diff(&info.xd_old_data, &info.xd_new_data,\n\t\t&xo->params, &xo->config, &xo->callback);\n\n\tgit_diff_find_context_clear(&findctxt);\n\n\treturn xo->output.error;\n}",
    "includes": [
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_diff_find_context_clear",
          "args": [
            "&findctxt"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_find_context_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "516-522",
          "snippet": "void git_diff_find_context_clear(git_diff_find_context_payload *payload)\n{\n\tif (payload) {\n\t\tgit_buf_free(&payload->line);\n\t\tpayload->driver = NULL;\n\t}\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_find_context_clear(git_diff_find_context_payload *payload)\n{\n\tif (payload) {\n\t\tgit_buf_free(&payload->line);\n\t\tpayload->driver = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdl_diff",
          "args": [
            "&info.xd_old_data",
            "&info.xd_new_data",
            "&xo->params",
            "&xo->config",
            "&xo->callback"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "xdl_diff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/xdiff/xdiffi.c",
          "lines": "586-618",
          "snippet": "int xdl_diff(mmfile_t *mf1, mmfile_t *mf2, xpparam_t const *xpp,\n\t     xdemitconf_t const *xecfg, xdemitcb_t *ecb) {\n\txdchange_t *xscr;\n\txdfenv_t xe;\n\temit_func_t ef = xecfg->hunk_func ? xdl_call_hunk_func : xdl_emit_diff;\n\n\tif (xdl_do_diff(mf1, mf2, xpp, &xe) < 0) {\n\n\t\treturn -1;\n\t}\n\tif (xdl_change_compact(&xe.xdf1, &xe.xdf2, xpp->flags) < 0 ||\n\t    xdl_change_compact(&xe.xdf2, &xe.xdf1, xpp->flags) < 0 ||\n\t    xdl_build_script(&xe, &xscr) < 0) {\n\n\t\txdl_free_env(&xe);\n\t\treturn -1;\n\t}\n\tif (xscr) {\n\t\tif (xpp->flags & XDF_IGNORE_BLANK_LINES)\n\t\t\txdl_mark_ignorable(xscr, &xe, xpp->flags);\n\n\t\tif (ef(&xe, xscr, ecb, xecfg) < 0) {\n\n\t\t\txdl_free_script(xscr);\n\t\t\txdl_free_env(&xe);\n\t\t\treturn -1;\n\t\t}\n\t\txdl_free_script(xscr);\n\t}\n\txdl_free_env(&xe);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"integer.h\"",
            "#include \"common.h\"",
            "#include \"xinclude.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"integer.h\"\n#include \"common.h\"\n#include \"xinclude.h\"\n\nint xdl_diff(mmfile_t *mf1, mmfile_t *mf2, xpparam_t const *xpp,\n\t     xdemitconf_t const *xecfg, xdemitcb_t *ecb) {\n\txdchange_t *xscr;\n\txdfenv_t xe;\n\temit_func_t ef = xecfg->hunk_func ? xdl_call_hunk_func : xdl_emit_diff;\n\n\tif (xdl_do_diff(mf1, mf2, xpp, &xe) < 0) {\n\n\t\treturn -1;\n\t}\n\tif (xdl_change_compact(&xe.xdf1, &xe.xdf2, xpp->flags) < 0 ||\n\t    xdl_change_compact(&xe.xdf2, &xe.xdf1, xpp->flags) < 0 ||\n\t    xdl_build_script(&xe, &xscr) < 0) {\n\n\t\txdl_free_env(&xe);\n\t\treturn -1;\n\t}\n\tif (xscr) {\n\t\tif (xpp->flags & XDF_IGNORE_BLANK_LINES)\n\t\t\txdl_mark_ignorable(xscr, &xe, xpp->flags);\n\n\t\tif (ef(&xe, xscr, ecb, xecfg) < 0) {\n\n\t\t\txdl_free_script(xscr);\n\t\t\txdl_free_env(&xe);\n\t\t\treturn -1;\n\t\t}\n\t\txdl_free_script(xscr);\n\t}\n\txdl_free_env(&xe);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"files too large for diff\""
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_patch__new_data",
          "args": [
            "&info.xd_new_data.ptr",
            "&info.xd_new_data.size",
            "patch"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch__new_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "959-964",
          "snippet": "void git_patch__new_data(\n\tchar **ptr, size_t *len, git_patch *patch)\n{\n\t*ptr = patch->nfile.map.data;\n\t*len = patch->nfile.map.len;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch__new_data(\n\tchar **ptr, size_t *len, git_patch *patch)\n{\n\t*ptr = patch->nfile.map.data;\n\t*len = patch->nfile.map.len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_patch__old_data",
          "args": [
            "&info.xd_old_data.ptr",
            "&info.xd_old_data.size",
            "patch"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch__old_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "952-957",
          "snippet": "void git_patch__old_data(\n\tchar **ptr, size_t *len, git_patch *patch)\n{\n\t*ptr = patch->ofile.map.data;\n\t*len = patch->ofile.map.len;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nvoid git_patch__old_data(\n\tchar **ptr, size_t *len, git_patch *patch)\n{\n\t*ptr = patch->ofile.map.data;\n\t*len = patch->ofile.map.len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_diff_find_context_init",
          "args": [
            "&xo->config.find_func",
            "&findctxt",
            "git_patch__driver(patch)"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_find_context_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "500-514",
          "snippet": "void git_diff_find_context_init(\n\tgit_diff_find_context_fn *findfn_out,\n\tgit_diff_find_context_payload *payload_out,\n\tgit_diff_driver *driver)\n{\n\t*findfn_out = driver ? diff_context_find : NULL;\n\n\tmemset(payload_out, 0, sizeof(*payload_out));\n\tif (driver) {\n\t\tpayload_out->driver = driver;\n\t\tpayload_out->match_line = (driver->type == DIFF_DRIVER_PATTERNLIST) ?\n\t\t\tdiff_context_line__pattern_match : diff_context_line__simple;\n\t\tgit_buf_init(&payload_out->line, 0);\n\t}\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_find_context_init(\n\tgit_diff_find_context_fn *findfn_out,\n\tgit_diff_find_context_payload *payload_out,\n\tgit_diff_driver *driver)\n{\n\t*findfn_out = driver ? diff_context_find : NULL;\n\n\tmemset(payload_out, 0, sizeof(*payload_out));\n\tif (driver) {\n\t\tpayload_out->driver = driver;\n\t\tpayload_out->match_line = (driver->type == DIFF_DRIVER_PATTERNLIST) ?\n\t\t\tdiff_context_line__pattern_match : diff_context_line__simple;\n\t\tgit_buf_init(&payload_out->line, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_patch__driver",
          "args": [
            "patch"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch__driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "946-950",
          "snippet": "git_diff_driver *git_patch__driver(git_patch *patch)\n{\n\t/* ofile driver is representative for whole patch */\n\treturn patch->ofile.driver;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\ngit_diff_driver *git_patch__driver(git_patch *patch)\n{\n\t/* ofile driver is representative for whole patch */\n\treturn patch->ofile.driver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&info",
            "0",
            "sizeof(info)"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nstatic int git_xdiff(git_diff_output *output, git_patch *patch)\n{\n\tgit_xdiff_output *xo = (git_xdiff_output *)output;\n\tgit_xdiff_info info;\n\tgit_diff_find_context_payload findctxt;\n\n\tmemset(&info, 0, sizeof(info));\n\tinfo.patch = patch;\n\tinfo.xo    = xo;\n\n\txo->callback.priv = &info;\n\n\tgit_diff_find_context_init(\n\t\t&xo->config.find_func, &findctxt, git_patch__driver(patch));\n\txo->config.find_func_priv = &findctxt;\n\n\tif (xo->config.find_func != NULL)\n\t\txo->config.flags |= XDL_EMIT_FUNCNAMES;\n\telse\n\t\txo->config.flags &= ~XDL_EMIT_FUNCNAMES;\n\n\t/* TODO: check ofile.opts_flags to see if driver-specific per-file\n\t * updates are needed to xo->params.flags\n\t */\n\n\tgit_patch__old_data(&info.xd_old_data.ptr, &info.xd_old_data.size, patch);\n\tgit_patch__new_data(&info.xd_new_data.ptr, &info.xd_new_data.size, patch);\n\n\tif (info.xd_old_data.size > GIT_XDIFF_MAX_SIZE ||\n\t\tinfo.xd_new_data.size > GIT_XDIFF_MAX_SIZE) {\n\t\tgiterr_set(GITERR_INVALID, \"files too large for diff\");\n\t\treturn -1;\n\t}\n\n\txdl_diff(&info.xd_old_data, &info.xd_new_data,\n\t\t&xo->params, &xo->config, &xo->callback);\n\n\tgit_diff_find_context_clear(&findctxt);\n\n\treturn xo->output.error;\n}"
  },
  {
    "function_name": "git_xdiff_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
    "lines": "110-182",
    "snippet": "static int git_xdiff_cb(void *priv, mmbuffer_t *bufs, int len)\n{\n\tgit_xdiff_info *info = priv;\n\tgit_patch *patch = info->patch;\n\tconst git_diff_delta *delta = git_patch_get_delta(patch);\n\tgit_diff_output *output = &info->xo->output;\n\tgit_diff_line line;\n\n\tif (len == 1) {\n\t\toutput->error = git_xdiff_parse_hunk(&info->hunk, bufs[0].ptr);\n\t\tif (output->error < 0)\n\t\t\treturn output->error;\n\n\t\tinfo->hunk.header_len = bufs[0].size;\n\t\tif (info->hunk.header_len >= sizeof(info->hunk.header))\n\t\t\tinfo->hunk.header_len = sizeof(info->hunk.header) - 1;\n\t\tmemcpy(info->hunk.header, bufs[0].ptr, info->hunk.header_len);\n\t\tinfo->hunk.header[info->hunk.header_len] = '\\0';\n\n\t\tif (output->hunk_cb != NULL &&\n\t\t\t(output->error = output->hunk_cb(\n\t\t\t\tdelta, &info->hunk, output->payload)))\n\t\t\treturn output->error;\n\n\t\tinfo->old_lineno = info->hunk.old_start;\n\t\tinfo->new_lineno = info->hunk.new_start;\n\t}\n\n\tif (len == 2 || len == 3) {\n\t\t/* expect \" \"/\"-\"/\"+\", then data */\n\t\tline.origin =\n\t\t\t(*bufs[0].ptr == '+') ? GIT_DIFF_LINE_ADDITION :\n\t\t\t(*bufs[0].ptr == '-') ? GIT_DIFF_LINE_DELETION :\n\t\t\tGIT_DIFF_LINE_CONTEXT;\n\n\t\tif (line.origin == GIT_DIFF_LINE_ADDITION)\n\t\t\tline.content_offset = bufs[1].ptr - info->xd_new_data.ptr;\n\t\telse if (line.origin == GIT_DIFF_LINE_DELETION)\n\t\t\tline.content_offset = bufs[1].ptr - info->xd_old_data.ptr;\n\t\telse\n\t\t\tline.content_offset = -1;\n\n\t\toutput->error = diff_update_lines(\n\t\t\tinfo, &line, bufs[1].ptr, bufs[1].size);\n\n\t\tif (!output->error && output->data_cb != NULL)\n\t\t\toutput->error = output->data_cb(\n\t\t\t\tdelta, &info->hunk, &line, output->payload);\n\t}\n\n\tif (len == 3 && !output->error) {\n\t\t/* If we have a '+' and a third buf, then we have added a line\n\t\t * without a newline and the old code had one, so DEL_EOFNL.\n\t\t * If we have a '-' and a third buf, then we have removed a line\n\t\t * with out a newline but added a blank line, so ADD_EOFNL.\n\t\t */\n\t\tline.origin =\n\t\t\t(*bufs[0].ptr == '+') ? GIT_DIFF_LINE_DEL_EOFNL :\n\t\t\t(*bufs[0].ptr == '-') ? GIT_DIFF_LINE_ADD_EOFNL :\n\t\t\tGIT_DIFF_LINE_CONTEXT_EOFNL;\n\n\t\tline.content_offset = -1;\n\n\t\toutput->error = diff_update_lines(\n\t\t\tinfo, &line, bufs[2].ptr, bufs[2].size);\n\n\t\tif (!output->error && output->data_cb != NULL)\n\t\t\toutput->error = output->data_cb(\n\t\t\t\tdelta, &info->hunk, &line, output->payload);\n\t}\n\n\treturn output->error;\n}",
    "includes": [
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "output->data_cb",
          "args": [
            "delta",
            "&info->hunk",
            "&line",
            "output->payload"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diff_update_lines",
          "args": [
            "info",
            "&line",
            "bufs[2].ptr",
            "bufs[2].size"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "diff_update_lines",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
          "lines": "65-108",
          "snippet": "static int diff_update_lines(\n\tgit_xdiff_info *info,\n\tgit_diff_line *line,\n\tconst char *content,\n\tsize_t content_len)\n{\n\tconst char *scan = content, *scan_end = content + content_len;\n\n\tfor (line->num_lines = 0; scan < scan_end; ++scan)\n\t\tif (*scan == '\\n')\n\t\t\t++line->num_lines;\n\n\tline->content     = content;\n\tline->content_len = content_len;\n\n\t/* expect \" \"/\"-\"/\"+\", then data */\n\tswitch (line->origin) {\n\tcase GIT_DIFF_LINE_ADDITION:\n\tcase GIT_DIFF_LINE_DEL_EOFNL:\n\t\tline->old_lineno = -1;\n\t\tline->new_lineno = info->new_lineno;\n\t\tinfo->new_lineno += (int)line->num_lines;\n\t\tbreak;\n\tcase GIT_DIFF_LINE_DELETION:\n\tcase GIT_DIFF_LINE_ADD_EOFNL:\n\t\tline->old_lineno = info->old_lineno;\n\t\tline->new_lineno = -1;\n\t\tinfo->old_lineno += (int)line->num_lines;\n\t\tbreak;\n\tcase GIT_DIFF_LINE_CONTEXT:\n\tcase GIT_DIFF_LINE_CONTEXT_EOFNL:\n\t\tline->old_lineno = info->old_lineno;\n\t\tline->new_lineno = info->new_lineno;\n\t\tinfo->old_lineno += (int)line->num_lines;\n\t\tinfo->new_lineno += (int)line->num_lines;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Unknown diff line origin %02x\",\n\t\t\t(unsigned int)line->origin);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nstatic int diff_update_lines(\n\tgit_xdiff_info *info,\n\tgit_diff_line *line,\n\tconst char *content,\n\tsize_t content_len)\n{\n\tconst char *scan = content, *scan_end = content + content_len;\n\n\tfor (line->num_lines = 0; scan < scan_end; ++scan)\n\t\tif (*scan == '\\n')\n\t\t\t++line->num_lines;\n\n\tline->content     = content;\n\tline->content_len = content_len;\n\n\t/* expect \" \"/\"-\"/\"+\", then data */\n\tswitch (line->origin) {\n\tcase GIT_DIFF_LINE_ADDITION:\n\tcase GIT_DIFF_LINE_DEL_EOFNL:\n\t\tline->old_lineno = -1;\n\t\tline->new_lineno = info->new_lineno;\n\t\tinfo->new_lineno += (int)line->num_lines;\n\t\tbreak;\n\tcase GIT_DIFF_LINE_DELETION:\n\tcase GIT_DIFF_LINE_ADD_EOFNL:\n\t\tline->old_lineno = info->old_lineno;\n\t\tline->new_lineno = -1;\n\t\tinfo->old_lineno += (int)line->num_lines;\n\t\tbreak;\n\tcase GIT_DIFF_LINE_CONTEXT:\n\tcase GIT_DIFF_LINE_CONTEXT_EOFNL:\n\t\tline->old_lineno = info->old_lineno;\n\t\tline->new_lineno = info->new_lineno;\n\t\tinfo->old_lineno += (int)line->num_lines;\n\t\tinfo->new_lineno += (int)line->num_lines;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Unknown diff line origin %02x\",\n\t\t\t(unsigned int)line->origin);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "output->data_cb",
          "args": [
            "delta",
            "&info->hunk",
            "&line",
            "output->payload"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output->hunk_cb",
          "args": [
            "delta",
            "&info->hunk",
            "output->payload"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "info->hunk.header",
            "bufs[0].ptr",
            "info->hunk.header_len"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_xdiff_parse_hunk",
          "args": [
            "&info->hunk",
            "bufs[0].ptr"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "git_xdiff_parse_hunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
          "lines": "28-55",
          "snippet": "static int git_xdiff_parse_hunk(git_diff_hunk *hunk, const char *header)\n{\n\t/* expect something of the form \"@@ -%d[,%d] +%d[,%d] @@\" */\n\tif (*header != '@')\n\t\tgoto fail;\n\tif (git_xdiff_scan_int(&header, &hunk->old_start) < 0)\n\t\tgoto fail;\n\tif (*header == ',') {\n\t\tif (git_xdiff_scan_int(&header, &hunk->old_lines) < 0)\n\t\t\tgoto fail;\n\t} else\n\t\thunk->old_lines = 1;\n\tif (git_xdiff_scan_int(&header, &hunk->new_start) < 0)\n\t\tgoto fail;\n\tif (*header == ',') {\n\t\tif (git_xdiff_scan_int(&header, &hunk->new_lines) < 0)\n\t\t\tgoto fail;\n\t} else\n\t\thunk->new_lines = 1;\n\tif (hunk->old_start < 0 || hunk->new_start < 0)\n\t\tgoto fail;\n\n\treturn 0;\n\nfail:\n\tgiterr_set(GITERR_INVALID, \"Malformed hunk header from xdiff\");\n\treturn -1;\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nstatic int git_xdiff_parse_hunk(git_diff_hunk *hunk, const char *header)\n{\n\t/* expect something of the form \"@@ -%d[,%d] +%d[,%d] @@\" */\n\tif (*header != '@')\n\t\tgoto fail;\n\tif (git_xdiff_scan_int(&header, &hunk->old_start) < 0)\n\t\tgoto fail;\n\tif (*header == ',') {\n\t\tif (git_xdiff_scan_int(&header, &hunk->old_lines) < 0)\n\t\t\tgoto fail;\n\t} else\n\t\thunk->old_lines = 1;\n\tif (git_xdiff_scan_int(&header, &hunk->new_start) < 0)\n\t\tgoto fail;\n\tif (*header == ',') {\n\t\tif (git_xdiff_scan_int(&header, &hunk->new_lines) < 0)\n\t\t\tgoto fail;\n\t} else\n\t\thunk->new_lines = 1;\n\tif (hunk->old_start < 0 || hunk->new_start < 0)\n\t\tgoto fail;\n\n\treturn 0;\n\nfail:\n\tgiterr_set(GITERR_INVALID, \"Malformed hunk header from xdiff\");\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_patch_get_delta",
          "args": [
            "patch"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "git_patch_get_delta",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_patch.c",
          "lines": "794-798",
          "snippet": "const git_diff_delta *git_patch_get_delta(const git_patch *patch)\n{\n\tassert(patch);\n\treturn patch->delta;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"zstream.h\"",
            "#include \"delta.h\"",
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_file.h\"",
            "#include \"diff.h\"",
            "#include \"git2/blob.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void diff_output_to_patch(git_diff_output *, git_patch *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"zstream.h\"\n#include \"delta.h\"\n#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff_file.h\"\n#include \"diff.h\"\n#include \"git2/blob.h\"\n#include \"common.h\"\n\nstatic void diff_output_to_patch(git_diff_output *, git_patch *);\n\nconst git_diff_delta *git_patch_get_delta(const git_patch *patch)\n{\n\tassert(patch);\n\treturn patch->delta;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nstatic int git_xdiff_cb(void *priv, mmbuffer_t *bufs, int len)\n{\n\tgit_xdiff_info *info = priv;\n\tgit_patch *patch = info->patch;\n\tconst git_diff_delta *delta = git_patch_get_delta(patch);\n\tgit_diff_output *output = &info->xo->output;\n\tgit_diff_line line;\n\n\tif (len == 1) {\n\t\toutput->error = git_xdiff_parse_hunk(&info->hunk, bufs[0].ptr);\n\t\tif (output->error < 0)\n\t\t\treturn output->error;\n\n\t\tinfo->hunk.header_len = bufs[0].size;\n\t\tif (info->hunk.header_len >= sizeof(info->hunk.header))\n\t\t\tinfo->hunk.header_len = sizeof(info->hunk.header) - 1;\n\t\tmemcpy(info->hunk.header, bufs[0].ptr, info->hunk.header_len);\n\t\tinfo->hunk.header[info->hunk.header_len] = '\\0';\n\n\t\tif (output->hunk_cb != NULL &&\n\t\t\t(output->error = output->hunk_cb(\n\t\t\t\tdelta, &info->hunk, output->payload)))\n\t\t\treturn output->error;\n\n\t\tinfo->old_lineno = info->hunk.old_start;\n\t\tinfo->new_lineno = info->hunk.new_start;\n\t}\n\n\tif (len == 2 || len == 3) {\n\t\t/* expect \" \"/\"-\"/\"+\", then data */\n\t\tline.origin =\n\t\t\t(*bufs[0].ptr == '+') ? GIT_DIFF_LINE_ADDITION :\n\t\t\t(*bufs[0].ptr == '-') ? GIT_DIFF_LINE_DELETION :\n\t\t\tGIT_DIFF_LINE_CONTEXT;\n\n\t\tif (line.origin == GIT_DIFF_LINE_ADDITION)\n\t\t\tline.content_offset = bufs[1].ptr - info->xd_new_data.ptr;\n\t\telse if (line.origin == GIT_DIFF_LINE_DELETION)\n\t\t\tline.content_offset = bufs[1].ptr - info->xd_old_data.ptr;\n\t\telse\n\t\t\tline.content_offset = -1;\n\n\t\toutput->error = diff_update_lines(\n\t\t\tinfo, &line, bufs[1].ptr, bufs[1].size);\n\n\t\tif (!output->error && output->data_cb != NULL)\n\t\t\toutput->error = output->data_cb(\n\t\t\t\tdelta, &info->hunk, &line, output->payload);\n\t}\n\n\tif (len == 3 && !output->error) {\n\t\t/* If we have a '+' and a third buf, then we have added a line\n\t\t * without a newline and the old code had one, so DEL_EOFNL.\n\t\t * If we have a '-' and a third buf, then we have removed a line\n\t\t * with out a newline but added a blank line, so ADD_EOFNL.\n\t\t */\n\t\tline.origin =\n\t\t\t(*bufs[0].ptr == '+') ? GIT_DIFF_LINE_DEL_EOFNL :\n\t\t\t(*bufs[0].ptr == '-') ? GIT_DIFF_LINE_ADD_EOFNL :\n\t\t\tGIT_DIFF_LINE_CONTEXT_EOFNL;\n\n\t\tline.content_offset = -1;\n\n\t\toutput->error = diff_update_lines(\n\t\t\tinfo, &line, bufs[2].ptr, bufs[2].size);\n\n\t\tif (!output->error && output->data_cb != NULL)\n\t\t\toutput->error = output->data_cb(\n\t\t\t\tdelta, &info->hunk, &line, output->payload);\n\t}\n\n\treturn output->error;\n}"
  },
  {
    "function_name": "diff_update_lines",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
    "lines": "65-108",
    "snippet": "static int diff_update_lines(\n\tgit_xdiff_info *info,\n\tgit_diff_line *line,\n\tconst char *content,\n\tsize_t content_len)\n{\n\tconst char *scan = content, *scan_end = content + content_len;\n\n\tfor (line->num_lines = 0; scan < scan_end; ++scan)\n\t\tif (*scan == '\\n')\n\t\t\t++line->num_lines;\n\n\tline->content     = content;\n\tline->content_len = content_len;\n\n\t/* expect \" \"/\"-\"/\"+\", then data */\n\tswitch (line->origin) {\n\tcase GIT_DIFF_LINE_ADDITION:\n\tcase GIT_DIFF_LINE_DEL_EOFNL:\n\t\tline->old_lineno = -1;\n\t\tline->new_lineno = info->new_lineno;\n\t\tinfo->new_lineno += (int)line->num_lines;\n\t\tbreak;\n\tcase GIT_DIFF_LINE_DELETION:\n\tcase GIT_DIFF_LINE_ADD_EOFNL:\n\t\tline->old_lineno = info->old_lineno;\n\t\tline->new_lineno = -1;\n\t\tinfo->old_lineno += (int)line->num_lines;\n\t\tbreak;\n\tcase GIT_DIFF_LINE_CONTEXT:\n\tcase GIT_DIFF_LINE_CONTEXT_EOFNL:\n\t\tline->old_lineno = info->old_lineno;\n\t\tline->new_lineno = info->new_lineno;\n\t\tinfo->old_lineno += (int)line->num_lines;\n\t\tinfo->new_lineno += (int)line->num_lines;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Unknown diff line origin %02x\",\n\t\t\t(unsigned int)line->origin);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Unknown diff line origin %02x\"",
            "(unsigned int)line->origin"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nstatic int diff_update_lines(\n\tgit_xdiff_info *info,\n\tgit_diff_line *line,\n\tconst char *content,\n\tsize_t content_len)\n{\n\tconst char *scan = content, *scan_end = content + content_len;\n\n\tfor (line->num_lines = 0; scan < scan_end; ++scan)\n\t\tif (*scan == '\\n')\n\t\t\t++line->num_lines;\n\n\tline->content     = content;\n\tline->content_len = content_len;\n\n\t/* expect \" \"/\"-\"/\"+\", then data */\n\tswitch (line->origin) {\n\tcase GIT_DIFF_LINE_ADDITION:\n\tcase GIT_DIFF_LINE_DEL_EOFNL:\n\t\tline->old_lineno = -1;\n\t\tline->new_lineno = info->new_lineno;\n\t\tinfo->new_lineno += (int)line->num_lines;\n\t\tbreak;\n\tcase GIT_DIFF_LINE_DELETION:\n\tcase GIT_DIFF_LINE_ADD_EOFNL:\n\t\tline->old_lineno = info->old_lineno;\n\t\tline->new_lineno = -1;\n\t\tinfo->old_lineno += (int)line->num_lines;\n\t\tbreak;\n\tcase GIT_DIFF_LINE_CONTEXT:\n\tcase GIT_DIFF_LINE_CONTEXT_EOFNL:\n\t\tline->old_lineno = info->old_lineno;\n\t\tline->new_lineno = info->new_lineno;\n\t\tinfo->old_lineno += (int)line->num_lines;\n\t\tinfo->new_lineno += (int)line->num_lines;\n\t\tbreak;\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Unknown diff line origin %02x\",\n\t\t\t(unsigned int)line->origin);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_xdiff_parse_hunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
    "lines": "28-55",
    "snippet": "static int git_xdiff_parse_hunk(git_diff_hunk *hunk, const char *header)\n{\n\t/* expect something of the form \"@@ -%d[,%d] +%d[,%d] @@\" */\n\tif (*header != '@')\n\t\tgoto fail;\n\tif (git_xdiff_scan_int(&header, &hunk->old_start) < 0)\n\t\tgoto fail;\n\tif (*header == ',') {\n\t\tif (git_xdiff_scan_int(&header, &hunk->old_lines) < 0)\n\t\t\tgoto fail;\n\t} else\n\t\thunk->old_lines = 1;\n\tif (git_xdiff_scan_int(&header, &hunk->new_start) < 0)\n\t\tgoto fail;\n\tif (*header == ',') {\n\t\tif (git_xdiff_scan_int(&header, &hunk->new_lines) < 0)\n\t\t\tgoto fail;\n\t} else\n\t\thunk->new_lines = 1;\n\tif (hunk->old_start < 0 || hunk->new_start < 0)\n\t\tgoto fail;\n\n\treturn 0;\n\nfail:\n\tgiterr_set(GITERR_INVALID, \"Malformed hunk header from xdiff\");\n\treturn -1;\n}",
    "includes": [
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Malformed hunk header from xdiff\""
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_xdiff_scan_int",
          "args": [
            "&header",
            "&hunk->new_lines"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "git_xdiff_scan_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
          "lines": "14-26",
          "snippet": "static int git_xdiff_scan_int(const char **str, int *value)\n{\n\tconst char *scan = *str;\n\tint v = 0, digits = 0;\n\t/* find next digit */\n\tfor (scan = *str; *scan && !git__isdigit(*scan); scan++);\n\t/* parse next number */\n\tfor (; git__isdigit(*scan); scan++, digits++)\n\t\tv = (v * 10) + (*scan - '0');\n\t*str = scan;\n\t*value = v;\n\treturn (digits > 0) ? 0 : -1;\n}",
          "includes": [
            "#include \"diff_xdiff.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff.h\"",
            "#include \"common.h\"",
            "#include \"git2/errors.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nstatic int git_xdiff_scan_int(const char **str, int *value)\n{\n\tconst char *scan = *str;\n\tint v = 0, digits = 0;\n\t/* find next digit */\n\tfor (scan = *str; *scan && !git__isdigit(*scan); scan++);\n\t/* parse next number */\n\tfor (; git__isdigit(*scan); scan++, digits++)\n\t\tv = (v * 10) + (*scan - '0');\n\t*str = scan;\n\t*value = v;\n\treturn (digits > 0) ? 0 : -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nstatic int git_xdiff_parse_hunk(git_diff_hunk *hunk, const char *header)\n{\n\t/* expect something of the form \"@@ -%d[,%d] +%d[,%d] @@\" */\n\tif (*header != '@')\n\t\tgoto fail;\n\tif (git_xdiff_scan_int(&header, &hunk->old_start) < 0)\n\t\tgoto fail;\n\tif (*header == ',') {\n\t\tif (git_xdiff_scan_int(&header, &hunk->old_lines) < 0)\n\t\t\tgoto fail;\n\t} else\n\t\thunk->old_lines = 1;\n\tif (git_xdiff_scan_int(&header, &hunk->new_start) < 0)\n\t\tgoto fail;\n\tif (*header == ',') {\n\t\tif (git_xdiff_scan_int(&header, &hunk->new_lines) < 0)\n\t\t\tgoto fail;\n\t} else\n\t\thunk->new_lines = 1;\n\tif (hunk->old_start < 0 || hunk->new_start < 0)\n\t\tgoto fail;\n\n\treturn 0;\n\nfail:\n\tgiterr_set(GITERR_INVALID, \"Malformed hunk header from xdiff\");\n\treturn -1;\n}"
  },
  {
    "function_name": "git_xdiff_scan_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_xdiff.c",
    "lines": "14-26",
    "snippet": "static int git_xdiff_scan_int(const char **str, int *value)\n{\n\tconst char *scan = *str;\n\tint v = 0, digits = 0;\n\t/* find next digit */\n\tfor (scan = *str; *scan && !git__isdigit(*scan); scan++);\n\t/* parse next number */\n\tfor (; git__isdigit(*scan); scan++, digits++)\n\t\tv = (v * 10) + (*scan - '0');\n\t*str = scan;\n\t*value = v;\n\treturn (digits > 0) ? 0 : -1;\n}",
    "includes": [
      "#include \"diff_xdiff.h\"",
      "#include \"diff_patch.h\"",
      "#include \"diff_driver.h\"",
      "#include \"diff.h\"",
      "#include \"common.h\"",
      "#include \"git2/errors.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__isdigit",
          "args": [
            "*scan"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "git__isdigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "449-452",
          "snippet": "GIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isdigit(int c)\n{\n\treturn (c >= '0' && c <= '9');\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"diff_xdiff.h\"\n#include \"diff_patch.h\"\n#include \"diff_driver.h\"\n#include \"diff.h\"\n#include \"common.h\"\n#include \"git2/errors.h\"\n\nstatic int git_xdiff_scan_int(const char **str, int *value)\n{\n\tconst char *scan = *str;\n\tint v = 0, digits = 0;\n\t/* find next digit */\n\tfor (scan = *str; *scan && !git__isdigit(*scan); scan++);\n\t/* parse next number */\n\tfor (; git__isdigit(*scan); scan++, digits++)\n\t\tv = (v * 10) + (*scan - '0');\n\t*str = scan;\n\t*value = v;\n\treturn (digits > 0) ? 0 : -1;\n}"
  }
]