[
  {
    "function_name": "git__getenv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "799-809",
    "snippet": "int git__getenv(git_buf *out, const char *name)\n{\n\tconst char *val = getenv(name);\n\n\tgit_buf_clear(out);\n\n\tif (!val)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn git_buf_puts(out, val);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "out",
            "val"
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "name"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__getenv(git_buf *out, const char *name)\n{\n\tconst char *val = getenv(name);\n\n\tgit_buf_clear(out);\n\n\tif (!val)\n\t\treturn GIT_ENOTFOUND;\n\n\treturn git_buf_puts(out, val);\n}"
  },
  {
    "function_name": "git__getenv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "769-797",
    "snippet": "int git__getenv(git_buf *out, const char *name)\n{\n\twchar_t *wide_name = NULL, *wide_value = NULL;\n\tDWORD value_len;\n\tint error = -1;\n\n\tgit_buf_clear(out);\n\n\tif (git__utf8_to_16_alloc(&wide_name, name) < 0)\n\t\treturn -1;\n\n\tif ((value_len = GetEnvironmentVariableW(wide_name, NULL, 0)) > 0) {\n\t\twide_value = git__malloc(value_len * sizeof(wchar_t));\n\t\tGITERR_CHECK_ALLOC(wide_value);\n\n\t\tvalue_len = GetEnvironmentVariableW(wide_name, wide_value, value_len);\n\t}\n\n\tif (value_len)\n\t\terror = git_buf_put_w(out, wide_value, value_len);\n\telse if (GetLastError() == ERROR_ENVVAR_NOT_FOUND)\n\t\terror = GIT_ENOTFOUND;\n\telse\n\t\tgiterr_set(GITERR_OS, \"could not read environment variable '%s'\", name);\n\n\tgit__free(wide_name);\n\tgit__free(wide_value);\n\treturn error;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "wide_value"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"could not read environment variable '%s'\"",
            "name"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_put_w",
          "args": [
            "out",
            "wide_value",
            "value_len"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put_w",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_buffer.c",
          "lines": "23-54",
          "snippet": "int git_buf_put_w(git_buf *buf, const wchar_t *string_w, size_t len_w)\n{\n\tint utf8_len, utf8_write_len;\n\tsize_t new_size;\n\n\tif (!len_w)\n\t\treturn 0;\n\n\tassert(string_w);\n\n\t/* Measure the string necessary for conversion */\n\tif ((utf8_len = WideCharToMultiByte(CP_UTF8, WC_ERR_INVALID_CHARS, string_w, len_w, NULL, 0, NULL, NULL)) == 0)\n\t\treturn 0;\n\n\tassert(utf8_len > 0);\n\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, (size_t)utf8_len);\n\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\n\tif (git_buf_grow(buf, new_size) < 0)\n\t\treturn -1;\n\n\tif ((utf8_write_len = WideCharToMultiByte(\n\t\t\tCP_UTF8, WC_ERR_INVALID_CHARS, string_w, len_w, &buf->ptr[buf->size], utf8_len, NULL, NULL)) == 0)\n\t\treturn handle_wc_error();\n\n\tassert(utf8_write_len == utf8_len);\n\n\tbuf->size += utf8_write_len;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}",
          "includes": [
            "#include \"utf-conv.h\"",
            "#include \"../buffer.h\"",
            "#include \"w32_buffer.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utf-conv.h\"\n#include \"../buffer.h\"\n#include \"w32_buffer.h\"\n#include \"common.h\"\n\nint git_buf_put_w(git_buf *buf, const wchar_t *string_w, size_t len_w)\n{\n\tint utf8_len, utf8_write_len;\n\tsize_t new_size;\n\n\tif (!len_w)\n\t\treturn 0;\n\n\tassert(string_w);\n\n\t/* Measure the string necessary for conversion */\n\tif ((utf8_len = WideCharToMultiByte(CP_UTF8, WC_ERR_INVALID_CHARS, string_w, len_w, NULL, 0, NULL, NULL)) == 0)\n\t\treturn 0;\n\n\tassert(utf8_len > 0);\n\n\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, (size_t)utf8_len);\n\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\n\tif (git_buf_grow(buf, new_size) < 0)\n\t\treturn -1;\n\n\tif ((utf8_write_len = WideCharToMultiByte(\n\t\t\tCP_UTF8, WC_ERR_INVALID_CHARS, string_w, len_w, &buf->ptr[buf->size], utf8_len, NULL, NULL)) == 0)\n\t\treturn handle_wc_error();\n\n\tassert(utf8_write_len == utf8_len);\n\n\tbuf->size += utf8_write_len;\n\tbuf->ptr[buf->size] = '\\0';\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetEnvironmentVariableW",
          "args": [
            "wide_name",
            "wide_value",
            "value_len"
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "wide_value"
          ],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "value_len * sizeof(wchar_t)"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetEnvironmentVariableW",
          "args": [
            "wide_name",
            "NULL",
            "0"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__utf8_to_16_alloc",
          "args": [
            "&wide_name",
            "name"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "git__utf8_to_16_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/utf-conv.c",
          "lines": "70-102",
          "snippet": "int git__utf8_to_16_alloc(wchar_t **dest, const char *src)\n{\n\tint utf16_size;\n\n\t*dest = NULL;\n\n\t/* Length of -1 indicates NULL termination of the input string */\n\tutf16_size = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, src, -1, NULL, 0);\n\n\tif (!utf16_size) {\n\t\tgit__set_errno();\n\t\treturn -1;\n\t}\n\n\tif (!(*dest = git__mallocarray(utf16_size, sizeof(wchar_t)))) {\n\t\terrno = ENOMEM;\n\t\treturn -1;\n\t}\n\n\tutf16_size = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, src, -1, *dest, utf16_size);\n\n\tif (!utf16_size) {\n\t\tgit__set_errno();\n\n\t\tgit__free(*dest);\n\t\t*dest = NULL;\n\t}\n\n\t/* Subtract 1 from the result to turn 0 into -1 (an error code) and to not count the NULL\n\t * terminator as part of the string's length. MultiByteToWideChar never returns int's minvalue,\n\t * so underflow is not possible */\n\treturn utf16_size - 1;\n}",
          "includes": [
            "#include \"utf-conv.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utf-conv.h\"\n#include \"common.h\"\n\nint git__utf8_to_16_alloc(wchar_t **dest, const char *src)\n{\n\tint utf16_size;\n\n\t*dest = NULL;\n\n\t/* Length of -1 indicates NULL termination of the input string */\n\tutf16_size = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, src, -1, NULL, 0);\n\n\tif (!utf16_size) {\n\t\tgit__set_errno();\n\t\treturn -1;\n\t}\n\n\tif (!(*dest = git__mallocarray(utf16_size, sizeof(wchar_t)))) {\n\t\terrno = ENOMEM;\n\t\treturn -1;\n\t}\n\n\tutf16_size = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, src, -1, *dest, utf16_size);\n\n\tif (!utf16_size) {\n\t\tgit__set_errno();\n\n\t\tgit__free(*dest);\n\t\t*dest = NULL;\n\t}\n\n\t/* Subtract 1 from the result to turn 0 into -1 (an error code) and to not count the NULL\n\t * terminator as part of the string's length. MultiByteToWideChar never returns int's minvalue,\n\t * so underflow is not possible */\n\treturn utf16_size - 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "out"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__getenv(git_buf *out, const char *name)\n{\n\twchar_t *wide_name = NULL, *wide_value = NULL;\n\tDWORD value_len;\n\tint error = -1;\n\n\tgit_buf_clear(out);\n\n\tif (git__utf8_to_16_alloc(&wide_name, name) < 0)\n\t\treturn -1;\n\n\tif ((value_len = GetEnvironmentVariableW(wide_name, NULL, 0)) > 0) {\n\t\twide_value = git__malloc(value_len * sizeof(wchar_t));\n\t\tGITERR_CHECK_ALLOC(wide_value);\n\n\t\tvalue_len = GetEnvironmentVariableW(wide_name, wide_value, value_len);\n\t}\n\n\tif (value_len)\n\t\terror = git_buf_put_w(out, wide_value, value_len);\n\telse if (GetLastError() == ERROR_ENVVAR_NOT_FOUND)\n\t\terror = GIT_ENOTFOUND;\n\telse\n\t\tgiterr_set(GITERR_OS, \"could not read environment variable '%s'\", name);\n\n\tgit__free(wide_name);\n\tgit__free(wide_value);\n\treturn error;\n}"
  },
  {
    "function_name": "git__utf8_iterate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "730-766",
    "snippet": "int git__utf8_iterate(const uint8_t *str, int str_len, int32_t *dst)\n{\n\tint length;\n\tint32_t uc = -1;\n\n\t*dst = -1;\n\tlength = git__utf8_charlen(str, str_len);\n\tif (length < 0)\n\t\treturn -1;\n\n\tswitch (length) {\n\t\tcase 1:\n\t\t\tuc = str[0];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tuc = ((str[0] & 0x1F) <<  6) + (str[1] & 0x3F);\n\t\t\tif (uc < 0x80) uc = -1;\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tuc = ((str[0] & 0x0F) << 12) + ((str[1] & 0x3F) <<  6)\n\t\t\t\t+ (str[2] & 0x3F);\n\t\t\tif (uc < 0x800 || (uc >= 0xD800 && uc < 0xE000) ||\n\t\t\t\t\t(uc >= 0xFDD0 && uc < 0xFDF0)) uc = -1;\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tuc = ((str[0] & 0x07) << 18) + ((str[1] & 0x3F) << 12)\n\t\t\t\t+ ((str[2] & 0x3F) <<  6) + (str[3] & 0x3F);\n\t\t\tif (uc < 0x10000 || uc >= 0x110000) uc = -1;\n\t\t\tbreak;\n\t}\n\n\tif (uc < 0 || ((uc & 0xFFFF) >= 0xFFFE))\n\t\treturn -1;\n\n\t*dst = uc;\n\treturn length;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__utf8_charlen",
          "args": [
            "str",
            "str_len"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "git__utf8_charlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "711-728",
          "snippet": "int git__utf8_charlen(const uint8_t *str, int str_len)\n{\n\tint length, i;\n\n\tlength = utf8proc_utf8class[str[0]];\n\tif (!length)\n\t\treturn -1;\n\n\tif (str_len >= 0 && length > str_len)\n\t\treturn -str_len;\n\n\tfor (i = 1; i < length; i++) {\n\t\tif ((str[i] & 0xC0) != 0x80)\n\t\t\treturn -i;\n\t}\n\n\treturn length;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const int8_t utf8proc_utf8class[256] = {\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n\t2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n\t3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,\n\t4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nstatic const int8_t utf8proc_utf8class[256] = {\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n\t2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n\t3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,\n\t4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0\n};\n\nint git__utf8_charlen(const uint8_t *str, int str_len)\n{\n\tint length, i;\n\n\tlength = utf8proc_utf8class[str[0]];\n\tif (!length)\n\t\treturn -1;\n\n\tif (str_len >= 0 && length > str_len)\n\t\treturn -str_len;\n\n\tfor (i = 1; i < length; i++) {\n\t\tif ((str[i] & 0xC0) != 0x80)\n\t\t\treturn -i;\n\t}\n\n\treturn length;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__utf8_iterate(const uint8_t *str, int str_len, int32_t *dst)\n{\n\tint length;\n\tint32_t uc = -1;\n\n\t*dst = -1;\n\tlength = git__utf8_charlen(str, str_len);\n\tif (length < 0)\n\t\treturn -1;\n\n\tswitch (length) {\n\t\tcase 1:\n\t\t\tuc = str[0];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tuc = ((str[0] & 0x1F) <<  6) + (str[1] & 0x3F);\n\t\t\tif (uc < 0x80) uc = -1;\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tuc = ((str[0] & 0x0F) << 12) + ((str[1] & 0x3F) <<  6)\n\t\t\t\t+ (str[2] & 0x3F);\n\t\t\tif (uc < 0x800 || (uc >= 0xD800 && uc < 0xE000) ||\n\t\t\t\t\t(uc >= 0xFDD0 && uc < 0xFDF0)) uc = -1;\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tuc = ((str[0] & 0x07) << 18) + ((str[1] & 0x3F) << 12)\n\t\t\t\t+ ((str[2] & 0x3F) <<  6) + (str[3] & 0x3F);\n\t\t\tif (uc < 0x10000 || uc >= 0x110000) uc = -1;\n\t\t\tbreak;\n\t}\n\n\tif (uc < 0 || ((uc & 0xFFFF) >= 0xFFFE))\n\t\treturn -1;\n\n\t*dst = uc;\n\treturn length;\n}"
  },
  {
    "function_name": "git__utf8_charlen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "711-728",
    "snippet": "int git__utf8_charlen(const uint8_t *str, int str_len)\n{\n\tint length, i;\n\n\tlength = utf8proc_utf8class[str[0]];\n\tif (!length)\n\t\treturn -1;\n\n\tif (str_len >= 0 && length > str_len)\n\t\treturn -str_len;\n\n\tfor (i = 1; i < length; i++) {\n\t\tif ((str[i] & 0xC0) != 0x80)\n\t\t\treturn -i;\n\t}\n\n\treturn length;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const int8_t utf8proc_utf8class[256] = {\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n\t2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n\t3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,\n\t4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nstatic const int8_t utf8proc_utf8class[256] = {\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n\t2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n\t3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,\n\t4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0\n};\n\nint git__utf8_charlen(const uint8_t *str, int str_len)\n{\n\tint length, i;\n\n\tlength = utf8proc_utf8class[str[0]];\n\tif (!length)\n\t\treturn -1;\n\n\tif (str_len >= 0 && length > str_len)\n\t\treturn -str_len;\n\n\tfor (i = 1; i < length; i++) {\n\t\tif ((str[i] & 0xC0) != 0x80)\n\t\t\treturn -i;\n\t}\n\n\treturn length;\n}"
  },
  {
    "function_name": "git__insertsort_r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "644-665",
    "snippet": "void git__insertsort_r(\n\tvoid *els, size_t nel, size_t elsize, void *swapel,\n\tgit__sort_r_cmp cmp, void *payload)\n{\n\tuint8_t *base = els;\n\tuint8_t *end = base + nel * elsize;\n\tuint8_t *i, *j;\n\tbool freeswap = !swapel;\n\n\tif (freeswap)\n\t\tswapel = git__malloc(elsize);\n\n\tfor (i = base + elsize; i < end; i += elsize)\n\t\tfor (j = i; j > base && cmp(j, j - elsize, payload) < 0; j -= elsize) {\n\t\t\tmemcpy(swapel, j, elsize);\n\t\t\tmemcpy(j, j - elsize, elsize);\n\t\t\tmemcpy(j - elsize, swapel, elsize);\n\t\t}\n\n\tif (freeswap)\n\t\tgit__free(swapel);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "swapel"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "j - elsize",
            "swapel",
            "elsize"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "j",
            "j - elsize",
            "elsize"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "swapel",
            "j",
            "elsize"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmp",
          "args": [
            "j",
            "j - elsize",
            "payload"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "git__qsort_r_glue_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "620-625",
          "snippet": "static int GIT_STDLIB_CALL git__qsort_r_glue_cmp(\n\tvoid *payload, const void *a, const void *b)\n{\n\tgit__qsort_r_glue *glue = payload;\n\treturn glue->cmp(a, b, glue->payload);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nstatic int GIT_STDLIB_CALL git__qsort_r_glue_cmp(\n\tvoid *payload, const void *a, const void *b)\n{\n\tgit__qsort_r_glue *glue = payload;\n\treturn glue->cmp(a, b, glue->payload);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "elsize"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git__insertsort_r(\n\tvoid *els, size_t nel, size_t elsize, void *swapel,\n\tgit__sort_r_cmp cmp, void *payload)\n{\n\tuint8_t *base = els;\n\tuint8_t *end = base + nel * elsize;\n\tuint8_t *i, *j;\n\tbool freeswap = !swapel;\n\n\tif (freeswap)\n\t\tswapel = git__malloc(elsize);\n\n\tfor (i = base + elsize; i < end; i += elsize)\n\t\tfor (j = i; j > base && cmp(j, j - elsize, payload) < 0; j -= elsize) {\n\t\t\tmemcpy(swapel, j, elsize);\n\t\t\tmemcpy(j, j - elsize, elsize);\n\t\t\tmemcpy(j - elsize, swapel, elsize);\n\t\t}\n\n\tif (freeswap)\n\t\tgit__free(swapel);\n}"
  },
  {
    "function_name": "git__qsort_r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "628-642",
    "snippet": "void git__qsort_r(\n\tvoid *els, size_t nel, size_t elsize, git__sort_r_cmp cmp, void *payload)\n{\n#if defined(HAVE_QSORT_R) && defined(BSD)\n\tgit__qsort_r_glue glue = { cmp, payload };\n\tqsort_r(els, nel, elsize, &glue, git__qsort_r_glue_cmp);\n#elif defined(HAVE_QSORT_R) && defined(__GLIBC__)\n\tqsort_r(els, nel, elsize, cmp, payload);\n#elif defined(HAVE_QSORT_S)\n\tgit__qsort_r_glue glue = { cmp, payload };\n\tqsort_s(els, nel, elsize, git__qsort_r_glue_cmp, &glue);\n#else\n\tgit__insertsort_r(els, nel, elsize, NULL, cmp, payload);\n#endif\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__insertsort_r",
          "args": [
            "els",
            "nel",
            "elsize",
            "NULL",
            "cmp",
            "payload"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "git__insertsort_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "644-665",
          "snippet": "void git__insertsort_r(\n\tvoid *els, size_t nel, size_t elsize, void *swapel,\n\tgit__sort_r_cmp cmp, void *payload)\n{\n\tuint8_t *base = els;\n\tuint8_t *end = base + nel * elsize;\n\tuint8_t *i, *j;\n\tbool freeswap = !swapel;\n\n\tif (freeswap)\n\t\tswapel = git__malloc(elsize);\n\n\tfor (i = base + elsize; i < end; i += elsize)\n\t\tfor (j = i; j > base && cmp(j, j - elsize, payload) < 0; j -= elsize) {\n\t\t\tmemcpy(swapel, j, elsize);\n\t\t\tmemcpy(j, j - elsize, elsize);\n\t\t\tmemcpy(j - elsize, swapel, elsize);\n\t\t}\n\n\tif (freeswap)\n\t\tgit__free(swapel);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git__insertsort_r(\n\tvoid *els, size_t nel, size_t elsize, void *swapel,\n\tgit__sort_r_cmp cmp, void *payload)\n{\n\tuint8_t *base = els;\n\tuint8_t *end = base + nel * elsize;\n\tuint8_t *i, *j;\n\tbool freeswap = !swapel;\n\n\tif (freeswap)\n\t\tswapel = git__malloc(elsize);\n\n\tfor (i = base + elsize; i < end; i += elsize)\n\t\tfor (j = i; j > base && cmp(j, j - elsize, payload) < 0; j -= elsize) {\n\t\t\tmemcpy(swapel, j, elsize);\n\t\t\tmemcpy(j, j - elsize, elsize);\n\t\t\tmemcpy(j - elsize, swapel, elsize);\n\t\t}\n\n\tif (freeswap)\n\t\tgit__free(swapel);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qsort_s",
          "args": [
            "els",
            "nel",
            "elsize",
            "git__qsort_r_glue_cmp",
            "&glue"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qsort_r",
          "args": [
            "els",
            "nel",
            "elsize",
            "cmp",
            "payload"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "git__qsort_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "628-642",
          "snippet": "void git__qsort_r(\n\tvoid *els, size_t nel, size_t elsize, git__sort_r_cmp cmp, void *payload)\n{\n#if defined(HAVE_QSORT_R) && defined(BSD)\n\tgit__qsort_r_glue glue = { cmp, payload };\n\tqsort_r(els, nel, elsize, &glue, git__qsort_r_glue_cmp);\n#elif defined(HAVE_QSORT_R) && defined(__GLIBC__)\n\tqsort_r(els, nel, elsize, cmp, payload);\n#elif defined(HAVE_QSORT_S)\n\tgit__qsort_r_glue glue = { cmp, payload };\n\tqsort_s(els, nel, elsize, git__qsort_r_glue_cmp, &glue);\n#else\n\tgit__insertsort_r(els, nel, elsize, NULL, cmp, payload);\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git__qsort_r(\n\tvoid *els, size_t nel, size_t elsize, git__sort_r_cmp cmp, void *payload)\n{\n#if defined(HAVE_QSORT_R) && defined(BSD)\n\tgit__qsort_r_glue glue = { cmp, payload };\n\tqsort_r(els, nel, elsize, &glue, git__qsort_r_glue_cmp);\n#elif defined(HAVE_QSORT_R) && defined(__GLIBC__)\n\tqsort_r(els, nel, elsize, cmp, payload);\n#elif defined(HAVE_QSORT_S)\n\tgit__qsort_r_glue glue = { cmp, payload };\n\tqsort_s(els, nel, elsize, git__qsort_r_glue_cmp, &glue);\n#else\n\tgit__insertsort_r(els, nel, elsize, NULL, cmp, payload);\n#endif\n}"
  },
  {
    "function_name": "git__qsort_r_glue_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "620-625",
    "snippet": "static int GIT_STDLIB_CALL git__qsort_r_glue_cmp(\n\tvoid *payload, const void *a, const void *b)\n{\n\tgit__qsort_r_glue *glue = payload;\n\treturn glue->cmp(a, b, glue->payload);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "glue->cmp",
          "args": [
            "a",
            "b",
            "glue->payload"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nstatic int GIT_STDLIB_CALL git__qsort_r_glue_cmp(\n\tvoid *payload, const void *a, const void *b)\n{\n\tgit__qsort_r_glue *glue = payload;\n\treturn glue->cmp(a, b, glue->payload);\n}"
  },
  {
    "function_name": "git__unescape",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "593-612",
    "snippet": "size_t git__unescape(char *str)\n{\n\tchar *scan, *pos = str;\n\n\tif (!str)\n\t\treturn 0;\n\n\tfor (scan = str; *scan; pos++, scan++) {\n\t\tif (*scan == '\\\\' && *(scan + 1) != '\\0')\n\t\t\tscan++; /* skip '\\' but include next char */\n\t\tif (pos != scan)\n\t\t\t*pos = *scan;\n\t}\n\n\tif (pos != scan) {\n\t\t*pos = '\\0';\n\t}\n\n\treturn (pos - str);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nsize_t git__unescape(char *str)\n{\n\tchar *scan, *pos = str;\n\n\tif (!str)\n\t\treturn 0;\n\n\tfor (scan = str; *scan; pos++, scan++) {\n\t\tif (*scan == '\\\\' && *(scan + 1) != '\\0')\n\t\t\tscan++; /* skip '\\' but include next char */\n\t\tif (pos != scan)\n\t\t\t*pos = *scan;\n\t}\n\n\tif (pos != scan) {\n\t\t*pos = '\\0';\n\t}\n\n\treturn (pos - str);\n}"
  },
  {
    "function_name": "git__parse_bool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "572-591",
    "snippet": "int git__parse_bool(int *out, const char *value)\n{\n\t/* A missing value means true */\n\tif (value == NULL ||\n\t\t!strcasecmp(value, \"true\") ||\n\t\t!strcasecmp(value, \"yes\") ||\n\t\t!strcasecmp(value, \"on\")) {\n\t\t*out = 1;\n\t\treturn 0;\n\t}\n\tif (!strcasecmp(value, \"false\") ||\n\t\t!strcasecmp(value, \"no\") ||\n\t\t!strcasecmp(value, \"off\") ||\n\t\tvalue[0] == '\\0') {\n\t\t*out = 0;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "value",
            "\"off\""
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcasecmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "567-570",
          "snippet": "int git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__parse_bool(int *out, const char *value)\n{\n\t/* A missing value means true */\n\tif (value == NULL ||\n\t\t!strcasecmp(value, \"true\") ||\n\t\t!strcasecmp(value, \"yes\") ||\n\t\t!strcasecmp(value, \"on\")) {\n\t\t*out = 1;\n\t\treturn 0;\n\t}\n\tif (!strcasecmp(value, \"false\") ||\n\t\t!strcasecmp(value, \"no\") ||\n\t\t!strcasecmp(value, \"off\") ||\n\t\tvalue[0] == '\\0') {\n\t\t*out = 0;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}"
  },
  {
    "function_name": "git__strcasecmp_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "567-570",
    "snippet": "int git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "(const char *)a",
            "(const char *)b"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcasecmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "567-570",
          "snippet": "int git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcasecmp_cb(const void *a, const void *b)\n{\n\treturn strcasecmp((const char *)a, (const char *)b);\n}"
  },
  {
    "function_name": "git__strcmp_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "562-565",
    "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "(const char *)a",
            "(const char *)b"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
  },
  {
    "function_name": "git__bsearch_r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "525-554",
    "snippet": "int git__bsearch_r(\n\tvoid **array,\n\tsize_t array_len,\n\tconst void *key,\n\tint (*compare_r)(const void *, const void *, void *),\n\tvoid *payload,\n\tsize_t *position)\n{\n\tsize_t lim;\n\tint cmp = -1;\n\tvoid **part, **base = array;\n\n\tfor (lim = array_len; lim != 0; lim >>= 1) {\n\t\tpart = base + (lim >> 1);\n\t\tcmp = (*compare_r)(key, *part, payload);\n\t\tif (cmp == 0) {\n\t\t\tbase = part;\n\t\t\tbreak;\n\t\t}\n\t\tif (cmp > 0) { /* key > p; take right partition */\n\t\t\tbase = part + 1;\n\t\t\tlim--;\n\t\t} /* else take left partition */\n\t}\n\n\tif (position)\n\t\t*position = (base - array);\n\n\treturn (cmp == 0) ? 0 : GIT_ENOTFOUND;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "key",
            "*part",
            "payload"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__bsearch_r(\n\tvoid **array,\n\tsize_t array_len,\n\tconst void *key,\n\tint (*compare_r)(const void *, const void *, void *),\n\tvoid *payload,\n\tsize_t *position)\n{\n\tsize_t lim;\n\tint cmp = -1;\n\tvoid **part, **base = array;\n\n\tfor (lim = array_len; lim != 0; lim >>= 1) {\n\t\tpart = base + (lim >> 1);\n\t\tcmp = (*compare_r)(key, *part, payload);\n\t\tif (cmp == 0) {\n\t\t\tbase = part;\n\t\t\tbreak;\n\t\t}\n\t\tif (cmp > 0) { /* key > p; take right partition */\n\t\t\tbase = part + 1;\n\t\t\tlim--;\n\t\t} /* else take left partition */\n\t}\n\n\tif (position)\n\t\t*position = (base - array);\n\n\treturn (cmp == 0) ? 0 : GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git__bsearch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "495-523",
    "snippet": "int git__bsearch(\n\tvoid **array,\n\tsize_t array_len,\n\tconst void *key,\n\tint (*compare)(const void *, const void *),\n\tsize_t *position)\n{\n\tsize_t lim;\n\tint cmp = -1;\n\tvoid **part, **base = array;\n\n\tfor (lim = array_len; lim != 0; lim >>= 1) {\n\t\tpart = base + (lim >> 1);\n\t\tcmp = (*compare)(key, *part);\n\t\tif (cmp == 0) {\n\t\t\tbase = part;\n\t\t\tbreak;\n\t\t}\n\t\tif (cmp > 0) { /* key > p; take right partition */\n\t\t\tbase = part + 1;\n\t\t\tlim--;\n\t\t} /* else take left partition */\n\t}\n\n\tif (position)\n\t\t*position = (base - array);\n\n\treturn (cmp == 0) ? 0 : GIT_ENOTFOUND;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "key",
            "*part"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__bsearch(\n\tvoid **array,\n\tsize_t array_len,\n\tconst void *key,\n\tint (*compare)(const void *, const void *),\n\tsize_t *position)\n{\n\tsize_t lim;\n\tint cmp = -1;\n\tvoid **part, **base = array;\n\n\tfor (lim = array_len; lim != 0; lim >>= 1) {\n\t\tpart = base + (lim >> 1);\n\t\tcmp = (*compare)(key, *part);\n\t\tif (cmp == 0) {\n\t\t\tbase = part;\n\t\t\tbreak;\n\t\t}\n\t\tif (cmp > 0) { /* key > p; take right partition */\n\t\t\tbase = part + 1;\n\t\t\tlim--;\n\t\t} /* else take left partition */\n\t}\n\n\tif (position)\n\t\t*position = (base - array);\n\n\treturn (cmp == 0) ? 0 : GIT_ENOTFOUND;\n}"
  },
  {
    "function_name": "git__hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "413-462",
    "snippet": "uint32_t git__hash(const void *key, int len, uint32_t seed)\n{\n\n#define MURMUR_BLOCK() {\\\n\tk1 *= c1; \\\n\tk1 = git__rotl(k1,11);\\\n\tk1 *= c2;\\\n\th1 ^= k1;\\\n\th1 = h1*3 + 0x52dce729;\\\n\tc1 = c1*5 + 0x7b7d159c;\\\n\tc2 = c2*5 + 0x6bce6396;\\\n}\n\n\tconst uint8_t *data = (const uint8_t*)key;\n\tconst int nblocks = len / 4;\n\n\tconst uint32_t *blocks = (const uint32_t *)(data + nblocks * 4);\n\tconst uint8_t *tail = (const uint8_t *)(data + nblocks * 4);\n\n\tuint32_t h1 = 0x971e137b ^ seed;\n\tuint32_t k1;\n\n\tuint32_t c1 = 0x95543787;\n\tuint32_t c2 = 0x2ad7eb25;\n\n\tint i;\n\n\tfor (i = -nblocks; i; i++) {\n\t\tk1 = blocks[i];\n\t\tMURMUR_BLOCK();\n\t}\n\n\tk1 = 0;\n\n\tswitch(len & 3) {\n\tcase 3: k1 ^= tail[2] << 16;\n\tcase 2: k1 ^= tail[1] << 8;\n\tcase 1: k1 ^= tail[0];\n\t\t\tMURMUR_BLOCK();\n\t}\n\n\th1 ^= len;\n\th1 ^= h1 >> 16;\n\th1 *= 0x85ebca6b;\n\th1 ^= h1 >> 13;\n\th1 *= 0xc2b2ae35;\n\th1 ^= h1 >> 16;\n\n\treturn h1;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MURMUR_BLOCK",
          "args": [],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MURMUR_BLOCK",
          "args": [],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nuint32_t git__hash(const void *key, int len, uint32_t seed)\n{\n\n#define MURMUR_BLOCK() {\\\n\tk1 *= c1; \\\n\tk1 = git__rotl(k1,11);\\\n\tk1 *= c2;\\\n\th1 ^= k1;\\\n\th1 = h1*3 + 0x52dce729;\\\n\tc1 = c1*5 + 0x7b7d159c;\\\n\tc2 = c2*5 + 0x6bce6396;\\\n}\n\n\tconst uint8_t *data = (const uint8_t*)key;\n\tconst int nblocks = len / 4;\n\n\tconst uint32_t *blocks = (const uint32_t *)(data + nblocks * 4);\n\tconst uint8_t *tail = (const uint8_t *)(data + nblocks * 4);\n\n\tuint32_t h1 = 0x971e137b ^ seed;\n\tuint32_t k1;\n\n\tuint32_t c1 = 0x95543787;\n\tuint32_t c2 = 0x2ad7eb25;\n\n\tint i;\n\n\tfor (i = -nblocks; i; i++) {\n\t\tk1 = blocks[i];\n\t\tMURMUR_BLOCK();\n\t}\n\n\tk1 = 0;\n\n\tswitch(len & 3) {\n\tcase 3: k1 ^= tail[2] << 16;\n\tcase 2: k1 ^= tail[1] << 8;\n\tcase 1: k1 ^= tail[0];\n\t\t\tMURMUR_BLOCK();\n\t}\n\n\th1 ^= len;\n\th1 ^= h1 >> 16;\n\th1 *= 0x85ebca6b;\n\th1 ^= h1 >> 13;\n\th1 *= 0xc2b2ae35;\n\th1 ^= h1 >> 16;\n\n\treturn h1;\n}"
  },
  {
    "function_name": "git__hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "370-404",
    "snippet": "uint32_t git__hash(const void *key, int len, unsigned int seed)\n{\n\tconst uint32_t m = 0x5bd1e995;\n\tconst int r = 24;\n\tuint32_t h = seed ^ len;\n\n\tconst unsigned char *data = (const unsigned char *)key;\n\n\twhile(len >= 4) {\n\t\tuint32_t k = *(uint32_t *)data;\n\n\t\tk *= m;\n\t\tk ^= k >> r;\n\t\tk *= m;\n\n\t\th *= m;\n\t\th ^= k;\n\n\t\tdata += 4;\n\t\tlen -= 4;\n\t}\n\n\tswitch(len) {\n\tcase 3: h ^= data[2] << 16;\n\tcase 2: h ^= data[1] << 8;\n\tcase 1: h ^= data[0];\n\t\t\th *= m;\n\t};\n\n\th ^= h >> 13;\n\th *= m;\n\th ^= h >> 15;\n\n\treturn h;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nuint32_t git__hash(const void *key, int len, unsigned int seed)\n{\n\tconst uint32_t m = 0x5bd1e995;\n\tconst int r = 24;\n\tuint32_t h = seed ^ len;\n\n\tconst unsigned char *data = (const unsigned char *)key;\n\n\twhile(len >= 4) {\n\t\tuint32_t k = *(uint32_t *)data;\n\n\t\tk *= m;\n\t\tk ^= k >> r;\n\t\tk *= m;\n\n\t\th *= m;\n\t\th ^= k;\n\n\t\tdata += 4;\n\t\tlen -= 4;\n\t}\n\n\tswitch(len) {\n\tcase 3: h ^= data[2] << 16;\n\tcase 2: h ^= data[1] << 8;\n\tcase 1: h ^= data[0];\n\t\t\th *= m;\n\t};\n\n\th ^= h >> 13;\n\th *= m;\n\th ^= h >> 15;\n\n\treturn h;\n}"
  },
  {
    "function_name": "git__hexdump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "324-367",
    "snippet": "void git__hexdump(const char *buffer, size_t len)\n{\n\tstatic const size_t LINE_WIDTH = 16;\n\n\tsize_t line_count, last_line, i, j;\n\tconst char *line;\n\n\tline_count = (len / LINE_WIDTH);\n\tlast_line = (len % LINE_WIDTH);\n\n\tfor (i = 0; i < line_count; ++i) {\n\t\tline = buffer + (i * LINE_WIDTH);\n\t\tfor (j = 0; j < LINE_WIDTH; ++j, ++line)\n\t\t\tprintf(\"%02X \", (unsigned char)*line & 0xFF);\n\n\t\tprintf(\"| \");\n\n\t\tline = buffer + (i * LINE_WIDTH);\n\t\tfor (j = 0; j < LINE_WIDTH; ++j, ++line)\n\t\t\tprintf(\"%c\", (*line >= 32 && *line <= 126) ? *line : '.');\n\n\t\tprintf(\"\\n\");\n\t}\n\n\tif (last_line > 0) {\n\n\t\tline = buffer + (line_count * LINE_WIDTH);\n\t\tfor (j = 0; j < last_line; ++j, ++line)\n\t\t\tprintf(\"%02X \", (unsigned char)*line & 0xFF);\n\n\t\tfor (j = 0; j < (LINE_WIDTH - last_line); ++j)\n\t\t\tprintf(\"\t\");\n\n\t\tprintf(\"| \");\n\n\t\tline = buffer + (line_count * LINE_WIDTH);\n\t\tfor (j = 0; j < last_line; ++j, ++line)\n\t\t\tprintf(\"%c\", (*line >= 32 && *line <= 126) ? *line : '.');\n\n\t\tprintf(\"\\n\");\n\t}\n\n\tprintf(\"\\n\");\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%c\"",
            "(*line >= 32 && *line <= 126) ? *line : '.'"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "406-416",
          "snippet": "int git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_printf(git_buf *buf, const char *format, ...)\n{\n\tint r;\n\tva_list ap;\n\n\tva_start(ap, format);\n\tr = git_buf_vprintf(buf, format, ap);\n\tva_end(ap);\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"| \""
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\t\""
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"| \""
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git__hexdump(const char *buffer, size_t len)\n{\n\tstatic const size_t LINE_WIDTH = 16;\n\n\tsize_t line_count, last_line, i, j;\n\tconst char *line;\n\n\tline_count = (len / LINE_WIDTH);\n\tlast_line = (len % LINE_WIDTH);\n\n\tfor (i = 0; i < line_count; ++i) {\n\t\tline = buffer + (i * LINE_WIDTH);\n\t\tfor (j = 0; j < LINE_WIDTH; ++j, ++line)\n\t\t\tprintf(\"%02X \", (unsigned char)*line & 0xFF);\n\n\t\tprintf(\"| \");\n\n\t\tline = buffer + (i * LINE_WIDTH);\n\t\tfor (j = 0; j < LINE_WIDTH; ++j, ++line)\n\t\t\tprintf(\"%c\", (*line >= 32 && *line <= 126) ? *line : '.');\n\n\t\tprintf(\"\\n\");\n\t}\n\n\tif (last_line > 0) {\n\n\t\tline = buffer + (line_count * LINE_WIDTH);\n\t\tfor (j = 0; j < last_line; ++j, ++line)\n\t\t\tprintf(\"%02X \", (unsigned char)*line & 0xFF);\n\n\t\tfor (j = 0; j < (LINE_WIDTH - last_line); ++j)\n\t\t\tprintf(\"\t\");\n\n\t\tprintf(\"| \");\n\n\t\tline = buffer + (line_count * LINE_WIDTH);\n\t\tfor (j = 0; j < last_line; ++j, ++line)\n\t\t\tprintf(\"%c\", (*line >= 32 && *line <= 126) ? *line : '.');\n\n\t\tprintf(\"\\n\");\n\t}\n\n\tprintf(\"\\n\");\n}"
  },
  {
    "function_name": "git__strsep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "307-322",
    "snippet": "char *git__strsep(char **end, const char *sep)\n{\n\tchar *start = *end, *ptr = *end;\n\n\twhile (*ptr && !strchr(sep, *ptr))\n\t\t++ptr;\n\n\tif (*ptr) {\n\t\t*end = ptr + 1;\n\t\t*ptr = '\\0';\n\n\t\treturn start;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "sep",
            "*ptr"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nchar *git__strsep(char **end, const char *sep)\n{\n\tchar *start = *end, *ptr = *end;\n\n\twhile (*ptr && !strchr(sep, *ptr))\n\t\t++ptr;\n\n\tif (*ptr) {\n\t\t*end = ptr + 1;\n\t\t*ptr = '\\0';\n\n\t\treturn start;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "git__strtok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "281-304",
    "snippet": "char *git__strtok(char **end, const char *sep)\n{\n\tchar *ptr = *end;\n\n\twhile (*ptr && strchr(sep, *ptr))\n\t\t++ptr;\n\n\tif (*ptr) {\n\t\tchar *start = ptr;\n\t\t*end = start + 1;\n\n\t\twhile (**end && !strchr(sep, **end))\n\t\t\t++*end;\n\n\t\tif (**end) {\n\t\t\t**end = '\\0';\n\t\t\t++*end;\n\t\t}\n\n\t\treturn start;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "sep",
            "**end"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "sep",
            "*ptr"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nchar *git__strtok(char **end, const char *sep)\n{\n\tchar *ptr = *end;\n\n\twhile (*ptr && strchr(sep, *ptr))\n\t\t++ptr;\n\n\tif (*ptr) {\n\t\tchar *start = ptr;\n\t\t*end = start + 1;\n\n\t\twhile (**end && !strchr(sep, **end))\n\t\t\t++*end;\n\n\t\tif (**end) {\n\t\t\t**end = '\\0';\n\t\t\t++*end;\n\t\t}\n\n\t\treturn start;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "git__suffixcmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "272-279",
    "snippet": "int git__suffixcmp(const char *str, const char *suffix)\n{\n\tsize_t a = strlen(str);\n\tsize_t b = strlen(suffix);\n\tif (a < b)\n\t\treturn -1;\n\treturn strcmp(str + (a - b), suffix);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str + (a - b)",
            "suffix"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "suffix"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__suffixcmp(const char *str, const char *suffix)\n{\n\tsize_t a = strlen(str);\n\tsize_t b = strlen(suffix);\n\tif (a < b)\n\t\treturn -1;\n\treturn strcmp(str + (a - b), suffix);\n}"
  },
  {
    "function_name": "git__prefixncmp_icase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "257-270",
    "snippet": "int git__prefixncmp_icase(const char *str, size_t str_n, const char *prefix)\n{\n\tint s, p;\n\n\twhile(str_n--) {\n\t\ts = (unsigned char)git__tolower(*str++);\n\t\tp = (unsigned char)git__tolower(*prefix++);\n\n\t\tif (s != p)\n\t\t\treturn s - p;\n\t}\n\n\treturn (0 - *prefix);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__tolower",
          "args": [
            "*prefix++"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "git__tolower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "285-288",
          "snippet": "GIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixncmp_icase(const char *str, size_t str_n, const char *prefix)\n{\n\tint s, p;\n\n\twhile(str_n--) {\n\t\ts = (unsigned char)git__tolower(*str++);\n\t\tp = (unsigned char)git__tolower(*prefix++);\n\n\t\tif (s != p)\n\t\t\treturn s - p;\n\t}\n\n\treturn (0 - *prefix);\n}"
  },
  {
    "function_name": "git__prefixcmp_icase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "252-255",
    "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "str",
            "prefix",
            "strlen(prefix)"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "git__strncasecmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "214-225",
          "snippet": "int git__strncasecmp(const char *a, const char *b, size_t sz)\n{\n\tint al, bl;\n\n\tdo {\n\t\tal = (unsigned char)git__tolower(*a);\n\t\tbl = (unsigned char)git__tolower(*b);\n\t\t++a, ++b;\n\t} while (--sz && al && al == bl);\n\n\treturn al - bl;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strncasecmp(const char *a, const char *b, size_t sz)\n{\n\tint al, bl;\n\n\tdo {\n\t\tal = (unsigned char)git__tolower(*a);\n\t\tbl = (unsigned char)git__tolower(*b);\n\t\t++a, ++b;\n\t} while (--sz && al && al == bl);\n\n\treturn al - bl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prefix"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
  },
  {
    "function_name": "git__prefixcmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "241-250",
    "snippet": "int git__prefixcmp(const char *str, const char *prefix)\n{\n\tfor (;;) {\n\t\tunsigned char p = *(prefix++), s;\n\t\tif (!p)\n\t\t\treturn 0;\n\t\tif ((s = *(str++)) != p)\n\t\t\treturn s - p;\n\t}\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp(const char *str, const char *prefix)\n{\n\tfor (;;) {\n\t\tunsigned char p = *(prefix++), s;\n\t\tif (!p)\n\t\t\treturn 0;\n\t\tif ((s = *(str++)) != p)\n\t\t\treturn s - p;\n\t}\n}"
  },
  {
    "function_name": "git__strtolower",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "236-239",
    "snippet": "void git__strtolower(char *str)\n{\n\tgit__strntolower(str, strlen(str));\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__strntolower",
          "args": [
            "str",
            "strlen(str)"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "git__strntolower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "227-234",
          "snippet": "void git__strntolower(char *str, size_t len)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < len; ++i) {\n\t\tstr[i] = (char)git__tolower(str[i]);\n\t}\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git__strntolower(char *str, size_t len)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < len; ++i) {\n\t\tstr[i] = (char)git__tolower(str[i]);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git__strtolower(char *str)\n{\n\tgit__strntolower(str, strlen(str));\n}"
  },
  {
    "function_name": "git__strntolower",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "227-234",
    "snippet": "void git__strntolower(char *str, size_t len)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < len; ++i) {\n\t\tstr[i] = (char)git__tolower(str[i]);\n\t}\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__tolower",
          "args": [
            "str[i]"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "git__tolower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "285-288",
          "snippet": "GIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git__strntolower(char *str, size_t len)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < len; ++i) {\n\t\tstr[i] = (char)git__tolower(str[i]);\n\t}\n}"
  },
  {
    "function_name": "git__strncasecmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "214-225",
    "snippet": "int git__strncasecmp(const char *a, const char *b, size_t sz)\n{\n\tint al, bl;\n\n\tdo {\n\t\tal = (unsigned char)git__tolower(*a);\n\t\tbl = (unsigned char)git__tolower(*b);\n\t\t++a, ++b;\n\t} while (--sz && al && al == bl);\n\n\treturn al - bl;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__tolower",
          "args": [
            "*b"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "git__tolower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "285-288",
          "snippet": "GIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strncasecmp(const char *a, const char *b, size_t sz)\n{\n\tint al, bl;\n\n\tdo {\n\t\tal = (unsigned char)git__tolower(*a);\n\t\tbl = (unsigned char)git__tolower(*b);\n\t\t++a, ++b;\n\t} while (--sz && al && al == bl);\n\n\treturn al - bl;\n}"
  },
  {
    "function_name": "git__strncmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "205-212",
    "snippet": "int git__strncmp(const char *a, const char *b, size_t sz)\n{\n\twhile (sz && *a && *b && *a == *b)\n\t\t--sz, ++a, ++b;\n\tif (!sz)\n\t\treturn 0;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strncmp(const char *a, const char *b, size_t sz)\n{\n\twhile (sz && *a && *b && *a == *b)\n\t\t--sz, ++a, ++b;\n\tif (!sz)\n\t\treturn 0;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}"
  },
  {
    "function_name": "git__strcasesort_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "183-203",
    "snippet": "int git__strcasesort_cmp(const char *a, const char *b)\n{\n\tint cmp = 0;\n\n\twhile (*a && *b) {\n\t\tif (*a != *b) {\n\t\t\tif (git__tolower(*a) != git__tolower(*b))\n\t\t\t\tbreak;\n\t\t\t/* use case in sort order even if not in equivalence */\n\t\t\tif (!cmp)\n\t\t\t\tcmp = (int)(*(const uint8_t *)a) - (int)(*(const uint8_t *)b);\n\t\t}\n\n\t\t++a, ++b;\n\t}\n\n\tif (*a || *b)\n\t\treturn (unsigned char)git__tolower(*a) - (unsigned char)git__tolower(*b);\n\n\treturn cmp;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__tolower",
          "args": [
            "*b"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "git__tolower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "285-288",
          "snippet": "GIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcasesort_cmp(const char *a, const char *b)\n{\n\tint cmp = 0;\n\n\twhile (*a && *b) {\n\t\tif (*a != *b) {\n\t\t\tif (git__tolower(*a) != git__tolower(*b))\n\t\t\t\tbreak;\n\t\t\t/* use case in sort order even if not in equivalence */\n\t\t\tif (!cmp)\n\t\t\t\tcmp = (int)(*(const uint8_t *)a) - (int)(*(const uint8_t *)b);\n\t\t}\n\n\t\t++a, ++b;\n\t}\n\n\tif (*a || *b)\n\t\treturn (unsigned char)git__tolower(*a) - (unsigned char)git__tolower(*b);\n\n\treturn cmp;\n}"
  },
  {
    "function_name": "git__strcasecmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "176-181",
    "snippet": "int git__strcasecmp(const char *a, const char *b)\n{\n\twhile (*a && *b && git__tolower(*a) == git__tolower(*b))\n\t\t++a, ++b;\n\treturn ((unsigned char)git__tolower(*a) - (unsigned char)git__tolower(*b));\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__tolower",
          "args": [
            "*b"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "git__tolower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "285-288",
          "snippet": "GIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(int) git__tolower(int c)\n{\n\treturn (c >= 'A' && c <= 'Z') ? (c + 32) : c;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcasecmp(const char *a, const char *b)\n{\n\twhile (*a && *b && git__tolower(*a) == git__tolower(*b))\n\t\t++a, ++b;\n\treturn ((unsigned char)git__tolower(*a) - (unsigned char)git__tolower(*b));\n}"
  },
  {
    "function_name": "git__strcmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "169-174",
    "snippet": "int git__strcmp(const char *a, const char *b)\n{\n\twhile (*a && *b && *a == *b)\n\t\t++a, ++b;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp(const char *a, const char *b)\n{\n\twhile (*a && *b && *a == *b)\n\t\t++a, ++b;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}"
  },
  {
    "function_name": "git__strtol32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "149-167",
    "snippet": "int git__strtol32(int32_t *result, const char *nptr, const char **endptr, int base)\n{\n\tint error;\n\tint32_t tmp_int;\n\tint64_t tmp_long;\n\n\tif ((error = git__strtol64(&tmp_long, nptr, endptr, base)) < 0)\n\t\treturn error;\n\n\ttmp_int = tmp_long & 0xFFFFFFFF;\n\tif (tmp_int != tmp_long) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert. '%s' is too large\", nptr);\n\t\treturn -1;\n\t}\n\n\t*result = tmp_int;\n\n\treturn error;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Failed to convert. '%s' is too large\"",
            "nptr"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strtol64",
          "args": [
            "&tmp_long",
            "nptr",
            "endptr",
            "base"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "git__strtol64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "67-147",
          "snippet": "int git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strtol32(int32_t *result, const char *nptr, const char **endptr, int base)\n{\n\tint error;\n\tint32_t tmp_int;\n\tint64_t tmp_long;\n\n\tif ((error = git__strtol64(&tmp_long, nptr, endptr, base)) < 0)\n\t\treturn error;\n\n\ttmp_int = tmp_long & 0xFFFFFFFF;\n\tif (tmp_int != tmp_long) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert. '%s' is too large\", nptr);\n\t\treturn -1;\n\t}\n\n\t*result = tmp_int;\n\n\treturn error;\n}"
  },
  {
    "function_name": "git__strtol64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "67-147",
    "snippet": "int git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_INVALID",
            "\"Failed to convert string to long. Overflow error\""
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__isspace",
          "args": [
            "*p"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "git__isspace_nonlf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "459-462",
          "snippet": "GIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strtol64(int64_t *result, const char *nptr, const char **endptr, int base)\n{\n\tconst char *p;\n\tint64_t n, nn;\n\tint c, ovfl, v, neg, ndig;\n\n\tp = nptr;\n\tneg = 0;\n\tn = 0;\n\tndig = 0;\n\tovfl = 0;\n\n\t/*\n\t * White space\n\t */\n\twhile (git__isspace(*p))\n\t\tp++;\n\n\t/*\n\t * Sign\n\t */\n\tif (*p == '-' || *p == '+')\n\t\tif (*p++ == '-')\n\t\t\tneg = 1;\n\n\t/*\n\t * Base\n\t */\n\tif (base == 0) {\n\t\tif (*p != '0')\n\t\t\tbase = 10;\n\t\telse {\n\t\t\tbase = 8;\n\t\t\tif (p[1] == 'x' || p[1] == 'X') {\n\t\t\t\tp += 2;\n\t\t\t\tbase = 16;\n\t\t\t}\n\t\t}\n\t} else if (base == 16 && *p == '0') {\n\t\tif (p[1] == 'x' || p[1] == 'X')\n\t\t\tp += 2;\n\t} else if (base < 0 || 36 < base)\n\t\tgoto Return;\n\n\t/*\n\t * Non-empty sequence of digits\n\t */\n\tfor (;; p++,ndig++) {\n\t\tc = *p;\n\t\tv = base;\n\t\tif ('0'<=c && c<='9')\n\t\t\tv = c - '0';\n\t\telse if ('a'<=c && c<='z')\n\t\t\tv = c - 'a' + 10;\n\t\telse if ('A'<=c && c<='Z')\n\t\t\tv = c - 'A' + 10;\n\t\tif (v >= base)\n\t\t\tbreak;\n\t\tnn = n * base + (neg ? -v : v);\n\t\tif ((!neg && nn < n) || (neg && nn > n))\n\t\t\tovfl = 1;\n\t\tn = nn;\n\t}\n\nReturn:\n\tif (ndig == 0) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Not a number\");\n\t\treturn -1;\n\t}\n\n\tif (endptr)\n\t\t*endptr = p;\n\n\tif (ovfl) {\n\t\tgiterr_set(GITERR_INVALID, \"Failed to convert string to long. Overflow error\");\n\t\treturn -1;\n\t}\n\n\t*result = n;\n\treturn 0;\n}"
  },
  {
    "function_name": "git_strarray_copy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "36-65",
    "snippet": "int git_strarray_copy(git_strarray *tgt, const git_strarray *src)\n{\n\tsize_t i;\n\n\tassert(tgt && src);\n\n\tmemset(tgt, 0, sizeof(*tgt));\n\n\tif (!src->count)\n\t\treturn 0;\n\n\ttgt->strings = git__calloc(src->count, sizeof(char *));\n\tGITERR_CHECK_ALLOC(tgt->strings);\n\n\tfor (i = 0; i < src->count; ++i) {\n\t\tif (!src->strings[i])\n\t\t\tcontinue;\n\n\t\ttgt->strings[tgt->count] = git__strdup(src->strings[i]);\n\t\tif (!tgt->strings[tgt->count]) {\n\t\t\tgit_strarray_free(tgt);\n\t\t\tmemset(tgt, 0, sizeof(*tgt));\n\t\t\treturn -1;\n\t\t}\n\n\t\ttgt->count++;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "tgt",
            "0",
            "sizeof(*tgt)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strarray_free",
          "args": [
            "tgt"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "git_strarray_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "21-34",
          "snippet": "void git_strarray_free(git_strarray *array)\n{\n\tsize_t i;\n\n\tif (array == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < array->count; ++i)\n\t\tgit__free(array->strings[i]);\n\n\tgit__free(array->strings);\n\n\tmemset(array, 0, sizeof(*array));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git_strarray_free(git_strarray *array)\n{\n\tsize_t i;\n\n\tif (array == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < array->count; ++i)\n\t\tgit__free(array->strings[i]);\n\n\tgit__free(array->strings);\n\n\tmemset(array, 0, sizeof(*array));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "src->strings[i]"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "tgt->strings"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "src->count",
            "sizeof(char *)"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "tgt",
            "0",
            "sizeof(*tgt)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "tgt && src"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git_strarray_copy(git_strarray *tgt, const git_strarray *src)\n{\n\tsize_t i;\n\n\tassert(tgt && src);\n\n\tmemset(tgt, 0, sizeof(*tgt));\n\n\tif (!src->count)\n\t\treturn 0;\n\n\ttgt->strings = git__calloc(src->count, sizeof(char *));\n\tGITERR_CHECK_ALLOC(tgt->strings);\n\n\tfor (i = 0; i < src->count; ++i) {\n\t\tif (!src->strings[i])\n\t\t\tcontinue;\n\n\t\ttgt->strings[tgt->count] = git__strdup(src->strings[i]);\n\t\tif (!tgt->strings[tgt->count]) {\n\t\t\tgit_strarray_free(tgt);\n\t\t\tmemset(tgt, 0, sizeof(*tgt));\n\t\t\treturn -1;\n\t\t}\n\n\t\ttgt->count++;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_strarray_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
    "lines": "21-34",
    "snippet": "void git_strarray_free(git_strarray *array)\n{\n\tsize_t i;\n\n\tif (array == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < array->count; ++i)\n\t\tgit__free(array->strings[i]);\n\n\tgit__free(array->strings);\n\n\tmemset(array, 0, sizeof(*array));\n}",
    "includes": [
      "# include <Shlwapi.h>",
      "# include \"win32/w32_buffer.h\"",
      "#include \"posix.h\"",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include \"common.h\"",
      "#include <git2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "array",
            "0",
            "sizeof(*array)"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "array->strings"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nvoid git_strarray_free(git_strarray *array)\n{\n\tsize_t i;\n\n\tif (array == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < array->count; ++i)\n\t\tgit__free(array->strings[i]);\n\n\tgit__free(array->strings);\n\n\tmemset(array, 0, sizeof(*array));\n}"
  }
]