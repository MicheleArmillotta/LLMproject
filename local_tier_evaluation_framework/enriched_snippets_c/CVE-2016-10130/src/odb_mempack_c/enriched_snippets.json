[
  {
    "function_name": "git_mempack_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_mempack.c",
    "lines": "169-188",
    "snippet": "int git_mempack_new(git_odb_backend **out)\n{\n\tstruct memory_packer_db *db;\n\n\tassert(out);\n\n\tdb = git__calloc(1, sizeof(struct memory_packer_db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tdb->objects = git_oidmap_alloc();\n\n\tdb->parent.read = &impl__read;\n\tdb->parent.write = &impl__write;\n\tdb->parent.read_header = &impl__read_header;\n\tdb->parent.exists = &impl__exists;\n\tdb->parent.free = &impl__free;\n\n\t*out = (git_odb_backend *)db;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/pack.h\"",
      "#include \"git2/types.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"oidmap.h\"",
      "#include \"array.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oidmap_alloc",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "db"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(struct memory_packer_db)"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/pack.h\"\n#include \"git2/types.h\"\n#include \"git2/odb_backend.h\"\n#include \"oidmap.h\"\n#include \"array.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include \"common.h\"\n\nint git_mempack_new(git_odb_backend **out)\n{\n\tstruct memory_packer_db *db;\n\n\tassert(out);\n\n\tdb = git__calloc(1, sizeof(struct memory_packer_db));\n\tGITERR_CHECK_ALLOC(db);\n\n\tdb->objects = git_oidmap_alloc();\n\n\tdb->parent.read = &impl__read;\n\tdb->parent.write = &impl__write;\n\tdb->parent.read_header = &impl__read_header;\n\tdb->parent.exists = &impl__exists;\n\tdb->parent.free = &impl__free;\n\n\t*out = (git_odb_backend *)db;\n\treturn 0;\n}"
  },
  {
    "function_name": "impl__free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_mempack.c",
    "lines": "161-167",
    "snippet": "static void impl__free(git_odb_backend *_backend)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)_backend;\n\n\tgit_oidmap_free(db->objects);\n\tgit__free(db);\n}",
    "includes": [
      "#include \"git2/pack.h\"",
      "#include \"git2/types.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"oidmap.h\"",
      "#include \"array.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "db"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oidmap_free",
          "args": [
            "db->objects"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/pack.h\"\n#include \"git2/types.h\"\n#include \"git2/odb_backend.h\"\n#include \"oidmap.h\"\n#include \"array.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include \"common.h\"\n\nstatic void impl__free(git_odb_backend *_backend)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)_backend;\n\n\tgit_oidmap_free(db->objects);\n\tgit__free(db);\n}"
  },
  {
    "function_name": "git_mempack_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_mempack.c",
    "lines": "147-159",
    "snippet": "void git_mempack_reset(git_odb_backend *_backend)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)_backend;\n\tstruct memobject *object = NULL;\n\n\tkh_foreach_value(db->objects, object, {\n\t\tgit__free(object);\n\t});\n\n\tgit_array_clear(db->commits);\n\n\tgit_oidmap_clear(db->objects);\n}",
    "includes": [
      "#include \"git2/pack.h\"",
      "#include \"git2/types.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"oidmap.h\"",
      "#include \"array.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_oidmap_clear",
          "args": [
            "db->objects"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "db->commits"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_foreach_value",
          "args": [
            "db->objects",
            "object",
            "{\n\t\tgit__free(object);\n\t}"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "object"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/pack.h\"\n#include \"git2/types.h\"\n#include \"git2/odb_backend.h\"\n#include \"oidmap.h\"\n#include \"array.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include \"common.h\"\n\nvoid git_mempack_reset(git_odb_backend *_backend)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)_backend;\n\tstruct memobject *object = NULL;\n\n\tkh_foreach_value(db->objects, object, {\n\t\tgit__free(object);\n\t});\n\n\tgit_array_clear(db->commits);\n\n\tgit_oidmap_clear(db->objects);\n}"
  },
  {
    "function_name": "git_mempack_dump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_mempack.c",
    "lines": "122-145",
    "snippet": "int git_mempack_dump(git_buf *pack, git_repository *repo, git_odb_backend *_backend)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)_backend;\n\tgit_packbuilder *packbuilder;\n\tuint32_t i;\n\tint err = -1;\n\n\tif (git_packbuilder_new(&packbuilder, repo) < 0)\n\t\treturn -1;\n\n\tfor (i = 0; i < db->commits.size; ++i) {\n\t\tstruct memobject *commit = db->commits.ptr[i];\n\n\t\terr = git_packbuilder_insert_commit(packbuilder, &commit->oid);\n\t\tif (err < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\terr = git_packbuilder_write_buf(pack, packbuilder);\n\ncleanup:\n\tgit_packbuilder_free(packbuilder);\n\treturn err;\n}",
    "includes": [
      "#include \"git2/pack.h\"",
      "#include \"git2/types.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"oidmap.h\"",
      "#include \"array.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_packbuilder_free",
          "args": [
            "packbuilder"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1726-1755",
          "snippet": "void git_packbuilder_free(git_packbuilder *pb)\n{\n\tif (pb == NULL)\n\t\treturn;\n\n#ifdef GIT_THREADS\n\n\tgit_mutex_free(&pb->cache_mutex);\n\tgit_mutex_free(&pb->progress_mutex);\n\tgit_cond_free(&pb->progress_cond);\n\n#endif\n\n\tif (pb->odb)\n\t\tgit_odb_free(pb->odb);\n\n\tif (pb->object_ix)\n\t\tgit_oidmap_free(pb->object_ix);\n\n\tif (pb->object_list)\n\t\tgit__free(pb->object_list);\n\n\tgit_oidmap_free(pb->walk_objects);\n\tgit_pool_clear(&pb->object_pool);\n\n\tgit_hash_ctx_cleanup(&pb->ctx);\n\tgit_zstream_free(&pb->zstream);\n\n\tgit__free(pb);\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nvoid git_packbuilder_free(git_packbuilder *pb)\n{\n\tif (pb == NULL)\n\t\treturn;\n\n#ifdef GIT_THREADS\n\n\tgit_mutex_free(&pb->cache_mutex);\n\tgit_mutex_free(&pb->progress_mutex);\n\tgit_cond_free(&pb->progress_cond);\n\n#endif\n\n\tif (pb->odb)\n\t\tgit_odb_free(pb->odb);\n\n\tif (pb->object_ix)\n\t\tgit_oidmap_free(pb->object_ix);\n\n\tif (pb->object_list)\n\t\tgit__free(pb->object_list);\n\n\tgit_oidmap_free(pb->walk_objects);\n\tgit_pool_clear(&pb->object_pool);\n\n\tgit_hash_ctx_cleanup(&pb->ctx);\n\tgit_zstream_free(&pb->zstream);\n\n\tgit__free(pb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_packbuilder_write_buf",
          "args": [
            "pack",
            "packbuilder"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_write_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1339-1344",
          "snippet": "int git_packbuilder_write_buf(git_buf *buf, git_packbuilder *pb)\n{\n\tPREPARE_PACK;\n\tgit_buf_sanitize(buf);\n\treturn write_pack(pb, &write_pack_buf, buf);\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [
            "#define PREPARE_PACK if (prepare_pack(pb) < 0) { return -1; }"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\n#define PREPARE_PACK if (prepare_pack(pb) < 0) { return -1; }\n\nint git_packbuilder_write_buf(git_buf *buf, git_packbuilder *pb)\n{\n\tPREPARE_PACK;\n\tgit_buf_sanitize(buf);\n\treturn write_pack(pb, &write_pack_buf, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_packbuilder_insert_commit",
          "args": [
            "packbuilder",
            "&commit->oid"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_insert_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "1410-1423",
          "snippet": "int git_packbuilder_insert_commit(git_packbuilder *pb, const git_oid *oid)\n{\n\tgit_commit *commit;\n\n\tif (git_commit_lookup(&commit, pb->repo, oid) < 0 ||\n\t\tgit_packbuilder_insert(pb, oid, NULL) < 0)\n\t\treturn -1;\n\n\tif (git_packbuilder_insert_tree(pb, git_commit_tree_id(commit)) < 0)\n\t\treturn -1;\n\n\tgit_commit_free(commit);\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nint git_packbuilder_insert_commit(git_packbuilder *pb, const git_oid *oid)\n{\n\tgit_commit *commit;\n\n\tif (git_commit_lookup(&commit, pb->repo, oid) < 0 ||\n\t\tgit_packbuilder_insert(pb, oid, NULL) < 0)\n\t\treturn -1;\n\n\tif (git_packbuilder_insert_tree(pb, git_commit_tree_id(commit)) < 0)\n\t\treturn -1;\n\n\tgit_commit_free(commit);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_packbuilder_new",
          "args": [
            "&packbuilder",
            "repo"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "git_packbuilder_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pack-objects.c",
          "lines": "124-170",
          "snippet": "int git_packbuilder_new(git_packbuilder **out, git_repository *repo)\n{\n\tgit_packbuilder *pb;\n\n\t*out = NULL;\n\n\tpb = git__calloc(1, sizeof(*pb));\n\tGITERR_CHECK_ALLOC(pb);\n\n\tpb->object_ix = git_oidmap_alloc();\n\tif (!pb->object_ix)\n\t\tgoto on_error;\n\n\tpb->walk_objects = git_oidmap_alloc();\n\tif (!pb->walk_objects)\n\t\tgoto on_error;\n\n\tgit_pool_init(&pb->object_pool, sizeof(git_walk_object));\n\n\tpb->repo = repo;\n\tpb->nr_threads = 1; /* do not spawn any thread by default */\n\n\tif (git_hash_ctx_init(&pb->ctx) < 0 ||\n\t\tgit_zstream_init(&pb->zstream) < 0 ||\n\t\tgit_repository_odb(&pb->odb, repo) < 0 ||\n\t\tpackbuilder_config(pb) < 0)\n\t\tgoto on_error;\n\n#ifdef GIT_THREADS\n\n\tif (git_mutex_init(&pb->cache_mutex) ||\n\t\tgit_mutex_init(&pb->progress_mutex) ||\n\t\tgit_cond_init(&pb->progress_cond))\n\t{\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize packbuilder mutex\");\n\t\tgoto on_error;\n\t}\n\n#endif\n\n\t*out = pb;\n\treturn 0;\n\non_error:\n\tgit_packbuilder_free(pb);\n\treturn -1;\n}",
          "includes": [
            "#include \"git2/config.h\"",
            "#include \"git2/indexer.h\"",
            "#include \"git2/tag.h\"",
            "#include \"git2/commit.h\"",
            "#include \"git2/pack.h\"",
            "#include \"commit_list.h\"",
            "#include \"revwalk.h\"",
            "#include \"util.h\"",
            "#include \"tree.h\"",
            "#include \"thread-utils.h\"",
            "#include \"pack.h\"",
            "#include \"netops.h\"",
            "#include \"iterator.h\"",
            "#include \"delta.h\"",
            "#include \"zstream.h\"",
            "#include \"pack-objects.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/config.h\"\n#include \"git2/indexer.h\"\n#include \"git2/tag.h\"\n#include \"git2/commit.h\"\n#include \"git2/pack.h\"\n#include \"commit_list.h\"\n#include \"revwalk.h\"\n#include \"util.h\"\n#include \"tree.h\"\n#include \"thread-utils.h\"\n#include \"pack.h\"\n#include \"netops.h\"\n#include \"iterator.h\"\n#include \"delta.h\"\n#include \"zstream.h\"\n#include \"pack-objects.h\"\n\nint git_packbuilder_new(git_packbuilder **out, git_repository *repo)\n{\n\tgit_packbuilder *pb;\n\n\t*out = NULL;\n\n\tpb = git__calloc(1, sizeof(*pb));\n\tGITERR_CHECK_ALLOC(pb);\n\n\tpb->object_ix = git_oidmap_alloc();\n\tif (!pb->object_ix)\n\t\tgoto on_error;\n\n\tpb->walk_objects = git_oidmap_alloc();\n\tif (!pb->walk_objects)\n\t\tgoto on_error;\n\n\tgit_pool_init(&pb->object_pool, sizeof(git_walk_object));\n\n\tpb->repo = repo;\n\tpb->nr_threads = 1; /* do not spawn any thread by default */\n\n\tif (git_hash_ctx_init(&pb->ctx) < 0 ||\n\t\tgit_zstream_init(&pb->zstream) < 0 ||\n\t\tgit_repository_odb(&pb->odb, repo) < 0 ||\n\t\tpackbuilder_config(pb) < 0)\n\t\tgoto on_error;\n\n#ifdef GIT_THREADS\n\n\tif (git_mutex_init(&pb->cache_mutex) ||\n\t\tgit_mutex_init(&pb->progress_mutex) ||\n\t\tgit_cond_init(&pb->progress_cond))\n\t{\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize packbuilder mutex\");\n\t\tgoto on_error;\n\t}\n\n#endif\n\n\t*out = pb;\n\treturn 0;\n\non_error:\n\tgit_packbuilder_free(pb);\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"git2/pack.h\"\n#include \"git2/types.h\"\n#include \"git2/odb_backend.h\"\n#include \"oidmap.h\"\n#include \"array.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include \"common.h\"\n\nint git_mempack_dump(git_buf *pack, git_repository *repo, git_odb_backend *_backend)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)_backend;\n\tgit_packbuilder *packbuilder;\n\tuint32_t i;\n\tint err = -1;\n\n\tif (git_packbuilder_new(&packbuilder, repo) < 0)\n\t\treturn -1;\n\n\tfor (i = 0; i < db->commits.size; ++i) {\n\t\tstruct memobject *commit = db->commits.ptr[i];\n\n\t\terr = git_packbuilder_insert_commit(packbuilder, &commit->oid);\n\t\tif (err < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\terr = git_packbuilder_write_buf(pack, packbuilder);\n\ncleanup:\n\tgit_packbuilder_free(packbuilder);\n\treturn err;\n}"
  },
  {
    "function_name": "impl__read_header",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_mempack.c",
    "lines": "105-120",
    "snippet": "static int impl__read_header(size_t *len_p, git_otype *type_p, git_odb_backend *backend, const git_oid *oid)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)backend;\n\tstruct memobject *obj = NULL;\n\tkhiter_t pos;\n\n\tpos = kh_get(oid, db->objects, oid);\n\tif (pos == kh_end(db->objects))\n\t\treturn GIT_ENOTFOUND;\n\n\tobj = kh_val(db->objects, pos);\n\n\t*len_p = obj->len;\n\t*type_p = obj->type;\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/pack.h\"",
      "#include \"git2/types.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"oidmap.h\"",
      "#include \"array.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kh_val",
          "args": [
            "db->objects",
            "pos"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_end",
          "args": [
            "db->objects"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_get",
          "args": [
            "oid",
            "db->objects",
            "oid"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/pack.h\"\n#include \"git2/types.h\"\n#include \"git2/odb_backend.h\"\n#include \"oidmap.h\"\n#include \"array.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include \"common.h\"\n\nstatic int impl__read_header(size_t *len_p, git_otype *type_p, git_odb_backend *backend, const git_oid *oid)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)backend;\n\tstruct memobject *obj = NULL;\n\tkhiter_t pos;\n\n\tpos = kh_get(oid, db->objects, oid);\n\tif (pos == kh_end(db->objects))\n\t\treturn GIT_ENOTFOUND;\n\n\tobj = kh_val(db->objects, pos);\n\n\t*len_p = obj->len;\n\t*type_p = obj->type;\n\treturn 0;\n}"
  },
  {
    "function_name": "impl__read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_mempack.c",
    "lines": "84-103",
    "snippet": "static int impl__read(void **buffer_p, size_t *len_p, git_otype *type_p, git_odb_backend *backend, const git_oid *oid)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)backend;\n\tstruct memobject *obj = NULL;\n\tkhiter_t pos;\n\n\tpos = kh_get(oid, db->objects, oid);\n\tif (pos == kh_end(db->objects))\n\t\treturn GIT_ENOTFOUND;\n\n\tobj = kh_val(db->objects, pos);\n\n\t*len_p = obj->len;\n\t*type_p = obj->type;\n\t*buffer_p = git__malloc(obj->len);\n\tGITERR_CHECK_ALLOC(*buffer_p);\n\n\tmemcpy(*buffer_p, obj->data, obj->len);\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/pack.h\"",
      "#include \"git2/types.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"oidmap.h\"",
      "#include \"array.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "*buffer_p",
            "obj->data",
            "obj->len"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "*buffer_p"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "obj->len"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kh_val",
          "args": [
            "db->objects",
            "pos"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_end",
          "args": [
            "db->objects"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_get",
          "args": [
            "oid",
            "db->objects",
            "oid"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/pack.h\"\n#include \"git2/types.h\"\n#include \"git2/odb_backend.h\"\n#include \"oidmap.h\"\n#include \"array.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include \"common.h\"\n\nstatic int impl__read(void **buffer_p, size_t *len_p, git_otype *type_p, git_odb_backend *backend, const git_oid *oid)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)backend;\n\tstruct memobject *obj = NULL;\n\tkhiter_t pos;\n\n\tpos = kh_get(oid, db->objects, oid);\n\tif (pos == kh_end(db->objects))\n\t\treturn GIT_ENOTFOUND;\n\n\tobj = kh_val(db->objects, pos);\n\n\t*len_p = obj->len;\n\t*type_p = obj->type;\n\t*buffer_p = git__malloc(obj->len);\n\tGITERR_CHECK_ALLOC(*buffer_p);\n\n\tmemcpy(*buffer_p, obj->data, obj->len);\n\treturn 0;\n}"
  },
  {
    "function_name": "impl__exists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_mempack.c",
    "lines": "72-82",
    "snippet": "static int impl__exists(git_odb_backend *backend, const git_oid *oid)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)backend;\n\tkhiter_t pos;\n\n\tpos = kh_get(oid, db->objects, oid);\n\tif (pos != kh_end(db->objects))\n\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/pack.h\"",
      "#include \"git2/types.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"oidmap.h\"",
      "#include \"array.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kh_end",
          "args": [
            "db->objects"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_get",
          "args": [
            "oid",
            "db->objects",
            "oid"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/pack.h\"\n#include \"git2/types.h\"\n#include \"git2/odb_backend.h\"\n#include \"oidmap.h\"\n#include \"array.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include \"common.h\"\n\nstatic int impl__exists(git_odb_backend *backend, const git_oid *oid)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)backend;\n\tkhiter_t pos;\n\n\tpos = kh_get(oid, db->objects, oid);\n\tif (pos != kh_end(db->objects))\n\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "impl__write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb_mempack.c",
    "lines": "36-70",
    "snippet": "static int impl__write(git_odb_backend *_backend, const git_oid *oid, const void *data, size_t len, git_otype type)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)_backend;\n\tstruct memobject *obj = NULL; \n\tkhiter_t pos;\n\tsize_t alloc_len;\n\tint rval;\n\n\tpos = kh_put(oid, db->objects, oid, &rval);\n\tif (rval < 0)\n\t\treturn -1;\n\n\tif (rval == 0)\n\t\treturn 0;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, sizeof(struct memobject), len);\n\tobj = git__malloc(alloc_len);\n\tGITERR_CHECK_ALLOC(obj);\n\n\tmemcpy(obj->data, data, len);\n\tgit_oid_cpy(&obj->oid, oid);\n\tobj->len = len;\n\tobj->type = type;\n\n\tkh_key(db->objects, pos) = &obj->oid;\n\tkh_val(db->objects, pos) = obj;\n\n\tif (type == GIT_OBJ_COMMIT) {\n\t\tstruct memobject **store = git_array_alloc(db->commits);\n\t\tGITERR_CHECK_ALLOC(store);\n\t\t*store = obj;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"git2/pack.h\"",
      "#include \"git2/types.h\"",
      "#include \"git2/odb_backend.h\"",
      "#include \"oidmap.h\"",
      "#include \"array.h\"",
      "#include \"odb.h\"",
      "#include \"hash.h\"",
      "#include \"fileops.h\"",
      "#include \"git2/sys/odb_backend.h\"",
      "#include \"git2/object.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "store"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "db->commits"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_val",
          "args": [
            "db->objects",
            "pos"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_key",
          "args": [
            "db->objects",
            "pos"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_oid_cpy",
          "args": [
            "&obj->oid",
            "oid"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "174-177",
          "snippet": "void git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_cpy(git_oid *out, const git_oid *src)\n{\n\tmemcpy(out->id, src->id, sizeof(out->id));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "obj->data",
            "data",
            "len"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "obj"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__malloc",
          "args": [
            "alloc_len"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "git__malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "160-165",
          "snippet": "GIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__malloc(size_t len)\n{\n\tvoid *ptr = malloc(len);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC_ADD",
          "args": [
            "&alloc_len",
            "sizeof(struct memobject)",
            "len"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kh_put",
          "args": [
            "oid",
            "db->objects",
            "oid",
            "&rval"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"git2/pack.h\"\n#include \"git2/types.h\"\n#include \"git2/odb_backend.h\"\n#include \"oidmap.h\"\n#include \"array.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include \"common.h\"\n\nstatic int impl__write(git_odb_backend *_backend, const git_oid *oid, const void *data, size_t len, git_otype type)\n{\n\tstruct memory_packer_db *db = (struct memory_packer_db *)_backend;\n\tstruct memobject *obj = NULL; \n\tkhiter_t pos;\n\tsize_t alloc_len;\n\tint rval;\n\n\tpos = kh_put(oid, db->objects, oid, &rval);\n\tif (rval < 0)\n\t\treturn -1;\n\n\tif (rval == 0)\n\t\treturn 0;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, sizeof(struct memobject), len);\n\tobj = git__malloc(alloc_len);\n\tGITERR_CHECK_ALLOC(obj);\n\n\tmemcpy(obj->data, data, len);\n\tgit_oid_cpy(&obj->oid, oid);\n\tobj->len = len;\n\tobj->type = type;\n\n\tkh_key(db->objects, pos) = &obj->oid;\n\tkh_val(db->objects, pos) = obj;\n\n\tif (type == GIT_OBJ_COMMIT) {\n\t\tstruct memobject **store = git_array_alloc(db->commits);\n\t\tGITERR_CHECK_ALLOC(store);\n\t\t*store = obj;\n\t}\n\n\treturn 0;\n}"
  }
]