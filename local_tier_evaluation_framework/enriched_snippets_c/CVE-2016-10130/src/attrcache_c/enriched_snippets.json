[
  {
    "function_name": "git_attr_cache__lookup_macro",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "443-455",
    "snippet": "git_attr_rule *git_attr_cache__lookup_macro(\n\tgit_repository *repo, const char *name)\n{\n\tgit_strmap *macros = git_repository_attr_cache(repo)->macros;\n\tkhiter_t pos;\n\n\tpos = git_strmap_lookup_index(macros, name);\n\n\tif (!git_strmap_valid_index(macros, pos))\n\t\treturn NULL;\n\n\treturn (git_attr_rule *)git_strmap_value_at(macros, pos);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_strmap_value_at",
          "args": [
            "macros",
            "pos"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_valid_index",
          "args": [
            "macros",
            "pos"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_lookup_index",
          "args": [
            "macros",
            "name"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_attr_cache",
          "args": [
            "repo"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_attr_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.h",
          "lines": "148-151",
          "snippet": "GIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}",
          "includes": [
            "#include \"diff_driver.h\"",
            "#include \"submodule.h\"",
            "#include \"attrcache.h\"",
            "#include \"object.h\"",
            "#include \"buffer.h\"",
            "#include \"refs.h\"",
            "#include \"cache.h\"",
            "#include \"array.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_driver.h\"\n#include \"submodule.h\"\n#include \"attrcache.h\"\n#include \"object.h\"\n#include \"buffer.h\"\n#include \"refs.h\"\n#include \"cache.h\"\n#include \"array.h\"\n#include \"git2/config.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\ngit_attr_rule *git_attr_cache__lookup_macro(\n\tgit_repository *repo, const char *name)\n{\n\tgit_strmap *macros = git_repository_attr_cache(repo)->macros;\n\tkhiter_t pos;\n\n\tpos = git_strmap_lookup_index(macros, name);\n\n\tif (!git_strmap_valid_index(macros, pos))\n\t\treturn NULL;\n\n\treturn (git_attr_rule *)git_strmap_value_at(macros, pos);\n}"
  },
  {
    "function_name": "git_attr_cache__insert_macro",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "422-441",
    "snippet": "int git_attr_cache__insert_macro(git_repository *repo, git_attr_rule *macro)\n{\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_strmap *macros = cache->macros;\n\tint error;\n\n\t/* TODO: generate warning log if (macro->assigns.length == 0) */\n\tif (macro->assigns.length == 0)\n\t\treturn 0;\n\n\tif (git_mutex_lock(&cache->lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to get attr cache lock\");\n\t\terror = -1;\n\t} else {\n\t\tgit_strmap_insert(macros, macro->match.pattern, macro, error);\n\t\tgit_mutex_unlock(&cache->lock);\n\t}\n\n\treturn (error < 0) ? -1 : 0;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_mutex_unlock",
          "args": [
            "&cache->lock"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "116-120",
          "snippet": "int git_mutex_unlock(git_mutex *mutex)\n{\n\tLeaveCriticalSection(mutex);\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nint git_mutex_unlock(git_mutex *mutex)\n{\n\tLeaveCriticalSection(mutex);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_insert",
          "args": [
            "macros",
            "macro->match.pattern",
            "macro",
            "error"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Unable to get attr cache lock\""
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_mutex_lock",
          "args": [
            "&cache->lock"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "142-143",
          "snippet": "GIT_INLINE(int) git_mutex_lock(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [
            "#define git_mutex unsigned int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\n#define git_mutex unsigned int\n\nGIT_INLINE(int) git_mutex_lock(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_attr_cache",
          "args": [
            "repo"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_attr_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.h",
          "lines": "148-151",
          "snippet": "GIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}",
          "includes": [
            "#include \"diff_driver.h\"",
            "#include \"submodule.h\"",
            "#include \"attrcache.h\"",
            "#include \"object.h\"",
            "#include \"buffer.h\"",
            "#include \"refs.h\"",
            "#include \"cache.h\"",
            "#include \"array.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_driver.h\"\n#include \"submodule.h\"\n#include \"attrcache.h\"\n#include \"object.h\"\n#include \"buffer.h\"\n#include \"refs.h\"\n#include \"cache.h\"\n#include \"array.h\"\n#include \"git2/config.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_attr_cache__insert_macro(git_repository *repo, git_attr_rule *macro)\n{\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_strmap *macros = cache->macros;\n\tint error;\n\n\t/* TODO: generate warning log if (macro->assigns.length == 0) */\n\tif (macro->assigns.length == 0)\n\t\treturn 0;\n\n\tif (git_mutex_lock(&cache->lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to get attr cache lock\");\n\t\terror = -1;\n\t} else {\n\t\tgit_strmap_insert(macros, macro->match.pattern, macro, error);\n\t\tgit_mutex_unlock(&cache->lock);\n\t}\n\n\treturn (error < 0) ? -1 : 0;\n}"
  },
  {
    "function_name": "git_attr_cache_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "411-420",
    "snippet": "void git_attr_cache_flush(git_repository *repo)\n{\n\tgit_attr_cache *cache;\n\n\t/* this could be done less expensively, but for now, we'll just free\n\t * the entire attrcache and let the next use reinitialize it...\n\t */\n\tif (repo && (cache = git__swap(repo->attrcache, NULL)) != NULL)\n\t\tattr_cache__free(cache);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "attr_cache__free",
          "args": [
            "cache"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "305-352",
          "snippet": "static void attr_cache__free(git_attr_cache *cache)\n{\n\tbool unlock;\n\n\tif (!cache)\n\t\treturn;\n\n\tunlock = (git_mutex_lock(&cache->lock) == 0);\n\n\tif (cache->files != NULL) {\n\t\tgit_attr_file_entry *entry;\n\t\tgit_attr_file *file;\n\t\tint i;\n\n\t\tgit_strmap_foreach_value(cache->files, entry, {\n\t\t\tfor (i = 0; i < GIT_ATTR_FILE_NUM_SOURCES; ++i) {\n\t\t\t\tif ((file = git__swap(entry->file[i], NULL)) != NULL) {\n\t\t\t\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\t\t\t\tgit_attr_file__free(file);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tgit_strmap_free(cache->files);\n\t}\n\n\tif (cache->macros != NULL) {\n\t\tgit_attr_rule *rule;\n\n\t\tgit_strmap_foreach_value(cache->macros, rule, {\n\t\t\tgit_attr_rule__free(rule);\n\t\t});\n\t\tgit_strmap_free(cache->macros);\n\t}\n\n\tgit_pool_clear(&cache->pool);\n\n\tgit__free(cache->cfg_attr_file);\n\tcache->cfg_attr_file = NULL;\n\n\tgit__free(cache->cfg_excl_file);\n\tcache->cfg_excl_file = NULL;\n\n\tif (unlock)\n\t\tgit_mutex_unlock(&cache->lock);\n\tgit_mutex_free(&cache->lock);\n\n\tgit__free(cache);\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic void attr_cache__free(git_attr_cache *cache)\n{\n\tbool unlock;\n\n\tif (!cache)\n\t\treturn;\n\n\tunlock = (git_mutex_lock(&cache->lock) == 0);\n\n\tif (cache->files != NULL) {\n\t\tgit_attr_file_entry *entry;\n\t\tgit_attr_file *file;\n\t\tint i;\n\n\t\tgit_strmap_foreach_value(cache->files, entry, {\n\t\t\tfor (i = 0; i < GIT_ATTR_FILE_NUM_SOURCES; ++i) {\n\t\t\t\tif ((file = git__swap(entry->file[i], NULL)) != NULL) {\n\t\t\t\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\t\t\t\tgit_attr_file__free(file);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tgit_strmap_free(cache->files);\n\t}\n\n\tif (cache->macros != NULL) {\n\t\tgit_attr_rule *rule;\n\n\t\tgit_strmap_foreach_value(cache->macros, rule, {\n\t\t\tgit_attr_rule__free(rule);\n\t\t});\n\t\tgit_strmap_free(cache->macros);\n\t}\n\n\tgit_pool_clear(&cache->pool);\n\n\tgit__free(cache->cfg_attr_file);\n\tcache->cfg_attr_file = NULL;\n\n\tgit__free(cache->cfg_excl_file);\n\tcache->cfg_excl_file = NULL;\n\n\tif (unlock)\n\t\tgit_mutex_unlock(&cache->lock);\n\tgit_mutex_free(&cache->lock);\n\n\tgit__free(cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__swap",
          "args": [
            "repo->attrcache",
            "NULL"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_attr_cache_flush(git_repository *repo)\n{\n\tgit_attr_cache *cache;\n\n\t/* this could be done less expensively, but for now, we'll just free\n\t * the entire attrcache and let the next use reinitialize it...\n\t */\n\tif (repo && (cache = git__swap(repo->attrcache, NULL)) != NULL)\n\t\tattr_cache__free(cache);\n}"
  },
  {
    "function_name": "git_attr_cache__do_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "354-409",
    "snippet": "int git_attr_cache__do_init(git_repository *repo)\n{\n\tint ret = 0;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_config *cfg = NULL;\n\n\tif (cache)\n\t\treturn 0;\n\n\tcache = git__calloc(1, sizeof(git_attr_cache));\n\tGITERR_CHECK_ALLOC(cache);\n\n\t/* set up lock */\n\tif (git_mutex_init(&cache->lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to initialize lock for attr cache\");\n\t\tgit__free(cache);\n\t\treturn -1;\n\t}\n\n\tif ((ret = git_repository_config_snapshot(&cfg, repo)) < 0)\n\t\tgoto cancel;\n\n\t/* cache config settings for attributes and ignores */\n\tret = attr_cache__lookup_path(\n\t\t&cache->cfg_attr_file, cfg, GIT_ATTR_CONFIG, GIT_ATTR_FILE_XDG);\n\tif (ret < 0)\n\t\tgoto cancel;\n\n\tret = attr_cache__lookup_path(\n\t\t&cache->cfg_excl_file, cfg, GIT_IGNORE_CONFIG, GIT_IGNORE_FILE_XDG);\n\tif (ret < 0)\n\t\tgoto cancel;\n\n\t/* allocate hashtable for attribute and ignore file contents,\n\t * hashtable for attribute macros, and string pool\n\t */\n\tif ((ret = git_strmap_alloc(&cache->files)) < 0 ||\n\t\t(ret = git_strmap_alloc(&cache->macros)) < 0)\n\t\tgoto cancel;\n\n\tgit_pool_init(&cache->pool, 1);\n\n\tcache = git__compare_and_swap(&repo->attrcache, NULL, cache);\n\tif (cache)\n\t\tgoto cancel; /* raced with another thread, free this but no error */\n\n\tgit_config_free(cfg);\n\n\t/* insert default macros */\n\treturn git_attr_add_macro(repo, \"binary\", \"-diff -crlf -text\");\n\ncancel:\n\tattr_cache__free(cache);\n\tgit_config_free(cfg);\n\treturn ret;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "cfg"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_cache__free",
          "args": [
            "cache"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "305-352",
          "snippet": "static void attr_cache__free(git_attr_cache *cache)\n{\n\tbool unlock;\n\n\tif (!cache)\n\t\treturn;\n\n\tunlock = (git_mutex_lock(&cache->lock) == 0);\n\n\tif (cache->files != NULL) {\n\t\tgit_attr_file_entry *entry;\n\t\tgit_attr_file *file;\n\t\tint i;\n\n\t\tgit_strmap_foreach_value(cache->files, entry, {\n\t\t\tfor (i = 0; i < GIT_ATTR_FILE_NUM_SOURCES; ++i) {\n\t\t\t\tif ((file = git__swap(entry->file[i], NULL)) != NULL) {\n\t\t\t\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\t\t\t\tgit_attr_file__free(file);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tgit_strmap_free(cache->files);\n\t}\n\n\tif (cache->macros != NULL) {\n\t\tgit_attr_rule *rule;\n\n\t\tgit_strmap_foreach_value(cache->macros, rule, {\n\t\t\tgit_attr_rule__free(rule);\n\t\t});\n\t\tgit_strmap_free(cache->macros);\n\t}\n\n\tgit_pool_clear(&cache->pool);\n\n\tgit__free(cache->cfg_attr_file);\n\tcache->cfg_attr_file = NULL;\n\n\tgit__free(cache->cfg_excl_file);\n\tcache->cfg_excl_file = NULL;\n\n\tif (unlock)\n\t\tgit_mutex_unlock(&cache->lock);\n\tgit_mutex_free(&cache->lock);\n\n\tgit__free(cache);\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic void attr_cache__free(git_attr_cache *cache)\n{\n\tbool unlock;\n\n\tif (!cache)\n\t\treturn;\n\n\tunlock = (git_mutex_lock(&cache->lock) == 0);\n\n\tif (cache->files != NULL) {\n\t\tgit_attr_file_entry *entry;\n\t\tgit_attr_file *file;\n\t\tint i;\n\n\t\tgit_strmap_foreach_value(cache->files, entry, {\n\t\t\tfor (i = 0; i < GIT_ATTR_FILE_NUM_SOURCES; ++i) {\n\t\t\t\tif ((file = git__swap(entry->file[i], NULL)) != NULL) {\n\t\t\t\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\t\t\t\tgit_attr_file__free(file);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tgit_strmap_free(cache->files);\n\t}\n\n\tif (cache->macros != NULL) {\n\t\tgit_attr_rule *rule;\n\n\t\tgit_strmap_foreach_value(cache->macros, rule, {\n\t\t\tgit_attr_rule__free(rule);\n\t\t});\n\t\tgit_strmap_free(cache->macros);\n\t}\n\n\tgit_pool_clear(&cache->pool);\n\n\tgit__free(cache->cfg_attr_file);\n\tcache->cfg_attr_file = NULL;\n\n\tgit__free(cache->cfg_excl_file);\n\tcache->cfg_excl_file = NULL;\n\n\tif (unlock)\n\t\tgit_mutex_unlock(&cache->lock);\n\tgit_mutex_free(&cache->lock);\n\n\tgit__free(cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_attr_add_macro",
          "args": [
            "repo",
            "\"binary\"",
            "\"-diff -crlf -text\""
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_add_macro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr.c",
          "lines": "344-376",
          "snippet": "int git_attr_add_macro(\n\tgit_repository *repo,\n\tconst char *name,\n\tconst char *values)\n{\n\tint error;\n\tgit_attr_rule *macro = NULL;\n\tgit_pool *pool;\n\n\tif ((error = git_attr_cache__init(repo)) < 0)\n\t\treturn error;\n\n\tmacro = git__calloc(1, sizeof(git_attr_rule));\n\tGITERR_CHECK_ALLOC(macro);\n\n\tpool = &git_repository_attr_cache(repo)->pool;\n\n\tmacro->match.pattern = git_pool_strdup(pool, name);\n\tGITERR_CHECK_ALLOC(macro->match.pattern);\n\n\tmacro->match.length = strlen(macro->match.pattern);\n\tmacro->match.flags = GIT_ATTR_FNMATCH_MACRO;\n\n\terror = git_attr_assignment__parse(repo, pool, &macro->assigns, &values);\n\n\tif (!error)\n\t\terror = git_attr_cache__insert_macro(repo, macro);\n\n\tif (error < 0)\n\t\tgit_attr_rule__free(macro);\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"git2/oid.h\"",
            "#include \"ignore.h\"",
            "#include \"attr_file.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"git2/oid.h\"\n#include \"ignore.h\"\n#include \"attr_file.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_attr_add_macro(\n\tgit_repository *repo,\n\tconst char *name,\n\tconst char *values)\n{\n\tint error;\n\tgit_attr_rule *macro = NULL;\n\tgit_pool *pool;\n\n\tif ((error = git_attr_cache__init(repo)) < 0)\n\t\treturn error;\n\n\tmacro = git__calloc(1, sizeof(git_attr_rule));\n\tGITERR_CHECK_ALLOC(macro);\n\n\tpool = &git_repository_attr_cache(repo)->pool;\n\n\tmacro->match.pattern = git_pool_strdup(pool, name);\n\tGITERR_CHECK_ALLOC(macro->match.pattern);\n\n\tmacro->match.length = strlen(macro->match.pattern);\n\tmacro->match.flags = GIT_ATTR_FNMATCH_MACRO;\n\n\terror = git_attr_assignment__parse(repo, pool, &macro->assigns, &values);\n\n\tif (!error)\n\t\terror = git_attr_cache__insert_macro(repo, macro);\n\n\tif (error < 0)\n\t\tgit_attr_rule__free(macro);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__compare_and_swap",
          "args": [
            "&repo->attrcache",
            "NULL",
            "cache"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pool_init",
          "args": [
            "&cache->pool",
            "1"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "120-129",
          "snippet": "void git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_init(git_pool *pool, uint32_t item_size)\n{\n\tassert(pool);\n\tassert(item_size >= 1);\n\n\tmemset(pool, 0, sizeof(git_pool));\n\tpool->item_size = item_size;\n\tpool->page_size = git_pool__system_page_size();\n\tgit_vector_init(&pool->allocations, 100, git_pool__ptr_cmp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_alloc",
          "args": [
            "&cache->macros"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_alloc",
          "args": [
            "&cache->files"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attr_cache__lookup_path",
          "args": [
            "&cache->cfg_excl_file",
            "cfg",
            "GIT_IGNORE_CONFIG",
            "GIT_IGNORE_FILE_XDG"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache__lookup_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "274-303",
          "snippet": "static int attr_cache__lookup_path(\n\tchar **out, git_config *cfg, const char *key, const char *fallback)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\tgit_config_entry *entry = NULL;\n\n\t*out = NULL;\n\n\tif ((error = git_config__lookup_entry(&entry, cfg, key, false)) < 0)\n\t\treturn error;\n\n\tif (entry) {\n\t\tconst char *cfgval = entry->value;\n\n\t\t/* expand leading ~/ as needed */\n\t\tif (cfgval && cfgval[0] == '~' && cfgval[1] == '/' &&\n\t\t\t!git_sysdir_find_global_file(&buf, &cfgval[2]))\n\t\t\t*out = git_buf_detach(&buf);\n\t\telse if (cfgval)\n\t\t\t*out = git__strdup(cfgval);\n\t}\n\telse if (!git_sysdir_find_xdg_file(&buf, fallback))\n\t\t*out = git_buf_detach(&buf);\n\n\tgit_config_entry_free(entry);\n\tgit_buf_free(&buf);\n\n\treturn error;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache__lookup_path(\n\tchar **out, git_config *cfg, const char *key, const char *fallback)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\tgit_config_entry *entry = NULL;\n\n\t*out = NULL;\n\n\tif ((error = git_config__lookup_entry(&entry, cfg, key, false)) < 0)\n\t\treturn error;\n\n\tif (entry) {\n\t\tconst char *cfgval = entry->value;\n\n\t\t/* expand leading ~/ as needed */\n\t\tif (cfgval && cfgval[0] == '~' && cfgval[1] == '/' &&\n\t\t\t!git_sysdir_find_global_file(&buf, &cfgval[2]))\n\t\t\t*out = git_buf_detach(&buf);\n\t\telse if (cfgval)\n\t\t\t*out = git__strdup(cfgval);\n\t}\n\telse if (!git_sysdir_find_xdg_file(&buf, fallback))\n\t\t*out = git_buf_detach(&buf);\n\n\tgit_config_entry_free(entry);\n\tgit_buf_free(&buf);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config_snapshot",
          "args": [
            "&cfg",
            "repo"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config_snapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "716-725",
          "snippet": "int git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "cache"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Unable to initialize lock for attr cache\""
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_mutex_init",
          "args": [
            "&cache->lock"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "140-141",
          "snippet": "GIT_INLINE(int) git_mutex_init(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [
            "#define git_mutex unsigned int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\n#define git_mutex unsigned int\n\nGIT_INLINE(int) git_mutex_init(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "cache"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_attr_cache)"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_attr_cache",
          "args": [
            "repo"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_attr_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.h",
          "lines": "148-151",
          "snippet": "GIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}",
          "includes": [
            "#include \"diff_driver.h\"",
            "#include \"submodule.h\"",
            "#include \"attrcache.h\"",
            "#include \"object.h\"",
            "#include \"buffer.h\"",
            "#include \"refs.h\"",
            "#include \"cache.h\"",
            "#include \"array.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_driver.h\"\n#include \"submodule.h\"\n#include \"attrcache.h\"\n#include \"object.h\"\n#include \"buffer.h\"\n#include \"refs.h\"\n#include \"cache.h\"\n#include \"array.h\"\n#include \"git2/config.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_attr_cache__do_init(git_repository *repo)\n{\n\tint ret = 0;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_config *cfg = NULL;\n\n\tif (cache)\n\t\treturn 0;\n\n\tcache = git__calloc(1, sizeof(git_attr_cache));\n\tGITERR_CHECK_ALLOC(cache);\n\n\t/* set up lock */\n\tif (git_mutex_init(&cache->lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to initialize lock for attr cache\");\n\t\tgit__free(cache);\n\t\treturn -1;\n\t}\n\n\tif ((ret = git_repository_config_snapshot(&cfg, repo)) < 0)\n\t\tgoto cancel;\n\n\t/* cache config settings for attributes and ignores */\n\tret = attr_cache__lookup_path(\n\t\t&cache->cfg_attr_file, cfg, GIT_ATTR_CONFIG, GIT_ATTR_FILE_XDG);\n\tif (ret < 0)\n\t\tgoto cancel;\n\n\tret = attr_cache__lookup_path(\n\t\t&cache->cfg_excl_file, cfg, GIT_IGNORE_CONFIG, GIT_IGNORE_FILE_XDG);\n\tif (ret < 0)\n\t\tgoto cancel;\n\n\t/* allocate hashtable for attribute and ignore file contents,\n\t * hashtable for attribute macros, and string pool\n\t */\n\tif ((ret = git_strmap_alloc(&cache->files)) < 0 ||\n\t\t(ret = git_strmap_alloc(&cache->macros)) < 0)\n\t\tgoto cancel;\n\n\tgit_pool_init(&cache->pool, 1);\n\n\tcache = git__compare_and_swap(&repo->attrcache, NULL, cache);\n\tif (cache)\n\t\tgoto cancel; /* raced with another thread, free this but no error */\n\n\tgit_config_free(cfg);\n\n\t/* insert default macros */\n\treturn git_attr_add_macro(repo, \"binary\", \"-diff -crlf -text\");\n\ncancel:\n\tattr_cache__free(cache);\n\tgit_config_free(cfg);\n\treturn ret;\n}"
  },
  {
    "function_name": "attr_cache__free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "305-352",
    "snippet": "static void attr_cache__free(git_attr_cache *cache)\n{\n\tbool unlock;\n\n\tif (!cache)\n\t\treturn;\n\n\tunlock = (git_mutex_lock(&cache->lock) == 0);\n\n\tif (cache->files != NULL) {\n\t\tgit_attr_file_entry *entry;\n\t\tgit_attr_file *file;\n\t\tint i;\n\n\t\tgit_strmap_foreach_value(cache->files, entry, {\n\t\t\tfor (i = 0; i < GIT_ATTR_FILE_NUM_SOURCES; ++i) {\n\t\t\t\tif ((file = git__swap(entry->file[i], NULL)) != NULL) {\n\t\t\t\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\t\t\t\tgit_attr_file__free(file);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tgit_strmap_free(cache->files);\n\t}\n\n\tif (cache->macros != NULL) {\n\t\tgit_attr_rule *rule;\n\n\t\tgit_strmap_foreach_value(cache->macros, rule, {\n\t\t\tgit_attr_rule__free(rule);\n\t\t});\n\t\tgit_strmap_free(cache->macros);\n\t}\n\n\tgit_pool_clear(&cache->pool);\n\n\tgit__free(cache->cfg_attr_file);\n\tcache->cfg_attr_file = NULL;\n\n\tgit__free(cache->cfg_excl_file);\n\tcache->cfg_excl_file = NULL;\n\n\tif (unlock)\n\t\tgit_mutex_unlock(&cache->lock);\n\tgit_mutex_free(&cache->lock);\n\n\tgit__free(cache);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "cache"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_mutex_free",
          "args": [
            "&cache->lock"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "104-108",
          "snippet": "int git_mutex_free(git_mutex *mutex)\n{\n\tDeleteCriticalSection(mutex);\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nint git_mutex_free(git_mutex *mutex)\n{\n\tDeleteCriticalSection(mutex);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_mutex_unlock",
          "args": [
            "&cache->lock"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "116-120",
          "snippet": "int git_mutex_unlock(git_mutex *mutex)\n{\n\tLeaveCriticalSection(mutex);\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nint git_mutex_unlock(git_mutex *mutex)\n{\n\tLeaveCriticalSection(mutex);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_pool_clear",
          "args": [
            "&cache->pool"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "131-134",
          "snippet": "void git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nvoid git_pool_clear(git_pool *pool)\n{\n\tgit_vector_free_deep(&pool->allocations);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_free",
          "args": [
            "cache->macros"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_foreach_value",
          "args": [
            "cache->macros",
            "rule",
            "{\n\t\t\tgit_attr_rule__free(rule);\n\t\t}"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_attr_rule__free",
          "args": [
            "rule"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_rule__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr_file.c",
          "lines": "842-846",
          "snippet": "void git_attr_rule__free(git_attr_rule *rule)\n{\n\tgit_attr_rule__clear(rule);\n\tgit__free(rule);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/blob.h\"",
            "#include \"attrcache.h\"",
            "#include \"attr_file.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void git_attr_rule__clear(git_attr_rule *rule);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"index.h\"\n#include \"git2/tree.h\"\n#include \"git2/blob.h\"\n#include \"attrcache.h\"\n#include \"attr_file.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic void git_attr_rule__clear(git_attr_rule *rule);\n\nvoid git_attr_rule__free(git_attr_rule *rule)\n{\n\tgit_attr_rule__clear(rule);\n\tgit__free(rule);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_strmap_free",
          "args": [
            "cache->files"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_foreach_value",
          "args": [
            "cache->files",
            "entry",
            "{\n\t\t\tfor (i = 0; i < GIT_ATTR_FILE_NUM_SOURCES; ++i) {\n\t\t\t\tif ((file = git__swap(entry->file[i], NULL)) != NULL) {\n\t\t\t\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\t\t\t\tgit_attr_file__free(file);\n\t\t\t\t}\n\t\t\t}\n\t\t}"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_attr_file__free",
          "args": [
            "file"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_file__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr_file.c",
          "lines": "66-71",
          "snippet": "void git_attr_file__free(git_attr_file *file)\n{\n\tif (!file)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(file, attr_file_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/blob.h\"",
            "#include \"attrcache.h\"",
            "#include \"attr_file.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"index.h\"\n#include \"git2/tree.h\"\n#include \"git2/blob.h\"\n#include \"attrcache.h\"\n#include \"attr_file.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_attr_file__free(git_attr_file *file)\n{\n\tif (!file)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(file, attr_file_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "file",
            "NULL"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__swap",
          "args": [
            "entry->file[i]",
            "NULL"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_mutex_lock",
          "args": [
            "&cache->lock"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "142-143",
          "snippet": "GIT_INLINE(int) git_mutex_lock(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [
            "#define git_mutex unsigned int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\n#define git_mutex unsigned int\n\nGIT_INLINE(int) git_mutex_lock(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic void attr_cache__free(git_attr_cache *cache)\n{\n\tbool unlock;\n\n\tif (!cache)\n\t\treturn;\n\n\tunlock = (git_mutex_lock(&cache->lock) == 0);\n\n\tif (cache->files != NULL) {\n\t\tgit_attr_file_entry *entry;\n\t\tgit_attr_file *file;\n\t\tint i;\n\n\t\tgit_strmap_foreach_value(cache->files, entry, {\n\t\t\tfor (i = 0; i < GIT_ATTR_FILE_NUM_SOURCES; ++i) {\n\t\t\t\tif ((file = git__swap(entry->file[i], NULL)) != NULL) {\n\t\t\t\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\t\t\t\tgit_attr_file__free(file);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tgit_strmap_free(cache->files);\n\t}\n\n\tif (cache->macros != NULL) {\n\t\tgit_attr_rule *rule;\n\n\t\tgit_strmap_foreach_value(cache->macros, rule, {\n\t\t\tgit_attr_rule__free(rule);\n\t\t});\n\t\tgit_strmap_free(cache->macros);\n\t}\n\n\tgit_pool_clear(&cache->pool);\n\n\tgit__free(cache->cfg_attr_file);\n\tcache->cfg_attr_file = NULL;\n\n\tgit__free(cache->cfg_excl_file);\n\tcache->cfg_excl_file = NULL;\n\n\tif (unlock)\n\t\tgit_mutex_unlock(&cache->lock);\n\tgit_mutex_free(&cache->lock);\n\n\tgit__free(cache);\n}"
  },
  {
    "function_name": "attr_cache__lookup_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "274-303",
    "snippet": "static int attr_cache__lookup_path(\n\tchar **out, git_config *cfg, const char *key, const char *fallback)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\tgit_config_entry *entry = NULL;\n\n\t*out = NULL;\n\n\tif ((error = git_config__lookup_entry(&entry, cfg, key, false)) < 0)\n\t\treturn error;\n\n\tif (entry) {\n\t\tconst char *cfgval = entry->value;\n\n\t\t/* expand leading ~/ as needed */\n\t\tif (cfgval && cfgval[0] == '~' && cfgval[1] == '/' &&\n\t\t\t!git_sysdir_find_global_file(&buf, &cfgval[2]))\n\t\t\t*out = git_buf_detach(&buf);\n\t\telse if (cfgval)\n\t\t\t*out = git__strdup(cfgval);\n\t}\n\telse if (!git_sysdir_find_xdg_file(&buf, fallback))\n\t\t*out = git_buf_detach(&buf);\n\n\tgit_config_entry_free(entry);\n\tgit_buf_free(&buf);\n\n\treturn error;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "entry"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&buf"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_sysdir_find_xdg_file",
          "args": [
            "&buf",
            "fallback"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_xdg_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "260-264",
          "snippet": "int git_sysdir_find_xdg_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_XDG, \"global/xdg\");\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_xdg_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_XDG, \"global/xdg\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "cfgval"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_sysdir_find_global_file",
          "args": [
            "&buf",
            "&cfgval[2]"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_global_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "254-258",
          "snippet": "int git_sysdir_find_global_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_GLOBAL, \"global\");\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_global_file(git_buf *path, const char *filename)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, filename, GIT_SYSDIR_GLOBAL, \"global\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config__lookup_entry",
          "args": [
            "&entry",
            "cfg",
            "key",
            "false"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__lookup_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "737-745",
          "snippet": "int git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache__lookup_path(\n\tchar **out, git_config *cfg, const char *key, const char *fallback)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\tgit_config_entry *entry = NULL;\n\n\t*out = NULL;\n\n\tif ((error = git_config__lookup_entry(&entry, cfg, key, false)) < 0)\n\t\treturn error;\n\n\tif (entry) {\n\t\tconst char *cfgval = entry->value;\n\n\t\t/* expand leading ~/ as needed */\n\t\tif (cfgval && cfgval[0] == '~' && cfgval[1] == '/' &&\n\t\t\t!git_sysdir_find_global_file(&buf, &cfgval[2]))\n\t\t\t*out = git_buf_detach(&buf);\n\t\telse if (cfgval)\n\t\t\t*out = git__strdup(cfgval);\n\t}\n\telse if (!git_sysdir_find_xdg_file(&buf, fallback))\n\t\t*out = git_buf_detach(&buf);\n\n\tgit_config_entry_free(entry);\n\tgit_buf_free(&buf);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_attr_cache__is_cached",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "251-271",
    "snippet": "bool git_attr_cache__is_cached(\n\tgit_repository *repo,\n\tgit_attr_file_source source,\n\tconst char *filename)\n{\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_strmap *files;\n\tkhiter_t pos;\n\tgit_attr_file_entry *entry;\n\n\tif (!cache || !(files = cache->files))\n\t\treturn false;\n\n\tpos = git_strmap_lookup_index(files, filename);\n\tif (!git_strmap_valid_index(files, pos))\n\t\treturn false;\n\n\tentry = git_strmap_value_at(files, pos);\n\n\treturn entry && (entry->file[source] != NULL);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_strmap_value_at",
          "args": [
            "files",
            "pos"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_valid_index",
          "args": [
            "files",
            "pos"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_lookup_index",
          "args": [
            "files",
            "filename"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_attr_cache",
          "args": [
            "repo"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_attr_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.h",
          "lines": "148-151",
          "snippet": "GIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}",
          "includes": [
            "#include \"diff_driver.h\"",
            "#include \"submodule.h\"",
            "#include \"attrcache.h\"",
            "#include \"object.h\"",
            "#include \"buffer.h\"",
            "#include \"refs.h\"",
            "#include \"cache.h\"",
            "#include \"array.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_driver.h\"\n#include \"submodule.h\"\n#include \"attrcache.h\"\n#include \"object.h\"\n#include \"buffer.h\"\n#include \"refs.h\"\n#include \"cache.h\"\n#include \"array.h\"\n#include \"git2/config.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nbool git_attr_cache__is_cached(\n\tgit_repository *repo,\n\tgit_attr_file_source source,\n\tconst char *filename)\n{\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_strmap *files;\n\tkhiter_t pos;\n\tgit_attr_file_entry *entry;\n\n\tif (!cache || !(files = cache->files))\n\t\treturn false;\n\n\tpos = git_strmap_lookup_index(files, filename);\n\tif (!git_strmap_valid_index(files, pos))\n\t\treturn false;\n\n\tentry = git_strmap_value_at(files, pos);\n\n\treturn entry && (entry->file[source] != NULL);\n}"
  },
  {
    "function_name": "git_attr_cache__get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "200-249",
    "snippet": "int git_attr_cache__get(\n\tgit_attr_file **out,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file_source source,\n\tconst char *base,\n\tconst char *filename,\n\tgit_attr_file_parser parser)\n{\n\tint error = 0;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\tgit_attr_file *file = NULL, *updated = NULL;\n\n\tif ((error = attr_cache_lookup(\n\t\t\t&file, &entry, repo, attr_session, source, base, filename)) < 0)\n\t\treturn error;\n\n\t/* load file if we don't have one or if existing one is out of date */\n\tif (!file || (error = git_attr_file__out_of_date(repo, attr_session, file)) > 0)\n\t\terror = git_attr_file__load(&updated, repo, attr_session, entry, source, parser);\n\n\t/* if we loaded the file, insert into and/or update cache */\n\tif (updated) {\n\t\tif ((error = attr_cache_upsert(cache, updated)) < 0)\n\t\t\tgit_attr_file__free(updated);\n\t\telse {\n\t\t\tgit_attr_file__free(file); /* offset incref from lookup */\n\t\t\tfile = updated;\n\t\t}\n\t}\n\n\t/* if file could not be loaded */\n\tif (error < 0) {\n\t\t/* remove existing entry */\n\t\tif (file) {\n\t\t\tattr_cache_remove(cache, file);\n\t\t\tgit_attr_file__free(file); /* offset incref from lookup */\n\t\t\tfile = NULL;\n\t\t}\n\t\t/* no error if file simply doesn't exist */\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\t*out = file;\n\treturn error;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_attr_file__free",
          "args": [
            "file"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_file__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr_file.c",
          "lines": "66-71",
          "snippet": "void git_attr_file__free(git_attr_file *file)\n{\n\tif (!file)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(file, attr_file_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/blob.h\"",
            "#include \"attrcache.h\"",
            "#include \"attr_file.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"index.h\"\n#include \"git2/tree.h\"\n#include \"git2/blob.h\"\n#include \"attrcache.h\"\n#include \"attr_file.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_attr_file__free(git_attr_file *file)\n{\n\tif (!file)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(file, attr_file_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_cache_remove",
          "args": [
            "cache",
            "file"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "120-141",
          "snippet": "static int attr_cache_remove(git_attr_cache *cache, git_attr_file *file)\n{\n\tint error = 0;\n\tgit_attr_file_entry *entry;\n\n\tif (!file)\n\t\treturn 0;\n\tif ((error = attr_cache_lock(cache)) < 0)\n\t\treturn error;\n\n\tif ((entry = attr_cache_lookup_entry(cache, file->entry->path)) != NULL)\n\t\tfile = git__compare_and_swap(&entry->file[file->source], file, NULL);\n\n\tattr_cache_unlock(cache);\n\n\tif (file) {\n\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\tgit_attr_file__free(file);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache_remove(git_attr_cache *cache, git_attr_file *file)\n{\n\tint error = 0;\n\tgit_attr_file_entry *entry;\n\n\tif (!file)\n\t\treturn 0;\n\tif ((error = attr_cache_lock(cache)) < 0)\n\t\treturn error;\n\n\tif ((entry = attr_cache_lookup_entry(cache, file->entry->path)) != NULL)\n\t\tfile = git__compare_and_swap(&entry->file[file->source], file, NULL);\n\n\tattr_cache_unlock(cache);\n\n\tif (file) {\n\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\tgit_attr_file__free(file);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_cache_upsert",
          "args": [
            "cache",
            "updated"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_upsert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "95-118",
          "snippet": "static int attr_cache_upsert(git_attr_cache *cache, git_attr_file *file)\n{\n\tgit_attr_file_entry *entry;\n\tgit_attr_file *old;\n\n\tif (attr_cache_lock(cache) < 0)\n\t\treturn -1;\n\n\tentry = attr_cache_lookup_entry(cache, file->entry->path);\n\n\tGIT_REFCOUNT_OWN(file, entry);\n\tGIT_REFCOUNT_INC(file);\n\n\told = git__compare_and_swap(\n\t\t&entry->file[file->source], entry->file[file->source], file);\n\n\tif (old) {\n\t\tGIT_REFCOUNT_OWN(old, NULL);\n\t\tgit_attr_file__free(old);\n\t}\n\n\tattr_cache_unlock(cache);\n\treturn 0;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache_upsert(git_attr_cache *cache, git_attr_file *file)\n{\n\tgit_attr_file_entry *entry;\n\tgit_attr_file *old;\n\n\tif (attr_cache_lock(cache) < 0)\n\t\treturn -1;\n\n\tentry = attr_cache_lookup_entry(cache, file->entry->path);\n\n\tGIT_REFCOUNT_OWN(file, entry);\n\tGIT_REFCOUNT_INC(file);\n\n\told = git__compare_and_swap(\n\t\t&entry->file[file->source], entry->file[file->source], file);\n\n\tif (old) {\n\t\tGIT_REFCOUNT_OWN(old, NULL);\n\t\tgit_attr_file__free(old);\n\t}\n\n\tattr_cache_unlock(cache);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_attr_file__load",
          "args": [
            "&updated",
            "repo",
            "attr_session",
            "entry",
            "source",
            "parser"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_file__load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr_file.c",
          "lines": "92-177",
          "snippet": "int git_attr_file__load(\n\tgit_attr_file **out,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file_entry *entry,\n\tgit_attr_file_source source,\n\tgit_attr_file_parser parser)\n{\n\tint error = 0;\n\tgit_blob *blob = NULL;\n\tgit_buf content = GIT_BUF_INIT;\n\tgit_attr_file *file;\n\tstruct stat st;\n\tbool nonexistent = false;\n\n\t*out = NULL;\n\n\tswitch (source) {\n\tcase GIT_ATTR_FILE__IN_MEMORY:\n\t\t/* in-memory attribute file doesn't need data */\n\t\tbreak;\n\tcase GIT_ATTR_FILE__FROM_INDEX: {\n\t\tgit_oid id;\n\n\t\tif ((error = attr_file_oid_from_index(&id, repo, entry->path)) < 0 ||\n\t\t\t(error = git_blob_lookup(&blob, repo, &id)) < 0)\n\t\t\treturn error;\n\n\t\t/* Do not assume that data straight from the ODB is NULL-terminated;\n\t\t * copy the contents of a file to a buffer to work on */\n\t\tgit_buf_put(&content, git_blob_rawcontent(blob), git_blob_rawsize(blob));\n\t\tbreak;\n\t}\n\tcase GIT_ATTR_FILE__FROM_FILE: {\n\t\tint fd = -1;\n\n\t\t/* For open or read errors, pretend that we got ENOTFOUND. */\n\t\t/* TODO: issue warning when warning API is available */\n\n\t\tif (p_stat(entry->fullpath, &st) < 0 ||\n\t\t\tS_ISDIR(st.st_mode) ||\n\t\t\t(fd = git_futils_open_ro(entry->fullpath)) < 0 ||\n\t\t\t(error = git_futils_readbuffer_fd(&content, fd, (size_t)st.st_size)) < 0)\n\t\t\tnonexistent = true;\n\n\t\tif (fd >= 0)\n\t\t\tp_close(fd);\n\n\t\tbreak;\n\t}\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Unknown file source %d\", source);\n\t\treturn -1;\n\t}\n\n\tif ((error = git_attr_file__new(&file, entry, source)) < 0)\n\t\tgoto cleanup;\n\n\t/* store the key of the attr_reader; don't bother with cache\n\t * invalidation during the same attr reader session.\n\t */\n\tif (attr_session)\n\t\tfile->session_key = attr_session->key;\n\n\tif (parser && (error = parser(repo, file, git_buf_cstr(&content))) < 0) {\n\t\tgit_attr_file__free(file);\n\t\tgoto cleanup;\n\t}\n\n\t/* write cache breakers */\n\tif (nonexistent)\n\t\tfile->nonexistent = 1;\n\telse if (source == GIT_ATTR_FILE__FROM_INDEX)\n\t\tgit_oid_cpy(&file->cache_data.oid, git_blob_id(blob));\n\telse if (source == GIT_ATTR_FILE__FROM_FILE)\n\t\tgit_futils_filestamp_set_from_stat(&file->cache_data.stamp, &st);\n\t/* else always cacheable */\n\n\t*out = file;\n\ncleanup:\n\tgit_blob_free(blob);\n\tgit_buf_free(&content);\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/blob.h\"",
            "#include \"attrcache.h\"",
            "#include \"attr_file.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"index.h\"\n#include \"git2/tree.h\"\n#include \"git2/blob.h\"\n#include \"attrcache.h\"\n#include \"attr_file.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_attr_file__load(\n\tgit_attr_file **out,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file_entry *entry,\n\tgit_attr_file_source source,\n\tgit_attr_file_parser parser)\n{\n\tint error = 0;\n\tgit_blob *blob = NULL;\n\tgit_buf content = GIT_BUF_INIT;\n\tgit_attr_file *file;\n\tstruct stat st;\n\tbool nonexistent = false;\n\n\t*out = NULL;\n\n\tswitch (source) {\n\tcase GIT_ATTR_FILE__IN_MEMORY:\n\t\t/* in-memory attribute file doesn't need data */\n\t\tbreak;\n\tcase GIT_ATTR_FILE__FROM_INDEX: {\n\t\tgit_oid id;\n\n\t\tif ((error = attr_file_oid_from_index(&id, repo, entry->path)) < 0 ||\n\t\t\t(error = git_blob_lookup(&blob, repo, &id)) < 0)\n\t\t\treturn error;\n\n\t\t/* Do not assume that data straight from the ODB is NULL-terminated;\n\t\t * copy the contents of a file to a buffer to work on */\n\t\tgit_buf_put(&content, git_blob_rawcontent(blob), git_blob_rawsize(blob));\n\t\tbreak;\n\t}\n\tcase GIT_ATTR_FILE__FROM_FILE: {\n\t\tint fd = -1;\n\n\t\t/* For open or read errors, pretend that we got ENOTFOUND. */\n\t\t/* TODO: issue warning when warning API is available */\n\n\t\tif (p_stat(entry->fullpath, &st) < 0 ||\n\t\t\tS_ISDIR(st.st_mode) ||\n\t\t\t(fd = git_futils_open_ro(entry->fullpath)) < 0 ||\n\t\t\t(error = git_futils_readbuffer_fd(&content, fd, (size_t)st.st_size)) < 0)\n\t\t\tnonexistent = true;\n\n\t\tif (fd >= 0)\n\t\t\tp_close(fd);\n\n\t\tbreak;\n\t}\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Unknown file source %d\", source);\n\t\treturn -1;\n\t}\n\n\tif ((error = git_attr_file__new(&file, entry, source)) < 0)\n\t\tgoto cleanup;\n\n\t/* store the key of the attr_reader; don't bother with cache\n\t * invalidation during the same attr reader session.\n\t */\n\tif (attr_session)\n\t\tfile->session_key = attr_session->key;\n\n\tif (parser && (error = parser(repo, file, git_buf_cstr(&content))) < 0) {\n\t\tgit_attr_file__free(file);\n\t\tgoto cleanup;\n\t}\n\n\t/* write cache breakers */\n\tif (nonexistent)\n\t\tfile->nonexistent = 1;\n\telse if (source == GIT_ATTR_FILE__FROM_INDEX)\n\t\tgit_oid_cpy(&file->cache_data.oid, git_blob_id(blob));\n\telse if (source == GIT_ATTR_FILE__FROM_FILE)\n\t\tgit_futils_filestamp_set_from_stat(&file->cache_data.stamp, &st);\n\t/* else always cacheable */\n\n\t*out = file;\n\ncleanup:\n\tgit_blob_free(blob);\n\tgit_buf_free(&content);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_attr_file__out_of_date",
          "args": [
            "repo",
            "attr_session",
            "file"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_file__out_of_date",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr_file.c",
          "lines": "179-218",
          "snippet": "int git_attr_file__out_of_date(\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file *file)\n{\n\tif (!file)\n\t\treturn 1;\n\n\t/* we are never out of date if we just created this data in the same\n\t * attr_session; otherwise, nonexistent files must be invalidated\n\t */\n\tif (attr_session && attr_session->key == file->session_key)\n\t\treturn 0;\n\telse if (file->nonexistent)\n\t\treturn 1;\n\n\tswitch (file->source) {\n\tcase GIT_ATTR_FILE__IN_MEMORY:\n\t\treturn 0;\n\n\tcase GIT_ATTR_FILE__FROM_FILE:\n\t\treturn git_futils_filestamp_check(\n\t\t\t&file->cache_data.stamp, file->entry->fullpath);\n\n\tcase GIT_ATTR_FILE__FROM_INDEX: {\n\t\tint error;\n\t\tgit_oid id;\n\n\t\tif ((error = attr_file_oid_from_index(\n\t\t\t\t&id, repo, file->entry->path)) < 0)\n\t\t\treturn error;\n\n\t\treturn (git_oid__cmp(&file->cache_data.oid, &id) != 0);\n\t}\n\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Invalid file type %d\", file->source);\n\t\treturn -1;\n\t}\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/blob.h\"",
            "#include \"attrcache.h\"",
            "#include \"attr_file.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"index.h\"\n#include \"git2/tree.h\"\n#include \"git2/blob.h\"\n#include \"attrcache.h\"\n#include \"attr_file.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_attr_file__out_of_date(\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file *file)\n{\n\tif (!file)\n\t\treturn 1;\n\n\t/* we are never out of date if we just created this data in the same\n\t * attr_session; otherwise, nonexistent files must be invalidated\n\t */\n\tif (attr_session && attr_session->key == file->session_key)\n\t\treturn 0;\n\telse if (file->nonexistent)\n\t\treturn 1;\n\n\tswitch (file->source) {\n\tcase GIT_ATTR_FILE__IN_MEMORY:\n\t\treturn 0;\n\n\tcase GIT_ATTR_FILE__FROM_FILE:\n\t\treturn git_futils_filestamp_check(\n\t\t\t&file->cache_data.stamp, file->entry->fullpath);\n\n\tcase GIT_ATTR_FILE__FROM_INDEX: {\n\t\tint error;\n\t\tgit_oid id;\n\n\t\tif ((error = attr_file_oid_from_index(\n\t\t\t\t&id, repo, file->entry->path)) < 0)\n\t\t\treturn error;\n\n\t\treturn (git_oid__cmp(&file->cache_data.oid, &id) != 0);\n\t}\n\n\tdefault:\n\t\tgiterr_set(GITERR_INVALID, \"Invalid file type %d\", file->source);\n\t\treturn -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_cache_lookup",
          "args": [
            "&file",
            "&entry",
            "repo",
            "attr_session",
            "source",
            "base",
            "filename"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "148-198",
          "snippet": "static int attr_cache_lookup(\n\tgit_attr_file **out_file,\n\tgit_attr_file_entry **out_entry,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file_source source,\n\tconst char *base,\n\tconst char *filename)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\tconst char *wd = git_repository_workdir(repo), *relfile;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\tgit_attr_file *file = NULL;\n\n\t/* join base and path as needed */\n\tif (base != NULL && git_path_root(filename) < 0) {\n\t\tgit_buf *p = attr_session ? &attr_session->tmp : &path;\n\n\t\tif (git_buf_joinpath(p, base, filename) < 0)\n\t\t\treturn -1;\n\n\t\tfilename = p->ptr;\n\t}\n\n\trelfile = filename;\n\tif (wd && !git__prefixcmp(relfile, wd))\n\t\trelfile += strlen(wd);\n\n\t/* check cache for existing entry */\n\tif ((error = attr_cache_lock(cache)) < 0)\n\t\tgoto cleanup;\n\n\tentry = attr_cache_lookup_entry(cache, relfile);\n\tif (!entry)\n\t\terror = attr_cache_make_entry(&entry, repo, relfile);\n\telse if (entry->file[source] != NULL) {\n\t\tfile = entry->file[source];\n\t\tGIT_REFCOUNT_INC(file);\n\t}\n\n\tattr_cache_unlock(cache);\n\ncleanup:\n\t*out_file  = file;\n\t*out_entry = entry;\n\n\tgit_buf_free(&path);\n\treturn error;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache_lookup(\n\tgit_attr_file **out_file,\n\tgit_attr_file_entry **out_entry,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file_source source,\n\tconst char *base,\n\tconst char *filename)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\tconst char *wd = git_repository_workdir(repo), *relfile;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\tgit_attr_file *file = NULL;\n\n\t/* join base and path as needed */\n\tif (base != NULL && git_path_root(filename) < 0) {\n\t\tgit_buf *p = attr_session ? &attr_session->tmp : &path;\n\n\t\tif (git_buf_joinpath(p, base, filename) < 0)\n\t\t\treturn -1;\n\n\t\tfilename = p->ptr;\n\t}\n\n\trelfile = filename;\n\tif (wd && !git__prefixcmp(relfile, wd))\n\t\trelfile += strlen(wd);\n\n\t/* check cache for existing entry */\n\tif ((error = attr_cache_lock(cache)) < 0)\n\t\tgoto cleanup;\n\n\tentry = attr_cache_lookup_entry(cache, relfile);\n\tif (!entry)\n\t\terror = attr_cache_make_entry(&entry, repo, relfile);\n\telse if (entry->file[source] != NULL) {\n\t\tfile = entry->file[source];\n\t\tGIT_REFCOUNT_INC(file);\n\t}\n\n\tattr_cache_unlock(cache);\n\ncleanup:\n\t*out_file  = file;\n\t*out_entry = entry;\n\n\tgit_buf_free(&path);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_attr_cache",
          "args": [
            "repo"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_attr_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.h",
          "lines": "148-151",
          "snippet": "GIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}",
          "includes": [
            "#include \"diff_driver.h\"",
            "#include \"submodule.h\"",
            "#include \"attrcache.h\"",
            "#include \"object.h\"",
            "#include \"buffer.h\"",
            "#include \"refs.h\"",
            "#include \"cache.h\"",
            "#include \"array.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_driver.h\"\n#include \"submodule.h\"\n#include \"attrcache.h\"\n#include \"object.h\"\n#include \"buffer.h\"\n#include \"refs.h\"\n#include \"cache.h\"\n#include \"array.h\"\n#include \"git2/config.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_attr_cache__get(\n\tgit_attr_file **out,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file_source source,\n\tconst char *base,\n\tconst char *filename,\n\tgit_attr_file_parser parser)\n{\n\tint error = 0;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\tgit_attr_file *file = NULL, *updated = NULL;\n\n\tif ((error = attr_cache_lookup(\n\t\t\t&file, &entry, repo, attr_session, source, base, filename)) < 0)\n\t\treturn error;\n\n\t/* load file if we don't have one or if existing one is out of date */\n\tif (!file || (error = git_attr_file__out_of_date(repo, attr_session, file)) > 0)\n\t\terror = git_attr_file__load(&updated, repo, attr_session, entry, source, parser);\n\n\t/* if we loaded the file, insert into and/or update cache */\n\tif (updated) {\n\t\tif ((error = attr_cache_upsert(cache, updated)) < 0)\n\t\t\tgit_attr_file__free(updated);\n\t\telse {\n\t\t\tgit_attr_file__free(file); /* offset incref from lookup */\n\t\t\tfile = updated;\n\t\t}\n\t}\n\n\t/* if file could not be loaded */\n\tif (error < 0) {\n\t\t/* remove existing entry */\n\t\tif (file) {\n\t\t\tattr_cache_remove(cache, file);\n\t\t\tgit_attr_file__free(file); /* offset incref from lookup */\n\t\t\tfile = NULL;\n\t\t}\n\t\t/* no error if file simply doesn't exist */\n\t\tif (error == GIT_ENOTFOUND) {\n\t\t\tgiterr_clear();\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\t*out = file;\n\treturn error;\n}"
  },
  {
    "function_name": "attr_cache_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "148-198",
    "snippet": "static int attr_cache_lookup(\n\tgit_attr_file **out_file,\n\tgit_attr_file_entry **out_entry,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file_source source,\n\tconst char *base,\n\tconst char *filename)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\tconst char *wd = git_repository_workdir(repo), *relfile;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\tgit_attr_file *file = NULL;\n\n\t/* join base and path as needed */\n\tif (base != NULL && git_path_root(filename) < 0) {\n\t\tgit_buf *p = attr_session ? &attr_session->tmp : &path;\n\n\t\tif (git_buf_joinpath(p, base, filename) < 0)\n\t\t\treturn -1;\n\n\t\tfilename = p->ptr;\n\t}\n\n\trelfile = filename;\n\tif (wd && !git__prefixcmp(relfile, wd))\n\t\trelfile += strlen(wd);\n\n\t/* check cache for existing entry */\n\tif ((error = attr_cache_lock(cache)) < 0)\n\t\tgoto cleanup;\n\n\tentry = attr_cache_lookup_entry(cache, relfile);\n\tif (!entry)\n\t\terror = attr_cache_make_entry(&entry, repo, relfile);\n\telse if (entry->file[source] != NULL) {\n\t\tfile = entry->file[source];\n\t\tGIT_REFCOUNT_INC(file);\n\t}\n\n\tattr_cache_unlock(cache);\n\ncleanup:\n\t*out_file  = file;\n\t*out_entry = entry;\n\n\tgit_buf_free(&path);\n\treturn error;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_cache_unlock",
          "args": [
            "cache"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "21-25",
          "snippet": "GIT_INLINE(void) attr_cache_unlock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\tgit_mutex_unlock(&cache->lock);\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) attr_cache_unlock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\tgit_mutex_unlock(&cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "file"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attr_cache_make_entry",
          "args": [
            "&entry",
            "repo",
            "relfile"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_make_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "74-92",
          "snippet": "static int attr_cache_make_entry(\n\tgit_attr_file_entry **out, git_repository *repo, const char *path)\n{\n\tint error = 0;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\n\terror = git_attr_cache__alloc_file_entry(\n\t\t&entry, git_repository_workdir(repo), path, &cache->pool);\n\n\tif (!error) {\n\t\tgit_strmap_insert(cache->files, entry->path, entry, error);\n\t\tif (error > 0)\n\t\t\terror = 0;\n\t}\n\n\t*out = entry;\n\treturn error;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache_make_entry(\n\tgit_attr_file_entry **out, git_repository *repo, const char *path)\n{\n\tint error = 0;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\n\terror = git_attr_cache__alloc_file_entry(\n\t\t&entry, git_repository_workdir(repo), path, &cache->pool);\n\n\tif (!error) {\n\t\tgit_strmap_insert(cache->files, entry->path, entry, error);\n\t\tif (error > 0)\n\t\t\terror = 0;\n\t}\n\n\t*out = entry;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_cache_lookup_entry",
          "args": [
            "cache",
            "relfile"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_lookup_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "27-36",
          "snippet": "GIT_INLINE(git_attr_file_entry *) attr_cache_lookup_entry(\n\tgit_attr_cache *cache, const char *path)\n{\n\tkhiter_t pos = git_strmap_lookup_index(cache->files, path);\n\n\tif (git_strmap_valid_index(cache->files, pos))\n\t\treturn git_strmap_value_at(cache->files, pos);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_attr_file_entry *) attr_cache_lookup_entry(\n\tgit_attr_cache *cache, const char *path)\n{\n\tkhiter_t pos = git_strmap_lookup_index(cache->files, path);\n\n\tif (git_strmap_valid_index(cache->files, pos))\n\t\treturn git_strmap_value_at(cache->files, pos);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_cache_lock",
          "args": [
            "cache"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "wd"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__prefixcmp",
          "args": [
            "relfile",
            "wd"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "git__prefixcmp_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "252-255",
          "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "p",
            "base",
            "filename"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_root",
          "args": [
            "filename"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "238-263",
          "snippet": "int git_path_root(const char *path)\n{\n\tint offset = 0;\n\n\t/* Does the root of the path look like a windows drive ? */\n\tif (LOOKS_LIKE_DRIVE_PREFIX(path))\n\t\toffset += 2;\n\n#ifdef GIT_WIN32\n\t/* Are we dealing with a windows network path? */\n\telse if ((path[0] == '/' && path[1] == '/' && path[2] != '/') ||\n\t\t(path[0] == '\\\\' && path[1] == '\\\\' && path[2] != '\\\\'))\n\t{\n\t\toffset += 2;\n\n\t\t/* Skip the computer name segment */\n\t\twhile (path[offset] && path[offset] != '/' && path[offset] != '\\\\')\n\t\t\toffset++;\n\t}\n#endif\n\n\tif (path[offset] == '/' || path[offset] == '\\\\')\n\t\treturn offset;\n\n\treturn -1;\t/* Not a real error - signals that path is not rooted */\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_root(const char *path)\n{\n\tint offset = 0;\n\n\t/* Does the root of the path look like a windows drive ? */\n\tif (LOOKS_LIKE_DRIVE_PREFIX(path))\n\t\toffset += 2;\n\n#ifdef GIT_WIN32\n\t/* Are we dealing with a windows network path? */\n\telse if ((path[0] == '/' && path[1] == '/' && path[2] != '/') ||\n\t\t(path[0] == '\\\\' && path[1] == '\\\\' && path[2] != '\\\\'))\n\t{\n\t\toffset += 2;\n\n\t\t/* Skip the computer name segment */\n\t\twhile (path[offset] && path[offset] != '/' && path[offset] != '\\\\')\n\t\t\toffset++;\n\t}\n#endif\n\n\tif (path[offset] == '/' || path[offset] == '\\\\')\n\t\treturn offset;\n\n\treturn -1;\t/* Not a real error - signals that path is not rooted */\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_attr_cache",
          "args": [
            "repo"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_attr_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.h",
          "lines": "148-151",
          "snippet": "GIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}",
          "includes": [
            "#include \"diff_driver.h\"",
            "#include \"submodule.h\"",
            "#include \"attrcache.h\"",
            "#include \"object.h\"",
            "#include \"buffer.h\"",
            "#include \"refs.h\"",
            "#include \"cache.h\"",
            "#include \"array.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_driver.h\"\n#include \"submodule.h\"\n#include \"attrcache.h\"\n#include \"object.h\"\n#include \"buffer.h\"\n#include \"refs.h\"\n#include \"cache.h\"\n#include \"array.h\"\n#include \"git2/config.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_workdir",
          "args": [
            "repo"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_workdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1828-1836",
          "snippet": "const char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache_lookup(\n\tgit_attr_file **out_file,\n\tgit_attr_file_entry **out_entry,\n\tgit_repository *repo,\n\tgit_attr_session *attr_session,\n\tgit_attr_file_source source,\n\tconst char *base,\n\tconst char *filename)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\tconst char *wd = git_repository_workdir(repo), *relfile;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\tgit_attr_file *file = NULL;\n\n\t/* join base and path as needed */\n\tif (base != NULL && git_path_root(filename) < 0) {\n\t\tgit_buf *p = attr_session ? &attr_session->tmp : &path;\n\n\t\tif (git_buf_joinpath(p, base, filename) < 0)\n\t\t\treturn -1;\n\n\t\tfilename = p->ptr;\n\t}\n\n\trelfile = filename;\n\tif (wd && !git__prefixcmp(relfile, wd))\n\t\trelfile += strlen(wd);\n\n\t/* check cache for existing entry */\n\tif ((error = attr_cache_lock(cache)) < 0)\n\t\tgoto cleanup;\n\n\tentry = attr_cache_lookup_entry(cache, relfile);\n\tif (!entry)\n\t\terror = attr_cache_make_entry(&entry, repo, relfile);\n\telse if (entry->file[source] != NULL) {\n\t\tfile = entry->file[source];\n\t\tGIT_REFCOUNT_INC(file);\n\t}\n\n\tattr_cache_unlock(cache);\n\ncleanup:\n\t*out_file  = file;\n\t*out_entry = entry;\n\n\tgit_buf_free(&path);\n\treturn error;\n}"
  },
  {
    "function_name": "attr_cache_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "120-141",
    "snippet": "static int attr_cache_remove(git_attr_cache *cache, git_attr_file *file)\n{\n\tint error = 0;\n\tgit_attr_file_entry *entry;\n\n\tif (!file)\n\t\treturn 0;\n\tif ((error = attr_cache_lock(cache)) < 0)\n\t\treturn error;\n\n\tif ((entry = attr_cache_lookup_entry(cache, file->entry->path)) != NULL)\n\t\tfile = git__compare_and_swap(&entry->file[file->source], file, NULL);\n\n\tattr_cache_unlock(cache);\n\n\tif (file) {\n\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\tgit_attr_file__free(file);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_attr_file__free",
          "args": [
            "file"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_file__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr_file.c",
          "lines": "66-71",
          "snippet": "void git_attr_file__free(git_attr_file *file)\n{\n\tif (!file)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(file, attr_file_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/blob.h\"",
            "#include \"attrcache.h\"",
            "#include \"attr_file.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"index.h\"\n#include \"git2/tree.h\"\n#include \"git2/blob.h\"\n#include \"attrcache.h\"\n#include \"attr_file.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_attr_file__free(git_attr_file *file)\n{\n\tif (!file)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(file, attr_file_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "file",
            "NULL"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attr_cache_unlock",
          "args": [
            "cache"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "21-25",
          "snippet": "GIT_INLINE(void) attr_cache_unlock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\tgit_mutex_unlock(&cache->lock);\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) attr_cache_unlock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\tgit_mutex_unlock(&cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__compare_and_swap",
          "args": [
            "&entry->file[file->source]",
            "file",
            "NULL"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attr_cache_lookup_entry",
          "args": [
            "cache",
            "file->entry->path"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_lookup_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "27-36",
          "snippet": "GIT_INLINE(git_attr_file_entry *) attr_cache_lookup_entry(\n\tgit_attr_cache *cache, const char *path)\n{\n\tkhiter_t pos = git_strmap_lookup_index(cache->files, path);\n\n\tif (git_strmap_valid_index(cache->files, pos))\n\t\treturn git_strmap_value_at(cache->files, pos);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_attr_file_entry *) attr_cache_lookup_entry(\n\tgit_attr_cache *cache, const char *path)\n{\n\tkhiter_t pos = git_strmap_lookup_index(cache->files, path);\n\n\tif (git_strmap_valid_index(cache->files, pos))\n\t\treturn git_strmap_value_at(cache->files, pos);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_cache_lock",
          "args": [
            "cache"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache_remove(git_attr_cache *cache, git_attr_file *file)\n{\n\tint error = 0;\n\tgit_attr_file_entry *entry;\n\n\tif (!file)\n\t\treturn 0;\n\tif ((error = attr_cache_lock(cache)) < 0)\n\t\treturn error;\n\n\tif ((entry = attr_cache_lookup_entry(cache, file->entry->path)) != NULL)\n\t\tfile = git__compare_and_swap(&entry->file[file->source], file, NULL);\n\n\tattr_cache_unlock(cache);\n\n\tif (file) {\n\t\tGIT_REFCOUNT_OWN(file, NULL);\n\t\tgit_attr_file__free(file);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "attr_cache_upsert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "95-118",
    "snippet": "static int attr_cache_upsert(git_attr_cache *cache, git_attr_file *file)\n{\n\tgit_attr_file_entry *entry;\n\tgit_attr_file *old;\n\n\tif (attr_cache_lock(cache) < 0)\n\t\treturn -1;\n\n\tentry = attr_cache_lookup_entry(cache, file->entry->path);\n\n\tGIT_REFCOUNT_OWN(file, entry);\n\tGIT_REFCOUNT_INC(file);\n\n\told = git__compare_and_swap(\n\t\t&entry->file[file->source], entry->file[file->source], file);\n\n\tif (old) {\n\t\tGIT_REFCOUNT_OWN(old, NULL);\n\t\tgit_attr_file__free(old);\n\t}\n\n\tattr_cache_unlock(cache);\n\treturn 0;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "attr_cache_unlock",
          "args": [
            "cache"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "21-25",
          "snippet": "GIT_INLINE(void) attr_cache_unlock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\tgit_mutex_unlock(&cache->lock);\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) attr_cache_unlock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\tgit_mutex_unlock(&cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_attr_file__free",
          "args": [
            "old"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_file__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attr_file.c",
          "lines": "66-71",
          "snippet": "void git_attr_file__free(git_attr_file *file)\n{\n\tif (!file)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(file, attr_file_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/blob.h\"",
            "#include \"attrcache.h\"",
            "#include \"attr_file.h\"",
            "#include \"filebuf.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"index.h\"\n#include \"git2/tree.h\"\n#include \"git2/blob.h\"\n#include \"attrcache.h\"\n#include \"attr_file.h\"\n#include \"filebuf.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_attr_file__free(git_attr_file *file)\n{\n\tif (!file)\n\t\treturn;\n\tGIT_REFCOUNT_DEC(file, attr_file_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "old",
            "NULL"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__compare_and_swap",
          "args": [
            "&entry->file[file->source]",
            "entry->file[file->source]",
            "file"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "file"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "file",
            "entry"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attr_cache_lookup_entry",
          "args": [
            "cache",
            "file->entry->path"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "attr_cache_lookup_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "27-36",
          "snippet": "GIT_INLINE(git_attr_file_entry *) attr_cache_lookup_entry(\n\tgit_attr_cache *cache, const char *path)\n{\n\tkhiter_t pos = git_strmap_lookup_index(cache->files, path);\n\n\tif (git_strmap_valid_index(cache->files, pos))\n\t\treturn git_strmap_value_at(cache->files, pos);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_attr_file_entry *) attr_cache_lookup_entry(\n\tgit_attr_cache *cache, const char *path)\n{\n\tkhiter_t pos = git_strmap_lookup_index(cache->files, path);\n\n\tif (git_strmap_valid_index(cache->files, pos))\n\t\treturn git_strmap_value_at(cache->files, pos);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_cache_lock",
          "args": [
            "cache"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache_upsert(git_attr_cache *cache, git_attr_file *file)\n{\n\tgit_attr_file_entry *entry;\n\tgit_attr_file *old;\n\n\tif (attr_cache_lock(cache) < 0)\n\t\treturn -1;\n\n\tentry = attr_cache_lookup_entry(cache, file->entry->path);\n\n\tGIT_REFCOUNT_OWN(file, entry);\n\tGIT_REFCOUNT_INC(file);\n\n\told = git__compare_and_swap(\n\t\t&entry->file[file->source], entry->file[file->source], file);\n\n\tif (old) {\n\t\tGIT_REFCOUNT_OWN(old, NULL);\n\t\tgit_attr_file__free(old);\n\t}\n\n\tattr_cache_unlock(cache);\n\treturn 0;\n}"
  },
  {
    "function_name": "attr_cache_make_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "74-92",
    "snippet": "static int attr_cache_make_entry(\n\tgit_attr_file_entry **out, git_repository *repo, const char *path)\n{\n\tint error = 0;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\n\terror = git_attr_cache__alloc_file_entry(\n\t\t&entry, git_repository_workdir(repo), path, &cache->pool);\n\n\tif (!error) {\n\t\tgit_strmap_insert(cache->files, entry->path, entry, error);\n\t\tif (error > 0)\n\t\t\terror = 0;\n\t}\n\n\t*out = entry;\n\treturn error;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_strmap_insert",
          "args": [
            "cache->files",
            "entry->path",
            "entry",
            "error"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_attr_cache__alloc_file_entry",
          "args": [
            "&entry",
            "git_repository_workdir(repo)",
            "path",
            "&cache->pool"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_cache__alloc_file_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "38-71",
          "snippet": "int git_attr_cache__alloc_file_entry(\n\tgit_attr_file_entry **out,\n\tconst char *base,\n\tconst char *path,\n\tgit_pool *pool)\n{\n\tsize_t baselen = 0, pathlen = strlen(path);\n\tsize_t cachesize = sizeof(git_attr_file_entry) + pathlen + 1;\n\tgit_attr_file_entry *ce;\n\n\tif (base != NULL && git_path_root(path) < 0) {\n\t\tbaselen = strlen(base);\n\t\tcachesize += baselen;\n\n\t\tif (baselen && base[baselen - 1] != '/')\n\t\t\tcachesize++;\n\t}\n\n\tce = git_pool_mallocz(pool, (uint32_t)cachesize);\n\tGITERR_CHECK_ALLOC(ce);\n\n\tif (baselen) {\n\t\tmemcpy(ce->fullpath, base, baselen);\n\n\t\tif (base[baselen - 1] != '/')\n\t\t\tce->fullpath[baselen++] = '/';\n\t}\n\tmemcpy(&ce->fullpath[baselen], path, pathlen);\n\n\tce->path = &ce->fullpath[baselen];\n\t*out = ce;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_attr_cache__alloc_file_entry(\n\tgit_attr_file_entry **out,\n\tconst char *base,\n\tconst char *path,\n\tgit_pool *pool)\n{\n\tsize_t baselen = 0, pathlen = strlen(path);\n\tsize_t cachesize = sizeof(git_attr_file_entry) + pathlen + 1;\n\tgit_attr_file_entry *ce;\n\n\tif (base != NULL && git_path_root(path) < 0) {\n\t\tbaselen = strlen(base);\n\t\tcachesize += baselen;\n\n\t\tif (baselen && base[baselen - 1] != '/')\n\t\t\tcachesize++;\n\t}\n\n\tce = git_pool_mallocz(pool, (uint32_t)cachesize);\n\tGITERR_CHECK_ALLOC(ce);\n\n\tif (baselen) {\n\t\tmemcpy(ce->fullpath, base, baselen);\n\n\t\tif (base[baselen - 1] != '/')\n\t\t\tce->fullpath[baselen++] = '/';\n\t}\n\tmemcpy(&ce->fullpath[baselen], path, pathlen);\n\n\tce->path = &ce->fullpath[baselen];\n\t*out = ce;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_workdir",
          "args": [
            "repo"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_workdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1828-1836",
          "snippet": "const char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_attr_cache",
          "args": [
            "repo"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_attr_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.h",
          "lines": "148-151",
          "snippet": "GIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}",
          "includes": [
            "#include \"diff_driver.h\"",
            "#include \"submodule.h\"",
            "#include \"attrcache.h\"",
            "#include \"object.h\"",
            "#include \"buffer.h\"",
            "#include \"refs.h\"",
            "#include \"cache.h\"",
            "#include \"array.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/object.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/odb.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"diff_driver.h\"\n#include \"submodule.h\"\n#include \"attrcache.h\"\n#include \"object.h\"\n#include \"buffer.h\"\n#include \"refs.h\"\n#include \"cache.h\"\n#include \"array.h\"\n#include \"git2/config.h\"\n#include \"git2/object.h\"\n#include \"git2/repository.h\"\n#include \"git2/odb.h\"\n#include \"git2/oid.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(git_attr_cache *) git_repository_attr_cache(git_repository *repo)\n{\n\treturn repo->attrcache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nstatic int attr_cache_make_entry(\n\tgit_attr_file_entry **out, git_repository *repo, const char *path)\n{\n\tint error = 0;\n\tgit_attr_cache *cache = git_repository_attr_cache(repo);\n\tgit_attr_file_entry *entry = NULL;\n\n\terror = git_attr_cache__alloc_file_entry(\n\t\t&entry, git_repository_workdir(repo), path, &cache->pool);\n\n\tif (!error) {\n\t\tgit_strmap_insert(cache->files, entry->path, entry, error);\n\t\tif (error > 0)\n\t\t\terror = 0;\n\t}\n\n\t*out = entry;\n\treturn error;\n}"
  },
  {
    "function_name": "git_attr_cache__alloc_file_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "38-71",
    "snippet": "int git_attr_cache__alloc_file_entry(\n\tgit_attr_file_entry **out,\n\tconst char *base,\n\tconst char *path,\n\tgit_pool *pool)\n{\n\tsize_t baselen = 0, pathlen = strlen(path);\n\tsize_t cachesize = sizeof(git_attr_file_entry) + pathlen + 1;\n\tgit_attr_file_entry *ce;\n\n\tif (base != NULL && git_path_root(path) < 0) {\n\t\tbaselen = strlen(base);\n\t\tcachesize += baselen;\n\n\t\tif (baselen && base[baselen - 1] != '/')\n\t\t\tcachesize++;\n\t}\n\n\tce = git_pool_mallocz(pool, (uint32_t)cachesize);\n\tGITERR_CHECK_ALLOC(ce);\n\n\tif (baselen) {\n\t\tmemcpy(ce->fullpath, base, baselen);\n\n\t\tif (base[baselen - 1] != '/')\n\t\t\tce->fullpath[baselen++] = '/';\n\t}\n\tmemcpy(&ce->fullpath[baselen], path, pathlen);\n\n\tce->path = &ce->fullpath[baselen];\n\t*out = ce;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ce->fullpath[baselen]",
            "path",
            "pathlen"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ce->fullpath",
            "base",
            "baselen"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "ce"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_pool_mallocz",
          "args": [
            "pool",
            "(uint32_t)cachesize"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "git_pool_mallocz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/pool.c",
          "lines": "181-188",
          "snippet": "void *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include \"posix.h\"",
            "#include \"pool.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void *pool_alloc_page(git_pool *pool, uint32_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include \"posix.h\"\n#include \"pool.h\"\n\nstatic void *pool_alloc_page(git_pool *pool, uint32_t size);\n\nvoid *git_pool_mallocz(git_pool *pool, uint32_t items)\n{\n\tconst uint32_t size = alloc_size(pool, items);\n\tvoid *ptr = pool_alloc(pool, size);\n\tif (ptr)\n\t\tmemset(ptr, 0x0, size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "base"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_path_root",
          "args": [
            "path"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "238-263",
          "snippet": "int git_path_root(const char *path)\n{\n\tint offset = 0;\n\n\t/* Does the root of the path look like a windows drive ? */\n\tif (LOOKS_LIKE_DRIVE_PREFIX(path))\n\t\toffset += 2;\n\n#ifdef GIT_WIN32\n\t/* Are we dealing with a windows network path? */\n\telse if ((path[0] == '/' && path[1] == '/' && path[2] != '/') ||\n\t\t(path[0] == '\\\\' && path[1] == '\\\\' && path[2] != '\\\\'))\n\t{\n\t\toffset += 2;\n\n\t\t/* Skip the computer name segment */\n\t\twhile (path[offset] && path[offset] != '/' && path[offset] != '\\\\')\n\t\t\toffset++;\n\t}\n#endif\n\n\tif (path[offset] == '/' || path[offset] == '\\\\')\n\t\treturn offset;\n\n\treturn -1;\t/* Not a real error - signals that path is not rooted */\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_root(const char *path)\n{\n\tint offset = 0;\n\n\t/* Does the root of the path look like a windows drive ? */\n\tif (LOOKS_LIKE_DRIVE_PREFIX(path))\n\t\toffset += 2;\n\n#ifdef GIT_WIN32\n\t/* Are we dealing with a windows network path? */\n\telse if ((path[0] == '/' && path[1] == '/' && path[2] != '/') ||\n\t\t(path[0] == '\\\\' && path[1] == '\\\\' && path[2] != '\\\\'))\n\t{\n\t\toffset += 2;\n\n\t\t/* Skip the computer name segment */\n\t\twhile (path[offset] && path[offset] != '/' && path[offset] != '\\\\')\n\t\t\toffset++;\n\t}\n#endif\n\n\tif (path[offset] == '/' || path[offset] == '\\\\')\n\t\treturn offset;\n\n\treturn -1;\t/* Not a real error - signals that path is not rooted */\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "path"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_attr_cache__alloc_file_entry(\n\tgit_attr_file_entry **out,\n\tconst char *base,\n\tconst char *path,\n\tgit_pool *pool)\n{\n\tsize_t baselen = 0, pathlen = strlen(path);\n\tsize_t cachesize = sizeof(git_attr_file_entry) + pathlen + 1;\n\tgit_attr_file_entry *ce;\n\n\tif (base != NULL && git_path_root(path) < 0) {\n\t\tbaselen = strlen(base);\n\t\tcachesize += baselen;\n\n\t\tif (baselen && base[baselen - 1] != '/')\n\t\t\tcachesize++;\n\t}\n\n\tce = git_pool_mallocz(pool, (uint32_t)cachesize);\n\tGITERR_CHECK_ALLOC(ce);\n\n\tif (baselen) {\n\t\tmemcpy(ce->fullpath, base, baselen);\n\n\t\tif (base[baselen - 1] != '/')\n\t\t\tce->fullpath[baselen++] = '/';\n\t}\n\tmemcpy(&ce->fullpath[baselen], path, pathlen);\n\n\tce->path = &ce->fullpath[baselen];\n\t*out = ce;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "attr_cache_lookup_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "27-36",
    "snippet": "GIT_INLINE(git_attr_file_entry *) attr_cache_lookup_entry(\n\tgit_attr_cache *cache, const char *path)\n{\n\tkhiter_t pos = git_strmap_lookup_index(cache->files, path);\n\n\tif (git_strmap_valid_index(cache->files, pos))\n\t\treturn git_strmap_value_at(cache->files, pos);\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_strmap_value_at",
          "args": [
            "cache->files",
            "pos"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_valid_index",
          "args": [
            "cache->files",
            "pos"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_strmap_lookup_index",
          "args": [
            "cache->files",
            "path"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(git_attr_file_entry *) attr_cache_lookup_entry(\n\tgit_attr_cache *cache, const char *path)\n{\n\tkhiter_t pos = git_strmap_lookup_index(cache->files, path);\n\n\tif (git_strmap_valid_index(cache->files, pos))\n\t\treturn git_strmap_value_at(cache->files, pos);\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "attr_cache_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "21-25",
    "snippet": "GIT_INLINE(void) attr_cache_unlock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\tgit_mutex_unlock(&cache->lock);\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_mutex_unlock",
          "args": [
            "&cache->lock"
          ],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/thread.c",
          "lines": "116-120",
          "snippet": "int git_mutex_unlock(git_mutex *mutex)\n{\n\tLeaveCriticalSection(mutex);\n\treturn 0;\n}",
          "includes": [
            "#include \"../global.h\"",
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../global.h\"\n#include \"thread.h\"\n\nint git_mutex_unlock(git_mutex *mutex)\n{\n\tLeaveCriticalSection(mutex);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "cache"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) attr_cache_unlock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\tgit_mutex_unlock(&cache->lock);\n}"
  },
  {
    "function_name": "GIT_INLINE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
    "lines": "8-19",
    "snippet": "GIT__USE_STRMAP\n\nGIT_INLINE(int) attr_cache_lock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\n\tif (git_mutex_lock(&cache->lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to get attr cache lock\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"ignore.h\"",
      "#include \"sysdir.h\"",
      "#include \"config.h\"",
      "#include \"attr_file.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Unable to get attr cache lock\""
          ],
          "line": 15
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_mutex_lock",
          "args": [
            "&cache->lock"
          ],
          "line": 14
        },
        "resolved": true,
        "details": {
          "function_name": "git_mutex_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/thread-utils.h",
          "lines": "142-143",
          "snippet": "GIT_INLINE(int) git_mutex_lock(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }",
          "includes": [
            "#   include \"unix/pthread.h\"",
            "#   include \"win32/thread.h\""
          ],
          "macros_used": [
            "#define git_mutex unsigned int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include \"unix/pthread.h\"\n#   include \"win32/thread.h\"\n\n#define git_mutex unsigned int\n\nGIT_INLINE(int) git_mutex_lock(git_mutex *mutex) \\\n\t{ GIT_UNUSED(mutex); return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "cache"
          ],
          "line": 12
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attr_cache_lock",
          "args": [
            "git_attr_cache *cache"
          ],
          "line": 10
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nGIT__USE_STRMAP\n\nGIT_INLINE(int) attr_cache_lock(git_attr_cache *cache)\n{\n\tGIT_UNUSED(cache); /* avoid warning if threading is off */\n\n\tif (git_mutex_lock(&cache->lock) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Unable to get attr cache lock\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}"
  }
]