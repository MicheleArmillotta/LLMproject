[
  {
    "function_name": "git_repository_set_ident",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2339-2360",
    "snippet": "int git_repository_set_ident(git_repository *repo, const char *name, const char *email)\n{\n\tchar *tmp_name = NULL, *tmp_email = NULL;\n\n\tif (name) {\n\t\ttmp_name = git__strdup(name);\n\t\tGITERR_CHECK_ALLOC(tmp_name);\n\t}\n\n\tif (email) {\n\t\ttmp_email = git__strdup(email);\n\t\tGITERR_CHECK_ALLOC(tmp_email);\n\t}\n\n\ttmp_name = git__swap(repo->ident_name, tmp_name);\n\ttmp_email = git__swap(repo->ident_email, tmp_email);\n\n\tgit__free(tmp_name);\n\tgit__free(tmp_email);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "tmp_email"
          ],
          "line": 2357
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__swap",
          "args": [
            "repo->ident_email",
            "tmp_email"
          ],
          "line": 2354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__swap",
          "args": [
            "repo->ident_name",
            "tmp_name"
          ],
          "line": 2353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "tmp_email"
          ],
          "line": 2350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "email"
          ],
          "line": 2349
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "tmp_name"
          ],
          "line": 2345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_set_ident(git_repository *repo, const char *name, const char *email)\n{\n\tchar *tmp_name = NULL, *tmp_email = NULL;\n\n\tif (name) {\n\t\ttmp_name = git__strdup(name);\n\t\tGITERR_CHECK_ALLOC(tmp_name);\n\t}\n\n\tif (email) {\n\t\ttmp_email = git__strdup(email);\n\t\tGITERR_CHECK_ALLOC(tmp_email);\n\t}\n\n\ttmp_name = git__swap(repo->ident_name, tmp_name);\n\ttmp_email = git__swap(repo->ident_email, tmp_email);\n\n\tgit__free(tmp_name);\n\tgit__free(tmp_email);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_ident",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2331-2337",
    "snippet": "int git_repository_ident(const char **name, const char **email, const git_repository *repo)\n{\n\t*name = repo->ident_name;\n\t*email = repo->ident_email;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_ident(const char **name, const char **email, const git_repository *repo)\n{\n\t*name = repo->ident_name;\n\t*email = repo->ident_email;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_init_init_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2322-2329",
    "snippet": "int git_repository_init_init_options(\n\tgit_repository_init_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_repository_init_options,\n\t\tGIT_REPOSITORY_INIT_OPTIONS_INIT);\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_INIT_STRUCTURE_FROM_TEMPLATE",
          "args": [
            "opts",
            "version",
            "git_repository_init_options",
            "GIT_REPOSITORY_INIT_OPTIONS_INIT"
          ],
          "line": 2325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_init_init_options(\n\tgit_repository_init_options *opts, unsigned int version)\n{\n\tGIT_INIT_STRUCTURE_FROM_TEMPLATE(\n\t\topts, version, git_repository_init_options,\n\t\tGIT_REPOSITORY_INIT_OPTIONS_INIT);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_is_shallow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2300-2320",
    "snippet": "int git_repository_is_shallow(git_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tint error;\n\n\tif ((error = git_buf_joinpath(&path, repo->path_repository, \"shallow\")) < 0)\n\t\treturn error;\n\n\terror = git_path_lstat(path.ptr, &st);\n\tgit_buf_free(&path);\n\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n\tif (error < 0)\n\t\treturn error;\n\treturn st.st_size == 0 ? 0 : 1;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 2313
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 2310
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_lstat",
          "args": [
            "path.ptr",
            "&st"
          ],
          "line": 2309
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_lstat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "634-640",
          "snippet": "int git_path_lstat(const char *path, struct stat *st)\n{\n\tif (p_lstat(path, st) == 0)\n\t\treturn 0;\n\n\treturn git_path_set_error(errno, path, \"stat\");\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_lstat(const char *path, struct stat *st)\n{\n\tif (p_lstat(path, st) == 0)\n\t\treturn 0;\n\n\treturn git_path_set_error(errno, path, \"stat\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "repo->path_repository",
            "\"shallow\""
          ],
          "line": 2306
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_is_shallow(git_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tint error;\n\n\tif ((error = git_buf_joinpath(&path, repo->path_repository, \"shallow\")) < 0)\n\t\treturn error;\n\n\terror = git_path_lstat(path.ptr, &st);\n\tgit_buf_free(&path);\n\n\tif (error == GIT_ENOTFOUND) {\n\t\tgiterr_clear();\n\t\treturn 0;\n\t}\n\n\tif (error < 0)\n\t\treturn error;\n\treturn st.st_size == 0 ? 0 : 1;\n}"
  },
  {
    "function_name": "git_repository_state_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2293-2298",
    "snippet": "int git_repository_state_cleanup(git_repository *repo)\n{\n\tassert(repo);\n\n\treturn git_repository__cleanup_files(repo, state_files, ARRAY_SIZE(state_files));\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *state_files[] = {\n\tGIT_MERGE_HEAD_FILE,\n\tGIT_MERGE_MODE_FILE,\n\tGIT_MERGE_MSG_FILE,\n\tGIT_REVERT_HEAD_FILE,\n\tGIT_CHERRYPICK_HEAD_FILE,\n\tGIT_BISECT_LOG_FILE,\n\tGIT_REBASE_MERGE_DIR,\n\tGIT_REBASE_APPLY_DIR,\n\tGIT_SEQUENCER_DIR,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_repository__cleanup_files",
          "args": [
            "repo",
            "state_files",
            "ARRAY_SIZE(state_files)"
          ],
          "line": 2297
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__cleanup_files",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "2252-2279",
          "snippet": "int git_repository__cleanup_files(\n\tgit_repository *repo, const char *files[], size_t files_len)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tsize_t i;\n\tint error;\n\n\tfor (error = 0, i = 0; !error && i < files_len; ++i) {\n\t\tconst char *path;\n\n\t\tif (git_buf_joinpath(&buf, repo->path_repository, files[i]) < 0)\n\t\t\treturn -1;\n\n\t\tpath = git_buf_cstr(&buf);\n\n\t\tif (git_path_isfile(path)) {\n\t\t\terror = p_unlink(path);\n\t\t} else if (git_path_isdir(path)) {\n\t\t\terror = git_futils_rmdir_r(path, NULL,\n\t\t\t\tGIT_RMDIR_REMOVE_FILES | GIT_RMDIR_REMOVE_BLOCKERS);\n\t\t}\n\t\t\t\n\t\tgit_buf_clear(&buf);\n\t}\n\n\tgit_buf_free(&buf);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository__cleanup_files(\n\tgit_repository *repo, const char *files[], size_t files_len)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tsize_t i;\n\tint error;\n\n\tfor (error = 0, i = 0; !error && i < files_len; ++i) {\n\t\tconst char *path;\n\n\t\tif (git_buf_joinpath(&buf, repo->path_repository, files[i]) < 0)\n\t\t\treturn -1;\n\n\t\tpath = git_buf_cstr(&buf);\n\n\t\tif (git_path_isfile(path)) {\n\t\t\terror = p_unlink(path);\n\t\t} else if (git_path_isdir(path)) {\n\t\t\terror = git_futils_rmdir_r(path, NULL,\n\t\t\t\tGIT_RMDIR_REMOVE_FILES | GIT_RMDIR_REMOVE_BLOCKERS);\n\t\t}\n\t\t\t\n\t\tgit_buf_clear(&buf);\n\t}\n\n\tgit_buf_free(&buf);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "state_files"
          ],
          "line": 2297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 2295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic const char *state_files[] = {\n\tGIT_MERGE_HEAD_FILE,\n\tGIT_MERGE_MODE_FILE,\n\tGIT_MERGE_MSG_FILE,\n\tGIT_REVERT_HEAD_FILE,\n\tGIT_CHERRYPICK_HEAD_FILE,\n\tGIT_BISECT_LOG_FILE,\n\tGIT_REBASE_MERGE_DIR,\n\tGIT_REBASE_APPLY_DIR,\n\tGIT_SEQUENCER_DIR,\n};\n\nint git_repository_state_cleanup(git_repository *repo)\n{\n\tassert(repo);\n\n\treturn git_repository__cleanup_files(repo, state_files, ARRAY_SIZE(state_files));\n}"
  },
  {
    "function_name": "git_repository__cleanup_files",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2252-2279",
    "snippet": "int git_repository__cleanup_files(\n\tgit_repository *repo, const char *files[], size_t files_len)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tsize_t i;\n\tint error;\n\n\tfor (error = 0, i = 0; !error && i < files_len; ++i) {\n\t\tconst char *path;\n\n\t\tif (git_buf_joinpath(&buf, repo->path_repository, files[i]) < 0)\n\t\t\treturn -1;\n\n\t\tpath = git_buf_cstr(&buf);\n\n\t\tif (git_path_isfile(path)) {\n\t\t\terror = p_unlink(path);\n\t\t} else if (git_path_isdir(path)) {\n\t\t\terror = git_futils_rmdir_r(path, NULL,\n\t\t\t\tGIT_RMDIR_REMOVE_FILES | GIT_RMDIR_REMOVE_BLOCKERS);\n\t\t}\n\t\t\t\n\t\tgit_buf_clear(&buf);\n\t}\n\n\tgit_buf_free(&buf);\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&buf"
          ],
          "line": 2277
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "&buf"
          ],
          "line": 2274
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_rmdir_r",
          "args": [
            "path",
            "NULL",
            "GIT_RMDIR_REMOVE_FILES | GIT_RMDIR_REMOVE_BLOCKERS"
          ],
          "line": 2270
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_rmdir_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "753-784",
          "snippet": "int git_futils_rmdir_r(\n\tconst char *path, const char *base, uint32_t flags)\n{\n\tint error;\n\tgit_buf fullpath = GIT_BUF_INIT;\n\tfutils__rmdir_data data;\n\n\t/* build path and find \"root\" where we should start calling mkdir */\n\tif (git_path_join_unrooted(&fullpath, path, base, NULL) < 0)\n\t\treturn -1;\n\n\tmemset(&data, 0, sizeof(data));\n\tdata.base    = base ? base : \"\";\n\tdata.baselen = base ? strlen(base) : 0;\n\tdata.flags   = flags;\n\n\terror = futils__rmdir_recurs_foreach(&data, &fullpath);\n\n\t/* remove now-empty parents if requested */\n\tif (!error && (flags & GIT_RMDIR_EMPTY_PARENTS) != 0)\n\t\terror = git_path_walk_up(\n\t\t\t&fullpath, base, futils__rmdir_empty_parent, &data);\n\n\tif (error == GIT_ITEROVER) {\n\t\tgiterr_clear();\n\t\terror = 0;\n\t}\n\n\tgit_buf_free(&fullpath);\n\n\treturn error;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_rmdir_r(\n\tconst char *path, const char *base, uint32_t flags)\n{\n\tint error;\n\tgit_buf fullpath = GIT_BUF_INIT;\n\tfutils__rmdir_data data;\n\n\t/* build path and find \"root\" where we should start calling mkdir */\n\tif (git_path_join_unrooted(&fullpath, path, base, NULL) < 0)\n\t\treturn -1;\n\n\tmemset(&data, 0, sizeof(data));\n\tdata.base    = base ? base : \"\";\n\tdata.baselen = base ? strlen(base) : 0;\n\tdata.flags   = flags;\n\n\terror = futils__rmdir_recurs_foreach(&data, &fullpath);\n\n\t/* remove now-empty parents if requested */\n\tif (!error && (flags & GIT_RMDIR_EMPTY_PARENTS) != 0)\n\t\terror = git_path_walk_up(\n\t\t\t&fullpath, base, futils__rmdir_empty_parent, &data);\n\n\tif (error == GIT_ITEROVER) {\n\t\tgiterr_clear();\n\t\terror = 0;\n\t}\n\n\tgit_buf_free(&fullpath);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_isdir",
          "args": [
            "path"
          ],
          "line": 2269
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_isdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "509-516",
          "snippet": "bool git_path_isdir(const char *path)\n{\n\tstruct stat st;\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISDIR(st.st_mode) != 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_isdir(const char *path)\n{\n\tstruct stat st;\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISDIR(st.st_mode) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_unlink",
          "args": [
            "path"
          ],
          "line": 2268
        },
        "resolved": true,
        "details": {
          "function_name": "p_unlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "92-110",
          "snippet": "int p_unlink(const char *path)\n{\n\tgit_win32_path buf;\n\tint error;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\terror = _wunlink(buf);\n\n\t/* If the file could not be deleted because it was\n\t * read-only, clear the bit and try again */\n\tif (error == -1 && errno == EACCES) {\n\t\t_wchmod(buf, 0666);\n\t\terror = _wunlink(buf);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_unlink(const char *path)\n{\n\tgit_win32_path buf;\n\tint error;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\terror = _wunlink(buf);\n\n\t/* If the file could not be deleted because it was\n\t * read-only, clear the bit and try again */\n\tif (error == -1 && errno == EACCES) {\n\t\t_wchmod(buf, 0666);\n\t\terror = _wunlink(buf);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_isfile",
          "args": [
            "path"
          ],
          "line": 2267
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_isfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "518-527",
          "snippet": "bool git_path_isfile(const char *path)\n{\n\tstruct stat st;\n\n\tassert(path);\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISREG(st.st_mode) != 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_isfile(const char *path)\n{\n\tstruct stat st;\n\n\tassert(path);\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISREG(st.st_mode) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&buf"
          ],
          "line": 2265
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&buf",
            "repo->path_repository",
            "files[i]"
          ],
          "line": 2262
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository__cleanup_files(\n\tgit_repository *repo, const char *files[], size_t files_len)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tsize_t i;\n\tint error;\n\n\tfor (error = 0, i = 0; !error && i < files_len; ++i) {\n\t\tconst char *path;\n\n\t\tif (git_buf_joinpath(&buf, repo->path_repository, files[i]) < 0)\n\t\t\treturn -1;\n\n\t\tpath = git_buf_cstr(&buf);\n\n\t\tif (git_path_isfile(path)) {\n\t\t\terror = p_unlink(path);\n\t\t} else if (git_path_isdir(path)) {\n\t\t\terror = git_futils_rmdir_r(path, NULL,\n\t\t\t\tGIT_RMDIR_REMOVE_FILES | GIT_RMDIR_REMOVE_BLOCKERS);\n\t\t}\n\t\t\t\n\t\tgit_buf_clear(&buf);\n\t}\n\n\tgit_buf_free(&buf);\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2213-2250",
    "snippet": "int git_repository_state(git_repository *repo)\n{\n\tgit_buf repo_path = GIT_BUF_INIT;\n\tint state = GIT_REPOSITORY_STATE_NONE;\n\n\tassert(repo);\n\n\tif (git_buf_puts(&repo_path, repo->path_repository) < 0)\n\t\treturn -1;\n\n\tif (git_path_contains_file(&repo_path, GIT_REBASE_MERGE_INTERACTIVE_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_REBASE_INTERACTIVE;\n\telse if (git_path_contains_dir(&repo_path, GIT_REBASE_MERGE_DIR))\n\t\tstate = GIT_REPOSITORY_STATE_REBASE_MERGE;\n\telse if (git_path_contains_file(&repo_path, GIT_REBASE_APPLY_REBASING_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_REBASE;\n\telse if (git_path_contains_file(&repo_path, GIT_REBASE_APPLY_APPLYING_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_APPLY_MAILBOX;\n\telse if (git_path_contains_dir(&repo_path, GIT_REBASE_APPLY_DIR))\n\t\tstate = GIT_REPOSITORY_STATE_APPLY_MAILBOX_OR_REBASE;\n\telse if (git_path_contains_file(&repo_path, GIT_MERGE_HEAD_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_MERGE;\n\telse if (git_path_contains_file(&repo_path, GIT_REVERT_HEAD_FILE)) {\n\t\tstate = GIT_REPOSITORY_STATE_REVERT;\n\t\tif (git_path_contains_file(&repo_path, GIT_SEQUENCER_TODO_FILE)) {\n\t\t\tstate = GIT_REPOSITORY_STATE_REVERT_SEQUENCE;\n\t\t}\n\t} else if (git_path_contains_file(&repo_path, GIT_CHERRYPICK_HEAD_FILE)) {\n\t\tstate = GIT_REPOSITORY_STATE_CHERRYPICK;\n\t\tif (git_path_contains_file(&repo_path, GIT_SEQUENCER_TODO_FILE)) {\n\t\t\tstate = GIT_REPOSITORY_STATE_CHERRYPICK_SEQUENCE;\n\t\t}\n\t} else if (git_path_contains_file(&repo_path, GIT_BISECT_LOG_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_BISECT;\n\n\tgit_buf_free(&repo_path);\n\treturn state;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&repo_path"
          ],
          "line": 2248
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_contains_file",
          "args": [
            "&repo_path",
            "GIT_BISECT_LOG_FILE"
          ],
          "line": 2245
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_contains_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "678-681",
          "snippet": "bool git_path_contains_file(git_buf *base, const char *file)\n{\n\treturn _check_dir_contents(base, file, &git_path_isfile);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_contains_file(git_buf *base, const char *file)\n{\n\treturn _check_dir_contents(base, file, &git_path_isfile);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_contains_dir",
          "args": [
            "&repo_path",
            "GIT_REBASE_APPLY_DIR"
          ],
          "line": 2231
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_contains_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "673-676",
          "snippet": "bool git_path_contains_dir(git_buf *base, const char *subdir)\n{\n\treturn _check_dir_contents(base, subdir, &git_path_isdir);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_contains_dir(git_buf *base, const char *subdir)\n{\n\treturn _check_dir_contents(base, subdir, &git_path_isdir);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "&repo_path",
            "repo->path_repository"
          ],
          "line": 2220
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 2218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_state(git_repository *repo)\n{\n\tgit_buf repo_path = GIT_BUF_INIT;\n\tint state = GIT_REPOSITORY_STATE_NONE;\n\n\tassert(repo);\n\n\tif (git_buf_puts(&repo_path, repo->path_repository) < 0)\n\t\treturn -1;\n\n\tif (git_path_contains_file(&repo_path, GIT_REBASE_MERGE_INTERACTIVE_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_REBASE_INTERACTIVE;\n\telse if (git_path_contains_dir(&repo_path, GIT_REBASE_MERGE_DIR))\n\t\tstate = GIT_REPOSITORY_STATE_REBASE_MERGE;\n\telse if (git_path_contains_file(&repo_path, GIT_REBASE_APPLY_REBASING_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_REBASE;\n\telse if (git_path_contains_file(&repo_path, GIT_REBASE_APPLY_APPLYING_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_APPLY_MAILBOX;\n\telse if (git_path_contains_dir(&repo_path, GIT_REBASE_APPLY_DIR))\n\t\tstate = GIT_REPOSITORY_STATE_APPLY_MAILBOX_OR_REBASE;\n\telse if (git_path_contains_file(&repo_path, GIT_MERGE_HEAD_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_MERGE;\n\telse if (git_path_contains_file(&repo_path, GIT_REVERT_HEAD_FILE)) {\n\t\tstate = GIT_REPOSITORY_STATE_REVERT;\n\t\tif (git_path_contains_file(&repo_path, GIT_SEQUENCER_TODO_FILE)) {\n\t\t\tstate = GIT_REPOSITORY_STATE_REVERT_SEQUENCE;\n\t\t}\n\t} else if (git_path_contains_file(&repo_path, GIT_CHERRYPICK_HEAD_FILE)) {\n\t\tstate = GIT_REPOSITORY_STATE_CHERRYPICK;\n\t\tif (git_path_contains_file(&repo_path, GIT_SEQUENCER_TODO_FILE)) {\n\t\t\tstate = GIT_REPOSITORY_STATE_CHERRYPICK_SEQUENCE;\n\t\t}\n\t} else if (git_path_contains_file(&repo_path, GIT_BISECT_LOG_FILE))\n\t\tstate = GIT_REPOSITORY_STATE_BISECT;\n\n\tgit_buf_free(&repo_path);\n\treturn state;\n}"
  },
  {
    "function_name": "git_repository_detach_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2176-2207",
    "snippet": "int git_repository_detach_head(git_repository* repo)\n{\n\tgit_reference *old_head = NULL,\t*new_head = NULL, *current = NULL;\n\tgit_object *object = NULL;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tint error;\n\n\tassert(repo);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_repository_head(&old_head, repo)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_object_lookup(&object, repo, git_reference_target(old_head), GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = checkout_message(&log_message, current, git_oid_tostr_s(git_object_id(object)))) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_create(&new_head, repo, GIT_HEAD_FILE, git_reference_target(old_head),\n\t\t\t1, git_buf_cstr(&log_message));\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_object_free(object);\n\tgit_reference_free(old_head);\n\tgit_reference_free(new_head);\n\tgit_reference_free(current);\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "current"
          ],
          "line": 2205
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "object"
          ],
          "line": 2202
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&log_message"
          ],
          "line": 2201
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_create",
          "args": [
            "&new_head",
            "repo",
            "GIT_HEAD_FILE",
            "git_reference_target(old_head)",
            "1",
            "git_buf_cstr(&log_message)"
          ],
          "line": 2197
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "464-473",
          "snippet": "int git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&log_message"
          ],
          "line": 2198
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_target",
          "args": [
            "old_head"
          ],
          "line": 2197
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_target_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "331-339",
          "snippet": "const git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkout_message",
          "args": [
            "&log_message",
            "current",
            "git_oid_tostr_s(git_object_id(object))"
          ],
          "line": 2194
        },
        "resolved": true,
        "details": {
          "function_name": "checkout_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "2063-2083",
          "snippet": "static int checkout_message(git_buf *out, git_reference *old, const char *new)\n{\n\tgit_buf_puts(out, \"checkout: moving from \");\n\n\tif (git_reference_type(old) == GIT_REF_SYMBOLIC)\n\t\tgit_buf_puts(out, git_reference__shorthand(git_reference_symbolic_target(old)));\n\telse\n\t\tgit_buf_puts(out, git_oid_tostr_s(git_reference_target(old)));\n\n\tgit_buf_puts(out, \" to \");\n\n\tif (git_reference__is_branch(new))\n\t\tgit_buf_puts(out, git_reference__shorthand(new));\n\telse\n\t\tgit_buf_puts(out, new);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int checkout_message(git_buf *out, git_reference *old, const char *new)\n{\n\tgit_buf_puts(out, \"checkout: moving from \");\n\n\tif (git_reference_type(old) == GIT_REF_SYMBOLIC)\n\t\tgit_buf_puts(out, git_reference__shorthand(git_reference_symbolic_target(old)));\n\telse\n\t\tgit_buf_puts(out, git_oid_tostr_s(git_reference_target(old)));\n\n\tgit_buf_puts(out, \" to \");\n\n\tif (git_reference__is_branch(new))\n\t\tgit_buf_puts(out, git_reference__shorthand(new));\n\telse\n\t\tgit_buf_puts(out, new);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_tostr_s",
          "args": [
            "git_object_id(object)"
          ],
          "line": 2194
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_tostr_s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "103-108",
          "snippet": "char *git_oid_tostr_s(const git_oid *oid)\n{\n\tchar *str = GIT_GLOBAL->oid_fmt;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr_s(const git_oid *oid)\n{\n\tchar *str = GIT_GLOBAL->oid_fmt;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_id",
          "args": [
            "object"
          ],
          "line": 2194
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "209-213",
          "snippet": "const git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_lookup",
          "args": [
            "&object",
            "repo",
            "git_reference_target(old_head)",
            "GIT_OBJ_COMMIT"
          ],
          "line": 2191
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_lookup_bypath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "390-423",
          "snippet": "int git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_head",
          "args": [
            "&old_head",
            "repo"
          ],
          "line": 2188
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_head_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1914-1931",
          "snippet": "int git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup",
          "args": [
            "&current",
            "repo",
            "GIT_HEAD_FILE"
          ],
          "line": 2185
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "146-150",
          "snippet": "int git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 2183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_detach_head(git_repository* repo)\n{\n\tgit_reference *old_head = NULL,\t*new_head = NULL, *current = NULL;\n\tgit_object *object = NULL;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tint error;\n\n\tassert(repo);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_repository_head(&old_head, repo)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_object_lookup(&object, repo, git_reference_target(old_head), GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = checkout_message(&log_message, current, git_oid_tostr_s(git_object_id(object)))) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_create(&new_head, repo, GIT_HEAD_FILE, git_reference_target(old_head),\n\t\t\t1, git_buf_cstr(&log_message));\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_object_free(object);\n\tgit_reference_free(old_head);\n\tgit_reference_free(new_head);\n\tgit_reference_free(current);\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_set_head_detached_from_annotated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2167-2174",
    "snippet": "int git_repository_set_head_detached_from_annotated(\n\tgit_repository *repo,\n\tconst git_annotated_commit *commitish)\n{\n\tassert(repo && commitish);\n\n\treturn detach(repo, git_annotated_commit_id(commitish), commitish->ref_name);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "detach",
          "args": [
            "repo",
            "git_annotated_commit_id(commitish)",
            "commitish->ref_name"
          ],
          "line": 2173
        },
        "resolved": true,
        "details": {
          "function_name": "detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "2125-2158",
          "snippet": "static int detach(git_repository *repo, const git_oid *id, const char *from)\n{\n\tint error;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tgit_object *object = NULL, *peeled = NULL;\n\tgit_reference *new_head = NULL, *current = NULL;\n\n\tassert(repo && id);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_lookup(&object, repo, id, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_object_peel(&peeled, object, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (from == NULL)\n\t\tfrom = git_oid_tostr_s(git_object_id(peeled));\n\n\tif ((error = checkout_message(&log_message, current, from)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_create(&new_head, repo, GIT_HEAD_FILE, git_object_id(peeled), true, git_buf_cstr(&log_message));\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_object_free(object);\n\tgit_object_free(peeled);\n\tgit_reference_free(current);\n\tgit_reference_free(new_head);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int detach(git_repository *repo, const git_oid *id, const char *from)\n{\n\tint error;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tgit_object *object = NULL, *peeled = NULL;\n\tgit_reference *new_head = NULL, *current = NULL;\n\n\tassert(repo && id);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_lookup(&object, repo, id, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_object_peel(&peeled, object, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (from == NULL)\n\t\tfrom = git_oid_tostr_s(git_object_id(peeled));\n\n\tif ((error = checkout_message(&log_message, current, from)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_create(&new_head, repo, GIT_HEAD_FILE, git_object_id(peeled), true, git_buf_cstr(&log_message));\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_object_free(object);\n\tgit_object_free(peeled);\n\tgit_reference_free(current);\n\tgit_reference_free(new_head);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_annotated_commit_id",
          "args": [
            "commitish"
          ],
          "line": 2173
        },
        "resolved": true,
        "details": {
          "function_name": "git_annotated_commit_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/annotated_commit.c",
          "lines": "174-179",
          "snippet": "const git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}",
          "includes": [
            "#include \"git2/index.h\"",
            "#include \"git2/tree.h\"",
            "#include \"git2/revparse.h\"",
            "#include \"git2/annotated_commit.h\"",
            "#include \"git2/repository.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/commit.h\"",
            "#include \"cache.h\"",
            "#include \"refs.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/index.h\"\n#include \"git2/tree.h\"\n#include \"git2/revparse.h\"\n#include \"git2/annotated_commit.h\"\n#include \"git2/repository.h\"\n#include \"git2/refs.h\"\n#include \"git2/commit.h\"\n#include \"cache.h\"\n#include \"refs.h\"\n#include \"annotated_commit.h\"\n#include \"common.h\"\n\nconst git_oid *git_annotated_commit_id(\n\tconst git_annotated_commit *annotated_commit)\n{\n\tassert(annotated_commit);\n\treturn git_commit_id(annotated_commit->commit);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && commitish"
          ],
          "line": 2171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_set_head_detached_from_annotated(\n\tgit_repository *repo,\n\tconst git_annotated_commit *commitish)\n{\n\tassert(repo && commitish);\n\n\treturn detach(repo, git_annotated_commit_id(commitish), commitish->ref_name);\n}"
  },
  {
    "function_name": "git_repository_set_head_detached",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2160-2165",
    "snippet": "int git_repository_set_head_detached(\n\tgit_repository* repo,\n\tconst git_oid* commitish)\n{\n\treturn detach(repo, commitish, NULL);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "detach",
          "args": [
            "repo",
            "commitish",
            "NULL"
          ],
          "line": 2164
        },
        "resolved": true,
        "details": {
          "function_name": "detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "2125-2158",
          "snippet": "static int detach(git_repository *repo, const git_oid *id, const char *from)\n{\n\tint error;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tgit_object *object = NULL, *peeled = NULL;\n\tgit_reference *new_head = NULL, *current = NULL;\n\n\tassert(repo && id);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_lookup(&object, repo, id, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_object_peel(&peeled, object, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (from == NULL)\n\t\tfrom = git_oid_tostr_s(git_object_id(peeled));\n\n\tif ((error = checkout_message(&log_message, current, from)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_create(&new_head, repo, GIT_HEAD_FILE, git_object_id(peeled), true, git_buf_cstr(&log_message));\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_object_free(object);\n\tgit_object_free(peeled);\n\tgit_reference_free(current);\n\tgit_reference_free(new_head);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int detach(git_repository *repo, const git_oid *id, const char *from)\n{\n\tint error;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tgit_object *object = NULL, *peeled = NULL;\n\tgit_reference *new_head = NULL, *current = NULL;\n\n\tassert(repo && id);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_lookup(&object, repo, id, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_object_peel(&peeled, object, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (from == NULL)\n\t\tfrom = git_oid_tostr_s(git_object_id(peeled));\n\n\tif ((error = checkout_message(&log_message, current, from)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_create(&new_head, repo, GIT_HEAD_FILE, git_object_id(peeled), true, git_buf_cstr(&log_message));\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_object_free(object);\n\tgit_object_free(peeled);\n\tgit_reference_free(current);\n\tgit_reference_free(new_head);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_set_head_detached(\n\tgit_repository* repo,\n\tconst git_oid* commitish)\n{\n\treturn detach(repo, commitish, NULL);\n}"
  },
  {
    "function_name": "detach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2125-2158",
    "snippet": "static int detach(git_repository *repo, const git_oid *id, const char *from)\n{\n\tint error;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tgit_object *object = NULL, *peeled = NULL;\n\tgit_reference *new_head = NULL, *current = NULL;\n\n\tassert(repo && id);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_lookup(&object, repo, id, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_object_peel(&peeled, object, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (from == NULL)\n\t\tfrom = git_oid_tostr_s(git_object_id(peeled));\n\n\tif ((error = checkout_message(&log_message, current, from)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_create(&new_head, repo, GIT_HEAD_FILE, git_object_id(peeled), true, git_buf_cstr(&log_message));\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_object_free(object);\n\tgit_object_free(peeled);\n\tgit_reference_free(current);\n\tgit_reference_free(new_head);\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "new_head"
          ],
          "line": 2156
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_free",
          "args": [
            "peeled"
          ],
          "line": 2154
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "201-207",
          "snippet": "void git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nvoid git_object_free(git_object *object)\n{\n\tif (object == NULL)\n\t\treturn;\n\n\tgit_cached_obj_decref(object);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&log_message"
          ],
          "line": 2152
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_create",
          "args": [
            "&new_head",
            "repo",
            "GIT_HEAD_FILE",
            "git_object_id(peeled)",
            "true",
            "git_buf_cstr(&log_message)"
          ],
          "line": 2149
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "464-473",
          "snippet": "int git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst git_oid *id,\n\tint force,\n\tconst char *log_message)\n{\n        return git_reference_create_matching(ref_out, repo, name, id, force, NULL, log_message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&log_message"
          ],
          "line": 2149
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_id",
          "args": [
            "peeled"
          ],
          "line": 2149
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "209-213",
          "snippet": "const git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nconst git_oid *git_object_id(const git_object *obj)\n{\n\tassert(obj);\n\treturn &obj->cached.oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkout_message",
          "args": [
            "&log_message",
            "current",
            "from"
          ],
          "line": 2146
        },
        "resolved": true,
        "details": {
          "function_name": "checkout_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "2063-2083",
          "snippet": "static int checkout_message(git_buf *out, git_reference *old, const char *new)\n{\n\tgit_buf_puts(out, \"checkout: moving from \");\n\n\tif (git_reference_type(old) == GIT_REF_SYMBOLIC)\n\t\tgit_buf_puts(out, git_reference__shorthand(git_reference_symbolic_target(old)));\n\telse\n\t\tgit_buf_puts(out, git_oid_tostr_s(git_reference_target(old)));\n\n\tgit_buf_puts(out, \" to \");\n\n\tif (git_reference__is_branch(new))\n\t\tgit_buf_puts(out, git_reference__shorthand(new));\n\telse\n\t\tgit_buf_puts(out, new);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int checkout_message(git_buf *out, git_reference *old, const char *new)\n{\n\tgit_buf_puts(out, \"checkout: moving from \");\n\n\tif (git_reference_type(old) == GIT_REF_SYMBOLIC)\n\t\tgit_buf_puts(out, git_reference__shorthand(git_reference_symbolic_target(old)));\n\telse\n\t\tgit_buf_puts(out, git_oid_tostr_s(git_reference_target(old)));\n\n\tgit_buf_puts(out, \" to \");\n\n\tif (git_reference__is_branch(new))\n\t\tgit_buf_puts(out, git_reference__shorthand(new));\n\telse\n\t\tgit_buf_puts(out, new);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_tostr_s",
          "args": [
            "git_object_id(peeled)"
          ],
          "line": 2144
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_tostr_s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "103-108",
          "snippet": "char *git_oid_tostr_s(const git_oid *oid)\n{\n\tchar *str = GIT_GLOBAL->oid_fmt;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr_s(const git_oid *oid)\n{\n\tchar *str = GIT_GLOBAL->oid_fmt;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_peel",
          "args": [
            "&peeled",
            "object",
            "GIT_OBJ_COMMIT"
          ],
          "line": 2140
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "327-381",
          "snippet": "int git_object_peel(\n\tgit_object **peeled,\n\tconst git_object *object,\n\tgit_otype target_type)\n{\n\tgit_object *source, *deref = NULL;\n\tint error;\n\n\tassert(object && peeled);\n\n\tassert(target_type == GIT_OBJ_TAG ||\n\t\ttarget_type == GIT_OBJ_COMMIT ||\n\t\ttarget_type == GIT_OBJ_TREE ||\n\t\ttarget_type == GIT_OBJ_BLOB ||\n\t\ttarget_type == GIT_OBJ_ANY);\n\n\tif ((error = check_type_combination(git_object_type(object), target_type)) < 0)\n\t\treturn peel_error(error, git_object_id(object), target_type);\n\n\tif (git_object_type(object) == target_type)\n\t\treturn git_object_dup(peeled, (git_object *)object);\n\n\tsource = (git_object *)object;\n\n\twhile (!(error = dereference_object(&deref, source))) {\n\n\t\tif (source != object)\n\t\t\tgit_object_free(source);\n\n\t\tif (git_object_type(deref) == target_type) {\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (target_type == GIT_OBJ_ANY &&\n\t\t\tgit_object_type(deref) != git_object_type(object))\n\t\t{\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tsource = deref;\n\t\tderef = NULL;\n\t}\n\n\tif (source != object)\n\t\tgit_object_free(source);\n\n\tgit_object_free(deref);\n\n\tif (error)\n\t\terror = peel_error(error, git_object_id(object), target_type);\n\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_peel(\n\tgit_object **peeled,\n\tconst git_object *object,\n\tgit_otype target_type)\n{\n\tgit_object *source, *deref = NULL;\n\tint error;\n\n\tassert(object && peeled);\n\n\tassert(target_type == GIT_OBJ_TAG ||\n\t\ttarget_type == GIT_OBJ_COMMIT ||\n\t\ttarget_type == GIT_OBJ_TREE ||\n\t\ttarget_type == GIT_OBJ_BLOB ||\n\t\ttarget_type == GIT_OBJ_ANY);\n\n\tif ((error = check_type_combination(git_object_type(object), target_type)) < 0)\n\t\treturn peel_error(error, git_object_id(object), target_type);\n\n\tif (git_object_type(object) == target_type)\n\t\treturn git_object_dup(peeled, (git_object *)object);\n\n\tsource = (git_object *)object;\n\n\twhile (!(error = dereference_object(&deref, source))) {\n\n\t\tif (source != object)\n\t\t\tgit_object_free(source);\n\n\t\tif (git_object_type(deref) == target_type) {\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (target_type == GIT_OBJ_ANY &&\n\t\t\tgit_object_type(deref) != git_object_type(object))\n\t\t{\n\t\t\t*peeled = deref;\n\t\t\treturn 0;\n\t\t}\n\n\t\tsource = deref;\n\t\tderef = NULL;\n\t}\n\n\tif (source != object)\n\t\tgit_object_free(source);\n\n\tgit_object_free(deref);\n\n\tif (error)\n\t\terror = peel_error(error, git_object_id(object), target_type);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_object_lookup",
          "args": [
            "&object",
            "repo",
            "id",
            "GIT_OBJ_ANY"
          ],
          "line": 2137
        },
        "resolved": true,
        "details": {
          "function_name": "git_object_lookup_bypath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/object.c",
          "lines": "390-423",
          "snippet": "int git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}",
          "includes": [
            "#include \"tag.h\"",
            "#include \"oid.h\"",
            "#include \"blob.h\"",
            "#include \"tree.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/object.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tag.h\"\n#include \"oid.h\"\n#include \"blob.h\"\n#include \"tree.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/object.h\"\n\nint git_object_lookup_bypath(\n\t\tgit_object **out,\n\t\tconst git_object *treeish,\n\t\tconst char *path,\n\t\tgit_otype type)\n{\n\tint error = -1;\n\tgit_tree *tree = NULL;\n\tgit_tree_entry *entry = NULL;\n\n\tassert(out && treeish && path);\n\n\tif ((error = git_object_peel((git_object**)&tree, treeish, GIT_OBJ_TREE)) < 0 ||\n\t\t (error = git_tree_entry_bypath(&entry, tree, path)) < 0)\n\t{\n\t\tgoto cleanup;\n\t}\n\n\tif (type != GIT_OBJ_ANY && git_tree_entry_type(entry) != type)\n\t{\n\t\tgiterr_set(GITERR_OBJECT,\n\t\t\t\t\"object at path '%s' is not of the asked-for type %d\",\n\t\t\t\tpath, type);\n\t\terror = GIT_EINVALIDSPEC;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_tree_entry_to_object(out, git_object_owner(treeish), entry);\n\ncleanup:\n\tgit_tree_entry_free(entry);\n\tgit_tree_free(tree);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup",
          "args": [
            "&current",
            "repo",
            "GIT_HEAD_FILE"
          ],
          "line": 2134
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "146-150",
          "snippet": "int git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && id"
          ],
          "line": 2132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int detach(git_repository *repo, const git_oid *id, const char *from)\n{\n\tint error;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tgit_object *object = NULL, *peeled = NULL;\n\tgit_reference *new_head = NULL, *current = NULL;\n\n\tassert(repo && id);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = git_object_lookup(&object, repo, id, GIT_OBJ_ANY)) < 0)\n\t\tgoto cleanup;\n\n\tif ((error = git_object_peel(&peeled, object, GIT_OBJ_COMMIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (from == NULL)\n\t\tfrom = git_oid_tostr_s(git_object_id(peeled));\n\n\tif ((error = checkout_message(&log_message, current, from)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_create(&new_head, repo, GIT_HEAD_FILE, git_object_id(peeled), true, git_buf_cstr(&log_message));\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_object_free(object);\n\tgit_object_free(peeled);\n\tgit_reference_free(current);\n\tgit_reference_free(new_head);\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_set_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2085-2123",
    "snippet": "int git_repository_set_head(\n\tgit_repository* repo,\n\tconst char* refname)\n{\n\tgit_reference *ref = NULL, *current = NULL, *new_head = NULL;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tint error;\n\n\tassert(repo && refname);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = checkout_message(&log_message, current, refname)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_lookup(&ref, repo, refname);\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\tif (!error) {\n\t\tif (git_reference_is_branch(ref)) {\n\t\t\terror = git_reference_symbolic_create(&new_head, repo, GIT_HEAD_FILE,\n\t\t\t\t\tgit_reference_name(ref), true, git_buf_cstr(&log_message));\n\t\t} else {\n\t\t\terror = git_repository_set_head_detached(repo, git_reference_target(ref));\n\t\t}\n\t} else if (git_reference__is_branch(refname)) {\n\t\terror = git_reference_symbolic_create(&new_head, repo, GIT_HEAD_FILE, refname,\n\t\t\t\ttrue, git_buf_cstr(&log_message));\n\t}\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_reference_free(current);\n\tgit_reference_free(ref);\n\tgit_reference_free(new_head);\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "new_head"
          ],
          "line": 2121
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&log_message"
          ],
          "line": 2118
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_symbolic_create",
          "args": [
            "&new_head",
            "repo",
            "GIT_HEAD_FILE",
            "refname",
            "true",
            "git_buf_cstr(&log_message)"
          ],
          "line": 2113
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_symbolic_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "499-508",
          "snippet": "int git_reference_symbolic_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst char *target,\n\tint force,\n\tconst char *log_message)\n{\n\treturn git_reference_symbolic_create_matching(ref_out, repo, name, target, force, NULL, log_message);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_symbolic_create(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tconst char *target,\n\tint force,\n\tconst char *log_message)\n{\n\treturn git_reference_symbolic_create_matching(ref_out, repo, name, target, force, NULL, log_message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&log_message"
          ],
          "line": 2114
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference__is_branch",
          "args": [
            "refname"
          ],
          "line": 2112
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference__is_branch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "1172-1175",
          "snippet": "int git_reference__is_branch(const char *ref_name)\n{\n\treturn git__prefixcmp(ref_name, GIT_REFS_HEADS_DIR) == 0;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference__is_branch(const char *ref_name)\n{\n\treturn git__prefixcmp(ref_name, GIT_REFS_HEADS_DIR) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_set_head_detached",
          "args": [
            "repo",
            "git_reference_target(ref)"
          ],
          "line": 2110
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_head_detached_from_annotated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "2167-2174",
          "snippet": "int git_repository_set_head_detached_from_annotated(\n\tgit_repository *repo,\n\tconst git_annotated_commit *commitish)\n{\n\tassert(repo && commitish);\n\n\treturn detach(repo, git_annotated_commit_id(commitish), commitish->ref_name);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_set_head_detached_from_annotated(\n\tgit_repository *repo,\n\tconst git_annotated_commit *commitish)\n{\n\tassert(repo && commitish);\n\n\treturn detach(repo, git_annotated_commit_id(commitish), commitish->ref_name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_target",
          "args": [
            "ref"
          ],
          "line": 2110
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_target_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "331-339",
          "snippet": "const git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_name",
          "args": [
            "ref"
          ],
          "line": 2108
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "309-313",
          "snippet": "const char *git_reference_name(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->name;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst char *git_reference_name(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_is_branch",
          "args": [
            "ref"
          ],
          "line": 2106
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_is_branch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "1177-1181",
          "snippet": "int git_reference_is_branch(const git_reference *ref)\n{\n\tassert(ref);\n\treturn git_reference__is_branch(ref->name);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_is_branch(const git_reference *ref)\n{\n\tassert(ref);\n\treturn git_reference__is_branch(ref->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup",
          "args": [
            "&ref",
            "repo",
            "refname"
          ],
          "line": 2101
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "146-150",
          "snippet": "int git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkout_message",
          "args": [
            "&log_message",
            "current",
            "refname"
          ],
          "line": 2098
        },
        "resolved": true,
        "details": {
          "function_name": "checkout_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "2063-2083",
          "snippet": "static int checkout_message(git_buf *out, git_reference *old, const char *new)\n{\n\tgit_buf_puts(out, \"checkout: moving from \");\n\n\tif (git_reference_type(old) == GIT_REF_SYMBOLIC)\n\t\tgit_buf_puts(out, git_reference__shorthand(git_reference_symbolic_target(old)));\n\telse\n\t\tgit_buf_puts(out, git_oid_tostr_s(git_reference_target(old)));\n\n\tgit_buf_puts(out, \" to \");\n\n\tif (git_reference__is_branch(new))\n\t\tgit_buf_puts(out, git_reference__shorthand(new));\n\telse\n\t\tgit_buf_puts(out, new);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int checkout_message(git_buf *out, git_reference *old, const char *new)\n{\n\tgit_buf_puts(out, \"checkout: moving from \");\n\n\tif (git_reference_type(old) == GIT_REF_SYMBOLIC)\n\t\tgit_buf_puts(out, git_reference__shorthand(git_reference_symbolic_target(old)));\n\telse\n\t\tgit_buf_puts(out, git_oid_tostr_s(git_reference_target(old)));\n\n\tgit_buf_puts(out, \" to \");\n\n\tif (git_reference__is_branch(new))\n\t\tgit_buf_puts(out, git_reference__shorthand(new));\n\telse\n\t\tgit_buf_puts(out, new);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && refname"
          ],
          "line": 2093
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_set_head(\n\tgit_repository* repo,\n\tconst char* refname)\n{\n\tgit_reference *ref = NULL, *current = NULL, *new_head = NULL;\n\tgit_buf log_message = GIT_BUF_INIT;\n\tint error;\n\n\tassert(repo && refname);\n\n\tif ((error = git_reference_lookup(&current, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif ((error = checkout_message(&log_message, current, refname)) < 0)\n\t\tgoto cleanup;\n\n\terror = git_reference_lookup(&ref, repo, refname);\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\tif (!error) {\n\t\tif (git_reference_is_branch(ref)) {\n\t\t\terror = git_reference_symbolic_create(&new_head, repo, GIT_HEAD_FILE,\n\t\t\t\t\tgit_reference_name(ref), true, git_buf_cstr(&log_message));\n\t\t} else {\n\t\t\terror = git_repository_set_head_detached(repo, git_reference_target(ref));\n\t\t}\n\t} else if (git_reference__is_branch(refname)) {\n\t\terror = git_reference_symbolic_create(&new_head, repo, GIT_HEAD_FILE, refname,\n\t\t\t\ttrue, git_buf_cstr(&log_message));\n\t}\n\ncleanup:\n\tgit_buf_free(&log_message);\n\tgit_reference_free(current);\n\tgit_reference_free(ref);\n\tgit_reference_free(new_head);\n\treturn error;\n}"
  },
  {
    "function_name": "checkout_message",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "2063-2083",
    "snippet": "static int checkout_message(git_buf *out, git_reference *old, const char *new)\n{\n\tgit_buf_puts(out, \"checkout: moving from \");\n\n\tif (git_reference_type(old) == GIT_REF_SYMBOLIC)\n\t\tgit_buf_puts(out, git_reference__shorthand(git_reference_symbolic_target(old)));\n\telse\n\t\tgit_buf_puts(out, git_oid_tostr_s(git_reference_target(old)));\n\n\tgit_buf_puts(out, \" to \");\n\n\tif (git_reference__is_branch(new))\n\t\tgit_buf_puts(out, git_reference__shorthand(new));\n\telse\n\t\tgit_buf_puts(out, new);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "out"
          ],
          "line": 2079
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_puts",
          "args": [
            "out",
            "new"
          ],
          "line": 2077
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "225-229",
          "snippet": "int git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_puts(git_buf *buf, const char *string)\n{\n\tassert(string);\n\treturn git_buf_put(buf, string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference__shorthand",
          "args": [
            "new"
          ],
          "line": 2075
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference__shorthand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "1284-1297",
          "snippet": "const char *git_reference__shorthand(const char *name)\n{\n\tif (!git__prefixcmp(name, GIT_REFS_HEADS_DIR))\n\t\treturn name + strlen(GIT_REFS_HEADS_DIR);\n\telse if (!git__prefixcmp(name, GIT_REFS_TAGS_DIR))\n\t\treturn name + strlen(GIT_REFS_TAGS_DIR);\n\telse if (!git__prefixcmp(name, GIT_REFS_REMOTES_DIR))\n\t\treturn name + strlen(GIT_REFS_REMOTES_DIR);\n\telse if (!git__prefixcmp(name, GIT_REFS_DIR))\n\t\treturn name + strlen(GIT_REFS_DIR);\n\n\t/* No shorthands are avaiable, so just return the name */\n\treturn name;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst char *git_reference__shorthand(const char *name)\n{\n\tif (!git__prefixcmp(name, GIT_REFS_HEADS_DIR))\n\t\treturn name + strlen(GIT_REFS_HEADS_DIR);\n\telse if (!git__prefixcmp(name, GIT_REFS_TAGS_DIR))\n\t\treturn name + strlen(GIT_REFS_TAGS_DIR);\n\telse if (!git__prefixcmp(name, GIT_REFS_REMOTES_DIR))\n\t\treturn name + strlen(GIT_REFS_REMOTES_DIR);\n\telse if (!git__prefixcmp(name, GIT_REFS_DIR))\n\t\treturn name + strlen(GIT_REFS_DIR);\n\n\t/* No shorthands are avaiable, so just return the name */\n\treturn name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference__is_branch",
          "args": [
            "new"
          ],
          "line": 2074
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference__is_branch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "1172-1175",
          "snippet": "int git_reference__is_branch(const char *ref_name)\n{\n\treturn git__prefixcmp(ref_name, GIT_REFS_HEADS_DIR) == 0;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference__is_branch(const char *ref_name)\n{\n\treturn git__prefixcmp(ref_name, GIT_REFS_HEADS_DIR) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_tostr_s",
          "args": [
            "git_reference_target(old)"
          ],
          "line": 2070
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_tostr_s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "103-108",
          "snippet": "char *git_oid_tostr_s(const git_oid *oid)\n{\n\tchar *str = GIT_GLOBAL->oid_fmt;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nchar *git_oid_tostr_s(const git_oid *oid)\n{\n\tchar *str = GIT_GLOBAL->oid_fmt;\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ + 1, oid);\n\treturn str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_target",
          "args": [
            "old"
          ],
          "line": 2070
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_target_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "331-339",
          "snippet": "const git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_symbolic_target",
          "args": [
            "old"
          ],
          "line": 2068
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_symbolic_target",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "341-349",
          "snippet": "const char *git_reference_symbolic_target(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_SYMBOLIC)\n\t\treturn NULL;\n\n\treturn ref->target.symbolic;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst char *git_reference_symbolic_target(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_SYMBOLIC)\n\t\treturn NULL;\n\n\treturn ref->target.symbolic;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_type",
          "args": [
            "old"
          ],
          "line": 2067
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "303-307",
          "snippet": "git_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\ngit_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int checkout_message(git_buf *out, git_reference *old, const char *new)\n{\n\tgit_buf_puts(out, \"checkout: moving from \");\n\n\tif (git_reference_type(old) == GIT_REF_SYMBOLIC)\n\t\tgit_buf_puts(out, git_reference__shorthand(git_reference_symbolic_target(old)));\n\telse\n\t\tgit_buf_puts(out, git_oid_tostr_s(git_reference_target(old)));\n\n\tgit_buf_puts(out, \" to \");\n\n\tif (git_reference__is_branch(new))\n\t\tgit_buf_puts(out, git_reference__shorthand(new));\n\telse\n\t\tgit_buf_puts(out, new);\n\n\tif (git_buf_oom(out))\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_hashfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1993-2061",
    "snippet": "int git_repository_hashfile(\n\tgit_oid *out,\n\tgit_repository *repo,\n\tconst char *path,\n\tgit_otype type,\n\tconst char *as_path)\n{\n\tint error;\n\tgit_filter_list *fl = NULL;\n\tgit_file fd = -1;\n\tgit_off_t len;\n\tgit_buf full_path = GIT_BUF_INIT;\n\n\tassert(out && path && repo); /* as_path can be NULL */\n\n\t/* At some point, it would be nice if repo could be NULL to just\n\t * apply filter rules defined in system and global files, but for\n\t * now that is not possible because git_filters_load() needs it.\n\t */\n\n\terror = git_path_join_unrooted(\n\t\t&full_path, path, git_repository_workdir(repo), NULL);\n\tif (error < 0)\n\t\treturn error;\n\n\tif (!as_path)\n\t\tas_path = path;\n\n\t/* passing empty string for \"as_path\" indicated --no-filters */\n\tif (strlen(as_path) > 0) {\n\t\terror = git_filter_list_load(\n\t\t\t&fl, repo, NULL, as_path,\n\t\t\tGIT_FILTER_TO_ODB, GIT_FILTER_DEFAULT);\n\t\tif (error < 0)\n\t\t\treturn error;\n\t} else {\n\t\terror = 0;\n\t}\n\n\t/* at this point, error is a count of the number of loaded filters */\n\n\tfd = git_futils_open_ro(full_path.ptr);\n\tif (fd < 0) {\n\t\terror = fd;\n\t\tgoto cleanup;\n\t}\n\n\tlen = git_futils_filesize(fd);\n\tif (len < 0) {\n\t\terror = (int)len;\n\t\tgoto cleanup;\n\t}\n\n\tif (!git__is_sizet(len)) {\n\t\tgiterr_set(GITERR_OS, \"File size overflow for 32-bit systems\");\n\t\terror = -1;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_odb__hashfd_filtered(out, fd, (size_t)len, type, fl);\n\ncleanup:\n\tif (fd >= 0)\n\t\tp_close(fd);\n\tgit_filter_list_free(fl);\n\tgit_buf_free(&full_path);\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&full_path"
          ],
          "line": 2058
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filter_list_free",
          "args": [
            "fl"
          ],
          "line": 2057
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_list_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "589-604",
          "snippet": "void git_filter_list_free(git_filter_list *fl)\n{\n\tuint32_t i;\n\n\tif (!fl)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(fl->filters); ++i) {\n\t\tgit_filter_entry *fe = git_array_get(fl->filters, i);\n\t\tif (fe->filter->cleanup)\n\t\t\tfe->filter->cleanup(fe->filter, fe->payload);\n\t}\n\n\tgit_array_clear(fl->filters);\n\tgit__free(fl);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid git_filter_list_free(git_filter_list *fl)\n{\n\tuint32_t i;\n\n\tif (!fl)\n\t\treturn;\n\n\tfor (i = 0; i < git_array_size(fl->filters); ++i) {\n\t\tgit_filter_entry *fe = git_array_get(fl->filters, i);\n\t\tif (fe->filter->cleanup)\n\t\t\tfe->filter->cleanup(fe->filter, fe->payload);\n\t}\n\n\tgit_array_clear(fl->filters);\n\tgit__free(fl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_close",
          "args": [
            "fd"
          ],
          "line": 2056
        },
        "resolved": true,
        "details": {
          "function_name": "winhttp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/winhttp.c",
          "lines": "1359-1377",
          "snippet": "static int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}",
          "includes": [
            "#include <urlmon.h>",
            "#include <objbase.h>",
            "#include <winhttp.h>",
            "#include <wincrypt.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"remote.h\"",
            "#include \"smart.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <urlmon.h>\n#include <objbase.h>\n#include <winhttp.h>\n#include <wincrypt.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"remote.h\"\n#include \"smart.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"git2.h\"\n\nstatic int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb__hashfd_filtered",
          "args": [
            "out",
            "fd",
            "(size_t)len",
            "type",
            "fl"
          ],
          "line": 2052
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb__hashfd_filtered",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "190-217",
          "snippet": "int git_odb__hashfd_filtered(\n\tgit_oid *out, git_file fd, size_t size, git_otype type, git_filter_list *fl)\n{\n\tint error;\n\tgit_buf raw = GIT_BUF_INIT;\n\n\tif (!fl)\n\t\treturn git_odb__hashfd(out, fd, size, type);\n\n\t/* size of data is used in header, so we have to read the whole file\n\t * into memory to apply filters before beginning to calculate the hash\n\t */\n\n\tif (!(error = git_futils_readbuffer_fd(&raw, fd, size))) {\n\t\tgit_buf post = GIT_BUF_INIT;\n\n\t\terror = git_filter_list_apply_to_data(&post, fl, &raw);\n\n\t\tgit_buf_free(&raw);\n\n\t\tif (!error)\n\t\t\terror = git_odb_hash(out, post.ptr, post.size, type);\n\n\t\tgit_buf_free(&post);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb__hashfd_filtered(\n\tgit_oid *out, git_file fd, size_t size, git_otype type, git_filter_list *fl)\n{\n\tint error;\n\tgit_buf raw = GIT_BUF_INIT;\n\n\tif (!fl)\n\t\treturn git_odb__hashfd(out, fd, size, type);\n\n\t/* size of data is used in header, so we have to read the whole file\n\t * into memory to apply filters before beginning to calculate the hash\n\t */\n\n\tif (!(error = git_futils_readbuffer_fd(&raw, fd, size))) {\n\t\tgit_buf post = GIT_BUF_INIT;\n\n\t\terror = git_filter_list_apply_to_data(&post, fl, &raw);\n\n\t\tgit_buf_free(&raw);\n\n\t\tif (!error)\n\t\t\terror = git_odb_hash(out, post.ptr, post.size, type);\n\n\t\tgit_buf_free(&post);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"File size overflow for 32-bit systems\""
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__is_sizet",
          "args": [
            "len"
          ],
          "line": 2046
        },
        "resolved": true,
        "details": {
          "function_name": "git__is_sizet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/integer.h",
          "lines": "11-15",
          "snippet": "GIT_INLINE(int) git__is_sizet(git_off_t p)\n{\n\tsize_t r = (size_t)p;\n\treturn p == (git_off_t)r;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "GIT_INLINE(int) git__is_sizet(git_off_t p)\n{\n\tsize_t r = (size_t)p;\n\treturn p == (git_off_t)r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_filesize",
          "args": [
            "fd"
          ],
          "line": 2040
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_filesize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "98-108",
          "snippet": "git_off_t git_futils_filesize(git_file fd)\n{\n\tstruct stat sb;\n\n\tif (p_fstat(fd, &sb)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to stat file descriptor\");\n\t\treturn -1;\n\t}\n\n\treturn sb.st_size;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\ngit_off_t git_futils_filesize(git_file fd)\n{\n\tstruct stat sb;\n\n\tif (p_fstat(fd, &sb)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to stat file descriptor\");\n\t\treturn -1;\n\t}\n\n\treturn sb.st_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_open_ro",
          "args": [
            "full_path.ptr"
          ],
          "line": 2034
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_open_ro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "90-96",
          "snippet": "int git_futils_open_ro(const char *path)\n{\n\tint fd = p_open(path, O_RDONLY);\n\tif (fd < 0)\n\t\treturn git_path_set_error(errno, path, \"open\");\n\treturn fd;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_open_ro(const char *path)\n{\n\tint fd = p_open(path, O_RDONLY);\n\tif (fd < 0)\n\t\treturn git_path_set_error(errno, path, \"open\");\n\treturn fd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filter_list_load",
          "args": [
            "&fl",
            "repo",
            "NULL",
            "as_path",
            "GIT_FILTER_TO_ODB",
            "GIT_FILTER_DEFAULT"
          ],
          "line": 2023
        },
        "resolved": true,
        "details": {
          "function_name": "git_filter_list_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filter.c",
          "lines": "573-587",
          "snippet": "int git_filter_list_load(\n\tgit_filter_list **filters,\n\tgit_repository *repo,\n\tgit_blob *blob, /* can be NULL */\n\tconst char *path,\n\tgit_filter_mode_t mode,\n\tuint32_t flags)\n{\n\tgit_filter_options filter_opts = GIT_FILTER_OPTIONS_INIT;\n\n\tfilter_opts.flags = flags;\n\n\treturn git_filter_list__load_ext(\n\t\tfilters, repo, blob, path, mode, &filter_opts);\n}",
          "includes": [
            "#include \"array.h\"",
            "#include \"attr_file.h\"",
            "#include \"blob.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/sys/filter.h\"",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n#include \"attr_file.h\"\n#include \"blob.h\"\n#include \"git2/config.h\"\n#include \"git2/sys/filter.h\"\n#include \"global.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_filter_list_load(\n\tgit_filter_list **filters,\n\tgit_repository *repo,\n\tgit_blob *blob, /* can be NULL */\n\tconst char *path,\n\tgit_filter_mode_t mode,\n\tuint32_t flags)\n{\n\tgit_filter_options filter_opts = GIT_FILTER_OPTIONS_INIT;\n\n\tfilter_opts.flags = flags;\n\n\treturn git_filter_list__load_ext(\n\t\tfilters, repo, blob, path, mode, &filter_opts);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "as_path"
          ],
          "line": 2022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_path_join_unrooted",
          "args": [
            "&full_path",
            "path",
            "git_repository_workdir(repo)",
            "NULL"
          ],
          "line": 2013
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_join_unrooted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "279-307",
          "snippet": "int git_path_join_unrooted(\n\tgit_buf *path_out, const char *path, const char *base, ssize_t *root_at)\n{\n\tssize_t root;\n\n\tassert(path && path_out);\n\n\troot = (ssize_t)git_path_root(path);\n\n\tif (base != NULL && root < 0) {\n\t\tif (git_buf_joinpath(path_out, base, path) < 0)\n\t\t\treturn -1;\n\n\t\troot = (ssize_t)strlen(base);\n\t} else {\n\t\tif (git_buf_sets(path_out, path) < 0)\n\t\t\treturn -1;\n\n\t\tif (root < 0)\n\t\t\troot = 0;\n\t\telse if (base)\n\t\t\tgit_path_equal_or_prefixed(base, path, &root);\n\t}\n\n\tif (root_at)\n\t\t*root_at = root;\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_join_unrooted(\n\tgit_buf *path_out, const char *path, const char *base, ssize_t *root_at)\n{\n\tssize_t root;\n\n\tassert(path && path_out);\n\n\troot = (ssize_t)git_path_root(path);\n\n\tif (base != NULL && root < 0) {\n\t\tif (git_buf_joinpath(path_out, base, path) < 0)\n\t\t\treturn -1;\n\n\t\troot = (ssize_t)strlen(base);\n\t} else {\n\t\tif (git_buf_sets(path_out, path) < 0)\n\t\t\treturn -1;\n\n\t\tif (root < 0)\n\t\t\troot = 0;\n\t\telse if (base)\n\t\t\tgit_path_equal_or_prefixed(base, path, &root);\n\t}\n\n\tif (root_at)\n\t\t*root_at = root;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_workdir",
          "args": [
            "repo"
          ],
          "line": 2014
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_workdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1828-1836",
          "snippet": "const char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && path && repo"
          ],
          "line": 2006
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_hashfile(\n\tgit_oid *out,\n\tgit_repository *repo,\n\tconst char *path,\n\tgit_otype type,\n\tconst char *as_path)\n{\n\tint error;\n\tgit_filter_list *fl = NULL;\n\tgit_file fd = -1;\n\tgit_off_t len;\n\tgit_buf full_path = GIT_BUF_INIT;\n\n\tassert(out && path && repo); /* as_path can be NULL */\n\n\t/* At some point, it would be nice if repo could be NULL to just\n\t * apply filter rules defined in system and global files, but for\n\t * now that is not possible because git_filters_load() needs it.\n\t */\n\n\terror = git_path_join_unrooted(\n\t\t&full_path, path, git_repository_workdir(repo), NULL);\n\tif (error < 0)\n\t\treturn error;\n\n\tif (!as_path)\n\t\tas_path = path;\n\n\t/* passing empty string for \"as_path\" indicated --no-filters */\n\tif (strlen(as_path) > 0) {\n\t\terror = git_filter_list_load(\n\t\t\t&fl, repo, NULL, as_path,\n\t\t\tGIT_FILTER_TO_ODB, GIT_FILTER_DEFAULT);\n\t\tif (error < 0)\n\t\t\treturn error;\n\t} else {\n\t\terror = 0;\n\t}\n\n\t/* at this point, error is a count of the number of loaded filters */\n\n\tfd = git_futils_open_ro(full_path.ptr);\n\tif (fd < 0) {\n\t\terror = fd;\n\t\tgoto cleanup;\n\t}\n\n\tlen = git_futils_filesize(fd);\n\tif (len < 0) {\n\t\terror = (int)len;\n\t\tgoto cleanup;\n\t}\n\n\tif (!git__is_sizet(len)) {\n\t\tgiterr_set(GITERR_OS, \"File size overflow for 32-bit systems\");\n\t\terror = -1;\n\t\tgoto cleanup;\n\t}\n\n\terror = git_odb__hashfd_filtered(out, fd, (size_t)len, type, fl);\n\ncleanup:\n\tif (fd >= 0)\n\t\tp_close(fd);\n\tgit_filter_list_free(fl);\n\tgit_buf_free(&full_path);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_message_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1979-1991",
    "snippet": "int git_repository_message_remove(git_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint error;\n\n\tif (git_buf_joinpath(&path, repo->path_repository, GIT_MERGE_MSG_FILE) < 0)\n\t\treturn -1;\n\n\terror = p_unlink(git_buf_cstr(&path));\n\tgit_buf_free(&path);\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 1988
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_unlink",
          "args": [
            "git_buf_cstr(&path)"
          ],
          "line": 1987
        },
        "resolved": true,
        "details": {
          "function_name": "p_unlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "92-110",
          "snippet": "int p_unlink(const char *path)\n{\n\tgit_win32_path buf;\n\tint error;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\terror = _wunlink(buf);\n\n\t/* If the file could not be deleted because it was\n\t * read-only, clear the bit and try again */\n\tif (error == -1 && errno == EACCES) {\n\t\t_wchmod(buf, 0666);\n\t\terror = _wunlink(buf);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_unlink(const char *path)\n{\n\tgit_win32_path buf;\n\tint error;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\terror = _wunlink(buf);\n\n\t/* If the file could not be deleted because it was\n\t * read-only, clear the bit and try again */\n\tif (error == -1 && errno == EACCES) {\n\t\t_wchmod(buf, 0666);\n\t\terror = _wunlink(buf);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&path"
          ],
          "line": 1987
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "repo->path_repository",
            "GIT_MERGE_MSG_FILE"
          ],
          "line": 1984
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_message_remove(git_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint error;\n\n\tif (git_buf_joinpath(&path, repo->path_repository, GIT_MERGE_MSG_FILE) < 0)\n\t\treturn -1;\n\n\terror = p_unlink(git_buf_cstr(&path));\n\tgit_buf_free(&path);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_message",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1955-1977",
    "snippet": "int git_repository_message(git_buf *out, git_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tint error;\n\n\tgit_buf_sanitize(out);\n\n\tif (git_buf_joinpath(&path, repo->path_repository, GIT_MERGE_MSG_FILE) < 0)\n\t\treturn -1;\n\n\tif ((error = p_stat(git_buf_cstr(&path), &st)) < 0) {\n\t\tif (errno == ENOENT)\n\t\t\terror = GIT_ENOTFOUND;\n\t\tgiterr_set(GITERR_OS, \"Could not access message file\");\n\t} else {\n\t\terror = git_futils_readbuffer(out, git_buf_cstr(&path));\n\t}\n\n\tgit_buf_free(&path);\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 1974
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_readbuffer",
          "args": [
            "out",
            "git_buf_cstr(&path)"
          ],
          "line": 1971
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_readbuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "224-227",
          "snippet": "int git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&path"
          ],
          "line": 1971
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Could not access message file\""
          ],
          "line": 1969
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_stat",
          "args": [
            "git_buf_cstr(&path)",
            "&st"
          ],
          "line": 1966
        },
        "resolved": true,
        "details": {
          "function_name": "p_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "417-432",
          "snippet": "int p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "repo->path_repository",
            "GIT_MERGE_MSG_FILE"
          ],
          "line": 1963
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "out"
          ],
          "line": 1961
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_message(git_buf *out, git_repository *repo)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tint error;\n\n\tgit_buf_sanitize(out);\n\n\tif (git_buf_joinpath(&path, repo->path_repository, GIT_MERGE_MSG_FILE) < 0)\n\t\treturn -1;\n\n\tif ((error = p_stat(git_buf_cstr(&path), &st)) < 0) {\n\t\tif (errno == ENOENT)\n\t\t\terror = GIT_ENOTFOUND;\n\t\tgiterr_set(GITERR_OS, \"Could not access message file\");\n\t} else {\n\t\terror = git_futils_readbuffer(out, git_buf_cstr(&path));\n\t}\n\n\tgit_buf_free(&path);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository__set_orig_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1933-1953",
    "snippet": "int git_repository__set_orig_head(git_repository *repo, const git_oid *orig_head)\n{\n\tgit_filebuf file = GIT_FILEBUF_INIT;\n\tgit_buf file_path = GIT_BUF_INIT;\n\tchar orig_head_str[GIT_OID_HEXSZ];\n\tint error = 0;\n\n\tgit_oid_fmt(orig_head_str, orig_head);\n\n\tif ((error = git_buf_joinpath(&file_path, repo->path_repository, GIT_ORIG_HEAD_FILE)) == 0 &&\n\t\t(error = git_filebuf_open(&file, file_path.ptr, GIT_FILEBUF_FORCE, GIT_MERGE_FILE_MODE)) == 0 &&\n\t\t(error = git_filebuf_printf(&file, \"%.*s\\n\", GIT_OID_HEXSZ, orig_head_str)) == 0)\n\t\terror = git_filebuf_commit(&file);\n\n\tif (error < 0)\n\t\tgit_filebuf_cleanup(&file);\n\n\tgit_buf_free(&file_path);\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&file_path"
          ],
          "line": 1950
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filebuf_cleanup",
          "args": [
            "&file"
          ],
          "line": 1948
        },
        "resolved": true,
        "details": {
          "function_name": "git_filebuf_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filebuf.c",
          "lines": "104-133",
          "snippet": "void git_filebuf_cleanup(git_filebuf *file)\n{\n\tif (file->fd_is_open && file->fd >= 0)\n\t\tp_close(file->fd);\n\n\tif (file->created_lock && !file->did_rename && file->path_lock && git_path_exists(file->path_lock))\n\t\tp_unlink(file->path_lock);\n\n\tif (file->compute_digest) {\n\t\tgit_hash_ctx_cleanup(&file->digest);\n\t\tfile->compute_digest = 0;\n\t}\n\n\tif (file->buffer)\n\t\tgit__free(file->buffer);\n\n\t/* use the presence of z_buf to decide if we need to deflateEnd */\n\tif (file->z_buf) {\n\t\tgit__free(file->z_buf);\n\t\tdeflateEnd(&file->zs);\n\t}\n\n\tif (file->path_original)\n\t\tgit__free(file->path_original);\n\tif (file->path_lock)\n\t\tgit__free(file->path_lock);\n\n\tmemset(file, 0x0, sizeof(git_filebuf));\n\tfile->fd = -1;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n\nvoid git_filebuf_cleanup(git_filebuf *file)\n{\n\tif (file->fd_is_open && file->fd >= 0)\n\t\tp_close(file->fd);\n\n\tif (file->created_lock && !file->did_rename && file->path_lock && git_path_exists(file->path_lock))\n\t\tp_unlink(file->path_lock);\n\n\tif (file->compute_digest) {\n\t\tgit_hash_ctx_cleanup(&file->digest);\n\t\tfile->compute_digest = 0;\n\t}\n\n\tif (file->buffer)\n\t\tgit__free(file->buffer);\n\n\t/* use the presence of z_buf to decide if we need to deflateEnd */\n\tif (file->z_buf) {\n\t\tgit__free(file->z_buf);\n\t\tdeflateEnd(&file->zs);\n\t}\n\n\tif (file->path_original)\n\t\tgit__free(file->path_original);\n\tif (file->path_lock)\n\t\tgit__free(file->path_lock);\n\n\tmemset(file, 0x0, sizeof(git_filebuf));\n\tfile->fd = -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filebuf_commit",
          "args": [
            "&file"
          ],
          "line": 1945
        },
        "resolved": true,
        "details": {
          "function_name": "git_filebuf_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filebuf.c",
          "lines": "410-443",
          "snippet": "int git_filebuf_commit(git_filebuf *file)\n{\n\t/* temporary files cannot be committed */\n\tassert(file && file->path_original);\n\n\tfile->flush_mode = Z_FINISH;\n\tflush_buffer(file);\n\n\tif (verify_last_error(file) < 0)\n\t\tgoto on_error;\n\n\tfile->fd_is_open = false;\n\n\tif (p_close(file->fd) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to close file at '%s'\", file->path_lock);\n\t\tgoto on_error;\n\t}\n\n\tfile->fd = -1;\n\n\tif (p_rename(file->path_lock, file->path_original) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to rename lockfile to '%s'\", file->path_original);\n\t\tgoto on_error;\n\t}\n\n\tfile->did_rename = true;\n\n\tgit_filebuf_cleanup(file);\n\treturn 0;\n\non_error:\n\tgit_filebuf_cleanup(file);\n\treturn -1;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n\nint git_filebuf_commit(git_filebuf *file)\n{\n\t/* temporary files cannot be committed */\n\tassert(file && file->path_original);\n\n\tfile->flush_mode = Z_FINISH;\n\tflush_buffer(file);\n\n\tif (verify_last_error(file) < 0)\n\t\tgoto on_error;\n\n\tfile->fd_is_open = false;\n\n\tif (p_close(file->fd) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to close file at '%s'\", file->path_lock);\n\t\tgoto on_error;\n\t}\n\n\tfile->fd = -1;\n\n\tif (p_rename(file->path_lock, file->path_original) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to rename lockfile to '%s'\", file->path_original);\n\t\tgoto on_error;\n\t}\n\n\tfile->did_rename = true;\n\n\tgit_filebuf_cleanup(file);\n\treturn 0;\n\non_error:\n\tgit_filebuf_cleanup(file);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filebuf_printf",
          "args": [
            "&file",
            "\"%.*s\\n\"",
            "GIT_OID_HEXSZ",
            "orig_head_str"
          ],
          "line": 1944
        },
        "resolved": true,
        "details": {
          "function_name": "git_filebuf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filebuf.c",
          "lines": "502-556",
          "snippet": "int git_filebuf_printf(git_filebuf *file, const char *format, ...)\n{\n\tva_list arglist;\n\tsize_t space_left, len, alloclen;\n\tint written, res;\n\tchar *tmp_buffer;\n\n\tENSURE_BUF_OK(file);\n\n\tspace_left = file->buf_size - file->buf_pos;\n\n\tdo {\n\t\tva_start(arglist, format);\n\t\twritten = p_vsnprintf((char *)file->buffer + file->buf_pos, space_left, format, arglist);\n\t\tva_end(arglist);\n\n\t\tif (written < 0) {\n\t\t\tfile->last_error = BUFERR_MEM;\n\t\t\treturn -1;\n\t\t}\n\n\t\tlen = written;\n\t\tif (len + 1 <= space_left) {\n\t\t\tfile->buf_pos += len;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (flush_buffer(file) < 0)\n\t\t\treturn -1;\n\n\t\tspace_left = file->buf_size - file->buf_pos;\n\n\t} while (len + 1 <= space_left);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclen, len, 1) ||\n\t\t!(tmp_buffer = git__malloc(alloclen))) {\n\t\tfile->last_error = BUFERR_MEM;\n\t\treturn -1;\n\t}\n\n\tva_start(arglist, format);\n\twritten = p_vsnprintf(tmp_buffer, len + 1, format, arglist);\n\tva_end(arglist);\n\n\tif (written < 0) {\n\t\tgit__free(tmp_buffer);\n\t\tfile->last_error = BUFERR_MEM;\n\t\treturn -1;\n\t}\n\n\tres = git_filebuf_write(file, tmp_buffer, len);\n\tgit__free(tmp_buffer);\n\n\treturn res;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n\nint git_filebuf_printf(git_filebuf *file, const char *format, ...)\n{\n\tva_list arglist;\n\tsize_t space_left, len, alloclen;\n\tint written, res;\n\tchar *tmp_buffer;\n\n\tENSURE_BUF_OK(file);\n\n\tspace_left = file->buf_size - file->buf_pos;\n\n\tdo {\n\t\tva_start(arglist, format);\n\t\twritten = p_vsnprintf((char *)file->buffer + file->buf_pos, space_left, format, arglist);\n\t\tva_end(arglist);\n\n\t\tif (written < 0) {\n\t\t\tfile->last_error = BUFERR_MEM;\n\t\t\treturn -1;\n\t\t}\n\n\t\tlen = written;\n\t\tif (len + 1 <= space_left) {\n\t\t\tfile->buf_pos += len;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (flush_buffer(file) < 0)\n\t\t\treturn -1;\n\n\t\tspace_left = file->buf_size - file->buf_pos;\n\n\t} while (len + 1 <= space_left);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclen, len, 1) ||\n\t\t!(tmp_buffer = git__malloc(alloclen))) {\n\t\tfile->last_error = BUFERR_MEM;\n\t\treturn -1;\n\t}\n\n\tva_start(arglist, format);\n\twritten = p_vsnprintf(tmp_buffer, len + 1, format, arglist);\n\tva_end(arglist);\n\n\tif (written < 0) {\n\t\tgit__free(tmp_buffer);\n\t\tfile->last_error = BUFERR_MEM;\n\t\treturn -1;\n\t}\n\n\tres = git_filebuf_write(file, tmp_buffer, len);\n\tgit__free(tmp_buffer);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filebuf_open",
          "args": [
            "&file",
            "file_path.ptr",
            "GIT_FILEBUF_FORCE",
            "GIT_MERGE_FILE_MODE"
          ],
          "line": 1943
        },
        "resolved": true,
        "details": {
          "function_name": "git_filebuf_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filebuf.c",
          "lines": "274-383",
          "snippet": "int git_filebuf_open(git_filebuf *file, const char *path, int flags, mode_t mode)\n{\n\tint compression, error = -1;\n\tsize_t path_len, alloc_len;\n\n\t/* opening an already open buffer is a programming error;\n\t * assert that this never happens instead of returning\n\t * an error code */\n\tassert(file && path && file->buffer == NULL);\n\n\tmemset(file, 0x0, sizeof(git_filebuf));\n\n\tif (flags & GIT_FILEBUF_DO_NOT_BUFFER)\n\t\tfile->do_not_buffer = true;\n\n\tfile->buf_size = WRITE_BUFFER_SIZE;\n\tfile->buf_pos = 0;\n\tfile->fd = -1;\n\tfile->last_error = BUFERR_OK;\n\n\t/* Allocate the main cache buffer */\n\tif (!file->do_not_buffer) {\n\t\tfile->buffer = git__malloc(file->buf_size);\n\t\tGITERR_CHECK_ALLOC(file->buffer);\n\t}\n\n\t/* If we are hashing on-write, allocate a new hash context */\n\tif (flags & GIT_FILEBUF_HASH_CONTENTS) {\n\t\tfile->compute_digest = 1;\n\n\t\tif (git_hash_ctx_init(&file->digest) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tcompression = flags >> GIT_FILEBUF_DEFLATE_SHIFT;\n\n\t/* If we are deflating on-write, */\n\tif (compression != 0) {\n\t\t/* Initialize the ZLib stream */\n\t\tif (deflateInit(&file->zs, compression) != Z_OK) {\n\t\t\tgiterr_set(GITERR_ZLIB, \"Failed to initialize zlib\");\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\t/* Allocate the Zlib cache buffer */\n\t\tfile->z_buf = git__malloc(file->buf_size);\n\t\tGITERR_CHECK_ALLOC(file->z_buf);\n\n\t\t/* Never flush */\n\t\tfile->flush_mode = Z_NO_FLUSH;\n\t\tfile->write = &write_deflate;\n\t} else {\n\t\tfile->write = &write_normal;\n\t}\n\n\t/* If we are writing to a temp file */\n\tif (flags & GIT_FILEBUF_TEMPORARY) {\n\t\tgit_buf tmp_path = GIT_BUF_INIT;\n\n\t\t/* Open the file as temporary for locking */\n\t\tfile->fd = git_futils_mktmp(&tmp_path, path, mode);\n\n\t\tif (file->fd < 0) {\n\t\t\tgit_buf_free(&tmp_path);\n\t\t\tgoto cleanup;\n\t\t}\n\t\tfile->fd_is_open = true;\n\t\tfile->created_lock = true;\n\n\t\t/* No original path */\n\t\tfile->path_original = NULL;\n\t\tfile->path_lock = git_buf_detach(&tmp_path);\n\t\tGITERR_CHECK_ALLOC(file->path_lock);\n\t} else {\n\t\tgit_buf resolved_path = GIT_BUF_INIT;\n\n\t\tif ((error = resolve_symlink(&resolved_path, path)) < 0)\n\t\t\tgoto cleanup;\n\n\t\t/* Save the original path of the file */\n\t\tpath_len = resolved_path.size;\n\t\tfile->path_original = git_buf_detach(&resolved_path);\n\n\t\t/* create the locking path by appending \".lock\" to the original */\n\t\tGITERR_CHECK_ALLOC_ADD(&alloc_len, path_len, GIT_FILELOCK_EXTLENGTH);\n\t\tfile->path_lock = git__malloc(alloc_len);\n\t\tGITERR_CHECK_ALLOC(file->path_lock);\n\n\t\tmemcpy(file->path_lock, file->path_original, path_len);\n\t\tmemcpy(file->path_lock + path_len, GIT_FILELOCK_EXTENSION, GIT_FILELOCK_EXTLENGTH);\n\n\t\tif (git_path_isdir(file->path_original)) {\n\t\t\tgiterr_set(GITERR_FILESYSTEM, \"path '%s' is a directory\", file->path_original);\n\t\t\terror = GIT_EDIRECTORY;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\t/* open the file for locking */\n\t\tif ((error = lock_file(file, flags, mode)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tfile->created_lock = true;\n\t}\n\n\treturn 0;\n\ncleanup:\n\tgit_filebuf_cleanup(file);\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const size_t WRITE_BUFFER_SIZE = (4096 * 2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n\nstatic const size_t WRITE_BUFFER_SIZE = (4096 * 2);\n\nint git_filebuf_open(git_filebuf *file, const char *path, int flags, mode_t mode)\n{\n\tint compression, error = -1;\n\tsize_t path_len, alloc_len;\n\n\t/* opening an already open buffer is a programming error;\n\t * assert that this never happens instead of returning\n\t * an error code */\n\tassert(file && path && file->buffer == NULL);\n\n\tmemset(file, 0x0, sizeof(git_filebuf));\n\n\tif (flags & GIT_FILEBUF_DO_NOT_BUFFER)\n\t\tfile->do_not_buffer = true;\n\n\tfile->buf_size = WRITE_BUFFER_SIZE;\n\tfile->buf_pos = 0;\n\tfile->fd = -1;\n\tfile->last_error = BUFERR_OK;\n\n\t/* Allocate the main cache buffer */\n\tif (!file->do_not_buffer) {\n\t\tfile->buffer = git__malloc(file->buf_size);\n\t\tGITERR_CHECK_ALLOC(file->buffer);\n\t}\n\n\t/* If we are hashing on-write, allocate a new hash context */\n\tif (flags & GIT_FILEBUF_HASH_CONTENTS) {\n\t\tfile->compute_digest = 1;\n\n\t\tif (git_hash_ctx_init(&file->digest) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tcompression = flags >> GIT_FILEBUF_DEFLATE_SHIFT;\n\n\t/* If we are deflating on-write, */\n\tif (compression != 0) {\n\t\t/* Initialize the ZLib stream */\n\t\tif (deflateInit(&file->zs, compression) != Z_OK) {\n\t\t\tgiterr_set(GITERR_ZLIB, \"Failed to initialize zlib\");\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\t/* Allocate the Zlib cache buffer */\n\t\tfile->z_buf = git__malloc(file->buf_size);\n\t\tGITERR_CHECK_ALLOC(file->z_buf);\n\n\t\t/* Never flush */\n\t\tfile->flush_mode = Z_NO_FLUSH;\n\t\tfile->write = &write_deflate;\n\t} else {\n\t\tfile->write = &write_normal;\n\t}\n\n\t/* If we are writing to a temp file */\n\tif (flags & GIT_FILEBUF_TEMPORARY) {\n\t\tgit_buf tmp_path = GIT_BUF_INIT;\n\n\t\t/* Open the file as temporary for locking */\n\t\tfile->fd = git_futils_mktmp(&tmp_path, path, mode);\n\n\t\tif (file->fd < 0) {\n\t\t\tgit_buf_free(&tmp_path);\n\t\t\tgoto cleanup;\n\t\t}\n\t\tfile->fd_is_open = true;\n\t\tfile->created_lock = true;\n\n\t\t/* No original path */\n\t\tfile->path_original = NULL;\n\t\tfile->path_lock = git_buf_detach(&tmp_path);\n\t\tGITERR_CHECK_ALLOC(file->path_lock);\n\t} else {\n\t\tgit_buf resolved_path = GIT_BUF_INIT;\n\n\t\tif ((error = resolve_symlink(&resolved_path, path)) < 0)\n\t\t\tgoto cleanup;\n\n\t\t/* Save the original path of the file */\n\t\tpath_len = resolved_path.size;\n\t\tfile->path_original = git_buf_detach(&resolved_path);\n\n\t\t/* create the locking path by appending \".lock\" to the original */\n\t\tGITERR_CHECK_ALLOC_ADD(&alloc_len, path_len, GIT_FILELOCK_EXTLENGTH);\n\t\tfile->path_lock = git__malloc(alloc_len);\n\t\tGITERR_CHECK_ALLOC(file->path_lock);\n\n\t\tmemcpy(file->path_lock, file->path_original, path_len);\n\t\tmemcpy(file->path_lock + path_len, GIT_FILELOCK_EXTENSION, GIT_FILELOCK_EXTLENGTH);\n\n\t\tif (git_path_isdir(file->path_original)) {\n\t\t\tgiterr_set(GITERR_FILESYSTEM, \"path '%s' is a directory\", file->path_original);\n\t\t\terror = GIT_EDIRECTORY;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\t/* open the file for locking */\n\t\tif ((error = lock_file(file, flags, mode)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tfile->created_lock = true;\n\t}\n\n\treturn 0;\n\ncleanup:\n\tgit_filebuf_cleanup(file);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&file_path",
            "repo->path_repository",
            "GIT_ORIG_HEAD_FILE"
          ],
          "line": 1942
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_oid_fmt",
          "args": [
            "orig_head_str",
            "orig_head"
          ],
          "line": 1940
        },
        "resolved": true,
        "details": {
          "function_name": "git_oid_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/oid.c",
          "lines": "88-91",
          "snippet": "void git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}",
          "includes": [
            "#include <limits.h>",
            "#include <string.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"git2/oid.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <string.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"git2/oid.h\"\n#include \"common.h\"\n\nvoid git_oid_fmt(char *str, const git_oid *oid)\n{\n\tgit_oid_nfmt(str, GIT_OID_HEXSZ, oid);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository__set_orig_head(git_repository *repo, const git_oid *orig_head)\n{\n\tgit_filebuf file = GIT_FILEBUF_INIT;\n\tgit_buf file_path = GIT_BUF_INIT;\n\tchar orig_head_str[GIT_OID_HEXSZ];\n\tint error = 0;\n\n\tgit_oid_fmt(orig_head_str, orig_head);\n\n\tif ((error = git_buf_joinpath(&file_path, repo->path_repository, GIT_ORIG_HEAD_FILE)) == 0 &&\n\t\t(error = git_filebuf_open(&file, file_path.ptr, GIT_FILEBUF_FORCE, GIT_MERGE_FILE_MODE)) == 0 &&\n\t\t(error = git_filebuf_printf(&file, \"%.*s\\n\", GIT_OID_HEXSZ, orig_head_str)) == 0)\n\t\terror = git_filebuf_commit(&file);\n\n\tif (error < 0)\n\t\tgit_filebuf_cleanup(&file);\n\n\tgit_buf_free(&file_path);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_head_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1914-1931",
    "snippet": "int git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "head"
          ],
          "line": 1929
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_peel",
          "args": [
            "&obj",
            "head",
            "GIT_OBJ_TREE"
          ],
          "line": 1923
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "1224-1267",
          "snippet": "int git_reference_peel(\n\tgit_object **peeled,\n\tgit_reference *ref,\n\tgit_otype target_type)\n{\n\tgit_reference *resolved = NULL;\n\tgit_object *target = NULL;\n\tint error;\n\n\tassert(ref);\n\n\tif (ref->type == GIT_REF_OID) {\n\t\tresolved = ref;\n\t} else {\n\t\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\t\treturn peel_error(error, ref, \"Cannot resolve reference\");\n\t}\n\n\tif (!git_oid_iszero(&resolved->peel)) {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->peel, GIT_OBJ_ANY);\n\t} else {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->target.oid, GIT_OBJ_ANY);\n\t}\n\n\tif (error < 0) {\n\t\tpeel_error(error, ref, \"Cannot retrieve reference target\");\n\t\tgoto cleanup;\n\t}\n\n\tif (target_type == GIT_OBJ_ANY && git_object_type(target) != GIT_OBJ_TAG)\n\t\terror = git_object_dup(peeled, target);\n\telse\n\t\terror = git_object_peel(peeled, target, target_type);\n\ncleanup:\n\tgit_object_free(target);\n\n\tif (resolved != ref)\n\t\tgit_reference_free(resolved);\n\n\treturn error;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_peel(\n\tgit_object **peeled,\n\tgit_reference *ref,\n\tgit_otype target_type)\n{\n\tgit_reference *resolved = NULL;\n\tgit_object *target = NULL;\n\tint error;\n\n\tassert(ref);\n\n\tif (ref->type == GIT_REF_OID) {\n\t\tresolved = ref;\n\t} else {\n\t\tif ((error = git_reference_resolve(&resolved, ref)) < 0)\n\t\t\treturn peel_error(error, ref, \"Cannot resolve reference\");\n\t}\n\n\tif (!git_oid_iszero(&resolved->peel)) {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->peel, GIT_OBJ_ANY);\n\t} else {\n\t\terror = git_object_lookup(&target,\n\t\t\tgit_reference_owner(ref), &resolved->target.oid, GIT_OBJ_ANY);\n\t}\n\n\tif (error < 0) {\n\t\tpeel_error(error, ref, \"Cannot retrieve reference target\");\n\t\tgoto cleanup;\n\t}\n\n\tif (target_type == GIT_OBJ_ANY && git_object_type(target) != GIT_OBJ_TAG)\n\t\terror = git_object_dup(peeled, target);\n\telse\n\t\terror = git_object_peel(peeled, target, target_type);\n\ncleanup:\n\tgit_object_free(target);\n\n\tif (resolved != ref)\n\t\tgit_reference_free(resolved);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_head",
          "args": [
            "&head",
            "repo"
          ],
          "line": 1920
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_head_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1914-1931",
          "snippet": "int git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_set_bare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1888-1912",
    "snippet": "int git_repository_set_bare(git_repository *repo)\n{\n\tint error;\n\tgit_config *config;\n\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn 0;\n\n\tif ((error = git_repository_config__weakptr(&config, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_config_set_bool(config, \"core.bare\", true)) < 0)\n\t\treturn error;\n\n\tif ((error = git_config__update_entry(config, \"core.worktree\", NULL, true, true)) < 0)\n\t\treturn error;\n\n\tgit__free(repo->workdir);\n\trepo->workdir = NULL;\n\trepo->is_bare = 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "repo->workdir"
          ],
          "line": 1907
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config__update_entry",
          "args": [
            "config",
            "\"core.worktree\"",
            "NULL",
            "true",
            "true"
          ],
          "line": 1904
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__update_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "640-669",
          "snippet": "int git_config__update_entry(\n\tgit_config *config,\n\tconst char *key,\n\tconst char *value,\n\tbool overwrite_existing,\n\tbool only_if_existing)\n{\n\tint error = 0;\n\tgit_config_entry *ce = NULL;\n\n\tif ((error = git_config__lookup_entry(&ce, config, key, false)) < 0)\n\t\treturn error;\n\n\tif (!ce && only_if_existing) /* entry doesn't exist */\n\t\treturn 0;\n\tif (ce && !overwrite_existing) /* entry would be overwritten */\n\t\treturn 0;\n\tif (value && ce && ce->value && !strcmp(ce->value, value)) /* no change */\n\t\treturn 0;\n\tif (!value && (!ce || !ce->value)) /* asked to delete absent entry */\n\t\treturn 0;\n\n\tif (!value)\n\t\terror = git_config_delete_entry(config, key);\n\telse\n\t\terror = git_config_set_string(config, key, value);\n\n\tgit_config_entry_free(ce);\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__update_entry(\n\tgit_config *config,\n\tconst char *key,\n\tconst char *value,\n\tbool overwrite_existing,\n\tbool only_if_existing)\n{\n\tint error = 0;\n\tgit_config_entry *ce = NULL;\n\n\tif ((error = git_config__lookup_entry(&ce, config, key, false)) < 0)\n\t\treturn error;\n\n\tif (!ce && only_if_existing) /* entry doesn't exist */\n\t\treturn 0;\n\tif (ce && !overwrite_existing) /* entry would be overwritten */\n\t\treturn 0;\n\tif (value && ce && ce->value && !strcmp(ce->value, value)) /* no change */\n\t\treturn 0;\n\tif (!value && (!ce || !ce->value)) /* asked to delete absent entry */\n\t\treturn 0;\n\n\tif (!value)\n\t\terror = git_config_delete_entry(config, key);\n\telse\n\t\terror = git_config_set_string(config, key, value);\n\n\tgit_config_entry_free(ce);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_set_bool",
          "args": [
            "config",
            "\"core.bare\"",
            "true"
          ],
          "line": 1901
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_set_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "611-614",
          "snippet": "int git_config_set_bool(git_config *cfg, const char *name, int value)\n{\n\treturn git_config_set_string(cfg, name, value ? \"true\" : \"false\");\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_bool(git_config *cfg, const char *name, int value)\n{\n\treturn git_config_set_string(cfg, name, value ? \"true\" : \"false\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config__weakptr",
          "args": [
            "&config",
            "repo"
          ],
          "line": 1898
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "661-705",
          "snippet": "int git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 1893
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_set_bare(git_repository *repo)\n{\n\tint error;\n\tgit_config *config;\n\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn 0;\n\n\tif ((error = git_repository_config__weakptr(&config, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_config_set_bool(config, \"core.bare\", true)) < 0)\n\t\treturn error;\n\n\tif ((error = git_config__update_entry(config, \"core.worktree\", NULL, true, true)) < 0)\n\t\treturn error;\n\n\tgit__free(repo->workdir);\n\trepo->workdir = NULL;\n\trepo->is_bare = 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_is_bare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1882-1886",
    "snippet": "int git_repository_is_bare(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->is_bare;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 1884
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_is_bare(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->is_bare;\n}"
  },
  {
    "function_name": "git_repository_set_workdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1838-1880",
    "snippet": "int git_repository_set_workdir(\n\tgit_repository *repo, const char *workdir, int update_gitlink)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\n\tassert(repo && workdir);\n\n\tif (git_path_prettify_dir(&path, workdir, NULL) < 0)\n\t\treturn -1;\n\n\tif (repo->workdir && strcmp(repo->workdir, path.ptr) == 0)\n\t\treturn 0;\n\n\tif (update_gitlink) {\n\t\tgit_config *config;\n\n\t\tif (git_repository_config__weakptr(&config, repo) < 0)\n\t\t\treturn -1;\n\n\t\terror = repo_write_gitlink(path.ptr, git_repository_path(repo), false);\n\n\t\t/* passthrough error means gitlink is unnecessary */\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = git_config_delete_entry(config, \"core.worktree\");\n\t\telse if (!error)\n\t\t\terror = git_config_set_string(config, \"core.worktree\", path.ptr);\n\n\t\tif (!error)\n\t\t\terror = git_config_set_bool(config, \"core.bare\", false);\n\t}\n\n\tif (!error) {\n\t\tchar *old_workdir = repo->workdir;\n\n\t\trepo->workdir = git_buf_detach(&path);\n\t\trepo->is_bare = 0;\n\n\t\tgit__free(old_workdir);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "old_workdir"
          ],
          "line": 1876
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&path"
          ],
          "line": 1873
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_set_bool",
          "args": [
            "config",
            "\"core.bare\"",
            "false"
          ],
          "line": 1867
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_set_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "611-614",
          "snippet": "int git_config_set_bool(git_config *cfg, const char *name, int value)\n{\n\treturn git_config_set_string(cfg, name, value ? \"true\" : \"false\");\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_bool(git_config *cfg, const char *name, int value)\n{\n\treturn git_config_set_string(cfg, name, value ? \"true\" : \"false\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_set_string",
          "args": [
            "config",
            "\"core.worktree\"",
            "path.ptr"
          ],
          "line": 1864
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_set_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "616-638",
          "snippet": "int git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_string(git_config *cfg, const char *name, const char *value)\n{\n\tint error;\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tif (!value) {\n\t\tgiterr_set(GITERR_CONFIG, \"The value to set cannot be NULL\");\n\t\treturn -1;\n\t}\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\terror = file->set(file, name, value);\n\n\tif (!error && GIT_REFCOUNT_OWNER(cfg) != NULL)\n\t\tgit_repository__cvar_cache_clear(GIT_REFCOUNT_OWNER(cfg));\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_delete_entry",
          "args": [
            "config",
            "\"core.worktree\""
          ],
          "line": 1862
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_delete_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "586-597",
          "snippet": "int git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_write_gitlink",
          "args": [
            "path.ptr",
            "git_repository_path(repo)",
            "false"
          ],
          "line": 1858
        },
        "resolved": true,
        "details": {
          "function_name": "repo_write_gitlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1333-1381",
          "snippet": "static int repo_write_gitlink(\n\tconst char *in_dir, const char *to_repo, bool use_relative_path)\n{\n\tint error;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_buf path_to_repo = GIT_BUF_INIT;\n\tstruct stat st;\n\n\tgit_path_dirname_r(&buf, to_repo);\n\tgit_path_to_dir(&buf);\n\tif (git_buf_oom(&buf))\n\t\treturn -1;\n\n\t/* don't write gitlink to natural workdir */\n\tif (git__suffixcmp(to_repo, \"/\" DOT_GIT \"/\") == 0 &&\n\t\tstrcmp(in_dir, buf.ptr) == 0)\n\t{\n\t\terror = GIT_PASSTHROUGH;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_buf_joinpath(&buf, in_dir, DOT_GIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (!p_stat(buf.ptr, &st) && !S_ISREG(st.st_mode)) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Cannot overwrite gitlink file into path '%s'\", in_dir);\n\t\terror = GIT_EEXISTS;\n\t\tgoto cleanup;\n\t}\n\n\tgit_buf_clear(&buf);\n\n\terror = git_buf_sets(&path_to_repo, to_repo);\n\n\tif (!error && use_relative_path)\n\t\terror = git_path_make_relative(&path_to_repo, in_dir);\n\n\tif (!error)\n\t\terror = git_buf_join(&buf, ' ', GIT_FILE_CONTENT_PREFIX, path_to_repo.ptr);\n\n\tif (!error)\n\t\terror = repo_write_template(in_dir, true, DOT_GIT, 0666, true, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\tgit_buf_free(&path_to_repo);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [
            "#define GIT_FILE_CONTENT_PREFIX \"gitdir:\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_FILE_CONTENT_PREFIX \"gitdir:\"\n\nstatic int repo_write_gitlink(\n\tconst char *in_dir, const char *to_repo, bool use_relative_path)\n{\n\tint error;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_buf path_to_repo = GIT_BUF_INIT;\n\tstruct stat st;\n\n\tgit_path_dirname_r(&buf, to_repo);\n\tgit_path_to_dir(&buf);\n\tif (git_buf_oom(&buf))\n\t\treturn -1;\n\n\t/* don't write gitlink to natural workdir */\n\tif (git__suffixcmp(to_repo, \"/\" DOT_GIT \"/\") == 0 &&\n\t\tstrcmp(in_dir, buf.ptr) == 0)\n\t{\n\t\terror = GIT_PASSTHROUGH;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_buf_joinpath(&buf, in_dir, DOT_GIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (!p_stat(buf.ptr, &st) && !S_ISREG(st.st_mode)) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Cannot overwrite gitlink file into path '%s'\", in_dir);\n\t\terror = GIT_EEXISTS;\n\t\tgoto cleanup;\n\t}\n\n\tgit_buf_clear(&buf);\n\n\terror = git_buf_sets(&path_to_repo, to_repo);\n\n\tif (!error && use_relative_path)\n\t\terror = git_path_make_relative(&path_to_repo, in_dir);\n\n\tif (!error)\n\t\terror = git_buf_join(&buf, ' ', GIT_FILE_CONTENT_PREFIX, path_to_repo.ptr);\n\n\tif (!error)\n\t\terror = repo_write_template(in_dir, true, DOT_GIT, 0666, true, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\tgit_buf_free(&path_to_repo);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_path",
          "args": [
            "repo"
          ],
          "line": 1858
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1822-1826",
          "snippet": "const char *git_repository_path(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->path_repository;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_path(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->path_repository;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config__weakptr",
          "args": [
            "&config",
            "repo"
          ],
          "line": 1855
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "661-705",
          "snippet": "int git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "repo->workdir",
            "path.ptr"
          ],
          "line": 1849
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_prettify_dir",
          "args": [
            "&path",
            "workdir",
            "NULL"
          ],
          "line": 1846
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_prettify_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "335-339",
          "snippet": "int git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && workdir"
          ],
          "line": 1844
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_set_workdir(\n\tgit_repository *repo, const char *workdir, int update_gitlink)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\n\tassert(repo && workdir);\n\n\tif (git_path_prettify_dir(&path, workdir, NULL) < 0)\n\t\treturn -1;\n\n\tif (repo->workdir && strcmp(repo->workdir, path.ptr) == 0)\n\t\treturn 0;\n\n\tif (update_gitlink) {\n\t\tgit_config *config;\n\n\t\tif (git_repository_config__weakptr(&config, repo) < 0)\n\t\t\treturn -1;\n\n\t\terror = repo_write_gitlink(path.ptr, git_repository_path(repo), false);\n\n\t\t/* passthrough error means gitlink is unnecessary */\n\t\tif (error == GIT_PASSTHROUGH)\n\t\t\terror = git_config_delete_entry(config, \"core.worktree\");\n\t\telse if (!error)\n\t\t\terror = git_config_set_string(config, \"core.worktree\", path.ptr);\n\n\t\tif (!error)\n\t\t\terror = git_config_set_bool(config, \"core.bare\", false);\n\t}\n\n\tif (!error) {\n\t\tchar *old_workdir = repo->workdir;\n\n\t\trepo->workdir = git_buf_detach(&path);\n\t\trepo->is_bare = 0;\n\n\t\tgit__free(old_workdir);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_workdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1828-1836",
    "snippet": "const char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 1830
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}"
  },
  {
    "function_name": "git_repository_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1822-1826",
    "snippet": "const char *git_repository_path(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->path_repository;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 1824
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_path(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->path_repository;\n}"
  },
  {
    "function_name": "git_repository_is_empty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1803-1820",
    "snippet": "int git_repository_is_empty(git_repository *repo)\n{\n\tgit_reference *head = NULL;\n\tint is_empty = 0;\n\n\tif (git_reference_lookup(&head, repo, GIT_HEAD_FILE) < 0)\n\t\treturn -1;\n\n\tif (git_reference_type(head) == GIT_REF_SYMBOLIC)\n\t\tis_empty =\n\t\t\t(strcmp(git_reference_symbolic_target(head),\n\t\t\t\t\tGIT_REFS_HEADS_DIR \"master\") == 0) &&\n\t\t\trepo_contains_no_reference(repo);\n\n\tgit_reference_free(head);\n\n\treturn is_empty;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "head"
          ],
          "line": 1817
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_contains_no_reference",
          "args": [
            "repo"
          ],
          "line": 1815
        },
        "resolved": true,
        "details": {
          "function_name": "repo_contains_no_reference",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1790-1801",
          "snippet": "static int repo_contains_no_reference(git_repository *repo)\n{\n\tint error = git_reference_foreach_name(repo, &at_least_one_cb, NULL);\n\n\tif (error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\tif (!error)\n\t\treturn 1;\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_contains_no_reference(git_repository *repo)\n{\n\tint error = git_reference_foreach_name(repo, &at_least_one_cb, NULL);\n\n\tif (error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\tif (!error)\n\t\treturn 1;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "git_reference_symbolic_target(head)",
            "GIT_REFS_HEADS_DIR \"master\""
          ],
          "line": 1813
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_symbolic_target",
          "args": [
            "head"
          ],
          "line": 1813
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_symbolic_target",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "341-349",
          "snippet": "const char *git_reference_symbolic_target(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_SYMBOLIC)\n\t\treturn NULL;\n\n\treturn ref->target.symbolic;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst char *git_reference_symbolic_target(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_SYMBOLIC)\n\t\treturn NULL;\n\n\treturn ref->target.symbolic;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_type",
          "args": [
            "head"
          ],
          "line": 1811
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "303-307",
          "snippet": "git_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\ngit_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup",
          "args": [
            "&head",
            "repo",
            "GIT_HEAD_FILE"
          ],
          "line": 1808
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "146-150",
          "snippet": "int git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_is_empty(git_repository *repo)\n{\n\tgit_reference *head = NULL;\n\tint is_empty = 0;\n\n\tif (git_reference_lookup(&head, repo, GIT_HEAD_FILE) < 0)\n\t\treturn -1;\n\n\tif (git_reference_type(head) == GIT_REF_SYMBOLIC)\n\t\tis_empty =\n\t\t\t(strcmp(git_reference_symbolic_target(head),\n\t\t\t\t\tGIT_REFS_HEADS_DIR \"master\") == 0) &&\n\t\t\trepo_contains_no_reference(repo);\n\n\tgit_reference_free(head);\n\n\treturn is_empty;\n}"
  },
  {
    "function_name": "repo_contains_no_reference",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1790-1801",
    "snippet": "static int repo_contains_no_reference(git_repository *repo)\n{\n\tint error = git_reference_foreach_name(repo, &at_least_one_cb, NULL);\n\n\tif (error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\tif (!error)\n\t\treturn 1;\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_foreach_name",
          "args": [
            "repo",
            "&at_least_one_cb",
            "NULL"
          ],
          "line": 1792
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_foreach_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "658-682",
          "snippet": "int git_reference_foreach_name(\n\tgit_repository *repo,\n\tgit_reference_foreach_name_cb callback,\n\tvoid *payload)\n{\n\tgit_reference_iterator *iter;\n\tconst char *refname;\n\tint error;\n\n\tif ((error = git_reference_iterator_new(&iter, repo)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_reference_next_name(&refname, iter))) {\n\t\tif ((error = callback(refname, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\tgit_reference_iterator_free(iter);\n\treturn error;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_foreach_name(\n\tgit_repository *repo,\n\tgit_reference_foreach_name_cb callback,\n\tvoid *payload)\n{\n\tgit_reference_iterator *iter;\n\tconst char *refname;\n\tint error;\n\n\tif ((error = git_reference_iterator_new(&iter, repo)) < 0)\n\t\treturn error;\n\n\twhile (!(error = git_reference_next_name(&refname, iter))) {\n\t\tif ((error = callback(refname, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error == GIT_ITEROVER)\n\t\terror = 0;\n\n\tgit_reference_iterator_free(iter);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_contains_no_reference(git_repository *repo)\n{\n\tint error = git_reference_foreach_name(repo, &at_least_one_cb, NULL);\n\n\tif (error == GIT_PASSTHROUGH)\n\t\treturn 0;\n\n\tif (!error)\n\t\treturn 1;\n\n\treturn error;\n}"
  },
  {
    "function_name": "at_least_one_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1783-1788",
    "snippet": "static int at_least_one_cb(const char *refname, void *payload)\n{\n\tGIT_UNUSED(refname);\n\tGIT_UNUSED(payload);\n\treturn GIT_PASSTHROUGH;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "payload"
          ],
          "line": 1786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "refname"
          ],
          "line": 1785
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int at_least_one_cb(const char *refname, void *payload)\n{\n\tGIT_UNUSED(refname);\n\tGIT_UNUSED(payload);\n\treturn GIT_PASSTHROUGH;\n}"
  },
  {
    "function_name": "git_repository_head_unborn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1764-1781",
    "snippet": "int git_repository_head_unborn(git_repository *repo)\n{\n\tgit_reference *ref = NULL;\n\tint error;\n\n\terror = git_repository_head(&ref, repo);\n\tgit_reference_free(ref);\n\n\tif (error == GIT_EUNBORNBRANCH) {\n\t\tgiterr_clear();\n\t\treturn 1;\n\t}\n\n\tif (error < 0)\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 1773
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "ref"
          ],
          "line": 1770
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_head",
          "args": [
            "&ref",
            "repo"
          ],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_head_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1914-1931",
          "snippet": "int git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_tree(git_tree **tree, git_repository *repo)\n{\n\tgit_reference *head;\n\tgit_object *obj;\n\tint error;\n\n\tif ((error = git_repository_head(&head, repo)) < 0)\n\t\treturn error;\n\n\tif ((error = git_reference_peel(&obj, head, GIT_OBJ_TREE)) < 0)\n\t\tgoto cleanup;\n\n\t*tree = (git_tree *)obj;\n\ncleanup:\n\tgit_reference_free(head);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_unborn(git_repository *repo)\n{\n\tgit_reference *ref = NULL;\n\tint error;\n\n\terror = git_repository_head(&ref, repo);\n\tgit_reference_free(ref);\n\n\tif (error == GIT_EUNBORNBRANCH) {\n\t\tgiterr_clear();\n\t\treturn 1;\n\t}\n\n\tif (error < 0)\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1745-1762",
    "snippet": "int git_repository_head(git_reference **head_out, git_repository *repo)\n{\n\tgit_reference *head;\n\tint error;\n\n\tif ((error = git_reference_lookup(&head, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif (git_reference_type(head) == GIT_REF_OID) {\n\t\t*head_out = head;\n\t\treturn 0;\n\t}\n\n\terror = git_reference_lookup_resolved(head_out, repo, git_reference_symbolic_target(head), -1);\n\tgit_reference_free(head);\n\n\treturn error == GIT_ENOTFOUND ? GIT_EUNBORNBRANCH : error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "head"
          ],
          "line": 1759
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup_resolved",
          "args": [
            "head_out",
            "repo",
            "git_reference_symbolic_target(head)",
            "-1"
          ],
          "line": 1758
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup_resolved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "181-234",
          "snippet": "int git_reference_lookup_resolved(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tint max_nesting)\n{\n\tgit_refname_t scan_name;\n\tgit_ref_t scan_type;\n\tint error = 0, nesting;\n\tgit_reference *ref = NULL;\n\tgit_refdb *refdb;\n\n\tassert(ref_out && repo && name);\n\n\t*ref_out = NULL;\n\n\tif (max_nesting > MAX_NESTING_LEVEL)\n\t\tmax_nesting = MAX_NESTING_LEVEL;\n\telse if (max_nesting < 0)\n\t\tmax_nesting = DEFAULT_NESTING_LEVEL;\n\n\tscan_type = GIT_REF_SYMBOLIC;\n\n\tif ((error = reference_normalize_for_repo(scan_name, repo, name)) < 0)\n\t\treturn error;\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn error;\n\n\tfor (nesting = max_nesting;\n\t\t nesting >= 0 && scan_type == GIT_REF_SYMBOLIC;\n\t\t nesting--)\n\t{\n\t\tif (nesting != max_nesting) {\n\t\t\tstrncpy(scan_name, ref->target.symbolic, sizeof(scan_name));\n\t\t\tgit_reference_free(ref);\n\t\t}\n\n\t\tif ((error = git_refdb_lookup(&ref, refdb, scan_name)) < 0)\n\t\t\treturn error;\n\n\t\tscan_type = ref->type;\n\t}\n\n\tif (scan_type != GIT_REF_OID && max_nesting != 0) {\n\t\tgiterr_set(GITERR_REFERENCE,\n\t\t\t\"Cannot resolve reference (>%u levels deep)\", max_nesting);\n\t\tgit_reference_free(ref);\n\t\treturn -1;\n\t}\n\n\t*ref_out = ref;\n\treturn 0;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [
            "#define MAX_NESTING_LEVEL\t\t10",
            "#define DEFAULT_NESTING_LEVEL\t5"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\n#define MAX_NESTING_LEVEL\t\t10\n#define DEFAULT_NESTING_LEVEL\t5\n\nint git_reference_lookup_resolved(\n\tgit_reference **ref_out,\n\tgit_repository *repo,\n\tconst char *name,\n\tint max_nesting)\n{\n\tgit_refname_t scan_name;\n\tgit_ref_t scan_type;\n\tint error = 0, nesting;\n\tgit_reference *ref = NULL;\n\tgit_refdb *refdb;\n\n\tassert(ref_out && repo && name);\n\n\t*ref_out = NULL;\n\n\tif (max_nesting > MAX_NESTING_LEVEL)\n\t\tmax_nesting = MAX_NESTING_LEVEL;\n\telse if (max_nesting < 0)\n\t\tmax_nesting = DEFAULT_NESTING_LEVEL;\n\n\tscan_type = GIT_REF_SYMBOLIC;\n\n\tif ((error = reference_normalize_for_repo(scan_name, repo, name)) < 0)\n\t\treturn error;\n\n\tif ((error = git_repository_refdb__weakptr(&refdb, repo)) < 0)\n\t\treturn error;\n\n\tfor (nesting = max_nesting;\n\t\t nesting >= 0 && scan_type == GIT_REF_SYMBOLIC;\n\t\t nesting--)\n\t{\n\t\tif (nesting != max_nesting) {\n\t\t\tstrncpy(scan_name, ref->target.symbolic, sizeof(scan_name));\n\t\t\tgit_reference_free(ref);\n\t\t}\n\n\t\tif ((error = git_refdb_lookup(&ref, refdb, scan_name)) < 0)\n\t\t\treturn error;\n\n\t\tscan_type = ref->type;\n\t}\n\n\tif (scan_type != GIT_REF_OID && max_nesting != 0) {\n\t\tgiterr_set(GITERR_REFERENCE,\n\t\t\t\"Cannot resolve reference (>%u levels deep)\", max_nesting);\n\t\tgit_reference_free(ref);\n\t\treturn -1;\n\t}\n\n\t*ref_out = ref;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_symbolic_target",
          "args": [
            "head"
          ],
          "line": 1758
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_symbolic_target",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "341-349",
          "snippet": "const char *git_reference_symbolic_target(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_SYMBOLIC)\n\t\treturn NULL;\n\n\treturn ref->target.symbolic;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst char *git_reference_symbolic_target(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_SYMBOLIC)\n\t\treturn NULL;\n\n\treturn ref->target.symbolic;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_type",
          "args": [
            "head"
          ],
          "line": 1753
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "303-307",
          "snippet": "git_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\ngit_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup",
          "args": [
            "&head",
            "repo",
            "GIT_HEAD_FILE"
          ],
          "line": 1750
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "146-150",
          "snippet": "int git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head(git_reference **head_out, git_repository *repo)\n{\n\tgit_reference *head;\n\tint error;\n\n\tif ((error = git_reference_lookup(&head, repo, GIT_HEAD_FILE)) < 0)\n\t\treturn error;\n\n\tif (git_reference_type(head) == GIT_REF_OID) {\n\t\t*head_out = head;\n\t\treturn 0;\n\t}\n\n\terror = git_reference_lookup_resolved(head_out, repo, git_reference_symbolic_target(head), -1);\n\tgit_reference_free(head);\n\n\treturn error == GIT_ENOTFOUND ? GIT_EUNBORNBRANCH : error;\n}"
  },
  {
    "function_name": "git_repository_head_detached",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1722-1743",
    "snippet": "int git_repository_head_detached(git_repository *repo)\n{\n\tgit_reference *ref;\n\tgit_odb *odb = NULL;\n\tint exists;\n\n\tif (git_repository_odb__weakptr(&odb, repo) < 0)\n\t\treturn -1;\n\n\tif (git_reference_lookup(&ref, repo, GIT_HEAD_FILE) < 0)\n\t\treturn -1;\n\n\tif (git_reference_type(ref) == GIT_REF_SYMBOLIC) {\n\t\tgit_reference_free(ref);\n\t\treturn 0;\n\t}\n\n\texists = git_odb_exists(odb, git_reference_target(ref));\n\n\tgit_reference_free(ref);\n\treturn exists;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_reference_free",
          "args": [
            "ref"
          ],
          "line": 1741
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "108-120",
          "snippet": "void git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nvoid git_reference_free(git_reference *reference)\n{\n\tif (reference == NULL)\n\t\treturn;\n\n\tif (reference->type == GIT_REF_SYMBOLIC)\n\t\tgit__free(reference->target.symbolic);\n\n\tif (reference->db)\n\t\tGIT_REFCOUNT_DEC(reference->db, git_refdb__free);\n\n\tgit__free(reference);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_exists",
          "args": [
            "odb",
            "git_reference_target(ref)"
          ],
          "line": 1739
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "646-665",
          "snippet": "int git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_exists(git_odb *db, const git_oid *id)\n{\n\tgit_odb_object *object;\n\n\tassert(db && id);\n\n\tif ((object = git_cache_get_raw(odb_cache(db), id)) != NULL) {\n\t\tgit_odb_object_free(object);\n\t\treturn (int)true;\n\t}\n\n\tif (odb_exists_1(db, id, false))\n\t\treturn 1;\n\n\tif (!git_odb_refresh(db))\n\t\treturn odb_exists_1(db, id, true);\n\n\t/* Failed to refresh, hence not found */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_target",
          "args": [
            "ref"
          ],
          "line": 1739
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_target_peel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "331-339",
          "snippet": "const git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nconst git_oid *git_reference_target_peel(const git_reference *ref)\n{\n\tassert(ref);\n\n\tif (ref->type != GIT_REF_OID || git_oid_iszero(&ref->peel))\n\t\treturn NULL;\n\n\treturn &ref->peel;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_type",
          "args": [
            "ref"
          ],
          "line": 1734
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "303-307",
          "snippet": "git_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\ngit_ref_t git_reference_type(const git_reference *ref)\n{\n\tassert(ref);\n\treturn ref->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_reference_lookup",
          "args": [
            "&ref",
            "repo",
            "GIT_HEAD_FILE"
          ],
          "line": 1731
        },
        "resolved": true,
        "details": {
          "function_name": "git_reference_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refs.c",
          "lines": "146-150",
          "snippet": "int git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}",
          "includes": [
            "#include <git2/commit.h>",
            "#include <git2/signature.h>",
            "#include <git2/sys/refs.h>",
            "#include <git2/refdb.h>",
            "#include <git2/refs.h>",
            "#include <git2/branch.h>",
            "#include <git2/oid.h>",
            "#include <git2/object.h>",
            "#include <git2/tag.h>",
            "#include \"refdb.h\"",
            "#include \"reflog.h\"",
            "#include \"pack.h\"",
            "#include \"filebuf.h\"",
            "#include \"fileops.h\"",
            "#include \"repository.h\"",
            "#include \"hash.h\"",
            "#include \"refs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <git2/commit.h>\n#include <git2/signature.h>\n#include <git2/sys/refs.h>\n#include <git2/refdb.h>\n#include <git2/refs.h>\n#include <git2/branch.h>\n#include <git2/oid.h>\n#include <git2/object.h>\n#include <git2/tag.h>\n#include \"refdb.h\"\n#include \"reflog.h\"\n#include \"pack.h\"\n#include \"filebuf.h\"\n#include \"fileops.h\"\n#include \"repository.h\"\n#include \"hash.h\"\n#include \"refs.h\"\n\nint git_reference_lookup(git_reference **ref_out,\n\tgit_repository *repo, const char *name)\n{\n\treturn git_reference_lookup_resolved(ref_out, repo, name, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_odb__weakptr",
          "args": [
            "&odb",
            "repo"
          ],
          "line": 1728
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_odb__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "733-762",
          "snippet": "int git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_head_detached(git_repository *repo)\n{\n\tgit_reference *ref;\n\tgit_odb *odb = NULL;\n\tint exists;\n\n\tif (git_repository_odb__weakptr(&odb, repo) < 0)\n\t\treturn -1;\n\n\tif (git_reference_lookup(&ref, repo, GIT_HEAD_FILE) < 0)\n\t\treturn -1;\n\n\tif (git_reference_type(ref) == GIT_REF_SYMBOLIC) {\n\t\tgit_reference_free(ref);\n\t\treturn 0;\n\t}\n\n\texists = git_odb_exists(odb, git_reference_target(ref));\n\n\tgit_reference_free(ref);\n\treturn exists;\n}"
  },
  {
    "function_name": "git_repository_init_ext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1665-1720",
    "snippet": "int git_repository_init_ext(\n\tgit_repository **out,\n\tconst char *given_repo,\n\tgit_repository_init_options *opts)\n{\n\tint error;\n\tgit_buf repo_path = GIT_BUF_INIT, wd_path = GIT_BUF_INIT;\n\tconst char *wd;\n\n\tassert(out && given_repo && opts);\n\n\tGITERR_CHECK_VERSION(opts, GIT_REPOSITORY_INIT_OPTIONS_VERSION, \"git_repository_init_options\");\n\n\terror = repo_init_directories(&repo_path, &wd_path, given_repo, opts);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\twd = (opts->flags & GIT_REPOSITORY_INIT_BARE) ? NULL : git_buf_cstr(&wd_path);\n\tif (valid_repository_path(&repo_path)) {\n\n\t\tif ((opts->flags & GIT_REPOSITORY_INIT_NO_REINIT) != 0) {\n\t\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\t\"Attempt to reinitialize '%s'\", given_repo);\n\t\t\terror = GIT_EEXISTS;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\topts->flags |= GIT_REPOSITORY_INIT__IS_REINIT;\n\n\t\terror = repo_init_config(\n\t\t\trepo_path.ptr, wd, opts->flags, opts->mode);\n\n\t\t/* TODO: reinitialize the templates */\n\t}\n\telse {\n\t\tif (!(error = repo_init_structure(\n\t\t\t\trepo_path.ptr, wd, opts)) &&\n\t\t\t!(error = repo_init_config(\n\t\t\t\trepo_path.ptr, wd, opts->flags, opts->mode)))\n\t\t\terror = repo_init_create_head(\n\t\t\t\trepo_path.ptr, opts->initial_head);\n\t}\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_repository_open(out, repo_path.ptr);\n\n\tif (!error && opts->origin_url)\n\t\terror = repo_init_create_origin(*out, opts->origin_url);\n\ncleanup:\n\tgit_buf_free(&repo_path);\n\tgit_buf_free(&wd_path);\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&wd_path"
          ],
          "line": 1717
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_init_create_origin",
          "args": [
            "*out",
            "opts->origin_url"
          ],
          "line": 1713
        },
        "resolved": true,
        "details": {
          "function_name": "repo_init_create_origin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1641-1651",
          "snippet": "static int repo_init_create_origin(git_repository *repo, const char *url)\n{\n\tint error;\n\tgit_remote *remote;\n\n\tif (!(error = git_remote_create(&remote, repo, GIT_REMOTE_ORIGIN, url))) {\n\t\tgit_remote_free(remote);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_init_create_origin(git_repository *repo, const char *url)\n{\n\tint error;\n\tgit_remote *remote;\n\n\tif (!(error = git_remote_create(&remote, repo, GIT_REMOTE_ORIGIN, url))) {\n\t\tgit_remote_free(remote);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_open",
          "args": [
            "out",
            "repo_path.ptr"
          ],
          "line": 1710
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "557-561",
          "snippet": "int git_repository_open(git_repository **repo_out, const char *path)\n{\n\treturn git_repository_open_ext(\n\t\trepo_out, path, GIT_REPOSITORY_OPEN_NO_SEARCH, NULL);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_open(git_repository **repo_out, const char *path)\n{\n\treturn git_repository_open_ext(\n\t\trepo_out, path, GIT_REPOSITORY_OPEN_NO_SEARCH, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_init_create_head",
          "args": [
            "repo_path.ptr",
            "opts->initial_head"
          ],
          "line": 1704
        },
        "resolved": true,
        "details": {
          "function_name": "repo_init_create_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1008-1037",
          "snippet": "static int repo_init_create_head(const char *git_dir, const char *ref_name)\n{\n\tgit_buf ref_path = GIT_BUF_INIT;\n\tgit_filebuf ref = GIT_FILEBUF_INIT;\n\tconst char *fmt;\n\n\tif (git_buf_joinpath(&ref_path, git_dir, GIT_HEAD_FILE) < 0 ||\n\t\tgit_filebuf_open(&ref, ref_path.ptr, 0, GIT_REFS_FILE_MODE) < 0)\n\t\tgoto fail;\n\n\tif (!ref_name)\n\t\tref_name = GIT_BRANCH_MASTER;\n\n\tif (git__prefixcmp(ref_name, GIT_REFS_DIR) == 0)\n\t\tfmt = \"ref: %s\\n\";\n\telse\n\t\tfmt = \"ref: \" GIT_REFS_HEADS_DIR \"%s\\n\";\n\n\tif (git_filebuf_printf(&ref, fmt, ref_name) < 0 ||\n\t\tgit_filebuf_commit(&ref) < 0)\n\t\tgoto fail;\n\n\tgit_buf_free(&ref_path);\n\treturn 0;\n\nfail:\n\tgit_buf_free(&ref_path);\n\tgit_filebuf_cleanup(&ref);\n\treturn -1;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [
            "#define GIT_BRANCH_MASTER \"master\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_BRANCH_MASTER \"master\"\n\nstatic int repo_init_create_head(const char *git_dir, const char *ref_name)\n{\n\tgit_buf ref_path = GIT_BUF_INIT;\n\tgit_filebuf ref = GIT_FILEBUF_INIT;\n\tconst char *fmt;\n\n\tif (git_buf_joinpath(&ref_path, git_dir, GIT_HEAD_FILE) < 0 ||\n\t\tgit_filebuf_open(&ref, ref_path.ptr, 0, GIT_REFS_FILE_MODE) < 0)\n\t\tgoto fail;\n\n\tif (!ref_name)\n\t\tref_name = GIT_BRANCH_MASTER;\n\n\tif (git__prefixcmp(ref_name, GIT_REFS_DIR) == 0)\n\t\tfmt = \"ref: %s\\n\";\n\telse\n\t\tfmt = \"ref: \" GIT_REFS_HEADS_DIR \"%s\\n\";\n\n\tif (git_filebuf_printf(&ref, fmt, ref_name) < 0 ||\n\t\tgit_filebuf_commit(&ref) < 0)\n\t\tgoto fail;\n\n\tgit_buf_free(&ref_path);\n\treturn 0;\n\nfail:\n\tgit_buf_free(&ref_path);\n\tgit_filebuf_cleanup(&ref);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_init_config",
          "args": [
            "repo_path.ptr",
            "wd",
            "opts->flags",
            "opts->mode"
          ],
          "line": 1702
        },
        "resolved": true,
        "details": {
          "function_name": "repo_init_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1187-1249",
          "snippet": "static int repo_init_config(\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tuint32_t flags,\n\tuint32_t mode)\n{\n\tint error = 0;\n\tgit_buf cfg_path = GIT_BUF_INIT, worktree_path = GIT_BUF_INIT;\n\tgit_config *config = NULL;\n\tbool is_bare = ((flags & GIT_REPOSITORY_INIT_BARE) != 0);\n\tbool is_reinit = ((flags & GIT_REPOSITORY_INIT__IS_REINIT) != 0);\n\n\tif ((error = repo_local_config(&config, &cfg_path, NULL, repo_dir)) < 0)\n\t\tgoto cleanup;\n\n\tif (is_reinit && (error = check_repositoryformatversion(config)) < 0)\n\t\tgoto cleanup;\n\n#define SET_REPO_CONFIG(TYPE, NAME, VAL) do { \\\n\tif ((error = git_config_set_##TYPE(config, NAME, VAL)) < 0) \\\n\t\tgoto cleanup; } while (0)\n\n\tSET_REPO_CONFIG(bool, \"core.bare\", is_bare);\n\tSET_REPO_CONFIG(int32, \"core.repositoryformatversion\", GIT_REPO_VERSION);\n\n\tif ((error = repo_init_fs_configs(\n\t\t\tconfig, cfg_path.ptr, repo_dir, work_dir, !is_reinit)) < 0)\n\t\tgoto cleanup;\n\n\tif (!is_bare) {\n\t\tSET_REPO_CONFIG(bool, \"core.logallrefupdates\", true);\n\n\t\tif (!(flags & GIT_REPOSITORY_INIT__NATURAL_WD)) {\n\t\t\tif ((error = git_buf_sets(&worktree_path, work_dir)) < 0)\n\t\t\t\tgoto cleanup;\n\n\t\t\tif ((flags & GIT_REPOSITORY_INIT_RELATIVE_GITLINK))\n\t\t\t\tif ((error = git_path_make_relative(&worktree_path, repo_dir)) < 0)\n\t\t\t\t\tgoto cleanup;\n\n\t\t\tSET_REPO_CONFIG(string, \"core.worktree\", worktree_path.ptr);\n\t\t} else if (is_reinit) {\n\t\t\tif (git_config_delete_entry(config, \"core.worktree\") < 0)\n\t\t\t\tgiterr_clear();\n\t\t}\n\t}\n\n\tif (mode == GIT_REPOSITORY_INIT_SHARED_GROUP) {\n\t\tSET_REPO_CONFIG(int32, \"core.sharedrepository\", 1);\n\t\tSET_REPO_CONFIG(bool, \"receive.denyNonFastforwards\", true);\n\t}\n\telse if (mode == GIT_REPOSITORY_INIT_SHARED_ALL) {\n\t\tSET_REPO_CONFIG(int32, \"core.sharedrepository\", 2);\n\t\tSET_REPO_CONFIG(bool, \"receive.denyNonFastforwards\", true);\n\t}\n\ncleanup:\n\tgit_buf_free(&cfg_path);\n\tgit_buf_free(&worktree_path);\n\tgit_config_free(config);\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [
            "#define GIT_REPO_VERSION 0"
          ],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_REPO_VERSION 0\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int repo_init_config(\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tuint32_t flags,\n\tuint32_t mode)\n{\n\tint error = 0;\n\tgit_buf cfg_path = GIT_BUF_INIT, worktree_path = GIT_BUF_INIT;\n\tgit_config *config = NULL;\n\tbool is_bare = ((flags & GIT_REPOSITORY_INIT_BARE) != 0);\n\tbool is_reinit = ((flags & GIT_REPOSITORY_INIT__IS_REINIT) != 0);\n\n\tif ((error = repo_local_config(&config, &cfg_path, NULL, repo_dir)) < 0)\n\t\tgoto cleanup;\n\n\tif (is_reinit && (error = check_repositoryformatversion(config)) < 0)\n\t\tgoto cleanup;\n\n#define SET_REPO_CONFIG(TYPE, NAME, VAL) do { \\\n\tif ((error = git_config_set_##TYPE(config, NAME, VAL)) < 0) \\\n\t\tgoto cleanup; } while (0)\n\n\tSET_REPO_CONFIG(bool, \"core.bare\", is_bare);\n\tSET_REPO_CONFIG(int32, \"core.repositoryformatversion\", GIT_REPO_VERSION);\n\n\tif ((error = repo_init_fs_configs(\n\t\t\tconfig, cfg_path.ptr, repo_dir, work_dir, !is_reinit)) < 0)\n\t\tgoto cleanup;\n\n\tif (!is_bare) {\n\t\tSET_REPO_CONFIG(bool, \"core.logallrefupdates\", true);\n\n\t\tif (!(flags & GIT_REPOSITORY_INIT__NATURAL_WD)) {\n\t\t\tif ((error = git_buf_sets(&worktree_path, work_dir)) < 0)\n\t\t\t\tgoto cleanup;\n\n\t\t\tif ((flags & GIT_REPOSITORY_INIT_RELATIVE_GITLINK))\n\t\t\t\tif ((error = git_path_make_relative(&worktree_path, repo_dir)) < 0)\n\t\t\t\t\tgoto cleanup;\n\n\t\t\tSET_REPO_CONFIG(string, \"core.worktree\", worktree_path.ptr);\n\t\t} else if (is_reinit) {\n\t\t\tif (git_config_delete_entry(config, \"core.worktree\") < 0)\n\t\t\t\tgiterr_clear();\n\t\t}\n\t}\n\n\tif (mode == GIT_REPOSITORY_INIT_SHARED_GROUP) {\n\t\tSET_REPO_CONFIG(int32, \"core.sharedrepository\", 1);\n\t\tSET_REPO_CONFIG(bool, \"receive.denyNonFastforwards\", true);\n\t}\n\telse if (mode == GIT_REPOSITORY_INIT_SHARED_ALL) {\n\t\tSET_REPO_CONFIG(int32, \"core.sharedrepository\", 2);\n\t\tSET_REPO_CONFIG(bool, \"receive.denyNonFastforwards\", true);\n\t}\n\ncleanup:\n\tgit_buf_free(&cfg_path);\n\tgit_buf_free(&worktree_path);\n\tgit_config_free(config);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_init_structure",
          "args": [
            "repo_path.ptr",
            "wd",
            "opts"
          ],
          "line": 1700
        },
        "resolved": true,
        "details": {
          "function_name": "repo_init_structure",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1396-1496",
          "snippet": "static int repo_init_structure(\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tgit_repository_init_options *opts)\n{\n\tint error = 0;\n\trepo_template_item *tpl;\n\tbool external_tpl =\n\t\t((opts->flags & GIT_REPOSITORY_INIT_EXTERNAL_TEMPLATE) != 0);\n\tmode_t dmode = pick_dir_mode(opts);\n\tbool chmod = opts->mode != GIT_REPOSITORY_INIT_SHARED_UMASK;\n\n\t/* Hide the \".git\" directory */\n#ifdef GIT_WIN32\n\tif ((opts->flags & GIT_REPOSITORY_INIT__HAS_DOTGIT) != 0) {\n\t\tif (git_win32__set_hidden(repo_dir, true) < 0) {\n\t\t\tgiterr_set(GITERR_OS,\n\t\t\t\t\"Failed to mark Git repository folder as hidden\");\n\t\t\treturn -1;\n\t\t}\n\t}\n#endif\n\n\t/* Create the .git gitlink if appropriate */\n\tif ((opts->flags & GIT_REPOSITORY_INIT_BARE) == 0 &&\n\t\t(opts->flags & GIT_REPOSITORY_INIT__NATURAL_WD) == 0)\n\t{\n\t\tif (repo_write_gitlink(work_dir, repo_dir, opts->flags & GIT_REPOSITORY_INIT_RELATIVE_GITLINK) < 0)\n\t\t\treturn -1;\n\t}\n\n\t/* Copy external template if requested */\n\tif (external_tpl) {\n\t\tgit_config *cfg = NULL;\n\t\tconst char *tdir = NULL;\n\t\tbool default_template = false;\n\t\tgit_buf template_buf = GIT_BUF_INIT;\n\n\t\tif (opts->template_path)\n\t\t\ttdir = opts->template_path;\n\t\telse if ((error = git_config_open_default(&cfg)) >= 0) {\n\t\t\tif (!git_config_get_path(&template_buf, cfg, \"init.templatedir\"))\n\t\t\t\ttdir = template_buf.ptr;\n\t\t\tgiterr_clear();\n\t\t}\n\n\t\tif (!tdir) {\n\t\t\tif (!(error = git_sysdir_find_template_dir(&template_buf)))\n\t\t\t\ttdir = template_buf.ptr;\n\t\t\tdefault_template = true;\n\t\t}\n\n\t\tif (tdir) {\n\t\t\tuint32_t cpflags = GIT_CPDIR_COPY_SYMLINKS |\n\t\t\t\tGIT_CPDIR_SIMPLE_TO_MODE |\n\t\t\t\tGIT_CPDIR_COPY_DOTFILES;\n\t\t\tif (opts->mode != GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\t\t\t\tcpflags |= GIT_CPDIR_CHMOD_DIRS;\n\t\t\terror = git_futils_cp_r(tdir, repo_dir, cpflags, dmode);\n\t\t}\n\n\t\tgit_buf_free(&template_buf);\n\t\tgit_config_free(cfg);\n\n\t\tif (error < 0) {\n\t\t\tif (!default_template)\n\t\t\t\treturn error;\n\n\t\t\t/* if template was default, ignore error and use internal */\n\t\t\tgiterr_clear();\n\t\t\texternal_tpl = false;\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\t/* Copy internal template\n\t * - always ensure existence of dirs\n\t * - only create files if no external template was specified\n\t */\n\tfor (tpl = repo_template; !error && tpl->path; ++tpl) {\n\t\tif (!tpl->content) {\n\t\t\tuint32_t mkdir_flags = GIT_MKDIR_PATH;\n\t\t\tif (chmod)\n\t\t\t\tmkdir_flags |= GIT_MKDIR_CHMOD;\n\n\t\t\terror = git_futils_mkdir_relative(\n\t\t\t\ttpl->path, repo_dir, dmode, mkdir_flags, NULL);\n\t\t}\n\t\telse if (!external_tpl) {\n\t\t\tconst char *content = tpl->content;\n\n\t\t\tif (opts->description && strcmp(tpl->path, GIT_DESC_FILE) == 0)\n\t\t\t\tcontent = opts->description;\n\n\t\t\terror = repo_write_template(\n\t\t\t\trepo_dir, false, tpl->path, tpl->mode, false, content);\n\t\t}\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_init_structure(\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tgit_repository_init_options *opts)\n{\n\tint error = 0;\n\trepo_template_item *tpl;\n\tbool external_tpl =\n\t\t((opts->flags & GIT_REPOSITORY_INIT_EXTERNAL_TEMPLATE) != 0);\n\tmode_t dmode = pick_dir_mode(opts);\n\tbool chmod = opts->mode != GIT_REPOSITORY_INIT_SHARED_UMASK;\n\n\t/* Hide the \".git\" directory */\n#ifdef GIT_WIN32\n\tif ((opts->flags & GIT_REPOSITORY_INIT__HAS_DOTGIT) != 0) {\n\t\tif (git_win32__set_hidden(repo_dir, true) < 0) {\n\t\t\tgiterr_set(GITERR_OS,\n\t\t\t\t\"Failed to mark Git repository folder as hidden\");\n\t\t\treturn -1;\n\t\t}\n\t}\n#endif\n\n\t/* Create the .git gitlink if appropriate */\n\tif ((opts->flags & GIT_REPOSITORY_INIT_BARE) == 0 &&\n\t\t(opts->flags & GIT_REPOSITORY_INIT__NATURAL_WD) == 0)\n\t{\n\t\tif (repo_write_gitlink(work_dir, repo_dir, opts->flags & GIT_REPOSITORY_INIT_RELATIVE_GITLINK) < 0)\n\t\t\treturn -1;\n\t}\n\n\t/* Copy external template if requested */\n\tif (external_tpl) {\n\t\tgit_config *cfg = NULL;\n\t\tconst char *tdir = NULL;\n\t\tbool default_template = false;\n\t\tgit_buf template_buf = GIT_BUF_INIT;\n\n\t\tif (opts->template_path)\n\t\t\ttdir = opts->template_path;\n\t\telse if ((error = git_config_open_default(&cfg)) >= 0) {\n\t\t\tif (!git_config_get_path(&template_buf, cfg, \"init.templatedir\"))\n\t\t\t\ttdir = template_buf.ptr;\n\t\t\tgiterr_clear();\n\t\t}\n\n\t\tif (!tdir) {\n\t\t\tif (!(error = git_sysdir_find_template_dir(&template_buf)))\n\t\t\t\ttdir = template_buf.ptr;\n\t\t\tdefault_template = true;\n\t\t}\n\n\t\tif (tdir) {\n\t\t\tuint32_t cpflags = GIT_CPDIR_COPY_SYMLINKS |\n\t\t\t\tGIT_CPDIR_SIMPLE_TO_MODE |\n\t\t\t\tGIT_CPDIR_COPY_DOTFILES;\n\t\t\tif (opts->mode != GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\t\t\t\tcpflags |= GIT_CPDIR_CHMOD_DIRS;\n\t\t\terror = git_futils_cp_r(tdir, repo_dir, cpflags, dmode);\n\t\t}\n\n\t\tgit_buf_free(&template_buf);\n\t\tgit_config_free(cfg);\n\n\t\tif (error < 0) {\n\t\t\tif (!default_template)\n\t\t\t\treturn error;\n\n\t\t\t/* if template was default, ignore error and use internal */\n\t\t\tgiterr_clear();\n\t\t\texternal_tpl = false;\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\t/* Copy internal template\n\t * - always ensure existence of dirs\n\t * - only create files if no external template was specified\n\t */\n\tfor (tpl = repo_template; !error && tpl->path; ++tpl) {\n\t\tif (!tpl->content) {\n\t\t\tuint32_t mkdir_flags = GIT_MKDIR_PATH;\n\t\t\tif (chmod)\n\t\t\t\tmkdir_flags |= GIT_MKDIR_CHMOD;\n\n\t\t\terror = git_futils_mkdir_relative(\n\t\t\t\ttpl->path, repo_dir, dmode, mkdir_flags, NULL);\n\t\t}\n\t\telse if (!external_tpl) {\n\t\t\tconst char *content = tpl->content;\n\n\t\t\tif (opts->description && strcmp(tpl->path, GIT_DESC_FILE) == 0)\n\t\t\t\tcontent = opts->description;\n\n\t\t\terror = repo_write_template(\n\t\t\t\trepo_dir, false, tpl->path, tpl->mode, false, content);\n\t\t}\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"Attempt to reinitialize '%s'\"",
            "given_repo"
          ],
          "line": 1686
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "valid_repository_path",
          "args": [
            "&repo_path"
          ],
          "line": 1683
        },
        "resolved": true,
        "details": {
          "function_name": "valid_repository_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "155-169",
          "snippet": "static bool valid_repository_path(git_buf *repository_path)\n{\n\t/* Check OBJECTS_DIR first, since it will generate the longest path name */\n\tif (git_path_contains_dir(repository_path, GIT_OBJECTS_DIR) == false)\n\t\treturn false;\n\n\t/* Ensure HEAD file exists */\n\tif (git_path_contains_file(repository_path, GIT_HEAD_FILE) == false)\n\t\treturn false;\n\n\tif (git_path_contains_dir(repository_path, GIT_REFS_DIR)  == false)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool valid_repository_path(git_buf *repository_path)\n{\n\t/* Check OBJECTS_DIR first, since it will generate the longest path name */\n\tif (git_path_contains_dir(repository_path, GIT_OBJECTS_DIR) == false)\n\t\treturn false;\n\n\t/* Ensure HEAD file exists */\n\tif (git_path_contains_file(repository_path, GIT_HEAD_FILE) == false)\n\t\treturn false;\n\n\tif (git_path_contains_dir(repository_path, GIT_REFS_DIR)  == false)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&wd_path"
          ],
          "line": 1682
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_init_directories",
          "args": [
            "&repo_path",
            "&wd_path",
            "given_repo",
            "opts"
          ],
          "line": 1678
        },
        "resolved": true,
        "details": {
          "function_name": "repo_init_directories",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1509-1639",
          "snippet": "static int repo_init_directories(\n\tgit_buf *repo_path,\n\tgit_buf *wd_path,\n\tconst char *given_repo,\n\tgit_repository_init_options *opts)\n{\n\tint error = 0;\n\tbool is_bare, add_dotgit, has_dotgit, natural_wd;\n\tmode_t dirmode;\n\n\t/* There are three possible rules for what we are allowed to create:\n\t * - MKPATH means anything we need\n\t * - MKDIR means just the .git directory and its parent and the workdir\n\t * - Neither means only the .git directory can be created\n\t *\n\t * There are 5 \"segments\" of path that we might need to deal with:\n\t * 1. The .git directory\n\t * 2. The parent of the .git directory\n\t * 3. Everything above the parent of the .git directory\n\t * 4. The working directory (often the same as #2)\n\t * 5. Everything above the working directory (often the same as #3)\n\t *\n\t * For all directories created, we start with the init_mode value for\n\t * permissions and then strip off bits in some cases:\n\t *\n\t * For MKPATH, we create #3 (and #5) paths without S_ISGID or S_IWOTH\n\t * For MKPATH and MKDIR, we create #2 (and #4) without S_ISGID\n\t * For all rules, we create #1 using the untouched init_mode\n\t */\n\n\t/* set up repo path */\n\n\tis_bare = ((opts->flags & GIT_REPOSITORY_INIT_BARE) != 0);\n\n\tadd_dotgit =\n\t\t(opts->flags & GIT_REPOSITORY_INIT_NO_DOTGIT_DIR) == 0 &&\n\t\t!is_bare &&\n\t\tgit__suffixcmp(given_repo, \"/\" DOT_GIT) != 0 &&\n\t\tgit__suffixcmp(given_repo, \"/\" GIT_DIR) != 0;\n\n\tif (git_buf_joinpath(repo_path, given_repo, add_dotgit ? GIT_DIR : \"\") < 0)\n\t\treturn -1;\n\n\thas_dotgit = (git__suffixcmp(repo_path->ptr, \"/\" GIT_DIR) == 0);\n\tif (has_dotgit)\n\t\topts->flags |= GIT_REPOSITORY_INIT__HAS_DOTGIT;\n\n\t/* set up workdir path */\n\n\tif (!is_bare) {\n\t\tif (opts->workdir_path) {\n\t\t\tif (git_path_join_unrooted(\n\t\t\t\t\twd_path, opts->workdir_path, repo_path->ptr, NULL) < 0)\n\t\t\t\treturn -1;\n\t\t} else if (has_dotgit) {\n\t\t\tif (git_path_dirname_r(wd_path, repo_path->ptr) < 0)\n\t\t\t\treturn -1;\n\t\t} else {\n\t\t\tgiterr_set(GITERR_REPOSITORY, \"Cannot pick working directory\"\n\t\t\t\t\" for non-bare repository that isn't a '.git' directory\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (git_path_to_dir(wd_path) < 0)\n\t\t\treturn -1;\n\t} else {\n\t\tgit_buf_clear(wd_path);\n\t}\n\n\tnatural_wd =\n\t\thas_dotgit &&\n\t\twd_path->size > 0 &&\n\t\twd_path->size + strlen(GIT_DIR) == repo_path->size &&\n\t\tmemcmp(repo_path->ptr, wd_path->ptr, wd_path->size) == 0;\n\tif (natural_wd)\n\t\topts->flags |= GIT_REPOSITORY_INIT__NATURAL_WD;\n\n\t/* create directories as needed / requested */\n\n\tdirmode = pick_dir_mode(opts);\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0) {\n\t\t/* create path #5 */\n\t\tif (wd_path->size > 0 &&\n\t\t\t(error = mkdir_parent(wd_path, dirmode, false)) < 0)\n\t\t\treturn error;\n\n\t\t/* create path #3 (if not the same as #5) */\n\t\tif (!natural_wd &&\n\t\t\t(error = mkdir_parent(repo_path, dirmode, has_dotgit)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKDIR) != 0 ||\n\t\t(opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0)\n\t{\n\t\t/* create path #4 */\n\t\tif (wd_path->size > 0 &&\n\t\t\t(error = git_futils_mkdir(\n\t\t\t\twd_path->ptr, dirmode & ~S_ISGID,\n\t\t\t\tGIT_MKDIR_VERIFY_DIR)) < 0)\n\t\t\treturn error;\n\n\t\t/* create path #2 (if not the same as #4) */\n\t\tif (!natural_wd &&\n\t\t\t(error = git_futils_mkdir(\n\t\t\t\trepo_path->ptr, dirmode & ~S_ISGID,\n\t\t\t\tGIT_MKDIR_VERIFY_DIR | GIT_MKDIR_SKIP_LAST)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKDIR) != 0 ||\n\t\t(opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0 ||\n\t\thas_dotgit)\n\t{\n\t\t/* create path #1 */\n\t\terror = git_futils_mkdir(repo_path->ptr, dirmode,\n\t\t\tGIT_MKDIR_VERIFY_DIR | ((dirmode & S_ISGID) ? GIT_MKDIR_CHMOD : 0));\n\t}\n\n\t/* prettify both directories now that they are created */\n\n\tif (!error) {\n\t\terror = git_path_prettify_dir(repo_path, repo_path->ptr, NULL);\n\n\t\tif (!error && wd_path->size > 0)\n\t\t\terror = git_path_prettify_dir(wd_path, wd_path->ptr, NULL);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_init_directories(\n\tgit_buf *repo_path,\n\tgit_buf *wd_path,\n\tconst char *given_repo,\n\tgit_repository_init_options *opts)\n{\n\tint error = 0;\n\tbool is_bare, add_dotgit, has_dotgit, natural_wd;\n\tmode_t dirmode;\n\n\t/* There are three possible rules for what we are allowed to create:\n\t * - MKPATH means anything we need\n\t * - MKDIR means just the .git directory and its parent and the workdir\n\t * - Neither means only the .git directory can be created\n\t *\n\t * There are 5 \"segments\" of path that we might need to deal with:\n\t * 1. The .git directory\n\t * 2. The parent of the .git directory\n\t * 3. Everything above the parent of the .git directory\n\t * 4. The working directory (often the same as #2)\n\t * 5. Everything above the working directory (often the same as #3)\n\t *\n\t * For all directories created, we start with the init_mode value for\n\t * permissions and then strip off bits in some cases:\n\t *\n\t * For MKPATH, we create #3 (and #5) paths without S_ISGID or S_IWOTH\n\t * For MKPATH and MKDIR, we create #2 (and #4) without S_ISGID\n\t * For all rules, we create #1 using the untouched init_mode\n\t */\n\n\t/* set up repo path */\n\n\tis_bare = ((opts->flags & GIT_REPOSITORY_INIT_BARE) != 0);\n\n\tadd_dotgit =\n\t\t(opts->flags & GIT_REPOSITORY_INIT_NO_DOTGIT_DIR) == 0 &&\n\t\t!is_bare &&\n\t\tgit__suffixcmp(given_repo, \"/\" DOT_GIT) != 0 &&\n\t\tgit__suffixcmp(given_repo, \"/\" GIT_DIR) != 0;\n\n\tif (git_buf_joinpath(repo_path, given_repo, add_dotgit ? GIT_DIR : \"\") < 0)\n\t\treturn -1;\n\n\thas_dotgit = (git__suffixcmp(repo_path->ptr, \"/\" GIT_DIR) == 0);\n\tif (has_dotgit)\n\t\topts->flags |= GIT_REPOSITORY_INIT__HAS_DOTGIT;\n\n\t/* set up workdir path */\n\n\tif (!is_bare) {\n\t\tif (opts->workdir_path) {\n\t\t\tif (git_path_join_unrooted(\n\t\t\t\t\twd_path, opts->workdir_path, repo_path->ptr, NULL) < 0)\n\t\t\t\treturn -1;\n\t\t} else if (has_dotgit) {\n\t\t\tif (git_path_dirname_r(wd_path, repo_path->ptr) < 0)\n\t\t\t\treturn -1;\n\t\t} else {\n\t\t\tgiterr_set(GITERR_REPOSITORY, \"Cannot pick working directory\"\n\t\t\t\t\" for non-bare repository that isn't a '.git' directory\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (git_path_to_dir(wd_path) < 0)\n\t\t\treturn -1;\n\t} else {\n\t\tgit_buf_clear(wd_path);\n\t}\n\n\tnatural_wd =\n\t\thas_dotgit &&\n\t\twd_path->size > 0 &&\n\t\twd_path->size + strlen(GIT_DIR) == repo_path->size &&\n\t\tmemcmp(repo_path->ptr, wd_path->ptr, wd_path->size) == 0;\n\tif (natural_wd)\n\t\topts->flags |= GIT_REPOSITORY_INIT__NATURAL_WD;\n\n\t/* create directories as needed / requested */\n\n\tdirmode = pick_dir_mode(opts);\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0) {\n\t\t/* create path #5 */\n\t\tif (wd_path->size > 0 &&\n\t\t\t(error = mkdir_parent(wd_path, dirmode, false)) < 0)\n\t\t\treturn error;\n\n\t\t/* create path #3 (if not the same as #5) */\n\t\tif (!natural_wd &&\n\t\t\t(error = mkdir_parent(repo_path, dirmode, has_dotgit)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKDIR) != 0 ||\n\t\t(opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0)\n\t{\n\t\t/* create path #4 */\n\t\tif (wd_path->size > 0 &&\n\t\t\t(error = git_futils_mkdir(\n\t\t\t\twd_path->ptr, dirmode & ~S_ISGID,\n\t\t\t\tGIT_MKDIR_VERIFY_DIR)) < 0)\n\t\t\treturn error;\n\n\t\t/* create path #2 (if not the same as #4) */\n\t\tif (!natural_wd &&\n\t\t\t(error = git_futils_mkdir(\n\t\t\t\trepo_path->ptr, dirmode & ~S_ISGID,\n\t\t\t\tGIT_MKDIR_VERIFY_DIR | GIT_MKDIR_SKIP_LAST)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKDIR) != 0 ||\n\t\t(opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0 ||\n\t\thas_dotgit)\n\t{\n\t\t/* create path #1 */\n\t\terror = git_futils_mkdir(repo_path->ptr, dirmode,\n\t\t\tGIT_MKDIR_VERIFY_DIR | ((dirmode & S_ISGID) ? GIT_MKDIR_CHMOD : 0));\n\t}\n\n\t/* prettify both directories now that they are created */\n\n\tif (!error) {\n\t\terror = git_path_prettify_dir(repo_path, repo_path->ptr, NULL);\n\n\t\tif (!error && wd_path->size > 0)\n\t\t\terror = git_path_prettify_dir(wd_path, wd_path->ptr, NULL);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_VERSION",
          "args": [
            "opts",
            "GIT_REPOSITORY_INIT_OPTIONS_VERSION",
            "\"git_repository_init_options\""
          ],
          "line": 1676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && given_repo && opts"
          ],
          "line": 1674
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_init_ext(\n\tgit_repository **out,\n\tconst char *given_repo,\n\tgit_repository_init_options *opts)\n{\n\tint error;\n\tgit_buf repo_path = GIT_BUF_INIT, wd_path = GIT_BUF_INIT;\n\tconst char *wd;\n\n\tassert(out && given_repo && opts);\n\n\tGITERR_CHECK_VERSION(opts, GIT_REPOSITORY_INIT_OPTIONS_VERSION, \"git_repository_init_options\");\n\n\terror = repo_init_directories(&repo_path, &wd_path, given_repo, opts);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\twd = (opts->flags & GIT_REPOSITORY_INIT_BARE) ? NULL : git_buf_cstr(&wd_path);\n\tif (valid_repository_path(&repo_path)) {\n\n\t\tif ((opts->flags & GIT_REPOSITORY_INIT_NO_REINIT) != 0) {\n\t\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\t\"Attempt to reinitialize '%s'\", given_repo);\n\t\t\terror = GIT_EEXISTS;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\topts->flags |= GIT_REPOSITORY_INIT__IS_REINIT;\n\n\t\terror = repo_init_config(\n\t\t\trepo_path.ptr, wd, opts->flags, opts->mode);\n\n\t\t/* TODO: reinitialize the templates */\n\t}\n\telse {\n\t\tif (!(error = repo_init_structure(\n\t\t\t\trepo_path.ptr, wd, opts)) &&\n\t\t\t!(error = repo_init_config(\n\t\t\t\trepo_path.ptr, wd, opts->flags, opts->mode)))\n\t\t\terror = repo_init_create_head(\n\t\t\t\trepo_path.ptr, opts->initial_head);\n\t}\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_repository_open(out, repo_path.ptr);\n\n\tif (!error && opts->origin_url)\n\t\terror = repo_init_create_origin(*out, opts->origin_url);\n\ncleanup:\n\tgit_buf_free(&repo_path);\n\tgit_buf_free(&wd_path);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1653-1663",
    "snippet": "int git_repository_init(\n\tgit_repository **repo_out, const char *path, unsigned is_bare)\n{\n\tgit_repository_init_options opts = GIT_REPOSITORY_INIT_OPTIONS_INIT;\n\n\topts.flags = GIT_REPOSITORY_INIT_MKPATH; /* don't love this default */\n\tif (is_bare)\n\t\topts.flags |= GIT_REPOSITORY_INIT_BARE;\n\n\treturn git_repository_init_ext(repo_out, path, &opts);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_repository_init_ext",
          "args": [
            "repo_out",
            "path",
            "&opts"
          ],
          "line": 1662
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_init_ext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1665-1720",
          "snippet": "int git_repository_init_ext(\n\tgit_repository **out,\n\tconst char *given_repo,\n\tgit_repository_init_options *opts)\n{\n\tint error;\n\tgit_buf repo_path = GIT_BUF_INIT, wd_path = GIT_BUF_INIT;\n\tconst char *wd;\n\n\tassert(out && given_repo && opts);\n\n\tGITERR_CHECK_VERSION(opts, GIT_REPOSITORY_INIT_OPTIONS_VERSION, \"git_repository_init_options\");\n\n\terror = repo_init_directories(&repo_path, &wd_path, given_repo, opts);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\twd = (opts->flags & GIT_REPOSITORY_INIT_BARE) ? NULL : git_buf_cstr(&wd_path);\n\tif (valid_repository_path(&repo_path)) {\n\n\t\tif ((opts->flags & GIT_REPOSITORY_INIT_NO_REINIT) != 0) {\n\t\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\t\"Attempt to reinitialize '%s'\", given_repo);\n\t\t\terror = GIT_EEXISTS;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\topts->flags |= GIT_REPOSITORY_INIT__IS_REINIT;\n\n\t\terror = repo_init_config(\n\t\t\trepo_path.ptr, wd, opts->flags, opts->mode);\n\n\t\t/* TODO: reinitialize the templates */\n\t}\n\telse {\n\t\tif (!(error = repo_init_structure(\n\t\t\t\trepo_path.ptr, wd, opts)) &&\n\t\t\t!(error = repo_init_config(\n\t\t\t\trepo_path.ptr, wd, opts->flags, opts->mode)))\n\t\t\terror = repo_init_create_head(\n\t\t\t\trepo_path.ptr, opts->initial_head);\n\t}\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_repository_open(out, repo_path.ptr);\n\n\tif (!error && opts->origin_url)\n\t\terror = repo_init_create_origin(*out, opts->origin_url);\n\ncleanup:\n\tgit_buf_free(&repo_path);\n\tgit_buf_free(&wd_path);\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_init_ext(\n\tgit_repository **out,\n\tconst char *given_repo,\n\tgit_repository_init_options *opts)\n{\n\tint error;\n\tgit_buf repo_path = GIT_BUF_INIT, wd_path = GIT_BUF_INIT;\n\tconst char *wd;\n\n\tassert(out && given_repo && opts);\n\n\tGITERR_CHECK_VERSION(opts, GIT_REPOSITORY_INIT_OPTIONS_VERSION, \"git_repository_init_options\");\n\n\terror = repo_init_directories(&repo_path, &wd_path, given_repo, opts);\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\twd = (opts->flags & GIT_REPOSITORY_INIT_BARE) ? NULL : git_buf_cstr(&wd_path);\n\tif (valid_repository_path(&repo_path)) {\n\n\t\tif ((opts->flags & GIT_REPOSITORY_INIT_NO_REINIT) != 0) {\n\t\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\t\"Attempt to reinitialize '%s'\", given_repo);\n\t\t\terror = GIT_EEXISTS;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\topts->flags |= GIT_REPOSITORY_INIT__IS_REINIT;\n\n\t\terror = repo_init_config(\n\t\t\trepo_path.ptr, wd, opts->flags, opts->mode);\n\n\t\t/* TODO: reinitialize the templates */\n\t}\n\telse {\n\t\tif (!(error = repo_init_structure(\n\t\t\t\trepo_path.ptr, wd, opts)) &&\n\t\t\t!(error = repo_init_config(\n\t\t\t\trepo_path.ptr, wd, opts->flags, opts->mode)))\n\t\t\terror = repo_init_create_head(\n\t\t\t\trepo_path.ptr, opts->initial_head);\n\t}\n\tif (error < 0)\n\t\tgoto cleanup;\n\n\terror = git_repository_open(out, repo_path.ptr);\n\n\tif (!error && opts->origin_url)\n\t\terror = repo_init_create_origin(*out, opts->origin_url);\n\ncleanup:\n\tgit_buf_free(&repo_path);\n\tgit_buf_free(&wd_path);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_init(\n\tgit_repository **repo_out, const char *path, unsigned is_bare)\n{\n\tgit_repository_init_options opts = GIT_REPOSITORY_INIT_OPTIONS_INIT;\n\n\topts.flags = GIT_REPOSITORY_INIT_MKPATH; /* don't love this default */\n\tif (is_bare)\n\t\topts.flags |= GIT_REPOSITORY_INIT_BARE;\n\n\treturn git_repository_init_ext(repo_out, path, &opts);\n}"
  },
  {
    "function_name": "repo_init_create_origin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1641-1651",
    "snippet": "static int repo_init_create_origin(git_repository *repo, const char *url)\n{\n\tint error;\n\tgit_remote *remote;\n\n\tif (!(error = git_remote_create(&remote, repo, GIT_REMOTE_ORIGIN, url))) {\n\t\tgit_remote_free(remote);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_remote_free",
          "args": [
            "remote"
          ],
          "line": 1647
        },
        "resolved": true,
        "details": {
          "function_name": "git_remote_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/remote.c",
          "lines": "1642-1670",
          "snippet": "void git_remote_free(git_remote *remote)\n{\n\tif (remote == NULL)\n\t\treturn;\n\n\tif (remote->transport != NULL) {\n\t\tgit_remote_disconnect(remote);\n\n\t\tremote->transport->free(remote->transport);\n\t\tremote->transport = NULL;\n\t}\n\n\tgit_vector_free(&remote->refs);\n\n\tfree_refspecs(&remote->refspecs);\n\tgit_vector_free(&remote->refspecs);\n\n\tfree_refspecs(&remote->active_refspecs);\n\tgit_vector_free(&remote->active_refspecs);\n\n\tfree_refspecs(&remote->passive_refspecs);\n\tgit_vector_free(&remote->passive_refspecs);\n\n\tgit_push_free(remote->push);\n\tgit__free(remote->url);\n\tgit__free(remote->pushurl);\n\tgit__free(remote->name);\n\tgit__free(remote);\n}",
          "includes": [
            "#include \"push.h\"",
            "#include \"fetchhead.h\"",
            "#include \"refspec.h\"",
            "#include \"refs.h\"",
            "#include \"fetch.h\"",
            "#include \"remote.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"common.h\"",
            "#include \"git2/net.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/types.h\"",
            "#include \"git2/config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int dwim_refspecs(git_vector *out, git_vector *refspecs, git_vector *refs);",
            "static int lookup_remote_prune_config(git_remote *remote, git_config *config, const char *name);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"push.h\"\n#include \"fetchhead.h\"\n#include \"refspec.h\"\n#include \"refs.h\"\n#include \"fetch.h\"\n#include \"remote.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"common.h\"\n#include \"git2/net.h\"\n#include \"git2/oid.h\"\n#include \"git2/types.h\"\n#include \"git2/config.h\"\n\nstatic int dwim_refspecs(git_vector *out, git_vector *refspecs, git_vector *refs);\nstatic int lookup_remote_prune_config(git_remote *remote, git_config *config, const char *name);\n\nvoid git_remote_free(git_remote *remote)\n{\n\tif (remote == NULL)\n\t\treturn;\n\n\tif (remote->transport != NULL) {\n\t\tgit_remote_disconnect(remote);\n\n\t\tremote->transport->free(remote->transport);\n\t\tremote->transport = NULL;\n\t}\n\n\tgit_vector_free(&remote->refs);\n\n\tfree_refspecs(&remote->refspecs);\n\tgit_vector_free(&remote->refspecs);\n\n\tfree_refspecs(&remote->active_refspecs);\n\tgit_vector_free(&remote->active_refspecs);\n\n\tfree_refspecs(&remote->passive_refspecs);\n\tgit_vector_free(&remote->passive_refspecs);\n\n\tgit_push_free(remote->push);\n\tgit__free(remote->url);\n\tgit__free(remote->pushurl);\n\tgit__free(remote->name);\n\tgit__free(remote);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_remote_create",
          "args": [
            "&remote",
            "repo",
            "GIT_REMOTE_ORIGIN",
            "url"
          ],
          "line": 1646
        },
        "resolved": true,
        "details": {
          "function_name": "git_remote_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/remote.c",
          "lines": "292-304",
          "snippet": "int git_remote_create(git_remote **out, git_repository *repo, const char *name, const char *url)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\n\tif (git_buf_printf(&buf, \"+refs/heads/*:refs/remotes/%s/*\", name) < 0)\n\t\treturn -1;\n\n\terror = git_remote_create_with_fetchspec(out, repo, name, url, git_buf_cstr(&buf));\n\tgit_buf_free(&buf);\n\n\treturn error;\n}",
          "includes": [
            "#include \"push.h\"",
            "#include \"fetchhead.h\"",
            "#include \"refspec.h\"",
            "#include \"refs.h\"",
            "#include \"fetch.h\"",
            "#include \"remote.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"common.h\"",
            "#include \"git2/net.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/types.h\"",
            "#include \"git2/config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int dwim_refspecs(git_vector *out, git_vector *refspecs, git_vector *refs);",
            "static int lookup_remote_prune_config(git_remote *remote, git_config *config, const char *name);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"push.h\"\n#include \"fetchhead.h\"\n#include \"refspec.h\"\n#include \"refs.h\"\n#include \"fetch.h\"\n#include \"remote.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"common.h\"\n#include \"git2/net.h\"\n#include \"git2/oid.h\"\n#include \"git2/types.h\"\n#include \"git2/config.h\"\n\nstatic int dwim_refspecs(git_vector *out, git_vector *refspecs, git_vector *refs);\nstatic int lookup_remote_prune_config(git_remote *remote, git_config *config, const char *name);\n\nint git_remote_create(git_remote **out, git_repository *repo, const char *name, const char *url)\n{\n\tgit_buf buf = GIT_BUF_INIT;\n\tint error;\n\n\tif (git_buf_printf(&buf, \"+refs/heads/*:refs/remotes/%s/*\", name) < 0)\n\t\treturn -1;\n\n\terror = git_remote_create_with_fetchspec(out, repo, name, url, git_buf_cstr(&buf));\n\tgit_buf_free(&buf);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_init_create_origin(git_repository *repo, const char *url)\n{\n\tint error;\n\tgit_remote *remote;\n\n\tif (!(error = git_remote_create(&remote, repo, GIT_REMOTE_ORIGIN, url))) {\n\t\tgit_remote_free(remote);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "repo_init_directories",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1509-1639",
    "snippet": "static int repo_init_directories(\n\tgit_buf *repo_path,\n\tgit_buf *wd_path,\n\tconst char *given_repo,\n\tgit_repository_init_options *opts)\n{\n\tint error = 0;\n\tbool is_bare, add_dotgit, has_dotgit, natural_wd;\n\tmode_t dirmode;\n\n\t/* There are three possible rules for what we are allowed to create:\n\t * - MKPATH means anything we need\n\t * - MKDIR means just the .git directory and its parent and the workdir\n\t * - Neither means only the .git directory can be created\n\t *\n\t * There are 5 \"segments\" of path that we might need to deal with:\n\t * 1. The .git directory\n\t * 2. The parent of the .git directory\n\t * 3. Everything above the parent of the .git directory\n\t * 4. The working directory (often the same as #2)\n\t * 5. Everything above the working directory (often the same as #3)\n\t *\n\t * For all directories created, we start with the init_mode value for\n\t * permissions and then strip off bits in some cases:\n\t *\n\t * For MKPATH, we create #3 (and #5) paths without S_ISGID or S_IWOTH\n\t * For MKPATH and MKDIR, we create #2 (and #4) without S_ISGID\n\t * For all rules, we create #1 using the untouched init_mode\n\t */\n\n\t/* set up repo path */\n\n\tis_bare = ((opts->flags & GIT_REPOSITORY_INIT_BARE) != 0);\n\n\tadd_dotgit =\n\t\t(opts->flags & GIT_REPOSITORY_INIT_NO_DOTGIT_DIR) == 0 &&\n\t\t!is_bare &&\n\t\tgit__suffixcmp(given_repo, \"/\" DOT_GIT) != 0 &&\n\t\tgit__suffixcmp(given_repo, \"/\" GIT_DIR) != 0;\n\n\tif (git_buf_joinpath(repo_path, given_repo, add_dotgit ? GIT_DIR : \"\") < 0)\n\t\treturn -1;\n\n\thas_dotgit = (git__suffixcmp(repo_path->ptr, \"/\" GIT_DIR) == 0);\n\tif (has_dotgit)\n\t\topts->flags |= GIT_REPOSITORY_INIT__HAS_DOTGIT;\n\n\t/* set up workdir path */\n\n\tif (!is_bare) {\n\t\tif (opts->workdir_path) {\n\t\t\tif (git_path_join_unrooted(\n\t\t\t\t\twd_path, opts->workdir_path, repo_path->ptr, NULL) < 0)\n\t\t\t\treturn -1;\n\t\t} else if (has_dotgit) {\n\t\t\tif (git_path_dirname_r(wd_path, repo_path->ptr) < 0)\n\t\t\t\treturn -1;\n\t\t} else {\n\t\t\tgiterr_set(GITERR_REPOSITORY, \"Cannot pick working directory\"\n\t\t\t\t\" for non-bare repository that isn't a '.git' directory\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (git_path_to_dir(wd_path) < 0)\n\t\t\treturn -1;\n\t} else {\n\t\tgit_buf_clear(wd_path);\n\t}\n\n\tnatural_wd =\n\t\thas_dotgit &&\n\t\twd_path->size > 0 &&\n\t\twd_path->size + strlen(GIT_DIR) == repo_path->size &&\n\t\tmemcmp(repo_path->ptr, wd_path->ptr, wd_path->size) == 0;\n\tif (natural_wd)\n\t\topts->flags |= GIT_REPOSITORY_INIT__NATURAL_WD;\n\n\t/* create directories as needed / requested */\n\n\tdirmode = pick_dir_mode(opts);\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0) {\n\t\t/* create path #5 */\n\t\tif (wd_path->size > 0 &&\n\t\t\t(error = mkdir_parent(wd_path, dirmode, false)) < 0)\n\t\t\treturn error;\n\n\t\t/* create path #3 (if not the same as #5) */\n\t\tif (!natural_wd &&\n\t\t\t(error = mkdir_parent(repo_path, dirmode, has_dotgit)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKDIR) != 0 ||\n\t\t(opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0)\n\t{\n\t\t/* create path #4 */\n\t\tif (wd_path->size > 0 &&\n\t\t\t(error = git_futils_mkdir(\n\t\t\t\twd_path->ptr, dirmode & ~S_ISGID,\n\t\t\t\tGIT_MKDIR_VERIFY_DIR)) < 0)\n\t\t\treturn error;\n\n\t\t/* create path #2 (if not the same as #4) */\n\t\tif (!natural_wd &&\n\t\t\t(error = git_futils_mkdir(\n\t\t\t\trepo_path->ptr, dirmode & ~S_ISGID,\n\t\t\t\tGIT_MKDIR_VERIFY_DIR | GIT_MKDIR_SKIP_LAST)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKDIR) != 0 ||\n\t\t(opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0 ||\n\t\thas_dotgit)\n\t{\n\t\t/* create path #1 */\n\t\terror = git_futils_mkdir(repo_path->ptr, dirmode,\n\t\t\tGIT_MKDIR_VERIFY_DIR | ((dirmode & S_ISGID) ? GIT_MKDIR_CHMOD : 0));\n\t}\n\n\t/* prettify both directories now that they are created */\n\n\tif (!error) {\n\t\terror = git_path_prettify_dir(repo_path, repo_path->ptr, NULL);\n\n\t\tif (!error && wd_path->size > 0)\n\t\t\terror = git_path_prettify_dir(wd_path, wd_path->ptr, NULL);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_path_prettify_dir",
          "args": [
            "wd_path",
            "wd_path->ptr",
            "NULL"
          ],
          "line": 1635
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_prettify_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "335-339",
          "snippet": "int git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_mkdir",
          "args": [
            "repo_path->ptr",
            "dirmode",
            "GIT_MKDIR_VERIFY_DIR | ((dirmode & S_ISGID) ? GIT_MKDIR_CHMOD : 0)"
          ],
          "line": 1625
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_mkdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "408-491",
          "snippet": "int git_futils_mkdir(\n\tconst char *path,\n\tmode_t mode,\n\tuint32_t flags)\n{\n\tgit_buf make_path = GIT_BUF_INIT, parent_path = GIT_BUF_INIT;\n\tconst char *relative;\n\tstruct git_futils_mkdir_options opts = { 0 };\n\tstruct stat st;\n\tsize_t depth = 0;\n\tint len = 0, root_len, error;\n\n\tif ((error = git_buf_puts(&make_path, path)) < 0 ||\n\t\t(error = mkdir_canonicalize(&make_path, flags)) < 0 ||\n\t\t(error = git_buf_puts(&parent_path, make_path.ptr)) < 0 ||\n\t\tmake_path.size == 0)\n\t\tgoto done;\n\n\troot_len = git_path_root(make_path.ptr);\n\n\t/* find the first parent directory that exists.  this will be used\n\t * as the base to dirname_relative.\n\t */\n\tfor (relative = make_path.ptr; parent_path.size; ) {\n\t\terror = p_lstat(parent_path.ptr, &st);\n\n\t\tif (error == 0) {\n\t\t\tbreak;\n\t\t} else if (errno != ENOENT) {\n\t\t\tgiterr_set(GITERR_OS, \"failed to stat '%s'\", parent_path.ptr);\n\t\t\tgoto done;\n\t\t}\n\n\t\tdepth++;\n\n\t\t/* examine the parent of the current path */\n\t\tif ((len = git_path_dirname_r(&parent_path, parent_path.ptr)) < 0) {\n\t\t\terror = len;\n\t\t\tgoto done;\n\t\t}\n\n\t\tassert(len);\n\n\t\t/* we've walked all the given path's parents and it's either relative\n\t\t * or rooted.  either way, give up and make the entire path.\n\t\t */\n\t\tif ((len == 1 && parent_path.ptr[0] == '.') || len == root_len+1) {\n\t\t\trelative = make_path.ptr;\n\t\t\tbreak;\n\t\t}\n\n\t\trelative = make_path.ptr + len + 1;\n\n\t\t/* not recursive? just make this directory relative to its parent. */\n\t\tif ((flags & GIT_MKDIR_PATH) == 0)\n\t\t\tbreak;\n\t}\n\n\t/* we found an item at the location we're trying to create,\n\t * validate it.\n\t */\n\tif (depth == 0) {\n\t\terror = mkdir_validate_dir(make_path.ptr, &st, mode, flags, &opts);\n\n\t\tif (!error)\n\t\t\terror = mkdir_validate_mode(\n\t\t\t\tmake_path.ptr, &st, true, mode, flags, &opts);\n\n\t\tgoto done;\n\t}\n\n\t/* we already took `SKIP_LAST` and `SKIP_LAST2` into account when\n\t * canonicalizing `make_path`.\n\t */\n\tflags &= ~(GIT_MKDIR_SKIP_LAST2 | GIT_MKDIR_SKIP_LAST);\n\n\terror = git_futils_mkdir_relative(relative,\n\t\tparent_path.size ? parent_path.ptr : NULL, mode, flags, &opts);\n\ndone:\n\tgit_buf_free(&make_path);\n\tgit_buf_free(&parent_path);\n\treturn error;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_mkdir(\n\tconst char *path,\n\tmode_t mode,\n\tuint32_t flags)\n{\n\tgit_buf make_path = GIT_BUF_INIT, parent_path = GIT_BUF_INIT;\n\tconst char *relative;\n\tstruct git_futils_mkdir_options opts = { 0 };\n\tstruct stat st;\n\tsize_t depth = 0;\n\tint len = 0, root_len, error;\n\n\tif ((error = git_buf_puts(&make_path, path)) < 0 ||\n\t\t(error = mkdir_canonicalize(&make_path, flags)) < 0 ||\n\t\t(error = git_buf_puts(&parent_path, make_path.ptr)) < 0 ||\n\t\tmake_path.size == 0)\n\t\tgoto done;\n\n\troot_len = git_path_root(make_path.ptr);\n\n\t/* find the first parent directory that exists.  this will be used\n\t * as the base to dirname_relative.\n\t */\n\tfor (relative = make_path.ptr; parent_path.size; ) {\n\t\terror = p_lstat(parent_path.ptr, &st);\n\n\t\tif (error == 0) {\n\t\t\tbreak;\n\t\t} else if (errno != ENOENT) {\n\t\t\tgiterr_set(GITERR_OS, \"failed to stat '%s'\", parent_path.ptr);\n\t\t\tgoto done;\n\t\t}\n\n\t\tdepth++;\n\n\t\t/* examine the parent of the current path */\n\t\tif ((len = git_path_dirname_r(&parent_path, parent_path.ptr)) < 0) {\n\t\t\terror = len;\n\t\t\tgoto done;\n\t\t}\n\n\t\tassert(len);\n\n\t\t/* we've walked all the given path's parents and it's either relative\n\t\t * or rooted.  either way, give up and make the entire path.\n\t\t */\n\t\tif ((len == 1 && parent_path.ptr[0] == '.') || len == root_len+1) {\n\t\t\trelative = make_path.ptr;\n\t\t\tbreak;\n\t\t}\n\n\t\trelative = make_path.ptr + len + 1;\n\n\t\t/* not recursive? just make this directory relative to its parent. */\n\t\tif ((flags & GIT_MKDIR_PATH) == 0)\n\t\t\tbreak;\n\t}\n\n\t/* we found an item at the location we're trying to create,\n\t * validate it.\n\t */\n\tif (depth == 0) {\n\t\terror = mkdir_validate_dir(make_path.ptr, &st, mode, flags, &opts);\n\n\t\tif (!error)\n\t\t\terror = mkdir_validate_mode(\n\t\t\t\tmake_path.ptr, &st, true, mode, flags, &opts);\n\n\t\tgoto done;\n\t}\n\n\t/* we already took `SKIP_LAST` and `SKIP_LAST2` into account when\n\t * canonicalizing `make_path`.\n\t */\n\tflags &= ~(GIT_MKDIR_SKIP_LAST2 | GIT_MKDIR_SKIP_LAST);\n\n\terror = git_futils_mkdir_relative(relative,\n\t\tparent_path.size ? parent_path.ptr : NULL, mode, flags, &opts);\n\ndone:\n\tgit_buf_free(&make_path);\n\tgit_buf_free(&parent_path);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mkdir_parent",
          "args": [
            "repo_path",
            "dirmode",
            "has_dotgit"
          ],
          "line": 1598
        },
        "resolved": true,
        "details": {
          "function_name": "mkdir_parent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1498-1507",
          "snippet": "static int mkdir_parent(git_buf *buf, uint32_t mode, bool skip2)\n{\n\t/* When making parent directories during repository initialization\n\t * don't try to set gid or grant world write access\n\t */\n\treturn git_futils_mkdir(\n\t\tbuf->ptr, mode & ~(S_ISGID | 0002),\n\t\tGIT_MKDIR_PATH | GIT_MKDIR_VERIFY_DIR |\n\t\t(skip2 ? GIT_MKDIR_SKIP_LAST2 : GIT_MKDIR_SKIP_LAST));\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int mkdir_parent(git_buf *buf, uint32_t mode, bool skip2)\n{\n\t/* When making parent directories during repository initialization\n\t * don't try to set gid or grant world write access\n\t */\n\treturn git_futils_mkdir(\n\t\tbuf->ptr, mode & ~(S_ISGID | 0002),\n\t\tGIT_MKDIR_PATH | GIT_MKDIR_VERIFY_DIR |\n\t\t(skip2 ? GIT_MKDIR_SKIP_LAST2 : GIT_MKDIR_SKIP_LAST));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pick_dir_mode",
          "args": [
            "opts"
          ],
          "line": 1588
        },
        "resolved": true,
        "details": {
          "function_name": "pick_dir_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1383-1392",
          "snippet": "static mode_t pick_dir_mode(git_repository_init_options *opts)\n{\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\treturn 0777;\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_GROUP)\n\t\treturn (0775 | S_ISGID);\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_ALL)\n\t\treturn (0777 | S_ISGID);\n\treturn opts->mode;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic mode_t pick_dir_mode(git_repository_init_options *opts)\n{\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\treturn 0777;\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_GROUP)\n\t\treturn (0775 | S_ISGID);\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_ALL)\n\t\treturn (0777 | S_ISGID);\n\treturn opts->mode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "repo_path->ptr",
            "wd_path->ptr",
            "wd_path->size"
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "GIT_DIR"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "wd_path"
          ],
          "line": 1575
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_to_dir",
          "args": [
            "wd_path"
          ],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_to_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "341-349",
          "snippet": "int git_path_to_dir(git_buf *path)\n{\n\tif (path->asize > 0 &&\n\t\tgit_buf_len(path) > 0 &&\n\t\tpath->ptr[git_buf_len(path) - 1] != '/')\n\t\tgit_buf_putc(path, '/');\n\n\treturn git_buf_oom(path) ? -1 : 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_to_dir(git_buf *path)\n{\n\tif (path->asize > 0 &&\n\t\tgit_buf_len(path) > 0 &&\n\t\tpath->ptr[git_buf_len(path) - 1] != '/')\n\t\tgit_buf_putc(path, '/');\n\n\treturn git_buf_oom(path) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"Cannot pick working directory\"\n\t\t\t\t\" for non-bare repository that isn't a '.git' directory\""
          ],
          "line": 1567
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_dirname_r",
          "args": [
            "wd_path",
            "repo_path->ptr"
          ],
          "line": 1564
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_dirname_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "117-178",
          "snippet": "int git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_join_unrooted",
          "args": [
            "wd_path",
            "opts->workdir_path",
            "repo_path->ptr",
            "NULL"
          ],
          "line": 1560
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_join_unrooted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "279-307",
          "snippet": "int git_path_join_unrooted(\n\tgit_buf *path_out, const char *path, const char *base, ssize_t *root_at)\n{\n\tssize_t root;\n\n\tassert(path && path_out);\n\n\troot = (ssize_t)git_path_root(path);\n\n\tif (base != NULL && root < 0) {\n\t\tif (git_buf_joinpath(path_out, base, path) < 0)\n\t\t\treturn -1;\n\n\t\troot = (ssize_t)strlen(base);\n\t} else {\n\t\tif (git_buf_sets(path_out, path) < 0)\n\t\t\treturn -1;\n\n\t\tif (root < 0)\n\t\t\troot = 0;\n\t\telse if (base)\n\t\t\tgit_path_equal_or_prefixed(base, path, &root);\n\t}\n\n\tif (root_at)\n\t\t*root_at = root;\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_join_unrooted(\n\tgit_buf *path_out, const char *path, const char *base, ssize_t *root_at)\n{\n\tssize_t root;\n\n\tassert(path && path_out);\n\n\troot = (ssize_t)git_path_root(path);\n\n\tif (base != NULL && root < 0) {\n\t\tif (git_buf_joinpath(path_out, base, path) < 0)\n\t\t\treturn -1;\n\n\t\troot = (ssize_t)strlen(base);\n\t} else {\n\t\tif (git_buf_sets(path_out, path) < 0)\n\t\t\treturn -1;\n\n\t\tif (root < 0)\n\t\t\troot = 0;\n\t\telse if (base)\n\t\t\tgit_path_equal_or_prefixed(base, path, &root);\n\t}\n\n\tif (root_at)\n\t\t*root_at = root;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__suffixcmp",
          "args": [
            "repo_path->ptr",
            "\"/\" GIT_DIR"
          ],
          "line": 1552
        },
        "resolved": true,
        "details": {
          "function_name": "git__suffixcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "272-279",
          "snippet": "int git__suffixcmp(const char *str, const char *suffix)\n{\n\tsize_t a = strlen(str);\n\tsize_t b = strlen(suffix);\n\tif (a < b)\n\t\treturn -1;\n\treturn strcmp(str + (a - b), suffix);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__suffixcmp(const char *str, const char *suffix)\n{\n\tsize_t a = strlen(str);\n\tsize_t b = strlen(suffix);\n\tif (a < b)\n\t\treturn -1;\n\treturn strcmp(str + (a - b), suffix);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "repo_path",
            "given_repo",
            "add_dotgit ? GIT_DIR : \"\""
          ],
          "line": 1549
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_init_directories(\n\tgit_buf *repo_path,\n\tgit_buf *wd_path,\n\tconst char *given_repo,\n\tgit_repository_init_options *opts)\n{\n\tint error = 0;\n\tbool is_bare, add_dotgit, has_dotgit, natural_wd;\n\tmode_t dirmode;\n\n\t/* There are three possible rules for what we are allowed to create:\n\t * - MKPATH means anything we need\n\t * - MKDIR means just the .git directory and its parent and the workdir\n\t * - Neither means only the .git directory can be created\n\t *\n\t * There are 5 \"segments\" of path that we might need to deal with:\n\t * 1. The .git directory\n\t * 2. The parent of the .git directory\n\t * 3. Everything above the parent of the .git directory\n\t * 4. The working directory (often the same as #2)\n\t * 5. Everything above the working directory (often the same as #3)\n\t *\n\t * For all directories created, we start with the init_mode value for\n\t * permissions and then strip off bits in some cases:\n\t *\n\t * For MKPATH, we create #3 (and #5) paths without S_ISGID or S_IWOTH\n\t * For MKPATH and MKDIR, we create #2 (and #4) without S_ISGID\n\t * For all rules, we create #1 using the untouched init_mode\n\t */\n\n\t/* set up repo path */\n\n\tis_bare = ((opts->flags & GIT_REPOSITORY_INIT_BARE) != 0);\n\n\tadd_dotgit =\n\t\t(opts->flags & GIT_REPOSITORY_INIT_NO_DOTGIT_DIR) == 0 &&\n\t\t!is_bare &&\n\t\tgit__suffixcmp(given_repo, \"/\" DOT_GIT) != 0 &&\n\t\tgit__suffixcmp(given_repo, \"/\" GIT_DIR) != 0;\n\n\tif (git_buf_joinpath(repo_path, given_repo, add_dotgit ? GIT_DIR : \"\") < 0)\n\t\treturn -1;\n\n\thas_dotgit = (git__suffixcmp(repo_path->ptr, \"/\" GIT_DIR) == 0);\n\tif (has_dotgit)\n\t\topts->flags |= GIT_REPOSITORY_INIT__HAS_DOTGIT;\n\n\t/* set up workdir path */\n\n\tif (!is_bare) {\n\t\tif (opts->workdir_path) {\n\t\t\tif (git_path_join_unrooted(\n\t\t\t\t\twd_path, opts->workdir_path, repo_path->ptr, NULL) < 0)\n\t\t\t\treturn -1;\n\t\t} else if (has_dotgit) {\n\t\t\tif (git_path_dirname_r(wd_path, repo_path->ptr) < 0)\n\t\t\t\treturn -1;\n\t\t} else {\n\t\t\tgiterr_set(GITERR_REPOSITORY, \"Cannot pick working directory\"\n\t\t\t\t\" for non-bare repository that isn't a '.git' directory\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (git_path_to_dir(wd_path) < 0)\n\t\t\treturn -1;\n\t} else {\n\t\tgit_buf_clear(wd_path);\n\t}\n\n\tnatural_wd =\n\t\thas_dotgit &&\n\t\twd_path->size > 0 &&\n\t\twd_path->size + strlen(GIT_DIR) == repo_path->size &&\n\t\tmemcmp(repo_path->ptr, wd_path->ptr, wd_path->size) == 0;\n\tif (natural_wd)\n\t\topts->flags |= GIT_REPOSITORY_INIT__NATURAL_WD;\n\n\t/* create directories as needed / requested */\n\n\tdirmode = pick_dir_mode(opts);\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0) {\n\t\t/* create path #5 */\n\t\tif (wd_path->size > 0 &&\n\t\t\t(error = mkdir_parent(wd_path, dirmode, false)) < 0)\n\t\t\treturn error;\n\n\t\t/* create path #3 (if not the same as #5) */\n\t\tif (!natural_wd &&\n\t\t\t(error = mkdir_parent(repo_path, dirmode, has_dotgit)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKDIR) != 0 ||\n\t\t(opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0)\n\t{\n\t\t/* create path #4 */\n\t\tif (wd_path->size > 0 &&\n\t\t\t(error = git_futils_mkdir(\n\t\t\t\twd_path->ptr, dirmode & ~S_ISGID,\n\t\t\t\tGIT_MKDIR_VERIFY_DIR)) < 0)\n\t\t\treturn error;\n\n\t\t/* create path #2 (if not the same as #4) */\n\t\tif (!natural_wd &&\n\t\t\t(error = git_futils_mkdir(\n\t\t\t\trepo_path->ptr, dirmode & ~S_ISGID,\n\t\t\t\tGIT_MKDIR_VERIFY_DIR | GIT_MKDIR_SKIP_LAST)) < 0)\n\t\t\treturn error;\n\t}\n\n\tif ((opts->flags & GIT_REPOSITORY_INIT_MKDIR) != 0 ||\n\t\t(opts->flags & GIT_REPOSITORY_INIT_MKPATH) != 0 ||\n\t\thas_dotgit)\n\t{\n\t\t/* create path #1 */\n\t\terror = git_futils_mkdir(repo_path->ptr, dirmode,\n\t\t\tGIT_MKDIR_VERIFY_DIR | ((dirmode & S_ISGID) ? GIT_MKDIR_CHMOD : 0));\n\t}\n\n\t/* prettify both directories now that they are created */\n\n\tif (!error) {\n\t\terror = git_path_prettify_dir(repo_path, repo_path->ptr, NULL);\n\n\t\tif (!error && wd_path->size > 0)\n\t\t\terror = git_path_prettify_dir(wd_path, wd_path->ptr, NULL);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "mkdir_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1498-1507",
    "snippet": "static int mkdir_parent(git_buf *buf, uint32_t mode, bool skip2)\n{\n\t/* When making parent directories during repository initialization\n\t * don't try to set gid or grant world write access\n\t */\n\treturn git_futils_mkdir(\n\t\tbuf->ptr, mode & ~(S_ISGID | 0002),\n\t\tGIT_MKDIR_PATH | GIT_MKDIR_VERIFY_DIR |\n\t\t(skip2 ? GIT_MKDIR_SKIP_LAST2 : GIT_MKDIR_SKIP_LAST));\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_futils_mkdir",
          "args": [
            "buf->ptr",
            "mode & ~(S_ISGID | 0002)",
            "GIT_MKDIR_PATH | GIT_MKDIR_VERIFY_DIR |\n\t\t(skip2 ? GIT_MKDIR_SKIP_LAST2 : GIT_MKDIR_SKIP_LAST)"
          ],
          "line": 1503
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_mkdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "408-491",
          "snippet": "int git_futils_mkdir(\n\tconst char *path,\n\tmode_t mode,\n\tuint32_t flags)\n{\n\tgit_buf make_path = GIT_BUF_INIT, parent_path = GIT_BUF_INIT;\n\tconst char *relative;\n\tstruct git_futils_mkdir_options opts = { 0 };\n\tstruct stat st;\n\tsize_t depth = 0;\n\tint len = 0, root_len, error;\n\n\tif ((error = git_buf_puts(&make_path, path)) < 0 ||\n\t\t(error = mkdir_canonicalize(&make_path, flags)) < 0 ||\n\t\t(error = git_buf_puts(&parent_path, make_path.ptr)) < 0 ||\n\t\tmake_path.size == 0)\n\t\tgoto done;\n\n\troot_len = git_path_root(make_path.ptr);\n\n\t/* find the first parent directory that exists.  this will be used\n\t * as the base to dirname_relative.\n\t */\n\tfor (relative = make_path.ptr; parent_path.size; ) {\n\t\terror = p_lstat(parent_path.ptr, &st);\n\n\t\tif (error == 0) {\n\t\t\tbreak;\n\t\t} else if (errno != ENOENT) {\n\t\t\tgiterr_set(GITERR_OS, \"failed to stat '%s'\", parent_path.ptr);\n\t\t\tgoto done;\n\t\t}\n\n\t\tdepth++;\n\n\t\t/* examine the parent of the current path */\n\t\tif ((len = git_path_dirname_r(&parent_path, parent_path.ptr)) < 0) {\n\t\t\terror = len;\n\t\t\tgoto done;\n\t\t}\n\n\t\tassert(len);\n\n\t\t/* we've walked all the given path's parents and it's either relative\n\t\t * or rooted.  either way, give up and make the entire path.\n\t\t */\n\t\tif ((len == 1 && parent_path.ptr[0] == '.') || len == root_len+1) {\n\t\t\trelative = make_path.ptr;\n\t\t\tbreak;\n\t\t}\n\n\t\trelative = make_path.ptr + len + 1;\n\n\t\t/* not recursive? just make this directory relative to its parent. */\n\t\tif ((flags & GIT_MKDIR_PATH) == 0)\n\t\t\tbreak;\n\t}\n\n\t/* we found an item at the location we're trying to create,\n\t * validate it.\n\t */\n\tif (depth == 0) {\n\t\terror = mkdir_validate_dir(make_path.ptr, &st, mode, flags, &opts);\n\n\t\tif (!error)\n\t\t\terror = mkdir_validate_mode(\n\t\t\t\tmake_path.ptr, &st, true, mode, flags, &opts);\n\n\t\tgoto done;\n\t}\n\n\t/* we already took `SKIP_LAST` and `SKIP_LAST2` into account when\n\t * canonicalizing `make_path`.\n\t */\n\tflags &= ~(GIT_MKDIR_SKIP_LAST2 | GIT_MKDIR_SKIP_LAST);\n\n\terror = git_futils_mkdir_relative(relative,\n\t\tparent_path.size ? parent_path.ptr : NULL, mode, flags, &opts);\n\ndone:\n\tgit_buf_free(&make_path);\n\tgit_buf_free(&parent_path);\n\treturn error;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_mkdir(\n\tconst char *path,\n\tmode_t mode,\n\tuint32_t flags)\n{\n\tgit_buf make_path = GIT_BUF_INIT, parent_path = GIT_BUF_INIT;\n\tconst char *relative;\n\tstruct git_futils_mkdir_options opts = { 0 };\n\tstruct stat st;\n\tsize_t depth = 0;\n\tint len = 0, root_len, error;\n\n\tif ((error = git_buf_puts(&make_path, path)) < 0 ||\n\t\t(error = mkdir_canonicalize(&make_path, flags)) < 0 ||\n\t\t(error = git_buf_puts(&parent_path, make_path.ptr)) < 0 ||\n\t\tmake_path.size == 0)\n\t\tgoto done;\n\n\troot_len = git_path_root(make_path.ptr);\n\n\t/* find the first parent directory that exists.  this will be used\n\t * as the base to dirname_relative.\n\t */\n\tfor (relative = make_path.ptr; parent_path.size; ) {\n\t\terror = p_lstat(parent_path.ptr, &st);\n\n\t\tif (error == 0) {\n\t\t\tbreak;\n\t\t} else if (errno != ENOENT) {\n\t\t\tgiterr_set(GITERR_OS, \"failed to stat '%s'\", parent_path.ptr);\n\t\t\tgoto done;\n\t\t}\n\n\t\tdepth++;\n\n\t\t/* examine the parent of the current path */\n\t\tif ((len = git_path_dirname_r(&parent_path, parent_path.ptr)) < 0) {\n\t\t\terror = len;\n\t\t\tgoto done;\n\t\t}\n\n\t\tassert(len);\n\n\t\t/* we've walked all the given path's parents and it's either relative\n\t\t * or rooted.  either way, give up and make the entire path.\n\t\t */\n\t\tif ((len == 1 && parent_path.ptr[0] == '.') || len == root_len+1) {\n\t\t\trelative = make_path.ptr;\n\t\t\tbreak;\n\t\t}\n\n\t\trelative = make_path.ptr + len + 1;\n\n\t\t/* not recursive? just make this directory relative to its parent. */\n\t\tif ((flags & GIT_MKDIR_PATH) == 0)\n\t\t\tbreak;\n\t}\n\n\t/* we found an item at the location we're trying to create,\n\t * validate it.\n\t */\n\tif (depth == 0) {\n\t\terror = mkdir_validate_dir(make_path.ptr, &st, mode, flags, &opts);\n\n\t\tif (!error)\n\t\t\terror = mkdir_validate_mode(\n\t\t\t\tmake_path.ptr, &st, true, mode, flags, &opts);\n\n\t\tgoto done;\n\t}\n\n\t/* we already took `SKIP_LAST` and `SKIP_LAST2` into account when\n\t * canonicalizing `make_path`.\n\t */\n\tflags &= ~(GIT_MKDIR_SKIP_LAST2 | GIT_MKDIR_SKIP_LAST);\n\n\terror = git_futils_mkdir_relative(relative,\n\t\tparent_path.size ? parent_path.ptr : NULL, mode, flags, &opts);\n\ndone:\n\tgit_buf_free(&make_path);\n\tgit_buf_free(&parent_path);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int mkdir_parent(git_buf *buf, uint32_t mode, bool skip2)\n{\n\t/* When making parent directories during repository initialization\n\t * don't try to set gid or grant world write access\n\t */\n\treturn git_futils_mkdir(\n\t\tbuf->ptr, mode & ~(S_ISGID | 0002),\n\t\tGIT_MKDIR_PATH | GIT_MKDIR_VERIFY_DIR |\n\t\t(skip2 ? GIT_MKDIR_SKIP_LAST2 : GIT_MKDIR_SKIP_LAST));\n}"
  },
  {
    "function_name": "repo_init_structure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1396-1496",
    "snippet": "static int repo_init_structure(\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tgit_repository_init_options *opts)\n{\n\tint error = 0;\n\trepo_template_item *tpl;\n\tbool external_tpl =\n\t\t((opts->flags & GIT_REPOSITORY_INIT_EXTERNAL_TEMPLATE) != 0);\n\tmode_t dmode = pick_dir_mode(opts);\n\tbool chmod = opts->mode != GIT_REPOSITORY_INIT_SHARED_UMASK;\n\n\t/* Hide the \".git\" directory */\n#ifdef GIT_WIN32\n\tif ((opts->flags & GIT_REPOSITORY_INIT__HAS_DOTGIT) != 0) {\n\t\tif (git_win32__set_hidden(repo_dir, true) < 0) {\n\t\t\tgiterr_set(GITERR_OS,\n\t\t\t\t\"Failed to mark Git repository folder as hidden\");\n\t\t\treturn -1;\n\t\t}\n\t}\n#endif\n\n\t/* Create the .git gitlink if appropriate */\n\tif ((opts->flags & GIT_REPOSITORY_INIT_BARE) == 0 &&\n\t\t(opts->flags & GIT_REPOSITORY_INIT__NATURAL_WD) == 0)\n\t{\n\t\tif (repo_write_gitlink(work_dir, repo_dir, opts->flags & GIT_REPOSITORY_INIT_RELATIVE_GITLINK) < 0)\n\t\t\treturn -1;\n\t}\n\n\t/* Copy external template if requested */\n\tif (external_tpl) {\n\t\tgit_config *cfg = NULL;\n\t\tconst char *tdir = NULL;\n\t\tbool default_template = false;\n\t\tgit_buf template_buf = GIT_BUF_INIT;\n\n\t\tif (opts->template_path)\n\t\t\ttdir = opts->template_path;\n\t\telse if ((error = git_config_open_default(&cfg)) >= 0) {\n\t\t\tif (!git_config_get_path(&template_buf, cfg, \"init.templatedir\"))\n\t\t\t\ttdir = template_buf.ptr;\n\t\t\tgiterr_clear();\n\t\t}\n\n\t\tif (!tdir) {\n\t\t\tif (!(error = git_sysdir_find_template_dir(&template_buf)))\n\t\t\t\ttdir = template_buf.ptr;\n\t\t\tdefault_template = true;\n\t\t}\n\n\t\tif (tdir) {\n\t\t\tuint32_t cpflags = GIT_CPDIR_COPY_SYMLINKS |\n\t\t\t\tGIT_CPDIR_SIMPLE_TO_MODE |\n\t\t\t\tGIT_CPDIR_COPY_DOTFILES;\n\t\t\tif (opts->mode != GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\t\t\t\tcpflags |= GIT_CPDIR_CHMOD_DIRS;\n\t\t\terror = git_futils_cp_r(tdir, repo_dir, cpflags, dmode);\n\t\t}\n\n\t\tgit_buf_free(&template_buf);\n\t\tgit_config_free(cfg);\n\n\t\tif (error < 0) {\n\t\t\tif (!default_template)\n\t\t\t\treturn error;\n\n\t\t\t/* if template was default, ignore error and use internal */\n\t\t\tgiterr_clear();\n\t\t\texternal_tpl = false;\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\t/* Copy internal template\n\t * - always ensure existence of dirs\n\t * - only create files if no external template was specified\n\t */\n\tfor (tpl = repo_template; !error && tpl->path; ++tpl) {\n\t\tif (!tpl->content) {\n\t\t\tuint32_t mkdir_flags = GIT_MKDIR_PATH;\n\t\t\tif (chmod)\n\t\t\t\tmkdir_flags |= GIT_MKDIR_CHMOD;\n\n\t\t\terror = git_futils_mkdir_relative(\n\t\t\t\ttpl->path, repo_dir, dmode, mkdir_flags, NULL);\n\t\t}\n\t\telse if (!external_tpl) {\n\t\t\tconst char *content = tpl->content;\n\n\t\t\tif (opts->description && strcmp(tpl->path, GIT_DESC_FILE) == 0)\n\t\t\t\tcontent = opts->description;\n\n\t\t\terror = repo_write_template(\n\t\t\t\trepo_dir, false, tpl->path, tpl->mode, false, content);\n\t\t}\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "repo_write_template",
          "args": [
            "repo_dir",
            "false",
            "tpl->path",
            "tpl->mode",
            "false",
            "content"
          ],
          "line": 1490
        },
        "resolved": true,
        "details": {
          "function_name": "repo_write_template",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1286-1331",
          "snippet": "static int repo_write_template(\n\tconst char *git_dir,\n\tbool allow_overwrite,\n\tconst char *file,\n\tmode_t mode,\n\tbool hidden,\n\tconst char *content)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd, error = 0, flags;\n\n\tif (git_buf_joinpath(&path, git_dir, file) < 0)\n\t\treturn -1;\n\n\tif (allow_overwrite)\n\t\tflags = O_WRONLY | O_CREAT | O_TRUNC;\n\telse\n\t\tflags = O_WRONLY | O_CREAT | O_EXCL;\n\n\tfd = p_open(git_buf_cstr(&path), flags, mode);\n\n\tif (fd >= 0) {\n\t\terror = p_write(fd, content, strlen(content));\n\n\t\tp_close(fd);\n\t}\n\telse if (errno != EEXIST)\n\t\terror = fd;\n\n#ifdef GIT_WIN32\n\tif (!error && hidden) {\n\t\tif (git_win32__set_hidden(path.ptr, true) < 0)\n\t\t\terror = -1;\n\t}\n#else\n\tGIT_UNUSED(hidden);\n#endif\n\n\tgit_buf_free(&path);\n\n\tif (error)\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to initialize repository with template '%s'\", file);\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_write_template(\n\tconst char *git_dir,\n\tbool allow_overwrite,\n\tconst char *file,\n\tmode_t mode,\n\tbool hidden,\n\tconst char *content)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd, error = 0, flags;\n\n\tif (git_buf_joinpath(&path, git_dir, file) < 0)\n\t\treturn -1;\n\n\tif (allow_overwrite)\n\t\tflags = O_WRONLY | O_CREAT | O_TRUNC;\n\telse\n\t\tflags = O_WRONLY | O_CREAT | O_EXCL;\n\n\tfd = p_open(git_buf_cstr(&path), flags, mode);\n\n\tif (fd >= 0) {\n\t\terror = p_write(fd, content, strlen(content));\n\n\t\tp_close(fd);\n\t}\n\telse if (errno != EEXIST)\n\t\terror = fd;\n\n#ifdef GIT_WIN32\n\tif (!error && hidden) {\n\t\tif (git_win32__set_hidden(path.ptr, true) < 0)\n\t\t\terror = -1;\n\t}\n#else\n\tGIT_UNUSED(hidden);\n#endif\n\n\tgit_buf_free(&path);\n\n\tif (error)\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to initialize repository with template '%s'\", file);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "tpl->path",
            "GIT_DESC_FILE"
          ],
          "line": 1487
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_mkdir_relative",
          "args": [
            "tpl->path",
            "repo_dir",
            "dmode",
            "mkdir_flags",
            "NULL"
          ],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_mkdir_relative",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "498-625",
          "snippet": "int git_futils_mkdir_relative(\n\tconst char *relative_path,\n\tconst char *base,\n\tmode_t mode,\n\tuint32_t flags,\n\tstruct git_futils_mkdir_options *opts)\n{\n\tgit_buf make_path = GIT_BUF_INIT;\n\tssize_t root = 0, min_root_len;\n\tchar lastch = '/', *tail;\n\tstruct stat st;\n\tstruct git_futils_mkdir_options empty_opts = {0};\n\tint error;\n\n\tif (!opts)\n\t\topts = &empty_opts;\n\n\t/* build path and find \"root\" where we should start calling mkdir */\n\tif (git_path_join_unrooted(&make_path, relative_path, base, &root) < 0)\n\t\treturn -1;\n\n\tif ((error = mkdir_canonicalize(&make_path, flags)) < 0 ||\n\t\tmake_path.size == 0)\n\t\tgoto done;\n\n\t/* if we are not supposed to make the whole path, reset root */\n\tif ((flags & GIT_MKDIR_PATH) == 0)\n\t\troot = git_buf_rfind(&make_path, '/');\n\n\t/* advance root past drive name or network mount prefix */\n\tmin_root_len = git_path_root(make_path.ptr);\n\tif (root < min_root_len)\n\t\troot = min_root_len;\n\twhile (root >= 0 && make_path.ptr[root] == '/')\n\t\t++root;\n\n\t/* clip root to make_path length */\n\tif (root > (ssize_t)make_path.size)\n\t\troot = (ssize_t)make_path.size; /* i.e. NUL byte of string */\n\tif (root < 0)\n\t\troot = 0;\n\n\t/* walk down tail of path making each directory */\n\tfor (tail = &make_path.ptr[root]; *tail; *tail = lastch) {\n\t\tbool mkdir_attempted = false;\n\n\t\t/* advance tail to include next path component */\n\t\twhile (*tail == '/')\n\t\t\ttail++;\n\t\twhile (*tail && *tail != '/')\n\t\t\ttail++;\n\n\t\t/* truncate path at next component */\n\t\tlastch = *tail;\n\t\t*tail = '\\0';\n\t\tst.st_mode = 0;\n\n\t\tif (opts->dir_map && git_strmap_exists(opts->dir_map, make_path.ptr))\n\t\t\tcontinue;\n\n\t\t/* See what's going on with this path component */\n\t\topts->perfdata.stat_calls++;\n\nretry_lstat:\n\t\tif (p_lstat(make_path.ptr, &st) < 0) {\n\t\t\tif (mkdir_attempted || errno != ENOENT) {\n\t\t\t\tgiterr_set(GITERR_OS, \"Cannot access component in path '%s'\", make_path.ptr);\n\t\t\t\terror = -1;\n\t\t\t\tgoto done;\n\t\t\t}\n\n\t\t\tgiterr_clear();\n\t\t\topts->perfdata.mkdir_calls++;\n\t\t\tmkdir_attempted = true;\n\t\t\tif (p_mkdir(make_path.ptr, mode) < 0) {\n\t\t\t\tif (errno == EEXIST)\n\t\t\t\t\tgoto retry_lstat;\n\t\t\t\tgiterr_set(GITERR_OS, \"Failed to make directory '%s'\", make_path.ptr);\n\t\t\t\terror = -1;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t} else {\n\t\t\tif ((error = mkdir_validate_dir(\n\t\t\t\tmake_path.ptr, &st, mode, flags, opts)) < 0)\n\t\t\t\tgoto done;\n\t\t}\n\n\t\t/* chmod if requested and necessary */\n\t\tif ((error = mkdir_validate_mode(\n\t\t\tmake_path.ptr, &st, (lastch == '\\0'), mode, flags, opts)) < 0)\n\t\t\tgoto done;\n\n\t\tif (opts->dir_map && opts->pool) {\n\t\t\tchar *cache_path;\n\t\t\tsize_t alloc_size;\n\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloc_size, make_path.size, 1);\n\t\t\tif (!git__is_uint32(alloc_size))\n\t\t\t\treturn -1;\n\t\t\tcache_path = git_pool_malloc(opts->pool, (uint32_t)alloc_size);\n\t\t\tGITERR_CHECK_ALLOC(cache_path);\n\n\t\t\tmemcpy(cache_path, make_path.ptr, make_path.size + 1);\n\n\t\t\tgit_strmap_insert(opts->dir_map, cache_path, cache_path, error);\n\t\t\tif (error < 0)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\terror = 0;\n\n\t/* check that full path really is a directory if requested & needed */\n\tif ((flags & GIT_MKDIR_VERIFY_DIR) != 0 &&\n\t\tlastch != '\\0') {\n\t\topts->perfdata.stat_calls++;\n\n\t\tif (p_stat(make_path.ptr, &st) < 0 || !S_ISDIR(st.st_mode)) {\n\t\t\tgiterr_set(GITERR_OS, \"Path is not a directory '%s'\",\n\t\t\t\tmake_path.ptr);\n\t\t\terror = GIT_ENOTFOUND;\n\t\t}\n\t}\n\ndone:\n\tgit_buf_free(&make_path);\n\treturn error;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_mkdir_relative(\n\tconst char *relative_path,\n\tconst char *base,\n\tmode_t mode,\n\tuint32_t flags,\n\tstruct git_futils_mkdir_options *opts)\n{\n\tgit_buf make_path = GIT_BUF_INIT;\n\tssize_t root = 0, min_root_len;\n\tchar lastch = '/', *tail;\n\tstruct stat st;\n\tstruct git_futils_mkdir_options empty_opts = {0};\n\tint error;\n\n\tif (!opts)\n\t\topts = &empty_opts;\n\n\t/* build path and find \"root\" where we should start calling mkdir */\n\tif (git_path_join_unrooted(&make_path, relative_path, base, &root) < 0)\n\t\treturn -1;\n\n\tif ((error = mkdir_canonicalize(&make_path, flags)) < 0 ||\n\t\tmake_path.size == 0)\n\t\tgoto done;\n\n\t/* if we are not supposed to make the whole path, reset root */\n\tif ((flags & GIT_MKDIR_PATH) == 0)\n\t\troot = git_buf_rfind(&make_path, '/');\n\n\t/* advance root past drive name or network mount prefix */\n\tmin_root_len = git_path_root(make_path.ptr);\n\tif (root < min_root_len)\n\t\troot = min_root_len;\n\twhile (root >= 0 && make_path.ptr[root] == '/')\n\t\t++root;\n\n\t/* clip root to make_path length */\n\tif (root > (ssize_t)make_path.size)\n\t\troot = (ssize_t)make_path.size; /* i.e. NUL byte of string */\n\tif (root < 0)\n\t\troot = 0;\n\n\t/* walk down tail of path making each directory */\n\tfor (tail = &make_path.ptr[root]; *tail; *tail = lastch) {\n\t\tbool mkdir_attempted = false;\n\n\t\t/* advance tail to include next path component */\n\t\twhile (*tail == '/')\n\t\t\ttail++;\n\t\twhile (*tail && *tail != '/')\n\t\t\ttail++;\n\n\t\t/* truncate path at next component */\n\t\tlastch = *tail;\n\t\t*tail = '\\0';\n\t\tst.st_mode = 0;\n\n\t\tif (opts->dir_map && git_strmap_exists(opts->dir_map, make_path.ptr))\n\t\t\tcontinue;\n\n\t\t/* See what's going on with this path component */\n\t\topts->perfdata.stat_calls++;\n\nretry_lstat:\n\t\tif (p_lstat(make_path.ptr, &st) < 0) {\n\t\t\tif (mkdir_attempted || errno != ENOENT) {\n\t\t\t\tgiterr_set(GITERR_OS, \"Cannot access component in path '%s'\", make_path.ptr);\n\t\t\t\terror = -1;\n\t\t\t\tgoto done;\n\t\t\t}\n\n\t\t\tgiterr_clear();\n\t\t\topts->perfdata.mkdir_calls++;\n\t\t\tmkdir_attempted = true;\n\t\t\tif (p_mkdir(make_path.ptr, mode) < 0) {\n\t\t\t\tif (errno == EEXIST)\n\t\t\t\t\tgoto retry_lstat;\n\t\t\t\tgiterr_set(GITERR_OS, \"Failed to make directory '%s'\", make_path.ptr);\n\t\t\t\terror = -1;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t} else {\n\t\t\tif ((error = mkdir_validate_dir(\n\t\t\t\tmake_path.ptr, &st, mode, flags, opts)) < 0)\n\t\t\t\tgoto done;\n\t\t}\n\n\t\t/* chmod if requested and necessary */\n\t\tif ((error = mkdir_validate_mode(\n\t\t\tmake_path.ptr, &st, (lastch == '\\0'), mode, flags, opts)) < 0)\n\t\t\tgoto done;\n\n\t\tif (opts->dir_map && opts->pool) {\n\t\t\tchar *cache_path;\n\t\t\tsize_t alloc_size;\n\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloc_size, make_path.size, 1);\n\t\t\tif (!git__is_uint32(alloc_size))\n\t\t\t\treturn -1;\n\t\t\tcache_path = git_pool_malloc(opts->pool, (uint32_t)alloc_size);\n\t\t\tGITERR_CHECK_ALLOC(cache_path);\n\n\t\t\tmemcpy(cache_path, make_path.ptr, make_path.size + 1);\n\n\t\t\tgit_strmap_insert(opts->dir_map, cache_path, cache_path, error);\n\t\t\tif (error < 0)\n\t\t\t\tgoto done;\n\t\t}\n\t}\n\n\terror = 0;\n\n\t/* check that full path really is a directory if requested & needed */\n\tif ((flags & GIT_MKDIR_VERIFY_DIR) != 0 &&\n\t\tlastch != '\\0') {\n\t\topts->perfdata.stat_calls++;\n\n\t\tif (p_stat(make_path.ptr, &st) < 0 || !S_ISDIR(st.st_mode)) {\n\t\t\tgiterr_set(GITERR_OS, \"Path is not a directory '%s'\",\n\t\t\t\tmake_path.ptr);\n\t\t\terror = GIT_ENOTFOUND;\n\t\t}\n\t}\n\ndone:\n\tgit_buf_free(&make_path);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 1465
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "cfg"
          ],
          "line": 1458
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&template_buf"
          ],
          "line": 1457
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_cp_r",
          "args": [
            "tdir",
            "repo_dir",
            "cpflags",
            "dmode"
          ],
          "line": 1454
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_cp_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "991-1031",
          "snippet": "int git_futils_cp_r(\n\tconst char *from,\n\tconst char *to,\n\tuint32_t flags,\n\tmode_t dirmode)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tcp_r_info info;\n\n\tif (git_buf_joinpath(&path, from, \"\") < 0) /* ensure trailing slash */\n\t\treturn -1;\n\n\tmemset(&info, 0, sizeof(info));\n\tinfo.to_root = to;\n\tinfo.flags   = flags;\n\tinfo.dirmode = dirmode;\n\tinfo.from_prefix = path.size;\n\tgit_buf_init(&info.to, 0);\n\n\t/* precalculate mkdir flags */\n\tif ((flags & GIT_CPDIR_CREATE_EMPTY_DIRS) == 0) {\n\t\t/* if not creating empty dirs, then use mkdir to create the path on\n\t\t * demand right before files are copied.\n\t\t */\n\t\tinfo.mkdir_flags = GIT_MKDIR_PATH | GIT_MKDIR_SKIP_LAST;\n\t\tif ((flags & GIT_CPDIR_CHMOD_DIRS) != 0)\n\t\t\tinfo.mkdir_flags |= GIT_MKDIR_CHMOD_PATH;\n\t} else {\n\t\t/* otherwise, we will do simple mkdir as directories are encountered */\n\t\tinfo.mkdir_flags =\n\t\t\t((flags & GIT_CPDIR_CHMOD_DIRS) != 0) ? GIT_MKDIR_CHMOD : 0;\n\t}\n\n\terror = _cp_r_callback(&info, &path);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&info.to);\n\n\treturn error;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_cp_r(\n\tconst char *from,\n\tconst char *to,\n\tuint32_t flags,\n\tmode_t dirmode)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tcp_r_info info;\n\n\tif (git_buf_joinpath(&path, from, \"\") < 0) /* ensure trailing slash */\n\t\treturn -1;\n\n\tmemset(&info, 0, sizeof(info));\n\tinfo.to_root = to;\n\tinfo.flags   = flags;\n\tinfo.dirmode = dirmode;\n\tinfo.from_prefix = path.size;\n\tgit_buf_init(&info.to, 0);\n\n\t/* precalculate mkdir flags */\n\tif ((flags & GIT_CPDIR_CREATE_EMPTY_DIRS) == 0) {\n\t\t/* if not creating empty dirs, then use mkdir to create the path on\n\t\t * demand right before files are copied.\n\t\t */\n\t\tinfo.mkdir_flags = GIT_MKDIR_PATH | GIT_MKDIR_SKIP_LAST;\n\t\tif ((flags & GIT_CPDIR_CHMOD_DIRS) != 0)\n\t\t\tinfo.mkdir_flags |= GIT_MKDIR_CHMOD_PATH;\n\t} else {\n\t\t/* otherwise, we will do simple mkdir as directories are encountered */\n\t\tinfo.mkdir_flags =\n\t\t\t((flags & GIT_CPDIR_CHMOD_DIRS) != 0) ? GIT_MKDIR_CHMOD : 0;\n\t}\n\n\terror = _cp_r_callback(&info, &path);\n\n\tgit_buf_free(&path);\n\tgit_buf_free(&info.to);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_sysdir_find_template_dir",
          "args": [
            "&template_buf"
          ],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "git_sysdir_find_template_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/sysdir.c",
          "lines": "272-276",
          "snippet": "int git_sysdir_find_template_dir(git_buf *path)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, NULL, GIT_SYSDIR_TEMPLATE, \"template\");\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"path.h\"",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"path.h\"\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_sysdir_find_template_dir(git_buf *path)\n{\n\treturn git_sysdir_find_in_dirlist(\n\t\tpath, NULL, GIT_SYSDIR_TEMPLATE, \"template\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_get_path",
          "args": [
            "&template_buf",
            "cfg",
            "\"init.templatedir\""
          ],
          "line": 1437
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_get_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "824-836",
          "snippet": "int git_config_get_path(git_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint error;\n\n\tif ((error = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn error;\n\n\t error = git_config_parse_path(out, entry->value);\n\t git_config_entry_free(entry);\n\n\t return error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_path(git_buf *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint error;\n\n\tif ((error = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn error;\n\n\t error = git_config_parse_path(out, entry->value);\n\t git_config_entry_free(entry);\n\n\t return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_open_default",
          "args": [
            "&cfg"
          ],
          "line": 1436
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_open_default",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1120-1156",
          "snippet": "int git_config_open_default(git_config **out)\n{\n\tint error;\n\tgit_config *cfg = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tif ((error = git_config_new(&cfg)) < 0)\n\t\treturn error;\n\n\tif (!git_config_find_global(&buf) || !git_config__global_location(&buf)) {\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_GLOBAL, 0);\n\t}\n\n\tif (!error && !git_config_find_xdg(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_XDG, 0);\n\n\tif (!error && !git_config_find_system(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_SYSTEM, 0);\n\n\tif (!error && !git_config_find_programdata(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_PROGRAMDATA, 0);\n\n\tgit_buf_free(&buf);\n\n\tif (error) {\n\t\tgit_config_free(cfg);\n\t\tcfg = NULL;\n\t}\n\n\t*out = cfg;\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_open_default(git_config **out)\n{\n\tint error;\n\tgit_config *cfg = NULL;\n\tgit_buf buf = GIT_BUF_INIT;\n\n\tif ((error = git_config_new(&cfg)) < 0)\n\t\treturn error;\n\n\tif (!git_config_find_global(&buf) || !git_config__global_location(&buf)) {\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_GLOBAL, 0);\n\t}\n\n\tif (!error && !git_config_find_xdg(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_XDG, 0);\n\n\tif (!error && !git_config_find_system(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_SYSTEM, 0);\n\n\tif (!error && !git_config_find_programdata(&buf))\n\t\terror = git_config_add_file_ondisk(cfg, buf.ptr,\n\t\t\tGIT_CONFIG_LEVEL_PROGRAMDATA, 0);\n\n\tgit_buf_free(&buf);\n\n\tif (error) {\n\t\tgit_config_free(cfg);\n\t\tcfg = NULL;\n\t}\n\n\t*out = cfg;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_write_gitlink",
          "args": [
            "work_dir",
            "repo_dir",
            "opts->flags & GIT_REPOSITORY_INIT_RELATIVE_GITLINK"
          ],
          "line": 1423
        },
        "resolved": true,
        "details": {
          "function_name": "repo_write_gitlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1333-1381",
          "snippet": "static int repo_write_gitlink(\n\tconst char *in_dir, const char *to_repo, bool use_relative_path)\n{\n\tint error;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_buf path_to_repo = GIT_BUF_INIT;\n\tstruct stat st;\n\n\tgit_path_dirname_r(&buf, to_repo);\n\tgit_path_to_dir(&buf);\n\tif (git_buf_oom(&buf))\n\t\treturn -1;\n\n\t/* don't write gitlink to natural workdir */\n\tif (git__suffixcmp(to_repo, \"/\" DOT_GIT \"/\") == 0 &&\n\t\tstrcmp(in_dir, buf.ptr) == 0)\n\t{\n\t\terror = GIT_PASSTHROUGH;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_buf_joinpath(&buf, in_dir, DOT_GIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (!p_stat(buf.ptr, &st) && !S_ISREG(st.st_mode)) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Cannot overwrite gitlink file into path '%s'\", in_dir);\n\t\terror = GIT_EEXISTS;\n\t\tgoto cleanup;\n\t}\n\n\tgit_buf_clear(&buf);\n\n\terror = git_buf_sets(&path_to_repo, to_repo);\n\n\tif (!error && use_relative_path)\n\t\terror = git_path_make_relative(&path_to_repo, in_dir);\n\n\tif (!error)\n\t\terror = git_buf_join(&buf, ' ', GIT_FILE_CONTENT_PREFIX, path_to_repo.ptr);\n\n\tif (!error)\n\t\terror = repo_write_template(in_dir, true, DOT_GIT, 0666, true, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\tgit_buf_free(&path_to_repo);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [
            "#define GIT_FILE_CONTENT_PREFIX \"gitdir:\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_FILE_CONTENT_PREFIX \"gitdir:\"\n\nstatic int repo_write_gitlink(\n\tconst char *in_dir, const char *to_repo, bool use_relative_path)\n{\n\tint error;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_buf path_to_repo = GIT_BUF_INIT;\n\tstruct stat st;\n\n\tgit_path_dirname_r(&buf, to_repo);\n\tgit_path_to_dir(&buf);\n\tif (git_buf_oom(&buf))\n\t\treturn -1;\n\n\t/* don't write gitlink to natural workdir */\n\tif (git__suffixcmp(to_repo, \"/\" DOT_GIT \"/\") == 0 &&\n\t\tstrcmp(in_dir, buf.ptr) == 0)\n\t{\n\t\terror = GIT_PASSTHROUGH;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_buf_joinpath(&buf, in_dir, DOT_GIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (!p_stat(buf.ptr, &st) && !S_ISREG(st.st_mode)) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Cannot overwrite gitlink file into path '%s'\", in_dir);\n\t\terror = GIT_EEXISTS;\n\t\tgoto cleanup;\n\t}\n\n\tgit_buf_clear(&buf);\n\n\terror = git_buf_sets(&path_to_repo, to_repo);\n\n\tif (!error && use_relative_path)\n\t\terror = git_path_make_relative(&path_to_repo, in_dir);\n\n\tif (!error)\n\t\terror = git_buf_join(&buf, ' ', GIT_FILE_CONTENT_PREFIX, path_to_repo.ptr);\n\n\tif (!error)\n\t\terror = repo_write_template(in_dir, true, DOT_GIT, 0666, true, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\tgit_buf_free(&path_to_repo);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Failed to mark Git repository folder as hidden\""
          ],
          "line": 1412
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set_after_callback_function",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/common.h",
          "lines": "122-132",
          "snippet": "GIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <regex.h>",
            "#include \"integer.h\"",
            "#include \"thread-utils.h\"",
            "#include \"git2/errors.h\"",
            "#include \"git2/types.h\"",
            "# include <arpa/inet.h>",
            "#\tinclude <sched.h>",
            "#\tinclude <pthread.h>",
            "# include <strings.h>",
            "# include <unistd.h>",
            "#   include \"win32/w32_crtdbg_stacktrace.h\"",
            "#   include \"win32/w32_stack.h\"",
            "#\tinclude \"win32/thread.h\"",
            "# include \"win32/version.h\"",
            "# include \"win32/error.h\"",
            "# include \"win32/win32-compat.h\"",
            "# include \"win32/mingw-compat.h\"",
            "# include \"win32/msvc-compat.h\"",
            "# include <ws2tcpip.h>",
            "# include <windows.h>",
            "# include <winsock2.h>",
            "# include <direct.h>",
            "# include <io.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"cc-compat.h\"",
            "#include \"git2/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <regex.h>\n#include \"integer.h\"\n#include \"thread-utils.h\"\n#include \"git2/errors.h\"\n#include \"git2/types.h\"\n# include <arpa/inet.h>\n#\tinclude <sched.h>\n#\tinclude <pthread.h>\n# include <strings.h>\n# include <unistd.h>\n#   include \"win32/w32_crtdbg_stacktrace.h\"\n#   include \"win32/w32_stack.h\"\n#\tinclude \"win32/thread.h\"\n# include \"win32/version.h\"\n# include \"win32/error.h\"\n# include \"win32/win32-compat.h\"\n# include \"win32/mingw-compat.h\"\n# include \"win32/msvc-compat.h\"\n# include <ws2tcpip.h>\n# include <windows.h>\n# include <winsock2.h>\n# include <direct.h>\n# include <io.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <errno.h>\n#include <assert.h>\n#include \"cc-compat.h\"\n#include \"git2/common.h\"\n\nGIT_INLINE(int) giterr_set_after_callback_function(\n\tint error_code, const char *action)\n{\n\tif (error_code) {\n\t\tconst git_error *e = giterr_last();\n\t\tif (!e || !e->message)\n\t\t\tgiterr_set(e ? e->klass : GITERR_CALLBACK,\n\t\t\t\t\"%s callback returned %d\", action, error_code);\n\t}\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_win32__set_hidden",
          "args": [
            "repo_dir",
            "true"
          ],
          "line": 1411
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__set_hidden",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.c",
          "lines": "51-77",
          "snippet": "int git_win32__set_hidden(const char *path, bool hidden)\n{\n\tgit_win32_path buf;\n\tDWORD attrs, newattrs;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\tattrs = GetFileAttributesW(buf);\n\n\t/* Ensure the path exists */\n\tif (attrs == INVALID_FILE_ATTRIBUTES)\n\t\treturn -1;\n\n\tif (hidden)\n\t\tnewattrs = attrs | FILE_ATTRIBUTE_HIDDEN;\n\telse\n\t\tnewattrs = attrs & ~FILE_ATTRIBUTE_HIDDEN;\n\n\tif (attrs != newattrs && !SetFileAttributesW(buf, newattrs)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to %s hidden bit for '%s'\",\n\t\t\thidden ? \"set\" : \"unset\", path);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"w32_util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"w32_util.h\"\n\nint git_win32__set_hidden(const char *path, bool hidden)\n{\n\tgit_win32_path buf;\n\tDWORD attrs, newattrs;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\tattrs = GetFileAttributesW(buf);\n\n\t/* Ensure the path exists */\n\tif (attrs == INVALID_FILE_ATTRIBUTES)\n\t\treturn -1;\n\n\tif (hidden)\n\t\tnewattrs = attrs | FILE_ATTRIBUTE_HIDDEN;\n\telse\n\t\tnewattrs = attrs & ~FILE_ATTRIBUTE_HIDDEN;\n\n\tif (attrs != newattrs && !SetFileAttributesW(buf, newattrs)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to %s hidden bit for '%s'\",\n\t\t\thidden ? \"set\" : \"unset\", path);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pick_dir_mode",
          "args": [
            "opts"
          ],
          "line": 1405
        },
        "resolved": true,
        "details": {
          "function_name": "pick_dir_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1383-1392",
          "snippet": "static mode_t pick_dir_mode(git_repository_init_options *opts)\n{\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\treturn 0777;\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_GROUP)\n\t\treturn (0775 | S_ISGID);\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_ALL)\n\t\treturn (0777 | S_ISGID);\n\treturn opts->mode;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic mode_t pick_dir_mode(git_repository_init_options *opts)\n{\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\treturn 0777;\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_GROUP)\n\t\treturn (0775 | S_ISGID);\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_ALL)\n\t\treturn (0777 | S_ISGID);\n\treturn opts->mode;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_init_structure(\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tgit_repository_init_options *opts)\n{\n\tint error = 0;\n\trepo_template_item *tpl;\n\tbool external_tpl =\n\t\t((opts->flags & GIT_REPOSITORY_INIT_EXTERNAL_TEMPLATE) != 0);\n\tmode_t dmode = pick_dir_mode(opts);\n\tbool chmod = opts->mode != GIT_REPOSITORY_INIT_SHARED_UMASK;\n\n\t/* Hide the \".git\" directory */\n#ifdef GIT_WIN32\n\tif ((opts->flags & GIT_REPOSITORY_INIT__HAS_DOTGIT) != 0) {\n\t\tif (git_win32__set_hidden(repo_dir, true) < 0) {\n\t\t\tgiterr_set(GITERR_OS,\n\t\t\t\t\"Failed to mark Git repository folder as hidden\");\n\t\t\treturn -1;\n\t\t}\n\t}\n#endif\n\n\t/* Create the .git gitlink if appropriate */\n\tif ((opts->flags & GIT_REPOSITORY_INIT_BARE) == 0 &&\n\t\t(opts->flags & GIT_REPOSITORY_INIT__NATURAL_WD) == 0)\n\t{\n\t\tif (repo_write_gitlink(work_dir, repo_dir, opts->flags & GIT_REPOSITORY_INIT_RELATIVE_GITLINK) < 0)\n\t\t\treturn -1;\n\t}\n\n\t/* Copy external template if requested */\n\tif (external_tpl) {\n\t\tgit_config *cfg = NULL;\n\t\tconst char *tdir = NULL;\n\t\tbool default_template = false;\n\t\tgit_buf template_buf = GIT_BUF_INIT;\n\n\t\tif (opts->template_path)\n\t\t\ttdir = opts->template_path;\n\t\telse if ((error = git_config_open_default(&cfg)) >= 0) {\n\t\t\tif (!git_config_get_path(&template_buf, cfg, \"init.templatedir\"))\n\t\t\t\ttdir = template_buf.ptr;\n\t\t\tgiterr_clear();\n\t\t}\n\n\t\tif (!tdir) {\n\t\t\tif (!(error = git_sysdir_find_template_dir(&template_buf)))\n\t\t\t\ttdir = template_buf.ptr;\n\t\t\tdefault_template = true;\n\t\t}\n\n\t\tif (tdir) {\n\t\t\tuint32_t cpflags = GIT_CPDIR_COPY_SYMLINKS |\n\t\t\t\tGIT_CPDIR_SIMPLE_TO_MODE |\n\t\t\t\tGIT_CPDIR_COPY_DOTFILES;\n\t\t\tif (opts->mode != GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\t\t\t\tcpflags |= GIT_CPDIR_CHMOD_DIRS;\n\t\t\terror = git_futils_cp_r(tdir, repo_dir, cpflags, dmode);\n\t\t}\n\n\t\tgit_buf_free(&template_buf);\n\t\tgit_config_free(cfg);\n\n\t\tif (error < 0) {\n\t\t\tif (!default_template)\n\t\t\t\treturn error;\n\n\t\t\t/* if template was default, ignore error and use internal */\n\t\t\tgiterr_clear();\n\t\t\texternal_tpl = false;\n\t\t\terror = 0;\n\t\t}\n\t}\n\n\t/* Copy internal template\n\t * - always ensure existence of dirs\n\t * - only create files if no external template was specified\n\t */\n\tfor (tpl = repo_template; !error && tpl->path; ++tpl) {\n\t\tif (!tpl->content) {\n\t\t\tuint32_t mkdir_flags = GIT_MKDIR_PATH;\n\t\t\tif (chmod)\n\t\t\t\tmkdir_flags |= GIT_MKDIR_CHMOD;\n\n\t\t\terror = git_futils_mkdir_relative(\n\t\t\t\ttpl->path, repo_dir, dmode, mkdir_flags, NULL);\n\t\t}\n\t\telse if (!external_tpl) {\n\t\t\tconst char *content = tpl->content;\n\n\t\t\tif (opts->description && strcmp(tpl->path, GIT_DESC_FILE) == 0)\n\t\t\t\tcontent = opts->description;\n\n\t\t\terror = repo_write_template(\n\t\t\t\trepo_dir, false, tpl->path, tpl->mode, false, content);\n\t\t}\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "pick_dir_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1383-1392",
    "snippet": "static mode_t pick_dir_mode(git_repository_init_options *opts)\n{\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\treturn 0777;\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_GROUP)\n\t\treturn (0775 | S_ISGID);\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_ALL)\n\t\treturn (0777 | S_ISGID);\n\treturn opts->mode;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic mode_t pick_dir_mode(git_repository_init_options *opts)\n{\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_UMASK)\n\t\treturn 0777;\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_GROUP)\n\t\treturn (0775 | S_ISGID);\n\tif (opts->mode == GIT_REPOSITORY_INIT_SHARED_ALL)\n\t\treturn (0777 | S_ISGID);\n\treturn opts->mode;\n}"
  },
  {
    "function_name": "repo_write_gitlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1333-1381",
    "snippet": "static int repo_write_gitlink(\n\tconst char *in_dir, const char *to_repo, bool use_relative_path)\n{\n\tint error;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_buf path_to_repo = GIT_BUF_INIT;\n\tstruct stat st;\n\n\tgit_path_dirname_r(&buf, to_repo);\n\tgit_path_to_dir(&buf);\n\tif (git_buf_oom(&buf))\n\t\treturn -1;\n\n\t/* don't write gitlink to natural workdir */\n\tif (git__suffixcmp(to_repo, \"/\" DOT_GIT \"/\") == 0 &&\n\t\tstrcmp(in_dir, buf.ptr) == 0)\n\t{\n\t\terror = GIT_PASSTHROUGH;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_buf_joinpath(&buf, in_dir, DOT_GIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (!p_stat(buf.ptr, &st) && !S_ISREG(st.st_mode)) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Cannot overwrite gitlink file into path '%s'\", in_dir);\n\t\terror = GIT_EEXISTS;\n\t\tgoto cleanup;\n\t}\n\n\tgit_buf_clear(&buf);\n\n\terror = git_buf_sets(&path_to_repo, to_repo);\n\n\tif (!error && use_relative_path)\n\t\terror = git_path_make_relative(&path_to_repo, in_dir);\n\n\tif (!error)\n\t\terror = git_buf_join(&buf, ' ', GIT_FILE_CONTENT_PREFIX, path_to_repo.ptr);\n\n\tif (!error)\n\t\terror = repo_write_template(in_dir, true, DOT_GIT, 0666, true, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\tgit_buf_free(&path_to_repo);\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [
      "#define GIT_FILE_CONTENT_PREFIX \"gitdir:\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path_to_repo"
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_write_template",
          "args": [
            "in_dir",
            "true",
            "DOT_GIT",
            "0666",
            "true",
            "buf.ptr"
          ],
          "line": 1375
        },
        "resolved": true,
        "details": {
          "function_name": "repo_write_template",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1286-1331",
          "snippet": "static int repo_write_template(\n\tconst char *git_dir,\n\tbool allow_overwrite,\n\tconst char *file,\n\tmode_t mode,\n\tbool hidden,\n\tconst char *content)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd, error = 0, flags;\n\n\tif (git_buf_joinpath(&path, git_dir, file) < 0)\n\t\treturn -1;\n\n\tif (allow_overwrite)\n\t\tflags = O_WRONLY | O_CREAT | O_TRUNC;\n\telse\n\t\tflags = O_WRONLY | O_CREAT | O_EXCL;\n\n\tfd = p_open(git_buf_cstr(&path), flags, mode);\n\n\tif (fd >= 0) {\n\t\terror = p_write(fd, content, strlen(content));\n\n\t\tp_close(fd);\n\t}\n\telse if (errno != EEXIST)\n\t\terror = fd;\n\n#ifdef GIT_WIN32\n\tif (!error && hidden) {\n\t\tif (git_win32__set_hidden(path.ptr, true) < 0)\n\t\t\terror = -1;\n\t}\n#else\n\tGIT_UNUSED(hidden);\n#endif\n\n\tgit_buf_free(&path);\n\n\tif (error)\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to initialize repository with template '%s'\", file);\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_write_template(\n\tconst char *git_dir,\n\tbool allow_overwrite,\n\tconst char *file,\n\tmode_t mode,\n\tbool hidden,\n\tconst char *content)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd, error = 0, flags;\n\n\tif (git_buf_joinpath(&path, git_dir, file) < 0)\n\t\treturn -1;\n\n\tif (allow_overwrite)\n\t\tflags = O_WRONLY | O_CREAT | O_TRUNC;\n\telse\n\t\tflags = O_WRONLY | O_CREAT | O_EXCL;\n\n\tfd = p_open(git_buf_cstr(&path), flags, mode);\n\n\tif (fd >= 0) {\n\t\terror = p_write(fd, content, strlen(content));\n\n\t\tp_close(fd);\n\t}\n\telse if (errno != EEXIST)\n\t\terror = fd;\n\n#ifdef GIT_WIN32\n\tif (!error && hidden) {\n\t\tif (git_win32__set_hidden(path.ptr, true) < 0)\n\t\t\terror = -1;\n\t}\n#else\n\tGIT_UNUSED(hidden);\n#endif\n\n\tgit_buf_free(&path);\n\n\tif (error)\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to initialize repository with template '%s'\", file);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_join",
          "args": [
            "&buf",
            "' '",
            "GIT_FILE_CONTENT_PREFIX",
            "path_to_repo.ptr"
          ],
          "line": 1372
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "607-655",
          "snippet": "int git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_join(\n\tgit_buf *buf,\n\tchar separator,\n\tconst char *str_a,\n\tconst char *str_b)\n{\n\tsize_t strlen_a = str_a ? strlen(str_a) : 0;\n\tsize_t strlen_b = strlen(str_b);\n\tsize_t alloc_len;\n\tint need_sep = 0;\n\tssize_t offset_a = -1;\n\n\t/* not safe to have str_b point internally to the buffer */\n\tassert(str_b < buf->ptr || str_b >= buf->ptr + buf->size);\n\n\t/* figure out if we need to insert a separator */\n\tif (separator && strlen_a) {\n\t\twhile (*str_b == separator) { str_b++; strlen_b--; }\n\t\tif (str_a[strlen_a - 1] != separator)\n\t\t\tneed_sep = 1;\n\t}\n\n\t/* str_a could be part of the buffer */\n\tif (str_a >= buf->ptr && str_a < buf->ptr + buf->size)\n\t\toffset_a = str_a - buf->ptr;\n\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, strlen_a, strlen_b);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, need_sep);\n\tGITERR_CHECK_ALLOC_ADD(&alloc_len, alloc_len, 1);\n\tif (git_buf_grow(buf, alloc_len) < 0)\n\t\treturn -1;\n\tassert(buf->ptr);\n\n\t/* fix up internal pointers */\n\tif (offset_a >= 0)\n\t\tstr_a = buf->ptr + offset_a;\n\n\t/* do the actual copying */\n\tif (offset_a != 0 && str_a)\n\t\tmemmove(buf->ptr, str_a, strlen_a);\n\tif (need_sep)\n\t\tbuf->ptr[strlen_a] = separator;\n\tmemcpy(buf->ptr + strlen_a + need_sep, str_b, strlen_b);\n\n\tbuf->size = strlen_a + strlen_b + need_sep;\n\tbuf->ptr[buf->size] = '\\0';\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_make_relative",
          "args": [
            "&path_to_repo",
            "in_dir"
          ],
          "line": 1369
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_make_relative",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "813-872",
          "snippet": "int git_path_make_relative(git_buf *path, const char *parent)\n{\n\tconst char *p, *q, *p_dirsep, *q_dirsep;\n\tsize_t plen = path->size, newlen, alloclen, depth = 1, i, offset;\n\n\tfor (p_dirsep = p = path->ptr, q_dirsep = q = parent; *p && *q; p++, q++) {\n\t\tif (*p == '/' && *q == '/') {\n\t\t\tp_dirsep = p;\n\t\t\tq_dirsep = q;\n\t\t}\n\t\telse if (*p != *q)\n\t\t\tbreak;\n\t}\n\n\t/* need at least 1 common path segment */\n\tif ((p_dirsep == path->ptr || q_dirsep == parent) &&\n\t\t(*p_dirsep != '/' || *q_dirsep != '/')) {\n\t\tgiterr_set(GITERR_INVALID,\n\t\t\t\"%s is not a parent of %s\", parent, path->ptr);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (*p == '/' && !*q)\n\t\tp++;\n\telse if (!*p && *q == '/')\n\t\tq++;\n\telse if (!*p && !*q)\n\t\treturn git_buf_clear(path), 0;\n\telse {\n\t\tp = p_dirsep + 1;\n\t\tq = q_dirsep + 1;\n\t}\n\n\tplen -= (p - path->ptr);\n\n\tif (!*q)\n\t\treturn git_buf_set(path, p, plen);\n\n\tfor (; (q = strchr(q, '/')) && *(q + 1); q++)\n\t\tdepth++;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&newlen, depth, 3);\n\tGITERR_CHECK_ALLOC_ADD(&newlen, newlen, plen);\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, newlen, 1);\n\n\t/* save the offset as we might realllocate the pointer */\n\toffset = p - path->ptr;\n\tif (git_buf_try_grow(path, alloclen, 1) < 0)\n\t\treturn -1;\n\tp = path->ptr + offset;\n\n\tmemmove(path->ptr + (depth * 3), p, plen + 1);\n\n\tfor (i = 0; i < depth; i++)\n\t\tmemcpy(path->ptr + (i * 3), \"../\", 3);\n\n\tpath->size = newlen;\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_make_relative(git_buf *path, const char *parent)\n{\n\tconst char *p, *q, *p_dirsep, *q_dirsep;\n\tsize_t plen = path->size, newlen, alloclen, depth = 1, i, offset;\n\n\tfor (p_dirsep = p = path->ptr, q_dirsep = q = parent; *p && *q; p++, q++) {\n\t\tif (*p == '/' && *q == '/') {\n\t\t\tp_dirsep = p;\n\t\t\tq_dirsep = q;\n\t\t}\n\t\telse if (*p != *q)\n\t\t\tbreak;\n\t}\n\n\t/* need at least 1 common path segment */\n\tif ((p_dirsep == path->ptr || q_dirsep == parent) &&\n\t\t(*p_dirsep != '/' || *q_dirsep != '/')) {\n\t\tgiterr_set(GITERR_INVALID,\n\t\t\t\"%s is not a parent of %s\", parent, path->ptr);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (*p == '/' && !*q)\n\t\tp++;\n\telse if (!*p && *q == '/')\n\t\tq++;\n\telse if (!*p && !*q)\n\t\treturn git_buf_clear(path), 0;\n\telse {\n\t\tp = p_dirsep + 1;\n\t\tq = q_dirsep + 1;\n\t}\n\n\tplen -= (p - path->ptr);\n\n\tif (!*q)\n\t\treturn git_buf_set(path, p, plen);\n\n\tfor (; (q = strchr(q, '/')) && *(q + 1); q++)\n\t\tdepth++;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&newlen, depth, 3);\n\tGITERR_CHECK_ALLOC_ADD(&newlen, newlen, plen);\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, newlen, 1);\n\n\t/* save the offset as we might realllocate the pointer */\n\toffset = p - path->ptr;\n\tif (git_buf_try_grow(path, alloclen, 1) < 0)\n\t\treturn -1;\n\tp = path->ptr + offset;\n\n\tmemmove(path->ptr + (depth * 3), p, plen + 1);\n\n\tfor (i = 0; i < depth; i++)\n\t\tmemcpy(path->ptr + (i * 3), \"../\", 3);\n\n\tpath->size = newlen;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sets",
          "args": [
            "&path_to_repo",
            "to_repo"
          ],
          "line": 1366
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "181-184",
          "snippet": "int git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "&buf"
          ],
          "line": 1364
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"Cannot overwrite gitlink file into path '%s'\"",
            "in_dir"
          ],
          "line": 1358
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "st.st_mode"
          ],
          "line": 1357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_stat",
          "args": [
            "buf.ptr",
            "&st"
          ],
          "line": 1357
        },
        "resolved": true,
        "details": {
          "function_name": "p_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "417-432",
          "snippet": "int p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&buf",
            "in_dir",
            "DOT_GIT"
          ],
          "line": 1354
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "in_dir",
            "buf.ptr"
          ],
          "line": 1348
        },
        "resolved": true,
        "details": {
          "function_name": "git__strcmp_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "562-565",
          "snippet": "int git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strcmp_cb(const void *a, const void *b)\n{\n\treturn strcmp((const char *)a, (const char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__suffixcmp",
          "args": [
            "to_repo",
            "\"/\" DOT_GIT \"/\""
          ],
          "line": 1347
        },
        "resolved": true,
        "details": {
          "function_name": "git__suffixcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "272-279",
          "snippet": "int git__suffixcmp(const char *str, const char *suffix)\n{\n\tsize_t a = strlen(str);\n\tsize_t b = strlen(suffix);\n\tif (a < b)\n\t\treturn -1;\n\treturn strcmp(str + (a - b), suffix);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__suffixcmp(const char *str, const char *suffix)\n{\n\tsize_t a = strlen(str);\n\tsize_t b = strlen(suffix);\n\tif (a < b)\n\t\treturn -1;\n\treturn strcmp(str + (a - b), suffix);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "&buf"
          ],
          "line": 1343
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_to_dir",
          "args": [
            "&buf"
          ],
          "line": 1342
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_to_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "341-349",
          "snippet": "int git_path_to_dir(git_buf *path)\n{\n\tif (path->asize > 0 &&\n\t\tgit_buf_len(path) > 0 &&\n\t\tpath->ptr[git_buf_len(path) - 1] != '/')\n\t\tgit_buf_putc(path, '/');\n\n\treturn git_buf_oom(path) ? -1 : 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_to_dir(git_buf *path)\n{\n\tif (path->asize > 0 &&\n\t\tgit_buf_len(path) > 0 &&\n\t\tpath->ptr[git_buf_len(path) - 1] != '/')\n\t\tgit_buf_putc(path, '/');\n\n\treturn git_buf_oom(path) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_dirname_r",
          "args": [
            "&buf",
            "to_repo"
          ],
          "line": 1341
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_dirname_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "117-178",
          "snippet": "int git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_FILE_CONTENT_PREFIX \"gitdir:\"\n\nstatic int repo_write_gitlink(\n\tconst char *in_dir, const char *to_repo, bool use_relative_path)\n{\n\tint error;\n\tgit_buf buf = GIT_BUF_INIT;\n\tgit_buf path_to_repo = GIT_BUF_INIT;\n\tstruct stat st;\n\n\tgit_path_dirname_r(&buf, to_repo);\n\tgit_path_to_dir(&buf);\n\tif (git_buf_oom(&buf))\n\t\treturn -1;\n\n\t/* don't write gitlink to natural workdir */\n\tif (git__suffixcmp(to_repo, \"/\" DOT_GIT \"/\") == 0 &&\n\t\tstrcmp(in_dir, buf.ptr) == 0)\n\t{\n\t\terror = GIT_PASSTHROUGH;\n\t\tgoto cleanup;\n\t}\n\n\tif ((error = git_buf_joinpath(&buf, in_dir, DOT_GIT)) < 0)\n\t\tgoto cleanup;\n\n\tif (!p_stat(buf.ptr, &st) && !S_ISREG(st.st_mode)) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Cannot overwrite gitlink file into path '%s'\", in_dir);\n\t\terror = GIT_EEXISTS;\n\t\tgoto cleanup;\n\t}\n\n\tgit_buf_clear(&buf);\n\n\terror = git_buf_sets(&path_to_repo, to_repo);\n\n\tif (!error && use_relative_path)\n\t\terror = git_path_make_relative(&path_to_repo, in_dir);\n\n\tif (!error)\n\t\terror = git_buf_join(&buf, ' ', GIT_FILE_CONTENT_PREFIX, path_to_repo.ptr);\n\n\tif (!error)\n\t\terror = repo_write_template(in_dir, true, DOT_GIT, 0666, true, buf.ptr);\n\ncleanup:\n\tgit_buf_free(&buf);\n\tgit_buf_free(&path_to_repo);\n\treturn error;\n}"
  },
  {
    "function_name": "repo_write_template",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1286-1331",
    "snippet": "static int repo_write_template(\n\tconst char *git_dir,\n\tbool allow_overwrite,\n\tconst char *file,\n\tmode_t mode,\n\tbool hidden,\n\tconst char *content)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd, error = 0, flags;\n\n\tif (git_buf_joinpath(&path, git_dir, file) < 0)\n\t\treturn -1;\n\n\tif (allow_overwrite)\n\t\tflags = O_WRONLY | O_CREAT | O_TRUNC;\n\telse\n\t\tflags = O_WRONLY | O_CREAT | O_EXCL;\n\n\tfd = p_open(git_buf_cstr(&path), flags, mode);\n\n\tif (fd >= 0) {\n\t\terror = p_write(fd, content, strlen(content));\n\n\t\tp_close(fd);\n\t}\n\telse if (errno != EEXIST)\n\t\terror = fd;\n\n#ifdef GIT_WIN32\n\tif (!error && hidden) {\n\t\tif (git_win32__set_hidden(path.ptr, true) < 0)\n\t\t\terror = -1;\n\t}\n#else\n\tGIT_UNUSED(hidden);\n#endif\n\n\tgit_buf_free(&path);\n\n\tif (error)\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to initialize repository with template '%s'\", file);\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Failed to initialize repository with template '%s'\"",
            "file"
          ],
          "line": 1327
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 1324
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "hidden"
          ],
          "line": 1321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_win32__set_hidden",
          "args": [
            "path.ptr",
            "true"
          ],
          "line": 1317
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32__set_hidden",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/w32_util.c",
          "lines": "51-77",
          "snippet": "int git_win32__set_hidden(const char *path, bool hidden)\n{\n\tgit_win32_path buf;\n\tDWORD attrs, newattrs;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\tattrs = GetFileAttributesW(buf);\n\n\t/* Ensure the path exists */\n\tif (attrs == INVALID_FILE_ATTRIBUTES)\n\t\treturn -1;\n\n\tif (hidden)\n\t\tnewattrs = attrs | FILE_ATTRIBUTE_HIDDEN;\n\telse\n\t\tnewattrs = attrs & ~FILE_ATTRIBUTE_HIDDEN;\n\n\tif (attrs != newattrs && !SetFileAttributesW(buf, newattrs)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to %s hidden bit for '%s'\",\n\t\t\thidden ? \"set\" : \"unset\", path);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"w32_util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"w32_util.h\"\n\nint git_win32__set_hidden(const char *path, bool hidden)\n{\n\tgit_win32_path buf;\n\tDWORD attrs, newattrs;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\tattrs = GetFileAttributesW(buf);\n\n\t/* Ensure the path exists */\n\tif (attrs == INVALID_FILE_ATTRIBUTES)\n\t\treturn -1;\n\n\tif (hidden)\n\t\tnewattrs = attrs | FILE_ATTRIBUTE_HIDDEN;\n\telse\n\t\tnewattrs = attrs & ~FILE_ATTRIBUTE_HIDDEN;\n\n\tif (attrs != newattrs && !SetFileAttributesW(buf, newattrs)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to %s hidden bit for '%s'\",\n\t\t\thidden ? \"set\" : \"unset\", path);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_close",
          "args": [
            "fd"
          ],
          "line": 1310
        },
        "resolved": true,
        "details": {
          "function_name": "winhttp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/winhttp.c",
          "lines": "1359-1377",
          "snippet": "static int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}",
          "includes": [
            "#include <urlmon.h>",
            "#include <objbase.h>",
            "#include <winhttp.h>",
            "#include <wincrypt.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"remote.h\"",
            "#include \"smart.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <urlmon.h>\n#include <objbase.h>\n#include <winhttp.h>\n#include <wincrypt.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"remote.h\"\n#include \"smart.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"git2.h\"\n\nstatic int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_write",
          "args": [
            "fd",
            "content",
            "strlen(content)"
          ],
          "line": 1308
        },
        "resolved": true,
        "details": {
          "function_name": "p_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "189-214",
          "snippet": "int p_write(git_file fd, const void *buf, size_t cnt)\n{\n\tconst char *b = buf;\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tassert((size_t)((unsigned int)cnt) == cnt);\n\t\tr = write(fd, b, (unsigned int)cnt);\n#else\n\t\tr = write(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || GIT_ISBLOCKED(errno))\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r) {\n\t\t\terrno = EPIPE;\n\t\t\treturn -1;\n\t\t}\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_write(git_file fd, const void *buf, size_t cnt)\n{\n\tconst char *b = buf;\n\n\twhile (cnt) {\n\t\tssize_t r;\n#ifdef GIT_WIN32\n\t\tassert((size_t)((unsigned int)cnt) == cnt);\n\t\tr = write(fd, b, (unsigned int)cnt);\n#else\n\t\tr = write(fd, b, cnt);\n#endif\n\t\tif (r < 0) {\n\t\t\tif (errno == EINTR || GIT_ISBLOCKED(errno))\n\t\t\t\tcontinue;\n\t\t\treturn -1;\n\t\t}\n\t\tif (!r) {\n\t\t\terrno = EPIPE;\n\t\t\treturn -1;\n\t\t}\n\t\tcnt -= r;\n\t\tb += r;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "content"
          ],
          "line": 1308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_open",
          "args": [
            "git_buf_cstr(&path)",
            "flags",
            "mode"
          ],
          "line": 1305
        },
        "resolved": true,
        "details": {
          "function_name": "p_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "105-118",
          "snippet": "int p_open(const char *path, volatile int flags, ...)\n{\n\tmode_t mode = 0;\n\n\tif (flags & O_CREAT) {\n\t\tva_list arg_list;\n\n\t\tva_start(arg_list, flags);\n\t\tmode = (mode_t)va_arg(arg_list, int);\n\t\tva_end(arg_list);\n\t}\n\n\treturn open(path, flags | O_BINARY | O_CLOEXEC, mode);\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_open(const char *path, volatile int flags, ...)\n{\n\tmode_t mode = 0;\n\n\tif (flags & O_CREAT) {\n\t\tva_list arg_list;\n\n\t\tva_start(arg_list, flags);\n\t\tmode = (mode_t)va_arg(arg_list, int);\n\t\tva_end(arg_list);\n\t}\n\n\treturn open(path, flags | O_BINARY | O_CLOEXEC, mode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&path"
          ],
          "line": 1305
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "git_dir",
            "file"
          ],
          "line": 1297
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_write_template(\n\tconst char *git_dir,\n\tbool allow_overwrite,\n\tconst char *file,\n\tmode_t mode,\n\tbool hidden,\n\tconst char *content)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd, error = 0, flags;\n\n\tif (git_buf_joinpath(&path, git_dir, file) < 0)\n\t\treturn -1;\n\n\tif (allow_overwrite)\n\t\tflags = O_WRONLY | O_CREAT | O_TRUNC;\n\telse\n\t\tflags = O_WRONLY | O_CREAT | O_EXCL;\n\n\tfd = p_open(git_buf_cstr(&path), flags, mode);\n\n\tif (fd >= 0) {\n\t\terror = p_write(fd, content, strlen(content));\n\n\t\tp_close(fd);\n\t}\n\telse if (errno != EEXIST)\n\t\terror = fd;\n\n#ifdef GIT_WIN32\n\tif (!error && hidden) {\n\t\tif (git_win32__set_hidden(path.ptr, true) < 0)\n\t\t\terror = -1;\n\t}\n#else\n\tGIT_UNUSED(hidden);\n#endif\n\n\tgit_buf_free(&path);\n\n\tif (error)\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to initialize repository with template '%s'\", file);\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_reinit_filesystem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1264-1284",
    "snippet": "int git_repository_reinit_filesystem(git_repository *repo, int recurse)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_config *config = NULL;\n\tconst char *repo_dir = git_repository_path(repo);\n\n\tif (!(error = repo_local_config(&config, &path, repo, repo_dir)))\n\t\terror = repo_init_fs_configs(\n\t\t\tconfig, path.ptr, repo_dir, git_repository_workdir(repo), true);\n\n\tgit_config_free(config);\n\tgit_buf_free(&path);\n\n\tgit_repository__cvar_cache_clear(repo);\n\n\tif (!repo->is_bare && recurse)\n\t\t(void)git_submodule_foreach(repo, repo_reinit_submodule_fs, NULL);\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_submodule_foreach",
          "args": [
            "repo",
            "repo_reinit_submodule_fs",
            "NULL"
          ],
          "line": 1281
        },
        "resolved": true,
        "details": {
          "function_name": "git_submodule_foreach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/submodule.c",
          "lines": "497-547",
          "snippet": "int git_submodule_foreach(\n\tgit_repository *repo,\n\tgit_submodule_cb callback,\n\tvoid *payload)\n{\n\tgit_vector snapshot = GIT_VECTOR_INIT;\n\tgit_strmap *submodules;\n\tgit_submodule *sm;\n\tint error;\n\tsize_t i;\n\n\tif ((error = git_strmap_alloc(&submodules)) < 0)\n\t\treturn error;\n\n\tif ((error = all_submodules(repo, submodules)) < 0)\n\t\tgoto done;\n\n\tif (!(error = git_vector_init(\n\t\t\t&snapshot, kh_size(submodules), submodule_cmp))) {\n\n\t\tgit_strmap_foreach_value(submodules, sm, {\n\t\t\tif ((error = git_vector_insert(&snapshot, sm)) < 0)\n\t\t\t\tbreak;\n\t\t\tGIT_REFCOUNT_INC(sm);\n\t\t});\n\t}\n\n\tif (error < 0)\n\t\tgoto done;\n\n\tgit_vector_uniq(&snapshot, submodule_free_dup);\n\n\tgit_vector_foreach(&snapshot, i, sm) {\n\t\tif ((error = callback(sm, sm->name, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\ndone:\n\tgit_vector_foreach(&snapshot, i, sm)\n\t\tgit_submodule_free(sm);\n\tgit_vector_free(&snapshot);\n\n\tgit_strmap_foreach_value(submodules, sm, {\n\t\tgit_submodule_free(sm);\n\t});\n\tgit_strmap_free(submodules);\n\n\treturn error;\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"path.h\"",
            "#include \"iterator.h\"",
            "#include \"tree.h\"",
            "#include \"submodule.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"config_file.h\"",
            "#include \"posix.h\"",
            "#include \"vector.h\"",
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/types.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int submodule_alloc(git_submodule **out, git_repository *repo, const char *name);",
            "static git_config *gitmodules_snapshot(git_repository *repo);",
            "static int get_url_base(git_buf *url, git_repository *repo);",
            "static int lookup_head_remote_key(git_buf *remote_key, git_repository *repo);",
            "static int submodule_load_each(const git_config_entry *entry, void *payload);",
            "static int submodule_load_from_wd_lite(git_submodule *);",
            "static void submodule_get_index_status(unsigned int *, git_submodule *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"path.h\"\n#include \"iterator.h\"\n#include \"tree.h\"\n#include \"submodule.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"config_file.h\"\n#include \"posix.h\"\n#include \"vector.h\"\n#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"git2/index.h\"\n#include \"git2/types.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"common.h\"\n\nstatic int submodule_alloc(git_submodule **out, git_repository *repo, const char *name);\nstatic git_config *gitmodules_snapshot(git_repository *repo);\nstatic int get_url_base(git_buf *url, git_repository *repo);\nstatic int lookup_head_remote_key(git_buf *remote_key, git_repository *repo);\nstatic int submodule_load_each(const git_config_entry *entry, void *payload);\nstatic int submodule_load_from_wd_lite(git_submodule *);\nstatic void submodule_get_index_status(unsigned int *, git_submodule *);\n\nint git_submodule_foreach(\n\tgit_repository *repo,\n\tgit_submodule_cb callback,\n\tvoid *payload)\n{\n\tgit_vector snapshot = GIT_VECTOR_INIT;\n\tgit_strmap *submodules;\n\tgit_submodule *sm;\n\tint error;\n\tsize_t i;\n\n\tif ((error = git_strmap_alloc(&submodules)) < 0)\n\t\treturn error;\n\n\tif ((error = all_submodules(repo, submodules)) < 0)\n\t\tgoto done;\n\n\tif (!(error = git_vector_init(\n\t\t\t&snapshot, kh_size(submodules), submodule_cmp))) {\n\n\t\tgit_strmap_foreach_value(submodules, sm, {\n\t\t\tif ((error = git_vector_insert(&snapshot, sm)) < 0)\n\t\t\t\tbreak;\n\t\t\tGIT_REFCOUNT_INC(sm);\n\t\t});\n\t}\n\n\tif (error < 0)\n\t\tgoto done;\n\n\tgit_vector_uniq(&snapshot, submodule_free_dup);\n\n\tgit_vector_foreach(&snapshot, i, sm) {\n\t\tif ((error = callback(sm, sm->name, payload)) != 0) {\n\t\t\tgiterr_set_after_callback(error);\n\t\t\tbreak;\n\t\t}\n\t}\n\ndone:\n\tgit_vector_foreach(&snapshot, i, sm)\n\t\tgit_submodule_free(sm);\n\tgit_vector_free(&snapshot);\n\n\tgit_strmap_foreach_value(submodules, sm, {\n\t\tgit_submodule_free(sm);\n\t});\n\tgit_strmap_free(submodules);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository__cvar_cache_clear",
          "args": [
            "repo"
          ],
          "line": 1278
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__cvar_cache_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
          "lines": "122-128",
          "snippet": "void git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"vector.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"repository.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "config"
          ],
          "line": 1275
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_init_fs_configs",
          "args": [
            "config",
            "path.ptr",
            "repo_dir",
            "git_repository_workdir(repo)",
            "true"
          ],
          "line": 1272
        },
        "resolved": true,
        "details": {
          "function_name": "repo_init_fs_configs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1146-1185",
          "snippet": "static int repo_init_fs_configs(\n\tgit_config *cfg,\n\tconst char *cfg_path,\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tbool update_ignorecase)\n{\n\tint error = 0;\n\n\tif (!work_dir)\n\t\twork_dir = repo_dir;\n\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.filemode\", is_chmod_supported(cfg_path))) < 0)\n\t\treturn error;\n\n\tif (!are_symlinks_supported(work_dir)) {\n\t\tif ((error = git_config_set_bool(cfg, \"core.symlinks\", false)) < 0)\n\t\t\treturn error;\n\t} else if (git_config_delete_entry(cfg, \"core.symlinks\") < 0)\n\t\tgiterr_clear();\n\n\tif (update_ignorecase) {\n\t\tif (is_filesystem_case_insensitive(repo_dir)) {\n\t\t\tif ((error = git_config_set_bool(cfg, \"core.ignorecase\", true)) < 0)\n\t\t\t\treturn error;\n\t\t} else if (git_config_delete_entry(cfg, \"core.ignorecase\") < 0)\n\t\t\tgiterr_clear();\n\t}\n\n#ifdef GIT_USE_ICONV\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.precomposeunicode\",\n\t\t\tgit_path_does_fs_decompose_unicode(work_dir))) < 0)\n\t\treturn error;\n\t/* on non-iconv platforms, don't even set core.precomposeunicode */\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_init_fs_configs(\n\tgit_config *cfg,\n\tconst char *cfg_path,\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tbool update_ignorecase)\n{\n\tint error = 0;\n\n\tif (!work_dir)\n\t\twork_dir = repo_dir;\n\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.filemode\", is_chmod_supported(cfg_path))) < 0)\n\t\treturn error;\n\n\tif (!are_symlinks_supported(work_dir)) {\n\t\tif ((error = git_config_set_bool(cfg, \"core.symlinks\", false)) < 0)\n\t\t\treturn error;\n\t} else if (git_config_delete_entry(cfg, \"core.symlinks\") < 0)\n\t\tgiterr_clear();\n\n\tif (update_ignorecase) {\n\t\tif (is_filesystem_case_insensitive(repo_dir)) {\n\t\t\tif ((error = git_config_set_bool(cfg, \"core.ignorecase\", true)) < 0)\n\t\t\t\treturn error;\n\t\t} else if (git_config_delete_entry(cfg, \"core.ignorecase\") < 0)\n\t\t\tgiterr_clear();\n\t}\n\n#ifdef GIT_USE_ICONV\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.precomposeunicode\",\n\t\t\tgit_path_does_fs_decompose_unicode(work_dir))) < 0)\n\t\treturn error;\n\t/* on non-iconv platforms, don't even set core.precomposeunicode */\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_workdir",
          "args": [
            "repo"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_workdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1828-1836",
          "snippet": "const char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_workdir(git_repository *repo)\n{\n\tassert(repo);\n\n\tif (repo->is_bare)\n\t\treturn NULL;\n\n\treturn repo->workdir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_local_config",
          "args": [
            "&config",
            "&path",
            "repo",
            "repo_dir"
          ],
          "line": 1271
        },
        "resolved": true,
        "details": {
          "function_name": "repo_local_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1106-1144",
          "snippet": "static int repo_local_config(\n\tgit_config **out,\n\tgit_buf *config_dir,\n\tgit_repository *repo,\n\tconst char *repo_dir)\n{\n\tint error = 0;\n\tgit_config *parent;\n\tconst char *cfg_path;\n\n\tif (git_buf_joinpath(config_dir, repo_dir, GIT_CONFIG_FILENAME_INREPO) < 0)\n\t\treturn -1;\n\tcfg_path = git_buf_cstr(config_dir);\n\n\t/* make LOCAL config if missing */\n\tif (!git_path_isfile(cfg_path) &&\n\t\t(error = create_empty_file(cfg_path, GIT_CONFIG_FILE_MODE)) < 0)\n\t\treturn error;\n\n\t/* if no repo, just open that file directly */\n\tif (!repo)\n\t\treturn git_config_open_ondisk(out, cfg_path);\n\n\t/* otherwise, open parent config and get that level */\n\tif ((error = git_repository_config__weakptr(&parent, repo)) < 0)\n\t\treturn error;\n\n\tif (git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL) < 0) {\n\t\tgiterr_clear();\n\n\t\tif (!(error = git_config_add_file_ondisk(\n\t\t\t\tparent, cfg_path, GIT_CONFIG_LEVEL_LOCAL, false)))\n\t\t\terror = git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL);\n\t}\n\n\tgit_config_free(parent);\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int repo_local_config(\n\tgit_config **out,\n\tgit_buf *config_dir,\n\tgit_repository *repo,\n\tconst char *repo_dir)\n{\n\tint error = 0;\n\tgit_config *parent;\n\tconst char *cfg_path;\n\n\tif (git_buf_joinpath(config_dir, repo_dir, GIT_CONFIG_FILENAME_INREPO) < 0)\n\t\treturn -1;\n\tcfg_path = git_buf_cstr(config_dir);\n\n\t/* make LOCAL config if missing */\n\tif (!git_path_isfile(cfg_path) &&\n\t\t(error = create_empty_file(cfg_path, GIT_CONFIG_FILE_MODE)) < 0)\n\t\treturn error;\n\n\t/* if no repo, just open that file directly */\n\tif (!repo)\n\t\treturn git_config_open_ondisk(out, cfg_path);\n\n\t/* otherwise, open parent config and get that level */\n\tif ((error = git_repository_config__weakptr(&parent, repo)) < 0)\n\t\treturn error;\n\n\tif (git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL) < 0) {\n\t\tgiterr_clear();\n\n\t\tif (!(error = git_config_add_file_ondisk(\n\t\t\t\tparent, cfg_path, GIT_CONFIG_LEVEL_LOCAL, false)))\n\t\t\terror = git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL);\n\t}\n\n\tgit_config_free(parent);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_path",
          "args": [
            "repo"
          ],
          "line": 1269
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1822-1826",
          "snippet": "const char *git_repository_path(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->path_repository;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_path(git_repository *repo)\n{\n\tassert(repo);\n\treturn repo->path_repository;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_reinit_filesystem(git_repository *repo, int recurse)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_config *config = NULL;\n\tconst char *repo_dir = git_repository_path(repo);\n\n\tif (!(error = repo_local_config(&config, &path, repo, repo_dir)))\n\t\terror = repo_init_fs_configs(\n\t\t\tconfig, path.ptr, repo_dir, git_repository_workdir(repo), true);\n\n\tgit_config_free(config);\n\tgit_buf_free(&path);\n\n\tgit_repository__cvar_cache_clear(repo);\n\n\tif (!repo->is_bare && recurse)\n\t\t(void)git_submodule_foreach(repo, repo_reinit_submodule_fs, NULL);\n\n\treturn error;\n}"
  },
  {
    "function_name": "repo_reinit_submodule_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1251-1262",
    "snippet": "static int repo_reinit_submodule_fs(git_submodule *sm, const char *n, void *p)\n{\n\tgit_repository *smrepo = NULL;\n\tGIT_UNUSED(n); GIT_UNUSED(p);\n\n\tif (git_submodule_open(&smrepo, sm) < 0 ||\n\t\tgit_repository_reinit_filesystem(smrepo, true) < 0)\n\t\tgiterr_clear();\n\tgit_repository_free(smrepo);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_repository_free",
          "args": [
            "smrepo"
          ],
          "line": 1259
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "121-148",
          "snippet": "void git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 1258
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_reinit_filesystem",
          "args": [
            "smrepo",
            "true"
          ],
          "line": 1257
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_reinit_filesystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1264-1284",
          "snippet": "int git_repository_reinit_filesystem(git_repository *repo, int recurse)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_config *config = NULL;\n\tconst char *repo_dir = git_repository_path(repo);\n\n\tif (!(error = repo_local_config(&config, &path, repo, repo_dir)))\n\t\terror = repo_init_fs_configs(\n\t\t\tconfig, path.ptr, repo_dir, git_repository_workdir(repo), true);\n\n\tgit_config_free(config);\n\tgit_buf_free(&path);\n\n\tgit_repository__cvar_cache_clear(repo);\n\n\tif (!repo->is_bare && recurse)\n\t\t(void)git_submodule_foreach(repo, repo_reinit_submodule_fs, NULL);\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_reinit_filesystem(git_repository *repo, int recurse)\n{\n\tint error = 0;\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_config *config = NULL;\n\tconst char *repo_dir = git_repository_path(repo);\n\n\tif (!(error = repo_local_config(&config, &path, repo, repo_dir)))\n\t\terror = repo_init_fs_configs(\n\t\t\tconfig, path.ptr, repo_dir, git_repository_workdir(repo), true);\n\n\tgit_config_free(config);\n\tgit_buf_free(&path);\n\n\tgit_repository__cvar_cache_clear(repo);\n\n\tif (!repo->is_bare && recurse)\n\t\t(void)git_submodule_foreach(repo, repo_reinit_submodule_fs, NULL);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_submodule_open",
          "args": [
            "&smrepo",
            "sm"
          ],
          "line": 1256
        },
        "resolved": true,
        "details": {
          "function_name": "git_submodule_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/submodule.c",
          "lines": "1349-1352",
          "snippet": "int git_submodule_open(git_repository **subrepo, git_submodule *sm)\n{\n\treturn git_submodule__open(subrepo, sm, false);\n}",
          "includes": [
            "#include \"index.h\"",
            "#include \"path.h\"",
            "#include \"iterator.h\"",
            "#include \"tree.h\"",
            "#include \"submodule.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"config_file.h\"",
            "#include \"posix.h\"",
            "#include \"vector.h\"",
            "#include \"buf_text.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/index.h\"",
            "#include \"git2/types.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int submodule_load_from_wd_lite(git_submodule *);",
            "static void submodule_get_index_status(unsigned int *, git_submodule *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"index.h\"\n#include \"path.h\"\n#include \"iterator.h\"\n#include \"tree.h\"\n#include \"submodule.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"config_file.h\"\n#include \"posix.h\"\n#include \"vector.h\"\n#include \"buf_text.h\"\n#include \"buffer.h\"\n#include \"git2/index.h\"\n#include \"git2/types.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"common.h\"\n\nstatic int submodule_load_from_wd_lite(git_submodule *);\nstatic void submodule_get_index_status(unsigned int *, git_submodule *);\n\nint git_submodule_open(git_repository **subrepo, git_submodule *sm)\n{\n\treturn git_submodule__open(subrepo, sm, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "p"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "n"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_reinit_submodule_fs(git_submodule *sm, const char *n, void *p)\n{\n\tgit_repository *smrepo = NULL;\n\tGIT_UNUSED(n); GIT_UNUSED(p);\n\n\tif (git_submodule_open(&smrepo, sm) < 0 ||\n\t\tgit_repository_reinit_filesystem(smrepo, true) < 0)\n\t\tgiterr_clear();\n\tgit_repository_free(smrepo);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "repo_init_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1187-1249",
    "snippet": "static int repo_init_config(\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tuint32_t flags,\n\tuint32_t mode)\n{\n\tint error = 0;\n\tgit_buf cfg_path = GIT_BUF_INIT, worktree_path = GIT_BUF_INIT;\n\tgit_config *config = NULL;\n\tbool is_bare = ((flags & GIT_REPOSITORY_INIT_BARE) != 0);\n\tbool is_reinit = ((flags & GIT_REPOSITORY_INIT__IS_REINIT) != 0);\n\n\tif ((error = repo_local_config(&config, &cfg_path, NULL, repo_dir)) < 0)\n\t\tgoto cleanup;\n\n\tif (is_reinit && (error = check_repositoryformatversion(config)) < 0)\n\t\tgoto cleanup;\n\n#define SET_REPO_CONFIG(TYPE, NAME, VAL) do { \\\n\tif ((error = git_config_set_##TYPE(config, NAME, VAL)) < 0) \\\n\t\tgoto cleanup; } while (0)\n\n\tSET_REPO_CONFIG(bool, \"core.bare\", is_bare);\n\tSET_REPO_CONFIG(int32, \"core.repositoryformatversion\", GIT_REPO_VERSION);\n\n\tif ((error = repo_init_fs_configs(\n\t\t\tconfig, cfg_path.ptr, repo_dir, work_dir, !is_reinit)) < 0)\n\t\tgoto cleanup;\n\n\tif (!is_bare) {\n\t\tSET_REPO_CONFIG(bool, \"core.logallrefupdates\", true);\n\n\t\tif (!(flags & GIT_REPOSITORY_INIT__NATURAL_WD)) {\n\t\t\tif ((error = git_buf_sets(&worktree_path, work_dir)) < 0)\n\t\t\t\tgoto cleanup;\n\n\t\t\tif ((flags & GIT_REPOSITORY_INIT_RELATIVE_GITLINK))\n\t\t\t\tif ((error = git_path_make_relative(&worktree_path, repo_dir)) < 0)\n\t\t\t\t\tgoto cleanup;\n\n\t\t\tSET_REPO_CONFIG(string, \"core.worktree\", worktree_path.ptr);\n\t\t} else if (is_reinit) {\n\t\t\tif (git_config_delete_entry(config, \"core.worktree\") < 0)\n\t\t\t\tgiterr_clear();\n\t\t}\n\t}\n\n\tif (mode == GIT_REPOSITORY_INIT_SHARED_GROUP) {\n\t\tSET_REPO_CONFIG(int32, \"core.sharedrepository\", 1);\n\t\tSET_REPO_CONFIG(bool, \"receive.denyNonFastforwards\", true);\n\t}\n\telse if (mode == GIT_REPOSITORY_INIT_SHARED_ALL) {\n\t\tSET_REPO_CONFIG(int32, \"core.sharedrepository\", 2);\n\t\tSET_REPO_CONFIG(bool, \"receive.denyNonFastforwards\", true);\n\t}\n\ncleanup:\n\tgit_buf_free(&cfg_path);\n\tgit_buf_free(&worktree_path);\n\tgit_config_free(config);\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [
      "#define GIT_REPO_VERSION 0"
    ],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "config"
          ],
          "line": 1246
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&worktree_path"
          ],
          "line": 1245
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SET_REPO_CONFIG",
          "args": [
            "bool",
            "\"receive.denyNonFastforwards\"",
            "true"
          ],
          "line": 1240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_REPO_CONFIG",
          "args": [
            "int32",
            "\"core.sharedrepository\"",
            "2"
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_REPO_CONFIG",
          "args": [
            "bool",
            "\"receive.denyNonFastforwards\"",
            "true"
          ],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_REPO_CONFIG",
          "args": [
            "int32",
            "\"core.sharedrepository\"",
            "1"
          ],
          "line": 1235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_delete_entry",
          "args": [
            "config",
            "\"core.worktree\""
          ],
          "line": 1229
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_delete_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "586-597",
          "snippet": "int git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SET_REPO_CONFIG",
          "args": [
            "string",
            "\"core.worktree\"",
            "worktree_path.ptr"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_path_make_relative",
          "args": [
            "&worktree_path",
            "repo_dir"
          ],
          "line": 1224
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_make_relative",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "813-872",
          "snippet": "int git_path_make_relative(git_buf *path, const char *parent)\n{\n\tconst char *p, *q, *p_dirsep, *q_dirsep;\n\tsize_t plen = path->size, newlen, alloclen, depth = 1, i, offset;\n\n\tfor (p_dirsep = p = path->ptr, q_dirsep = q = parent; *p && *q; p++, q++) {\n\t\tif (*p == '/' && *q == '/') {\n\t\t\tp_dirsep = p;\n\t\t\tq_dirsep = q;\n\t\t}\n\t\telse if (*p != *q)\n\t\t\tbreak;\n\t}\n\n\t/* need at least 1 common path segment */\n\tif ((p_dirsep == path->ptr || q_dirsep == parent) &&\n\t\t(*p_dirsep != '/' || *q_dirsep != '/')) {\n\t\tgiterr_set(GITERR_INVALID,\n\t\t\t\"%s is not a parent of %s\", parent, path->ptr);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (*p == '/' && !*q)\n\t\tp++;\n\telse if (!*p && *q == '/')\n\t\tq++;\n\telse if (!*p && !*q)\n\t\treturn git_buf_clear(path), 0;\n\telse {\n\t\tp = p_dirsep + 1;\n\t\tq = q_dirsep + 1;\n\t}\n\n\tplen -= (p - path->ptr);\n\n\tif (!*q)\n\t\treturn git_buf_set(path, p, plen);\n\n\tfor (; (q = strchr(q, '/')) && *(q + 1); q++)\n\t\tdepth++;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&newlen, depth, 3);\n\tGITERR_CHECK_ALLOC_ADD(&newlen, newlen, plen);\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, newlen, 1);\n\n\t/* save the offset as we might realllocate the pointer */\n\toffset = p - path->ptr;\n\tif (git_buf_try_grow(path, alloclen, 1) < 0)\n\t\treturn -1;\n\tp = path->ptr + offset;\n\n\tmemmove(path->ptr + (depth * 3), p, plen + 1);\n\n\tfor (i = 0; i < depth; i++)\n\t\tmemcpy(path->ptr + (i * 3), \"../\", 3);\n\n\tpath->size = newlen;\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_make_relative(git_buf *path, const char *parent)\n{\n\tconst char *p, *q, *p_dirsep, *q_dirsep;\n\tsize_t plen = path->size, newlen, alloclen, depth = 1, i, offset;\n\n\tfor (p_dirsep = p = path->ptr, q_dirsep = q = parent; *p && *q; p++, q++) {\n\t\tif (*p == '/' && *q == '/') {\n\t\t\tp_dirsep = p;\n\t\t\tq_dirsep = q;\n\t\t}\n\t\telse if (*p != *q)\n\t\t\tbreak;\n\t}\n\n\t/* need at least 1 common path segment */\n\tif ((p_dirsep == path->ptr || q_dirsep == parent) &&\n\t\t(*p_dirsep != '/' || *q_dirsep != '/')) {\n\t\tgiterr_set(GITERR_INVALID,\n\t\t\t\"%s is not a parent of %s\", parent, path->ptr);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\tif (*p == '/' && !*q)\n\t\tp++;\n\telse if (!*p && *q == '/')\n\t\tq++;\n\telse if (!*p && !*q)\n\t\treturn git_buf_clear(path), 0;\n\telse {\n\t\tp = p_dirsep + 1;\n\t\tq = q_dirsep + 1;\n\t}\n\n\tplen -= (p - path->ptr);\n\n\tif (!*q)\n\t\treturn git_buf_set(path, p, plen);\n\n\tfor (; (q = strchr(q, '/')) && *(q + 1); q++)\n\t\tdepth++;\n\n\tGITERR_CHECK_ALLOC_MULTIPLY(&newlen, depth, 3);\n\tGITERR_CHECK_ALLOC_ADD(&newlen, newlen, plen);\n\n\tGITERR_CHECK_ALLOC_ADD(&alloclen, newlen, 1);\n\n\t/* save the offset as we might realllocate the pointer */\n\toffset = p - path->ptr;\n\tif (git_buf_try_grow(path, alloclen, 1) < 0)\n\t\treturn -1;\n\tp = path->ptr + offset;\n\n\tmemmove(path->ptr + (depth * 3), p, plen + 1);\n\n\tfor (i = 0; i < depth; i++)\n\t\tmemcpy(path->ptr + (i * 3), \"../\", 3);\n\n\tpath->size = newlen;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sets",
          "args": [
            "&worktree_path",
            "work_dir"
          ],
          "line": 1220
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "181-184",
          "snippet": "int git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_sets(git_buf *buf, const char *string)\n{\n\treturn git_buf_set(buf, string, string ? strlen(string) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SET_REPO_CONFIG",
          "args": [
            "bool",
            "\"core.logallrefupdates\"",
            "true"
          ],
          "line": 1217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "repo_init_fs_configs",
          "args": [
            "config",
            "cfg_path.ptr",
            "repo_dir",
            "work_dir",
            "!is_reinit"
          ],
          "line": 1212
        },
        "resolved": true,
        "details": {
          "function_name": "repo_init_fs_configs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1146-1185",
          "snippet": "static int repo_init_fs_configs(\n\tgit_config *cfg,\n\tconst char *cfg_path,\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tbool update_ignorecase)\n{\n\tint error = 0;\n\n\tif (!work_dir)\n\t\twork_dir = repo_dir;\n\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.filemode\", is_chmod_supported(cfg_path))) < 0)\n\t\treturn error;\n\n\tif (!are_symlinks_supported(work_dir)) {\n\t\tif ((error = git_config_set_bool(cfg, \"core.symlinks\", false)) < 0)\n\t\t\treturn error;\n\t} else if (git_config_delete_entry(cfg, \"core.symlinks\") < 0)\n\t\tgiterr_clear();\n\n\tif (update_ignorecase) {\n\t\tif (is_filesystem_case_insensitive(repo_dir)) {\n\t\t\tif ((error = git_config_set_bool(cfg, \"core.ignorecase\", true)) < 0)\n\t\t\t\treturn error;\n\t\t} else if (git_config_delete_entry(cfg, \"core.ignorecase\") < 0)\n\t\t\tgiterr_clear();\n\t}\n\n#ifdef GIT_USE_ICONV\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.precomposeunicode\",\n\t\t\tgit_path_does_fs_decompose_unicode(work_dir))) < 0)\n\t\treturn error;\n\t/* on non-iconv platforms, don't even set core.precomposeunicode */\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_init_fs_configs(\n\tgit_config *cfg,\n\tconst char *cfg_path,\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tbool update_ignorecase)\n{\n\tint error = 0;\n\n\tif (!work_dir)\n\t\twork_dir = repo_dir;\n\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.filemode\", is_chmod_supported(cfg_path))) < 0)\n\t\treturn error;\n\n\tif (!are_symlinks_supported(work_dir)) {\n\t\tif ((error = git_config_set_bool(cfg, \"core.symlinks\", false)) < 0)\n\t\t\treturn error;\n\t} else if (git_config_delete_entry(cfg, \"core.symlinks\") < 0)\n\t\tgiterr_clear();\n\n\tif (update_ignorecase) {\n\t\tif (is_filesystem_case_insensitive(repo_dir)) {\n\t\t\tif ((error = git_config_set_bool(cfg, \"core.ignorecase\", true)) < 0)\n\t\t\t\treturn error;\n\t\t} else if (git_config_delete_entry(cfg, \"core.ignorecase\") < 0)\n\t\t\tgiterr_clear();\n\t}\n\n#ifdef GIT_USE_ICONV\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.precomposeunicode\",\n\t\t\tgit_path_does_fs_decompose_unicode(work_dir))) < 0)\n\t\treturn error;\n\t/* on non-iconv platforms, don't even set core.precomposeunicode */\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SET_REPO_CONFIG",
          "args": [
            "int32",
            "\"core.repositoryformatversion\"",
            "GIT_REPO_VERSION"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_REPO_CONFIG",
          "args": [
            "bool",
            "\"core.bare\"",
            "is_bare"
          ],
          "line": 1209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_repositoryformatversion",
          "args": [
            "config"
          ],
          "line": 1202
        },
        "resolved": true,
        "details": {
          "function_name": "check_repositoryformatversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "986-1006",
          "snippet": "static int check_repositoryformatversion(git_config *config)\n{\n\tint version, error;\n\n\terror = git_config_get_int32(&version, config, \"core.repositoryformatversion\");\n\t/* git ignores this if the config variable isn't there */\n\tif (error == GIT_ENOTFOUND)\n\t\treturn 0;\n\n\tif (error < 0)\n\t\treturn -1;\n\n\tif (GIT_REPO_VERSION < version) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Unsupported repository version %d. Only versions up to %d are supported.\",\n\t\t\tversion, GIT_REPO_VERSION);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [
            "#define GIT_REPO_VERSION 0"
          ],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_REPO_VERSION 0\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int check_repositoryformatversion(git_config *config)\n{\n\tint version, error;\n\n\terror = git_config_get_int32(&version, config, \"core.repositoryformatversion\");\n\t/* git ignores this if the config variable isn't there */\n\tif (error == GIT_ENOTFOUND)\n\t\treturn 0;\n\n\tif (error < 0)\n\t\treturn -1;\n\n\tif (GIT_REPO_VERSION < version) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Unsupported repository version %d. Only versions up to %d are supported.\",\n\t\t\tversion, GIT_REPO_VERSION);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "repo_local_config",
          "args": [
            "&config",
            "&cfg_path",
            "NULL",
            "repo_dir"
          ],
          "line": 1199
        },
        "resolved": true,
        "details": {
          "function_name": "repo_local_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1106-1144",
          "snippet": "static int repo_local_config(\n\tgit_config **out,\n\tgit_buf *config_dir,\n\tgit_repository *repo,\n\tconst char *repo_dir)\n{\n\tint error = 0;\n\tgit_config *parent;\n\tconst char *cfg_path;\n\n\tif (git_buf_joinpath(config_dir, repo_dir, GIT_CONFIG_FILENAME_INREPO) < 0)\n\t\treturn -1;\n\tcfg_path = git_buf_cstr(config_dir);\n\n\t/* make LOCAL config if missing */\n\tif (!git_path_isfile(cfg_path) &&\n\t\t(error = create_empty_file(cfg_path, GIT_CONFIG_FILE_MODE)) < 0)\n\t\treturn error;\n\n\t/* if no repo, just open that file directly */\n\tif (!repo)\n\t\treturn git_config_open_ondisk(out, cfg_path);\n\n\t/* otherwise, open parent config and get that level */\n\tif ((error = git_repository_config__weakptr(&parent, repo)) < 0)\n\t\treturn error;\n\n\tif (git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL) < 0) {\n\t\tgiterr_clear();\n\n\t\tif (!(error = git_config_add_file_ondisk(\n\t\t\t\tparent, cfg_path, GIT_CONFIG_LEVEL_LOCAL, false)))\n\t\t\terror = git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL);\n\t}\n\n\tgit_config_free(parent);\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int repo_local_config(\n\tgit_config **out,\n\tgit_buf *config_dir,\n\tgit_repository *repo,\n\tconst char *repo_dir)\n{\n\tint error = 0;\n\tgit_config *parent;\n\tconst char *cfg_path;\n\n\tif (git_buf_joinpath(config_dir, repo_dir, GIT_CONFIG_FILENAME_INREPO) < 0)\n\t\treturn -1;\n\tcfg_path = git_buf_cstr(config_dir);\n\n\t/* make LOCAL config if missing */\n\tif (!git_path_isfile(cfg_path) &&\n\t\t(error = create_empty_file(cfg_path, GIT_CONFIG_FILE_MODE)) < 0)\n\t\treturn error;\n\n\t/* if no repo, just open that file directly */\n\tif (!repo)\n\t\treturn git_config_open_ondisk(out, cfg_path);\n\n\t/* otherwise, open parent config and get that level */\n\tif ((error = git_repository_config__weakptr(&parent, repo)) < 0)\n\t\treturn error;\n\n\tif (git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL) < 0) {\n\t\tgiterr_clear();\n\n\t\tif (!(error = git_config_add_file_ondisk(\n\t\t\t\tparent, cfg_path, GIT_CONFIG_LEVEL_LOCAL, false)))\n\t\t\terror = git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL);\n\t}\n\n\tgit_config_free(parent);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_REPO_VERSION 0\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int repo_init_config(\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tuint32_t flags,\n\tuint32_t mode)\n{\n\tint error = 0;\n\tgit_buf cfg_path = GIT_BUF_INIT, worktree_path = GIT_BUF_INIT;\n\tgit_config *config = NULL;\n\tbool is_bare = ((flags & GIT_REPOSITORY_INIT_BARE) != 0);\n\tbool is_reinit = ((flags & GIT_REPOSITORY_INIT__IS_REINIT) != 0);\n\n\tif ((error = repo_local_config(&config, &cfg_path, NULL, repo_dir)) < 0)\n\t\tgoto cleanup;\n\n\tif (is_reinit && (error = check_repositoryformatversion(config)) < 0)\n\t\tgoto cleanup;\n\n#define SET_REPO_CONFIG(TYPE, NAME, VAL) do { \\\n\tif ((error = git_config_set_##TYPE(config, NAME, VAL)) < 0) \\\n\t\tgoto cleanup; } while (0)\n\n\tSET_REPO_CONFIG(bool, \"core.bare\", is_bare);\n\tSET_REPO_CONFIG(int32, \"core.repositoryformatversion\", GIT_REPO_VERSION);\n\n\tif ((error = repo_init_fs_configs(\n\t\t\tconfig, cfg_path.ptr, repo_dir, work_dir, !is_reinit)) < 0)\n\t\tgoto cleanup;\n\n\tif (!is_bare) {\n\t\tSET_REPO_CONFIG(bool, \"core.logallrefupdates\", true);\n\n\t\tif (!(flags & GIT_REPOSITORY_INIT__NATURAL_WD)) {\n\t\t\tif ((error = git_buf_sets(&worktree_path, work_dir)) < 0)\n\t\t\t\tgoto cleanup;\n\n\t\t\tif ((flags & GIT_REPOSITORY_INIT_RELATIVE_GITLINK))\n\t\t\t\tif ((error = git_path_make_relative(&worktree_path, repo_dir)) < 0)\n\t\t\t\t\tgoto cleanup;\n\n\t\t\tSET_REPO_CONFIG(string, \"core.worktree\", worktree_path.ptr);\n\t\t} else if (is_reinit) {\n\t\t\tif (git_config_delete_entry(config, \"core.worktree\") < 0)\n\t\t\t\tgiterr_clear();\n\t\t}\n\t}\n\n\tif (mode == GIT_REPOSITORY_INIT_SHARED_GROUP) {\n\t\tSET_REPO_CONFIG(int32, \"core.sharedrepository\", 1);\n\t\tSET_REPO_CONFIG(bool, \"receive.denyNonFastforwards\", true);\n\t}\n\telse if (mode == GIT_REPOSITORY_INIT_SHARED_ALL) {\n\t\tSET_REPO_CONFIG(int32, \"core.sharedrepository\", 2);\n\t\tSET_REPO_CONFIG(bool, \"receive.denyNonFastforwards\", true);\n\t}\n\ncleanup:\n\tgit_buf_free(&cfg_path);\n\tgit_buf_free(&worktree_path);\n\tgit_config_free(config);\n\n\treturn error;\n}"
  },
  {
    "function_name": "repo_init_fs_configs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1146-1185",
    "snippet": "static int repo_init_fs_configs(\n\tgit_config *cfg,\n\tconst char *cfg_path,\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tbool update_ignorecase)\n{\n\tint error = 0;\n\n\tif (!work_dir)\n\t\twork_dir = repo_dir;\n\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.filemode\", is_chmod_supported(cfg_path))) < 0)\n\t\treturn error;\n\n\tif (!are_symlinks_supported(work_dir)) {\n\t\tif ((error = git_config_set_bool(cfg, \"core.symlinks\", false)) < 0)\n\t\t\treturn error;\n\t} else if (git_config_delete_entry(cfg, \"core.symlinks\") < 0)\n\t\tgiterr_clear();\n\n\tif (update_ignorecase) {\n\t\tif (is_filesystem_case_insensitive(repo_dir)) {\n\t\t\tif ((error = git_config_set_bool(cfg, \"core.ignorecase\", true)) < 0)\n\t\t\t\treturn error;\n\t\t} else if (git_config_delete_entry(cfg, \"core.ignorecase\") < 0)\n\t\t\tgiterr_clear();\n\t}\n\n#ifdef GIT_USE_ICONV\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.precomposeunicode\",\n\t\t\tgit_path_does_fs_decompose_unicode(work_dir))) < 0)\n\t\treturn error;\n\t/* on non-iconv platforms, don't even set core.precomposeunicode */\n#endif\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_set_bool",
          "args": [
            "cfg",
            "\"core.precomposeunicode\"",
            "git_path_does_fs_decompose_unicode(work_dir)"
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_set_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "611-614",
          "snippet": "int git_config_set_bool(git_config *cfg, const char *name, int value)\n{\n\treturn git_config_set_string(cfg, name, value ? \"true\" : \"false\");\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_set_bool(git_config *cfg, const char *name, int value)\n{\n\treturn git_config_set_string(cfg, name, value ? \"true\" : \"false\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_does_fs_decompose_unicode",
          "args": [
            "work_dir"
          ],
          "line": 1179
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_does_fs_decompose_unicode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "1009-1013",
          "snippet": "bool git_path_does_fs_decompose_unicode(const char *root)\n{\n\tGIT_UNUSED(root);\n\treturn false;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_does_fs_decompose_unicode(const char *root)\n{\n\tGIT_UNUSED(root);\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 1173
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_delete_entry",
          "args": [
            "cfg",
            "\"core.ignorecase\""
          ],
          "line": 1172
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_delete_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "586-597",
          "snippet": "int git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_delete_entry(git_config *cfg, const char *name)\n{\n\tgit_config_backend *file;\n\tfile_internal *internal;\n\n\tinternal = git_vector_get(&cfg->files, 0);\n\tif (!internal || !internal->file)\n\t\treturn config_error_nofiles(name);\n\tfile = internal->file;\n\n\treturn file->del(file, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_filesystem_case_insensitive",
          "args": [
            "repo_dir"
          ],
          "line": 1169
        },
        "resolved": true,
        "details": {
          "function_name": "is_filesystem_case_insensitive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1055-1065",
          "snippet": "static bool is_filesystem_case_insensitive(const char *gitdir_path)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint is_insensitive = -1;\n\n\tif (!git_buf_joinpath(&path, gitdir_path, \"CoNfIg\"))\n\t\tis_insensitive = git_path_exists(git_buf_cstr(&path));\n\n\tgit_buf_free(&path);\n\treturn is_insensitive;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool is_filesystem_case_insensitive(const char *gitdir_path)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint is_insensitive = -1;\n\n\tif (!git_buf_joinpath(&path, gitdir_path, \"CoNfIg\"))\n\t\tis_insensitive = git_path_exists(git_buf_cstr(&path));\n\n\tgit_buf_free(&path);\n\treturn is_insensitive;\n}"
        }
      },
      {
        "call_info": {
          "callee": "are_symlinks_supported",
          "args": [
            "work_dir"
          ],
          "line": 1162
        },
        "resolved": true,
        "details": {
          "function_name": "are_symlinks_supported",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1067-1087",
          "snippet": "static bool are_symlinks_supported(const char *wd_path)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd;\n\tstruct stat st;\n\tint symlinks_supported = -1;\n\n\tif ((fd = git_futils_mktmp(&path, wd_path, 0666)) < 0 ||\n\t\tp_close(fd) < 0 ||\n\t\tp_unlink(path.ptr) < 0 ||\n\t\tp_symlink(\"testing\", path.ptr) < 0 ||\n\t\tp_lstat(path.ptr, &st) < 0)\n\t\tsymlinks_supported = false;\n\telse\n\t\tsymlinks_supported = (S_ISLNK(st.st_mode) != 0);\n\n\t(void)p_unlink(path.ptr);\n\tgit_buf_free(&path);\n\n\treturn symlinks_supported;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool are_symlinks_supported(const char *wd_path)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd;\n\tstruct stat st;\n\tint symlinks_supported = -1;\n\n\tif ((fd = git_futils_mktmp(&path, wd_path, 0666)) < 0 ||\n\t\tp_close(fd) < 0 ||\n\t\tp_unlink(path.ptr) < 0 ||\n\t\tp_symlink(\"testing\", path.ptr) < 0 ||\n\t\tp_lstat(path.ptr, &st) < 0)\n\t\tsymlinks_supported = false;\n\telse\n\t\tsymlinks_supported = (S_ISLNK(st.st_mode) != 0);\n\n\t(void)p_unlink(path.ptr);\n\tgit_buf_free(&path);\n\n\treturn symlinks_supported;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_chmod_supported",
          "args": [
            "cfg_path"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "is_chmod_supported",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1039-1053",
          "snippet": "static bool is_chmod_supported(const char *file_path)\n{\n\tstruct stat st1, st2;\n\n\tif (p_stat(file_path, &st1) < 0)\n\t\treturn false;\n\n\tif (p_chmod(file_path, st1.st_mode ^ S_IXUSR) < 0)\n\t\treturn false;\n\n\tif (p_stat(file_path, &st2) < 0)\n\t\treturn false;\n\n\treturn (st1.st_mode != st2.st_mode);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool is_chmod_supported(const char *file_path)\n{\n\tstruct stat st1, st2;\n\n\tif (p_stat(file_path, &st1) < 0)\n\t\treturn false;\n\n\tif (p_chmod(file_path, st1.st_mode ^ S_IXUSR) < 0)\n\t\treturn false;\n\n\tif (p_stat(file_path, &st2) < 0)\n\t\treturn false;\n\n\treturn (st1.st_mode != st2.st_mode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int repo_init_fs_configs(\n\tgit_config *cfg,\n\tconst char *cfg_path,\n\tconst char *repo_dir,\n\tconst char *work_dir,\n\tbool update_ignorecase)\n{\n\tint error = 0;\n\n\tif (!work_dir)\n\t\twork_dir = repo_dir;\n\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.filemode\", is_chmod_supported(cfg_path))) < 0)\n\t\treturn error;\n\n\tif (!are_symlinks_supported(work_dir)) {\n\t\tif ((error = git_config_set_bool(cfg, \"core.symlinks\", false)) < 0)\n\t\t\treturn error;\n\t} else if (git_config_delete_entry(cfg, \"core.symlinks\") < 0)\n\t\tgiterr_clear();\n\n\tif (update_ignorecase) {\n\t\tif (is_filesystem_case_insensitive(repo_dir)) {\n\t\t\tif ((error = git_config_set_bool(cfg, \"core.ignorecase\", true)) < 0)\n\t\t\t\treturn error;\n\t\t} else if (git_config_delete_entry(cfg, \"core.ignorecase\") < 0)\n\t\t\tgiterr_clear();\n\t}\n\n#ifdef GIT_USE_ICONV\n\tif ((error = git_config_set_bool(\n\t\t\tcfg, \"core.precomposeunicode\",\n\t\t\tgit_path_does_fs_decompose_unicode(work_dir))) < 0)\n\t\treturn error;\n\t/* on non-iconv platforms, don't even set core.precomposeunicode */\n#endif\n\n\treturn 0;\n}"
  },
  {
    "function_name": "repo_local_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1106-1144",
    "snippet": "static int repo_local_config(\n\tgit_config **out,\n\tgit_buf *config_dir,\n\tgit_repository *repo,\n\tconst char *repo_dir)\n{\n\tint error = 0;\n\tgit_config *parent;\n\tconst char *cfg_path;\n\n\tif (git_buf_joinpath(config_dir, repo_dir, GIT_CONFIG_FILENAME_INREPO) < 0)\n\t\treturn -1;\n\tcfg_path = git_buf_cstr(config_dir);\n\n\t/* make LOCAL config if missing */\n\tif (!git_path_isfile(cfg_path) &&\n\t\t(error = create_empty_file(cfg_path, GIT_CONFIG_FILE_MODE)) < 0)\n\t\treturn error;\n\n\t/* if no repo, just open that file directly */\n\tif (!repo)\n\t\treturn git_config_open_ondisk(out, cfg_path);\n\n\t/* otherwise, open parent config and get that level */\n\tif ((error = git_repository_config__weakptr(&parent, repo)) < 0)\n\t\treturn error;\n\n\tif (git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL) < 0) {\n\t\tgiterr_clear();\n\n\t\tif (!(error = git_config_add_file_ondisk(\n\t\t\t\tparent, cfg_path, GIT_CONFIG_LEVEL_LOCAL, false)))\n\t\t\terror = git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL);\n\t}\n\n\tgit_config_free(parent);\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "parent"
          ],
          "line": 1141
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_open_level",
          "args": [
            "out",
            "parent",
            "GIT_CONFIG_LEVEL_LOCAL"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_open_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "281-304",
          "snippet": "int git_config_open_level(\n\tgit_config **cfg_out,\n\tconst git_config *cfg_parent,\n\tgit_config_level_t level)\n{\n\tgit_config *cfg;\n\tfile_internal *internal;\n\tint res;\n\n\tif ((res = find_internal_file_by_level(&internal, cfg_parent, level)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config_new(&cfg)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config__add_internal(cfg, internal, level, true)) < 0) {\n\t\tgit_config_free(cfg);\n\t\treturn res;\n\t}\n\n\t*cfg_out = cfg;\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_open_level(\n\tgit_config **cfg_out,\n\tconst git_config *cfg_parent,\n\tgit_config_level_t level)\n{\n\tgit_config *cfg;\n\tfile_internal *internal;\n\tint res;\n\n\tif ((res = find_internal_file_by_level(&internal, cfg_parent, level)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config_new(&cfg)) < 0)\n\t\treturn res;\n\n\tif ((res = git_config__add_internal(cfg, internal, level, true)) < 0) {\n\t\tgit_config_free(cfg);\n\t\treturn res;\n\t}\n\n\t*cfg_out = cfg;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_add_file_ondisk",
          "args": [
            "parent",
            "cfg_path",
            "GIT_CONFIG_LEVEL_LOCAL",
            "false"
          ],
          "line": 1136
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_add_file_ondisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "98-129",
          "snippet": "int git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 1134
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config__weakptr",
          "args": [
            "&parent",
            "repo"
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "661-705",
          "snippet": "int git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_open_ondisk",
          "args": [
            "out",
            "cfg_path"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_open_ondisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "131-147",
          "snippet": "int git_config_open_ondisk(git_config **out, const char *path)\n{\n\tint error;\n\tgit_config *config;\n\n\t*out = NULL;\n\n\tif (git_config_new(&config) < 0)\n\t\treturn -1;\n\n\tif ((error = git_config_add_file_ondisk(config, path, GIT_CONFIG_LEVEL_LOCAL, 0)) < 0)\n\t\tgit_config_free(config);\n\telse\n\t\t*out = config;\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_open_ondisk(git_config **out, const char *path)\n{\n\tint error;\n\tgit_config *config;\n\n\t*out = NULL;\n\n\tif (git_config_new(&config) < 0)\n\t\treturn -1;\n\n\tif ((error = git_config_add_file_ondisk(config, path, GIT_CONFIG_LEVEL_LOCAL, 0)) < 0)\n\t\tgit_config_free(config);\n\telse\n\t\t*out = config;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "create_empty_file",
          "args": [
            "cfg_path",
            "GIT_CONFIG_FILE_MODE"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "create_empty_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "1089-1104",
          "snippet": "static int create_empty_file(const char *path, mode_t mode)\n{\n\tint fd;\n\n\tif ((fd = p_creat(path, mode)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Error while creating '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (p_close(fd) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Error while closing '%s'\", path);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int create_empty_file(const char *path, mode_t mode)\n{\n\tint fd;\n\n\tif ((fd = p_creat(path, mode)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Error while creating '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (p_close(fd) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Error while closing '%s'\", path);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_isfile",
          "args": [
            "cfg_path"
          ],
          "line": 1121
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_isfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "518-527",
          "snippet": "bool git_path_isfile(const char *path)\n{\n\tstruct stat st;\n\n\tassert(path);\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISREG(st.st_mode) != 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_isfile(const char *path)\n{\n\tstruct stat st;\n\n\tassert(path);\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISREG(st.st_mode) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "config_dir"
          ],
          "line": 1118
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "config_dir",
            "repo_dir",
            "GIT_CONFIG_FILENAME_INREPO"
          ],
          "line": 1116
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int repo_local_config(\n\tgit_config **out,\n\tgit_buf *config_dir,\n\tgit_repository *repo,\n\tconst char *repo_dir)\n{\n\tint error = 0;\n\tgit_config *parent;\n\tconst char *cfg_path;\n\n\tif (git_buf_joinpath(config_dir, repo_dir, GIT_CONFIG_FILENAME_INREPO) < 0)\n\t\treturn -1;\n\tcfg_path = git_buf_cstr(config_dir);\n\n\t/* make LOCAL config if missing */\n\tif (!git_path_isfile(cfg_path) &&\n\t\t(error = create_empty_file(cfg_path, GIT_CONFIG_FILE_MODE)) < 0)\n\t\treturn error;\n\n\t/* if no repo, just open that file directly */\n\tif (!repo)\n\t\treturn git_config_open_ondisk(out, cfg_path);\n\n\t/* otherwise, open parent config and get that level */\n\tif ((error = git_repository_config__weakptr(&parent, repo)) < 0)\n\t\treturn error;\n\n\tif (git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL) < 0) {\n\t\tgiterr_clear();\n\n\t\tif (!(error = git_config_add_file_ondisk(\n\t\t\t\tparent, cfg_path, GIT_CONFIG_LEVEL_LOCAL, false)))\n\t\t\terror = git_config_open_level(out, parent, GIT_CONFIG_LEVEL_LOCAL);\n\t}\n\n\tgit_config_free(parent);\n\n\treturn error;\n}"
  },
  {
    "function_name": "create_empty_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1089-1104",
    "snippet": "static int create_empty_file(const char *path, mode_t mode)\n{\n\tint fd;\n\n\tif ((fd = p_creat(path, mode)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Error while creating '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (p_close(fd) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Error while closing '%s'\", path);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_OS",
            "\"Error while closing '%s'\"",
            "path"
          ],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_close",
          "args": [
            "fd"
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "winhttp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/winhttp.c",
          "lines": "1359-1377",
          "snippet": "static int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}",
          "includes": [
            "#include <urlmon.h>",
            "#include <objbase.h>",
            "#include <winhttp.h>",
            "#include <wincrypt.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"remote.h\"",
            "#include \"smart.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <urlmon.h>\n#include <objbase.h>\n#include <winhttp.h>\n#include <wincrypt.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"remote.h\"\n#include \"smart.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"git2.h\"\n\nstatic int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_creat",
          "args": [
            "path",
            "mode"
          ],
          "line": 1093
        },
        "resolved": true,
        "details": {
          "function_name": "p_creat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/posix.c",
          "lines": "120-123",
          "snippet": "int p_creat(const char *path, mode_t mode)\n{\n\treturn open(path, O_WRONLY | O_CREAT | O_TRUNC | O_BINARY | O_CLOEXEC, mode);\n}",
          "includes": [
            "#include \"map.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"path.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"path.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint p_creat(const char *path, mode_t mode)\n{\n\treturn open(path, O_WRONLY | O_CREAT | O_TRUNC | O_BINARY | O_CLOEXEC, mode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int create_empty_file(const char *path, mode_t mode)\n{\n\tint fd;\n\n\tif ((fd = p_creat(path, mode)) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Error while creating '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (p_close(fd) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Error while closing '%s'\", path);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "are_symlinks_supported",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1067-1087",
    "snippet": "static bool are_symlinks_supported(const char *wd_path)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd;\n\tstruct stat st;\n\tint symlinks_supported = -1;\n\n\tif ((fd = git_futils_mktmp(&path, wd_path, 0666)) < 0 ||\n\t\tp_close(fd) < 0 ||\n\t\tp_unlink(path.ptr) < 0 ||\n\t\tp_symlink(\"testing\", path.ptr) < 0 ||\n\t\tp_lstat(path.ptr, &st) < 0)\n\t\tsymlinks_supported = false;\n\telse\n\t\tsymlinks_supported = (S_ISLNK(st.st_mode) != 0);\n\n\t(void)p_unlink(path.ptr);\n\tgit_buf_free(&path);\n\n\treturn symlinks_supported;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 1084
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_unlink",
          "args": [
            "path.ptr"
          ],
          "line": 1083
        },
        "resolved": true,
        "details": {
          "function_name": "p_unlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "92-110",
          "snippet": "int p_unlink(const char *path)\n{\n\tgit_win32_path buf;\n\tint error;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\terror = _wunlink(buf);\n\n\t/* If the file could not be deleted because it was\n\t * read-only, clear the bit and try again */\n\tif (error == -1 && errno == EACCES) {\n\t\t_wchmod(buf, 0666);\n\t\terror = _wunlink(buf);\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_unlink(const char *path)\n{\n\tgit_win32_path buf;\n\tint error;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\terror = _wunlink(buf);\n\n\t/* If the file could not be deleted because it was\n\t * read-only, clear the bit and try again */\n\tif (error == -1 && errno == EACCES) {\n\t\t_wchmod(buf, 0666);\n\t\terror = _wunlink(buf);\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "st.st_mode"
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_lstat",
          "args": [
            "path.ptr",
            "&st"
          ],
          "line": 1078
        },
        "resolved": true,
        "details": {
          "function_name": "p_lstat_posixly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "208-211",
          "snippet": "int p_lstat_posixly(const char *filename, struct stat *buf)\n{\n\treturn do_lstat(filename, buf, true);\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_lstat_posixly(const char *filename, struct stat *buf)\n{\n\treturn do_lstat(filename, buf, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_symlink",
          "args": [
            "\"testing\"",
            "path.ptr"
          ],
          "line": 1077
        },
        "resolved": true,
        "details": {
          "function_name": "p_symlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "275-281",
          "snippet": "int p_symlink(const char *old, const char *new)\n{\n\t/* Real symlinks on NTFS require admin privileges. Until this changes,\n\t * libgit2 just creates a text file with the link target in the contents.\n\t */\n\treturn git_futils_fake_symlink(old, new);\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_symlink(const char *old, const char *new)\n{\n\t/* Real symlinks on NTFS require admin privileges. Until this changes,\n\t * libgit2 just creates a text file with the link target in the contents.\n\t */\n\treturn git_futils_fake_symlink(old, new);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_close",
          "args": [
            "fd"
          ],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "winhttp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/transports/winhttp.c",
          "lines": "1359-1377",
          "snippet": "static int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}",
          "includes": [
            "#include <urlmon.h>",
            "#include <objbase.h>",
            "#include <winhttp.h>",
            "#include <wincrypt.h>",
            "#include \"global.h\"",
            "#include \"repository.h\"",
            "#include \"remote.h\"",
            "#include \"smart.h\"",
            "#include \"netops.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\"",
            "#include \"git2/transport.h\"",
            "#include \"git2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <urlmon.h>\n#include <objbase.h>\n#include <winhttp.h>\n#include <wincrypt.h>\n#include \"global.h\"\n#include \"repository.h\"\n#include \"remote.h\"\n#include \"smart.h\"\n#include \"netops.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n#include \"git2/transport.h\"\n#include \"git2.h\"\n\nstatic int winhttp_close(git_smart_subtransport *subtransport)\n{\n\twinhttp_subtransport *t = (winhttp_subtransport *)subtransport;\n\n\tgitno_connection_data_free_ptrs(&t->connection_data);\n\tmemset(&t->connection_data, 0x0, sizeof(gitno_connection_data));\n\n\tif (t->cred) {\n\t\tt->cred->free(t->cred);\n\t\tt->cred = NULL;\n\t}\n\n\tif (t->url_cred) {\n\t\tt->url_cred->free(t->url_cred);\n\t\tt->url_cred = NULL;\n\t}\n\n\treturn winhttp_close_connection(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_mktmp",
          "args": [
            "&path",
            "wd_path",
            "0666"
          ],
          "line": 1074
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_mktmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "25-51",
          "snippet": "int git_futils_mktmp(git_buf *path_out, const char *filename, mode_t mode)\n{\n\tint fd;\n\tmode_t mask;\n\n\tp_umask(mask = p_umask(0));\n\n\tgit_buf_sets(path_out, filename);\n\tgit_buf_puts(path_out, \"_git2_XXXXXX\");\n\n\tif (git_buf_oom(path_out))\n\t\treturn -1;\n\n\tif ((fd = p_mkstemp(path_out->ptr)) < 0) {\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to create temporary file '%s'\", path_out->ptr);\n\t\treturn -1;\n\t}\n\n\tif (p_chmod(path_out->ptr, (mode & ~mask))) {\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to set permissions on file '%s'\", path_out->ptr);\n\t\treturn -1;\n\t}\n\n\treturn fd;\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_mktmp(git_buf *path_out, const char *filename, mode_t mode)\n{\n\tint fd;\n\tmode_t mask;\n\n\tp_umask(mask = p_umask(0));\n\n\tgit_buf_sets(path_out, filename);\n\tgit_buf_puts(path_out, \"_git2_XXXXXX\");\n\n\tif (git_buf_oom(path_out))\n\t\treturn -1;\n\n\tif ((fd = p_mkstemp(path_out->ptr)) < 0) {\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to create temporary file '%s'\", path_out->ptr);\n\t\treturn -1;\n\t}\n\n\tif (p_chmod(path_out->ptr, (mode & ~mask))) {\n\t\tgiterr_set(GITERR_OS,\n\t\t\t\"Failed to set permissions on file '%s'\", path_out->ptr);\n\t\treturn -1;\n\t}\n\n\treturn fd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool are_symlinks_supported(const char *wd_path)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint fd;\n\tstruct stat st;\n\tint symlinks_supported = -1;\n\n\tif ((fd = git_futils_mktmp(&path, wd_path, 0666)) < 0 ||\n\t\tp_close(fd) < 0 ||\n\t\tp_unlink(path.ptr) < 0 ||\n\t\tp_symlink(\"testing\", path.ptr) < 0 ||\n\t\tp_lstat(path.ptr, &st) < 0)\n\t\tsymlinks_supported = false;\n\telse\n\t\tsymlinks_supported = (S_ISLNK(st.st_mode) != 0);\n\n\t(void)p_unlink(path.ptr);\n\tgit_buf_free(&path);\n\n\treturn symlinks_supported;\n}"
  },
  {
    "function_name": "is_filesystem_case_insensitive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1055-1065",
    "snippet": "static bool is_filesystem_case_insensitive(const char *gitdir_path)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint is_insensitive = -1;\n\n\tif (!git_buf_joinpath(&path, gitdir_path, \"CoNfIg\"))\n\t\tis_insensitive = git_path_exists(git_buf_cstr(&path));\n\n\tgit_buf_free(&path);\n\treturn is_insensitive;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_exists",
          "args": [
            "git_buf_cstr(&path)"
          ],
          "line": 1061
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "503-507",
          "snippet": "bool git_path_exists(const char *path)\n{\n\tassert(path);\n\treturn p_access(path, F_OK) == 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_exists(const char *path)\n{\n\tassert(path);\n\treturn p_access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "&path"
          ],
          "line": 1061
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "gitdir_path",
            "\"CoNfIg\""
          ],
          "line": 1060
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool is_filesystem_case_insensitive(const char *gitdir_path)\n{\n\tgit_buf path = GIT_BUF_INIT;\n\tint is_insensitive = -1;\n\n\tif (!git_buf_joinpath(&path, gitdir_path, \"CoNfIg\"))\n\t\tis_insensitive = git_path_exists(git_buf_cstr(&path));\n\n\tgit_buf_free(&path);\n\treturn is_insensitive;\n}"
  },
  {
    "function_name": "is_chmod_supported",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1039-1053",
    "snippet": "static bool is_chmod_supported(const char *file_path)\n{\n\tstruct stat st1, st2;\n\n\tif (p_stat(file_path, &st1) < 0)\n\t\treturn false;\n\n\tif (p_chmod(file_path, st1.st_mode ^ S_IXUSR) < 0)\n\t\treturn false;\n\n\tif (p_stat(file_path, &st2) < 0)\n\t\treturn false;\n\n\treturn (st1.st_mode != st2.st_mode);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p_stat",
          "args": [
            "file_path",
            "&st2"
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "p_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "417-432",
          "snippet": "int p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p_chmod",
          "args": [
            "file_path",
            "st1.st_mode ^ S_IXUSR"
          ],
          "line": 1046
        },
        "resolved": true,
        "details": {
          "function_name": "p_chmod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "444-452",
          "snippet": "int p_chmod(const char* path, mode_t mode)\n{\n\tgit_win32_path buf;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\treturn _wchmod(buf, mode);\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_chmod(const char* path, mode_t mode)\n{\n\tgit_win32_path buf;\n\n\tif (git_win32_path_from_utf8(buf, path) < 0)\n\t\treturn -1;\n\n\treturn _wchmod(buf, mode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool is_chmod_supported(const char *file_path)\n{\n\tstruct stat st1, st2;\n\n\tif (p_stat(file_path, &st1) < 0)\n\t\treturn false;\n\n\tif (p_chmod(file_path, st1.st_mode ^ S_IXUSR) < 0)\n\t\treturn false;\n\n\tif (p_stat(file_path, &st2) < 0)\n\t\treturn false;\n\n\treturn (st1.st_mode != st2.st_mode);\n}"
  },
  {
    "function_name": "repo_init_create_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "1008-1037",
    "snippet": "static int repo_init_create_head(const char *git_dir, const char *ref_name)\n{\n\tgit_buf ref_path = GIT_BUF_INIT;\n\tgit_filebuf ref = GIT_FILEBUF_INIT;\n\tconst char *fmt;\n\n\tif (git_buf_joinpath(&ref_path, git_dir, GIT_HEAD_FILE) < 0 ||\n\t\tgit_filebuf_open(&ref, ref_path.ptr, 0, GIT_REFS_FILE_MODE) < 0)\n\t\tgoto fail;\n\n\tif (!ref_name)\n\t\tref_name = GIT_BRANCH_MASTER;\n\n\tif (git__prefixcmp(ref_name, GIT_REFS_DIR) == 0)\n\t\tfmt = \"ref: %s\\n\";\n\telse\n\t\tfmt = \"ref: \" GIT_REFS_HEADS_DIR \"%s\\n\";\n\n\tif (git_filebuf_printf(&ref, fmt, ref_name) < 0 ||\n\t\tgit_filebuf_commit(&ref) < 0)\n\t\tgoto fail;\n\n\tgit_buf_free(&ref_path);\n\treturn 0;\n\nfail:\n\tgit_buf_free(&ref_path);\n\tgit_filebuf_cleanup(&ref);\n\treturn -1;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [
      "#define GIT_BRANCH_MASTER \"master\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_filebuf_cleanup",
          "args": [
            "&ref"
          ],
          "line": 1035
        },
        "resolved": true,
        "details": {
          "function_name": "git_filebuf_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filebuf.c",
          "lines": "104-133",
          "snippet": "void git_filebuf_cleanup(git_filebuf *file)\n{\n\tif (file->fd_is_open && file->fd >= 0)\n\t\tp_close(file->fd);\n\n\tif (file->created_lock && !file->did_rename && file->path_lock && git_path_exists(file->path_lock))\n\t\tp_unlink(file->path_lock);\n\n\tif (file->compute_digest) {\n\t\tgit_hash_ctx_cleanup(&file->digest);\n\t\tfile->compute_digest = 0;\n\t}\n\n\tif (file->buffer)\n\t\tgit__free(file->buffer);\n\n\t/* use the presence of z_buf to decide if we need to deflateEnd */\n\tif (file->z_buf) {\n\t\tgit__free(file->z_buf);\n\t\tdeflateEnd(&file->zs);\n\t}\n\n\tif (file->path_original)\n\t\tgit__free(file->path_original);\n\tif (file->path_lock)\n\t\tgit__free(file->path_lock);\n\n\tmemset(file, 0x0, sizeof(git_filebuf));\n\tfile->fd = -1;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n\nvoid git_filebuf_cleanup(git_filebuf *file)\n{\n\tif (file->fd_is_open && file->fd >= 0)\n\t\tp_close(file->fd);\n\n\tif (file->created_lock && !file->did_rename && file->path_lock && git_path_exists(file->path_lock))\n\t\tp_unlink(file->path_lock);\n\n\tif (file->compute_digest) {\n\t\tgit_hash_ctx_cleanup(&file->digest);\n\t\tfile->compute_digest = 0;\n\t}\n\n\tif (file->buffer)\n\t\tgit__free(file->buffer);\n\n\t/* use the presence of z_buf to decide if we need to deflateEnd */\n\tif (file->z_buf) {\n\t\tgit__free(file->z_buf);\n\t\tdeflateEnd(&file->zs);\n\t}\n\n\tif (file->path_original)\n\t\tgit__free(file->path_original);\n\tif (file->path_lock)\n\t\tgit__free(file->path_lock);\n\n\tmemset(file, 0x0, sizeof(git_filebuf));\n\tfile->fd = -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&ref_path"
          ],
          "line": 1034
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filebuf_commit",
          "args": [
            "&ref"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "git_filebuf_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filebuf.c",
          "lines": "410-443",
          "snippet": "int git_filebuf_commit(git_filebuf *file)\n{\n\t/* temporary files cannot be committed */\n\tassert(file && file->path_original);\n\n\tfile->flush_mode = Z_FINISH;\n\tflush_buffer(file);\n\n\tif (verify_last_error(file) < 0)\n\t\tgoto on_error;\n\n\tfile->fd_is_open = false;\n\n\tif (p_close(file->fd) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to close file at '%s'\", file->path_lock);\n\t\tgoto on_error;\n\t}\n\n\tfile->fd = -1;\n\n\tif (p_rename(file->path_lock, file->path_original) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to rename lockfile to '%s'\", file->path_original);\n\t\tgoto on_error;\n\t}\n\n\tfile->did_rename = true;\n\n\tgit_filebuf_cleanup(file);\n\treturn 0;\n\non_error:\n\tgit_filebuf_cleanup(file);\n\treturn -1;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n\nint git_filebuf_commit(git_filebuf *file)\n{\n\t/* temporary files cannot be committed */\n\tassert(file && file->path_original);\n\n\tfile->flush_mode = Z_FINISH;\n\tflush_buffer(file);\n\n\tif (verify_last_error(file) < 0)\n\t\tgoto on_error;\n\n\tfile->fd_is_open = false;\n\n\tif (p_close(file->fd) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to close file at '%s'\", file->path_lock);\n\t\tgoto on_error;\n\t}\n\n\tfile->fd = -1;\n\n\tif (p_rename(file->path_lock, file->path_original) < 0) {\n\t\tgiterr_set(GITERR_OS, \"Failed to rename lockfile to '%s'\", file->path_original);\n\t\tgoto on_error;\n\t}\n\n\tfile->did_rename = true;\n\n\tgit_filebuf_cleanup(file);\n\treturn 0;\n\non_error:\n\tgit_filebuf_cleanup(file);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filebuf_printf",
          "args": [
            "&ref",
            "fmt",
            "ref_name"
          ],
          "line": 1026
        },
        "resolved": true,
        "details": {
          "function_name": "git_filebuf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filebuf.c",
          "lines": "502-556",
          "snippet": "int git_filebuf_printf(git_filebuf *file, const char *format, ...)\n{\n\tva_list arglist;\n\tsize_t space_left, len, alloclen;\n\tint written, res;\n\tchar *tmp_buffer;\n\n\tENSURE_BUF_OK(file);\n\n\tspace_left = file->buf_size - file->buf_pos;\n\n\tdo {\n\t\tva_start(arglist, format);\n\t\twritten = p_vsnprintf((char *)file->buffer + file->buf_pos, space_left, format, arglist);\n\t\tva_end(arglist);\n\n\t\tif (written < 0) {\n\t\t\tfile->last_error = BUFERR_MEM;\n\t\t\treturn -1;\n\t\t}\n\n\t\tlen = written;\n\t\tif (len + 1 <= space_left) {\n\t\t\tfile->buf_pos += len;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (flush_buffer(file) < 0)\n\t\t\treturn -1;\n\n\t\tspace_left = file->buf_size - file->buf_pos;\n\n\t} while (len + 1 <= space_left);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclen, len, 1) ||\n\t\t!(tmp_buffer = git__malloc(alloclen))) {\n\t\tfile->last_error = BUFERR_MEM;\n\t\treturn -1;\n\t}\n\n\tva_start(arglist, format);\n\twritten = p_vsnprintf(tmp_buffer, len + 1, format, arglist);\n\tva_end(arglist);\n\n\tif (written < 0) {\n\t\tgit__free(tmp_buffer);\n\t\tfile->last_error = BUFERR_MEM;\n\t\treturn -1;\n\t}\n\n\tres = git_filebuf_write(file, tmp_buffer, len);\n\tgit__free(tmp_buffer);\n\n\treturn res;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n\nint git_filebuf_printf(git_filebuf *file, const char *format, ...)\n{\n\tva_list arglist;\n\tsize_t space_left, len, alloclen;\n\tint written, res;\n\tchar *tmp_buffer;\n\n\tENSURE_BUF_OK(file);\n\n\tspace_left = file->buf_size - file->buf_pos;\n\n\tdo {\n\t\tva_start(arglist, format);\n\t\twritten = p_vsnprintf((char *)file->buffer + file->buf_pos, space_left, format, arglist);\n\t\tva_end(arglist);\n\n\t\tif (written < 0) {\n\t\t\tfile->last_error = BUFERR_MEM;\n\t\t\treturn -1;\n\t\t}\n\n\t\tlen = written;\n\t\tif (len + 1 <= space_left) {\n\t\t\tfile->buf_pos += len;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (flush_buffer(file) < 0)\n\t\t\treturn -1;\n\n\t\tspace_left = file->buf_size - file->buf_pos;\n\n\t} while (len + 1 <= space_left);\n\n\tif (GIT_ADD_SIZET_OVERFLOW(&alloclen, len, 1) ||\n\t\t!(tmp_buffer = git__malloc(alloclen))) {\n\t\tfile->last_error = BUFERR_MEM;\n\t\treturn -1;\n\t}\n\n\tva_start(arglist, format);\n\twritten = p_vsnprintf(tmp_buffer, len + 1, format, arglist);\n\tva_end(arglist);\n\n\tif (written < 0) {\n\t\tgit__free(tmp_buffer);\n\t\tfile->last_error = BUFERR_MEM;\n\t\treturn -1;\n\t}\n\n\tres = git_filebuf_write(file, tmp_buffer, len);\n\tgit__free(tmp_buffer);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__prefixcmp",
          "args": [
            "ref_name",
            "GIT_REFS_DIR"
          ],
          "line": 1021
        },
        "resolved": true,
        "details": {
          "function_name": "git__prefixcmp_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "252-255",
          "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_filebuf_open",
          "args": [
            "&ref",
            "ref_path.ptr",
            "0",
            "GIT_REFS_FILE_MODE"
          ],
          "line": 1015
        },
        "resolved": true,
        "details": {
          "function_name": "git_filebuf_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/filebuf.c",
          "lines": "274-383",
          "snippet": "int git_filebuf_open(git_filebuf *file, const char *path, int flags, mode_t mode)\n{\n\tint compression, error = -1;\n\tsize_t path_len, alloc_len;\n\n\t/* opening an already open buffer is a programming error;\n\t * assert that this never happens instead of returning\n\t * an error code */\n\tassert(file && path && file->buffer == NULL);\n\n\tmemset(file, 0x0, sizeof(git_filebuf));\n\n\tif (flags & GIT_FILEBUF_DO_NOT_BUFFER)\n\t\tfile->do_not_buffer = true;\n\n\tfile->buf_size = WRITE_BUFFER_SIZE;\n\tfile->buf_pos = 0;\n\tfile->fd = -1;\n\tfile->last_error = BUFERR_OK;\n\n\t/* Allocate the main cache buffer */\n\tif (!file->do_not_buffer) {\n\t\tfile->buffer = git__malloc(file->buf_size);\n\t\tGITERR_CHECK_ALLOC(file->buffer);\n\t}\n\n\t/* If we are hashing on-write, allocate a new hash context */\n\tif (flags & GIT_FILEBUF_HASH_CONTENTS) {\n\t\tfile->compute_digest = 1;\n\n\t\tif (git_hash_ctx_init(&file->digest) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tcompression = flags >> GIT_FILEBUF_DEFLATE_SHIFT;\n\n\t/* If we are deflating on-write, */\n\tif (compression != 0) {\n\t\t/* Initialize the ZLib stream */\n\t\tif (deflateInit(&file->zs, compression) != Z_OK) {\n\t\t\tgiterr_set(GITERR_ZLIB, \"Failed to initialize zlib\");\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\t/* Allocate the Zlib cache buffer */\n\t\tfile->z_buf = git__malloc(file->buf_size);\n\t\tGITERR_CHECK_ALLOC(file->z_buf);\n\n\t\t/* Never flush */\n\t\tfile->flush_mode = Z_NO_FLUSH;\n\t\tfile->write = &write_deflate;\n\t} else {\n\t\tfile->write = &write_normal;\n\t}\n\n\t/* If we are writing to a temp file */\n\tif (flags & GIT_FILEBUF_TEMPORARY) {\n\t\tgit_buf tmp_path = GIT_BUF_INIT;\n\n\t\t/* Open the file as temporary for locking */\n\t\tfile->fd = git_futils_mktmp(&tmp_path, path, mode);\n\n\t\tif (file->fd < 0) {\n\t\t\tgit_buf_free(&tmp_path);\n\t\t\tgoto cleanup;\n\t\t}\n\t\tfile->fd_is_open = true;\n\t\tfile->created_lock = true;\n\n\t\t/* No original path */\n\t\tfile->path_original = NULL;\n\t\tfile->path_lock = git_buf_detach(&tmp_path);\n\t\tGITERR_CHECK_ALLOC(file->path_lock);\n\t} else {\n\t\tgit_buf resolved_path = GIT_BUF_INIT;\n\n\t\tif ((error = resolve_symlink(&resolved_path, path)) < 0)\n\t\t\tgoto cleanup;\n\n\t\t/* Save the original path of the file */\n\t\tpath_len = resolved_path.size;\n\t\tfile->path_original = git_buf_detach(&resolved_path);\n\n\t\t/* create the locking path by appending \".lock\" to the original */\n\t\tGITERR_CHECK_ALLOC_ADD(&alloc_len, path_len, GIT_FILELOCK_EXTLENGTH);\n\t\tfile->path_lock = git__malloc(alloc_len);\n\t\tGITERR_CHECK_ALLOC(file->path_lock);\n\n\t\tmemcpy(file->path_lock, file->path_original, path_len);\n\t\tmemcpy(file->path_lock + path_len, GIT_FILELOCK_EXTENSION, GIT_FILELOCK_EXTLENGTH);\n\n\t\tif (git_path_isdir(file->path_original)) {\n\t\t\tgiterr_set(GITERR_FILESYSTEM, \"path '%s' is a directory\", file->path_original);\n\t\t\terror = GIT_EDIRECTORY;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\t/* open the file for locking */\n\t\tif ((error = lock_file(file, flags, mode)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tfile->created_lock = true;\n\t}\n\n\treturn 0;\n\ncleanup:\n\tgit_filebuf_cleanup(file);\n\treturn error;\n}",
          "includes": [
            "#include \"fileops.h\"",
            "#include \"filebuf.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const size_t WRITE_BUFFER_SIZE = (4096 * 2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fileops.h\"\n#include \"filebuf.h\"\n#include \"common.h\"\n\nstatic const size_t WRITE_BUFFER_SIZE = (4096 * 2);\n\nint git_filebuf_open(git_filebuf *file, const char *path, int flags, mode_t mode)\n{\n\tint compression, error = -1;\n\tsize_t path_len, alloc_len;\n\n\t/* opening an already open buffer is a programming error;\n\t * assert that this never happens instead of returning\n\t * an error code */\n\tassert(file && path && file->buffer == NULL);\n\n\tmemset(file, 0x0, sizeof(git_filebuf));\n\n\tif (flags & GIT_FILEBUF_DO_NOT_BUFFER)\n\t\tfile->do_not_buffer = true;\n\n\tfile->buf_size = WRITE_BUFFER_SIZE;\n\tfile->buf_pos = 0;\n\tfile->fd = -1;\n\tfile->last_error = BUFERR_OK;\n\n\t/* Allocate the main cache buffer */\n\tif (!file->do_not_buffer) {\n\t\tfile->buffer = git__malloc(file->buf_size);\n\t\tGITERR_CHECK_ALLOC(file->buffer);\n\t}\n\n\t/* If we are hashing on-write, allocate a new hash context */\n\tif (flags & GIT_FILEBUF_HASH_CONTENTS) {\n\t\tfile->compute_digest = 1;\n\n\t\tif (git_hash_ctx_init(&file->digest) < 0)\n\t\t\tgoto cleanup;\n\t}\n\n\tcompression = flags >> GIT_FILEBUF_DEFLATE_SHIFT;\n\n\t/* If we are deflating on-write, */\n\tif (compression != 0) {\n\t\t/* Initialize the ZLib stream */\n\t\tif (deflateInit(&file->zs, compression) != Z_OK) {\n\t\t\tgiterr_set(GITERR_ZLIB, \"Failed to initialize zlib\");\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\t/* Allocate the Zlib cache buffer */\n\t\tfile->z_buf = git__malloc(file->buf_size);\n\t\tGITERR_CHECK_ALLOC(file->z_buf);\n\n\t\t/* Never flush */\n\t\tfile->flush_mode = Z_NO_FLUSH;\n\t\tfile->write = &write_deflate;\n\t} else {\n\t\tfile->write = &write_normal;\n\t}\n\n\t/* If we are writing to a temp file */\n\tif (flags & GIT_FILEBUF_TEMPORARY) {\n\t\tgit_buf tmp_path = GIT_BUF_INIT;\n\n\t\t/* Open the file as temporary for locking */\n\t\tfile->fd = git_futils_mktmp(&tmp_path, path, mode);\n\n\t\tif (file->fd < 0) {\n\t\t\tgit_buf_free(&tmp_path);\n\t\t\tgoto cleanup;\n\t\t}\n\t\tfile->fd_is_open = true;\n\t\tfile->created_lock = true;\n\n\t\t/* No original path */\n\t\tfile->path_original = NULL;\n\t\tfile->path_lock = git_buf_detach(&tmp_path);\n\t\tGITERR_CHECK_ALLOC(file->path_lock);\n\t} else {\n\t\tgit_buf resolved_path = GIT_BUF_INIT;\n\n\t\tif ((error = resolve_symlink(&resolved_path, path)) < 0)\n\t\t\tgoto cleanup;\n\n\t\t/* Save the original path of the file */\n\t\tpath_len = resolved_path.size;\n\t\tfile->path_original = git_buf_detach(&resolved_path);\n\n\t\t/* create the locking path by appending \".lock\" to the original */\n\t\tGITERR_CHECK_ALLOC_ADD(&alloc_len, path_len, GIT_FILELOCK_EXTLENGTH);\n\t\tfile->path_lock = git__malloc(alloc_len);\n\t\tGITERR_CHECK_ALLOC(file->path_lock);\n\n\t\tmemcpy(file->path_lock, file->path_original, path_len);\n\t\tmemcpy(file->path_lock + path_len, GIT_FILELOCK_EXTENSION, GIT_FILELOCK_EXTLENGTH);\n\n\t\tif (git_path_isdir(file->path_original)) {\n\t\t\tgiterr_set(GITERR_FILESYSTEM, \"path '%s' is a directory\", file->path_original);\n\t\t\terror = GIT_EDIRECTORY;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\t/* open the file for locking */\n\t\tif ((error = lock_file(file, flags, mode)) < 0)\n\t\t\tgoto cleanup;\n\n\t\tfile->created_lock = true;\n\t}\n\n\treturn 0;\n\ncleanup:\n\tgit_filebuf_cleanup(file);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&ref_path",
            "git_dir",
            "GIT_HEAD_FILE"
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_BRANCH_MASTER \"master\"\n\nstatic int repo_init_create_head(const char *git_dir, const char *ref_name)\n{\n\tgit_buf ref_path = GIT_BUF_INIT;\n\tgit_filebuf ref = GIT_FILEBUF_INIT;\n\tconst char *fmt;\n\n\tif (git_buf_joinpath(&ref_path, git_dir, GIT_HEAD_FILE) < 0 ||\n\t\tgit_filebuf_open(&ref, ref_path.ptr, 0, GIT_REFS_FILE_MODE) < 0)\n\t\tgoto fail;\n\n\tif (!ref_name)\n\t\tref_name = GIT_BRANCH_MASTER;\n\n\tif (git__prefixcmp(ref_name, GIT_REFS_DIR) == 0)\n\t\tfmt = \"ref: %s\\n\";\n\telse\n\t\tfmt = \"ref: \" GIT_REFS_HEADS_DIR \"%s\\n\";\n\n\tif (git_filebuf_printf(&ref, fmt, ref_name) < 0 ||\n\t\tgit_filebuf_commit(&ref) < 0)\n\t\tgoto fail;\n\n\tgit_buf_free(&ref_path);\n\treturn 0;\n\nfail:\n\tgit_buf_free(&ref_path);\n\tgit_filebuf_cleanup(&ref);\n\treturn -1;\n}"
  },
  {
    "function_name": "check_repositoryformatversion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "986-1006",
    "snippet": "static int check_repositoryformatversion(git_config *config)\n{\n\tint version, error;\n\n\terror = git_config_get_int32(&version, config, \"core.repositoryformatversion\");\n\t/* git ignores this if the config variable isn't there */\n\tif (error == GIT_ENOTFOUND)\n\t\treturn 0;\n\n\tif (error < 0)\n\t\treturn -1;\n\n\tif (GIT_REPO_VERSION < version) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Unsupported repository version %d. Only versions up to %d are supported.\",\n\t\t\tversion, GIT_REPO_VERSION);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [
      "#define GIT_REPO_VERSION 0"
    ],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"Unsupported repository version %d. Only versions up to %d are supported.\"",
            "version",
            "GIT_REPO_VERSION"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_get_int32",
          "args": [
            "&version",
            "config",
            "\"core.repositoryformatversion\""
          ],
          "line": 990
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_get_int32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "780-792",
          "snippet": "int git_config_get_int32(int32_t *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_int32(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_int32(int32_t *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_int32(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_REPO_VERSION 0\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int check_repositoryformatversion(git_config *config)\n{\n\tint version, error;\n\n\terror = git_config_get_int32(&version, config, \"core.repositoryformatversion\");\n\t/* git ignores this if the config variable isn't there */\n\tif (error == GIT_ENOTFOUND)\n\t\treturn 0;\n\n\tif (error < 0)\n\t\treturn -1;\n\n\tif (GIT_REPO_VERSION < version) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Unsupported repository version %d. Only versions up to %d are supported.\",\n\t\t\tversion, GIT_REPO_VERSION);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository__reserved_names",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "969-983",
    "snippet": "bool git_repository__reserved_names(\n\tgit_buf **out, size_t *outlen, git_repository *repo, bool include_ntfs)\n{\n\tGIT_UNUSED(repo);\n\n\tif (include_ntfs) {\n\t\t*out = git_repository__reserved_names_win32;\n\t\t*outlen = git_repository__reserved_names_win32_len;\n\t} else {\n\t\t*out = git_repository__reserved_names_posix;\n\t\t*outlen = git_repository__reserved_names_posix_len;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "git_buf git_repository__reserved_names_win32[] = {\n\t{ DOT_GIT, 0, CONST_STRLEN(DOT_GIT) },\n\t{ GIT_DIR_SHORTNAME, 0, CONST_STRLEN(GIT_DIR_SHORTNAME) }\n};",
      "size_t git_repository__reserved_names_win32_len = 2;",
      "git_buf git_repository__reserved_names_posix[] = {\n\t{ DOT_GIT, 0, CONST_STRLEN(DOT_GIT) },\n};",
      "size_t git_repository__reserved_names_posix_len = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "repo"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\ngit_buf git_repository__reserved_names_win32[] = {\n\t{ DOT_GIT, 0, CONST_STRLEN(DOT_GIT) },\n\t{ GIT_DIR_SHORTNAME, 0, CONST_STRLEN(GIT_DIR_SHORTNAME) }\n};\nsize_t git_repository__reserved_names_win32_len = 2;\ngit_buf git_repository__reserved_names_posix[] = {\n\t{ DOT_GIT, 0, CONST_STRLEN(DOT_GIT) },\n};\nsize_t git_repository__reserved_names_posix_len = 1;\n\nbool git_repository__reserved_names(\n\tgit_buf **out, size_t *outlen, git_repository *repo, bool include_ntfs)\n{\n\tGIT_UNUSED(repo);\n\n\tif (include_ntfs) {\n\t\t*out = git_repository__reserved_names_win32;\n\t\t*outlen = git_repository__reserved_names_win32_len;\n\t} else {\n\t\t*out = git_repository__reserved_names_posix;\n\t\t*outlen = git_repository__reserved_names_posix_len;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "git_repository__reserved_names",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "912-967",
    "snippet": "bool git_repository__reserved_names(\n\tgit_buf **out, size_t *outlen, git_repository *repo, bool include_ntfs)\n{\n\tGIT_UNUSED(include_ntfs);\n\n\tif (repo->reserved_names.size == 0) {\n\t\tgit_buf *buf;\n\t\tsize_t i;\n\n\t\t/* Add the static defaults */\n\t\tfor (i = 0; i < git_repository__reserved_names_win32_len; i++) {\n\t\t\tif ((buf = git_array_alloc(repo->reserved_names)) == NULL)\n\t\t\t\tgoto on_error;\n\n\t\t\tbuf->ptr = git_repository__reserved_names_win32[i].ptr;\n\t\t\tbuf->size = git_repository__reserved_names_win32[i].size;\n\t\t}\n\n\t\t/* Try to add any repo-specific reserved names - the gitlink file\n\t\t * within a submodule or the repository (if the repository directory\n\t\t * is beneath the workdir).  These are typically `.git`, but should\n\t\t * be protected in case they are not.  Note, repo and workdir paths\n\t\t * are always prettified to end in `/`, so a prefixcmp is safe.\n\t\t */\n\t\tif (!repo->is_bare) {\n\t\t\tint (*prefixcmp)(const char *, const char *);\n\t\t\tint error, ignorecase;\n\n\t\t\terror = git_repository__cvar(\n\t\t\t\t&ignorecase, repo, GIT_CVAR_IGNORECASE);\n\t\t\tprefixcmp = (error || ignorecase) ? git__prefixcmp_icase :\n\t\t\t\tgit__prefixcmp;\n\n\t\t\tif (repo->path_gitlink &&\n\t\t\t\treserved_names_add8dot3(repo, repo->path_gitlink) < 0)\n\t\t\t\tgoto on_error;\n\n\t\t\tif (repo->path_repository &&\n\t\t\t\tprefixcmp(repo->path_repository, repo->workdir) == 0 &&\n\t\t\t\treserved_names_add8dot3(repo, repo->path_repository) < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\t*out = repo->reserved_names.ptr;\n\t*outlen = repo->reserved_names.size;\n\n\treturn true;\n\n\t/* Always give good defaults, even on OOM */\non_error:\n\t*out = git_repository__reserved_names_win32;\n\t*outlen = git_repository__reserved_names_win32_len;\n\n\treturn false;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "git_buf git_repository__reserved_names_win32[] = {\n\t{ DOT_GIT, 0, CONST_STRLEN(DOT_GIT) },\n\t{ GIT_DIR_SHORTNAME, 0, CONST_STRLEN(GIT_DIR_SHORTNAME) }\n};",
      "size_t git_repository__reserved_names_win32_len = 2;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "reserved_names_add8dot3",
          "args": [
            "repo",
            "repo->path_repository"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "reserved_names_add8dot3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "885-910",
          "snippet": "static int reserved_names_add8dot3(git_repository *repo, const char *path)\n{\n\tchar *name = git_win32_path_8dot3_name(path);\n\tconst char *def = GIT_DIR_SHORTNAME;\n\tconst char *def_dot_git = DOT_GIT;\n\tsize_t name_len, def_len = CONST_STRLEN(GIT_DIR_SHORTNAME);\n\tsize_t def_dot_git_len = CONST_STRLEN(DOT_GIT);\n\tgit_buf *buf;\n\n\tif (!name)\n\t\treturn 0;\n\n\tname_len = strlen(name);\n\n\tif ((name_len == def_len && memcmp(name, def, def_len) == 0) || \n\t\t(name_len == def_dot_git_len && memcmp(name, def_dot_git, def_dot_git_len) == 0)) {\n\t\tgit__free(name);\n\t\treturn 0;\n\t}\n\n\tif ((buf = git_array_alloc(repo->reserved_names)) == NULL)\n\t\treturn -1;\n\n\tgit_buf_attach(buf, name, name_len);\n\treturn true;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int reserved_names_add8dot3(git_repository *repo, const char *path)\n{\n\tchar *name = git_win32_path_8dot3_name(path);\n\tconst char *def = GIT_DIR_SHORTNAME;\n\tconst char *def_dot_git = DOT_GIT;\n\tsize_t name_len, def_len = CONST_STRLEN(GIT_DIR_SHORTNAME);\n\tsize_t def_dot_git_len = CONST_STRLEN(DOT_GIT);\n\tgit_buf *buf;\n\n\tif (!name)\n\t\treturn 0;\n\n\tname_len = strlen(name);\n\n\tif ((name_len == def_len && memcmp(name, def, def_len) == 0) || \n\t\t(name_len == def_dot_git_len && memcmp(name, def_dot_git, def_dot_git_len) == 0)) {\n\t\tgit__free(name);\n\t\treturn 0;\n\t}\n\n\tif ((buf = git_array_alloc(repo->reserved_names)) == NULL)\n\t\treturn -1;\n\n\tgit_buf_attach(buf, name, name_len);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prefixcmp",
          "args": [
            "repo->path_repository",
            "repo->workdir"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "git__prefixcmp_icase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "252-255",
          "snippet": "int git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__prefixcmp_icase(const char *str, const char *prefix)\n{\n\treturn strncasecmp(str, prefix, strlen(prefix));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository__cvar",
          "args": [
            "&ignorecase",
            "repo",
            "GIT_CVAR_IGNORECASE"
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__cvar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
          "lines": "104-120",
          "snippet": "int git_repository__cvar(int *out, git_repository *repo, git_cvar_cached cvar)\n{\n\t*out = repo->cvar_cache[(int)cvar];\n\n\tif (*out == GIT_CVAR_NOT_CACHED) {\n\t\tint error;\n\t\tgit_config *config;\n\n\t\tif ((error = git_repository_config__weakptr(&config, repo)) < 0 ||\n\t\t\t(error = git_config__cvar(out, config, cvar)) < 0)\n\t\t\treturn error;\n\n\t\trepo->cvar_cache[(int)cvar] = *out;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"vector.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"repository.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_repository__cvar(int *out, git_repository *repo, git_cvar_cached cvar)\n{\n\t*out = repo->cvar_cache[(int)cvar];\n\n\tif (*out == GIT_CVAR_NOT_CACHED) {\n\t\tint error;\n\t\tgit_config *config;\n\n\t\tif ((error = git_repository_config__weakptr(&config, repo)) < 0 ||\n\t\t\t(error = git_config__cvar(out, config, cvar)) < 0)\n\t\t\treturn error;\n\n\t\trepo->cvar_cache[(int)cvar] = *out;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "repo->reserved_names"
          ],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_UNUSED",
          "args": [
            "include_ntfs"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\ngit_buf git_repository__reserved_names_win32[] = {\n\t{ DOT_GIT, 0, CONST_STRLEN(DOT_GIT) },\n\t{ GIT_DIR_SHORTNAME, 0, CONST_STRLEN(GIT_DIR_SHORTNAME) }\n};\nsize_t git_repository__reserved_names_win32_len = 2;\n\nbool git_repository__reserved_names(\n\tgit_buf **out, size_t *outlen, git_repository *repo, bool include_ntfs)\n{\n\tGIT_UNUSED(include_ntfs);\n\n\tif (repo->reserved_names.size == 0) {\n\t\tgit_buf *buf;\n\t\tsize_t i;\n\n\t\t/* Add the static defaults */\n\t\tfor (i = 0; i < git_repository__reserved_names_win32_len; i++) {\n\t\t\tif ((buf = git_array_alloc(repo->reserved_names)) == NULL)\n\t\t\t\tgoto on_error;\n\n\t\t\tbuf->ptr = git_repository__reserved_names_win32[i].ptr;\n\t\t\tbuf->size = git_repository__reserved_names_win32[i].size;\n\t\t}\n\n\t\t/* Try to add any repo-specific reserved names - the gitlink file\n\t\t * within a submodule or the repository (if the repository directory\n\t\t * is beneath the workdir).  These are typically `.git`, but should\n\t\t * be protected in case they are not.  Note, repo and workdir paths\n\t\t * are always prettified to end in `/`, so a prefixcmp is safe.\n\t\t */\n\t\tif (!repo->is_bare) {\n\t\t\tint (*prefixcmp)(const char *, const char *);\n\t\t\tint error, ignorecase;\n\n\t\t\terror = git_repository__cvar(\n\t\t\t\t&ignorecase, repo, GIT_CVAR_IGNORECASE);\n\t\t\tprefixcmp = (error || ignorecase) ? git__prefixcmp_icase :\n\t\t\t\tgit__prefixcmp;\n\n\t\t\tif (repo->path_gitlink &&\n\t\t\t\treserved_names_add8dot3(repo, repo->path_gitlink) < 0)\n\t\t\t\tgoto on_error;\n\n\t\t\tif (repo->path_repository &&\n\t\t\t\tprefixcmp(repo->path_repository, repo->workdir) == 0 &&\n\t\t\t\treserved_names_add8dot3(repo, repo->path_repository) < 0)\n\t\t\t\tgoto on_error;\n\t\t}\n\t}\n\n\t*out = repo->reserved_names.ptr;\n\t*outlen = repo->reserved_names.size;\n\n\treturn true;\n\n\t/* Always give good defaults, even on OOM */\non_error:\n\t*out = git_repository__reserved_names_win32;\n\t*outlen = git_repository__reserved_names_win32_len;\n\n\treturn false;\n}"
  },
  {
    "function_name": "reserved_names_add8dot3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "885-910",
    "snippet": "static int reserved_names_add8dot3(git_repository *repo, const char *path)\n{\n\tchar *name = git_win32_path_8dot3_name(path);\n\tconst char *def = GIT_DIR_SHORTNAME;\n\tconst char *def_dot_git = DOT_GIT;\n\tsize_t name_len, def_len = CONST_STRLEN(GIT_DIR_SHORTNAME);\n\tsize_t def_dot_git_len = CONST_STRLEN(DOT_GIT);\n\tgit_buf *buf;\n\n\tif (!name)\n\t\treturn 0;\n\n\tname_len = strlen(name);\n\n\tif ((name_len == def_len && memcmp(name, def, def_len) == 0) || \n\t\t(name_len == def_dot_git_len && memcmp(name, def_dot_git, def_dot_git_len) == 0)) {\n\t\tgit__free(name);\n\t\treturn 0;\n\t}\n\n\tif ((buf = git_array_alloc(repo->reserved_names)) == NULL)\n\t\treturn -1;\n\n\tgit_buf_attach(buf, name, name_len);\n\treturn true;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_attach",
          "args": [
            "buf",
            "name",
            "name_len"
          ],
          "line": 908
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_attach_notowned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "505-517",
          "snippet": "void git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_attach_notowned(git_buf *buf, const char *ptr, size_t size)\n{\n\tif (git_buf_is_allocated(buf))\n\t\tgit_buf_free(buf);\n\n\tif (!size) {\n\t\tgit_buf_init(buf, 0);\n\t} else {\n\t\tbuf->ptr = (char *)ptr;\n\t\tbuf->asize = 0;\n\t\tbuf->size = size;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_alloc",
          "args": [
            "repo->reserved_names"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "name"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "name",
            "def_dot_git",
            "def_dot_git_len"
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "name",
            "def",
            "def_len"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CONST_STRLEN",
          "args": [
            "DOT_GIT"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CONST_STRLEN",
          "args": [
            "GIT_DIR_SHORTNAME"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_win32_path_8dot3_name",
          "args": [
            "path"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "git_win32_path_8dot3_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/path_w32.c",
          "lines": "281-315",
          "snippet": "char *git_win32_path_8dot3_name(const char *path)\n{\n\tgit_win32_path longpath, shortpath;\n\twchar_t *start;\n\tchar *shortname;\n\tint len, namelen = 1;\n\n\tif (git_win32_path_from_utf8(longpath, path) < 0)\n\t\treturn NULL;\n\n\tlen = GetShortPathNameW(longpath, shortpath, GIT_WIN_PATH_UTF16);\n\n\twhile (len && shortpath[len-1] == L'\\\\')\n\t\tshortpath[--len] = L'\\0';\n\n\tif (len == 0 || len >= GIT_WIN_PATH_UTF16)\n\t\treturn NULL;\n\n\tfor (start = shortpath + (len - 1);\n\t\tstart > shortpath && *(start-1) != '/' && *(start-1) != '\\\\';\n\t\tstart--)\n\t\tnamelen++;\n\n\t/* We may not have actually been given a short name.  But if we have,\n\t * it will be in the ASCII byte range, so we don't need to worry about\n\t * multi-byte sequences and can allocate naively.\n\t */\n\tif (namelen > 12 || (shortname = git__malloc(namelen + 1)) == NULL)\n\t\treturn NULL;\n\n\tif ((len = git__utf16_to_8(shortname, namelen + 1, start)) < 0)\n\t\treturn NULL;\n\n\treturn shortname;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"reparse.h\"",
            "#include \"posix.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"reparse.h\"\n#include \"posix.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nchar *git_win32_path_8dot3_name(const char *path)\n{\n\tgit_win32_path longpath, shortpath;\n\twchar_t *start;\n\tchar *shortname;\n\tint len, namelen = 1;\n\n\tif (git_win32_path_from_utf8(longpath, path) < 0)\n\t\treturn NULL;\n\n\tlen = GetShortPathNameW(longpath, shortpath, GIT_WIN_PATH_UTF16);\n\n\twhile (len && shortpath[len-1] == L'\\\\')\n\t\tshortpath[--len] = L'\\0';\n\n\tif (len == 0 || len >= GIT_WIN_PATH_UTF16)\n\t\treturn NULL;\n\n\tfor (start = shortpath + (len - 1);\n\t\tstart > shortpath && *(start-1) != '/' && *(start-1) != '\\\\';\n\t\tstart--)\n\t\tnamelen++;\n\n\t/* We may not have actually been given a short name.  But if we have,\n\t * it will be in the ASCII byte range, so we don't need to worry about\n\t * multi-byte sequences and can allocate naively.\n\t */\n\tif (namelen > 12 || (shortname = git__malloc(namelen + 1)) == NULL)\n\t\treturn NULL;\n\n\tif ((len = git__utf16_to_8(shortname, namelen + 1, start)) < 0)\n\t\treturn NULL;\n\n\treturn shortname;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int reserved_names_add8dot3(git_repository *repo, const char *path)\n{\n\tchar *name = git_win32_path_8dot3_name(path);\n\tconst char *def = GIT_DIR_SHORTNAME;\n\tconst char *def_dot_git = DOT_GIT;\n\tsize_t name_len, def_len = CONST_STRLEN(GIT_DIR_SHORTNAME);\n\tsize_t def_dot_git_len = CONST_STRLEN(DOT_GIT);\n\tgit_buf *buf;\n\n\tif (!name)\n\t\treturn 0;\n\n\tname_len = strlen(name);\n\n\tif ((name_len == def_len && memcmp(name, def, def_len) == 0) || \n\t\t(name_len == def_dot_git_len && memcmp(name, def_dot_git, def_dot_git_len) == 0)) {\n\t\tgit__free(name);\n\t\treturn 0;\n\t}\n\n\tif ((buf = git_array_alloc(repo->reserved_names)) == NULL)\n\t\treturn -1;\n\n\tgit_buf_attach(buf, name, name_len);\n\treturn true;\n}"
  },
  {
    "function_name": "git_repository_get_namespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "879-882",
    "snippet": "const char *git_repository_get_namespace(git_repository *repo)\n{\n\treturn repo->namespace;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nconst char *git_repository_get_namespace(git_repository *repo)\n{\n\treturn repo->namespace;\n}"
  },
  {
    "function_name": "git_repository_set_namespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "867-877",
    "snippet": "int git_repository_set_namespace(git_repository *repo, const char *namespace)\n{\n\tgit__free(repo->namespace);\n\n\tif (namespace == NULL) {\n\t\trepo->namespace = NULL;\n\t\treturn 0;\n\t}\n\n\treturn (repo->namespace = git__strdup(namespace)) ? 0 : -1;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__strdup",
          "args": [
            "namespace"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "git__strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "174-179",
          "snippet": "GIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(char *) git__strdup(const char *str)\n{\n\tchar *ptr = strdup(str);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "repo->namespace"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_set_namespace(git_repository *repo, const char *namespace)\n{\n\tgit__free(repo->namespace);\n\n\tif (namespace == NULL) {\n\t\trepo->namespace = NULL;\n\t\treturn 0;\n\t}\n\n\treturn (repo->namespace = git__strdup(namespace)) ? 0 : -1;\n}"
  },
  {
    "function_name": "git_repository_set_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "861-865",
    "snippet": "void git_repository_set_index(git_repository *repo, git_index *index)\n{\n\tassert(repo);\n\tset_index(repo, index);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_index",
          "args": [
            "repo",
            "index"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "861-865",
          "snippet": "void git_repository_set_index(git_repository *repo, git_index *index)\n{\n\tassert(repo);\n\tset_index(repo, index);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_set_index(git_repository *repo, git_index *index)\n{\n\tassert(repo);\n\tset_index(repo, index);\n}"
  },
  {
    "function_name": "git_repository_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "852-859",
    "snippet": "int git_repository_index(git_index **out, git_repository *repo)\n{\n\tif (git_repository_index__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "*out"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_index__weakptr",
          "args": [
            "out",
            "repo"
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_index__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "819-850",
          "snippet": "int git_repository_index__weakptr(git_index **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_index == NULL) {\n\t\tgit_buf index_path = GIT_BUF_INIT;\n\t\tgit_index *index;\n\n\t\tif ((error = git_buf_joinpath(&index_path, repo->path_repository, GIT_INDEX_FILE)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_index_open(&index, index_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(index, repo);\n\n\t\t\tindex = git__compare_and_swap(&repo->_index, NULL, index);\n\t\t\tif (index != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(index, NULL);\n\t\t\t\tgit_index_free(index);\n\t\t\t}\n\n\t\t\terror = git_index_set_caps(repo->_index, GIT_INDEXCAP_FROM_OWNER);\n\t\t}\n\n\t\tgit_buf_free(&index_path);\n\t}\n\n\t*out = repo->_index;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_index__weakptr(git_index **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_index == NULL) {\n\t\tgit_buf index_path = GIT_BUF_INIT;\n\t\tgit_index *index;\n\n\t\tif ((error = git_buf_joinpath(&index_path, repo->path_repository, GIT_INDEX_FILE)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_index_open(&index, index_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(index, repo);\n\n\t\t\tindex = git__compare_and_swap(&repo->_index, NULL, index);\n\t\t\tif (index != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(index, NULL);\n\t\t\t\tgit_index_free(index);\n\t\t\t}\n\n\t\t\terror = git_index_set_caps(repo->_index, GIT_INDEXCAP_FROM_OWNER);\n\t\t}\n\n\t\tgit_buf_free(&index_path);\n\t}\n\n\t*out = repo->_index;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_index(git_index **out, git_repository *repo)\n{\n\tif (git_repository_index__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_index__weakptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "819-850",
    "snippet": "int git_repository_index__weakptr(git_index **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_index == NULL) {\n\t\tgit_buf index_path = GIT_BUF_INIT;\n\t\tgit_index *index;\n\n\t\tif ((error = git_buf_joinpath(&index_path, repo->path_repository, GIT_INDEX_FILE)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_index_open(&index, index_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(index, repo);\n\n\t\t\tindex = git__compare_and_swap(&repo->_index, NULL, index);\n\t\t\tif (index != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(index, NULL);\n\t\t\t\tgit_index_free(index);\n\t\t\t}\n\n\t\t\terror = git_index_set_caps(repo->_index, GIT_INDEXCAP_FROM_OWNER);\n\t\t}\n\n\t\tgit_buf_free(&index_path);\n\t}\n\n\t*out = repo->_index;\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&index_path"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_set_caps",
          "args": [
            "repo->_index",
            "GIT_INDEXCAP_FROM_OWNER"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_set_caps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "554-588",
          "snippet": "int git_index_set_caps(git_index *index, int caps)\n{\n\tunsigned int old_ignore_case;\n\n\tassert(index);\n\n\told_ignore_case = index->ignore_case;\n\n\tif (caps == GIT_INDEXCAP_FROM_OWNER) {\n\t\tgit_repository *repo = INDEX_OWNER(index);\n\t\tint val;\n\n\t\tif (!repo)\n\t\t\treturn create_index_error(\n\t\t\t\t-1, \"Cannot access repository to set index caps\");\n\n\t\tif (!git_repository__cvar(&val, repo, GIT_CVAR_IGNORECASE))\n\t\t\tindex->ignore_case = (val != 0);\n\t\tif (!git_repository__cvar(&val, repo, GIT_CVAR_FILEMODE))\n\t\t\tindex->distrust_filemode = (val == 0);\n\t\tif (!git_repository__cvar(&val, repo, GIT_CVAR_SYMLINKS))\n\t\t\tindex->no_symlinks = (val == 0);\n\t}\n\telse {\n\t\tindex->ignore_case = ((caps & GIT_INDEXCAP_IGNORE_CASE) != 0);\n\t\tindex->distrust_filemode = ((caps & GIT_INDEXCAP_NO_FILEMODE) != 0);\n\t\tindex->no_symlinks = ((caps & GIT_INDEXCAP_NO_SYMLINKS) != 0);\n\t}\n\n\tif (old_ignore_case != index->ignore_case) {\n\t\tgit_index__set_ignore_case(index, (bool)index->ignore_case);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nint git_index_set_caps(git_index *index, int caps)\n{\n\tunsigned int old_ignore_case;\n\n\tassert(index);\n\n\told_ignore_case = index->ignore_case;\n\n\tif (caps == GIT_INDEXCAP_FROM_OWNER) {\n\t\tgit_repository *repo = INDEX_OWNER(index);\n\t\tint val;\n\n\t\tif (!repo)\n\t\t\treturn create_index_error(\n\t\t\t\t-1, \"Cannot access repository to set index caps\");\n\n\t\tif (!git_repository__cvar(&val, repo, GIT_CVAR_IGNORECASE))\n\t\t\tindex->ignore_case = (val != 0);\n\t\tif (!git_repository__cvar(&val, repo, GIT_CVAR_FILEMODE))\n\t\t\tindex->distrust_filemode = (val == 0);\n\t\tif (!git_repository__cvar(&val, repo, GIT_CVAR_SYMLINKS))\n\t\t\tindex->no_symlinks = (val == 0);\n\t}\n\telse {\n\t\tindex->ignore_case = ((caps & GIT_INDEXCAP_IGNORE_CASE) != 0);\n\t\tindex->distrust_filemode = ((caps & GIT_INDEXCAP_NO_FILEMODE) != 0);\n\t\tindex->no_symlinks = ((caps & GIT_INDEXCAP_NO_SYMLINKS) != 0);\n\t}\n\n\tif (old_ignore_case != index->ignore_case) {\n\t\tgit_index__set_ignore_case(index, (bool)index->ignore_case);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_index_free",
          "args": [
            "index"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "477-483",
          "snippet": "void git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nvoid git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "index",
            "NULL"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__compare_and_swap",
          "args": [
            "&repo->_index",
            "NULL",
            "index"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "index",
            "repo"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_index_open",
          "args": [
            "&index",
            "index_path.ptr"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "404-450",
          "snippet": "int git_index_open(git_index **index_out, const char *index_path)\n{\n\tgit_index *index;\n\tint error = -1;\n\n\tassert(index_out);\n\n\tindex = git__calloc(1, sizeof(git_index));\n\tGITERR_CHECK_ALLOC(index);\n\n\tgit_pool_init(&index->tree_pool, 1);\n\n\tif (index_path != NULL) {\n\t\tindex->index_file_path = git__strdup(index_path);\n\t\tif (!index->index_file_path)\n\t\t\tgoto fail;\n\n\t\t/* Check if index file is stored on disk already */\n\t\tif (git_path_exists(index->index_file_path) == true)\n\t\t\tindex->on_disk = 1;\n\t}\n\n\tif (git_vector_init(&index->entries, 32, git_index_entry_cmp) < 0 ||\n\t\tgit_idxmap_alloc(&index->entries_map) < 0 ||\n\t\tgit_vector_init(&index->names, 8, conflict_name_cmp) < 0 ||\n\t\tgit_vector_init(&index->reuc, 8, reuc_cmp) < 0 ||\n\t\tgit_vector_init(&index->deleted, 8, git_index_entry_cmp) < 0)\n\t\tgoto fail;\n\n\tindex->entries_cmp_path = git__strcmp_cb;\n\tindex->entries_search = git_index_entry_srch;\n\tindex->entries_search_path = index_entry_srch_path;\n\tindex->reuc_search = reuc_srch;\n\n\tif (index_path != NULL && (error = git_index_read(index, true)) < 0)\n\t\tgoto fail;\n\n\t*index_out = index;\n\tGIT_REFCOUNT_INC(index);\n\n\treturn 0;\n\nfail:\n\tgit_pool_clear(&index->tree_pool);\n\tgit_index_free(index);\n\treturn error;\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);",
            "static int write_index(git_oid *checksum, git_index *index, git_filebuf *file);",
            "static void index_entry_reuc_free(git_index_reuc_entry *reuc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\nstatic int write_index(git_oid *checksum, git_index *index, git_filebuf *file);\nstatic void index_entry_reuc_free(git_index_reuc_entry *reuc);\n\nint git_index_open(git_index **index_out, const char *index_path)\n{\n\tgit_index *index;\n\tint error = -1;\n\n\tassert(index_out);\n\n\tindex = git__calloc(1, sizeof(git_index));\n\tGITERR_CHECK_ALLOC(index);\n\n\tgit_pool_init(&index->tree_pool, 1);\n\n\tif (index_path != NULL) {\n\t\tindex->index_file_path = git__strdup(index_path);\n\t\tif (!index->index_file_path)\n\t\t\tgoto fail;\n\n\t\t/* Check if index file is stored on disk already */\n\t\tif (git_path_exists(index->index_file_path) == true)\n\t\t\tindex->on_disk = 1;\n\t}\n\n\tif (git_vector_init(&index->entries, 32, git_index_entry_cmp) < 0 ||\n\t\tgit_idxmap_alloc(&index->entries_map) < 0 ||\n\t\tgit_vector_init(&index->names, 8, conflict_name_cmp) < 0 ||\n\t\tgit_vector_init(&index->reuc, 8, reuc_cmp) < 0 ||\n\t\tgit_vector_init(&index->deleted, 8, git_index_entry_cmp) < 0)\n\t\tgoto fail;\n\n\tindex->entries_cmp_path = git__strcmp_cb;\n\tindex->entries_search = git_index_entry_srch;\n\tindex->entries_search_path = index_entry_srch_path;\n\tindex->reuc_search = reuc_srch;\n\n\tif (index_path != NULL && (error = git_index_read(index, true)) < 0)\n\t\tgoto fail;\n\n\t*index_out = index;\n\tGIT_REFCOUNT_INC(index);\n\n\treturn 0;\n\nfail:\n\tgit_pool_clear(&index->tree_pool);\n\tgit_index_free(index);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&index_path",
            "repo->path_repository",
            "GIT_INDEX_FILE"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_index__weakptr(git_index **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_index == NULL) {\n\t\tgit_buf index_path = GIT_BUF_INIT;\n\t\tgit_index *index;\n\n\t\tif ((error = git_buf_joinpath(&index_path, repo->path_repository, GIT_INDEX_FILE)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_index_open(&index, index_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(index, repo);\n\n\t\t\tindex = git__compare_and_swap(&repo->_index, NULL, index);\n\t\t\tif (index != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(index, NULL);\n\t\t\t\tgit_index_free(index);\n\t\t\t}\n\n\t\t\terror = git_index_set_caps(repo->_index, GIT_INDEXCAP_FROM_OWNER);\n\t\t}\n\n\t\tgit_buf_free(&index_path);\n\t}\n\n\t*out = repo->_index;\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_set_refdb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "813-817",
    "snippet": "void git_repository_set_refdb(git_repository *repo, git_refdb *refdb)\n{\n\tassert(repo && refdb);\n\tset_refdb(repo, refdb);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_refdb",
          "args": [
            "repo",
            "refdb"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_refdb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "813-817",
          "snippet": "void git_repository_set_refdb(git_repository *repo, git_refdb *refdb)\n{\n\tassert(repo && refdb);\n\tset_refdb(repo, refdb);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && refdb"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_set_refdb(git_repository *repo, git_refdb *refdb)\n{\n\tassert(repo && refdb);\n\tset_refdb(repo, refdb);\n}"
  },
  {
    "function_name": "git_repository_refdb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "804-811",
    "snippet": "int git_repository_refdb(git_refdb **out, git_repository *repo)\n{\n\tif (git_repository_refdb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "*out"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_refdb__weakptr",
          "args": [
            "out",
            "repo"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_refdb__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "779-802",
          "snippet": "int git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_refdb(git_refdb **out, git_repository *repo)\n{\n\tif (git_repository_refdb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_refdb__weakptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "779-802",
    "snippet": "int git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_refdb_free",
          "args": [
            "refdb"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "git_refdb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
          "lines": "93-99",
          "snippet": "void git_refdb_free(git_refdb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, git_refdb__free);\n}",
          "includes": [
            "#include \"reflog.h\"",
            "#include \"refs.h\"",
            "#include \"refdb.h\"",
            "#include \"hash.h\"",
            "#include \"git2/sys/refdb_backend.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/object.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid git_refdb_free(git_refdb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, git_refdb__free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "refdb",
            "NULL"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__compare_and_swap",
          "args": [
            "&repo->_refdb",
            "NULL",
            "refdb"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "refdb",
            "repo"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_refdb_open",
          "args": [
            "&refdb",
            "repo"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "git_refdb_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
          "lines": "37-60",
          "snippet": "int git_refdb_open(git_refdb **out, git_repository *repo)\n{\n\tgit_refdb *db;\n\tgit_refdb_backend *dir;\n\n\tassert(out && repo);\n\n\t*out = NULL;\n\n\tif (git_refdb_new(&db, repo) < 0)\n\t\treturn -1;\n\n\t/* Add the default (filesystem) backend */\n\tif (git_refdb_backend_fs(&dir, repo) < 0) {\n\t\tgit_refdb_free(db);\n\t\treturn -1;\n\t}\n\n\tdb->repo = repo;\n\tdb->backend = dir;\n\n\t*out = db;\n\treturn 0;\n}",
          "includes": [
            "#include \"reflog.h\"",
            "#include \"refs.h\"",
            "#include \"refdb.h\"",
            "#include \"hash.h\"",
            "#include \"git2/sys/refdb_backend.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/object.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nint git_refdb_open(git_refdb **out, git_repository *repo)\n{\n\tgit_refdb *db;\n\tgit_refdb_backend *dir;\n\n\tassert(out && repo);\n\n\t*out = NULL;\n\n\tif (git_refdb_new(&db, repo) < 0)\n\t\treturn -1;\n\n\t/* Add the default (filesystem) backend */\n\tif (git_refdb_backend_fs(&dir, repo) < 0) {\n\t\tgit_refdb_free(db);\n\t\treturn -1;\n\t}\n\n\tdb->repo = repo;\n\tdb->backend = dir;\n\n\t*out = db;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "out && repo"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_refdb__weakptr(git_refdb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(out && repo);\n\n\tif (repo->_refdb == NULL) {\n\t\tgit_refdb *refdb;\n\n\t\terror = git_refdb_open(&refdb, repo);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\n\t\t\trefdb = git__compare_and_swap(&repo->_refdb, NULL, refdb);\n\t\t\tif (refdb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\t\t\tgit_refdb_free(refdb);\n\t\t\t}\n\t\t}\n\t}\n\n\t*out = repo->_refdb;\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_set_odb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "773-777",
    "snippet": "void git_repository_set_odb(git_repository *repo, git_odb *odb)\n{\n\tassert(repo && odb);\n\tset_odb(repo, odb);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_odb",
          "args": [
            "repo",
            "odb"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_odb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "773-777",
          "snippet": "void git_repository_set_odb(git_repository *repo, git_odb *odb)\n{\n\tassert(repo && odb);\n\tset_odb(repo, odb);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && odb"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_set_odb(git_repository *repo, git_odb *odb)\n{\n\tassert(repo && odb);\n\tset_odb(repo, odb);\n}"
  },
  {
    "function_name": "git_repository_odb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "764-771",
    "snippet": "int git_repository_odb(git_odb **out, git_repository *repo)\n{\n\tif (git_repository_odb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "*out"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_odb__weakptr",
          "args": [
            "out",
            "repo"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_odb__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "733-762",
          "snippet": "int git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb(git_odb **out, git_repository *repo)\n{\n\tif (git_repository_odb__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_odb__weakptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "733-762",
    "snippet": "int git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&odb_path"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_odb_free",
          "args": [
            "odb"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "619-625",
          "snippet": "void git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "odb",
            "NULL"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__compare_and_swap",
          "args": [
            "&repo->_odb",
            "NULL",
            "odb"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "odb",
            "repo"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_odb_open",
          "args": [
            "&odb",
            "odb_path.ptr"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "579-597",
          "snippet": "int git_odb_open(git_odb **out, const char *objects_dir)\n{\n\tgit_odb *db;\n\n\tassert(out && objects_dir);\n\n\t*out = NULL;\n\n\tif (git_odb_new(&db) < 0)\n\t\treturn -1;\n\n\tif (add_default_backends(db, objects_dir, 0, 0) < 0) {\n\t\tgit_odb_free(db);\n\t\treturn -1;\n\t}\n\n\t*out = db;\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nint git_odb_open(git_odb **out, const char *objects_dir)\n{\n\tgit_odb *db;\n\n\tassert(out && objects_dir);\n\n\t*out = NULL;\n\n\tif (git_odb_new(&db) < 0)\n\t\treturn -1;\n\n\tif (add_default_backends(db, objects_dir, 0, 0) < 0) {\n\t\tgit_odb_free(db);\n\t\treturn -1;\n\t}\n\n\t*out = db;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&odb_path",
            "repo->path_repository",
            "GIT_OBJECTS_DIR"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && out"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_odb__weakptr(git_odb **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tassert(repo && out);\n\n\tif (repo->_odb == NULL) {\n\t\tgit_buf odb_path = GIT_BUF_INIT;\n\t\tgit_odb *odb;\n\n\t\tif ((error = git_buf_joinpath(&odb_path, repo->path_repository, GIT_OBJECTS_DIR)) < 0)\n\t\t\treturn error;\n\n\t\terror = git_odb_open(&odb, odb_path.ptr);\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(odb, repo);\n\n\t\t\todb = git__compare_and_swap(&repo->_odb, NULL, odb);\n\t\t\tif (odb != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\t\t\tgit_odb_free(odb);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&odb_path);\n\t}\n\n\t*out = repo->_odb;\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_set_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "727-731",
    "snippet": "void git_repository_set_config(git_repository *repo, git_config *config)\n{\n\tassert(repo && config);\n\tset_config(repo, config);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_config",
          "args": [
            "repo",
            "config"
          ],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "727-731",
          "snippet": "void git_repository_set_config(git_repository *repo, git_config *config)\n{\n\tassert(repo && config);\n\tset_config(repo, config);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && config"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nvoid git_repository_set_config(git_repository *repo, git_config *config)\n{\n\tassert(repo && config);\n\tset_config(repo, config);\n}"
  },
  {
    "function_name": "git_repository_config_snapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "716-725",
    "snippet": "int git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_snapshot",
          "args": [
            "out",
            "weak"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_snapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "149-179",
          "snippet": "int git_config_snapshot(git_config **out, git_config *in)\n{\n\tint error = 0;\n\tsize_t i;\n\tfile_internal *internal;\n\tgit_config *config;\n\n\t*out = NULL;\n\n\tif (git_config_new(&config) < 0)\n\t\treturn -1;\n\n\tgit_vector_foreach(&in->files, i, internal) {\n\t\tgit_config_backend *b;\n\n\t\tif ((error = internal->file->snapshot(&b, internal->file)) < 0)\n\t\t\tbreak;\n\n\t\tif ((error = git_config_add_backend(config, b, internal->level, 0)) < 0) {\n\t\t\tb->free(b);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error < 0)\n\t\tgit_config_free(config);\n\telse\n\t\t*out = config;\n\n\treturn error;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_snapshot(git_config **out, git_config *in)\n{\n\tint error = 0;\n\tsize_t i;\n\tfile_internal *internal;\n\tgit_config *config;\n\n\t*out = NULL;\n\n\tif (git_config_new(&config) < 0)\n\t\treturn -1;\n\n\tgit_vector_foreach(&in->files, i, internal) {\n\t\tgit_config_backend *b;\n\n\t\tif ((error = internal->file->snapshot(&b, internal->file)) < 0)\n\t\t\tbreak;\n\n\t\tif ((error = git_config_add_backend(config, b, internal->level, 0)) < 0) {\n\t\t\tb->free(b);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (error < 0)\n\t\tgit_config_free(config);\n\telse\n\t\t*out = config;\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config__weakptr",
          "args": [
            "&weak",
            "repo"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "661-705",
          "snippet": "int git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}"
  },
  {
    "function_name": "git_repository_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "707-714",
    "snippet": "int git_repository_config(git_config **out, git_repository *repo)\n{\n\tif (git_repository_config__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "*out"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_repository_config__weakptr",
          "args": [
            "out",
            "repo"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config__weakptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "661-705",
          "snippet": "int git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_config(git_config **out, git_repository *repo)\n{\n\tif (git_repository_config__weakptr(out, repo) < 0)\n\t\treturn -1;\n\n\tGIT_REFCOUNT_INC(*out);\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_config__weakptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "661-705",
    "snippet": "int git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&programdata_buf"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "config"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "config",
            "NULL"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__compare_and_swap",
          "args": [
            "&repo->_config",
            "NULL",
            "config"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "config",
            "repo"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "load_config",
          "args": [
            "&config",
            "repo",
            "path_unless_empty(&global_buf)",
            "path_unless_empty(&xdg_buf)",
            "path_unless_empty(&system_buf)",
            "path_unless_empty(&programdata_buf)"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "load_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "591-654",
          "snippet": "static int load_config(\n\tgit_config **out,\n\tgit_repository *repo,\n\tconst char *global_config_path,\n\tconst char *xdg_config_path,\n\tconst char *system_config_path,\n\tconst char *programdata_path)\n{\n\tint error;\n\tgit_buf config_path = GIT_BUF_INIT;\n\tgit_config *cfg = NULL;\n\n\tassert(repo && out);\n\n\tif ((error = git_config_new(&cfg)) < 0)\n\t\treturn error;\n\n\terror = git_buf_joinpath(\n\t\t&config_path, repo->path_repository, GIT_CONFIG_FILENAME_INREPO);\n\tif (error < 0)\n\t\tgoto on_error;\n\n\tif ((error = git_config_add_file_ondisk(\n\t\t\tcfg, config_path.ptr, GIT_CONFIG_LEVEL_LOCAL, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tgit_buf_free(&config_path);\n\n\tif (global_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, global_config_path, GIT_CONFIG_LEVEL_GLOBAL, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (xdg_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, xdg_config_path, GIT_CONFIG_LEVEL_XDG, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (system_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, system_config_path, GIT_CONFIG_LEVEL_SYSTEM, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (programdata_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, programdata_path, GIT_CONFIG_LEVEL_PROGRAMDATA, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tgiterr_clear(); /* clear any lingering ENOTFOUND errors */\n\n\t*out = cfg;\n\treturn 0;\n\non_error:\n\tgit_buf_free(&config_path);\n\tgit_config_free(cfg);\n\t*out = NULL;\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int load_config(\n\tgit_config **out,\n\tgit_repository *repo,\n\tconst char *global_config_path,\n\tconst char *xdg_config_path,\n\tconst char *system_config_path,\n\tconst char *programdata_path)\n{\n\tint error;\n\tgit_buf config_path = GIT_BUF_INIT;\n\tgit_config *cfg = NULL;\n\n\tassert(repo && out);\n\n\tif ((error = git_config_new(&cfg)) < 0)\n\t\treturn error;\n\n\terror = git_buf_joinpath(\n\t\t&config_path, repo->path_repository, GIT_CONFIG_FILENAME_INREPO);\n\tif (error < 0)\n\t\tgoto on_error;\n\n\tif ((error = git_config_add_file_ondisk(\n\t\t\tcfg, config_path.ptr, GIT_CONFIG_LEVEL_LOCAL, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tgit_buf_free(&config_path);\n\n\tif (global_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, global_config_path, GIT_CONFIG_LEVEL_GLOBAL, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (xdg_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, xdg_config_path, GIT_CONFIG_LEVEL_XDG, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (system_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, system_config_path, GIT_CONFIG_LEVEL_SYSTEM, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (programdata_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, programdata_path, GIT_CONFIG_LEVEL_PROGRAMDATA, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tgiterr_clear(); /* clear any lingering ENOTFOUND errors */\n\n\t*out = cfg;\n\treturn 0;\n\non_error:\n\tgit_buf_free(&config_path);\n\tgit_config_free(cfg);\n\t*out = NULL;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "path_unless_empty",
          "args": [
            "&programdata_buf"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "path_unless_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "656-659",
          "snippet": "static const char *path_unless_empty(git_buf *buf)\n{\n\treturn git_buf_len(buf) > 0 ? git_buf_cstr(buf) : NULL;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic const char *path_unless_empty(git_buf *buf)\n{\n\treturn git_buf_len(buf) > 0 ? git_buf_cstr(buf) : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config__global_location",
          "args": [
            "&global_buf"
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__global_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1095-1118",
          "snippet": "int git_config__global_location(git_buf *buf)\n{\n\tconst git_buf *paths;\n\tconst char *sep, *start;\n\n\tif (git_sysdir_get(&paths, GIT_SYSDIR_GLOBAL) < 0)\n\t\treturn -1;\n\n\t/* no paths, so give up */\n\tif (!paths || !git_buf_len(paths))\n\t\treturn -1;\n\n\t/* find unescaped separator or end of string */\n\tfor (sep = start = git_buf_cstr(paths); *sep; ++sep) {\n\t\tif (*sep == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t(sep <= start || sep[-1] != '\\\\'))\n\t\t\tbreak;\n\t}\n\n\tif (git_buf_set(buf, start, (size_t)(sep - start)) < 0)\n\t\treturn -1;\n\n\treturn git_buf_joinpath(buf, buf->ptr, GIT_CONFIG_FILENAME_GLOBAL);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__global_location(git_buf *buf)\n{\n\tconst git_buf *paths;\n\tconst char *sep, *start;\n\n\tif (git_sysdir_get(&paths, GIT_SYSDIR_GLOBAL) < 0)\n\t\treturn -1;\n\n\t/* no paths, so give up */\n\tif (!paths || !git_buf_len(paths))\n\t\treturn -1;\n\n\t/* find unescaped separator or end of string */\n\tfor (sep = start = git_buf_cstr(paths); *sep; ++sep) {\n\t\tif (*sep == GIT_PATH_LIST_SEPARATOR &&\n\t\t\t(sep <= start || sep[-1] != '\\\\'))\n\t\t\tbreak;\n\t}\n\n\tif (git_buf_set(buf, start, (size_t)(sep - start)) < 0)\n\t\treturn -1;\n\n\treturn git_buf_joinpath(buf, buf->ptr, GIT_CONFIG_FILENAME_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "&global_buf"
          ],
          "line": 678
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_find_programdata",
          "args": [
            "&programdata_buf"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_find_programdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1089-1093",
          "snippet": "int git_config_find_programdata(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_programdata_file(path, GIT_CONFIG_FILENAME_PROGRAMDATA);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_programdata(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_programdata_file(path, GIT_CONFIG_FILENAME_PROGRAMDATA);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_find_system",
          "args": [
            "&system_buf"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_find_system",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1083-1087",
          "snippet": "int git_config_find_system(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_system_file(path, GIT_CONFIG_FILENAME_SYSTEM);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_system(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_system_file(path, GIT_CONFIG_FILENAME_SYSTEM);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_find_xdg",
          "args": [
            "&xdg_buf"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_find_xdg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1077-1081",
          "snippet": "int git_config_find_xdg(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_xdg_file(path, GIT_CONFIG_FILENAME_XDG);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_xdg(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_xdg_file(path, GIT_CONFIG_FILENAME_XDG);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_find_global",
          "args": [
            "&global_buf"
          ],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_find_global",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "1071-1075",
          "snippet": "int git_config_find_global(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_global_file(path, GIT_CONFIG_FILENAME_GLOBAL);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_find_global(git_buf *path)\n{\n\tgit_buf_sanitize(path);\n\treturn git_sysdir_find_global_file(path, GIT_CONFIG_FILENAME_GLOBAL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_config__weakptr(git_config **out, git_repository *repo)\n{\n\tint error = 0;\n\n\tif (repo->_config == NULL) {\n\t\tgit_buf global_buf = GIT_BUF_INIT;\n\t\tgit_buf xdg_buf = GIT_BUF_INIT;\n\t\tgit_buf system_buf = GIT_BUF_INIT;\n\t\tgit_buf programdata_buf = GIT_BUF_INIT;\n\t\tgit_config *config;\n\n\t\tgit_config_find_global(&global_buf);\n\t\tgit_config_find_xdg(&xdg_buf);\n\t\tgit_config_find_system(&system_buf);\n\t\tgit_config_find_programdata(&programdata_buf);\n\n\t\t/* If there is no global file, open a backend for it anyway */\n\t\tif (git_buf_len(&global_buf) == 0)\n\t\t\tgit_config__global_location(&global_buf);\n\n\t\terror = load_config(\n\t\t\t&config, repo,\n\t\t\tpath_unless_empty(&global_buf),\n\t\t\tpath_unless_empty(&xdg_buf),\n\t\t\tpath_unless_empty(&system_buf),\n\t\t\tpath_unless_empty(&programdata_buf));\n\t\tif (!error) {\n\t\t\tGIT_REFCOUNT_OWN(config, repo);\n\n\t\t\tconfig = git__compare_and_swap(&repo->_config, NULL, config);\n\t\t\tif (config != NULL) {\n\t\t\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\t\t\tgit_config_free(config);\n\t\t\t}\n\t\t}\n\n\t\tgit_buf_free(&global_buf);\n\t\tgit_buf_free(&xdg_buf);\n\t\tgit_buf_free(&system_buf);\n\t\tgit_buf_free(&programdata_buf);\n\t}\n\n\t*out = repo->_config;\n\treturn error;\n}"
  },
  {
    "function_name": "path_unless_empty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "656-659",
    "snippet": "static const char *path_unless_empty(git_buf *buf)\n{\n\treturn git_buf_len(buf) > 0 ? git_buf_cstr(buf) : NULL;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "buf"
          ],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "buf"
          ],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic const char *path_unless_empty(git_buf *buf)\n{\n\treturn git_buf_len(buf) > 0 ? git_buf_cstr(buf) : NULL;\n}"
  },
  {
    "function_name": "load_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "591-654",
    "snippet": "static int load_config(\n\tgit_config **out,\n\tgit_repository *repo,\n\tconst char *global_config_path,\n\tconst char *xdg_config_path,\n\tconst char *system_config_path,\n\tconst char *programdata_path)\n{\n\tint error;\n\tgit_buf config_path = GIT_BUF_INIT;\n\tgit_config *cfg = NULL;\n\n\tassert(repo && out);\n\n\tif ((error = git_config_new(&cfg)) < 0)\n\t\treturn error;\n\n\terror = git_buf_joinpath(\n\t\t&config_path, repo->path_repository, GIT_CONFIG_FILENAME_INREPO);\n\tif (error < 0)\n\t\tgoto on_error;\n\n\tif ((error = git_config_add_file_ondisk(\n\t\t\tcfg, config_path.ptr, GIT_CONFIG_LEVEL_LOCAL, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tgit_buf_free(&config_path);\n\n\tif (global_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, global_config_path, GIT_CONFIG_LEVEL_GLOBAL, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (xdg_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, xdg_config_path, GIT_CONFIG_LEVEL_XDG, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (system_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, system_config_path, GIT_CONFIG_LEVEL_SYSTEM, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (programdata_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, programdata_path, GIT_CONFIG_LEVEL_PROGRAMDATA, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tgiterr_clear(); /* clear any lingering ENOTFOUND errors */\n\n\t*out = cfg;\n\treturn 0;\n\non_error:\n\tgit_buf_free(&config_path);\n\tgit_config_free(cfg);\n\t*out = NULL;\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "cfg"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&config_path"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_clear",
          "args": [],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "121-132",
          "snippet": "void giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_clear(void)\n{\n\tif (GIT_GLOBAL->last_error != NULL) {\n\t\tset_error(0, NULL);\n\t\tGIT_GLOBAL->last_error = NULL;\n\t}\n\n\terrno = 0;\n#ifdef GIT_WIN32\n\tSetLastError(0);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_add_file_ondisk",
          "args": [
            "cfg",
            "programdata_path",
            "GIT_CONFIG_LEVEL_PROGRAMDATA",
            "0"
          ],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_add_file_ondisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "98-129",
          "snippet": "int git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_add_file_ondisk(\n\tgit_config *cfg,\n\tconst char *path,\n\tgit_config_level_t level,\n\tint force)\n{\n\tgit_config_backend *file = NULL;\n\tstruct stat st;\n\tint res;\n\n\tassert(cfg && path);\n\n\tres = p_stat(path, &st);\n\tif (res < 0 && errno != ENOENT) {\n\t\tgiterr_set(GITERR_CONFIG, \"Error stat'ing config file '%s'\", path);\n\t\treturn -1;\n\t}\n\n\tif (git_config_file__ondisk(&file, path) < 0)\n\t\treturn -1;\n\n\tif ((res = git_config_add_backend(cfg, file, level, force)) < 0) {\n\t\t/*\n\t\t * free manually; the file is not owned by the config\n\t\t * instance yet and will not be freed on cleanup\n\t\t */\n\t\tfile->free(file);\n\t\treturn res;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&config_path",
            "repo->path_repository",
            "GIT_CONFIG_FILENAME_INREPO"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_new",
          "args": [
            "&cfg"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "79-96",
          "snippet": "int git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_new(git_config **out)\n{\n\tgit_config *cfg;\n\n\tcfg = git__malloc(sizeof(git_config));\n\tGITERR_CHECK_ALLOC(cfg);\n\n\tmemset(cfg, 0x0, sizeof(git_config));\n\n\tif (git_vector_init(&cfg->files, 3, config_backend_cmp) < 0) {\n\t\tgit__free(cfg);\n\t\treturn -1;\n\t}\n\n\t*out = cfg;\n\tGIT_REFCOUNT_INC(cfg);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo && out"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int load_config(\n\tgit_config **out,\n\tgit_repository *repo,\n\tconst char *global_config_path,\n\tconst char *xdg_config_path,\n\tconst char *system_config_path,\n\tconst char *programdata_path)\n{\n\tint error;\n\tgit_buf config_path = GIT_BUF_INIT;\n\tgit_config *cfg = NULL;\n\n\tassert(repo && out);\n\n\tif ((error = git_config_new(&cfg)) < 0)\n\t\treturn error;\n\n\terror = git_buf_joinpath(\n\t\t&config_path, repo->path_repository, GIT_CONFIG_FILENAME_INREPO);\n\tif (error < 0)\n\t\tgoto on_error;\n\n\tif ((error = git_config_add_file_ondisk(\n\t\t\tcfg, config_path.ptr, GIT_CONFIG_LEVEL_LOCAL, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tgit_buf_free(&config_path);\n\n\tif (global_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, global_config_path, GIT_CONFIG_LEVEL_GLOBAL, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (xdg_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, xdg_config_path, GIT_CONFIG_LEVEL_XDG, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (system_config_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, system_config_path, GIT_CONFIG_LEVEL_SYSTEM, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tif (programdata_path != NULL &&\n\t\t(error = git_config_add_file_ondisk(\n\t\t\tcfg, programdata_path, GIT_CONFIG_LEVEL_PROGRAMDATA, 0)) < 0 &&\n\t\terror != GIT_ENOTFOUND)\n\t\tgoto on_error;\n\n\tgiterr_clear(); /* clear any lingering ENOTFOUND errors */\n\n\t*out = cfg;\n\treturn 0;\n\non_error:\n\tgit_buf_free(&config_path);\n\tgit_config_free(cfg);\n\t*out = NULL;\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_discover",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "576-589",
    "snippet": "int git_repository_discover(\n\tgit_buf *out,\n\tconst char *start_path,\n\tint across_fs,\n\tconst char *ceiling_dirs)\n{\n\tuint32_t flags = across_fs ? GIT_REPOSITORY_OPEN_CROSS_FS : 0;\n\n\tassert(start_path);\n\n\tgit_buf_sanitize(out);\n\n\treturn find_repo(out, NULL, NULL, start_path, flags, ceiling_dirs);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_repo",
          "args": [
            "out",
            "NULL",
            "NULL",
            "start_path",
            "flags",
            "ceiling_dirs"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "find_repo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "350-458",
          "snippet": "static int find_repo(\n\tgit_buf *repo_path,\n\tgit_buf *parent_path,\n\tgit_buf *link_path,\n\tconst char *start_path,\n\tuint32_t flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tdev_t initial_device = 0;\n\tint min_iterations;\n\tbool in_dot_git;\n\tsize_t ceiling_offset = 0;\n\n\tgit_buf_free(repo_path);\n\n\tif ((error = git_path_prettify(&path, start_path, NULL)) < 0)\n\t\treturn error;\n\n\t/* in_dot_git toggles each loop:\n\t * /a/b/c/.git, /a/b/c, /a/b/.git, /a/b, /a/.git, /a\n\t * With GIT_REPOSITORY_OPEN_BARE, we assume we started with /a/b/c.git\n\t * and don't append .git the first time through.\n\t * min_iterations indicates the number of iterations left before going\n\t * further counts as a search. */\n\tif (flags & GIT_REPOSITORY_OPEN_BARE) {\n\t\tin_dot_git = true;\n\t\tmin_iterations = 1;\n\t} else {\n\t\tin_dot_git = false;\n\t\tmin_iterations = 2;\n\t}\n\n\twhile (!error && (min_iterations || !(path.ptr[ceiling_offset] == 0 ||\n\t\t\t\t\t      (flags & GIT_REPOSITORY_OPEN_NO_SEARCH)))) {\n\t\tif (!in_dot_git)\n\t\t\tif ((error = git_buf_joinpath(&path, path.ptr, DOT_GIT)) < 0)\n\t\t\t\tbreak;\n\t\tin_dot_git = !in_dot_git;\n\n\t\tif (p_stat(path.ptr, &st) == 0) {\n\t\t\t/* check that we have not crossed device boundaries */\n\t\t\tif (initial_device == 0)\n\t\t\t\tinitial_device = st.st_dev;\n\t\t\telse if (st.st_dev != initial_device &&\n\t\t\t\t(flags & GIT_REPOSITORY_OPEN_CROSS_FS) == 0)\n\t\t\t\tbreak;\n\n\t\t\tif (S_ISDIR(st.st_mode)) {\n\t\t\t\tif (valid_repository_path(&path)) {\n\t\t\t\t\tgit_path_to_dir(&path);\n\t\t\t\t\tgit_buf_set(repo_path, path.ptr, path.size);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (S_ISREG(st.st_mode)) {\n\t\t\t\tgit_buf repo_link = GIT_BUF_INIT;\n\n\t\t\t\tif (!(error = read_gitfile(&repo_link, path.ptr))) {\n\t\t\t\t\tif (valid_repository_path(&repo_link)) {\n\t\t\t\t\t\tgit_buf_swap(repo_path, &repo_link);\n\n\t\t\t\t\t\tif (link_path)\n\t\t\t\t\t\t\terror = git_buf_put(link_path, \n\t\t\t\t\t\t\t\tpath.ptr, path.size);\n\t\t\t\t\t}\n\n\t\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t}\n\t\t}\n\n\t\t/* move up one directory level */\n\t\tif (git_path_dirname_r(&path, path.ptr) < 0) {\n\t\t\terror = -1;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Once we've checked the directory (and .git if applicable),\n\t\t * find the ceiling for a search. */\n\t\tif (min_iterations && (--min_iterations == 0))\n\t\t\tceiling_offset = find_ceiling_dir_offset(path.ptr, ceiling_dirs);\n\t}\n\n\tif (!error && parent_path && !(flags & GIT_REPOSITORY_OPEN_BARE)) {\n\t\tif (!git_buf_len(repo_path))\n\t\t\tgit_buf_clear(parent_path);\n\t\telse {\n\t\t\tgit_path_dirname_r(parent_path, path.ptr);\n\t\t\tgit_path_to_dir(parent_path);\n\t\t}\n\t\tif (git_buf_oom(parent_path))\n\t\t\treturn -1;\n\t}\n\n\tgit_buf_free(&path);\n\n\tif (!git_buf_len(repo_path) && !error) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Could not find repository from '%s'\", start_path);\n\t\terror = GIT_ENOTFOUND;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int find_repo(\n\tgit_buf *repo_path,\n\tgit_buf *parent_path,\n\tgit_buf *link_path,\n\tconst char *start_path,\n\tuint32_t flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tdev_t initial_device = 0;\n\tint min_iterations;\n\tbool in_dot_git;\n\tsize_t ceiling_offset = 0;\n\n\tgit_buf_free(repo_path);\n\n\tif ((error = git_path_prettify(&path, start_path, NULL)) < 0)\n\t\treturn error;\n\n\t/* in_dot_git toggles each loop:\n\t * /a/b/c/.git, /a/b/c, /a/b/.git, /a/b, /a/.git, /a\n\t * With GIT_REPOSITORY_OPEN_BARE, we assume we started with /a/b/c.git\n\t * and don't append .git the first time through.\n\t * min_iterations indicates the number of iterations left before going\n\t * further counts as a search. */\n\tif (flags & GIT_REPOSITORY_OPEN_BARE) {\n\t\tin_dot_git = true;\n\t\tmin_iterations = 1;\n\t} else {\n\t\tin_dot_git = false;\n\t\tmin_iterations = 2;\n\t}\n\n\twhile (!error && (min_iterations || !(path.ptr[ceiling_offset] == 0 ||\n\t\t\t\t\t      (flags & GIT_REPOSITORY_OPEN_NO_SEARCH)))) {\n\t\tif (!in_dot_git)\n\t\t\tif ((error = git_buf_joinpath(&path, path.ptr, DOT_GIT)) < 0)\n\t\t\t\tbreak;\n\t\tin_dot_git = !in_dot_git;\n\n\t\tif (p_stat(path.ptr, &st) == 0) {\n\t\t\t/* check that we have not crossed device boundaries */\n\t\t\tif (initial_device == 0)\n\t\t\t\tinitial_device = st.st_dev;\n\t\t\telse if (st.st_dev != initial_device &&\n\t\t\t\t(flags & GIT_REPOSITORY_OPEN_CROSS_FS) == 0)\n\t\t\t\tbreak;\n\n\t\t\tif (S_ISDIR(st.st_mode)) {\n\t\t\t\tif (valid_repository_path(&path)) {\n\t\t\t\t\tgit_path_to_dir(&path);\n\t\t\t\t\tgit_buf_set(repo_path, path.ptr, path.size);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (S_ISREG(st.st_mode)) {\n\t\t\t\tgit_buf repo_link = GIT_BUF_INIT;\n\n\t\t\t\tif (!(error = read_gitfile(&repo_link, path.ptr))) {\n\t\t\t\t\tif (valid_repository_path(&repo_link)) {\n\t\t\t\t\t\tgit_buf_swap(repo_path, &repo_link);\n\n\t\t\t\t\t\tif (link_path)\n\t\t\t\t\t\t\terror = git_buf_put(link_path, \n\t\t\t\t\t\t\t\tpath.ptr, path.size);\n\t\t\t\t\t}\n\n\t\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t}\n\t\t}\n\n\t\t/* move up one directory level */\n\t\tif (git_path_dirname_r(&path, path.ptr) < 0) {\n\t\t\terror = -1;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Once we've checked the directory (and .git if applicable),\n\t\t * find the ceiling for a search. */\n\t\tif (min_iterations && (--min_iterations == 0))\n\t\t\tceiling_offset = find_ceiling_dir_offset(path.ptr, ceiling_dirs);\n\t}\n\n\tif (!error && parent_path && !(flags & GIT_REPOSITORY_OPEN_BARE)) {\n\t\tif (!git_buf_len(repo_path))\n\t\t\tgit_buf_clear(parent_path);\n\t\telse {\n\t\t\tgit_path_dirname_r(parent_path, path.ptr);\n\t\t\tgit_path_to_dir(parent_path);\n\t\t}\n\t\tif (git_buf_oom(parent_path))\n\t\t\treturn -1;\n\t}\n\n\tgit_buf_free(&path);\n\n\tif (!git_buf_len(repo_path) && !error) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Could not find repository from '%s'\", start_path);\n\t\terror = GIT_ENOTFOUND;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_sanitize",
          "args": [
            "out"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_sanitize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "128-135",
          "snippet": "void git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_sanitize(git_buf *buf)\n{\n\tif (buf->ptr == NULL) {\n\t\tassert(buf->size == 0 && buf->asize == 0);\n\t\tbuf->ptr = git_buf__initbuf;\n\t} else if (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "start_path"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_discover(\n\tgit_buf *out,\n\tconst char *start_path,\n\tint across_fs,\n\tconst char *ceiling_dirs)\n{\n\tuint32_t flags = across_fs ? GIT_REPOSITORY_OPEN_CROSS_FS : 0;\n\n\tassert(start_path);\n\n\tgit_buf_sanitize(out);\n\n\treturn find_repo(out, NULL, NULL, start_path, flags, ceiling_dirs);\n}"
  },
  {
    "function_name": "git_repository_wrap_odb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "563-574",
    "snippet": "int git_repository_wrap_odb(git_repository **repo_out, git_odb *odb)\n{\n\tgit_repository *repo;\n\n\trepo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\tgit_repository_set_odb(repo, odb);\n\t*repo_out = repo;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_repository_set_odb",
          "args": [
            "repo",
            "odb"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_odb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "773-777",
          "snippet": "void git_repository_set_odb(git_repository *repo, git_odb *odb)\n{\n\tassert(repo && odb);\n\tset_odb(repo, odb);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_set_odb(git_repository *repo, git_odb *odb)\n{\n\tassert(repo && odb);\n\tset_odb(repo, odb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "repo"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "repository_alloc",
          "args": [],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "repository_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "171-194",
          "snippet": "static git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_wrap_odb(git_repository **repo_out, git_odb *odb)\n{\n\tgit_repository *repo;\n\n\trepo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\tgit_repository_set_odb(repo, odb);\n\t*repo_out = repo;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "557-561",
    "snippet": "int git_repository_open(git_repository **repo_out, const char *path)\n{\n\treturn git_repository_open_ext(\n\t\trepo_out, path, GIT_REPOSITORY_OPEN_NO_SEARCH, NULL);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_repository_open_ext",
          "args": [
            "repo_out",
            "path",
            "GIT_REPOSITORY_OPEN_NO_SEARCH",
            "NULL"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_open_ext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "491-555",
          "snippet": "int git_repository_open_ext(\n\tgit_repository **repo_ptr,\n\tconst char *start_path,\n\tunsigned int flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT, parent = GIT_BUF_INIT,\n\t\tlink_path = GIT_BUF_INIT;\n\tgit_repository *repo;\n\tgit_config *config = NULL;\n\n\tif (repo_ptr)\n\t\t*repo_ptr = NULL;\n\n\terror = find_repo(\n\t\t&path, &parent, &link_path, start_path, flags, ceiling_dirs);\n\n\tif (error < 0 || !repo_ptr)\n\t\treturn error;\n\n\trepo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\trepo->path_repository = git_buf_detach(&path);\n\tGITERR_CHECK_ALLOC(repo->path_repository);\n\n\tif (link_path.size) {\n\t\trepo->path_gitlink = git_buf_detach(&link_path);\n\t\tGITERR_CHECK_ALLOC(repo->path_gitlink);\n\t}\n\n\t/*\n\t * We'd like to have the config, but git doesn't particularly\n\t * care if it's not there, so we need to deal with that.\n\t */\n\n\terror = git_repository_config_snapshot(&config, repo);\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\tif (config && (error = check_repositoryformatversion(config)) < 0)\n\t\tgoto cleanup;\n\n\tif ((flags & GIT_REPOSITORY_OPEN_BARE) != 0)\n\t\trepo->is_bare = 1;\n\telse {\n\n\t\tif (config &&\n\t\t    ((error = load_config_data(repo, config)) < 0 ||\n\t\t     (error = load_workdir(repo, config, &parent)) < 0))\n\t\t\tgoto cleanup;\n\t}\n\ncleanup:\n\tgit_buf_free(&parent);\n\tgit_config_free(config);\n\n\tif (error < 0)\n\t\tgit_repository_free(repo);\n\telse\n\t\t*repo_ptr = repo;\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_open_ext(\n\tgit_repository **repo_ptr,\n\tconst char *start_path,\n\tunsigned int flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT, parent = GIT_BUF_INIT,\n\t\tlink_path = GIT_BUF_INIT;\n\tgit_repository *repo;\n\tgit_config *config = NULL;\n\n\tif (repo_ptr)\n\t\t*repo_ptr = NULL;\n\n\terror = find_repo(\n\t\t&path, &parent, &link_path, start_path, flags, ceiling_dirs);\n\n\tif (error < 0 || !repo_ptr)\n\t\treturn error;\n\n\trepo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\trepo->path_repository = git_buf_detach(&path);\n\tGITERR_CHECK_ALLOC(repo->path_repository);\n\n\tif (link_path.size) {\n\t\trepo->path_gitlink = git_buf_detach(&link_path);\n\t\tGITERR_CHECK_ALLOC(repo->path_gitlink);\n\t}\n\n\t/*\n\t * We'd like to have the config, but git doesn't particularly\n\t * care if it's not there, so we need to deal with that.\n\t */\n\n\terror = git_repository_config_snapshot(&config, repo);\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\tif (config && (error = check_repositoryformatversion(config)) < 0)\n\t\tgoto cleanup;\n\n\tif ((flags & GIT_REPOSITORY_OPEN_BARE) != 0)\n\t\trepo->is_bare = 1;\n\telse {\n\n\t\tif (config &&\n\t\t    ((error = load_config_data(repo, config)) < 0 ||\n\t\t     (error = load_workdir(repo, config, &parent)) < 0))\n\t\t\tgoto cleanup;\n\t}\n\ncleanup:\n\tgit_buf_free(&parent);\n\tgit_config_free(config);\n\n\tif (error < 0)\n\t\tgit_repository_free(repo);\n\telse\n\t\t*repo_ptr = repo;\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_open(git_repository **repo_out, const char *path)\n{\n\treturn git_repository_open_ext(\n\t\trepo_out, path, GIT_REPOSITORY_OPEN_NO_SEARCH, NULL);\n}"
  },
  {
    "function_name": "git_repository_open_ext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "491-555",
    "snippet": "int git_repository_open_ext(\n\tgit_repository **repo_ptr,\n\tconst char *start_path,\n\tunsigned int flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT, parent = GIT_BUF_INIT,\n\t\tlink_path = GIT_BUF_INIT;\n\tgit_repository *repo;\n\tgit_config *config = NULL;\n\n\tif (repo_ptr)\n\t\t*repo_ptr = NULL;\n\n\terror = find_repo(\n\t\t&path, &parent, &link_path, start_path, flags, ceiling_dirs);\n\n\tif (error < 0 || !repo_ptr)\n\t\treturn error;\n\n\trepo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\trepo->path_repository = git_buf_detach(&path);\n\tGITERR_CHECK_ALLOC(repo->path_repository);\n\n\tif (link_path.size) {\n\t\trepo->path_gitlink = git_buf_detach(&link_path);\n\t\tGITERR_CHECK_ALLOC(repo->path_gitlink);\n\t}\n\n\t/*\n\t * We'd like to have the config, but git doesn't particularly\n\t * care if it's not there, so we need to deal with that.\n\t */\n\n\terror = git_repository_config_snapshot(&config, repo);\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\tif (config && (error = check_repositoryformatversion(config)) < 0)\n\t\tgoto cleanup;\n\n\tif ((flags & GIT_REPOSITORY_OPEN_BARE) != 0)\n\t\trepo->is_bare = 1;\n\telse {\n\n\t\tif (config &&\n\t\t    ((error = load_config_data(repo, config)) < 0 ||\n\t\t     (error = load_workdir(repo, config, &parent)) < 0))\n\t\t\tgoto cleanup;\n\t}\n\ncleanup:\n\tgit_buf_free(&parent);\n\tgit_config_free(config);\n\n\tif (error < 0)\n\t\tgit_repository_free(repo);\n\telse\n\t\t*repo_ptr = repo;\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_repository_free",
          "args": [
            "repo"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "121-148",
          "snippet": "void git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "config"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&parent"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "load_workdir",
          "args": [
            "repo",
            "config",
            "&parent"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "load_workdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "221-257",
          "snippet": "static int load_workdir(git_repository *repo, git_config *config, git_buf *parent_path)\n{\n\tint         error;\n\tgit_config_entry *ce;\n\tgit_buf     worktree = GIT_BUF_INIT;\n\n\tif (repo->is_bare)\n\t\treturn 0;\n\n\tif ((error = git_config__lookup_entry(\n\t\t\t&ce, config, \"core.worktree\", false)) < 0)\n\t\treturn error;\n\n\tif (ce && ce->value) {\n\t\tif ((error = git_path_prettify_dir(\n\t\t\t\t&worktree, ce->value, repo->path_repository)) < 0)\n\t\t\tgoto cleanup;\n\n\t\trepo->workdir = git_buf_detach(&worktree);\n\t}\n\telse if (parent_path && git_path_isdir(parent_path->ptr))\n\t\trepo->workdir = git_buf_detach(parent_path);\n\telse {\n\t\tif (git_path_dirname_r(&worktree, repo->path_repository) < 0 ||\n\t\t    git_path_to_dir(&worktree) < 0) {\n\t\t\terror = -1;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\trepo->workdir = git_buf_detach(&worktree);\n\t}\n\n\tGITERR_CHECK_ALLOC(repo->workdir);\ncleanup:\n\tgit_config_entry_free(ce);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int load_workdir(git_repository *repo, git_config *config, git_buf *parent_path)\n{\n\tint         error;\n\tgit_config_entry *ce;\n\tgit_buf     worktree = GIT_BUF_INIT;\n\n\tif (repo->is_bare)\n\t\treturn 0;\n\n\tif ((error = git_config__lookup_entry(\n\t\t\t&ce, config, \"core.worktree\", false)) < 0)\n\t\treturn error;\n\n\tif (ce && ce->value) {\n\t\tif ((error = git_path_prettify_dir(\n\t\t\t\t&worktree, ce->value, repo->path_repository)) < 0)\n\t\t\tgoto cleanup;\n\n\t\trepo->workdir = git_buf_detach(&worktree);\n\t}\n\telse if (parent_path && git_path_isdir(parent_path->ptr))\n\t\trepo->workdir = git_buf_detach(parent_path);\n\telse {\n\t\tif (git_path_dirname_r(&worktree, repo->path_repository) < 0 ||\n\t\t    git_path_to_dir(&worktree) < 0) {\n\t\t\terror = -1;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\trepo->workdir = git_buf_detach(&worktree);\n\t}\n\n\tGITERR_CHECK_ALLOC(repo->workdir);\ncleanup:\n\tgit_config_entry_free(ce);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "load_config_data",
          "args": [
            "repo",
            "config"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "load_config_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "208-219",
          "snippet": "static int load_config_data(git_repository *repo, const git_config *config)\n{\n\tint is_bare;\n\n\t/* Try to figure out if it's bare, default to non-bare if it's not set */\n\tif (git_config_get_bool(&is_bare, config, \"core.bare\") < 0)\n\t\trepo->is_bare = 0;\n\telse\n\t\trepo->is_bare = is_bare;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int load_config_data(git_repository *repo, const git_config *config)\n{\n\tint is_bare;\n\n\t/* Try to figure out if it's bare, default to non-bare if it's not set */\n\tif (git_config_get_bool(&is_bare, config, \"core.bare\") < 0)\n\t\trepo->is_bare = 0;\n\telse\n\t\trepo->is_bare = is_bare;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_repositoryformatversion",
          "args": [
            "config"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "check_repositoryformatversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "986-1006",
          "snippet": "static int check_repositoryformatversion(git_config *config)\n{\n\tint version, error;\n\n\terror = git_config_get_int32(&version, config, \"core.repositoryformatversion\");\n\t/* git ignores this if the config variable isn't there */\n\tif (error == GIT_ENOTFOUND)\n\t\treturn 0;\n\n\tif (error < 0)\n\t\treturn -1;\n\n\tif (GIT_REPO_VERSION < version) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Unsupported repository version %d. Only versions up to %d are supported.\",\n\t\t\tversion, GIT_REPO_VERSION);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [
            "#define GIT_REPO_VERSION 0"
          ],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_REPO_VERSION 0\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int check_repositoryformatversion(git_config *config)\n{\n\tint version, error;\n\n\terror = git_config_get_int32(&version, config, \"core.repositoryformatversion\");\n\t/* git ignores this if the config variable isn't there */\n\tif (error == GIT_ENOTFOUND)\n\t\treturn 0;\n\n\tif (error < 0)\n\t\treturn -1;\n\n\tif (GIT_REPO_VERSION < version) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Unsupported repository version %d. Only versions up to %d are supported.\",\n\t\t\tversion, GIT_REPO_VERSION);\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository_config_snapshot",
          "args": [
            "&config",
            "repo"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_config_snapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "716-725",
          "snippet": "int git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_config_snapshot(git_config **out, git_repository *repo)\n{\n\tint error;\n\tgit_config *weak;\n\n\tif ((error = git_repository_config__weakptr(&weak, repo)) < 0)\n\t\treturn error;\n\n\treturn git_config_snapshot(out, weak);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "repo->path_gitlink"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&link_path"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "repo->path_repository"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "repo"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "repository_alloc",
          "args": [],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "repository_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "171-194",
          "snippet": "static git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_repo",
          "args": [
            "&path",
            "&parent",
            "&link_path",
            "start_path",
            "flags",
            "ceiling_dirs"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "find_repo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "350-458",
          "snippet": "static int find_repo(\n\tgit_buf *repo_path,\n\tgit_buf *parent_path,\n\tgit_buf *link_path,\n\tconst char *start_path,\n\tuint32_t flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tdev_t initial_device = 0;\n\tint min_iterations;\n\tbool in_dot_git;\n\tsize_t ceiling_offset = 0;\n\n\tgit_buf_free(repo_path);\n\n\tif ((error = git_path_prettify(&path, start_path, NULL)) < 0)\n\t\treturn error;\n\n\t/* in_dot_git toggles each loop:\n\t * /a/b/c/.git, /a/b/c, /a/b/.git, /a/b, /a/.git, /a\n\t * With GIT_REPOSITORY_OPEN_BARE, we assume we started with /a/b/c.git\n\t * and don't append .git the first time through.\n\t * min_iterations indicates the number of iterations left before going\n\t * further counts as a search. */\n\tif (flags & GIT_REPOSITORY_OPEN_BARE) {\n\t\tin_dot_git = true;\n\t\tmin_iterations = 1;\n\t} else {\n\t\tin_dot_git = false;\n\t\tmin_iterations = 2;\n\t}\n\n\twhile (!error && (min_iterations || !(path.ptr[ceiling_offset] == 0 ||\n\t\t\t\t\t      (flags & GIT_REPOSITORY_OPEN_NO_SEARCH)))) {\n\t\tif (!in_dot_git)\n\t\t\tif ((error = git_buf_joinpath(&path, path.ptr, DOT_GIT)) < 0)\n\t\t\t\tbreak;\n\t\tin_dot_git = !in_dot_git;\n\n\t\tif (p_stat(path.ptr, &st) == 0) {\n\t\t\t/* check that we have not crossed device boundaries */\n\t\t\tif (initial_device == 0)\n\t\t\t\tinitial_device = st.st_dev;\n\t\t\telse if (st.st_dev != initial_device &&\n\t\t\t\t(flags & GIT_REPOSITORY_OPEN_CROSS_FS) == 0)\n\t\t\t\tbreak;\n\n\t\t\tif (S_ISDIR(st.st_mode)) {\n\t\t\t\tif (valid_repository_path(&path)) {\n\t\t\t\t\tgit_path_to_dir(&path);\n\t\t\t\t\tgit_buf_set(repo_path, path.ptr, path.size);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (S_ISREG(st.st_mode)) {\n\t\t\t\tgit_buf repo_link = GIT_BUF_INIT;\n\n\t\t\t\tif (!(error = read_gitfile(&repo_link, path.ptr))) {\n\t\t\t\t\tif (valid_repository_path(&repo_link)) {\n\t\t\t\t\t\tgit_buf_swap(repo_path, &repo_link);\n\n\t\t\t\t\t\tif (link_path)\n\t\t\t\t\t\t\terror = git_buf_put(link_path, \n\t\t\t\t\t\t\t\tpath.ptr, path.size);\n\t\t\t\t\t}\n\n\t\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t}\n\t\t}\n\n\t\t/* move up one directory level */\n\t\tif (git_path_dirname_r(&path, path.ptr) < 0) {\n\t\t\terror = -1;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Once we've checked the directory (and .git if applicable),\n\t\t * find the ceiling for a search. */\n\t\tif (min_iterations && (--min_iterations == 0))\n\t\t\tceiling_offset = find_ceiling_dir_offset(path.ptr, ceiling_dirs);\n\t}\n\n\tif (!error && parent_path && !(flags & GIT_REPOSITORY_OPEN_BARE)) {\n\t\tif (!git_buf_len(repo_path))\n\t\t\tgit_buf_clear(parent_path);\n\t\telse {\n\t\t\tgit_path_dirname_r(parent_path, path.ptr);\n\t\t\tgit_path_to_dir(parent_path);\n\t\t}\n\t\tif (git_buf_oom(parent_path))\n\t\t\treturn -1;\n\t}\n\n\tgit_buf_free(&path);\n\n\tif (!git_buf_len(repo_path) && !error) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Could not find repository from '%s'\", start_path);\n\t\terror = GIT_ENOTFOUND;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int find_repo(\n\tgit_buf *repo_path,\n\tgit_buf *parent_path,\n\tgit_buf *link_path,\n\tconst char *start_path,\n\tuint32_t flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tdev_t initial_device = 0;\n\tint min_iterations;\n\tbool in_dot_git;\n\tsize_t ceiling_offset = 0;\n\n\tgit_buf_free(repo_path);\n\n\tif ((error = git_path_prettify(&path, start_path, NULL)) < 0)\n\t\treturn error;\n\n\t/* in_dot_git toggles each loop:\n\t * /a/b/c/.git, /a/b/c, /a/b/.git, /a/b, /a/.git, /a\n\t * With GIT_REPOSITORY_OPEN_BARE, we assume we started with /a/b/c.git\n\t * and don't append .git the first time through.\n\t * min_iterations indicates the number of iterations left before going\n\t * further counts as a search. */\n\tif (flags & GIT_REPOSITORY_OPEN_BARE) {\n\t\tin_dot_git = true;\n\t\tmin_iterations = 1;\n\t} else {\n\t\tin_dot_git = false;\n\t\tmin_iterations = 2;\n\t}\n\n\twhile (!error && (min_iterations || !(path.ptr[ceiling_offset] == 0 ||\n\t\t\t\t\t      (flags & GIT_REPOSITORY_OPEN_NO_SEARCH)))) {\n\t\tif (!in_dot_git)\n\t\t\tif ((error = git_buf_joinpath(&path, path.ptr, DOT_GIT)) < 0)\n\t\t\t\tbreak;\n\t\tin_dot_git = !in_dot_git;\n\n\t\tif (p_stat(path.ptr, &st) == 0) {\n\t\t\t/* check that we have not crossed device boundaries */\n\t\t\tif (initial_device == 0)\n\t\t\t\tinitial_device = st.st_dev;\n\t\t\telse if (st.st_dev != initial_device &&\n\t\t\t\t(flags & GIT_REPOSITORY_OPEN_CROSS_FS) == 0)\n\t\t\t\tbreak;\n\n\t\t\tif (S_ISDIR(st.st_mode)) {\n\t\t\t\tif (valid_repository_path(&path)) {\n\t\t\t\t\tgit_path_to_dir(&path);\n\t\t\t\t\tgit_buf_set(repo_path, path.ptr, path.size);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (S_ISREG(st.st_mode)) {\n\t\t\t\tgit_buf repo_link = GIT_BUF_INIT;\n\n\t\t\t\tif (!(error = read_gitfile(&repo_link, path.ptr))) {\n\t\t\t\t\tif (valid_repository_path(&repo_link)) {\n\t\t\t\t\t\tgit_buf_swap(repo_path, &repo_link);\n\n\t\t\t\t\t\tif (link_path)\n\t\t\t\t\t\t\terror = git_buf_put(link_path, \n\t\t\t\t\t\t\t\tpath.ptr, path.size);\n\t\t\t\t\t}\n\n\t\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t}\n\t\t}\n\n\t\t/* move up one directory level */\n\t\tif (git_path_dirname_r(&path, path.ptr) < 0) {\n\t\t\terror = -1;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Once we've checked the directory (and .git if applicable),\n\t\t * find the ceiling for a search. */\n\t\tif (min_iterations && (--min_iterations == 0))\n\t\t\tceiling_offset = find_ceiling_dir_offset(path.ptr, ceiling_dirs);\n\t}\n\n\tif (!error && parent_path && !(flags & GIT_REPOSITORY_OPEN_BARE)) {\n\t\tif (!git_buf_len(repo_path))\n\t\t\tgit_buf_clear(parent_path);\n\t\telse {\n\t\t\tgit_path_dirname_r(parent_path, path.ptr);\n\t\t\tgit_path_to_dir(parent_path);\n\t\t}\n\t\tif (git_buf_oom(parent_path))\n\t\t\treturn -1;\n\t}\n\n\tgit_buf_free(&path);\n\n\tif (!git_buf_len(repo_path) && !error) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Could not find repository from '%s'\", start_path);\n\t\terror = GIT_ENOTFOUND;\n\t}\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nint git_repository_open_ext(\n\tgit_repository **repo_ptr,\n\tconst char *start_path,\n\tunsigned int flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT, parent = GIT_BUF_INIT,\n\t\tlink_path = GIT_BUF_INIT;\n\tgit_repository *repo;\n\tgit_config *config = NULL;\n\n\tif (repo_ptr)\n\t\t*repo_ptr = NULL;\n\n\terror = find_repo(\n\t\t&path, &parent, &link_path, start_path, flags, ceiling_dirs);\n\n\tif (error < 0 || !repo_ptr)\n\t\treturn error;\n\n\trepo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\trepo->path_repository = git_buf_detach(&path);\n\tGITERR_CHECK_ALLOC(repo->path_repository);\n\n\tif (link_path.size) {\n\t\trepo->path_gitlink = git_buf_detach(&link_path);\n\t\tGITERR_CHECK_ALLOC(repo->path_gitlink);\n\t}\n\n\t/*\n\t * We'd like to have the config, but git doesn't particularly\n\t * care if it's not there, so we need to deal with that.\n\t */\n\n\terror = git_repository_config_snapshot(&config, repo);\n\tif (error < 0 && error != GIT_ENOTFOUND)\n\t\tgoto cleanup;\n\n\tif (config && (error = check_repositoryformatversion(config)) < 0)\n\t\tgoto cleanup;\n\n\tif ((flags & GIT_REPOSITORY_OPEN_BARE) != 0)\n\t\trepo->is_bare = 1;\n\telse {\n\n\t\tif (config &&\n\t\t    ((error = load_config_data(repo, config)) < 0 ||\n\t\t     (error = load_workdir(repo, config, &parent)) < 0))\n\t\t\tgoto cleanup;\n\t}\n\ncleanup:\n\tgit_buf_free(&parent);\n\tgit_config_free(config);\n\n\tif (error < 0)\n\t\tgit_repository_free(repo);\n\telse\n\t\t*repo_ptr = repo;\n\n\treturn error;\n}"
  },
  {
    "function_name": "git_repository_open_bare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "460-489",
    "snippet": "int git_repository_open_bare(\n\tgit_repository **repo_ptr,\n\tconst char *bare_path)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_repository *repo = NULL;\n\n\tif ((error = git_path_prettify_dir(&path, bare_path, NULL)) < 0)\n\t\treturn error;\n\n\tif (!valid_repository_path(&path)) {\n\t\tgit_buf_free(&path);\n\t\tgiterr_set(GITERR_REPOSITORY, \"Path is not a repository: %s\", bare_path);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\trepo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\trepo->path_repository = git_buf_detach(&path);\n\tGITERR_CHECK_ALLOC(repo->path_repository);\n\n\t/* of course we're bare! */\n\trepo->is_bare = 1;\n\trepo->workdir = NULL;\n\n\t*repo_ptr = repo;\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "repo->path_repository"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&path"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "repo"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "repository_alloc",
          "args": [],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "repository_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "171-194",
          "snippet": "static git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"Path is not a repository: %s\"",
            "bare_path"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "valid_repository_path",
          "args": [
            "&path"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "valid_repository_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "155-169",
          "snippet": "static bool valid_repository_path(git_buf *repository_path)\n{\n\t/* Check OBJECTS_DIR first, since it will generate the longest path name */\n\tif (git_path_contains_dir(repository_path, GIT_OBJECTS_DIR) == false)\n\t\treturn false;\n\n\t/* Ensure HEAD file exists */\n\tif (git_path_contains_file(repository_path, GIT_HEAD_FILE) == false)\n\t\treturn false;\n\n\tif (git_path_contains_dir(repository_path, GIT_REFS_DIR)  == false)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool valid_repository_path(git_buf *repository_path)\n{\n\t/* Check OBJECTS_DIR first, since it will generate the longest path name */\n\tif (git_path_contains_dir(repository_path, GIT_OBJECTS_DIR) == false)\n\t\treturn false;\n\n\t/* Ensure HEAD file exists */\n\tif (git_path_contains_file(repository_path, GIT_HEAD_FILE) == false)\n\t\treturn false;\n\n\tif (git_path_contains_dir(repository_path, GIT_REFS_DIR)  == false)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_prettify_dir",
          "args": [
            "&path",
            "bare_path",
            "NULL"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_prettify_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "335-339",
          "snippet": "int git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_open_bare(\n\tgit_repository **repo_ptr,\n\tconst char *bare_path)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tgit_repository *repo = NULL;\n\n\tif ((error = git_path_prettify_dir(&path, bare_path, NULL)) < 0)\n\t\treturn error;\n\n\tif (!valid_repository_path(&path)) {\n\t\tgit_buf_free(&path);\n\t\tgiterr_set(GITERR_REPOSITORY, \"Path is not a repository: %s\", bare_path);\n\t\treturn GIT_ENOTFOUND;\n\t}\n\n\trepo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\trepo->path_repository = git_buf_detach(&path);\n\tGITERR_CHECK_ALLOC(repo->path_repository);\n\n\t/* of course we're bare! */\n\trepo->is_bare = 1;\n\trepo->workdir = NULL;\n\n\t*repo_ptr = repo;\n\treturn 0;\n}"
  },
  {
    "function_name": "find_repo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "350-458",
    "snippet": "static int find_repo(\n\tgit_buf *repo_path,\n\tgit_buf *parent_path,\n\tgit_buf *link_path,\n\tconst char *start_path,\n\tuint32_t flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tdev_t initial_device = 0;\n\tint min_iterations;\n\tbool in_dot_git;\n\tsize_t ceiling_offset = 0;\n\n\tgit_buf_free(repo_path);\n\n\tif ((error = git_path_prettify(&path, start_path, NULL)) < 0)\n\t\treturn error;\n\n\t/* in_dot_git toggles each loop:\n\t * /a/b/c/.git, /a/b/c, /a/b/.git, /a/b, /a/.git, /a\n\t * With GIT_REPOSITORY_OPEN_BARE, we assume we started with /a/b/c.git\n\t * and don't append .git the first time through.\n\t * min_iterations indicates the number of iterations left before going\n\t * further counts as a search. */\n\tif (flags & GIT_REPOSITORY_OPEN_BARE) {\n\t\tin_dot_git = true;\n\t\tmin_iterations = 1;\n\t} else {\n\t\tin_dot_git = false;\n\t\tmin_iterations = 2;\n\t}\n\n\twhile (!error && (min_iterations || !(path.ptr[ceiling_offset] == 0 ||\n\t\t\t\t\t      (flags & GIT_REPOSITORY_OPEN_NO_SEARCH)))) {\n\t\tif (!in_dot_git)\n\t\t\tif ((error = git_buf_joinpath(&path, path.ptr, DOT_GIT)) < 0)\n\t\t\t\tbreak;\n\t\tin_dot_git = !in_dot_git;\n\n\t\tif (p_stat(path.ptr, &st) == 0) {\n\t\t\t/* check that we have not crossed device boundaries */\n\t\t\tif (initial_device == 0)\n\t\t\t\tinitial_device = st.st_dev;\n\t\t\telse if (st.st_dev != initial_device &&\n\t\t\t\t(flags & GIT_REPOSITORY_OPEN_CROSS_FS) == 0)\n\t\t\t\tbreak;\n\n\t\t\tif (S_ISDIR(st.st_mode)) {\n\t\t\t\tif (valid_repository_path(&path)) {\n\t\t\t\t\tgit_path_to_dir(&path);\n\t\t\t\t\tgit_buf_set(repo_path, path.ptr, path.size);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (S_ISREG(st.st_mode)) {\n\t\t\t\tgit_buf repo_link = GIT_BUF_INIT;\n\n\t\t\t\tif (!(error = read_gitfile(&repo_link, path.ptr))) {\n\t\t\t\t\tif (valid_repository_path(&repo_link)) {\n\t\t\t\t\t\tgit_buf_swap(repo_path, &repo_link);\n\n\t\t\t\t\t\tif (link_path)\n\t\t\t\t\t\t\terror = git_buf_put(link_path, \n\t\t\t\t\t\t\t\tpath.ptr, path.size);\n\t\t\t\t\t}\n\n\t\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t}\n\t\t}\n\n\t\t/* move up one directory level */\n\t\tif (git_path_dirname_r(&path, path.ptr) < 0) {\n\t\t\terror = -1;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Once we've checked the directory (and .git if applicable),\n\t\t * find the ceiling for a search. */\n\t\tif (min_iterations && (--min_iterations == 0))\n\t\t\tceiling_offset = find_ceiling_dir_offset(path.ptr, ceiling_dirs);\n\t}\n\n\tif (!error && parent_path && !(flags & GIT_REPOSITORY_OPEN_BARE)) {\n\t\tif (!git_buf_len(repo_path))\n\t\t\tgit_buf_clear(parent_path);\n\t\telse {\n\t\t\tgit_path_dirname_r(parent_path, path.ptr);\n\t\t\tgit_path_to_dir(parent_path);\n\t\t}\n\t\tif (git_buf_oom(parent_path))\n\t\t\treturn -1;\n\t}\n\n\tgit_buf_free(&path);\n\n\tif (!git_buf_len(repo_path) && !error) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Could not find repository from '%s'\", start_path);\n\t\terror = GIT_ENOTFOUND;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"Could not find repository from '%s'\"",
            "start_path"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "repo_path"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&path"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_oom",
          "args": [
            "parent_path"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "94-97",
          "snippet": "GIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(bool) git_buf_oom(const git_buf *buf)\n{\n\treturn (buf->ptr == git_buf__oom);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_to_dir",
          "args": [
            "parent_path"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_to_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "341-349",
          "snippet": "int git_path_to_dir(git_buf *path)\n{\n\tif (path->asize > 0 &&\n\t\tgit_buf_len(path) > 0 &&\n\t\tpath->ptr[git_buf_len(path) - 1] != '/')\n\t\tgit_buf_putc(path, '/');\n\n\treturn git_buf_oom(path) ? -1 : 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_to_dir(git_buf *path)\n{\n\tif (path->asize > 0 &&\n\t\tgit_buf_len(path) > 0 &&\n\t\tpath->ptr[git_buf_len(path) - 1] != '/')\n\t\tgit_buf_putc(path, '/');\n\n\treturn git_buf_oom(path) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_dirname_r",
          "args": [
            "parent_path",
            "path.ptr"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_dirname_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "117-178",
          "snippet": "int git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_clear",
          "args": [
            "parent_path"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "137-148",
          "snippet": "void git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__initbuf[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__initbuf[1];\n\nvoid git_buf_clear(git_buf *buf)\n{\n\tbuf->size = 0;\n\n\tif (!buf->ptr) {\n\t\tbuf->ptr = git_buf__initbuf;\n\t\tbuf->asize = 0;\n\t}\n\n\tif (buf->asize > 0)\n\t\tbuf->ptr[0] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_ceiling_dir_offset",
          "args": [
            "path.ptr",
            "ceiling_dirs"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "find_ceiling_dir_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "267-309",
          "snippet": "static size_t find_ceiling_dir_offset(\n\tconst char *path,\n\tconst char *ceiling_directories)\n{\n\tchar buf[GIT_PATH_MAX + 1];\n\tchar buf2[GIT_PATH_MAX + 1];\n\tconst char *ceil, *sep;\n\tsize_t len, max_len = 0, min_len;\n\n\tassert(path);\n\n\tmin_len = (size_t)(git_path_root(path) + 1);\n\n\tif (ceiling_directories == NULL || min_len == 0)\n\t\treturn min_len;\n\n\tfor (sep = ceil = ceiling_directories; *sep; ceil = sep + 1) {\n\t\tfor (sep = ceil; *sep && *sep != GIT_PATH_LIST_SEPARATOR; sep++);\n\t\tlen = sep - ceil;\n\n\t\tif (len == 0 || len >= sizeof(buf) || git_path_root(ceil) == -1)\n\t\t\tcontinue;\n\n\t\tstrncpy(buf, ceil, len);\n\t\tbuf[len] = '\\0';\n\n\t\tif (p_realpath(buf, buf2) == NULL)\n\t\t\tcontinue;\n\n\t\tlen = strlen(buf2);\n\t\tif (len > 0 && buf2[len-1] == '/')\n\t\t\tbuf[--len] = '\\0';\n\n\t\tif (!strncmp(path, buf2, len) &&\n\t\t\t(path[len] == '/' || !path[len]) &&\n\t\t\tlen > max_len)\n\t\t{\n\t\t\tmax_len = len;\n\t\t}\n\t}\n\n\treturn (max_len <= min_len ? min_len : max_len);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic size_t find_ceiling_dir_offset(\n\tconst char *path,\n\tconst char *ceiling_directories)\n{\n\tchar buf[GIT_PATH_MAX + 1];\n\tchar buf2[GIT_PATH_MAX + 1];\n\tconst char *ceil, *sep;\n\tsize_t len, max_len = 0, min_len;\n\n\tassert(path);\n\n\tmin_len = (size_t)(git_path_root(path) + 1);\n\n\tif (ceiling_directories == NULL || min_len == 0)\n\t\treturn min_len;\n\n\tfor (sep = ceil = ceiling_directories; *sep; ceil = sep + 1) {\n\t\tfor (sep = ceil; *sep && *sep != GIT_PATH_LIST_SEPARATOR; sep++);\n\t\tlen = sep - ceil;\n\n\t\tif (len == 0 || len >= sizeof(buf) || git_path_root(ceil) == -1)\n\t\t\tcontinue;\n\n\t\tstrncpy(buf, ceil, len);\n\t\tbuf[len] = '\\0';\n\n\t\tif (p_realpath(buf, buf2) == NULL)\n\t\t\tcontinue;\n\n\t\tlen = strlen(buf2);\n\t\tif (len > 0 && buf2[len-1] == '/')\n\t\t\tbuf[--len] = '\\0';\n\n\t\tif (!strncmp(path, buf2, len) &&\n\t\t\t(path[len] == '/' || !path[len]) &&\n\t\t\tlen > max_len)\n\t\t{\n\t\t\tmax_len = len;\n\t\t}\n\t}\n\n\treturn (max_len <= min_len ? min_len : max_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_put",
          "args": [
            "link_path",
            "path.ptr",
            "path.size"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "208-223",
          "snippet": "int git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_put(git_buf *buf, const char *data, size_t len)\n{\n\tif (len) {\n\t\tsize_t new_size;\n\n\t\tassert(data);\n\t\t\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, buf->size, len);\n\t\tGITERR_CHECK_ALLOC_ADD(&new_size, new_size, 1);\n\t\tENSURE_SIZE(buf, new_size);\n\t\tmemmove(buf->ptr + buf->size, data, len);\n\t\tbuf->size += len;\n\t\tbuf->ptr[buf->size] = '\\0';\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_swap",
          "args": [
            "repo_path",
            "&repo_link"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_swap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "470-475",
          "snippet": "void git_buf_swap(git_buf *buf_a, git_buf *buf_b)\n{\n\tgit_buf t = *buf_a;\n\t*buf_a = *buf_b;\n\t*buf_b = t;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_swap(git_buf *buf_a, git_buf *buf_b)\n{\n\tgit_buf t = *buf_a;\n\t*buf_a = *buf_b;\n\t*buf_b = t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "valid_repository_path",
          "args": [
            "&repo_link"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "valid_repository_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "155-169",
          "snippet": "static bool valid_repository_path(git_buf *repository_path)\n{\n\t/* Check OBJECTS_DIR first, since it will generate the longest path name */\n\tif (git_path_contains_dir(repository_path, GIT_OBJECTS_DIR) == false)\n\t\treturn false;\n\n\t/* Ensure HEAD file exists */\n\tif (git_path_contains_file(repository_path, GIT_HEAD_FILE) == false)\n\t\treturn false;\n\n\tif (git_path_contains_dir(repository_path, GIT_REFS_DIR)  == false)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool valid_repository_path(git_buf *repository_path)\n{\n\t/* Check OBJECTS_DIR first, since it will generate the longest path name */\n\tif (git_path_contains_dir(repository_path, GIT_OBJECTS_DIR) == false)\n\t\treturn false;\n\n\t/* Ensure HEAD file exists */\n\tif (git_path_contains_file(repository_path, GIT_HEAD_FILE) == false)\n\t\treturn false;\n\n\tif (git_path_contains_dir(repository_path, GIT_REFS_DIR)  == false)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_gitfile",
          "args": [
            "&repo_link",
            "path.ptr"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "read_gitfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "316-348",
          "snippet": "static int read_gitfile(git_buf *path_out, const char *file_path)\n{\n\tint     error = 0;\n\tgit_buf file = GIT_BUF_INIT;\n\tsize_t  prefix_len = strlen(GIT_FILE_CONTENT_PREFIX);\n\n\tassert(path_out && file_path);\n\n\tif (git_futils_readbuffer(&file, file_path) < 0)\n\t\treturn -1;\n\n\tgit_buf_rtrim(&file);\n\t/* apparently on Windows, some people use backslashes in paths */\n\tgit_path_mkposix(file.ptr);\n\n\tif (git_buf_len(&file) <= prefix_len ||\n\t\tmemcmp(git_buf_cstr(&file), GIT_FILE_CONTENT_PREFIX, prefix_len) != 0)\n\t{\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"The `.git` file at '%s' is malformed\", file_path);\n\t\terror = -1;\n\t}\n\telse if ((error = git_path_dirname_r(path_out, file_path)) >= 0) {\n\t\tconst char *gitlink = git_buf_cstr(&file) + prefix_len;\n\t\twhile (*gitlink && git__isspace(*gitlink)) gitlink++;\n\n\t\terror = git_path_prettify_dir(\n\t\t\tpath_out, gitlink, git_buf_cstr(path_out));\n\t}\n\n\tgit_buf_free(&file);\n\treturn error;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [
            "#define GIT_FILE_CONTENT_PREFIX \"gitdir:\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_FILE_CONTENT_PREFIX \"gitdir:\"\n\nstatic int read_gitfile(git_buf *path_out, const char *file_path)\n{\n\tint     error = 0;\n\tgit_buf file = GIT_BUF_INIT;\n\tsize_t  prefix_len = strlen(GIT_FILE_CONTENT_PREFIX);\n\n\tassert(path_out && file_path);\n\n\tif (git_futils_readbuffer(&file, file_path) < 0)\n\t\treturn -1;\n\n\tgit_buf_rtrim(&file);\n\t/* apparently on Windows, some people use backslashes in paths */\n\tgit_path_mkposix(file.ptr);\n\n\tif (git_buf_len(&file) <= prefix_len ||\n\t\tmemcmp(git_buf_cstr(&file), GIT_FILE_CONTENT_PREFIX, prefix_len) != 0)\n\t{\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"The `.git` file at '%s' is malformed\", file_path);\n\t\terror = -1;\n\t}\n\telse if ((error = git_path_dirname_r(path_out, file_path)) >= 0) {\n\t\tconst char *gitlink = git_buf_cstr(&file) + prefix_len;\n\t\twhile (*gitlink && git__isspace(*gitlink)) gitlink++;\n\n\t\terror = git_path_prettify_dir(\n\t\t\tpath_out, gitlink, git_buf_cstr(path_out));\n\t}\n\n\tgit_buf_free(&file);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "st.st_mode"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_set",
          "args": [
            "repo_path",
            "path.ptr",
            "path.size"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "150-169",
          "snippet": "int git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nint git_buf_set(git_buf *buf, const void *data, size_t len)\n{\n\tsize_t alloclen;\n\n\tif (len == 0 || data == NULL) {\n\t\tgit_buf_clear(buf);\n\t} else {\n\t\tif (data != buf->ptr) {\n\t\t\tGITERR_CHECK_ALLOC_ADD(&alloclen, len, 1);\n\t\t\tENSURE_SIZE(buf, alloclen);\n\t\t\tmemmove(buf->ptr, data, len);\n\t\t}\n\n\t\tbuf->size = len;\n\t\tif (buf->asize > buf->size)\n\t\t\tbuf->ptr[buf->size] = '\\0';\n\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "st.st_mode"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_stat",
          "args": [
            "path.ptr",
            "&st"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "p_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/win32/posix_w32.c",
          "lines": "417-432",
          "snippet": "int p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}",
          "includes": [
            "#include <ws2tcpip.h>",
            "#include <fcntl.h>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include \"buffer.h\"",
            "#include \"global.h\"",
            "#include \"reparse.h\"",
            "#include \"repository.h\"",
            "#include \"utf-conv.h\"",
            "#include \"path_w32.h\"",
            "#include \"path.h\"",
            "#include \"../fileops.h\"",
            "#include \"../posix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ws2tcpip.h>\n#include <fcntl.h>\n#include <io.h>\n#include <errno.h>\n#include \"buffer.h\"\n#include \"global.h\"\n#include \"reparse.h\"\n#include \"repository.h\"\n#include \"utf-conv.h\"\n#include \"path_w32.h\"\n#include \"path.h\"\n#include \"../fileops.h\"\n#include \"../posix.h\"\n\nint p_stat(const char* path, struct stat* buf)\n{\n\tgit_win32_path path_w;\n\tint len;\n\n\tif ((len = git_win32_path_from_utf8(path_w, path)) < 0 ||\n\t\tlstat_w(path_w, buf, false) < 0)\n\t\treturn -1;\n\n\t/* The item is a symbolic link or mount point. No need to iterate\n\t * to follow multiple links; use GetFinalPathNameFromHandle. */\n\tif (S_ISLNK(buf->st_mode))\n\t\treturn follow_and_lstat_link(path_w, buf);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_joinpath",
          "args": [
            "&path",
            "path.ptr",
            "DOT_GIT"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_joinpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "131-134",
          "snippet": "GIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(int) git_buf_joinpath(git_buf *buf, const char *a, const char *b)\n{\n\treturn git_buf_join(buf, '/', a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_prettify",
          "args": [
            "&path",
            "start_path",
            "NULL"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_prettify_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "335-339",
          "snippet": "int git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int find_repo(\n\tgit_buf *repo_path,\n\tgit_buf *parent_path,\n\tgit_buf *link_path,\n\tconst char *start_path,\n\tuint32_t flags,\n\tconst char *ceiling_dirs)\n{\n\tint error;\n\tgit_buf path = GIT_BUF_INIT;\n\tstruct stat st;\n\tdev_t initial_device = 0;\n\tint min_iterations;\n\tbool in_dot_git;\n\tsize_t ceiling_offset = 0;\n\n\tgit_buf_free(repo_path);\n\n\tif ((error = git_path_prettify(&path, start_path, NULL)) < 0)\n\t\treturn error;\n\n\t/* in_dot_git toggles each loop:\n\t * /a/b/c/.git, /a/b/c, /a/b/.git, /a/b, /a/.git, /a\n\t * With GIT_REPOSITORY_OPEN_BARE, we assume we started with /a/b/c.git\n\t * and don't append .git the first time through.\n\t * min_iterations indicates the number of iterations left before going\n\t * further counts as a search. */\n\tif (flags & GIT_REPOSITORY_OPEN_BARE) {\n\t\tin_dot_git = true;\n\t\tmin_iterations = 1;\n\t} else {\n\t\tin_dot_git = false;\n\t\tmin_iterations = 2;\n\t}\n\n\twhile (!error && (min_iterations || !(path.ptr[ceiling_offset] == 0 ||\n\t\t\t\t\t      (flags & GIT_REPOSITORY_OPEN_NO_SEARCH)))) {\n\t\tif (!in_dot_git)\n\t\t\tif ((error = git_buf_joinpath(&path, path.ptr, DOT_GIT)) < 0)\n\t\t\t\tbreak;\n\t\tin_dot_git = !in_dot_git;\n\n\t\tif (p_stat(path.ptr, &st) == 0) {\n\t\t\t/* check that we have not crossed device boundaries */\n\t\t\tif (initial_device == 0)\n\t\t\t\tinitial_device = st.st_dev;\n\t\t\telse if (st.st_dev != initial_device &&\n\t\t\t\t(flags & GIT_REPOSITORY_OPEN_CROSS_FS) == 0)\n\t\t\t\tbreak;\n\n\t\t\tif (S_ISDIR(st.st_mode)) {\n\t\t\t\tif (valid_repository_path(&path)) {\n\t\t\t\t\tgit_path_to_dir(&path);\n\t\t\t\t\tgit_buf_set(repo_path, path.ptr, path.size);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (S_ISREG(st.st_mode)) {\n\t\t\t\tgit_buf repo_link = GIT_BUF_INIT;\n\n\t\t\t\tif (!(error = read_gitfile(&repo_link, path.ptr))) {\n\t\t\t\t\tif (valid_repository_path(&repo_link)) {\n\t\t\t\t\t\tgit_buf_swap(repo_path, &repo_link);\n\n\t\t\t\t\t\tif (link_path)\n\t\t\t\t\t\t\terror = git_buf_put(link_path, \n\t\t\t\t\t\t\t\tpath.ptr, path.size);\n\t\t\t\t\t}\n\n\t\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tgit_buf_free(&repo_link);\n\t\t\t}\n\t\t}\n\n\t\t/* move up one directory level */\n\t\tif (git_path_dirname_r(&path, path.ptr) < 0) {\n\t\t\terror = -1;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Once we've checked the directory (and .git if applicable),\n\t\t * find the ceiling for a search. */\n\t\tif (min_iterations && (--min_iterations == 0))\n\t\t\tceiling_offset = find_ceiling_dir_offset(path.ptr, ceiling_dirs);\n\t}\n\n\tif (!error && parent_path && !(flags & GIT_REPOSITORY_OPEN_BARE)) {\n\t\tif (!git_buf_len(repo_path))\n\t\t\tgit_buf_clear(parent_path);\n\t\telse {\n\t\t\tgit_path_dirname_r(parent_path, path.ptr);\n\t\t\tgit_path_to_dir(parent_path);\n\t\t}\n\t\tif (git_buf_oom(parent_path))\n\t\t\treturn -1;\n\t}\n\n\tgit_buf_free(&path);\n\n\tif (!git_buf_len(repo_path) && !error) {\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"Could not find repository from '%s'\", start_path);\n\t\terror = GIT_ENOTFOUND;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "read_gitfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "316-348",
    "snippet": "static int read_gitfile(git_buf *path_out, const char *file_path)\n{\n\tint     error = 0;\n\tgit_buf file = GIT_BUF_INIT;\n\tsize_t  prefix_len = strlen(GIT_FILE_CONTENT_PREFIX);\n\n\tassert(path_out && file_path);\n\n\tif (git_futils_readbuffer(&file, file_path) < 0)\n\t\treturn -1;\n\n\tgit_buf_rtrim(&file);\n\t/* apparently on Windows, some people use backslashes in paths */\n\tgit_path_mkposix(file.ptr);\n\n\tif (git_buf_len(&file) <= prefix_len ||\n\t\tmemcmp(git_buf_cstr(&file), GIT_FILE_CONTENT_PREFIX, prefix_len) != 0)\n\t{\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"The `.git` file at '%s' is malformed\", file_path);\n\t\terror = -1;\n\t}\n\telse if ((error = git_path_dirname_r(path_out, file_path)) >= 0) {\n\t\tconst char *gitlink = git_buf_cstr(&file) + prefix_len;\n\t\twhile (*gitlink && git__isspace(*gitlink)) gitlink++;\n\n\t\terror = git_path_prettify_dir(\n\t\t\tpath_out, gitlink, git_buf_cstr(path_out));\n\t}\n\n\tgit_buf_free(&file);\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [
      "#define GIT_FILE_CONTENT_PREFIX \"gitdir:\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "&file"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_prettify_dir",
          "args": [
            "path_out",
            "gitlink",
            "git_buf_cstr(path_out)"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_prettify_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "335-339",
          "snippet": "int git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_cstr",
          "args": [
            "path_out"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_cstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "136-139",
          "snippet": "GIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(const char *) git_buf_cstr(const git_buf *buf)\n{\n\treturn buf->ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__isspace",
          "args": [
            "*gitlink"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "git__isspace_nonlf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "459-462",
          "snippet": "GIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(bool) git__isspace_nonlf(int c)\n{\n\treturn (c == ' ' || c == '\\t' || c == '\\f' || c == '\\r' || c == '\\v');\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_dirname_r",
          "args": [
            "path_out",
            "file_path"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_dirname_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "117-178",
          "snippet": "int git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "giterr_set",
          "args": [
            "GITERR_REPOSITORY",
            "\"The `.git` file at '%s' is malformed\"",
            "file_path"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "giterr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/errors.c",
          "lines": "50-89",
          "snippet": "void giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}",
          "includes": [
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"global.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer.h\"\n#include \"posix.h\"\n#include \"global.h\"\n#include \"common.h\"\n\nvoid giterr_set(int error_class, const char *string, ...)\n{\n\tva_list arglist;\n#ifdef GIT_WIN32\n\tDWORD win32_error_code = (error_class == GITERR_OS) ? GetLastError() : 0;\n#endif\n\tint error_code = (error_class == GITERR_OS) ? errno : 0;\n\tgit_buf *buf = &GIT_GLOBAL->error_buf;\n\n\tgit_buf_clear(buf);\n\tif (string) {\n\t\tva_start(arglist, string);\n\t\tgit_buf_vprintf(buf, string, arglist);\n\t\tva_end(arglist);\n\n\t\tif (error_class == GITERR_OS)\n\t\t\tgit_buf_PUTS(buf, \": \");\n\t}\n\n\tif (error_class == GITERR_OS) {\n#ifdef GIT_WIN32\n\t\tchar * win32_error = git_win32_get_error_message(win32_error_code);\n\t\tif (win32_error) {\n\t\t\tgit_buf_puts(buf, win32_error);\n\t\t\tgit__free(win32_error);\n\n\t\t\tSetLastError(0);\n\t\t}\n\t\telse\n#endif\n\t\tif (error_code)\n\t\t\tgit_buf_puts(buf, strerror(error_code));\n\n\t\tif (error_code)\n\t\t\terrno = 0;\n\t}\n\n\tif (!git_buf_oom(buf))\n\t\tset_error_from_buffer(error_class);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "git_buf_cstr(&file)",
            "GIT_FILE_CONTENT_PREFIX",
            "prefix_len"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_len",
          "args": [
            "&file"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.h",
          "lines": "141-144",
          "snippet": "GIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}",
          "includes": [
            "#include \"git2/buffer.h\"",
            "#include \"git2/strarray.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/buffer.h\"\n#include \"git2/strarray.h\"\n#include \"common.h\"\n\nGIT_INLINE(size_t) git_buf_len(const git_buf *buf)\n{\n\treturn buf->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_mkposix",
          "args": [
            "file.ptr"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_mkposix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.h",
          "lines": "110-118",
          "snippet": "GIT_INLINE(void) git_path_mkposix(char *path)\n{\n\twhile (*path) {\n\t\tif (*path == '\\\\')\n\t\t\t*path = '/';\n\n\t\tpath++;\n\t}\n}",
          "includes": [
            "#include <iconv.h>",
            "#include \"vector.h\"",
            "#include \"buffer.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iconv.h>\n#include \"vector.h\"\n#include \"buffer.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nGIT_INLINE(void) git_path_mkposix(char *path)\n{\n\twhile (*path) {\n\t\tif (*path == '\\\\')\n\t\t\t*path = '/';\n\n\t\tpath++;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_buf_rtrim",
          "args": [
            "&file"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_rtrim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "718-729",
          "snippet": "void git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nvoid git_buf_rtrim(git_buf *buf)\n{\n\twhile (buf->size > 0) {\n\t\tif (!git__isspace(buf->ptr[buf->size - 1]))\n\t\t\tbreak;\n\n\t\tbuf->size--;\n\t}\n\n\tif (buf->asize > buf->size)\n\t\tbuf->ptr[buf->size] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_futils_readbuffer",
          "args": [
            "&file",
            "file_path"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "git_futils_readbuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/fileops.c",
          "lines": "224-227",
          "snippet": "int git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}",
          "includes": [
            "#include \"win32/findfile.h\"",
            "#include <ctype.h>",
            "#include \"strmap.h\"",
            "#include \"global.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"win32/findfile.h\"\n#include <ctype.h>\n#include \"strmap.h\"\n#include \"global.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nint git_futils_readbuffer(git_buf *buf, const char *path)\n{\n\treturn git_futils_readbuffer_updated(buf, path, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "path_out && file_path"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "GIT_FILE_CONTENT_PREFIX"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\n#define GIT_FILE_CONTENT_PREFIX \"gitdir:\"\n\nstatic int read_gitfile(git_buf *path_out, const char *file_path)\n{\n\tint     error = 0;\n\tgit_buf file = GIT_BUF_INIT;\n\tsize_t  prefix_len = strlen(GIT_FILE_CONTENT_PREFIX);\n\n\tassert(path_out && file_path);\n\n\tif (git_futils_readbuffer(&file, file_path) < 0)\n\t\treturn -1;\n\n\tgit_buf_rtrim(&file);\n\t/* apparently on Windows, some people use backslashes in paths */\n\tgit_path_mkposix(file.ptr);\n\n\tif (git_buf_len(&file) <= prefix_len ||\n\t\tmemcmp(git_buf_cstr(&file), GIT_FILE_CONTENT_PREFIX, prefix_len) != 0)\n\t{\n\t\tgiterr_set(GITERR_REPOSITORY,\n\t\t\t\"The `.git` file at '%s' is malformed\", file_path);\n\t\terror = -1;\n\t}\n\telse if ((error = git_path_dirname_r(path_out, file_path)) >= 0) {\n\t\tconst char *gitlink = git_buf_cstr(&file) + prefix_len;\n\t\twhile (*gitlink && git__isspace(*gitlink)) gitlink++;\n\n\t\terror = git_path_prettify_dir(\n\t\t\tpath_out, gitlink, git_buf_cstr(path_out));\n\t}\n\n\tgit_buf_free(&file);\n\treturn error;\n}"
  },
  {
    "function_name": "find_ceiling_dir_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "267-309",
    "snippet": "static size_t find_ceiling_dir_offset(\n\tconst char *path,\n\tconst char *ceiling_directories)\n{\n\tchar buf[GIT_PATH_MAX + 1];\n\tchar buf2[GIT_PATH_MAX + 1];\n\tconst char *ceil, *sep;\n\tsize_t len, max_len = 0, min_len;\n\n\tassert(path);\n\n\tmin_len = (size_t)(git_path_root(path) + 1);\n\n\tif (ceiling_directories == NULL || min_len == 0)\n\t\treturn min_len;\n\n\tfor (sep = ceil = ceiling_directories; *sep; ceil = sep + 1) {\n\t\tfor (sep = ceil; *sep && *sep != GIT_PATH_LIST_SEPARATOR; sep++);\n\t\tlen = sep - ceil;\n\n\t\tif (len == 0 || len >= sizeof(buf) || git_path_root(ceil) == -1)\n\t\t\tcontinue;\n\n\t\tstrncpy(buf, ceil, len);\n\t\tbuf[len] = '\\0';\n\n\t\tif (p_realpath(buf, buf2) == NULL)\n\t\t\tcontinue;\n\n\t\tlen = strlen(buf2);\n\t\tif (len > 0 && buf2[len-1] == '/')\n\t\t\tbuf[--len] = '\\0';\n\n\t\tif (!strncmp(path, buf2, len) &&\n\t\t\t(path[len] == '/' || !path[len]) &&\n\t\t\tlen > max_len)\n\t\t{\n\t\t\tmax_len = len;\n\t\t}\n\t}\n\n\treturn (max_len <= min_len ? min_len : max_len);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "path",
            "buf2",
            "len"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "git__strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.c",
          "lines": "205-212",
          "snippet": "int git__strncmp(const char *a, const char *b, size_t sz)\n{\n\twhile (sz && *a && *b && *a == *b)\n\t\t--sz, ++a, ++b;\n\tif (!sz)\n\t\treturn 0;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}",
          "includes": [
            "# include <Shlwapi.h>",
            "# include \"win32/w32_buffer.h\"",
            "#include \"posix.h\"",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include \"common.h\"",
            "#include <git2.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <Shlwapi.h>\n# include \"win32/w32_buffer.h\"\n#include \"posix.h\"\n#include <ctype.h>\n#include <stdio.h>\n#include \"common.h\"\n#include <git2.h>\n\nint git__strncmp(const char *a, const char *b, size_t sz)\n{\n\twhile (sz && *a && *b && *a == *b)\n\t\t--sz, ++a, ++b;\n\tif (!sz)\n\t\treturn 0;\n\treturn (int)(*(const unsigned char *)a) - (int)(*(const unsigned char *)b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "buf2"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p_realpath",
          "args": [
            "buf",
            "buf2"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "p_realpath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/unix/realpath.c",
          "lines": "16-29",
          "snippet": "char *p_realpath(const char *pathname, char *resolved)\n{\n\tchar *ret;\n\tif ((ret = realpath(pathname, resolved)) == NULL)\n\t\treturn NULL;\n\n#ifdef __OpenBSD__\n\t/* The OpenBSD realpath function behaves differently,\n\t * figure out if the file exists */\n\tif (access(ret, F_OK) < 0)\n\t\tret = NULL;\n#endif\n\treturn ret;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <git2/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <git2/common.h>\n\nchar *p_realpath(const char *pathname, char *resolved)\n{\n\tchar *ret;\n\tif ((ret = realpath(pathname, resolved)) == NULL)\n\t\treturn NULL;\n\n#ifdef __OpenBSD__\n\t/* The OpenBSD realpath function behaves differently,\n\t * figure out if the file exists */\n\tif (access(ret, F_OK) < 0)\n\t\tret = NULL;\n#endif\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "buf",
            "ceil",
            "len"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_path_root",
          "args": [
            "ceil"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "238-263",
          "snippet": "int git_path_root(const char *path)\n{\n\tint offset = 0;\n\n\t/* Does the root of the path look like a windows drive ? */\n\tif (LOOKS_LIKE_DRIVE_PREFIX(path))\n\t\toffset += 2;\n\n#ifdef GIT_WIN32\n\t/* Are we dealing with a windows network path? */\n\telse if ((path[0] == '/' && path[1] == '/' && path[2] != '/') ||\n\t\t(path[0] == '\\\\' && path[1] == '\\\\' && path[2] != '\\\\'))\n\t{\n\t\toffset += 2;\n\n\t\t/* Skip the computer name segment */\n\t\twhile (path[offset] && path[offset] != '/' && path[offset] != '\\\\')\n\t\t\toffset++;\n\t}\n#endif\n\n\tif (path[offset] == '/' || path[offset] == '\\\\')\n\t\treturn offset;\n\n\treturn -1;\t/* Not a real error - signals that path is not rooted */\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_root(const char *path)\n{\n\tint offset = 0;\n\n\t/* Does the root of the path look like a windows drive ? */\n\tif (LOOKS_LIKE_DRIVE_PREFIX(path))\n\t\toffset += 2;\n\n#ifdef GIT_WIN32\n\t/* Are we dealing with a windows network path? */\n\telse if ((path[0] == '/' && path[1] == '/' && path[2] != '/') ||\n\t\t(path[0] == '\\\\' && path[1] == '\\\\' && path[2] != '\\\\'))\n\t{\n\t\toffset += 2;\n\n\t\t/* Skip the computer name segment */\n\t\twhile (path[offset] && path[offset] != '/' && path[offset] != '\\\\')\n\t\t\toffset++;\n\t}\n#endif\n\n\tif (path[offset] == '/' || path[offset] == '\\\\')\n\t\treturn offset;\n\n\treturn -1;\t/* Not a real error - signals that path is not rooted */\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "path"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic size_t find_ceiling_dir_offset(\n\tconst char *path,\n\tconst char *ceiling_directories)\n{\n\tchar buf[GIT_PATH_MAX + 1];\n\tchar buf2[GIT_PATH_MAX + 1];\n\tconst char *ceil, *sep;\n\tsize_t len, max_len = 0, min_len;\n\n\tassert(path);\n\n\tmin_len = (size_t)(git_path_root(path) + 1);\n\n\tif (ceiling_directories == NULL || min_len == 0)\n\t\treturn min_len;\n\n\tfor (sep = ceil = ceiling_directories; *sep; ceil = sep + 1) {\n\t\tfor (sep = ceil; *sep && *sep != GIT_PATH_LIST_SEPARATOR; sep++);\n\t\tlen = sep - ceil;\n\n\t\tif (len == 0 || len >= sizeof(buf) || git_path_root(ceil) == -1)\n\t\t\tcontinue;\n\n\t\tstrncpy(buf, ceil, len);\n\t\tbuf[len] = '\\0';\n\n\t\tif (p_realpath(buf, buf2) == NULL)\n\t\t\tcontinue;\n\n\t\tlen = strlen(buf2);\n\t\tif (len > 0 && buf2[len-1] == '/')\n\t\t\tbuf[--len] = '\\0';\n\n\t\tif (!strncmp(path, buf2, len) &&\n\t\t\t(path[len] == '/' || !path[len]) &&\n\t\t\tlen > max_len)\n\t\t{\n\t\t\tmax_len = len;\n\t\t}\n\t}\n\n\treturn (max_len <= min_len ? min_len : max_len);\n}"
  },
  {
    "function_name": "load_workdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "221-257",
    "snippet": "static int load_workdir(git_repository *repo, git_config *config, git_buf *parent_path)\n{\n\tint         error;\n\tgit_config_entry *ce;\n\tgit_buf     worktree = GIT_BUF_INIT;\n\n\tif (repo->is_bare)\n\t\treturn 0;\n\n\tif ((error = git_config__lookup_entry(\n\t\t\t&ce, config, \"core.worktree\", false)) < 0)\n\t\treturn error;\n\n\tif (ce && ce->value) {\n\t\tif ((error = git_path_prettify_dir(\n\t\t\t\t&worktree, ce->value, repo->path_repository)) < 0)\n\t\t\tgoto cleanup;\n\n\t\trepo->workdir = git_buf_detach(&worktree);\n\t}\n\telse if (parent_path && git_path_isdir(parent_path->ptr))\n\t\trepo->workdir = git_buf_detach(parent_path);\n\telse {\n\t\tif (git_path_dirname_r(&worktree, repo->path_repository) < 0 ||\n\t\t    git_path_to_dir(&worktree) < 0) {\n\t\t\terror = -1;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\trepo->workdir = git_buf_detach(&worktree);\n\t}\n\n\tGITERR_CHECK_ALLOC(repo->workdir);\ncleanup:\n\tgit_config_entry_free(ce);\n\treturn error;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_entry_free",
          "args": [
            "ce"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_entry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "23-29",
          "snippet": "void git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_entry_free(git_config_entry *entry)\n{\n\tif (!entry)\n\t\treturn;\n\n\tentry->free(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "repo->workdir"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_detach",
          "args": [
            "&worktree"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "477-487",
          "snippet": "char *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nchar *git_buf_detach(git_buf *buf)\n{\n\tchar *data = buf->ptr;\n\n\tif (buf->asize == 0 || buf->ptr == git_buf__oom)\n\t\treturn NULL;\n\n\tgit_buf_init(buf, 0);\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_to_dir",
          "args": [
            "&worktree"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_to_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "341-349",
          "snippet": "int git_path_to_dir(git_buf *path)\n{\n\tif (path->asize > 0 &&\n\t\tgit_buf_len(path) > 0 &&\n\t\tpath->ptr[git_buf_len(path) - 1] != '/')\n\t\tgit_buf_putc(path, '/');\n\n\treturn git_buf_oom(path) ? -1 : 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_to_dir(git_buf *path)\n{\n\tif (path->asize > 0 &&\n\t\tgit_buf_len(path) > 0 &&\n\t\tpath->ptr[git_buf_len(path) - 1] != '/')\n\t\tgit_buf_putc(path, '/');\n\n\treturn git_buf_oom(path) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_dirname_r",
          "args": [
            "&worktree",
            "repo->path_repository"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_dirname_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "117-178",
          "snippet": "int git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_dirname_r(git_buf *buffer, const char *path)\n{\n\tconst char *endp;\n\tint result, len;\n\n\t/* Empty or NULL string gets treated as \".\" */\n\tif (path == NULL || *path == '\\0') {\n\t\tpath = \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\t/* Strip trailing slashes */\n\tendp = path + strlen(path) - 1;\n\twhile (endp > path && *endp == '/')\n\t\tendp--;\n\n\t/* Find the start of the dir */\n\twhile (endp > path && *endp != '/')\n\t\tendp--;\n\n\t/* Either the dir is \"/\" or there are no slashes */\n\tif (endp == path) {\n\t\tpath = (*endp == '/') ? \"/\" : \".\";\n\t\tlen = 1;\n\t\tgoto Exit;\n\t}\n\n\tdo {\n\t\tendp--;\n\t} while (endp > path && *endp == '/');\n\n\t/* Cast is safe because max path < max int */\n\tlen = (int)(endp - path + 1);\n\n#ifdef GIT_WIN32\n\t/* Mimic unix behavior where '/.git' returns '/': 'C:/.git' will return\n\t\t'C:/' here */\n\n\tif (len == 2 && LOOKS_LIKE_DRIVE_PREFIX(path)) {\n\t\tlen = 3;\n\t\tgoto Exit;\n\t}\n\n\t/* Similarly checks if we're dealing with a network computer name\n\t\t'//computername/.git' will return '//computername/' */\n\n\tif (looks_like_network_computer_name(path, len)) {\n\t\tlen++;\n\t\tgoto Exit;\n\t}\n\n#endif\n\nExit:\n\tresult = len;\n\n\tif (buffer != NULL && git_buf_set(buffer, path, len) < 0)\n\t\treturn -1;\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_isdir",
          "args": [
            "parent_path->ptr"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_isdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "509-516",
          "snippet": "bool git_path_isdir(const char *path)\n{\n\tstruct stat st;\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISDIR(st.st_mode) != 0;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_isdir(const char *path)\n{\n\tstruct stat st;\n\tif (p_stat(path, &st) < 0)\n\t\treturn false;\n\n\treturn S_ISDIR(st.st_mode) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_prettify_dir",
          "args": [
            "&worktree",
            "ce->value",
            "repo->path_repository"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_prettify_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "335-339",
          "snippet": "int git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nint git_path_prettify_dir(git_buf *path_out, const char *path, const char *base)\n{\n\tint error = git_path_prettify(path_out, path, base);\n\treturn (error < 0) ? error : git_path_to_dir(path_out);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config__lookup_entry",
          "args": [
            "&ce",
            "config",
            "\"core.worktree\"",
            "false"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "git_config__lookup_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "737-745",
          "snippet": "int git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config__lookup_entry(\n\tgit_config_entry **out,\n\tconst git_config *cfg,\n\tconst char *key,\n\tbool no_errors)\n{\n\treturn get_entry(\n\t\tout, cfg, key, false, no_errors ? GET_NO_ERRORS : GET_NO_MISSING);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int load_workdir(git_repository *repo, git_config *config, git_buf *parent_path)\n{\n\tint         error;\n\tgit_config_entry *ce;\n\tgit_buf     worktree = GIT_BUF_INIT;\n\n\tif (repo->is_bare)\n\t\treturn 0;\n\n\tif ((error = git_config__lookup_entry(\n\t\t\t&ce, config, \"core.worktree\", false)) < 0)\n\t\treturn error;\n\n\tif (ce && ce->value) {\n\t\tif ((error = git_path_prettify_dir(\n\t\t\t\t&worktree, ce->value, repo->path_repository)) < 0)\n\t\t\tgoto cleanup;\n\n\t\trepo->workdir = git_buf_detach(&worktree);\n\t}\n\telse if (parent_path && git_path_isdir(parent_path->ptr))\n\t\trepo->workdir = git_buf_detach(parent_path);\n\telse {\n\t\tif (git_path_dirname_r(&worktree, repo->path_repository) < 0 ||\n\t\t    git_path_to_dir(&worktree) < 0) {\n\t\t\terror = -1;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\trepo->workdir = git_buf_detach(&worktree);\n\t}\n\n\tGITERR_CHECK_ALLOC(repo->workdir);\ncleanup:\n\tgit_config_entry_free(ce);\n\treturn error;\n}"
  },
  {
    "function_name": "load_config_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "208-219",
    "snippet": "static int load_config_data(git_repository *repo, const git_config *config)\n{\n\tint is_bare;\n\n\t/* Try to figure out if it's bare, default to non-bare if it's not set */\n\tif (git_config_get_bool(&is_bare, config, \"core.bare\") < 0)\n\t\trepo->is_bare = 0;\n\telse\n\t\trepo->is_bare = is_bare;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_config_get_bool",
          "args": [
            "&is_bare",
            "config",
            "\"core.bare\""
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_get_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "794-806",
          "snippet": "int git_config_get_bool(int *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_bool(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nint git_config_get_bool(int *out, const git_config *cfg, const char *name)\n{\n\tgit_config_entry *entry;\n\tint ret;\n\n\tif ((ret = get_entry(&entry, cfg, name, true, GET_ALL_ERRORS)) < 0)\n\t\treturn ret;\n\n\tret = git_config_parse_bool(out, entry->value);\n\tgit_config_entry_free(entry);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic int load_config_data(git_repository *repo, const git_config *config)\n{\n\tint is_bare;\n\n\t/* Try to figure out if it's bare, default to non-bare if it's not set */\n\tif (git_config_get_bool(&is_bare, config, \"core.bare\") < 0)\n\t\trepo->is_bare = 0;\n\telse\n\t\trepo->is_bare = is_bare;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "git_repository_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "196-206",
    "snippet": "int git_repository_new(git_repository **out)\n{\n\tgit_repository *repo;\n\n\t*out = repo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\trepo->is_bare = 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GITERR_CHECK_ALLOC",
          "args": [
            "repo"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "repository_alloc",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "repository_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "171-194",
          "snippet": "static git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nint git_repository_new(git_repository **out)\n{\n\tgit_repository *repo;\n\n\t*out = repo = repository_alloc();\n\tGITERR_CHECK_ALLOC(repo);\n\n\trepo->is_bare = 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "repository_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "171-194",
    "snippet": "static git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "repo"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cache_free",
          "args": [
            "&repo->objects"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "106-112",
          "snippet": "void git_cache_free(git_cache *cache)\n{\n\tgit_cache_clear(cache);\n\tgit_oidmap_free(cache->map);\n\tgit_rwlock_free(&cache->lock);\n\tgit__memzero(cache, sizeof(*cache));\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cache_free(git_cache *cache)\n{\n\tgit_cache_clear(cache);\n\tgit_oidmap_free(cache->map);\n\tgit_rwlock_free(&cache->lock);\n\tgit__memzero(cache, sizeof(*cache));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository__cvar_cache_clear",
          "args": [
            "repo"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__cvar_cache_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
          "lines": "122-128",
          "snippet": "void git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"vector.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"repository.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_init_to_size",
          "args": [
            "repo->reserved_names",
            "4"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_cache_init",
          "args": [
            "&repo->objects"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "67-77",
          "snippet": "int git_cache_init(git_cache *cache)\n{\n\tmemset(cache, 0, sizeof(*cache));\n\tcache->map = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(cache->map);\n\tif (git_rwlock_init(&cache->lock)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize cache rwlock\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nint git_cache_init(git_cache *cache)\n{\n\tmemset(cache, 0, sizeof(*cache));\n\tcache->map = git_oidmap_alloc();\n\tGITERR_CHECK_ALLOC(cache->map);\n\tif (git_rwlock_init(&cache->lock)) {\n\t\tgiterr_set(GITERR_OS, \"Failed to initialize cache rwlock\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__calloc",
          "args": [
            "1",
            "sizeof(git_repository)"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "git__calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "167-172",
          "snippet": "GIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void *) git__calloc(size_t nelem, size_t elsize)\n{\n\tvoid *ptr = calloc(nelem, elsize);\n\tif (!ptr) giterr_set_oom();\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic git_repository *repository_alloc(void)\n{\n\tgit_repository *repo = git__calloc(1, sizeof(git_repository));\n\n\tif (repo == NULL ||\n\t\tgit_cache_init(&repo->objects) < 0)\n\t\tgoto on_error;\n\n\tgit_array_init_to_size(repo->reserved_names, 4);\n\tif (!repo->reserved_names.ptr)\n\t\tgoto on_error;\n\n\t/* set all the entries in the cvar cache to `unset` */\n\tgit_repository__cvar_cache_clear(repo);\n\n\treturn repo;\n\non_error:\n\tif (repo)\n\t\tgit_cache_free(&repo->objects);\n\n\tgit__free(repo);\n\treturn NULL;\n}"
  },
  {
    "function_name": "valid_repository_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "155-169",
    "snippet": "static bool valid_repository_path(git_buf *repository_path)\n{\n\t/* Check OBJECTS_DIR first, since it will generate the longest path name */\n\tif (git_path_contains_dir(repository_path, GIT_OBJECTS_DIR) == false)\n\t\treturn false;\n\n\t/* Ensure HEAD file exists */\n\tif (git_path_contains_file(repository_path, GIT_HEAD_FILE) == false)\n\t\treturn false;\n\n\tif (git_path_contains_dir(repository_path, GIT_REFS_DIR)  == false)\n\t\treturn false;\n\n\treturn true;\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_path_contains_dir",
          "args": [
            "repository_path",
            "GIT_REFS_DIR"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_contains_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "673-676",
          "snippet": "bool git_path_contains_dir(git_buf *base, const char *subdir)\n{\n\treturn _check_dir_contents(base, subdir, &git_path_isdir);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_contains_dir(git_buf *base, const char *subdir)\n{\n\treturn _check_dir_contents(base, subdir, &git_path_isdir);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_path_contains_file",
          "args": [
            "repository_path",
            "GIT_HEAD_FILE"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "git_path_contains_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/path.c",
          "lines": "678-681",
          "snippet": "bool git_path_contains_file(git_buf *base, const char *file)\n{\n\treturn _check_dir_contents(base, file, &git_path_isfile);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <dirent.h>",
            "#include \"win32/version.h\"",
            "#include \"win32/w32_util.h\"",
            "#include \"win32/w32_buffer.h\"",
            "#include \"win32/posix.h\"",
            "#include \"repository.h\"",
            "#include \"posix.h\"",
            "#include \"path.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <stdio.h>\n#include <dirent.h>\n#include \"win32/version.h\"\n#include \"win32/w32_util.h\"\n#include \"win32/w32_buffer.h\"\n#include \"win32/posix.h\"\n#include \"repository.h\"\n#include \"posix.h\"\n#include \"path.h\"\n#include \"common.h\"\n\nbool git_path_contains_file(git_buf *base, const char *file)\n{\n\treturn _check_dir_contents(base, file, &git_path_isfile);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic bool valid_repository_path(git_buf *repository_path)\n{\n\t/* Check OBJECTS_DIR first, since it will generate the longest path name */\n\tif (git_path_contains_dir(repository_path, GIT_OBJECTS_DIR) == false)\n\t\treturn false;\n\n\t/* Ensure HEAD file exists */\n\tif (git_path_contains_file(repository_path, GIT_HEAD_FILE) == false)\n\t\treturn false;\n\n\tif (git_path_contains_dir(repository_path, GIT_REFS_DIR)  == false)\n\t\treturn false;\n\n\treturn true;\n}"
  },
  {
    "function_name": "git_repository_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "121-148",
    "snippet": "void git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git__free",
          "args": [
            "repo"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "git__free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "244-247",
          "snippet": "GIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__free(void *ptr)\n{\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git__memzero",
          "args": [
            "repo",
            "sizeof(*repo)"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "git__memzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/util.h",
          "lines": "521-531",
          "snippet": "GIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}",
          "includes": [
            "#include <sys/time.h>",
            "#include <proto/timer.h>",
            "#include <mach/mach_time.h>",
            "#include \"thread-utils.h\"",
            "#include \"strnlen.h\"",
            "#include \"common.h\"",
            "#include \"win32/w32_crtdbg_stacktrace.h\"",
            "#include <crtdbg.h>",
            "#include <stdlib.h>",
            "#include \"buffer.h\"",
            "#include \"git2/buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/time.h>\n#include <proto/timer.h>\n#include <mach/mach_time.h>\n#include \"thread-utils.h\"\n#include \"strnlen.h\"\n#include \"common.h\"\n#include \"win32/w32_crtdbg_stacktrace.h\"\n#include <crtdbg.h>\n#include <stdlib.h>\n#include \"buffer.h\"\n#include \"git2/buffer.h\"\n\nGIT_INLINE(void) git__memzero(void *data, size_t size)\n{\n#ifdef _MSC_VER\n\tSecureZeroMemory((PVOID)data, size);\n#else\n\tvolatile uint8_t *scan = (volatile uint8_t *)data;\n\n\twhile (size--)\n\t\t*scan++ = 0x0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_clear",
          "args": [
            "repo->reserved_names"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_buf_free",
          "args": [
            "git_array_get(repo->reserved_names, i)"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "git_buf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/buffer.c",
          "lines": "118-126",
          "snippet": "void git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"buf_text.h\"",
            "#include \"git2/buffer.h\"",
            "#include \"posix.h\"",
            "#include \"buffer.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char git_buf__oom[1];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"buf_text.h\"\n#include \"git2/buffer.h\"\n#include \"posix.h\"\n#include \"buffer.h\"\n\nchar git_buf__oom[1];\n\nvoid git_buf_free(git_buf *buf)\n{\n\tif (!buf) return;\n\n\tif (buf->asize > 0 && buf->ptr != NULL && buf->ptr != git_buf__oom)\n\t\tgit__free(buf->ptr);\n\n\tgit_buf_init(buf, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_array_get",
          "args": [
            "repo->reserved_names",
            "i"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git_diff_driver_registry_free",
          "args": [
            "repo->diff_drivers"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "git_diff_driver_registry_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/diff_driver.c",
          "lines": "77-87",
          "snippet": "void git_diff_driver_registry_free(git_diff_driver_registry *reg)\n{\n\tgit_diff_driver *drv;\n\n\tif (!reg)\n\t\treturn;\n\n\tgit_strmap_foreach_value(reg->drivers, drv, git_diff_driver_free(drv));\n\tgit_strmap_free(reg->drivers);\n\tgit__free(reg);\n}",
          "includes": [
            "#include \"userdiff.h\"",
            "#include \"repository.h\"",
            "#include \"config.h\"",
            "#include \"buf_text.h\"",
            "#include \"map.h\"",
            "#include \"strmap.h\"",
            "#include \"diff_driver.h\"",
            "#include \"diff_patch.h\"",
            "#include \"diff.h\"",
            "#include \"git2/attr.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"userdiff.h\"\n#include \"repository.h\"\n#include \"config.h\"\n#include \"buf_text.h\"\n#include \"map.h\"\n#include \"strmap.h\"\n#include \"diff_driver.h\"\n#include \"diff_patch.h\"\n#include \"diff.h\"\n#include \"git2/attr.h\"\n#include \"common.h\"\n\nvoid git_diff_driver_registry_free(git_diff_driver_registry *reg)\n{\n\tgit_diff_driver *drv;\n\n\tif (!reg)\n\t\treturn;\n\n\tgit_strmap_foreach_value(reg->drivers, drv, git_diff_driver_free(drv));\n\tgit_strmap_free(reg->drivers);\n\tgit__free(reg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cache_free",
          "args": [
            "&repo->objects"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "106-112",
          "snippet": "void git_cache_free(git_cache *cache)\n{\n\tgit_cache_clear(cache);\n\tgit_oidmap_free(cache->map);\n\tgit_rwlock_free(&cache->lock);\n\tgit__memzero(cache, sizeof(*cache));\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cache_free(git_cache *cache)\n{\n\tgit_cache_clear(cache);\n\tgit_oidmap_free(cache->map);\n\tgit_rwlock_free(&cache->lock);\n\tgit__memzero(cache, sizeof(*cache));\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_repository__cleanup",
          "args": [
            "repo"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "108-119",
          "snippet": "void git_repository__cleanup(git_repository *repo)\n{\n\tassert(repo);\n\n\tgit_cache_clear(&repo->objects);\n\tgit_attr_cache_flush(repo);\n\n\tset_config(repo, NULL);\n\tset_index(repo, NULL);\n\tset_odb(repo, NULL);\n\tset_refdb(repo, NULL);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository__cleanup(git_repository *repo)\n{\n\tassert(repo);\n\n\tgit_cache_clear(&repo->objects);\n\tgit_attr_cache_flush(repo);\n\n\tset_config(repo, NULL);\n\tset_index(repo, NULL);\n\tset_odb(repo, NULL);\n\tset_refdb(repo, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_free(git_repository *repo)\n{\n\tsize_t i;\n\n\tif (repo == NULL)\n\t\treturn;\n\n\tgit_repository__cleanup(repo);\n\n\tgit_cache_free(&repo->objects);\n\n\tgit_diff_driver_registry_free(repo->diff_drivers);\n\trepo->diff_drivers = NULL;\n\n\tfor (i = 0; i < repo->reserved_names.size; i++)\n\t\tgit_buf_free(git_array_get(repo->reserved_names, i));\n\tgit_array_clear(repo->reserved_names);\n\n\tgit__free(repo->path_gitlink);\n\tgit__free(repo->path_repository);\n\tgit__free(repo->workdir);\n\tgit__free(repo->namespace);\n\tgit__free(repo->ident_name);\n\tgit__free(repo->ident_email);\n\n\tgit__memzero(repo, sizeof(*repo));\n\tgit__free(repo);\n}"
  },
  {
    "function_name": "git_repository__cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "108-119",
    "snippet": "void git_repository__cleanup(git_repository *repo)\n{\n\tassert(repo);\n\n\tgit_cache_clear(&repo->objects);\n\tgit_attr_cache_flush(repo);\n\n\tset_config(repo, NULL);\n\tset_index(repo, NULL);\n\tset_odb(repo, NULL);\n\tset_refdb(repo, NULL);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_refdb",
          "args": [
            "repo",
            "NULL"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_refdb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "813-817",
          "snippet": "void git_repository_set_refdb(git_repository *repo, git_refdb *refdb)\n{\n\tassert(repo && refdb);\n\tset_refdb(repo, refdb);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_set_refdb(git_repository *repo, git_refdb *refdb)\n{\n\tassert(repo && refdb);\n\tset_refdb(repo, refdb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_odb",
          "args": [
            "repo",
            "NULL"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_odb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "773-777",
          "snippet": "void git_repository_set_odb(git_repository *repo, git_odb *odb)\n{\n\tassert(repo && odb);\n\tset_odb(repo, odb);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_set_odb(git_repository *repo, git_odb *odb)\n{\n\tassert(repo && odb);\n\tset_odb(repo, odb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_index",
          "args": [
            "repo",
            "NULL"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "861-865",
          "snippet": "void git_repository_set_index(git_repository *repo, git_index *index)\n{\n\tassert(repo);\n\tset_index(repo, index);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository_set_index(git_repository *repo, git_index *index)\n{\n\tassert(repo);\n\tset_index(repo, index);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_config",
          "args": [
            "repo",
            "NULL"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository_set_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
          "lines": "727-731",
          "snippet": "void git_repository_set_config(git_repository *repo, git_config *config)\n{\n\tassert(repo && config);\n\tset_config(repo, config);\n}",
          "includes": [
            "#include \"repo_template.h\"",
            "# include \"win32/w32_util.h\"",
            "#include \"annotated_commit.h\"",
            "#include \"diff_driver.h\"",
            "#include \"merge.h\"",
            "#include \"remote.h\"",
            "#include \"odb.h\"",
            "#include \"filter.h\"",
            "#include \"refs.h\"",
            "#include \"config.h\"",
            "#include \"index.h\"",
            "#include \"filebuf.h\"",
            "#include \"sysdir.h\"",
            "#include \"fileops.h\"",
            "#include \"blob.h\"",
            "#include \"tag.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include \"git2/sys/repository.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/object.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int check_repositoryformatversion(git_config *config);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nvoid git_repository_set_config(git_repository *repo, git_config *config)\n{\n\tassert(repo && config);\n\tset_config(repo, config);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_attr_cache_flush",
          "args": [
            "repo"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "git_attr_cache_flush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/attrcache.c",
          "lines": "411-420",
          "snippet": "void git_attr_cache_flush(git_repository *repo)\n{\n\tgit_attr_cache *cache;\n\n\t/* this could be done less expensively, but for now, we'll just free\n\t * the entire attrcache and let the next use reinitialize it...\n\t */\n\tif (repo && (cache = git__swap(repo->attrcache, NULL)) != NULL)\n\t\tattr_cache__free(cache);\n}",
          "includes": [
            "#include \"ignore.h\"",
            "#include \"sysdir.h\"",
            "#include \"config.h\"",
            "#include \"attr_file.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ignore.h\"\n#include \"sysdir.h\"\n#include \"config.h\"\n#include \"attr_file.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_attr_cache_flush(git_repository *repo)\n{\n\tgit_attr_cache *cache;\n\n\t/* this could be done less expensively, but for now, we'll just free\n\t * the entire attrcache and let the next use reinitialize it...\n\t */\n\tif (repo && (cache = git__swap(repo->attrcache, NULL)) != NULL)\n\t\tattr_cache__free(cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_cache_clear",
          "args": [
            "&repo->objects"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "git_cache_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/cache.c",
          "lines": "96-104",
          "snippet": "void git_cache_clear(git_cache *cache)\n{\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn;\n\n\tclear_cache(cache);\n\n\tgit_rwlock_wrunlock(&cache->lock);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"object.h\"",
            "#include \"odb.h\"",
            "#include \"cache.h\"",
            "#include \"util.h\"",
            "#include \"thread-utils.h\"",
            "#include \"commit.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"object.h\"\n#include \"odb.h\"\n#include \"cache.h\"\n#include \"util.h\"\n#include \"thread-utils.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n\nvoid git_cache_clear(git_cache *cache)\n{\n\tif (git_rwlock_wrlock(&cache->lock) < 0)\n\t\treturn;\n\n\tclear_cache(cache);\n\n\tgit_rwlock_wrunlock(&cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "repo"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nvoid git_repository__cleanup(git_repository *repo)\n{\n\tassert(repo);\n\n\tgit_cache_clear(&repo->objects);\n\tgit_attr_cache_flush(repo);\n\n\tset_config(repo, NULL);\n\tset_index(repo, NULL);\n\tset_odb(repo, NULL);\n\tset_refdb(repo, NULL);\n}"
  },
  {
    "function_name": "set_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "95-106",
    "snippet": "static void set_index(git_repository *repo, git_index *index)\n{\n\tif (index) {\n\t\tGIT_REFCOUNT_OWN(index, repo);\n\t\tGIT_REFCOUNT_INC(index);\n\t}\n\n\tif ((index = git__swap(repo->_index, index)) != NULL) {\n\t\tGIT_REFCOUNT_OWN(index, NULL);\n\t\tgit_index_free(index);\n\t}\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_index_free",
          "args": [
            "index"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "git_index_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/index.c",
          "lines": "477-483",
          "snippet": "void git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}",
          "includes": [
            "#include \"git2/sys/index.h\"",
            "#include \"git2/config.h\"",
            "#include \"git2/blob.h\"",
            "#include \"git2/oid.h\"",
            "#include \"git2/odb.h\"",
            "#include \"diff.h\"",
            "#include \"idxmap.h\"",
            "#include \"blob.h\"",
            "#include \"ignore.h\"",
            "#include \"pathspec.h\"",
            "#include \"iterator.h\"",
            "#include \"hash.h\"",
            "#include \"tree-cache.h\"",
            "#include \"tree.h\"",
            "#include \"index.h\"",
            "#include \"repository.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool is_index_extended(git_index *index);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/sys/index.h\"\n#include \"git2/config.h\"\n#include \"git2/blob.h\"\n#include \"git2/oid.h\"\n#include \"git2/odb.h\"\n#include \"diff.h\"\n#include \"idxmap.h\"\n#include \"blob.h\"\n#include \"ignore.h\"\n#include \"pathspec.h\"\n#include \"iterator.h\"\n#include \"hash.h\"\n#include \"tree-cache.h\"\n#include \"tree.h\"\n#include \"index.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nstatic bool is_index_extended(git_index *index);\n\nvoid git_index_free(git_index *index)\n{\n\tif (index == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(index, index_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "index",
            "NULL"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__swap",
          "args": [
            "repo->_index",
            "index"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "index"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "index",
            "repo"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic void set_index(git_repository *repo, git_index *index)\n{\n\tif (index) {\n\t\tGIT_REFCOUNT_OWN(index, repo);\n\t\tGIT_REFCOUNT_INC(index);\n\t}\n\n\tif ((index = git__swap(repo->_index, index)) != NULL) {\n\t\tGIT_REFCOUNT_OWN(index, NULL);\n\t\tgit_index_free(index);\n\t}\n}"
  },
  {
    "function_name": "set_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "80-93",
    "snippet": "static void set_config(git_repository *repo, git_config *config)\n{\n\tif (config) {\n\t\tGIT_REFCOUNT_OWN(config, repo);\n\t\tGIT_REFCOUNT_INC(config);\n\t}\n\n\tif ((config = git__swap(repo->_config, config)) != NULL) {\n\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\tgit_config_free(config);\n\t}\n\n\tgit_repository__cvar_cache_clear(repo);\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int check_repositoryformatversion(git_config *config);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_repository__cvar_cache_clear",
          "args": [
            "repo"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "git_repository__cvar_cache_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config_cache.c",
          "lines": "122-128",
          "snippet": "void git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}",
          "includes": [
            "#include \"filter.h\"",
            "#include \"vector.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"repository.h\"",
            "#include \"fileops.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filter.h\"\n#include \"vector.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"repository.h\"\n#include \"fileops.h\"\n#include \"common.h\"\n\nvoid git_repository__cvar_cache_clear(git_repository *repo)\n{\n\tint i;\n\n\tfor (i = 0; i < GIT_CVAR_CACHE_MAX; ++i)\n\t\trepo->cvar_cache[i] = GIT_CVAR_NOT_CACHED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "git_config_free",
          "args": [
            "config"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "git_config_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/config.c",
          "lines": "63-69",
          "snippet": "void git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}",
          "includes": [
            "#include <ctype.h>",
            "# include <windows.h>",
            "#include \"transaction.h\"",
            "#include \"config_file.h\"",
            "#include \"buf_text.h\"",
            "#include \"vector.h\"",
            "#include \"git2/sys/config.h\"",
            "#include \"git2/config.h\"",
            "#include \"config.h\"",
            "#include \"sysdir.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n# include <windows.h>\n#include \"transaction.h\"\n#include \"config_file.h\"\n#include \"buf_text.h\"\n#include \"vector.h\"\n#include \"git2/sys/config.h\"\n#include \"git2/config.h\"\n#include \"config.h\"\n#include \"sysdir.h\"\n#include \"common.h\"\n\nvoid git_config_free(git_config *cfg)\n{\n\tif (cfg == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(cfg, config_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "config",
            "NULL"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__swap",
          "args": [
            "repo->_config",
            "config"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "config"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "config",
            "repo"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic int check_repositoryformatversion(git_config *config);\n\nstatic void set_config(git_repository *repo, git_config *config)\n{\n\tif (config) {\n\t\tGIT_REFCOUNT_OWN(config, repo);\n\t\tGIT_REFCOUNT_INC(config);\n\t}\n\n\tif ((config = git__swap(repo->_config, config)) != NULL) {\n\t\tGIT_REFCOUNT_OWN(config, NULL);\n\t\tgit_config_free(config);\n\t}\n\n\tgit_repository__cvar_cache_clear(repo);\n}"
  },
  {
    "function_name": "set_refdb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "67-78",
    "snippet": "static void set_refdb(git_repository *repo, git_refdb *refdb)\n{\n\tif (refdb) {\n\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\t\tGIT_REFCOUNT_INC(refdb);\n\t}\n\n\tif ((refdb = git__swap(repo->_refdb, refdb)) != NULL) {\n\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\tgit_refdb_free(refdb);\n\t}\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_refdb_free",
          "args": [
            "refdb"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "git_refdb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/refdb.c",
          "lines": "93-99",
          "snippet": "void git_refdb_free(git_refdb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, git_refdb__free);\n}",
          "includes": [
            "#include \"reflog.h\"",
            "#include \"refs.h\"",
            "#include \"refdb.h\"",
            "#include \"hash.h\"",
            "#include \"git2/sys/refdb_backend.h\"",
            "#include \"git2/refdb.h\"",
            "#include \"git2/refs.h\"",
            "#include \"git2/object.h\"",
            "#include \"posix.h\"",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reflog.h\"\n#include \"refs.h\"\n#include \"refdb.h\"\n#include \"hash.h\"\n#include \"git2/sys/refdb_backend.h\"\n#include \"git2/refdb.h\"\n#include \"git2/refs.h\"\n#include \"git2/object.h\"\n#include \"posix.h\"\n#include \"common.h\"\n\nvoid git_refdb_free(git_refdb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, git_refdb__free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "refdb",
            "NULL"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__swap",
          "args": [
            "repo->_refdb",
            "refdb"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "refdb"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "refdb",
            "repo"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic void set_refdb(git_repository *repo, git_refdb *refdb)\n{\n\tif (refdb) {\n\t\tGIT_REFCOUNT_OWN(refdb, repo);\n\t\tGIT_REFCOUNT_INC(refdb);\n\t}\n\n\tif ((refdb = git__swap(repo->_refdb, refdb)) != NULL) {\n\t\tGIT_REFCOUNT_OWN(refdb, NULL);\n\t\tgit_refdb_free(refdb);\n\t}\n}"
  },
  {
    "function_name": "set_odb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/repository.c",
    "lines": "54-65",
    "snippet": "static void set_odb(git_repository *repo, git_odb *odb)\n{\n\tif (odb) {\n\t\tGIT_REFCOUNT_OWN(odb, repo);\n\t\tGIT_REFCOUNT_INC(odb);\n\t}\n\n\tif ((odb = git__swap(repo->_odb, odb)) != NULL) {\n\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\tgit_odb_free(odb);\n\t}\n}",
    "includes": [
      "#include \"repo_template.h\"",
      "# include \"win32/w32_util.h\"",
      "#include \"annotated_commit.h\"",
      "#include \"diff_driver.h\"",
      "#include \"merge.h\"",
      "#include \"remote.h\"",
      "#include \"odb.h\"",
      "#include \"filter.h\"",
      "#include \"refs.h\"",
      "#include \"config.h\"",
      "#include \"index.h\"",
      "#include \"filebuf.h\"",
      "#include \"sysdir.h\"",
      "#include \"fileops.h\"",
      "#include \"blob.h\"",
      "#include \"tag.h\"",
      "#include \"commit.h\"",
      "#include \"repository.h\"",
      "#include \"common.h\"",
      "#include \"git2/sys/repository.h\"",
      "#include \"git2/refdb.h\"",
      "#include \"git2/object.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "git_odb_free",
          "args": [
            "odb"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "git_odb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10130/repo/src/odb.c",
          "lines": "619-625",
          "snippet": "void git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}",
          "includes": [
            "#include \"git2/oid.h\"",
            "#include \"git2/odb_backend.h\"",
            "#include \"repository.h\"",
            "#include \"filter.h\"",
            "#include \"delta-apply.h\"",
            "#include \"odb.h\"",
            "#include \"hash.h\"",
            "#include \"fileops.h\"",
            "#include \"git2/sys/odb_backend.h\"",
            "#include \"git2/object.h\"",
            "#include <zlib.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"git2/oid.h\"\n#include \"git2/odb_backend.h\"\n#include \"repository.h\"\n#include \"filter.h\"\n#include \"delta-apply.h\"\n#include \"odb.h\"\n#include \"hash.h\"\n#include \"fileops.h\"\n#include \"git2/sys/odb_backend.h\"\n#include \"git2/object.h\"\n#include <zlib.h>\n#include \"common.h\"\n\nvoid git_odb_free(git_odb *db)\n{\n\tif (db == NULL)\n\t\treturn;\n\n\tGIT_REFCOUNT_DEC(db, odb_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "odb",
            "NULL"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "git__swap",
          "args": [
            "repo->_odb",
            "odb"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_INC",
          "args": [
            "odb"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIT_REFCOUNT_OWN",
          "args": [
            "odb",
            "repo"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"repo_template.h\"\n# include \"win32/w32_util.h\"\n#include \"annotated_commit.h\"\n#include \"diff_driver.h\"\n#include \"merge.h\"\n#include \"remote.h\"\n#include \"odb.h\"\n#include \"filter.h\"\n#include \"refs.h\"\n#include \"config.h\"\n#include \"index.h\"\n#include \"filebuf.h\"\n#include \"sysdir.h\"\n#include \"fileops.h\"\n#include \"blob.h\"\n#include \"tag.h\"\n#include \"commit.h\"\n#include \"repository.h\"\n#include \"common.h\"\n#include \"git2/sys/repository.h\"\n#include \"git2/refdb.h\"\n#include \"git2/object.h\"\n#include <ctype.h>\n\nstatic void set_odb(git_repository *repo, git_odb *odb)\n{\n\tif (odb) {\n\t\tGIT_REFCOUNT_OWN(odb, repo);\n\t\tGIT_REFCOUNT_INC(odb);\n\t}\n\n\tif ((odb = git__swap(repo->_odb, odb)) != NULL) {\n\t\tGIT_REFCOUNT_OWN(odb, NULL);\n\t\tgit_odb_free(odb);\n\t}\n}"
  }
]