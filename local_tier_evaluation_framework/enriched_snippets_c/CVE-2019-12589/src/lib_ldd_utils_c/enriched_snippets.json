[
  {
    "function_name": "is_lib_64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/lib/ldd_utils.c",
    "lines": "41-62",
    "snippet": "int is_lib_64(const char *exe) {\n\tint retval = 0;\n\tint fd = open(exe, O_RDONLY);\n\tif (fd < 0)\n\t\treturn 0;\n\n\tunsigned char buf[EI_NIDENT];\n\tssize_t len = 0;\n\twhile (len < EI_NIDENT) {\n\t\tssize_t sz = read(fd, buf, EI_NIDENT);\n\t\tif (sz <= 0)\n\t\t\tgoto doexit;\n\t\tlen += sz;\n\t}\n\n\tif (buf[EI_CLASS] == ELFCLASS64)\n\t\tretval = 1;\n\ndoexit:\n\tclose(fd);\n\treturn retval;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"../include/ldd_utils.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "rtnl_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/lib/libnetlink.c",
          "lines": "46-52",
          "snippet": "void rtnl_close(struct rtnl_handle *rth)\n{\n\tif (rth->fd >= 0) {\n\t\tclose(rth->fd);\n\t\trth->fd = -1;\n\t}\n}",
          "includes": [
            "#include \"../include/libnetlink.h\"",
            "#include <sys/uio.h>",
            "#include <time.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <net/if_arp.h>",
            "#include <fcntl.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../include/libnetlink.h\"\n#include <sys/uio.h>\n#include <time.h>\n#include <errno.h>\n#include <string.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <net/if_arp.h>\n#include <fcntl.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid rtnl_close(struct rtnl_handle *rth)\n{\n\tif (rth->fd >= 0) {\n\t\tclose(rth->fd);\n\t\trth->fd = -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "buf",
            "EI_NIDENT"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "exe",
            "O_RDONLY"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "rtnl_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/lib/libnetlink.c",
          "lines": "103-106",
          "snippet": "int rtnl_open(struct rtnl_handle *rth, unsigned subscriptions)\n{\n\treturn rtnl_open_byproto(rth, subscriptions, NETLINK_ROUTE);\n}",
          "includes": [
            "#include \"../include/libnetlink.h\"",
            "#include <sys/uio.h>",
            "#include <time.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <net/if_arp.h>",
            "#include <fcntl.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../include/libnetlink.h\"\n#include <sys/uio.h>\n#include <time.h>\n#include <errno.h>\n#include <string.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <net/if_arp.h>\n#include <fcntl.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint rtnl_open(struct rtnl_handle *rth, unsigned subscriptions)\n{\n\treturn rtnl_open_byproto(rth, subscriptions, NETLINK_ROUTE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"../include/ldd_utils.h\"\n\nint is_lib_64(const char *exe) {\n\tint retval = 0;\n\tint fd = open(exe, O_RDONLY);\n\tif (fd < 0)\n\t\treturn 0;\n\n\tunsigned char buf[EI_NIDENT];\n\tssize_t len = 0;\n\twhile (len < EI_NIDENT) {\n\t\tssize_t sz = read(fd, buf, EI_NIDENT);\n\t\tif (sz <= 0)\n\t\t\tgoto doexit;\n\t\tlen += sz;\n\t}\n\n\tif (buf[EI_CLASS] == ELFCLASS64)\n\t\tretval = 1;\n\ndoexit:\n\tclose(fd);\n\treturn retval;\n}"
  }
]