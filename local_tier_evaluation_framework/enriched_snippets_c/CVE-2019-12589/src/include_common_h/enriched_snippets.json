[
  {
    "function_name": "getticks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/include/common.h",
    "lines": "113-125",
    "snippet": "static inline unsigned long long getticks(void) {\n#if defined(__x86_64__)\n\tunsigned a, d;\n\tasm volatile(\"rdtsc\" : \"=a\" (a), \"=d\" (d));\n\treturn ((unsigned long long)a) | (((unsigned long long)d) << 32);\n#elif defined(__i386__)\n\tunsigned long long ret;\n\t__asm__ __volatile__(\"rdtsc\" : \"=A\" (ret));\n\treturn ret;\n#else\n\treturn 0; // not implemented\n#endif\n}",
    "includes": [
      "#include <assert.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stddef.h>",
      "#include <stdint.h>",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <assert.h>\n#include <ctype.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <stdio.h>\n\nstatic inline unsigned long long getticks(void) {\n#if defined(__x86_64__)\n\tunsigned a, d;\n\tasm volatile(\"rdtsc\" : \"=a\" (a), \"=d\" (d));\n\treturn ((unsigned long long)a) | (((unsigned long long)d) << 32);\n#elif defined(__i386__)\n\tunsigned long long ret;\n\t__asm__ __volatile__(\"rdtsc\" : \"=A\" (ret));\n\treturn ret;\n#else\n\treturn 0; // not implemented\n#endif\n}"
  },
  {
    "function_name": "mac_not_zero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/include/common.h",
    "lines": "102-110",
    "snippet": "static inline int mac_not_zero(const unsigned char mac[6]) {\n\tint i;\n\tfor (i = 0; i < 6; i++) {\n\t\tif (mac[i] != 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stddef.h>",
      "#include <stdint.h>",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <assert.h>\n#include <ctype.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <stdio.h>\n\nstatic inline int mac_not_zero(const unsigned char mac[6]) {\n\tint i;\n\tfor (i = 0; i < 6; i++) {\n\t\tif (mac[i] != 0)\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "atomac",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/include/common.h",
    "lines": "84-99",
    "snippet": "static inline int atomac(char *str, unsigned char macAddr[6]) {\n\tunsigned mac[6];\n\n\tif (sscanf(str, \"%2x:%2x:%2x:%2x:%2x:%2x\", &mac[0], &mac[1], &mac[2], &mac[3], &mac[4], &mac[5]) != 6)\n\t\treturn 1;\n\n\tint i;\n\tfor (i = 0; i < 6; i++) {\n\t\tif (mac[i] > 0xff)\n\t\t\treturn 1;\n\n\t\tmacAddr[i] = (unsigned char) mac[i];\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stddef.h>",
      "#include <stdint.h>",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str",
            "\"%2x:%2x:%2x:%2x:%2x:%2x\"",
            "&mac[0]",
            "&mac[1]",
            "&mac[2]",
            "&mac[3]",
            "&mac[4]",
            "&mac[5]"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <ctype.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <stdio.h>\n\nstatic inline int atomac(char *str, unsigned char macAddr[6]) {\n\tunsigned mac[6];\n\n\tif (sscanf(str, \"%2x:%2x:%2x:%2x:%2x:%2x\", &mac[0], &mac[1], &mac[2], &mac[3], &mac[4], &mac[5]) != 6)\n\t\treturn 1;\n\n\tint i;\n\tfor (i = 0; i < 6; i++) {\n\t\tif (mac[i] > 0xff)\n\t\t\treturn 1;\n\n\t\tmacAddr[i] = (unsigned char) mac[i];\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "in_netrange",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/include/common.h",
    "lines": "73-81",
    "snippet": "static inline char *in_netrange(uint32_t ip, uint32_t ifip, uint32_t ifmask) {\n\tif ((ip & ifmask) != (ifip & ifmask))\n\t\treturn \"Error: the IP address is not in the interface range\\n\";\n\telse if ((ip & ifmask) == ip)\n\t\treturn \"Error: the IP address is a network address\\n\";\n\telse if ((ip | ~ifmask) == ip)\n\t\treturn \"Error: the IP address is a network address\\n\";\n\treturn NULL;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stddef.h>",
      "#include <stdint.h>",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <assert.h>\n#include <ctype.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <stdio.h>\n\nstatic inline char *in_netrange(uint32_t ip, uint32_t ifip, uint32_t ifmask) {\n\tif ((ip & ifmask) != (ifip & ifmask))\n\t\treturn \"Error: the IP address is not in the interface range\\n\";\n\telse if ((ip & ifmask) == ip)\n\t\treturn \"Error: the IP address is a network address\\n\";\n\telse if ((ip | ~ifmask) == ip)\n\t\treturn \"Error: the IP address is a network address\\n\";\n\treturn NULL;\n}"
  },
  {
    "function_name": "atoip",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/include/common.h",
    "lines": "62-70",
    "snippet": "static inline int atoip(const char *str, uint32_t *ip) {\n\tunsigned a, b, c, d;\n\n\tif (sscanf(str, \"%u.%u.%u.%u\", &a, &b, &c, &d) != 4 || a > 255 || b > 255 || c > 255 || d > 255)\n\t\treturn 1;\n\n\t*ip = a * 0x1000000 + b * 0x10000 + c * 0x100 + d;\n\treturn 0;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stddef.h>",
      "#include <stdint.h>",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str",
            "\"%u.%u.%u.%u\"",
            "&a",
            "&b",
            "&c",
            "&d"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <ctype.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <stdio.h>\n\nstatic inline int atoip(const char *str, uint32_t *ip) {\n\tunsigned a, b, c, d;\n\n\tif (sscanf(str, \"%u.%u.%u.%u\", &a, &b, &c, &d) != 4 || a > 255 || b > 255 || c > 255 || d > 255)\n\t\treturn 1;\n\n\t*ip = a * 0x1000000 + b * 0x10000 + c * 0x100 + d;\n\treturn 0;\n}"
  },
  {
    "function_name": "mask2bits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/include/common.h",
    "lines": "47-59",
    "snippet": "static inline uint8_t mask2bits(uint32_t mask) {\n\tuint32_t tmp = 0x80000000;\n\tint i;\n\tuint8_t rv = 0;\n\n\tfor (i = 0; i < 32; i++, tmp >>= 1) {\n\t\tif (tmp & mask)\n\t\t\trv++;\n\t\telse\n\t\t\tbreak;\n\t}\n\treturn rv;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stddef.h>",
      "#include <stdint.h>",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <assert.h>\n#include <ctype.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <stdio.h>\n\nstatic inline uint8_t mask2bits(uint32_t mask) {\n\tuint32_t tmp = 0x80000000;\n\tint i;\n\tuint8_t rv = 0;\n\n\tfor (i = 0; i < 32; i++, tmp >>= 1) {\n\t\tif (tmp & mask)\n\t\t\trv++;\n\t\telse\n\t\t\tbreak;\n\t}\n\treturn rv;\n}"
  }
]