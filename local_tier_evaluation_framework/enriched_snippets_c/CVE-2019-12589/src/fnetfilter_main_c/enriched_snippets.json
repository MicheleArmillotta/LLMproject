[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
    "lines": "159-210",
    "snippet": "int main(int argc, char **argv) {\n#if 0\n{\nsystem(\"cat /proc/self/status\");\nint i;\nfor (i = 0; i < argc; i++)\n\tprintf(\"*%s* \", argv[i]);\nprintf(\"\\n\");\n}\n#endif\n\n\tchar *quiet = getenv(\"FIREJAIL_QUIET\");\n\tif (quiet && strcmp(quiet, \"yes\") == 0)\n\t\targ_quiet = 1;\n\n\tif (argc > 1 && (strcmp(argv[1], \"-h\") == 0 || strcmp(argv[1], \"--help\") == 0 || strcmp(argv[1], \"-?\") ==0)) {\n\t\tusage();\n\t\treturn 0;\n\t}\n\n\tif (argc != 2 && argc != 3) {\n\t\tusage();\n\t\treturn 1;\n\t}\n\n\tchar *destfile = (argc == 3)? argv[2]: argv[1];\n\tchar *command = (argc == 3)? argv[1]: NULL;\n//printf(\"command %s\\n\", command);\n//printf(\"destfile %s\\n\", destfile);\n\t// destfile is a real filename\n\tint len = strlen(destfile);\n\tif (strcspn(destfile, \"\\\\&!?\\\"'<>%^(){};,*[]\") != (size_t)len)\n\t\terr_exit_cannot_open_file(destfile);\n\n\t// handle default config (command = NULL, destfile)\n\tif (command == NULL) {\n\t\t// create a default filter file\n\t\tFILE *fp = fopen(destfile, \"w\");\n\t\tif (!fp)\n\t\t\terr_exit_cannot_open_file(destfile);\n\t\tfprintf(fp, \"%s\\n\", default_filter);\n\t\tfclose(fp);\n\t}\n\telse {\n\t\tif (strrchr(command, ','))\n\t\t\tprocess_template(command, destfile);\n\t\telse\n\t\t\tcopy(command, destfile);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"../include/common.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int arg_quiet = 0;",
      "static char *default_filter =\n\"*filter\\n\"\n\":INPUT DROP [0:0]\\n\"\n\":FORWARD DROP [0:0]\\n\"\n\":OUTPUT ACCEPT [0:0]\\n\"\n\"-A INPUT -i lo -j ACCEPT\\n\"\n\"-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\\n\"\n\"# echo replay is handled by -m state RELATED/ESTABLISHED above\\n\"\n\"#-A INPUT -p icmp --icmp-type echo-reply -j ACCEPT\\n\"\n\"-A INPUT -p icmp --icmp-type destination-unreachable -j ACCEPT\\n\"\n\"-A INPUT -p icmp --icmp-type time-exceeded -j ACCEPT\\n\"\n\"-A INPUT -p icmp --icmp-type echo-request -j ACCEPT \\n\"\n\"# disable STUN\\n\"\n\"-A OUTPUT -p udp --dport 3478 -j DROP\\n\"\n\"-A OUTPUT -p udp --dport 3479 -j DROP\\n\"\n\"-A OUTPUT -p tcp --dport 3478 -j DROP\\n\"\n\"-A OUTPUT -p tcp --dport 3479 -j DROP\\n\"\n\"COMMIT\\n\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy",
          "args": [
            "command",
            "destfile"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "copy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
          "lines": "59-74",
          "snippet": "static void copy(const char *src, const char *dest) {\n\tFILE *fp1 = fopen(src, \"r\");\n\tif (!fp1)\n\t\terr_exit_cannot_open_file(src);\n\n\tFILE *fp2 = fopen(dest, \"w\");\n\tif (!fp2)\n\t\terr_exit_cannot_open_file(dest);\n\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp1))\n\t\tfprintf(fp2, \"%s\", buf);\n\n\tfclose(fp1);\n\tfclose(fp2);\n}",
          "includes": [
            "#include \"../include/common.h\""
          ],
          "macros_used": [
            "#define MAXBUF 4098"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../include/common.h\"\n\n#define MAXBUF 4098\n\nstatic void copy(const char *src, const char *dest) {\n\tFILE *fp1 = fopen(src, \"r\");\n\tif (!fp1)\n\t\terr_exit_cannot_open_file(src);\n\n\tFILE *fp2 = fopen(dest, \"w\");\n\tif (!fp2)\n\t\terr_exit_cannot_open_file(dest);\n\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp1))\n\t\tfprintf(fp2, \"%s\", buf);\n\n\tfclose(fp1);\n\tfclose(fp2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "process_template",
          "args": [
            "command",
            "destfile"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "process_template",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
          "lines": "76-157",
          "snippet": "static void process_template(char *src, const char *dest) {\n\tchar *arg_start = strchr(src, ',');\n\tassert(arg_start);\n\t*arg_start = '\\0';\n\targ_start++;\n\tif (*arg_start == '\\0') {\n\t\tfprintf(stderr, \"Error fnetfilter: you need to provide at least one argument\\n\");\n\t\texit(1);\n\t}\n\n\t// extract the arguments from command line\n\tchar *token = strtok(arg_start, \",\");\n\twhile (token) {\n\t\tif (argcnt == MAXARGS) {\n\t\t\tfprintf(stderr, \"Error fnetfilter: only up to %u arguments are supported\\n\", (unsigned) MAXARGS);\n\t\t\texit(1);\n\t\t}\n\t\t// look for abnormal things\n\t\tint len = strlen(token);\n\t\tif (strcspn(token, \"\\\\&!?\\\"'<>%^(){};,*[]\") != (size_t)len) {\n\t\t\tfprintf(stderr, \"Error fnetfilter: invalid argument in netfilter command\\n\");\n\t\t\texit(1);\n\t\t}\n\t\targs[argcnt] = token;\n\t\targcnt++;\n\t\ttoken = strtok(NULL, \",\");\n\t}\n#if 0\n{\nprintf(\"argcnt %d\\n\", argcnt);\nint i;\nfor (i = 0; i < argcnt; i++)\n\tprintf(\"%s\\n\", args[i]);\n}\n#endif\n\n\t// open the files\n\tFILE *fp1 = fopen(src, \"r\");\n\tif (!fp1)\n\t\terr_exit_cannot_open_file(src);\n\n\tFILE *fp2 = fopen(dest, \"w\");\n\tif (!fp2)\n\t\terr_exit_cannot_open_file(dest);\n\n\tint line = 0;\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp1)) {\n\t\tline++;\n\t\tchar *ptr = buf;\n\t\twhile (*ptr != '\\0') {\n\t\t\tif (*ptr != '$')\n\t\t\t\tfputc(*ptr, fp2);\n\t\t\telse {\n\t\t\t\t// parsing\n\t\t\t\tint index = 0;\n\t\t\t\tint rv = sscanf(ptr, \"$ARG%d\", &index) ;\n\t\t\t\tif (rv != 1) {\n\t\t\t\t\tfprintf(stderr, \"Error fnetfilter: invalid template argument on line %d\\n\", line);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\n\t\t\t\t// print argument\n\t\t\t\tif (index < 1 || index > argcnt) {\n\t\t\t\t\tfprintf(stderr, \"Error fnetfilter: $ARG%d on line %d was not defined\\n\", index, line);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\t\t\t\tfprintf(fp2, \"%s\", args[index - 1]);\n\n\t\t\t\t// march to the end of argument\n\t\t\t\tptr += 4;\n\t\t\t\twhile (isdigit(*ptr))\n\t\t\t\t\tptr++;\n\t\t\t\tptr--;\n\t\t\t}\n\t\t\tptr++;\n\t\t}\n\t}\n\n\tfclose(fp1);\n\tfclose(fp2);\n}",
          "includes": [
            "#include \"../include/common.h\""
          ],
          "macros_used": [
            "#define MAXARGS 16",
            "#define MAXBUF 4098"
          ],
          "globals_used": [
            "static char *args[MAXARGS] = {0};",
            "static int argcnt = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../include/common.h\"\n\n#define MAXARGS 16\n#define MAXBUF 4098\n\nstatic char *args[MAXARGS] = {0};\nstatic int argcnt = 0;\n\nstatic void process_template(char *src, const char *dest) {\n\tchar *arg_start = strchr(src, ',');\n\tassert(arg_start);\n\t*arg_start = '\\0';\n\targ_start++;\n\tif (*arg_start == '\\0') {\n\t\tfprintf(stderr, \"Error fnetfilter: you need to provide at least one argument\\n\");\n\t\texit(1);\n\t}\n\n\t// extract the arguments from command line\n\tchar *token = strtok(arg_start, \",\");\n\twhile (token) {\n\t\tif (argcnt == MAXARGS) {\n\t\t\tfprintf(stderr, \"Error fnetfilter: only up to %u arguments are supported\\n\", (unsigned) MAXARGS);\n\t\t\texit(1);\n\t\t}\n\t\t// look for abnormal things\n\t\tint len = strlen(token);\n\t\tif (strcspn(token, \"\\\\&!?\\\"'<>%^(){};,*[]\") != (size_t)len) {\n\t\t\tfprintf(stderr, \"Error fnetfilter: invalid argument in netfilter command\\n\");\n\t\t\texit(1);\n\t\t}\n\t\targs[argcnt] = token;\n\t\targcnt++;\n\t\ttoken = strtok(NULL, \",\");\n\t}\n#if 0\n{\nprintf(\"argcnt %d\\n\", argcnt);\nint i;\nfor (i = 0; i < argcnt; i++)\n\tprintf(\"%s\\n\", args[i]);\n}\n#endif\n\n\t// open the files\n\tFILE *fp1 = fopen(src, \"r\");\n\tif (!fp1)\n\t\terr_exit_cannot_open_file(src);\n\n\tFILE *fp2 = fopen(dest, \"w\");\n\tif (!fp2)\n\t\terr_exit_cannot_open_file(dest);\n\n\tint line = 0;\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp1)) {\n\t\tline++;\n\t\tchar *ptr = buf;\n\t\twhile (*ptr != '\\0') {\n\t\t\tif (*ptr != '$')\n\t\t\t\tfputc(*ptr, fp2);\n\t\t\telse {\n\t\t\t\t// parsing\n\t\t\t\tint index = 0;\n\t\t\t\tint rv = sscanf(ptr, \"$ARG%d\", &index) ;\n\t\t\t\tif (rv != 1) {\n\t\t\t\t\tfprintf(stderr, \"Error fnetfilter: invalid template argument on line %d\\n\", line);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\n\t\t\t\t// print argument\n\t\t\t\tif (index < 1 || index > argcnt) {\n\t\t\t\t\tfprintf(stderr, \"Error fnetfilter: $ARG%d on line %d was not defined\\n\", index, line);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\t\t\t\tfprintf(fp2, \"%s\", args[index - 1]);\n\n\t\t\t\t// march to the end of argument\n\t\t\t\tptr += 4;\n\t\t\t\twhile (isdigit(*ptr))\n\t\t\t\t\tptr++;\n\t\t\t\tptr--;\n\t\t\t}\n\t\t\tptr++;\n\t\t}\n\t}\n\n\tfclose(fp1);\n\tfclose(fp2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "command",
            "','"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"%s\\n\"",
            "default_filter"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "err_exit_cannot_open_file",
          "args": [
            "destfile"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "err_exit_cannot_open_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
          "lines": "53-56",
          "snippet": "static void err_exit_cannot_open_file(const char *fname) {\n\tfprintf(stderr, \"Error fnetfilter: cannot open %s\\n\", fname);\n\texit(1);\n}",
          "includes": [
            "#include \"../include/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../include/common.h\"\n\nstatic void err_exit_cannot_open_file(const char *fname) {\n\tfprintf(stderr, \"Error fnetfilter: cannot open %s\\n\", fname);\n\texit(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "destfile",
            "\"w\""
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "fopen64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/libtrace/libtrace.c",
          "lines": "320-327",
          "snippet": "FILE *fopen64(const char *pathname, const char *mode) {\n\tif (!orig_fopen64)\n\t\torig_fopen64 = (orig_fopen_t)dlsym(RTLD_NEXT, \"fopen64\");\n\n\tFILE *rv = orig_fopen64(pathname, mode);\n\tprintf(\"%u:%s:fopen64 %s:%p\\n\", pid(), name(), pathname, rv);\n\treturn rv;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <syslog.h>",
            "#include <sys/stat.h>",
            "#include <sys/un.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include <dlfcn.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static orig_fopen64_t orig_fopen64 = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <dirent.h>\n#include <syslog.h>\n#include <sys/stat.h>\n#include <sys/un.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <unistd.h>\n#include <limits.h>\n#include <sys/types.h>\n#include <dlfcn.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic orig_fopen64_t orig_fopen64 = NULL;\n\nFILE *fopen64(const char *pathname, const char *mode) {\n\tif (!orig_fopen64)\n\t\torig_fopen64 = (orig_fopen_t)dlsym(RTLD_NEXT, \"fopen64\");\n\n\tFILE *rv = orig_fopen64(pathname, mode);\n\tprintf(\"%u:%s:fopen64 %s:%p\\n\", pid(), name(), pathname, rv);\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcspn",
          "args": [
            "destfile",
            "\"\\\\&!?\\\"'<>%^(){};,*[]\""
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "destfile"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "= strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
          "lines": "83-91",
          "snippet": "len = strlen(name);\n\tif (len <= 4)\n\t\treturn 0;\n\tif (*name == '$' && name[1] == '{' && name[len - 1] == '}')\n\t\treturn 1;\n\treturn 0;\n}\n\n// returns mallocated memory\nstatic char *resolve_x",
          "includes": [
            "#include <sys/stat.h>",
            "#include \"firejail.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/stat.h>\n#include \"firejail.h\"\n\nlen = strlen(name);\n\tif (len <= 4)\n\t\treturn 0;\n\tif (*name == '$' && name[1] == '{' && name[len - 1] == '}')\n\t\treturn 1;\n\treturn 0;\n}\n\n// returns mallocated memory\nstatic char *resolve_x"
        }
      },
      {
        "call_info": {
          "callee": "usage",
          "args": [],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "usage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
          "lines": "48-51",
          "snippet": "static void usage(void) {\n\tprintf(\"Usage:\\n\");\n\tprintf(\"\\tfnetfilter netfilter-command destination-file\\n\");\n}",
          "includes": [
            "#include \"../include/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../include/common.h\"\n\nstatic void usage(void) {\n\tprintf(\"Usage:\\n\");\n\tprintf(\"\\tfnetfilter netfilter-command destination-file\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[1]",
            "\"-?\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[1]",
            "\"--help\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[1]",
            "\"-h\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "quiet",
            "\"yes\""
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"FIREJAIL_QUIET\""
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"*%s* \"",
            "argv[i]"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "system",
          "args": [
            "\"cat /proc/self/status\""
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "system",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/libtrace/libtrace.c",
          "lines": "574-582",
          "snippet": "int system(const char *command) {\n\tif (!orig_system)\n\t\torig_system = (orig_system_t)dlsym(RTLD_NEXT, \"system\");\n\n\tint rv = orig_system(command);\n\tprintf(\"%u:%s:system %s:%d\\n\", pid(), name(), command, rv);\n\n\treturn rv;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <syslog.h>",
            "#include <sys/stat.h>",
            "#include <sys/un.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include <dlfcn.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static orig_system_t orig_system = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <dirent.h>\n#include <syslog.h>\n#include <sys/stat.h>\n#include <sys/un.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <unistd.h>\n#include <limits.h>\n#include <sys/types.h>\n#include <dlfcn.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic orig_system_t orig_system = NULL;\n\nint system(const char *command) {\n\tif (!orig_system)\n\t\torig_system = (orig_system_t)dlsym(RTLD_NEXT, \"system\");\n\n\tint rv = orig_system(command);\n\tprintf(\"%u:%s:system %s:%d\\n\", pid(), name(), command, rv);\n\n\treturn rv;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../include/common.h\"\n\nint arg_quiet = 0;\nstatic char *default_filter =\n\"*filter\\n\"\n\":INPUT DROP [0:0]\\n\"\n\":FORWARD DROP [0:0]\\n\"\n\":OUTPUT ACCEPT [0:0]\\n\"\n\"-A INPUT -i lo -j ACCEPT\\n\"\n\"-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\\n\"\n\"# echo replay is handled by -m state RELATED/ESTABLISHED above\\n\"\n\"#-A INPUT -p icmp --icmp-type echo-reply -j ACCEPT\\n\"\n\"-A INPUT -p icmp --icmp-type destination-unreachable -j ACCEPT\\n\"\n\"-A INPUT -p icmp --icmp-type time-exceeded -j ACCEPT\\n\"\n\"-A INPUT -p icmp --icmp-type echo-request -j ACCEPT \\n\"\n\"# disable STUN\\n\"\n\"-A OUTPUT -p udp --dport 3478 -j DROP\\n\"\n\"-A OUTPUT -p udp --dport 3479 -j DROP\\n\"\n\"-A OUTPUT -p tcp --dport 3478 -j DROP\\n\"\n\"-A OUTPUT -p tcp --dport 3479 -j DROP\\n\"\n\"COMMIT\\n\";\n\nint main(int argc, char **argv) {\n#if 0\n{\nsystem(\"cat /proc/self/status\");\nint i;\nfor (i = 0; i < argc; i++)\n\tprintf(\"*%s* \", argv[i]);\nprintf(\"\\n\");\n}\n#endif\n\n\tchar *quiet = getenv(\"FIREJAIL_QUIET\");\n\tif (quiet && strcmp(quiet, \"yes\") == 0)\n\t\targ_quiet = 1;\n\n\tif (argc > 1 && (strcmp(argv[1], \"-h\") == 0 || strcmp(argv[1], \"--help\") == 0 || strcmp(argv[1], \"-?\") ==0)) {\n\t\tusage();\n\t\treturn 0;\n\t}\n\n\tif (argc != 2 && argc != 3) {\n\t\tusage();\n\t\treturn 1;\n\t}\n\n\tchar *destfile = (argc == 3)? argv[2]: argv[1];\n\tchar *command = (argc == 3)? argv[1]: NULL;\n//printf(\"command %s\\n\", command);\n//printf(\"destfile %s\\n\", destfile);\n\t// destfile is a real filename\n\tint len = strlen(destfile);\n\tif (strcspn(destfile, \"\\\\&!?\\\"'<>%^(){};,*[]\") != (size_t)len)\n\t\terr_exit_cannot_open_file(destfile);\n\n\t// handle default config (command = NULL, destfile)\n\tif (command == NULL) {\n\t\t// create a default filter file\n\t\tFILE *fp = fopen(destfile, \"w\");\n\t\tif (!fp)\n\t\t\terr_exit_cannot_open_file(destfile);\n\t\tfprintf(fp, \"%s\\n\", default_filter);\n\t\tfclose(fp);\n\t}\n\telse {\n\t\tif (strrchr(command, ','))\n\t\t\tprocess_template(command, destfile);\n\t\telse\n\t\t\tcopy(command, destfile);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "process_template",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
    "lines": "76-157",
    "snippet": "static void process_template(char *src, const char *dest) {\n\tchar *arg_start = strchr(src, ',');\n\tassert(arg_start);\n\t*arg_start = '\\0';\n\targ_start++;\n\tif (*arg_start == '\\0') {\n\t\tfprintf(stderr, \"Error fnetfilter: you need to provide at least one argument\\n\");\n\t\texit(1);\n\t}\n\n\t// extract the arguments from command line\n\tchar *token = strtok(arg_start, \",\");\n\twhile (token) {\n\t\tif (argcnt == MAXARGS) {\n\t\t\tfprintf(stderr, \"Error fnetfilter: only up to %u arguments are supported\\n\", (unsigned) MAXARGS);\n\t\t\texit(1);\n\t\t}\n\t\t// look for abnormal things\n\t\tint len = strlen(token);\n\t\tif (strcspn(token, \"\\\\&!?\\\"'<>%^(){};,*[]\") != (size_t)len) {\n\t\t\tfprintf(stderr, \"Error fnetfilter: invalid argument in netfilter command\\n\");\n\t\t\texit(1);\n\t\t}\n\t\targs[argcnt] = token;\n\t\targcnt++;\n\t\ttoken = strtok(NULL, \",\");\n\t}\n#if 0\n{\nprintf(\"argcnt %d\\n\", argcnt);\nint i;\nfor (i = 0; i < argcnt; i++)\n\tprintf(\"%s\\n\", args[i]);\n}\n#endif\n\n\t// open the files\n\tFILE *fp1 = fopen(src, \"r\");\n\tif (!fp1)\n\t\terr_exit_cannot_open_file(src);\n\n\tFILE *fp2 = fopen(dest, \"w\");\n\tif (!fp2)\n\t\terr_exit_cannot_open_file(dest);\n\n\tint line = 0;\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp1)) {\n\t\tline++;\n\t\tchar *ptr = buf;\n\t\twhile (*ptr != '\\0') {\n\t\t\tif (*ptr != '$')\n\t\t\t\tfputc(*ptr, fp2);\n\t\t\telse {\n\t\t\t\t// parsing\n\t\t\t\tint index = 0;\n\t\t\t\tint rv = sscanf(ptr, \"$ARG%d\", &index) ;\n\t\t\t\tif (rv != 1) {\n\t\t\t\t\tfprintf(stderr, \"Error fnetfilter: invalid template argument on line %d\\n\", line);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\n\t\t\t\t// print argument\n\t\t\t\tif (index < 1 || index > argcnt) {\n\t\t\t\t\tfprintf(stderr, \"Error fnetfilter: $ARG%d on line %d was not defined\\n\", index, line);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\t\t\t\tfprintf(fp2, \"%s\", args[index - 1]);\n\n\t\t\t\t// march to the end of argument\n\t\t\t\tptr += 4;\n\t\t\t\twhile (isdigit(*ptr))\n\t\t\t\t\tptr++;\n\t\t\t\tptr--;\n\t\t\t}\n\t\t\tptr++;\n\t\t}\n\t}\n\n\tfclose(fp1);\n\tfclose(fp2);\n}",
    "includes": [
      "#include \"../include/common.h\""
    ],
    "macros_used": [
      "#define MAXARGS 16",
      "#define MAXBUF 4098"
    ],
    "globals_used": [
      "static char *args[MAXARGS] = {0};",
      "static int argcnt = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp2"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp1"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*ptr"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp2",
            "\"%s\"",
            "args[index - 1]"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "err_exit_cannot_open_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
          "lines": "53-56",
          "snippet": "static void err_exit_cannot_open_file(const char *fname) {\n\tfprintf(stderr, \"Error fnetfilter: cannot open %s\\n\", fname);\n\texit(1);\n}",
          "includes": [
            "#include \"../include/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../include/common.h\"\n\nstatic void err_exit_cannot_open_file(const char *fname) {\n\tfprintf(stderr, \"Error fnetfilter: cannot open %s\\n\", fname);\n\texit(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Error fnetfilter: $ARG%d on line %d was not defined\\n\"",
            "index",
            "line"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Error fnetfilter: invalid template argument on line %d\\n\"",
            "line"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "ptr",
            "\"$ARG%d\"",
            "&index"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputc",
          "args": [
            "*ptr",
            "fp2"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "buf",
            "MAXBUF",
            "fp1"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "dest",
            "\"w\""
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "fopen64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/libtrace/libtrace.c",
          "lines": "320-327",
          "snippet": "FILE *fopen64(const char *pathname, const char *mode) {\n\tif (!orig_fopen64)\n\t\torig_fopen64 = (orig_fopen_t)dlsym(RTLD_NEXT, \"fopen64\");\n\n\tFILE *rv = orig_fopen64(pathname, mode);\n\tprintf(\"%u:%s:fopen64 %s:%p\\n\", pid(), name(), pathname, rv);\n\treturn rv;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <syslog.h>",
            "#include <sys/stat.h>",
            "#include <sys/un.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include <dlfcn.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static orig_fopen64_t orig_fopen64 = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <dirent.h>\n#include <syslog.h>\n#include <sys/stat.h>\n#include <sys/un.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <unistd.h>\n#include <limits.h>\n#include <sys/types.h>\n#include <dlfcn.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic orig_fopen64_t orig_fopen64 = NULL;\n\nFILE *fopen64(const char *pathname, const char *mode) {\n\tif (!orig_fopen64)\n\t\torig_fopen64 = (orig_fopen_t)dlsym(RTLD_NEXT, \"fopen64\");\n\n\tFILE *rv = orig_fopen64(pathname, mode);\n\tprintf(\"%u:%s:fopen64 %s:%p\\n\", pid(), name(), pathname, rv);\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "args[i]"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"argcnt %d\\n\"",
            "argcnt"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok",
          "args": [
            "NULL",
            "\",\""
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Error fnetfilter: invalid argument in netfilter command\\n\""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcspn",
          "args": [
            "token",
            "\"\\\\&!?\\\"'<>%^(){};,*[]\""
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "token"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "= strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
          "lines": "83-91",
          "snippet": "len = strlen(name);\n\tif (len <= 4)\n\t\treturn 0;\n\tif (*name == '$' && name[1] == '{' && name[len - 1] == '}')\n\t\treturn 1;\n\treturn 0;\n}\n\n// returns mallocated memory\nstatic char *resolve_x",
          "includes": [
            "#include <sys/stat.h>",
            "#include \"firejail.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/stat.h>\n#include \"firejail.h\"\n\nlen = strlen(name);\n\tif (len <= 4)\n\t\treturn 0;\n\tif (*name == '$' && name[1] == '{' && name[len - 1] == '}')\n\t\treturn 1;\n\treturn 0;\n}\n\n// returns mallocated memory\nstatic char *resolve_x"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Error fnetfilter: only up to %u arguments are supported\\n\"",
            "(unsigned) MAXARGS"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok",
          "args": [
            "arg_start",
            "\",\""
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Error fnetfilter: you need to provide at least one argument\\n\""
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "arg_start"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "src",
            "','"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../include/common.h\"\n\n#define MAXARGS 16\n#define MAXBUF 4098\n\nstatic char *args[MAXARGS] = {0};\nstatic int argcnt = 0;\n\nstatic void process_template(char *src, const char *dest) {\n\tchar *arg_start = strchr(src, ',');\n\tassert(arg_start);\n\t*arg_start = '\\0';\n\targ_start++;\n\tif (*arg_start == '\\0') {\n\t\tfprintf(stderr, \"Error fnetfilter: you need to provide at least one argument\\n\");\n\t\texit(1);\n\t}\n\n\t// extract the arguments from command line\n\tchar *token = strtok(arg_start, \",\");\n\twhile (token) {\n\t\tif (argcnt == MAXARGS) {\n\t\t\tfprintf(stderr, \"Error fnetfilter: only up to %u arguments are supported\\n\", (unsigned) MAXARGS);\n\t\t\texit(1);\n\t\t}\n\t\t// look for abnormal things\n\t\tint len = strlen(token);\n\t\tif (strcspn(token, \"\\\\&!?\\\"'<>%^(){};,*[]\") != (size_t)len) {\n\t\t\tfprintf(stderr, \"Error fnetfilter: invalid argument in netfilter command\\n\");\n\t\t\texit(1);\n\t\t}\n\t\targs[argcnt] = token;\n\t\targcnt++;\n\t\ttoken = strtok(NULL, \",\");\n\t}\n#if 0\n{\nprintf(\"argcnt %d\\n\", argcnt);\nint i;\nfor (i = 0; i < argcnt; i++)\n\tprintf(\"%s\\n\", args[i]);\n}\n#endif\n\n\t// open the files\n\tFILE *fp1 = fopen(src, \"r\");\n\tif (!fp1)\n\t\terr_exit_cannot_open_file(src);\n\n\tFILE *fp2 = fopen(dest, \"w\");\n\tif (!fp2)\n\t\terr_exit_cannot_open_file(dest);\n\n\tint line = 0;\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp1)) {\n\t\tline++;\n\t\tchar *ptr = buf;\n\t\twhile (*ptr != '\\0') {\n\t\t\tif (*ptr != '$')\n\t\t\t\tfputc(*ptr, fp2);\n\t\t\telse {\n\t\t\t\t// parsing\n\t\t\t\tint index = 0;\n\t\t\t\tint rv = sscanf(ptr, \"$ARG%d\", &index) ;\n\t\t\t\tif (rv != 1) {\n\t\t\t\t\tfprintf(stderr, \"Error fnetfilter: invalid template argument on line %d\\n\", line);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\n\t\t\t\t// print argument\n\t\t\t\tif (index < 1 || index > argcnt) {\n\t\t\t\t\tfprintf(stderr, \"Error fnetfilter: $ARG%d on line %d was not defined\\n\", index, line);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\t\t\t\tfprintf(fp2, \"%s\", args[index - 1]);\n\n\t\t\t\t// march to the end of argument\n\t\t\t\tptr += 4;\n\t\t\t\twhile (isdigit(*ptr))\n\t\t\t\t\tptr++;\n\t\t\t\tptr--;\n\t\t\t}\n\t\t\tptr++;\n\t\t}\n\t}\n\n\tfclose(fp1);\n\tfclose(fp2);\n}"
  },
  {
    "function_name": "copy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
    "lines": "59-74",
    "snippet": "static void copy(const char *src, const char *dest) {\n\tFILE *fp1 = fopen(src, \"r\");\n\tif (!fp1)\n\t\terr_exit_cannot_open_file(src);\n\n\tFILE *fp2 = fopen(dest, \"w\");\n\tif (!fp2)\n\t\terr_exit_cannot_open_file(dest);\n\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp1))\n\t\tfprintf(fp2, \"%s\", buf);\n\n\tfclose(fp1);\n\tfclose(fp2);\n}",
    "includes": [
      "#include \"../include/common.h\""
    ],
    "macros_used": [
      "#define MAXBUF 4098"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp2"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp1"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp2",
            "\"%s\"",
            "buf"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "buf",
            "MAXBUF",
            "fp1"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "err_exit_cannot_open_file",
          "args": [
            "dest"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "err_exit_cannot_open_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
          "lines": "53-56",
          "snippet": "static void err_exit_cannot_open_file(const char *fname) {\n\tfprintf(stderr, \"Error fnetfilter: cannot open %s\\n\", fname);\n\texit(1);\n}",
          "includes": [
            "#include \"../include/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../include/common.h\"\n\nstatic void err_exit_cannot_open_file(const char *fname) {\n\tfprintf(stderr, \"Error fnetfilter: cannot open %s\\n\", fname);\n\texit(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "dest",
            "\"w\""
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "fopen64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/libtrace/libtrace.c",
          "lines": "320-327",
          "snippet": "FILE *fopen64(const char *pathname, const char *mode) {\n\tif (!orig_fopen64)\n\t\torig_fopen64 = (orig_fopen_t)dlsym(RTLD_NEXT, \"fopen64\");\n\n\tFILE *rv = orig_fopen64(pathname, mode);\n\tprintf(\"%u:%s:fopen64 %s:%p\\n\", pid(), name(), pathname, rv);\n\treturn rv;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <syslog.h>",
            "#include <sys/stat.h>",
            "#include <sys/un.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include <dlfcn.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static orig_fopen64_t orig_fopen64 = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <dirent.h>\n#include <syslog.h>\n#include <sys/stat.h>\n#include <sys/un.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <unistd.h>\n#include <limits.h>\n#include <sys/types.h>\n#include <dlfcn.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic orig_fopen64_t orig_fopen64 = NULL;\n\nFILE *fopen64(const char *pathname, const char *mode) {\n\tif (!orig_fopen64)\n\t\torig_fopen64 = (orig_fopen_t)dlsym(RTLD_NEXT, \"fopen64\");\n\n\tFILE *rv = orig_fopen64(pathname, mode);\n\tprintf(\"%u:%s:fopen64 %s:%p\\n\", pid(), name(), pathname, rv);\n\treturn rv;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../include/common.h\"\n\n#define MAXBUF 4098\n\nstatic void copy(const char *src, const char *dest) {\n\tFILE *fp1 = fopen(src, \"r\");\n\tif (!fp1)\n\t\terr_exit_cannot_open_file(src);\n\n\tFILE *fp2 = fopen(dest, \"w\");\n\tif (!fp2)\n\t\terr_exit_cannot_open_file(dest);\n\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp1))\n\t\tfprintf(fp2, \"%s\", buf);\n\n\tfclose(fp1);\n\tfclose(fp2);\n}"
  },
  {
    "function_name": "err_exit_cannot_open_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
    "lines": "53-56",
    "snippet": "static void err_exit_cannot_open_file(const char *fname) {\n\tfprintf(stderr, \"Error fnetfilter: cannot open %s\\n\", fname);\n\texit(1);\n}",
    "includes": [
      "#include \"../include/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "err_exit_cannot_open_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
          "lines": "53-56",
          "snippet": "static void err_exit_cannot_open_file(const char *fname) {\n\tfprintf(stderr, \"Error fnetfilter: cannot open %s\\n\", fname);\n\texit(1);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Error fnetfilter: cannot open %s\\n\"",
            "fname"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../include/common.h\"\n\nstatic void err_exit_cannot_open_file(const char *fname) {\n\tfprintf(stderr, \"Error fnetfilter: cannot open %s\\n\", fname);\n\texit(1);\n}"
  },
  {
    "function_name": "usage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fnetfilter/main.c",
    "lines": "48-51",
    "snippet": "static void usage(void) {\n\tprintf(\"Usage:\\n\");\n\tprintf(\"\\tfnetfilter netfilter-command destination-file\\n\");\n}",
    "includes": [
      "#include \"../include/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\tfnetfilter netfilter-command destination-file\\n\""
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Usage:\\n\""
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../include/common.h\"\n\nstatic void usage(void) {\n\tprintf(\"Usage:\\n\");\n\tprintf(\"\\tfnetfilter netfilter-command destination-file\\n\");\n}"
  }
]