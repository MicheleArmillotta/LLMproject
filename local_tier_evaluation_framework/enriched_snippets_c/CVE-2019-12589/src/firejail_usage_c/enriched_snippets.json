[
  {
    "function_name": "usage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/usage.c",
    "lines": "263-266",
    "snippet": "void usage(void) {\n\tprintf(\"firejail - version %s\\n\\n\", VERSION);\n\tputs(usage_str);\n}",
    "includes": [
      "#include \"firejail.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static char *usage_str =\n\t\"Firejail is a SUID sandbox program that reduces the risk of security breaches by\\n\"\n\t\"restricting the running environment of untrusted applications using Linux\\n\"\n\t\"namespaces.\\n\"\n\t\"\\n\"\n\t\"Usage: firejail [options] [program and arguments]\\n\"\n\t\"\\n\"\n\t\"Options:\\n\"\n\t\"    -- - signal the end of options and disables further option processing.\\n\"\n\t\"    --allow-debuggers - allow tools such as strace and gdb inside the sandbox.\\n\"\n\t\"    --allusers - all user home directories are visible inside the sandbox.\\n\"\n\t\"    --apparmor - enable AppArmor confinement.\\n\"\n\t\"    --apparmor.print=name|pid - print apparmor status.\\n\"\n\t\"    --appimage - sandbox an AppImage application.\\n\"\n\t\"    --audit[=test-program] - audit the sandbox.\\n\"\n#ifdef HAVE_NETWORK\n\t\"    --bandwidth=name|pid - set bandwidth limits.\\n\"\n#endif\n\t\"    --bind=dirname1,dirname2 - mount-bind dirname1 on top of dirname2.\\n\"\n\t\"    --bind=filename1,filename2 - mount-bind filename1 on top of filename2.\\n\"\n\t\"    --blacklist=filename - blacklist directory or file.\\n\"\n\t\"    --build - build a whitelisted profile for the application.\\n\"\n\t\"    --build=filename - build a whitelisted profile for the application.\\n\"\n\t\"    --caps - enable default Linux capabilities filter.\\n\"\n\t\"    --caps.drop=all - drop all capabilities.\\n\"\n\t\"    --caps.drop=capability,capability - blacklist capabilities filter.\\n\"\n\t\"    --caps.keep=capability,capability - whitelist capabilities filter.\\n\"\n\t\"    --caps.print=name|pid - print the caps filter.\\n\"\n\t\"    --cgroup=tasks-file - place the sandbox in the specified control group.\\n\"\n#ifdef HAVE_CHROOT\n\t\"    --chroot=dirname - chroot into directory.\\n\"\n#endif\n\t\"    --cpu=cpu-number,cpu-number - set cpu affinity.\\n\"\n\t\"    --cpu.print=name|pid - print the cpus in use.\\n\"\n\t\"    --debug - print sandbox debug messages.\\n\"\n\t\"    --debug-blacklists - debug blacklisting.\\n\"\n\t\"    --debug-caps - print all recognized capabilities.\\n\"\n\t\"    --debug-errnos - print all recognized error numbers.\\n\"\n\t\"    --debug-private-lib - debug for --private-lib option.\\n\"\n\t\"    --debug-protocols - print all recognized protocols.\\n\"\n\t\"    --debug-syscalls - print all recognized system calls.\\n\"\n#ifdef HAVE_WHITELIST\n\t\"    --debug-whitelists - debug whitelisting.\\n\"\n#endif\n#ifdef HAVE_NETWORK\n\t\"    --defaultgw=address - configure default gateway.\\n\"\n#endif\n\t\"    --dns=address - set DNS server.\\n\"\n\t\"    --dns.print=name|pid - print DNS configuration.\\n\"\n\t\"    --env=name=value - set environment variable.\\n\"\n\t\"    --fs.print=name|pid - print the filesystem log.\\n\"\n#ifdef HAVE_FILE_TRANSFER\n\t\"    --get=name|pid filename - get a file from sandbox container.\\n\"\n#endif\n\t\"    --help, -? - this help screen.\\n\"\n\t\"    --hostname=name - set sandbox hostname.\\n\"\n\t\"    --hosts-file=file - use file as /etc/hosts.\\n\"\n\t\"    --ignore=command - ignore command in profile files.\\n\"\n#ifdef HAVE_NETWORK\n\t\"    --interface=name - move interface in sandbox.\\n\"\n\t\"    --ip=address - set interface IP address.\\n\"\n\t\"    --ip=none - no IP address and no default gateway are configured.\\n\"\n\t\"    --ip6=address - set interface IPv6 address.\\n\"\n\t\"    --iprange=address,address - configure an IP address in this range.\\n\"\n#endif\n\t\"    --ipc-namespace - enable a new IPC namespace.\\n\"\n\t\"    --join=name|pid - join the sandbox.\\n\"\n\t\"    --join-filesystem=name|pid - join the mount namespace.\\n\"\n#ifdef HAVE_NETWORK\n\t\"    --join-network=name|pid - join the network namespace.\\n\"\n#endif\n\t\"    --join-or-start=name|pid - join the sandbox or start a new one.\\n\"\n        \"    --keep-dev-shm - /dev/shm directory is untouched (even with --private-dev).\\n\"\n\t\"    --keep-var-tmp - /var/tmp directory is untouched.\\n\"\n\t\"    --list - list all sandboxes.\\n\"\n#ifdef HAVE_FILE_TRANSFER\n\t\"    --ls=name|pid dir_or_filename - list files in sandbox container.\\n\"\n#endif\n#ifdef HAVE_NETWORK\n\t\"    --mac=xx:xx:xx:xx:xx:xx - set interface MAC address.\\n\"\n#endif\n\t\"    --machine-id - preserve /etc/machine-id\\n\"\n#ifdef HAVE_SECCOMP\n\t\"    --memory-deny-write-execute - seccomp filter to block attempts to create\\n\"\n\t\"\\tmemory mappings  that are both writable and executable.\\n\"\n#endif\n#ifdef HAVE_NETWORK\n\t\"    --mtu=number - set interface MTU.\\n\"\n#endif\n\t\"    --name=name - set sandbox name.\\n\"\n#ifdef HAVE_NETWORK\n\t\"    --net=bridgename - enable network namespaces and connect to this bridge.\\n\"\n\t\"    --net=ethernet_interface - enable network namespaces and connect to this\\n\"\n\t\"\\tEthernet interface.\\n\"\n\t\"    --net=none - enable a new, unconnected network namespace.\\n\"\n\t\"    --net.print=name|pid - print network interface configuration.\\n\"\n\t\"    --netfilter[=filename,arg1,arg2,arg3 ...] - enable firewall.\\n\"\n\t\"    --netfilter.print=name|pid - print the firewall.\\n\"\n\t\"    --netfilter6=filename - enable IPv6 firewall.\\n\"\n\t\"    --netfilter6.print=name|pid - print the IPv6 firewall.\\n\"\n\t\"    --netmask=address - define a network mask when dealing with unconfigured\"\n\t\"\\tparrent interfaces.\\n\"\n\t\"    --netns=name - Run the program in a named, persistent network namespace.\\n\"\n\t\"    --netstats - monitor network statistics.\\n\"\n#endif\n\t\"    --nice=value - set nice value.\\n\"\n\t\"    --no3d - disable 3D hardware acceleration.\\n\"\n\t\"    --noblacklist=filename - disable blacklist for file or directory.\\n\"\n\t\"    --nodbus - disable D-Bus access.\\n\"\n\t\"    --nodvd - disable DVD and audio CD devices.\\n\"\n\t\"    --noexec=filename - remount the file or directory noexec nosuid and nodev.\\n\"\n\t\"    --nogroups - disable supplementary groups.\\n\"\n\t\"    --nonewprivs - sets the NO_NEW_PRIVS prctl.\\n\"\n\t\"    --noprofile - do not use a security profile.\\n\"\n#ifdef HAVE_USERNS\n\t\"    --noroot - install a user namespace with only the current user.\\n\"\n#endif\n\t\"    --nosound - disable sound system.\\n\"\n\t\"    --noautopulse - disable automatic ~/.config/pulse init.\\n\"\n\t\"    --novideo - disable video devices.\\n\"\n\t\"    --nou2f - disable U2F devices.\\n\"\n\t\"    --nowhitelist=filename - disable whitelist for file or directory .\\n\"\n\t\"    --output=logfile - stdout logging and log rotation.\\n\"\n\t\"    --output-stderr=logfile - stdout and stderr logging and log rotation.\\n\"\n\t\"    --overlay - mount a filesystem overlay on top of the current filesystem.\\n\"\n\t\"    --overlay-named=name - mount a filesystem overlay on top of the current\\n\"\n\t\"\\tfilesystem, and store it in name directory.\\n\"\n\t\"    --overlay-tmpfs - mount a temporary filesystem overlay on top of the\\n\"\n\t\"\\tcurrent filesystem.\\n\"\n\t\"    --overlay-clean - clean all overlays stored in $HOME/.firejail directory.\\n\"\n\t\"    --private - temporary home directory.\\n\"\n\t\"    --private=directory - use directory as user home.\\n\"\n\t\"    --private-cache - temporary ~/.cache directory.\\n\"\n\t\"    --private-home=file,directory - build a new user home in a temporary\\n\"\n\t\"\\tfilesystem, and copy the files and directories in the list in\\n\"\n\t\"\\tthe new home.\\n\"\n\t\"    --private-bin=file,file - build a new /bin in a temporary filesystem,\\n\"\n\t\"\\tand copy the programs in the list.\\n\"\n\t\"    --private-dev - create a new /dev directory with a small number of\\n\"\n\t\"\\tcommon device files.\\n\"\n\t\"    --private-etc=file,directory - build a new /etc in a temporary\\n\"\n\t\"\\tfilesystem, and copy the files and directories in the list.\\n\"\n\t\"    --private-tmp - mount a tmpfs on top of /tmp directory.\\n\"\n\t\"    --private-opt=file,directory - build a new /opt in a temporary filesystem.\\n\"\n\t\"    --private-srv=file,directory - build a new /srv in a temporary filesystem.\\n\"\n\t\"    --profile=filename|profile_name - use a custom profile.\\n\"\n\t\"    --profile.print=name|pid - print the name of profile file.\\n\"\n\t\"    --profile-path=directory - use this directory to look for profile files.\\n\"\n\t\"    --protocol=protocol,protocol,protocol - enable protocol filter.\\n\"\n\t\"    --protocol.print=name|pid - print the protocol filter.\\n\"\n#ifdef HAVE_FILE_TRANSFER\n\t\"    --put=name|pid src-filename dest-filename - put a file in sandbox\\n\"\n\t\"\\tcontainer.\\n\"\n#endif\n\t\"    --quiet - turn off Firejail's output.\\n"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "puts",
          "args": [
            "usage_str"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"firejail - version %s\\n\\n\"",
            "VERSION"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"firejail.h\"\n\nstatic char *usage_str =\n\t\"Firejail is a SUID sandbox program that reduces the risk of security breaches by\\n\"\n\t\"restricting the running environment of untrusted applications using Linux\\n\"\n\t\"namespaces.\\n\"\n\t\"\\n\"\n\t\"Usage: firejail [options] [program and arguments]\\n\"\n\t\"\\n\"\n\t\"Options:\\n\"\n\t\"    -- - signal the end of options and disables further option processing.\\n\"\n\t\"    --allow-debuggers - allow tools such as strace and gdb inside the sandbox.\\n\"\n\t\"    --allusers - all user home directories are visible inside the sandbox.\\n\"\n\t\"    --apparmor - enable AppArmor confinement.\\n\"\n\t\"    --apparmor.print=name|pid - print apparmor status.\\n\"\n\t\"    --appimage - sandbox an AppImage application.\\n\"\n\t\"    --audit[=test-program] - audit the sandbox.\\n\"\n#ifdef HAVE_NETWORK\n\t\"    --bandwidth=name|pid - set bandwidth limits.\\n\"\n#endif\n\t\"    --bind=dirname1,dirname2 - mount-bind dirname1 on top of dirname2.\\n\"\n\t\"    --bind=filename1,filename2 - mount-bind filename1 on top of filename2.\\n\"\n\t\"    --blacklist=filename - blacklist directory or file.\\n\"\n\t\"    --build - build a whitelisted profile for the application.\\n\"\n\t\"    --build=filename - build a whitelisted profile for the application.\\n\"\n\t\"    --caps - enable default Linux capabilities filter.\\n\"\n\t\"    --caps.drop=all - drop all capabilities.\\n\"\n\t\"    --caps.drop=capability,capability - blacklist capabilities filter.\\n\"\n\t\"    --caps.keep=capability,capability - whitelist capabilities filter.\\n\"\n\t\"    --caps.print=name|pid - print the caps filter.\\n\"\n\t\"    --cgroup=tasks-file - place the sandbox in the specified control group.\\n\"\n#ifdef HAVE_CHROOT\n\t\"    --chroot=dirname - chroot into directory.\\n\"\n#endif\n\t\"    --cpu=cpu-number,cpu-number - set cpu affinity.\\n\"\n\t\"    --cpu.print=name|pid - print the cpus in use.\\n\"\n\t\"    --debug - print sandbox debug messages.\\n\"\n\t\"    --debug-blacklists - debug blacklisting.\\n\"\n\t\"    --debug-caps - print all recognized capabilities.\\n\"\n\t\"    --debug-errnos - print all recognized error numbers.\\n\"\n\t\"    --debug-private-lib - debug for --private-lib option.\\n\"\n\t\"    --debug-protocols - print all recognized protocols.\\n\"\n\t\"    --debug-syscalls - print all recognized system calls.\\n\"\n#ifdef HAVE_WHITELIST\n\t\"    --debug-whitelists - debug whitelisting.\\n\"\n#endif\n#ifdef HAVE_NETWORK\n\t\"    --defaultgw=address - configure default gateway.\\n\"\n#endif\n\t\"    --dns=address - set DNS server.\\n\"\n\t\"    --dns.print=name|pid - print DNS configuration.\\n\"\n\t\"    --env=name=value - set environment variable.\\n\"\n\t\"    --fs.print=name|pid - print the filesystem log.\\n\"\n#ifdef HAVE_FILE_TRANSFER\n\t\"    --get=name|pid filename - get a file from sandbox container.\\n\"\n#endif\n\t\"    --help, -? - this help screen.\\n\"\n\t\"    --hostname=name - set sandbox hostname.\\n\"\n\t\"    --hosts-file=file - use file as /etc/hosts.\\n\"\n\t\"    --ignore=command - ignore command in profile files.\\n\"\n#ifdef HAVE_NETWORK\n\t\"    --interface=name - move interface in sandbox.\\n\"\n\t\"    --ip=address - set interface IP address.\\n\"\n\t\"    --ip=none - no IP address and no default gateway are configured.\\n\"\n\t\"    --ip6=address - set interface IPv6 address.\\n\"\n\t\"    --iprange=address,address - configure an IP address in this range.\\n\"\n#endif\n\t\"    --ipc-namespace - enable a new IPC namespace.\\n\"\n\t\"    --join=name|pid - join the sandbox.\\n\"\n\t\"    --join-filesystem=name|pid - join the mount namespace.\\n\"\n#ifdef HAVE_NETWORK\n\t\"    --join-network=name|pid - join the network namespace.\\n\"\n#endif\n\t\"    --join-or-start=name|pid - join the sandbox or start a new one.\\n\"\n        \"    --keep-dev-shm - /dev/shm directory is untouched (even with --private-dev).\\n\"\n\t\"    --keep-var-tmp - /var/tmp directory is untouched.\\n\"\n\t\"    --list - list all sandboxes.\\n\"\n#ifdef HAVE_FILE_TRANSFER\n\t\"    --ls=name|pid dir_or_filename - list files in sandbox container.\\n\"\n#endif\n#ifdef HAVE_NETWORK\n\t\"    --mac=xx:xx:xx:xx:xx:xx - set interface MAC address.\\n\"\n#endif\n\t\"    --machine-id - preserve /etc/machine-id\\n\"\n#ifdef HAVE_SECCOMP\n\t\"    --memory-deny-write-execute - seccomp filter to block attempts to create\\n\"\n\t\"\\tmemory mappings  that are both writable and executable.\\n\"\n#endif\n#ifdef HAVE_NETWORK\n\t\"    --mtu=number - set interface MTU.\\n\"\n#endif\n\t\"    --name=name - set sandbox name.\\n\"\n#ifdef HAVE_NETWORK\n\t\"    --net=bridgename - enable network namespaces and connect to this bridge.\\n\"\n\t\"    --net=ethernet_interface - enable network namespaces and connect to this\\n\"\n\t\"\\tEthernet interface.\\n\"\n\t\"    --net=none - enable a new, unconnected network namespace.\\n\"\n\t\"    --net.print=name|pid - print network interface configuration.\\n\"\n\t\"    --netfilter[=filename,arg1,arg2,arg3 ...] - enable firewall.\\n\"\n\t\"    --netfilter.print=name|pid - print the firewall.\\n\"\n\t\"    --netfilter6=filename - enable IPv6 firewall.\\n\"\n\t\"    --netfilter6.print=name|pid - print the IPv6 firewall.\\n\"\n\t\"    --netmask=address - define a network mask when dealing with unconfigured\"\n\t\"\\tparrent interfaces.\\n\"\n\t\"    --netns=name - Run the program in a named, persistent network namespace.\\n\"\n\t\"    --netstats - monitor network statistics.\\n\"\n#endif\n\t\"    --nice=value - set nice value.\\n\"\n\t\"    --no3d - disable 3D hardware acceleration.\\n\"\n\t\"    --noblacklist=filename - disable blacklist for file or directory.\\n\"\n\t\"    --nodbus - disable D-Bus access.\\n\"\n\t\"    --nodvd - disable DVD and audio CD devices.\\n\"\n\t\"    --noexec=filename - remount the file or directory noexec nosuid and nodev.\\n\"\n\t\"    --nogroups - disable supplementary groups.\\n\"\n\t\"    --nonewprivs - sets the NO_NEW_PRIVS prctl.\\n\"\n\t\"    --noprofile - do not use a security profile.\\n\"\n#ifdef HAVE_USERNS\n\t\"    --noroot - install a user namespace with only the current user.\\n\"\n#endif\n\t\"    --nosound - disable sound system.\\n\"\n\t\"    --noautopulse - disable automatic ~/.config/pulse init.\\n\"\n\t\"    --novideo - disable video devices.\\n\"\n\t\"    --nou2f - disable U2F devices.\\n\"\n\t\"    --nowhitelist=filename - disable whitelist for file or directory .\\n\"\n\t\"    --output=logfile - stdout logging and log rotation.\\n\"\n\t\"    --output-stderr=logfile - stdout and stderr logging and log rotation.\\n\"\n\t\"    --overlay - mount a filesystem overlay on top of the current filesystem.\\n\"\n\t\"    --overlay-named=name - mount a filesystem overlay on top of the current\\n\"\n\t\"\\tfilesystem, and store it in name directory.\\n\"\n\t\"    --overlay-tmpfs - mount a temporary filesystem overlay on top of the\\n\"\n\t\"\\tcurrent filesystem.\\n\"\n\t\"    --overlay-clean - clean all overlays stored in $HOME/.firejail directory.\\n\"\n\t\"    --private - temporary home directory.\\n\"\n\t\"    --private=directory - use directory as user home.\\n\"\n\t\"    --private-cache - temporary ~/.cache directory.\\n\"\n\t\"    --private-home=file,directory - build a new user home in a temporary\\n\"\n\t\"\\tfilesystem, and copy the files and directories in the list in\\n\"\n\t\"\\tthe new home.\\n\"\n\t\"    --private-bin=file,file - build a new /bin in a temporary filesystem,\\n\"\n\t\"\\tand copy the programs in the list.\\n\"\n\t\"    --private-dev - create a new /dev directory with a small number of\\n\"\n\t\"\\tcommon device files.\\n\"\n\t\"    --private-etc=file,directory - build a new /etc in a temporary\\n\"\n\t\"\\tfilesystem, and copy the files and directories in the list.\\n\"\n\t\"    --private-tmp - mount a tmpfs on top of /tmp directory.\\n\"\n\t\"    --private-opt=file,directory - build a new /opt in a temporary filesystem.\\n\"\n\t\"    --private-srv=file,directory - build a new /srv in a temporary filesystem.\\n\"\n\t\"    --profile=filename|profile_name - use a custom profile.\\n\"\n\t\"    --profile.print=name|pid - print the name of profile file.\\n\"\n\t\"    --profile-path=directory - use this directory to look for profile files.\\n\"\n\t\"    --protocol=protocol,protocol,protocol - enable protocol filter.\\n\"\n\t\"    --protocol.print=name|pid - print the protocol filter.\\n\"\n#ifdef HAVE_FILE_TRANSFER\n\t\"    --put=name|pid src-filename dest-filename - put a file in sandbox\\n\"\n\t\"\\tcontainer.\\n\"\n#endif\n\t\"    --quiet - turn off Firejail's output.\\n;\n\nvoid usage(void) {\n\tprintf(\"firejail - version %s\\n\\n\", VERSION);\n\tputs(usage_str);\n}"
  }
]