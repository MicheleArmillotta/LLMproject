[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/tools/ttytest.c",
    "lines": "7-36",
    "snippet": "int main(void) {\n\tint fdm;\n\tint rc;\n\n\t// initial\n\tsystem(\"ls -l /dev/pts\");\n\n\tfdm = posix_openpt(O_RDWR);\n\tif (fdm < 0) {\n\t\tperror(\"posix_openpt\");\n\t\treturn 1;\n\t}\n\n\trc = grantpt(fdm);\n\tif (rc != 0) {\n\t\tperror(\"grantpt\");\n\t\treturn 1;\n\t}\n\n\trc = unlockpt(fdm);\n\tif (rc != 0) {\n\t\tperror(\"unlockpt\");\n\t\treturn 1;\n\t}\n\n\t// final\n\tsystem(\"ls -l /dev/pts\");\n\n\treturn 0;\n}",
    "includes": [
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "system",
          "args": [
            "\"ls -l /dev/pts\""
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "system",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/libtrace/libtrace.c",
          "lines": "574-582",
          "snippet": "int system(const char *command) {\n\tif (!orig_system)\n\t\torig_system = (orig_system_t)dlsym(RTLD_NEXT, \"system\");\n\n\tint rv = orig_system(command);\n\tprintf(\"%u:%s:system %s:%d\\n\", pid(), name(), command, rv);\n\n\treturn rv;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <syslog.h>",
            "#include <sys/stat.h>",
            "#include <sys/un.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include <dlfcn.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static orig_system_t orig_system = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <dirent.h>\n#include <syslog.h>\n#include <sys/stat.h>\n#include <sys/un.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <unistd.h>\n#include <limits.h>\n#include <sys/types.h>\n#include <dlfcn.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic orig_system_t orig_system = NULL;\n\nint system(const char *command) {\n\tif (!orig_system)\n\t\torig_system = (orig_system_t)dlsym(RTLD_NEXT, \"system\");\n\n\tint rv = orig_system(command);\n\tprintf(\"%u:%s:system %s:%d\\n\", pid(), name(), command, rv);\n\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"unlockpt\""
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlockpt",
          "args": [
            "fdm"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"grantpt\""
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "grantpt",
          "args": [
            "fdm"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"posix_openpt\""
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "posix_openpt",
          "args": [
            "O_RDWR"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nint main(void) {\n\tint fdm;\n\tint rc;\n\n\t// initial\n\tsystem(\"ls -l /dev/pts\");\n\n\tfdm = posix_openpt(O_RDWR);\n\tif (fdm < 0) {\n\t\tperror(\"posix_openpt\");\n\t\treturn 1;\n\t}\n\n\trc = grantpt(fdm);\n\tif (rc != 0) {\n\t\tperror(\"grantpt\");\n\t\treturn 1;\n\t}\n\n\trc = unlockpt(fdm);\n\tif (rc != 0) {\n\t\tperror(\"unlockpt\");\n\t\treturn 1;\n\t}\n\n\t// final\n\tsystem(\"ls -l /dev/pts\");\n\n\treturn 0;\n}"
  }
]