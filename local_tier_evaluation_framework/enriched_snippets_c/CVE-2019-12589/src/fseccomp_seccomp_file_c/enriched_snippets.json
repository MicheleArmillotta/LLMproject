[
  {
    "function_name": "filter_end_whitelist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
    "lines": "98-103",
    "snippet": "void filter_end_whitelist(int fd) {\n\tstruct sock_filter filter[] = {\n\t\tKILL_PROCESS\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}",
    "includes": [
      "#include <sys/syscall.h>",
      "#include \"../include/seccomp.h\"",
      "#include \"fseccomp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_to_file",
          "args": [
            "fd",
            "filter",
            "sizeof(filter)"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "write_to_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
          "lines": "24-37",
          "snippet": "void write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}",
          "includes": [
            "#include <sys/syscall.h>",
            "#include \"../include/seccomp.h\"",
            "#include \"fseccomp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid filter_end_whitelist(int fd) {\n\tstruct sock_filter filter[] = {\n\t\tKILL_PROCESS\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}"
  },
  {
    "function_name": "filter_end_blacklist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
    "lines": "91-96",
    "snippet": "void filter_end_blacklist(int fd) {\n\tstruct sock_filter filter[] = {\n\t\tRETURN_ALLOW\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}",
    "includes": [
      "#include <sys/syscall.h>",
      "#include \"../include/seccomp.h\"",
      "#include \"fseccomp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_to_file",
          "args": [
            "fd",
            "filter",
            "sizeof(filter)"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "write_to_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
          "lines": "24-37",
          "snippet": "void write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}",
          "includes": [
            "#include <sys/syscall.h>",
            "#include \"../include/seccomp.h\"",
            "#include \"fseccomp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid filter_end_blacklist(int fd) {\n\tstruct sock_filter filter[] = {\n\t\tRETURN_ALLOW\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}"
  },
  {
    "function_name": "filter_add_errno",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
    "lines": "83-89",
    "snippet": "void filter_add_errno(int fd, int syscall, int arg, void *ptrarg) {\n\t(void) ptrarg;\n\tstruct sock_filter filter[] = {\n\t\tBLACKLIST_ERRNO(syscall, arg)\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}",
    "includes": [
      "#include <sys/syscall.h>",
      "#include \"../include/seccomp.h\"",
      "#include \"fseccomp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_to_file",
          "args": [
            "fd",
            "filter",
            "sizeof(filter)"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "write_to_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
          "lines": "24-37",
          "snippet": "void write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}",
          "includes": [
            "#include <sys/syscall.h>",
            "#include \"../include/seccomp.h\"",
            "#include \"fseccomp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BLACKLIST_ERRNO",
          "args": [
            "syscall",
            "arg"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid filter_add_errno(int fd, int syscall, int arg, void *ptrarg) {\n\t(void) ptrarg;\n\tstruct sock_filter filter[] = {\n\t\tBLACKLIST_ERRNO(syscall, arg)\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}"
  },
  {
    "function_name": "filter_add_blacklist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
    "lines": "73-81",
    "snippet": "void filter_add_blacklist(int fd, int syscall, int arg, void *ptrarg) {\n\t(void) arg;\n\t(void) ptrarg;\n\n\tstruct sock_filter filter[] = {\n\t\tBLACKLIST(syscall)\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}",
    "includes": [
      "#include <sys/syscall.h>",
      "#include \"../include/seccomp.h\"",
      "#include \"fseccomp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_to_file",
          "args": [
            "fd",
            "filter",
            "sizeof(filter)"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "write_to_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
          "lines": "24-37",
          "snippet": "void write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}",
          "includes": [
            "#include <sys/syscall.h>",
            "#include \"../include/seccomp.h\"",
            "#include \"fseccomp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BLACKLIST",
          "args": [
            "syscall"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid filter_add_blacklist(int fd, int syscall, int arg, void *ptrarg) {\n\t(void) arg;\n\t(void) ptrarg;\n\n\tstruct sock_filter filter[] = {\n\t\tBLACKLIST(syscall)\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}"
  },
  {
    "function_name": "filter_add_whitelist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
    "lines": "63-71",
    "snippet": "void filter_add_whitelist(int fd, int syscall, int arg, void *ptrarg) {\n\t(void) arg;\n\t(void) ptrarg;\n\n\tstruct sock_filter filter[] = {\n\t\tWHITELIST(syscall)\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}",
    "includes": [
      "#include <sys/syscall.h>",
      "#include \"../include/seccomp.h\"",
      "#include \"fseccomp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_to_file",
          "args": [
            "fd",
            "filter",
            "sizeof(filter)"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "write_to_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
          "lines": "24-37",
          "snippet": "void write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}",
          "includes": [
            "#include <sys/syscall.h>",
            "#include \"../include/seccomp.h\"",
            "#include \"fseccomp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "WHITELIST",
          "args": [
            "syscall"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid filter_add_whitelist(int fd, int syscall, int arg, void *ptrarg) {\n\t(void) arg;\n\t(void) ptrarg;\n\n\tstruct sock_filter filter[] = {\n\t\tWHITELIST(syscall)\n\t};\n\twrite_to_file(fd, filter, sizeof(filter));\n}"
  },
  {
    "function_name": "filter_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
    "lines": "39-61",
    "snippet": "void filter_init(int fd) {\n\tstruct sock_filter filter[] = {\n\t\tVALIDATE_ARCHITECTURE,\n#if defined(__x86_64__)\n\t\tEXAMINE_SYSCALL,\n\t\tHANDLE_X32\n#else\n\t\tEXAMINE_SYSCALL\n#endif\n\t};\n\n#if 0\n{\n\tint i;\n\tunsigned char *ptr = (unsigned char *) &filter[0];\n\tfor (i = 0; i < sizeof(filter); i++, ptr++)\n\t\tprintf(\"%x, \", (*ptr) & 0xff);\n\tprintf(\"\\n\");\n}\n#endif\n\n\twrite_to_file(fd, filter, sizeof(filter));\n}",
    "includes": [
      "#include <sys/syscall.h>",
      "#include \"../include/seccomp.h\"",
      "#include \"fseccomp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_to_file",
          "args": [
            "fd",
            "filter",
            "sizeof(filter)"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "write_to_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
          "lines": "24-37",
          "snippet": "void write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}",
          "includes": [
            "#include <sys/syscall.h>",
            "#include \"../include/seccomp.h\"",
            "#include \"fseccomp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%x, \"",
            "(*ptr) & 0xff"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid filter_init(int fd) {\n\tstruct sock_filter filter[] = {\n\t\tVALIDATE_ARCHITECTURE,\n#if defined(__x86_64__)\n\t\tEXAMINE_SYSCALL,\n\t\tHANDLE_X32\n#else\n\t\tEXAMINE_SYSCALL\n#endif\n\t};\n\n#if 0\n{\n\tint i;\n\tunsigned char *ptr = (unsigned char *) &filter[0];\n\tfor (i = 0; i < sizeof(filter); i++, ptr++)\n\t\tprintf(\"%x, \", (*ptr) & 0xff);\n\tprintf(\"\\n\");\n}\n#endif\n\n\twrite_to_file(fd, filter, sizeof(filter));\n}"
  },
  {
    "function_name": "write_to_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
    "lines": "24-37",
    "snippet": "void write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}",
    "includes": [
      "#include <sys/syscall.h>",
      "#include \"../include/seccomp.h\"",
      "#include \"fseccomp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "exit_err_feature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/main.c",
          "lines": "329-332",
          "snippet": "static void exit_err_feature(const char *feature) {\n\tfprintf(stderr, \"Error: %s feature is disabled in Firejail configuration file\\n\", feature);\n\texit(1);\n}",
          "includes": [
            "#include <sys/utsname.h>",
            "#include <net/if.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/prctl.h>",
            "#include <sys/file.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <pwd.h>",
            "#include <dirent.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/mount.h>",
            "#include <sched.h>",
            "#include <sys/utsname.h>",
            "#include \"../include/firejail_user.h\"",
            "#include \"../include/pid.h\"",
            "#include \"firejail.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/utsname.h>\n#include <net/if.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/prctl.h>\n#include <sys/file.h>\n#include <limits.h>\n#include <errno.h>\n#include <pwd.h>\n#include <dirent.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/mount.h>\n#include <sched.h>\n#include <sys/utsname.h>\n#include \"../include/firejail_user.h\"\n#include \"../include/pid.h\"\n#include \"firejail.h\"\n\nstatic void exit_err_feature(const char *feature) {\n\tfprintf(stderr, \"Error: %s feature is disabled in Firejail configuration file\\n\", feature);\n\texit(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Error fseccomp: cannot write seccomp file\\n\""
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write",
          "args": [
            "fd",
            "(unsigned char *) data + written",
            "size - written"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "write_to_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/fseccomp/seccomp_file.c",
          "lines": "24-37",
          "snippet": "void write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "size"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "data"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/syscall.h>\n#include \"../include/seccomp.h\"\n#include \"fseccomp.h\"\n\nvoid write_to_file(int fd, const void *data, int size) {\n\tassert(data);\n\tassert(size);\n\n\tint written = 0;\n\twhile (written < size) {\n\t\tint rv = write(fd, (unsigned char *) data + written, size - written);\n\t\tif (rv == -1) {\n\t\t\tfprintf(stderr, \"Error fseccomp: cannot write seccomp file\\n\");\n\t\t\texit(1);\n\t\t}\n\t\twritten += rv;\n\t}\n}"
  }
]