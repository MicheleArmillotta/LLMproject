[
  {
    "function_name": "/\tEUID_ASSERT();",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
    "lines": "261-293",
    "snippet": ") {\n//\tEUID_ASSERT();\n\tassert(fname);\n\tconst char *ptr = fname;\n\n\tif (strncmp(ptr, \"${HOME}\", 7) == 0)\n\t\tptr = fname + 7;\n\telse if (strncmp(ptr, \"${PATH}\", 7) == 0)\n\t\tptr = fname + 7;\n\telse if (strncmp(ptr, \"${RUNUSER}\", 10) == 0)\n\t\tptr = fname + 10;\n\telse {\n\t\tint id = macro_id(fname);\n\t\tif (id != -1)\n\t\t\treturn;\n\t}\n\n\tint len = strlen(ptr);\n\n\tif (globbing) {\n\t\t// file globbing ('*?[]') is allowed\n\t\tif (strcspn(ptr, \"\\\\&!\\\"'<>%^(){};,\") != (size_t)len) {\n\t\t\tfprintf(stderr, \"Error: \\\"%s\\\" is an invalid filename\\n\", ptr);\n\t\t\texit(1);\n\t\t}\n\t}\n\telse {\n\t\tif (strcspn(ptr, \"\\\\&!?\\\"'<>%^(){};,*[]\") != (size_t)len) {\n\t\t\tfprintf(stderr, \"Error: \\\"%s\\\" is an invalid filename\\n\", ptr);\n\t\t\texit(1);\n\t\t}\n\t}\n}",
    "includes": [
      "#include <sys/stat.h>",
      "#include \"firejail.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "\\n\", pt",
          "args": [
            ");",
            "it(1);\n\t\t}\n\t}\n}"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "{\n\t\t\tf",
          "args": [
            "rin",
            "(stderr, \"Error: \\\"%s\\\""
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">%^(",
          "args": [
            "{"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "\\n\", pt",
          "args": [
            ");",
            "it(1);\n\t\t}\n\t}\n\telse {\n\t\tif (strcspn(ptr,",
            "\\\\&"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprin",
          "args": [
            "f(s",
            "err, \"Error: \\\"%s\\\""
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "?[]')",
          "args": [
            "s a"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "len = st",
          "args": [
            "len(p"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "10;\n\tel",
          "args": [
            "e {",
            "int id = ma",
            "o_"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "else if",
          "args": [
            "(st",
            "cmp(ptr,",
            "{"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "else if",
          "args": [
            "(st",
            "cmp(ptr,",
            "{"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p(ptr,",
          "args": [
            "\"${HO"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/stat.h>\n#include \"firejail.h\"\n\n) {\n//\tEUID_ASSERT();\n\tassert(fname);\n\tconst char *ptr = fname;\n\n\tif (strncmp(ptr, \"${HOME}\", 7) == 0)\n\t\tptr = fname + 7;\n\telse if (strncmp(ptr, \"${PATH}\", 7) == 0)\n\t\tptr = fname + 7;\n\telse if (strncmp(ptr, \"${RUNUSER}\", 10) == 0)\n\t\tptr = fname + 10;\n\telse {\n\t\tint id = macro_id(fname);\n\t\tif (id != -1)\n\t\t\treturn;\n\t}\n\n\tint len = strlen(ptr);\n\n\tif (globbing) {\n\t\t// file globbing ('*?[]') is allowed\n\t\tif (strcspn(ptr, \"\\\\&!\\\"'<>%^(){};,\") != (size_t)len) {\n\t\t\tfprintf(stderr, \"Error: \\\"%s\\\" is an invalid filename\\n\", ptr);\n\t\t\texit(1);\n\t\t}\n\t}\n\telse {\n\t\tif (strcspn(ptr, \"\\\\&!?\\\"'<>%^(){};,*[]\") != (size_t)len) {\n\t\t\tfprintf(stderr, \"Error: \\\"%s\\\" is an invalid filename\\n\", ptr);\n\t\t\texit(1);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "t called_as_r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
    "lines": "195-259",
    "snippet": ";\n\n\tint called_as_root = 0;\n\n\tif(geteuid() == 0)\n\t\tcalled_as_root = 1;\n\n\tif(called_as_root) {\n\t\tEUID_USER();\n\t}\n\n\tEUID_ASSERT();\n\n\t// Replace home macro\n\tchar *new_name = NULL;\n\tif (strncmp(path, \"${HOME}\", 7) == 0) {\n\t\tif (asprintf(&new_name, \"%s%s\", cfg.homedir, path + 7) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse if (*path == '~') {\n\t\tif (asprintf(&new_name, \"%s%s\", cfg.homedir, path + 1) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse if (strncmp(path, \"${CFG}\", 6) == 0) {\n\t\tif (asprintf(&new_name, \"%s%s\", SYSCONFDIR, path + 6) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse if (strncmp(path, \"${RUNUSER}\", 10) == 0) {\n\t\tif (asprintf(&new_name, \"/run/user/%u%s\", getuid(), path + 10) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse {\n\t\tchar *directory = resolve_macro(path);\n\t\tif (directory) {\n\t\t\tif (asprintf(&new_name, \"%s/%s\", cfg.homedir, directory) == -1)\n\t\t\t\terrExit(\"asprintf\");\n\t\t\tif(called_as_root)\n\t\t\t\tEUID_ROOT();\n\t\t\tfree(directory);\n\t\t\treturn new_name;\n\t\t}\n\t}\n\n\tchar *rv = strdup(path);\n\tif (!rv)\n\t\terrExit(\"strdup\");\n\n\tif(called_as_root)\n\t\tEUID_ROOT();\n\n\treturn rv;\n}\n\nvoid invalid_filename(const char *fname, int globbi",
    "includes": [
      "#include <sys/stat.h>",
      "#include \"firejail.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Macro macro[] = {\n\t{\n\t\t\"${DOWNLOADS}\",\n\t\t\"XDG_DOWNLOAD_DIR=\\\"$HOME/\",\n\t\t{ \"Downloads\", \"Загрузки\", \"Téléchargement\" }\n\t},\n\n\t{\n\t \t\"${MUSIC}\",\n\t\t\"XDG_MUSIC_DIR=\\\"$HOME/\",\n\t\t{\"Music\", \"Музыка\", \"Musique\"}\n\t},\n\n\t{\n\t \t\"${VIDEOS}\",\n\t\t\"XDG_VIDEOS_DIR=\\\"$HOME/\",\n\t\t{\"Videos\", \"Видео\", \"Vidéos\"}\n\t},\n\n\t{\n\t \t\"${PICTURES}\",\n\t\t\"XDG_PICTURES_DIR=\\\"$HOME/\",\n\t\t{\"Pictures\", \"Изображения\", \"Photos\"}\n\t},\n\n\t{\n\t\t\"${DESKTOP}\",\n\t\t\"XDG_DESKTOP_DIR=\\\"$HOME/\",\n\t\t{\"Desktop\", \"Рабочий стол\", \"Bureau\"}\n\t},\n\n\t{\n\t\t\"${DOCUMENTS}\",\n\t\t\"XDG_DOCUMENTS_DIR=\\\"$HOME/\",\n\t\t{\"Documents\", \"Документы\", \"Documents\"}\n\t},\n\n\t{ 0 }\n};\n\n// return -1 if not found\nint macro_id(const char *"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nst char",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n\n\tret",
          "args": [
            "rn rv;\n}"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "led_as",
          "args": [
            "root"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "t called_as_r",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
          "lines": "195-259",
          "snippet": ";\n\n\tint called_as_root = 0;\n\n\tif(geteuid() == 0)\n\t\tcalled_as_root = 1;\n\n\tif(called_as_root) {\n\t\tEUID_USER();\n\t}\n\n\tEUID_ASSERT();\n\n\t// Replace home macro\n\tchar *new_name = NULL;\n\tif (strncmp(path, \"${HOME}\", 7) == 0) {\n\t\tif (asprintf(&new_name, \"%s%s\", cfg.homedir, path + 7) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse if (*path == '~') {\n\t\tif (asprintf(&new_name, \"%s%s\", cfg.homedir, path + 1) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse if (strncmp(path, \"${CFG}\", 6) == 0) {\n\t\tif (asprintf(&new_name, \"%s%s\", SYSCONFDIR, path + 6) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse if (strncmp(path, \"${RUNUSER}\", 10) == 0) {\n\t\tif (asprintf(&new_name, \"/run/user/%u%s\", getuid(), path + 10) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse {\n\t\tchar *directory = resolve_macro(path);\n\t\tif (directory) {\n\t\t\tif (asprintf(&new_name, \"%s/%s\", cfg.homedir, directory) == -1)\n\t\t\t\terrExit(\"asprintf\");\n\t\t\tif(called_as_root)\n\t\t\t\tEUID_ROOT();\n\t\t\tfree(directory);\n\t\t\treturn new_name;\n\t\t}\n\t}\n\n\tchar *rv = strdup(path);\n\tif (!rv)\n\t\terrExit(\"strdup\");\n\n\tif(called_as_root)\n\t\tEUID_ROOT();\n\n\treturn rv;\n}\n\nvoid invalid_filename(const char *fname, int globbi",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "v =",
          "args": [
            "trdup(pat"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "}\n\t}",
          "args": [],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OOT();",
          "args": [
            "free(dir"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "== -1)",
          "args": [
            "errExit",
            "asprint",
            ");\n\t\t\tif(ca",
            "ed_as_roo"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tf(&new_name,",
          "args": [
            "\"%s/"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rectory =",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T();",
          "args": [
            "eturn new_"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "+ 10) ==",
          "args": [
            "-1)\n\t\t\ter",
            "xit(\"asprintf\");",
            "if(call",
            "_as_root)"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "if(ca",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f(&new_",
          "args": [
            "ame,",
            "/run/user/%u",
            "\","
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path, \"${",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T();",
          "args": [
            "eturn new_"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "-1)\n\t\t\te",
          "args": [
            "rExit(\"as",
            "intf\")",
            "if(calle",
            "as_root)"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w_name,",
          "args": [
            "\"%s%",
            ", SYSCON",
            "I"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path, \"${",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T();",
          "args": [
            "eturn new_"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "-1)",
          "args": [
            "rrExit(\"a",
            "rintf\"",
            "if(calle",
            "as_root)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "'~') {",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T();",
          "args": [
            "eturn new_"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "-1)",
          "args": [
            "rrExit(\"a",
            "rintf\"",
            "if(calle",
            "as_root)"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ew_name",
          "args": [
            "\"%s",
            "\", cfg.ho",
            "d"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e = NULL;",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cro\n\tchar",
          "args": [],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root) {",
          "args": [],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ") == 0",
          "args": [
            "c"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/stat.h>\n#include \"firejail.h\"\n\nMacro macro[] = {\n\t{\n\t\t\"${DOWNLOADS}\",\n\t\t\"XDG_DOWNLOAD_DIR=\\\"$HOME/\",\n\t\t{ \"Downloads\", \"Загрузки\", \"Téléchargement\" }\n\t},\n\n\t{\n\t \t\"${MUSIC}\",\n\t\t\"XDG_MUSIC_DIR=\\\"$HOME/\",\n\t\t{\"Music\", \"Музыка\", \"Musique\"}\n\t},\n\n\t{\n\t \t\"${VIDEOS}\",\n\t\t\"XDG_VIDEOS_DIR=\\\"$HOME/\",\n\t\t{\"Videos\", \"Видео\", \"Vidéos\"}\n\t},\n\n\t{\n\t \t\"${PICTURES}\",\n\t\t\"XDG_PICTURES_DIR=\\\"$HOME/\",\n\t\t{\"Pictures\", \"Изображения\", \"Photos\"}\n\t},\n\n\t{\n\t\t\"${DESKTOP}\",\n\t\t\"XDG_DESKTOP_DIR=\\\"$HOME/\",\n\t\t{\"Desktop\", \"Рабочий стол\", \"Bureau\"}\n\t},\n\n\t{\n\t\t\"${DOCUMENTS}\",\n\t\t\"XDG_DOCUMENTS_DIR=\\\"$HOME/\",\n\t\t{\"Documents\", \"Документы\", \"Documents\"}\n\t},\n\n\t{ 0 }\n};\n\n// return -1 if not found\nint macro_id(const char *;\n\n;\n\n\tint called_as_root = 0;\n\n\tif(geteuid() == 0)\n\t\tcalled_as_root = 1;\n\n\tif(called_as_root) {\n\t\tEUID_USER();\n\t}\n\n\tEUID_ASSERT();\n\n\t// Replace home macro\n\tchar *new_name = NULL;\n\tif (strncmp(path, \"${HOME}\", 7) == 0) {\n\t\tif (asprintf(&new_name, \"%s%s\", cfg.homedir, path + 7) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse if (*path == '~') {\n\t\tif (asprintf(&new_name, \"%s%s\", cfg.homedir, path + 1) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse if (strncmp(path, \"${CFG}\", 6) == 0) {\n\t\tif (asprintf(&new_name, \"%s%s\", SYSCONFDIR, path + 6) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse if (strncmp(path, \"${RUNUSER}\", 10) == 0) {\n\t\tif (asprintf(&new_name, \"/run/user/%u%s\", getuid(), path + 10) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tif(called_as_root)\n\t\t\tEUID_ROOT();\n\t\treturn new_name;\n\t}\n\telse {\n\t\tchar *directory = resolve_macro(path);\n\t\tif (directory) {\n\t\t\tif (asprintf(&new_name, \"%s/%s\", cfg.homedir, directory) == -1)\n\t\t\t\terrExit(\"asprintf\");\n\t\t\tif(called_as_root)\n\t\t\t\tEUID_ROOT();\n\t\t\tfree(directory);\n\t\t\treturn new_name;\n\t\t}\n\t}\n\n\tchar *rv = strdup(path);\n\tif (!rv)\n\t\terrExit(\"strdup\");\n\n\tif(called_as_root)\n\t\tEUID_ROOT();\n\n\treturn rv;\n}\n\nvoid invalid_filename(const char *fname, int globbi"
  },
  {
    "function_name": "int id = macr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
    "lines": "175-188",
    "snippet": "ULL;\n\tint id = macro_id(name);\n\tif (id == -1)\n\t\treturn NULL;\n\n\trv = resolve_xdg(macro[id].xdg);\n\tif (rv == NULL)\n\t\trv = resolve_hardcoded(macro[id].translation);\n\tif (rv && arg_debug)\n\t\tprintf(\"Directory %s resolved as %s\\n\", name, rv);\n\n\treturn rv;\n}\n\n// This function takes a pathname supplied by the u",
    "includes": [
      "#include <sys/stat.h>",
      "#include \"firejail.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Macro macro[] = {\n\t{\n\t\t\"${DOWNLOADS}\",\n\t\t\"XDG_DOWNLOAD_DIR=\\\"$HOME/\",\n\t\t{ \"Downloads\", \"Загрузки\", \"Téléchargement\" }\n\t},\n\n\t{\n\t \t\"${MUSIC}\",\n\t\t\"XDG_MUSIC_DIR=\\\"$HOME/\",\n\t\t{\"Music\", \"Музыка\", \"Musique\"}\n\t},\n\n\t{\n\t \t\"${VIDEOS}\",\n\t\t\"XDG_VIDEOS_DIR=\\\"$HOME/\",\n\t\t{\"Videos\", \"Видео\", \"Vidéos\"}\n\t},\n\n\t{\n\t \t\"${PICTURES}\",\n\t\t\"XDG_PICTURES_DIR=\\\"$HOME/\",\n\t\t{\"Pictures\", \"Изображения\", \"Photos\"}\n\t},\n\n\t{\n\t\t\"${DESKTOP}\",\n\t\t\"XDG_DESKTOP_DIR=\\\"$HOME/\",\n\t\t{\"Desktop\", \"Рабочий стол\", \"Bureau\"}\n\t},\n\n\t{\n\t\t\"${DOCUMENTS}\",\n\t\t\"XDG_DOCUMENTS_DIR=\\\"$HOME/\",\n\t\t{\"Documents\", \"Документы\", \"Documents\"}\n\t},\n\n\t{ 0 }\n};\n\n// return -1 if not found\nint macro_id(const char *"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "return",
          "args": [
            "rv;\n}\n\n// This function takes a",
            "athn",
            "e"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arg_debug)\n\t\tprin",
          "args": [
            "f(\"Directory %s resol"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esolve_hard",
          "args": [
            "oded(macro[id"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resolve_",
          "args": [
            "dg(m"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/stat.h>\n#include \"firejail.h\"\n\nMacro macro[] = {\n\t{\n\t\t\"${DOWNLOADS}\",\n\t\t\"XDG_DOWNLOAD_DIR=\\\"$HOME/\",\n\t\t{ \"Downloads\", \"Загрузки\", \"Téléchargement\" }\n\t},\n\n\t{\n\t \t\"${MUSIC}\",\n\t\t\"XDG_MUSIC_DIR=\\\"$HOME/\",\n\t\t{\"Music\", \"Музыка\", \"Musique\"}\n\t},\n\n\t{\n\t \t\"${VIDEOS}\",\n\t\t\"XDG_VIDEOS_DIR=\\\"$HOME/\",\n\t\t{\"Videos\", \"Видео\", \"Vidéos\"}\n\t},\n\n\t{\n\t \t\"${PICTURES}\",\n\t\t\"XDG_PICTURES_DIR=\\\"$HOME/\",\n\t\t{\"Pictures\", \"Изображения\", \"Photos\"}\n\t},\n\n\t{\n\t\t\"${DESKTOP}\",\n\t\t\"XDG_DESKTOP_DIR=\\\"$HOME/\",\n\t\t{\"Desktop\", \"Рабочий стол\", \"Bureau\"}\n\t},\n\n\t{\n\t\t\"${DOCUMENTS}\",\n\t\t\"XDG_DOCUMENTS_DIR=\\\"$HOME/\",\n\t\t{\"Documents\", \"Документы\", \"Documents\"}\n\t},\n\n\t{ 0 }\n};\n\n// return -1 if not found\nint macro_id(const char *;\n\nULL;\n\tint id = macro_id(name);\n\tif (id == -1)\n\t\treturn NULL;\n\n\trv = resolve_xdg(macro[id].xdg);\n\tif (rv == NULL)\n\t\trv = resolve_hardcoded(macro[id].translation);\n\tif (rv && arg_debug)\n\t\tprintf(\"Directory %s resolved as %s\\n\", name, rv);\n\n\treturn rv;\n}\n\n// This function takes a pathname supplied by the u"
  },
  {
    "function_name": "truct stat s;\n\n\ti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
    "lines": "151-172",
    "snippet": "ar *fname;\n\tstruct stat s;\n\n\tint i = 0;\n\twhile (entries[i] != NULL) {\n\t\tif (asprintf(&fname, \"%s/%s\", cfg.homedir, entries[i]) == -1)\n\t\t\terrExit(\"asprintf\");\n\n\t\tif (stat(fname, &s) == 0) {\n\t\t\tfree(fname);\n\t\t\tchar *rv = strdup(entries[i]);\n\t\t\tif (!rv)\n\t\t\t\terrExit(\"strdup\");\n\t\t\treturn rv;\n\t\t}\n\t\tfree(fname);\n\t\ti++;\n\t}\n\n\treturn NULL;\n}\n\n// returns mallocated memory\nchar *resolve_macro(co",
    "includes": [
      "#include <sys/stat.h>",
      "#include \"firejail.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "allo",
          "args": [
            "ated"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i++;",
          "args": [
            "retur"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n\t\t\tr",
          "args": [
            "turn rv;"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(!rv",
          "args": [],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str",
          "args": [
            "up(en",
            "ie"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free(",
          "args": [
            "name);"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "-1)",
          "args": [
            "rrExit",
            "asprint",
            ");\n\n\t\tif (s",
            "t(fname, &"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/stat.h>\n#include \"firejail.h\"\n\nar *fname;\n\tstruct stat s;\n\n\tint i = 0;\n\twhile (entries[i] != NULL) {\n\t\tif (asprintf(&fname, \"%s/%s\", cfg.homedir, entries[i]) == -1)\n\t\t\terrExit(\"asprintf\");\n\n\t\tif (stat(fname, &s) == 0) {\n\t\t\tfree(fname);\n\t\t\tchar *rv = strdup(entries[i]);\n\t\t\tif (!rv)\n\t\t\t\terrExit(\"strdup\");\n\t\t\treturn rv;\n\t\t}\n\t\tfree(fname);\n\t\ti++;\n\t}\n\n\treturn NULL;\n}\n\n// returns mallocated memory\nchar *resolve_macro(co"
  },
  {
    "function_name": "*fname;\n\tst",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
    "lines": "94-148",
    "snippet": "ERT();\n\tchar *fname;\n\tstruct stat s;\n\tsize_t length = strlen(var);\n\n\tif (asprintf(&fname, \"%s/.config/user-dirs.dirs\", cfg.homedir) == -1)\n\t\terrExit(\"asprintf\");\n\tFILE *fp = fopen(fname, \"r\");\n\tif (!fp) {\n\t\tfree(fname);\n\t\treturn NULL;\n\t}\n\tfree(fname);\n\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp)) {\n\t\tchar *ptr = buf;\n\n\t\t// skip blanks\n\t\twhile (*ptr == ' ' || *ptr == '\\t')\n\t\t\tptr++;\n\t\tif (*ptr == '\\0' || *ptr == '\\n' || *ptr == '#')\n\t\t\tcontinue;\n\n\t\tif (strncmp(ptr, var, length) == 0) {\n\t\t\tchar *ptr1 = ptr + length;\n\t\t\tchar *ptr2 = strchr(ptr1, '\"');\n\t\t\tif (ptr2) {\n\t\t\t\tfclose(fp);\n\t\t\t\t*ptr2 = '\\0';\n\t\t\t\tif (strlen(ptr1) != 0) {\n\t\t\t\t\tif (asprintf(&fname, \"%s/%s\", cfg.homedir, ptr1) == -1)\n\t\t\t\t\t\terrExit(\"asprintf\");\n\n\t\t\t\t\tif (stat(fname, &s) == -1) {\n\t\t\t\t\t\tfree(fname);\n\t\t\t\t\t\treturn NULL;\n\t\t\t\t\t}\n\t\t\t\t\tfree(fname);\n\n\t\t\t\t\tchar *rv = strdup(ptr1);\n\t\t\t\t\tif (!rv)\n\t\t\t\t\t\terrExit(ptr1);\n\t\t\t\t\treturn rv;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\treturn NULL;\n\t\t\t}\n\t\t}\n\t}\n\n\tfclose(fp);\n\treturn NULL;\n}\n\n// returns mallocated memory\nstatic char *resolve_h",
    "includes": [
      "#include <sys/stat.h>",
      "#include \"firejail.h\""
    ],
    "macros_used": [
      "#define MAXBUF 4098"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mory\ns",
          "args": [
            "at"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "turn NU",
          "args": [
            "L;"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "retur",
          "args": [
            "rv;"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "!rv)",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e);",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urn",
          "args": [
            "ULL;"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "{",
          "args": [
            "free(fnam"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "err",
          "args": [
            "xit(\"a",
            "rintf\")",
            "if (s",
            "t(fn"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "errLogExit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/util.c",
          "lines": "40-57",
          "snippet": "void errLogExit(char* fmt, ...) {\n\tva_list args;\n\tva_start(args,fmt);\n\topenlog(\"firejail\", LOG_NDELAY | LOG_PID, LOG_AUTH);\n\tMountData *m = get_last_mount();\n\n\tchar *msg1;\n\tchar *msg2  = \"Access error\";\n\tif (vasprintf(&msg1, fmt, args) != -1 &&\n\t    asprintf(&msg2, \"Access error: pid %d, last mount name:%s dir:%s type:%s - %s\", getuid(), m->fsname, m->dir, m->fstype, msg1) != -1)\n\t\tsyslog(LOG_CRIT, \"%s\", msg2);\n\tva_end(args);\n\tcloselog();\n\n\tsleep(2);\n\tfprintf(stderr, \"%s\\n\", msg2);\n\texit(1);\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <termios.h>",
            "#include <sys/ioctl.h>",
            "#include <grp.h>",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <syslog.h>",
            "#include <sys/mount.h>",
            "#include <sys/stat.h>",
            "#include <ftw.h>",
            "#include \"firejail.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <sys/wait.h>\n#include <termios.h>\n#include <sys/ioctl.h>\n#include <grp.h>\n#include <dirent.h>\n#include <errno.h>\n#include <syslog.h>\n#include <sys/mount.h>\n#include <sys/stat.h>\n#include <ftw.h>\n#include \"firejail.h\"\n\nvoid errLogExit(char* fmt, ...) {\n\tva_list args;\n\tva_start(args,fmt);\n\topenlog(\"firejail\", LOG_NDELAY | LOG_PID, LOG_AUTH);\n\tMountData *m = get_last_mount();\n\n\tchar *msg1;\n\tchar *msg2  = \"Access error\";\n\tif (vasprintf(&msg1, fmt, args) != -1 &&\n\t    asprintf(&msg2, \"Access error: pid %d, last mount name:%s dir:%s type:%s - %s\", getuid(), m->fsname, m->dir, m->fstype, msg1) != -1)\n\t\tsyslog(LOG_CRIT, \"%s\", msg2);\n\tva_end(args);\n\tcloselog();\n\n\tsleep(2);\n\tfprintf(stderr, \"%s\\n\", msg2);\n\texit(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "\", cfg",
          "args": [
            "home"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "0) {",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "*ptr2",
          "args": [
            "= '\\",
            ";"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "+ leng",
          "args": [
            "h;",
            "ch",
            "*ptr2"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip bl",
          "args": [
            "nks",
            "while",
            "*p"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AXBU",
          "args": [
            ", fp)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uf[M",
          "args": [
            "XBUF]"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "n NUL",
          "args": [
            ";\n\t}",
            "ree"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "if (!fp",
          "args": [
            "{\n\t\tfree("
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "edir) ==",
          "args": [
            "-1)",
            "rExit(\"asprintf\");\n\tFILE *f",
            "= fopen(fna"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirs.d",
          "args": [
            "rs\""
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "length = st",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/stat.h>\n#include \"firejail.h\"\n\n#define MAXBUF 4098\n\nERT();\n\tchar *fname;\n\tstruct stat s;\n\tsize_t length = strlen(var);\n\n\tif (asprintf(&fname, \"%s/.config/user-dirs.dirs\", cfg.homedir) == -1)\n\t\terrExit(\"asprintf\");\n\tFILE *fp = fopen(fname, \"r\");\n\tif (!fp) {\n\t\tfree(fname);\n\t\treturn NULL;\n\t}\n\tfree(fname);\n\n\tchar buf[MAXBUF];\n\twhile (fgets(buf, MAXBUF, fp)) {\n\t\tchar *ptr = buf;\n\n\t\t// skip blanks\n\t\twhile (*ptr == ' ' || *ptr == '\\t')\n\t\t\tptr++;\n\t\tif (*ptr == '\\0' || *ptr == '\\n' || *ptr == '#')\n\t\t\tcontinue;\n\n\t\tif (strncmp(ptr, var, length) == 0) {\n\t\t\tchar *ptr1 = ptr + length;\n\t\t\tchar *ptr2 = strchr(ptr1, '\"');\n\t\t\tif (ptr2) {\n\t\t\t\tfclose(fp);\n\t\t\t\t*ptr2 = '\\0';\n\t\t\t\tif (strlen(ptr1) != 0) {\n\t\t\t\t\tif (asprintf(&fname, \"%s/%s\", cfg.homedir, ptr1) == -1)\n\t\t\t\t\t\terrExit(\"asprintf\");\n\n\t\t\t\t\tif (stat(fname, &s) == -1) {\n\t\t\t\t\t\tfree(fname);\n\t\t\t\t\t\treturn NULL;\n\t\t\t\t\t}\n\t\t\t\t\tfree(fname);\n\n\t\t\t\t\tchar *rv = strdup(ptr1);\n\t\t\t\t\tif (!rv)\n\t\t\t\t\t\terrExit(ptr1);\n\t\t\t\t\treturn rv;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\treturn NULL;\n\t\t\t}\n\t\t}\n\t}\n\n\tfclose(fp);\n\treturn NULL;\n}\n\n// returns mallocated memory\nstatic char *resolve_h"
  },
  {
    "function_name": "= strlen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
    "lines": "83-91",
    "snippet": "len = strlen(name);\n\tif (len <= 4)\n\t\treturn 0;\n\tif (*name == '$' && name[1] == '{' && name[len - 1] == '}')\n\t\treturn 1;\n\treturn 0;\n}\n\n// returns mallocated memory\nstatic char *resolve_x",
    "includes": [
      "#include <sys/stat.h>",
      "#include \"firejail.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "= '$'",
          "args": [
            "& na"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ret",
          "args": [
            "rn 0"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/stat.h>\n#include \"firejail.h\"\n\nlen = strlen(name);\n\tif (len <= 4)\n\t\treturn 0;\n\tif (*name == '$' && name[1] == '{' && name[len - 1] == '}')\n\t\treturn 1;\n\treturn 0;\n}\n\n// returns mallocated memory\nstatic char *resolve_x"
  },
  {
    "function_name": "o[i].nam",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-12589/repo/src/firejail/macros.c",
    "lines": "72-81",
    "snippet": "macro[i].name != NULL) {\n\t\tif (strcmp(name, macro[i].name) == 0)\n\t\t\treturn i;\n\t\ti++;\n\t}\n\n\treturn -1;\n}\n\nint is_macro(const char *name) {\n\tassert(name);\n\tin",
    "includes": [
      "#include <sys/stat.h>",
      "#include \"firejail.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Macro macro[] = {\n\t{\n\t\t\"${DOWNLOADS}\",\n\t\t\"XDG_DOWNLOAD_DIR=\\\"$HOME/\",\n\t\t{ \"Downloads\", \"Загрузки\", \"Téléchargement\" }\n\t},\n\n\t{\n\t \t\"${MUSIC}\",\n\t\t\"XDG_MUSIC_DIR=\\\"$HOME/\",\n\t\t{\"Music\", \"Музыка\", \"Musique\"}\n\t},\n\n\t{\n\t \t\"${VIDEOS}\",\n\t\t\"XDG_VIDEOS_DIR=\\\"$HOME/\",\n\t\t{\"Videos\", \"Видео\", \"Vidéos\"}\n\t},\n\n\t{\n\t \t\"${PICTURES}\",\n\t\t\"XDG_PICTURES_DIR=\\\"$HOME/\",\n\t\t{\"Pictures\", \"Изображения\", \"Photos\"}\n\t},\n\n\t{\n\t\t\"${DESKTOP}\",\n\t\t\"XDG_DESKTOP_DIR=\\\"$HOME/\",\n\t\t{\"Desktop\", \"Рабочий стол\", \"Bureau\"}\n\t},\n\n\t{\n\t\t\"${DOCUMENTS}\",\n\t\t\"XDG_DOCUMENTS_DIR=\\\"$HOME/\",\n\t\t{\"Documents\", \"Документы\", \"Documents\"}\n\t},\n\n\t{ 0 }\n};\n\n// return -1 if not found\nint macro_id(const char *"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "}",
          "args": [
            "etur",
            "-1;\n}\n\nint is"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/stat.h>\n#include \"firejail.h\"\n\nMacro macro[] = {\n\t{\n\t\t\"${DOWNLOADS}\",\n\t\t\"XDG_DOWNLOAD_DIR=\\\"$HOME/\",\n\t\t{ \"Downloads\", \"Загрузки\", \"Téléchargement\" }\n\t},\n\n\t{\n\t \t\"${MUSIC}\",\n\t\t\"XDG_MUSIC_DIR=\\\"$HOME/\",\n\t\t{\"Music\", \"Музыка\", \"Musique\"}\n\t},\n\n\t{\n\t \t\"${VIDEOS}\",\n\t\t\"XDG_VIDEOS_DIR=\\\"$HOME/\",\n\t\t{\"Videos\", \"Видео\", \"Vidéos\"}\n\t},\n\n\t{\n\t \t\"${PICTURES}\",\n\t\t\"XDG_PICTURES_DIR=\\\"$HOME/\",\n\t\t{\"Pictures\", \"Изображения\", \"Photos\"}\n\t},\n\n\t{\n\t\t\"${DESKTOP}\",\n\t\t\"XDG_DESKTOP_DIR=\\\"$HOME/\",\n\t\t{\"Desktop\", \"Рабочий стол\", \"Bureau\"}\n\t},\n\n\t{\n\t\t\"${DOCUMENTS}\",\n\t\t\"XDG_DOCUMENTS_DIR=\\\"$HOME/\",\n\t\t{\"Documents\", \"Документы\", \"Documents\"}\n\t},\n\n\t{ 0 }\n};\n\n// return -1 if not found\nint macro_id(const char *;\n\nmacro[i].name != NULL) {\n\t\tif (strcmp(name, macro[i].name) == 0)\n\t\t\treturn i;\n\t\ti++;\n\t}\n\n\treturn -1;\n}\n\nint is_macro(const char *name) {\n\tassert(name);\n\tin"
  }
]