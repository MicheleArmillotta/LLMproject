[
  {
    "function_name": "get_fixed_pmc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
    "lines": "90-98",
    "snippet": "static inline struct kvm_pmc *get_fixed_pmc(struct kvm_pmu *pmu, u32 msr)\n{\n\tint base = MSR_CORE_PERF_FIXED_CTR0;\n\n\tif (msr >= base && msr < base + pmu->nr_arch_fixed_counters)\n\t\treturn &pmu->fixed_counters[msr - base];\n\n\treturn NULL;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline struct kvm_pmc *get_fixed_pmc(struct kvm_pmu *pmu, u32 msr)\n{\n\tint base = MSR_CORE_PERF_FIXED_CTR0;\n\n\tif (msr >= base && msr < base + pmu->nr_arch_fixed_counters)\n\t\treturn &pmu->fixed_counters[msr - base];\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "get_gp_pmc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
    "lines": "80-87",
    "snippet": "static inline struct kvm_pmc *get_gp_pmc(struct kvm_pmu *pmu, u32 msr,\n\t\t\t\t\t u32 base)\n{\n\tif (msr >= base && msr < base + pmu->nr_arch_gp_counters)\n\t\treturn &pmu->gp_counters[msr - base];\n\n\treturn NULL;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline struct kvm_pmc *get_gp_pmc(struct kvm_pmu *pmu, u32 msr,\n\t\t\t\t\t u32 base)\n{\n\tif (msr >= base && msr < base + pmu->nr_arch_gp_counters)\n\t\treturn &pmu->gp_counters[msr - base];\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "pmc_is_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
    "lines": "71-74",
    "snippet": "static inline bool pmc_is_enabled(struct kvm_pmc *pmc)\n{\n\treturn kvm_x86_ops->pmu_ops->pmc_is_enabled(pmc);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_x86_ops->pmu_ops->pmc_is_enabled",
          "args": [
            "pmc"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "pmc_is_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
          "lines": "71-74",
          "snippet": "static inline bool pmc_is_enabled(struct kvm_pmc *pmc)\n{\n\treturn kvm_x86_ops->pmu_ops->pmc_is_enabled(pmc);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "static inline bool pmc_is_enabled(struct kvm_pmc *pmc)\n{\n\treturn kvm_x86_ops->pmu_ops->pmc_is_enabled(pmc);\n}"
  },
  {
    "function_name": "pmc_is_fixed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
    "lines": "66-69",
    "snippet": "static inline bool pmc_is_fixed(struct kvm_pmc *pmc)\n{\n\treturn pmc->type == KVM_PMC_FIXED;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline bool pmc_is_fixed(struct kvm_pmc *pmc)\n{\n\treturn pmc->type == KVM_PMC_FIXED;\n}"
  },
  {
    "function_name": "pmc_is_gp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
    "lines": "61-64",
    "snippet": "static inline bool pmc_is_gp(struct kvm_pmc *pmc)\n{\n\treturn pmc->type == KVM_PMC_GP;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline bool pmc_is_gp(struct kvm_pmc *pmc)\n{\n\treturn pmc->type == KVM_PMC_GP;\n}"
  },
  {
    "function_name": "pmc_stop_counter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
    "lines": "52-59",
    "snippet": "static inline void pmc_stop_counter(struct kvm_pmc *pmc)\n{\n\tif (pmc->perf_event) {\n\t\tpmc->counter = pmc_read_counter(pmc);\n\t\tperf_event_release_kernel(pmc->perf_event);\n\t\tpmc->perf_event = NULL;\n\t}\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "perf_event_release_kernel",
          "args": [
            "pmc->perf_event"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmc_read_counter",
          "args": [
            "pmc"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "pmc_read_counter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
          "lines": "40-50",
          "snippet": "static inline u64 pmc_read_counter(struct kvm_pmc *pmc)\n{\n\tu64 counter, enabled, running;\n\n\tcounter = pmc->counter;\n\tif (pmc->perf_event)\n\t\tcounter += perf_event_read_value(pmc->perf_event,\n\t\t\t\t\t\t &enabled, &running);\n\t/* FIXME: Scaling needed? */\n\treturn counter & pmc_bitmask(pmc);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u64 pmc_read_counter(struct kvm_pmc *pmc)\n{\n\tu64 counter, enabled, running;\n\n\tcounter = pmc->counter;\n\tif (pmc->perf_event)\n\t\tcounter += perf_event_read_value(pmc->perf_event,\n\t\t\t\t\t\t &enabled, &running);\n\t/* FIXME: Scaling needed? */\n\treturn counter & pmc_bitmask(pmc);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void pmc_stop_counter(struct kvm_pmc *pmc)\n{\n\tif (pmc->perf_event) {\n\t\tpmc->counter = pmc_read_counter(pmc);\n\t\tperf_event_release_kernel(pmc->perf_event);\n\t\tpmc->perf_event = NULL;\n\t}\n}"
  },
  {
    "function_name": "pmc_read_counter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
    "lines": "40-50",
    "snippet": "static inline u64 pmc_read_counter(struct kvm_pmc *pmc)\n{\n\tu64 counter, enabled, running;\n\n\tcounter = pmc->counter;\n\tif (pmc->perf_event)\n\t\tcounter += perf_event_read_value(pmc->perf_event,\n\t\t\t\t\t\t &enabled, &running);\n\t/* FIXME: Scaling needed? */\n\treturn counter & pmc_bitmask(pmc);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pmc_bitmask",
          "args": [
            "pmc"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "pmc_bitmask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
          "lines": "33-38",
          "snippet": "static inline u64 pmc_bitmask(struct kvm_pmc *pmc)\n{\n\tstruct kvm_pmu *pmu = pmc_to_pmu(pmc);\n\n\treturn pmu->counter_bitmask[pmc->type];\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u64 pmc_bitmask(struct kvm_pmc *pmc)\n{\n\tstruct kvm_pmu *pmu = pmc_to_pmu(pmc);\n\n\treturn pmu->counter_bitmask[pmc->type];\n}"
        }
      },
      {
        "call_info": {
          "callee": "perf_event_read_value",
          "args": [
            "pmc->perf_event",
            "&enabled",
            "&running"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline u64 pmc_read_counter(struct kvm_pmc *pmc)\n{\n\tu64 counter, enabled, running;\n\n\tcounter = pmc->counter;\n\tif (pmc->perf_event)\n\t\tcounter += perf_event_read_value(pmc->perf_event,\n\t\t\t\t\t\t &enabled, &running);\n\t/* FIXME: Scaling needed? */\n\treturn counter & pmc_bitmask(pmc);\n}"
  },
  {
    "function_name": "pmc_bitmask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/pmu.h",
    "lines": "33-38",
    "snippet": "static inline u64 pmc_bitmask(struct kvm_pmc *pmc)\n{\n\tstruct kvm_pmu *pmu = pmc_to_pmu(pmc);\n\n\treturn pmu->counter_bitmask[pmc->type];\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pmc_to_pmu",
          "args": [
            "pmc"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline u64 pmc_bitmask(struct kvm_pmc *pmc)\n{\n\tstruct kvm_pmu *pmu = pmc_to_pmu(pmc);\n\n\treturn pmu->counter_bitmask[pmc->type];\n}"
  }
]