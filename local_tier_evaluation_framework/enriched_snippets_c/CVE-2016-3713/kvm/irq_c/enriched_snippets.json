[
  {
    "function_name": "__kvm_migrate_timers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
    "lines": "148-152",
    "snippet": "void __kvm_migrate_timers(struct kvm_vcpu *vcpu)\n{\n\t__kvm_migrate_apic_timer(vcpu);\n\t__kvm_migrate_pit_timer(vcpu);\n}",
    "includes": [
      "#include \"x86.h\"",
      "#include \"i8254.h\"",
      "#include \"irq.h\"",
      "#include <linux/kvm_host.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__kvm_migrate_pit_timer",
          "args": [
            "vcpu"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "__kvm_migrate_pit_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/i8254.c",
          "lines": "218-231",
          "snippet": "void __kvm_migrate_pit_timer(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_pit *pit = vcpu->kvm->arch.vpit;\n\tstruct hrtimer *timer;\n\n\tif (!kvm_vcpu_is_bsp(vcpu) || !pit)\n\t\treturn;\n\n\ttimer = &pit->pit_state.timer;\n\tmutex_lock(&pit->pit_state.lock);\n\tif (hrtimer_cancel(timer))\n\t\thrtimer_start_expires(timer, HRTIMER_MODE_ABS);\n\tmutex_unlock(&pit->pit_state.lock);\n}",
          "includes": [
            "#include \"x86.h\"",
            "#include \"i8254.h\"",
            "#include \"irq.h\"",
            "#include \"ioapic.h\"",
            "#include <linux/slab.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include \"ioapic.h\"\n#include <linux/slab.h>\n#include <linux/kvm_host.h>\n\nvoid __kvm_migrate_pit_timer(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_pit *pit = vcpu->kvm->arch.vpit;\n\tstruct hrtimer *timer;\n\n\tif (!kvm_vcpu_is_bsp(vcpu) || !pit)\n\t\treturn;\n\n\ttimer = &pit->pit_state.timer;\n\tmutex_lock(&pit->pit_state.lock);\n\tif (hrtimer_cancel(timer))\n\t\thrtimer_start_expires(timer, HRTIMER_MODE_ABS);\n\tmutex_unlock(&pit->pit_state.lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__kvm_migrate_apic_timer",
          "args": [
            "vcpu"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "__kvm_migrate_apic_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.c",
          "lines": "1978-1988",
          "snippet": "void __kvm_migrate_apic_timer(struct kvm_vcpu *vcpu)\n{\n\tstruct hrtimer *timer;\n\n\tif (!lapic_in_kernel(vcpu))\n\t\treturn;\n\n\ttimer = &vcpu->arch.apic->lapic_timer.timer;\n\tif (hrtimer_cancel(timer))\n\t\thrtimer_start_expires(timer, HRTIMER_MODE_ABS_PINNED);\n}",
          "includes": [
            "#include \"hyperv.h\"",
            "#include \"cpuid.h\"",
            "#include \"x86.h\"",
            "#include \"trace.h\"",
            "#include \"irq.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include <linux/jump_label.h>",
            "#include <linux/atomic.h>",
            "#include <asm/delay.h>",
            "#include <asm/apicdef.h>",
            "#include <asm/current.h>",
            "#include <asm/page.h>",
            "#include <asm/msr.h>",
            "#include <asm/processor.h>",
            "#include <linux/slab.h>",
            "#include <linux/math64.h>",
            "#include <linux/module.h>",
            "#include <linux/io.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/smp.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/kvm.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hyperv.h\"\n#include \"cpuid.h\"\n#include \"x86.h\"\n#include \"trace.h\"\n#include \"irq.h\"\n#include \"kvm_cache_regs.h\"\n#include <linux/jump_label.h>\n#include <linux/atomic.h>\n#include <asm/delay.h>\n#include <asm/apicdef.h>\n#include <asm/current.h>\n#include <asm/page.h>\n#include <asm/msr.h>\n#include <asm/processor.h>\n#include <linux/slab.h>\n#include <linux/math64.h>\n#include <linux/module.h>\n#include <linux/io.h>\n#include <linux/hrtimer.h>\n#include <linux/smp.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/kvm.h>\n#include <linux/kvm_host.h>\n\nvoid __kvm_migrate_apic_timer(struct kvm_vcpu *vcpu)\n{\n\tstruct hrtimer *timer;\n\n\tif (!lapic_in_kernel(vcpu))\n\t\treturn;\n\n\ttimer = &vcpu->arch.apic->lapic_timer.timer;\n\tif (hrtimer_cancel(timer))\n\t\thrtimer_start_expires(timer, HRTIMER_MODE_ABS_PINNED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nvoid __kvm_migrate_timers(struct kvm_vcpu *vcpu)\n{\n\t__kvm_migrate_apic_timer(vcpu);\n\t__kvm_migrate_pit_timer(vcpu);\n}"
  },
  {
    "function_name": "kvm_inject_pending_timer_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
    "lines": "141-145",
    "snippet": "void kvm_inject_pending_timer_irqs(struct kvm_vcpu *vcpu)\n{\n\tif (lapic_in_kernel(vcpu))\n\t\tkvm_inject_apic_timer_irqs(vcpu);\n}",
    "includes": [
      "#include \"x86.h\"",
      "#include \"i8254.h\"",
      "#include \"irq.h\"",
      "#include <linux/kvm_host.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_inject_apic_timer_irqs",
          "args": [
            "vcpu"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_inject_apic_timer_irqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.c",
          "lines": "1901-1911",
          "snippet": "void kvm_inject_apic_timer_irqs(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\n\tif (atomic_read(&apic->lapic_timer.pending) > 0) {\n\t\tkvm_apic_local_deliver(apic, APIC_LVTT);\n\t\tif (apic_lvtt_tscdeadline(apic))\n\t\t\tapic->lapic_timer.tscdeadline = 0;\n\t\tatomic_set(&apic->lapic_timer.pending, 0);\n\t}\n}",
          "includes": [
            "#include \"hyperv.h\"",
            "#include \"cpuid.h\"",
            "#include \"x86.h\"",
            "#include \"trace.h\"",
            "#include \"irq.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include <linux/jump_label.h>",
            "#include <linux/atomic.h>",
            "#include <asm/delay.h>",
            "#include <asm/apicdef.h>",
            "#include <asm/current.h>",
            "#include <asm/page.h>",
            "#include <asm/msr.h>",
            "#include <asm/processor.h>",
            "#include <linux/slab.h>",
            "#include <linux/math64.h>",
            "#include <linux/module.h>",
            "#include <linux/io.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/smp.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/kvm.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hyperv.h\"\n#include \"cpuid.h\"\n#include \"x86.h\"\n#include \"trace.h\"\n#include \"irq.h\"\n#include \"kvm_cache_regs.h\"\n#include <linux/jump_label.h>\n#include <linux/atomic.h>\n#include <asm/delay.h>\n#include <asm/apicdef.h>\n#include <asm/current.h>\n#include <asm/page.h>\n#include <asm/msr.h>\n#include <asm/processor.h>\n#include <linux/slab.h>\n#include <linux/math64.h>\n#include <linux/module.h>\n#include <linux/io.h>\n#include <linux/hrtimer.h>\n#include <linux/smp.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/kvm.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_inject_apic_timer_irqs(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\n\tif (atomic_read(&apic->lapic_timer.pending) > 0) {\n\t\tkvm_apic_local_deliver(apic, APIC_LVTT);\n\t\tif (apic_lvtt_tscdeadline(apic))\n\t\t\tapic->lapic_timer.tscdeadline = 0;\n\t\tatomic_set(&apic->lapic_timer.pending, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "lapic_in_kernel",
          "args": [
            "vcpu"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "lapic_in_kernel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.h",
          "lines": "141-146",
          "snippet": "static inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}",
          "includes": [
            "#include <linux/kvm_host.h>",
            "#include <kvm/iodev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n#include <kvm/iodev.h>\n\nstatic inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nvoid kvm_inject_pending_timer_irqs(struct kvm_vcpu *vcpu)\n{\n\tif (lapic_in_kernel(vcpu))\n\t\tkvm_inject_apic_timer_irqs(vcpu);\n}"
  },
  {
    "function_name": "kvm_cpu_get_interrupt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
    "lines": "125-138",
    "snippet": "int kvm_cpu_get_interrupt(struct kvm_vcpu *v)\n{\n\tint vector;\n\n\tif (!lapic_in_kernel(v))\n\t\treturn v->arch.interrupt.nr;\n\n\tvector = kvm_cpu_get_extint(v);\n\n\tif (vector != -1)\n\t\treturn vector;\t\t\t/* PIC */\n\n\treturn kvm_get_apic_interrupt(v);\t/* APIC */\n}",
    "includes": [
      "#include \"x86.h\"",
      "#include \"i8254.h\"",
      "#include \"irq.h\"",
      "#include <linux/kvm_host.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_get_apic_interrupt",
          "args": [
            "v"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_get_apic_interrupt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.c",
          "lines": "1913-1938",
          "snippet": "int kvm_get_apic_interrupt(struct kvm_vcpu *vcpu)\n{\n\tint vector = kvm_apic_has_interrupt(vcpu);\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\n\tif (vector == -1)\n\t\treturn -1;\n\n\t/*\n\t * We get here even with APIC virtualization enabled, if doing\n\t * nested virtualization and L1 runs with the \"acknowledge interrupt\n\t * on exit\" mode.  Then we cannot inject the interrupt via RVI,\n\t * because the process would deliver it through the IDT.\n\t */\n\n\tapic_set_isr(vector, apic);\n\tapic_update_ppr(apic);\n\tapic_clear_irr(vector, apic);\n\n\tif (test_bit(vector, vcpu_to_synic(vcpu)->auto_eoi_bitmap)) {\n\t\tapic_clear_isr(vector, apic);\n\t\tapic_update_ppr(apic);\n\t}\n\n\treturn vector;\n}",
          "includes": [
            "#include \"hyperv.h\"",
            "#include \"cpuid.h\"",
            "#include \"x86.h\"",
            "#include \"trace.h\"",
            "#include \"irq.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include <linux/jump_label.h>",
            "#include <linux/atomic.h>",
            "#include <asm/delay.h>",
            "#include <asm/apicdef.h>",
            "#include <asm/current.h>",
            "#include <asm/page.h>",
            "#include <asm/msr.h>",
            "#include <asm/processor.h>",
            "#include <linux/slab.h>",
            "#include <linux/math64.h>",
            "#include <linux/module.h>",
            "#include <linux/io.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/smp.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/kvm.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hyperv.h\"\n#include \"cpuid.h\"\n#include \"x86.h\"\n#include \"trace.h\"\n#include \"irq.h\"\n#include \"kvm_cache_regs.h\"\n#include <linux/jump_label.h>\n#include <linux/atomic.h>\n#include <asm/delay.h>\n#include <asm/apicdef.h>\n#include <asm/current.h>\n#include <asm/page.h>\n#include <asm/msr.h>\n#include <asm/processor.h>\n#include <linux/slab.h>\n#include <linux/math64.h>\n#include <linux/module.h>\n#include <linux/io.h>\n#include <linux/hrtimer.h>\n#include <linux/smp.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/kvm.h>\n#include <linux/kvm_host.h>\n\nint kvm_get_apic_interrupt(struct kvm_vcpu *vcpu)\n{\n\tint vector = kvm_apic_has_interrupt(vcpu);\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\n\tif (vector == -1)\n\t\treturn -1;\n\n\t/*\n\t * We get here even with APIC virtualization enabled, if doing\n\t * nested virtualization and L1 runs with the \"acknowledge interrupt\n\t * on exit\" mode.  Then we cannot inject the interrupt via RVI,\n\t * because the process would deliver it through the IDT.\n\t */\n\n\tapic_set_isr(vector, apic);\n\tapic_update_ppr(apic);\n\tapic_clear_irr(vector, apic);\n\n\tif (test_bit(vector, vcpu_to_synic(vcpu)->auto_eoi_bitmap)) {\n\t\tapic_clear_isr(vector, apic);\n\t\tapic_update_ppr(apic);\n\t}\n\n\treturn vector;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvm_cpu_get_extint",
          "args": [
            "v"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_cpu_get_extint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
          "lines": "108-120",
          "snippet": "static int kvm_cpu_get_extint(struct kvm_vcpu *v)\n{\n\tif (kvm_cpu_has_extint(v)) {\n\t\tif (irqchip_split(v->kvm)) {\n\t\t\tint vector = v->arch.pending_external_vector;\n\n\t\t\tv->arch.pending_external_vector = -1;\n\t\t\treturn vector;\n\t\t} else\n\t\t\treturn kvm_pic_read_irq(v->kvm); /* PIC */\n\t} else\n\t\treturn -1;\n}",
          "includes": [
            "#include \"x86.h\"",
            "#include \"i8254.h\"",
            "#include \"irq.h\"",
            "#include <linux/kvm_host.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nstatic int kvm_cpu_get_extint(struct kvm_vcpu *v)\n{\n\tif (kvm_cpu_has_extint(v)) {\n\t\tif (irqchip_split(v->kvm)) {\n\t\t\tint vector = v->arch.pending_external_vector;\n\n\t\t\tv->arch.pending_external_vector = -1;\n\t\t\treturn vector;\n\t\t} else\n\t\t\treturn kvm_pic_read_irq(v->kvm); /* PIC */\n\t} else\n\t\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lapic_in_kernel",
          "args": [
            "v"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "lapic_in_kernel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.h",
          "lines": "141-146",
          "snippet": "static inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}",
          "includes": [
            "#include <linux/kvm_host.h>",
            "#include <kvm/iodev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n#include <kvm/iodev.h>\n\nstatic inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nint kvm_cpu_get_interrupt(struct kvm_vcpu *v)\n{\n\tint vector;\n\n\tif (!lapic_in_kernel(v))\n\t\treturn v->arch.interrupt.nr;\n\n\tvector = kvm_cpu_get_extint(v);\n\n\tif (vector != -1)\n\t\treturn vector;\t\t\t/* PIC */\n\n\treturn kvm_get_apic_interrupt(v);\t/* APIC */\n}"
  },
  {
    "function_name": "kvm_cpu_get_extint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
    "lines": "108-120",
    "snippet": "static int kvm_cpu_get_extint(struct kvm_vcpu *v)\n{\n\tif (kvm_cpu_has_extint(v)) {\n\t\tif (irqchip_split(v->kvm)) {\n\t\t\tint vector = v->arch.pending_external_vector;\n\n\t\t\tv->arch.pending_external_vector = -1;\n\t\t\treturn vector;\n\t\t} else\n\t\t\treturn kvm_pic_read_irq(v->kvm); /* PIC */\n\t} else\n\t\treturn -1;\n}",
    "includes": [
      "#include \"x86.h\"",
      "#include \"i8254.h\"",
      "#include \"irq.h\"",
      "#include <linux/kvm_host.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_pic_read_irq",
          "args": [
            "v->kvm"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_pic_read_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/i8259.c",
          "lines": "239-274",
          "snippet": "int kvm_pic_read_irq(struct kvm *kvm)\n{\n\tint irq, irq2, intno;\n\tstruct kvm_pic *s = pic_irqchip(kvm);\n\n\ts->output = 0;\n\n\tpic_lock(s);\n\tirq = pic_get_irq(&s->pics[0]);\n\tif (irq >= 0) {\n\t\tpic_intack(&s->pics[0], irq);\n\t\tif (irq == 2) {\n\t\t\tirq2 = pic_get_irq(&s->pics[1]);\n\t\t\tif (irq2 >= 0)\n\t\t\t\tpic_intack(&s->pics[1], irq2);\n\t\t\telse\n\t\t\t\t/*\n\t\t\t\t * spurious IRQ on slave controller\n\t\t\t\t */\n\t\t\t\tirq2 = 7;\n\t\t\tintno = s->pics[1].irq_base + irq2;\n\t\t\tirq = irq2 + 8;\n\t\t} else\n\t\t\tintno = s->pics[0].irq_base + irq;\n\t} else {\n\t\t/*\n\t\t * spurious IRQ on host controller\n\t\t */\n\t\tirq = 7;\n\t\tintno = s->pics[0].irq_base + irq;\n\t}\n\tpic_update_irq(s);\n\tpic_unlock(s);\n\n\treturn intno;\n}",
          "includes": [
            "#include \"trace.h\"",
            "#include <linux/kvm_host.h>",
            "#include \"irq.h\"",
            "#include <linux/bitops.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace.h\"\n#include <linux/kvm_host.h>\n#include \"irq.h\"\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nint kvm_pic_read_irq(struct kvm *kvm)\n{\n\tint irq, irq2, intno;\n\tstruct kvm_pic *s = pic_irqchip(kvm);\n\n\ts->output = 0;\n\n\tpic_lock(s);\n\tirq = pic_get_irq(&s->pics[0]);\n\tif (irq >= 0) {\n\t\tpic_intack(&s->pics[0], irq);\n\t\tif (irq == 2) {\n\t\t\tirq2 = pic_get_irq(&s->pics[1]);\n\t\t\tif (irq2 >= 0)\n\t\t\t\tpic_intack(&s->pics[1], irq2);\n\t\t\telse\n\t\t\t\t/*\n\t\t\t\t * spurious IRQ on slave controller\n\t\t\t\t */\n\t\t\t\tirq2 = 7;\n\t\t\tintno = s->pics[1].irq_base + irq2;\n\t\t\tirq = irq2 + 8;\n\t\t} else\n\t\t\tintno = s->pics[0].irq_base + irq;\n\t} else {\n\t\t/*\n\t\t * spurious IRQ on host controller\n\t\t */\n\t\tirq = 7;\n\t\tintno = s->pics[0].irq_base + irq;\n\t}\n\tpic_update_irq(s);\n\tpic_unlock(s);\n\n\treturn intno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irqchip_split",
          "args": [
            "v->kvm"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "irqchip_split",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.h",
          "lines": "94-97",
          "snippet": "static inline int irqchip_split(struct kvm *kvm)\n{\n\treturn kvm->arch.irqchip_split;\n}",
          "includes": [
            "#include \"lapic.h\"",
            "#include \"ioapic.h\"",
            "#include <kvm/iodev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/kvm_host.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/mm_types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lapic.h\"\n#include \"ioapic.h\"\n#include <kvm/iodev.h>\n#include <linux/spinlock.h>\n#include <linux/kvm_host.h>\n#include <linux/hrtimer.h>\n#include <linux/mm_types.h>\n\nstatic inline int irqchip_split(struct kvm *kvm)\n{\n\treturn kvm->arch.irqchip_split;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvm_cpu_has_extint",
          "args": [
            "v"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_cpu_has_extint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
          "lines": "55-66",
          "snippet": "static int kvm_cpu_has_extint(struct kvm_vcpu *v)\n{\n\tu8 accept = kvm_apic_accept_pic_intr(v);\n\n\tif (accept) {\n\t\tif (irqchip_split(v->kvm))\n\t\t\treturn pending_userspace_extint(v);\n\t\telse\n\t\t\treturn pic_irqchip(v->kvm)->output;\n\t} else\n\t\treturn 0;\n}",
          "includes": [
            "#include \"x86.h\"",
            "#include \"i8254.h\"",
            "#include \"irq.h\"",
            "#include <linux/kvm_host.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nstatic int kvm_cpu_has_extint(struct kvm_vcpu *v)\n{\n\tu8 accept = kvm_apic_accept_pic_intr(v);\n\n\tif (accept) {\n\t\tif (irqchip_split(v->kvm))\n\t\t\treturn pending_userspace_extint(v);\n\t\telse\n\t\t\treturn pic_irqchip(v->kvm)->output;\n\t} else\n\t\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nstatic int kvm_cpu_get_extint(struct kvm_vcpu *v)\n{\n\tif (kvm_cpu_has_extint(v)) {\n\t\tif (irqchip_split(v->kvm)) {\n\t\t\tint vector = v->arch.pending_external_vector;\n\n\t\t\tv->arch.pending_external_vector = -1;\n\t\t\treturn vector;\n\t\t} else\n\t\t\treturn kvm_pic_read_irq(v->kvm); /* PIC */\n\t} else\n\t\treturn -1;\n}"
  },
  {
    "function_name": "kvm_cpu_has_interrupt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
    "lines": "92-101",
    "snippet": "int kvm_cpu_has_interrupt(struct kvm_vcpu *v)\n{\n\tif (!lapic_in_kernel(v))\n\t\treturn v->arch.interrupt.pending;\n\n\tif (kvm_cpu_has_extint(v))\n\t\treturn 1;\n\n\treturn kvm_apic_has_interrupt(v) != -1;\t/* LAPIC */\n}",
    "includes": [
      "#include \"x86.h\"",
      "#include \"i8254.h\"",
      "#include \"irq.h\"",
      "#include <linux/kvm_host.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_apic_has_interrupt",
          "args": [
            "v"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_apic_has_interrupt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.c",
          "lines": "1872-1886",
          "snippet": "int kvm_apic_has_interrupt(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\tint highest_irr;\n\n\tif (!apic_enabled(apic))\n\t\treturn -1;\n\n\tapic_update_ppr(apic);\n\thighest_irr = apic_find_highest_irr(apic);\n\tif ((highest_irr == -1) ||\n\t    ((highest_irr & 0xF0) <= kvm_lapic_get_reg(apic, APIC_PROCPRI)))\n\t\treturn -1;\n\treturn highest_irr;\n}",
          "includes": [
            "#include \"hyperv.h\"",
            "#include \"cpuid.h\"",
            "#include \"x86.h\"",
            "#include \"trace.h\"",
            "#include \"irq.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include <linux/jump_label.h>",
            "#include <linux/atomic.h>",
            "#include <asm/delay.h>",
            "#include <asm/apicdef.h>",
            "#include <asm/current.h>",
            "#include <asm/page.h>",
            "#include <asm/msr.h>",
            "#include <asm/processor.h>",
            "#include <linux/slab.h>",
            "#include <linux/math64.h>",
            "#include <linux/module.h>",
            "#include <linux/io.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/smp.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/kvm.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hyperv.h\"\n#include \"cpuid.h\"\n#include \"x86.h\"\n#include \"trace.h\"\n#include \"irq.h\"\n#include \"kvm_cache_regs.h\"\n#include <linux/jump_label.h>\n#include <linux/atomic.h>\n#include <asm/delay.h>\n#include <asm/apicdef.h>\n#include <asm/current.h>\n#include <asm/page.h>\n#include <asm/msr.h>\n#include <asm/processor.h>\n#include <linux/slab.h>\n#include <linux/math64.h>\n#include <linux/module.h>\n#include <linux/io.h>\n#include <linux/hrtimer.h>\n#include <linux/smp.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/kvm.h>\n#include <linux/kvm_host.h>\n\nint kvm_apic_has_interrupt(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\tint highest_irr;\n\n\tif (!apic_enabled(apic))\n\t\treturn -1;\n\n\tapic_update_ppr(apic);\n\thighest_irr = apic_find_highest_irr(apic);\n\tif ((highest_irr == -1) ||\n\t    ((highest_irr & 0xF0) <= kvm_lapic_get_reg(apic, APIC_PROCPRI)))\n\t\treturn -1;\n\treturn highest_irr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvm_cpu_has_extint",
          "args": [
            "v"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_cpu_has_extint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
          "lines": "55-66",
          "snippet": "static int kvm_cpu_has_extint(struct kvm_vcpu *v)\n{\n\tu8 accept = kvm_apic_accept_pic_intr(v);\n\n\tif (accept) {\n\t\tif (irqchip_split(v->kvm))\n\t\t\treturn pending_userspace_extint(v);\n\t\telse\n\t\t\treturn pic_irqchip(v->kvm)->output;\n\t} else\n\t\treturn 0;\n}",
          "includes": [
            "#include \"x86.h\"",
            "#include \"i8254.h\"",
            "#include \"irq.h\"",
            "#include <linux/kvm_host.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nstatic int kvm_cpu_has_extint(struct kvm_vcpu *v)\n{\n\tu8 accept = kvm_apic_accept_pic_intr(v);\n\n\tif (accept) {\n\t\tif (irqchip_split(v->kvm))\n\t\t\treturn pending_userspace_extint(v);\n\t\telse\n\t\t\treturn pic_irqchip(v->kvm)->output;\n\t} else\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lapic_in_kernel",
          "args": [
            "v"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "lapic_in_kernel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.h",
          "lines": "141-146",
          "snippet": "static inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}",
          "includes": [
            "#include <linux/kvm_host.h>",
            "#include <kvm/iodev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n#include <kvm/iodev.h>\n\nstatic inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nint kvm_cpu_has_interrupt(struct kvm_vcpu *v)\n{\n\tif (!lapic_in_kernel(v))\n\t\treturn v->arch.interrupt.pending;\n\n\tif (kvm_cpu_has_extint(v))\n\t\treturn 1;\n\n\treturn kvm_apic_has_interrupt(v) != -1;\t/* LAPIC */\n}"
  },
  {
    "function_name": "kvm_cpu_has_injectable_intr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
    "lines": "74-86",
    "snippet": "int kvm_cpu_has_injectable_intr(struct kvm_vcpu *v)\n{\n\tif (!lapic_in_kernel(v))\n\t\treturn v->arch.interrupt.pending;\n\n\tif (kvm_cpu_has_extint(v))\n\t\treturn 1;\n\n\tif (kvm_vcpu_apicv_active(v))\n\t\treturn 0;\n\n\treturn kvm_apic_has_interrupt(v) != -1; /* LAPIC */\n}",
    "includes": [
      "#include \"x86.h\"",
      "#include \"i8254.h\"",
      "#include \"irq.h\"",
      "#include <linux/kvm_host.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_apic_has_interrupt",
          "args": [
            "v"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_apic_has_interrupt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.c",
          "lines": "1872-1886",
          "snippet": "int kvm_apic_has_interrupt(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\tint highest_irr;\n\n\tif (!apic_enabled(apic))\n\t\treturn -1;\n\n\tapic_update_ppr(apic);\n\thighest_irr = apic_find_highest_irr(apic);\n\tif ((highest_irr == -1) ||\n\t    ((highest_irr & 0xF0) <= kvm_lapic_get_reg(apic, APIC_PROCPRI)))\n\t\treturn -1;\n\treturn highest_irr;\n}",
          "includes": [
            "#include \"hyperv.h\"",
            "#include \"cpuid.h\"",
            "#include \"x86.h\"",
            "#include \"trace.h\"",
            "#include \"irq.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include <linux/jump_label.h>",
            "#include <linux/atomic.h>",
            "#include <asm/delay.h>",
            "#include <asm/apicdef.h>",
            "#include <asm/current.h>",
            "#include <asm/page.h>",
            "#include <asm/msr.h>",
            "#include <asm/processor.h>",
            "#include <linux/slab.h>",
            "#include <linux/math64.h>",
            "#include <linux/module.h>",
            "#include <linux/io.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/smp.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/kvm.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hyperv.h\"\n#include \"cpuid.h\"\n#include \"x86.h\"\n#include \"trace.h\"\n#include \"irq.h\"\n#include \"kvm_cache_regs.h\"\n#include <linux/jump_label.h>\n#include <linux/atomic.h>\n#include <asm/delay.h>\n#include <asm/apicdef.h>\n#include <asm/current.h>\n#include <asm/page.h>\n#include <asm/msr.h>\n#include <asm/processor.h>\n#include <linux/slab.h>\n#include <linux/math64.h>\n#include <linux/module.h>\n#include <linux/io.h>\n#include <linux/hrtimer.h>\n#include <linux/smp.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/kvm.h>\n#include <linux/kvm_host.h>\n\nint kvm_apic_has_interrupt(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\tint highest_irr;\n\n\tif (!apic_enabled(apic))\n\t\treturn -1;\n\n\tapic_update_ppr(apic);\n\thighest_irr = apic_find_highest_irr(apic);\n\tif ((highest_irr == -1) ||\n\t    ((highest_irr & 0xF0) <= kvm_lapic_get_reg(apic, APIC_PROCPRI)))\n\t\treturn -1;\n\treturn highest_irr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvm_vcpu_apicv_active",
          "args": [
            "v"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_vcpu_apicv_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.h",
          "lines": "181-184",
          "snippet": "static inline bool kvm_vcpu_apicv_active(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.apic && vcpu->arch.apicv_active;\n}",
          "includes": [
            "#include <linux/kvm_host.h>",
            "#include <kvm/iodev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n#include <kvm/iodev.h>\n\nstatic inline bool kvm_vcpu_apicv_active(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.apic && vcpu->arch.apicv_active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvm_cpu_has_extint",
          "args": [
            "v"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_cpu_has_extint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
          "lines": "55-66",
          "snippet": "static int kvm_cpu_has_extint(struct kvm_vcpu *v)\n{\n\tu8 accept = kvm_apic_accept_pic_intr(v);\n\n\tif (accept) {\n\t\tif (irqchip_split(v->kvm))\n\t\t\treturn pending_userspace_extint(v);\n\t\telse\n\t\t\treturn pic_irqchip(v->kvm)->output;\n\t} else\n\t\treturn 0;\n}",
          "includes": [
            "#include \"x86.h\"",
            "#include \"i8254.h\"",
            "#include \"irq.h\"",
            "#include <linux/kvm_host.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nstatic int kvm_cpu_has_extint(struct kvm_vcpu *v)\n{\n\tu8 accept = kvm_apic_accept_pic_intr(v);\n\n\tif (accept) {\n\t\tif (irqchip_split(v->kvm))\n\t\t\treturn pending_userspace_extint(v);\n\t\telse\n\t\t\treturn pic_irqchip(v->kvm)->output;\n\t} else\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lapic_in_kernel",
          "args": [
            "v"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "lapic_in_kernel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.h",
          "lines": "141-146",
          "snippet": "static inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}",
          "includes": [
            "#include <linux/kvm_host.h>",
            "#include <kvm/iodev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n#include <kvm/iodev.h>\n\nstatic inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nint kvm_cpu_has_injectable_intr(struct kvm_vcpu *v)\n{\n\tif (!lapic_in_kernel(v))\n\t\treturn v->arch.interrupt.pending;\n\n\tif (kvm_cpu_has_extint(v))\n\t\treturn 1;\n\n\tif (kvm_vcpu_apicv_active(v))\n\t\treturn 0;\n\n\treturn kvm_apic_has_interrupt(v) != -1; /* LAPIC */\n}"
  },
  {
    "function_name": "kvm_cpu_has_extint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
    "lines": "55-66",
    "snippet": "static int kvm_cpu_has_extint(struct kvm_vcpu *v)\n{\n\tu8 accept = kvm_apic_accept_pic_intr(v);\n\n\tif (accept) {\n\t\tif (irqchip_split(v->kvm))\n\t\t\treturn pending_userspace_extint(v);\n\t\telse\n\t\t\treturn pic_irqchip(v->kvm)->output;\n\t} else\n\t\treturn 0;\n}",
    "includes": [
      "#include \"x86.h\"",
      "#include \"i8254.h\"",
      "#include \"irq.h\"",
      "#include <linux/kvm_host.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pic_irqchip",
          "args": [
            "v->kvm"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "pic_irqchip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.h",
          "lines": "81-84",
          "snippet": "static inline struct kvm_pic *pic_irqchip(struct kvm *kvm)\n{\n\treturn kvm->arch.vpic;\n}",
          "includes": [
            "#include \"lapic.h\"",
            "#include \"ioapic.h\"",
            "#include <kvm/iodev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/kvm_host.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/mm_types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lapic.h\"\n#include \"ioapic.h\"\n#include <kvm/iodev.h>\n#include <linux/spinlock.h>\n#include <linux/kvm_host.h>\n#include <linux/hrtimer.h>\n#include <linux/mm_types.h>\n\nstatic inline struct kvm_pic *pic_irqchip(struct kvm *kvm)\n{\n\treturn kvm->arch.vpic;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pending_userspace_extint",
          "args": [
            "v"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "pending_userspace_extint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
          "lines": "46-49",
          "snippet": "static int pending_userspace_extint(struct kvm_vcpu *v)\n{\n\treturn v->arch.pending_external_vector != -1;\n}",
          "includes": [
            "#include \"x86.h\"",
            "#include \"i8254.h\"",
            "#include \"irq.h\"",
            "#include <linux/kvm_host.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nstatic int pending_userspace_extint(struct kvm_vcpu *v)\n{\n\treturn v->arch.pending_external_vector != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irqchip_split",
          "args": [
            "v->kvm"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "irqchip_split",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.h",
          "lines": "94-97",
          "snippet": "static inline int irqchip_split(struct kvm *kvm)\n{\n\treturn kvm->arch.irqchip_split;\n}",
          "includes": [
            "#include \"lapic.h\"",
            "#include \"ioapic.h\"",
            "#include <kvm/iodev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/kvm_host.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/mm_types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lapic.h\"\n#include \"ioapic.h\"\n#include <kvm/iodev.h>\n#include <linux/spinlock.h>\n#include <linux/kvm_host.h>\n#include <linux/hrtimer.h>\n#include <linux/mm_types.h>\n\nstatic inline int irqchip_split(struct kvm *kvm)\n{\n\treturn kvm->arch.irqchip_split;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvm_apic_accept_pic_intr",
          "args": [
            "v"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_apic_accept_pic_intr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.c",
          "lines": "1888-1899",
          "snippet": "int kvm_apic_accept_pic_intr(struct kvm_vcpu *vcpu)\n{\n\tu32 lvt0 = kvm_lapic_get_reg(vcpu->arch.apic, APIC_LVT0);\n\tint r = 0;\n\n\tif (!kvm_apic_hw_enabled(vcpu->arch.apic))\n\t\tr = 1;\n\tif ((lvt0 & APIC_LVT_MASKED) == 0 &&\n\t    GET_APIC_DELIVERY_MODE(lvt0) == APIC_MODE_EXTINT)\n\t\tr = 1;\n\treturn r;\n}",
          "includes": [
            "#include \"hyperv.h\"",
            "#include \"cpuid.h\"",
            "#include \"x86.h\"",
            "#include \"trace.h\"",
            "#include \"irq.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include <linux/jump_label.h>",
            "#include <linux/atomic.h>",
            "#include <asm/delay.h>",
            "#include <asm/apicdef.h>",
            "#include <asm/current.h>",
            "#include <asm/page.h>",
            "#include <asm/msr.h>",
            "#include <asm/processor.h>",
            "#include <linux/slab.h>",
            "#include <linux/math64.h>",
            "#include <linux/module.h>",
            "#include <linux/io.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/smp.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/kvm.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hyperv.h\"\n#include \"cpuid.h\"\n#include \"x86.h\"\n#include \"trace.h\"\n#include \"irq.h\"\n#include \"kvm_cache_regs.h\"\n#include <linux/jump_label.h>\n#include <linux/atomic.h>\n#include <asm/delay.h>\n#include <asm/apicdef.h>\n#include <asm/current.h>\n#include <asm/page.h>\n#include <asm/msr.h>\n#include <asm/processor.h>\n#include <linux/slab.h>\n#include <linux/math64.h>\n#include <linux/module.h>\n#include <linux/io.h>\n#include <linux/hrtimer.h>\n#include <linux/smp.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/kvm.h>\n#include <linux/kvm_host.h>\n\nint kvm_apic_accept_pic_intr(struct kvm_vcpu *vcpu)\n{\n\tu32 lvt0 = kvm_lapic_get_reg(vcpu->arch.apic, APIC_LVT0);\n\tint r = 0;\n\n\tif (!kvm_apic_hw_enabled(vcpu->arch.apic))\n\t\tr = 1;\n\tif ((lvt0 & APIC_LVT_MASKED) == 0 &&\n\t    GET_APIC_DELIVERY_MODE(lvt0) == APIC_MODE_EXTINT)\n\t\tr = 1;\n\treturn r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nstatic int kvm_cpu_has_extint(struct kvm_vcpu *v)\n{\n\tu8 accept = kvm_apic_accept_pic_intr(v);\n\n\tif (accept) {\n\t\tif (irqchip_split(v->kvm))\n\t\t\treturn pending_userspace_extint(v);\n\t\telse\n\t\t\treturn pic_irqchip(v->kvm)->output;\n\t} else\n\t\treturn 0;\n}"
  },
  {
    "function_name": "pending_userspace_extint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
    "lines": "46-49",
    "snippet": "static int pending_userspace_extint(struct kvm_vcpu *v)\n{\n\treturn v->arch.pending_external_vector != -1;\n}",
    "includes": [
      "#include \"x86.h\"",
      "#include \"i8254.h\"",
      "#include \"irq.h\"",
      "#include <linux/kvm_host.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nstatic int pending_userspace_extint(struct kvm_vcpu *v)\n{\n\treturn v->arch.pending_external_vector != -1;\n}"
  },
  {
    "function_name": "kvm_cpu_has_pending_timer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/irq.c",
    "lines": "34-40",
    "snippet": "int kvm_cpu_has_pending_timer(struct kvm_vcpu *vcpu)\n{\n\tif (lapic_in_kernel(vcpu))\n\t\treturn apic_has_pending_timer(vcpu);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"x86.h\"",
      "#include \"i8254.h\"",
      "#include \"irq.h\"",
      "#include <linux/kvm_host.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "apic_has_pending_timer",
          "args": [
            "vcpu"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "apic_has_pending_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.c",
          "lines": "1776-1784",
          "snippet": "int apic_has_pending_timer(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\n\tif (apic_enabled(apic) && apic_lvt_enabled(apic, APIC_LVTT))\n\t\treturn atomic_read(&apic->lapic_timer.pending);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"hyperv.h\"",
            "#include \"cpuid.h\"",
            "#include \"x86.h\"",
            "#include \"trace.h\"",
            "#include \"irq.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include <linux/jump_label.h>",
            "#include <linux/atomic.h>",
            "#include <asm/delay.h>",
            "#include <asm/apicdef.h>",
            "#include <asm/current.h>",
            "#include <asm/page.h>",
            "#include <asm/msr.h>",
            "#include <asm/processor.h>",
            "#include <linux/slab.h>",
            "#include <linux/math64.h>",
            "#include <linux/module.h>",
            "#include <linux/io.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/smp.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/kvm.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hyperv.h\"\n#include \"cpuid.h\"\n#include \"x86.h\"\n#include \"trace.h\"\n#include \"irq.h\"\n#include \"kvm_cache_regs.h\"\n#include <linux/jump_label.h>\n#include <linux/atomic.h>\n#include <asm/delay.h>\n#include <asm/apicdef.h>\n#include <asm/current.h>\n#include <asm/page.h>\n#include <asm/msr.h>\n#include <asm/processor.h>\n#include <linux/slab.h>\n#include <linux/math64.h>\n#include <linux/module.h>\n#include <linux/io.h>\n#include <linux/hrtimer.h>\n#include <linux/smp.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/kvm.h>\n#include <linux/kvm_host.h>\n\nint apic_has_pending_timer(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_lapic *apic = vcpu->arch.apic;\n\n\tif (apic_enabled(apic) && apic_lvt_enabled(apic, APIC_LVTT))\n\t\treturn atomic_read(&apic->lapic_timer.pending);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lapic_in_kernel",
          "args": [
            "vcpu"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "lapic_in_kernel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3713/repo/arch/x86/kvm/lapic.h",
          "lines": "141-146",
          "snippet": "static inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}",
          "includes": [
            "#include <linux/kvm_host.h>",
            "#include <kvm/iodev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n#include <kvm/iodev.h>\n\nstatic inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"x86.h\"\n#include \"i8254.h\"\n#include \"irq.h\"\n#include <linux/kvm_host.h>\n#include <linux/module.h>\n\nint kvm_cpu_has_pending_timer(struct kvm_vcpu *vcpu)\n{\n\tif (lapic_in_kernel(vcpu))\n\t\treturn apic_has_pending_timer(vcpu);\n\n\treturn 0;\n}"
  }
]