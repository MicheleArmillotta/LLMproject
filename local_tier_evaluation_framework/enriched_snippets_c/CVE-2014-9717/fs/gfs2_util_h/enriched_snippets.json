[
  {
    "function_name": "gfs2_tune_get_i",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/util.h",
    "lines": "155-163",
    "snippet": "static inline unsigned int gfs2_tune_get_i(struct gfs2_tune *gt,\n\t\t\t\t\t   unsigned int *p)\n{\n\tunsigned int x;\n\tspin_lock(&gt->gt_spin);\n\tx = *p;\n\tspin_unlock(&gt->gt_spin);\n\treturn x;\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/mempool.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gt->gt_spin"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gt->gt_spin"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/mempool.h>\n\nstatic inline unsigned int gfs2_tune_get_i(struct gfs2_tune *gt,\n\t\t\t\t\t   unsigned int *p)\n{\n\tunsigned int x;\n\tspin_lock(&gt->gt_spin);\n\tx = *p;\n\tspin_unlock(&gt->gt_spin);\n\treturn x;\n}"
  },
  {
    "function_name": "gfs2_metatype_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/util.h",
    "lines": "122-129",
    "snippet": "static inline void gfs2_metatype_set(struct buffer_head *bh, u16 type,\n\t\t\t\t     u16 format)\n{\n\tstruct gfs2_meta_header *mh;\n\tmh = (struct gfs2_meta_header *)bh->b_data;\n\tmh->mh_type = cpu_to_be32(type);\n\tmh->mh_format = cpu_to_be32(format);\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/mempool.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "format"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "type"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/mempool.h>\n\nstatic inline void gfs2_metatype_set(struct buffer_head *bh, u16 type,\n\t\t\t\t     u16 format)\n{\n\tstruct gfs2_meta_header *mh;\n\tmh = (struct gfs2_meta_header *)bh->b_data;\n\tmh->mh_type = cpu_to_be32(type);\n\tmh->mh_format = cpu_to_be32(format);\n}"
  },
  {
    "function_name": "gfs2_metatype_check_i",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/util.h",
    "lines": "101-117",
    "snippet": "static inline int gfs2_metatype_check_i(struct gfs2_sbd *sdp,\n\t\t\t\t\tstruct buffer_head *bh,\n\t\t\t\t\tu16 type,\n\t\t\t\t\tconst char *function,\n\t\t\t\t\tchar *file, unsigned int line)\n{\n\tstruct gfs2_meta_header *mh = (struct gfs2_meta_header *)bh->b_data;\n\tu32 magic = be32_to_cpu(mh->mh_magic);\n\tu16 t = be32_to_cpu(mh->mh_type);\n\tif (unlikely(magic != GFS2_MAGIC))\n\t\treturn gfs2_meta_check_ii(sdp, bh, \"magic number\", function,\n\t\t\t\t\t  file, line);\n        if (unlikely(t != type))\n\t\treturn gfs2_metatype_check_ii(sdp, bh, type, t, function,\n\t\t\t\t\t      file, line);\n\treturn 0;\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/mempool.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_metatype_check_ii",
          "args": [
            "sdp",
            "bh",
            "type",
            "t",
            "function",
            "file",
            "line"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_metatype_check_ii",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/util.c",
          "lines": "216-228",
          "snippet": "int gfs2_metatype_check_ii(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t\t   u16 type, u16 t, const char *function,\n\t\t\t   char *file, unsigned int line)\n{\n\tint me;\n\tme = gfs2_lm_withdraw(sdp,\n\t\t\t      \"fatal: invalid metadata block\\n\"\n\t\t\t      \"  bh = %llu (type: exp=%u, found=%u)\\n\"\n\t\t\t      \"  function = %s, file = %s, line = %u\\n\",\n\t\t\t      (unsigned long long)bh->b_blocknr, type, t,\n\t\t\t      function, file, line);\n\treturn (me) ? -1 : -2;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/crc32.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/crc32.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nint gfs2_metatype_check_ii(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t\t   u16 type, u16 t, const char *function,\n\t\t\t   char *file, unsigned int line)\n{\n\tint me;\n\tme = gfs2_lm_withdraw(sdp,\n\t\t\t      \"fatal: invalid metadata block\\n\"\n\t\t\t      \"  bh = %llu (type: exp=%u, found=%u)\\n\"\n\t\t\t      \"  function = %s, file = %s, line = %u\\n\",\n\t\t\t      (unsigned long long)bh->b_blocknr, type, t,\n\t\t\t      function, file, line);\n\treturn (me) ? -1 : -2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "t != type"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_meta_check_ii",
          "args": [
            "sdp",
            "bh",
            "\"magic number\"",
            "function",
            "file",
            "line"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_meta_check_ii",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/util.c",
          "lines": "196-208",
          "snippet": "int gfs2_meta_check_ii(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t       const char *type, const char *function, char *file,\n\t\t       unsigned int line)\n{\n\tint me;\n\tme = gfs2_lm_withdraw(sdp,\n\t\t\t      \"fatal: invalid metadata block\\n\"\n\t\t\t      \"  bh = %llu (%s)\\n\"\n\t\t\t      \"  function = %s, file = %s, line = %u\\n\",\n\t\t\t      (unsigned long long)bh->b_blocknr, type,\n\t\t\t      function, file, line);\n\treturn (me) ? -1 : -2;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/crc32.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/crc32.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nint gfs2_meta_check_ii(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t       const char *type, const char *function, char *file,\n\t\t       unsigned int line)\n{\n\tint me;\n\tme = gfs2_lm_withdraw(sdp,\n\t\t\t      \"fatal: invalid metadata block\\n\"\n\t\t\t      \"  bh = %llu (%s)\\n\"\n\t\t\t      \"  function = %s, file = %s, line = %u\\n\",\n\t\t\t      (unsigned long long)bh->b_blocknr, type,\n\t\t\t      function, file, line);\n\treturn (me) ? -1 : -2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "magic != GFS2_MAGIC"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "mh->mh_type"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "mh->mh_magic"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/mempool.h>\n\nstatic inline int gfs2_metatype_check_i(struct gfs2_sbd *sdp,\n\t\t\t\t\tstruct buffer_head *bh,\n\t\t\t\t\tu16 type,\n\t\t\t\t\tconst char *function,\n\t\t\t\t\tchar *file, unsigned int line)\n{\n\tstruct gfs2_meta_header *mh = (struct gfs2_meta_header *)bh->b_data;\n\tu32 magic = be32_to_cpu(mh->mh_magic);\n\tu16 t = be32_to_cpu(mh->mh_type);\n\tif (unlikely(magic != GFS2_MAGIC))\n\t\treturn gfs2_meta_check_ii(sdp, bh, \"magic number\", function,\n\t\t\t\t\t  file, line);\n        if (unlikely(t != type))\n\t\treturn gfs2_metatype_check_ii(sdp, bh, type, t, function,\n\t\t\t\t\t      file, line);\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_meta_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/util.h",
    "lines": "83-94",
    "snippet": "static inline int gfs2_meta_check(struct gfs2_sbd *sdp,\n\t\t\t\t    struct buffer_head *bh)\n{\n\tstruct gfs2_meta_header *mh = (struct gfs2_meta_header *)bh->b_data;\n\tu32 magic = be32_to_cpu(mh->mh_magic);\n\tif (unlikely(magic != GFS2_MAGIC)) {\n\t\tpr_err(\"Magic number missing at %llu\\n\",\n\t\t       (unsigned long long)bh->b_blocknr);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/mempool.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Magic number missing at %llu\\n\"",
            "(unsigned long long)bh->b_blocknr"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "magic != GFS2_MAGIC"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "mh->mh_magic"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/mempool.h>\n\nstatic inline int gfs2_meta_check(struct gfs2_sbd *sdp,\n\t\t\t\t    struct buffer_head *bh)\n{\n\tstruct gfs2_meta_header *mh = (struct gfs2_meta_header *)bh->b_data;\n\tu32 magic = be32_to_cpu(mh->mh_magic);\n\tif (unlikely(magic != GFS2_MAGIC)) {\n\t\tpr_err(\"Magic number missing at %llu\\n\",\n\t\t       (unsigned long long)bh->b_blocknr);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
  }
]